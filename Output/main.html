<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>FTAG Twine</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.36.1): A free (gratis and libre) story format.

Copyright © 2013–2021 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/1.2.20171210/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new c("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(e))throw new c("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],h=function(){return new l(this)};if(c[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return~a(this,t+"")},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",~a(this,t)||(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=a(this,t);~e;)this.splice(e,1),r=!0,e=a(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.replace=function(t,e){var n=a(t+"");~n&&(this.splice(n,1,e),this._updateClassName())},u.toString=function(){return this.join(" ")},s.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,f)}catch(p){void 0!==p.number&&-2146823252!==p.number||(f.enumerable=!1,s.defineProperty(i,e,f))}}else s[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,e){var n=this.toString().split(" "),i=n.indexOf(t+"");~i&&(n=n.slice(i),this.remove.apply(this,n),this.add(e),this.add.apply(this,n.slice(1)))}),t=null}());
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2020 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.14/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},E=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},j="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return E(t)}if(O(t)){return false}var r=T.call(t);return r===j||r===I};var M;var U=RegExp.prototype.exec,$=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},F="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?$(t):T.call(t)===F};var N;var C=String.prototype.valueOf,k=function tryStringObject(t){try{C.call(t);return true}catch(r){return false}},A="[object String]";N=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?k(t):T.call(t)===A};var R=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var P=function(t){var r;if(R){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var Z=function Empty(){};P(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){Z.prototype=r.prototype;a.prototype=new Z;Z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var H=d.bind(n.toString);var W=d.bind(s);var B=g.bind(s);if(typeof document==="object"&&document&&document.documentElement){try{W(document.documentElement.childNodes)}catch(X){var L=W;var q=B;W=function arraySliceIE(t){var r=[];var e=t.length;while(e-- >0){r[e]=t[e]}return q(r,L(arguments,1))};B=function arraySliceApplyIE(t,r){return q(W(t),r)}}}var K=d.bind(f.slice);var Q=d.bind(f.split);var V=d.bind(f.indexOf);var _=d.bind(v);var tt=d.bind(n.propertyIsEnumerable);var rt=d.bind(r.sort);var et=t.isArray||function isArray(t){return H(t)==="[object Array]"};var nt=[].unshift(0)!==1;P(r,{unshift:function(){h.apply(this,arguments);return this.length}},nt);P(t,{isArray:et});var it=e("a");var at=it[0]!=="a"||!(0 in it);var ot=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};P(r,{forEach:function forEach(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=-1;var i=z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!ot(r.forEach));P(r,{map:function map(r){var e=z.ToObject(this);var n=at&&N(this)?Q(this,""):e;var i=z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!ot(r.map));P(r,{filter:function filter(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){_(i,a)}}}return i}},!ot(r.filter));P(r,{every:function every(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!ot(r.every));P(r,{some:function some(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!ot(r.some));var ft=false;if(r.reduce){ft=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduce:function reduce(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!ft);var ut=false;if(r.reduceRight){ut=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduceRight:function reduceRight(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!ut);var lt=r.indexOf&&[0,1].indexOf(1,2)!==-1;P(r,{indexOf:function indexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},lt);var st=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;P(r,{lastIndexOf:function lastIndexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},st);var ct=function(){var t=[1,2];var r=t.splice();return t.length===2&&et(r)&&r.length===0}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ct);var vt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=W(arguments);if(e.length<2){_(e,this.length-t)}else{e[1]=z.ToInteger(r)}}return c.apply(this,e)}},!vt);var ht=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var pt=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();P(r,{splice:function splice(t,r){var e=z.ToObject(this);var n=[];var i=z.ToUint32(e.length);var a=z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=arguments.length===0?0:arguments.length===1?i-f:b(w(z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=W(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!ht||!pt);var yt=r.join;var dt;try{dt=Array.prototype.join.call("123",",")!=="1,2,3"}catch(X){dt=true}if(dt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(N(this)?Q(this,""):this,r)}},dt)}var gt=[1,2].join(undefined)!=="1,2";if(gt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(this,r)}},gt)}var wt=function push(t){var r=z.ToObject(this);var e=z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var bt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:function push(t){if(et(this)){return v.apply(this,arguments)}return wt.apply(this,arguments)}},bt);var Tt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:wt},Tt);P(r,{slice:function(t,r){var e=N(this)?Q(this,""):this;return B(e,arguments)}},at);var mt=function(){try{[1,2].sort(null)}catch(t){try{[1,2].sort({})}catch(r){return false}}return true}();var Dt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var St=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();P(r,{sort:function sort(t){if(typeof t==="undefined"){return rt(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return rt(this,t)}},mt||!St||!Dt);var xt=!tt({toString:null},"toString");var Ot=tt(function(){},"prototype");var Et=!G("x","0");var jt=function(t){var r=t.constructor;return r&&r.prototype===t};var It={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true,$width:true,$height:true,$top:true,$localStorage:true};var Mt=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!It["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){jt(window[t])}}catch(r){return true}}return false}();var Ut=function(t){if(typeof window==="undefined"||!Mt){return jt(t)}try{return jt(t)}catch(r){return false}};var $t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ft=$t.length;var Nt=function isArguments(t){return H(t)==="[object Arguments]"};var Ct=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!et(t)&&D(t.callee)};var kt=Nt(arguments)?Nt:Ct;P(e,{keys:function keys(t){var r=D(t);var e=kt(t);var n=t!==null&&typeof t==="object";var i=n&&N(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=Ot&&r;if(i&&Et||e){for(var u=0;u<t.length;++u){_(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){_(a,o(l))}}}if(xt){var s=Ut(t);for(var c=0;c<Ft;c++){var v=$t[c];if(!(s&&v==="constructor")&&G(t,v)){_(a,v)}}}return a}});var At=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var Rt=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Pt=e.keys;P(e,{keys:function keys(t){if(kt(t)){return Pt(W(t))}else{return Pt(t)}}},!At||Rt);var Jt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var Yt=new Date(-0x55d318d56a724);var zt=new Date(14496624e5);var Zt=Yt.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Gt;var Ht;var Wt=Yt.getTimezoneOffset();if(Wt<-720){Gt=Yt.toDateString()!=="Tue Jan 02 -45875";Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}else{Gt=Yt.toDateString()!=="Mon Jan 01 -45875";Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}var Bt=d.bind(Date.prototype.getFullYear);var Xt=d.bind(Date.prototype.getMonth);var Lt=d.bind(Date.prototype.getDate);var qt=d.bind(Date.prototype.getUTCFullYear);var Kt=d.bind(Date.prototype.getUTCMonth);var Qt=d.bind(Date.prototype.getUTCDate);var Vt=d.bind(Date.prototype.getUTCDay);var _t=d.bind(Date.prototype.getUTCHours);var tr=d.bind(Date.prototype.getUTCMinutes);var rr=d.bind(Date.prototype.getUTCSeconds);var er=d.bind(Date.prototype.getUTCMilliseconds);var nr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ar=function daysInMonth(t,r){return Lt(new Date(r,t,0))};P(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Xt(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);var e=Lt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);if(t<0&&Kt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);var e=Qt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e}},Jt);P(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Vt(this);var r=Qt(this);var e=Kt(this);var n=qt(this);var i=_t(this);var a=tr(this);var o=rr(this);return nr[t]+", "+(r<10?"0"+r:r)+" "+ir[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Jt||Zt);P(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n}},Jt||Gt);if(Jt||Ht){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(R){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var or=-621987552e5;var fr="-000001";var ur=Date.prototype.toISOString&&new Date(or).toISOString().indexOf(fr)===-1;var lr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var sr=d.bind(Date.prototype.getTime);P(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(sr(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=qt(this);var r=Kt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,Qt(this),_t(this),tr(this),rr(this)];t=(t<0?"-":t>9999?"+":"")+K("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=K("00"+e[n],-2)}return t+"-"+W(e,0,2).join("-")+"T"+W(e,2).join(":")+"."+K("000"+er(this),-3)+"Z"}},ur||lr);var cr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(or).toJSON().indexOf(fr)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!cr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var vr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var hr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var pr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(pr||hr||!vr){var yr=Math.pow(2,31)-1;var dr=Y(new Date(1970,0,1,0,0,0,yr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(dr&&s>=7&&l>yr){var p=Math.floor(l/yr)*yr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){P(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(dr&&n>yr){var i=Math.floor(n/yr)*yr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}P(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;P(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};P(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var gr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128");var wr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<wr.size){n+=t*wr.data[e];wr.data[e]=n%wr.base;n=Math.floor(n/wr.base)}},divide:function divide(t){var r=wr.size;var e=0;while(--r>=0){e+=wr.data[r];wr.data[r]=Math.floor(e/t);e=e%t*wr.base}},numToString:function numToString(){var t=wr.size;var r="";while(--t>=0){if(r!==""||t===0||wr.data[t]!==0){var e=o(wr.data[t]);if(r===""){r=e}else{r+=K("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var br=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=wr.log(e*wr.pow(2,69,1))-69;f=a<0?e*wr.pow(2,-a,1):e/wr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){wr.multiply(0,f);l=r;while(l>=7){wr.multiply(1e7,0);l-=7}wr.multiply(wr.pow(10,l,1),0);l=a-1;while(l>=23){wr.divide(1<<23);l-=23}wr.divide(1<<l);wr.multiply(1,1);wr.divide(2);i=wr.numToString()}else{wr.multiply(0,f);wr.multiply(1<<-a,0);i=wr.numToString()+K("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+K("0.0000000000000000000",0,r-s+2)+i}else{i=n+K(i,0,s-r)+"."+K(i,s-r)}}else{i=n+i}return i};P(l,{toFixed:br},gr);var Tr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var mr=l.toPrecision;P(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?mr.call(this):mr.call(this,t)}},Tr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return Q(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){_(a,K(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,W(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){_(a,"")}}else{_(a,K(i,f))}return a.length>p?W(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return Q(this,t,r)}}var Dr=f.replace;var Sr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){_(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!Sr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Dr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;_(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Dr.call(this,t,i)}}}var xr=f.substr;var Or="".substr&&"0b".substr(-1)!=="b";P(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return xr.call(this,e,r)}},Or);var Er="\t\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var jr="\u200b";var Ir="["+Er+"]";var Mr=new RegExp("^"+Ir+Ir+"*");var Ur=new RegExp(Ir+Ir+"*$");var $r=f.trim&&(Er.trim()||!jr.trim());P(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Mr,"").replace(Ur,"")}},$r);var Fr=d.bind(String.prototype.trim);var Nr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;P(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=V(K(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Nr);var Cr=f.lastIndexOf;P(f,{lastIndexOf:function lastIndexOf(t){return Cr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(Er+"08")!==8||parseInt(Er+"0x16")!==22){parseInt=function(t){var r=/^[-+]?0[xX]/;return function parseInt(e,n){if(typeof e==="symbol"){""+e}var i=Fr(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Fr(String(r));var n=t(e);return n===0&&K(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var kr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=kr}if(R){var Ar=function(t,r){if(tt(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};Ar(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}Ar(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Rr=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Rr}});
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.4/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var L=Math.exp;var F=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(F(1+t)/(1+t-1))};var Q=function isArguments(e){return g(e)==="[object Arguments]"};var ee=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var te=Q(arguments)?Q:ee;var re={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var ne=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var oe=typeof $==="function"&&typeof $["for"]==="function"&&re.symbol($());var ie=re.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ie="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ae=S.Reflect;var ue=String;var fe=typeof document==="undefined"||!document?null:document.all;var se=fe==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==fe};var ce={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!ce.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(se(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===fe},ToObject:function(e,t){return Object(ce.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return ce.IsCallable(e)},ToInt32:function(e){return ce.ToNumber(e)>>0},ToUint32:function(e){return ce.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=ce.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=ce.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return ce.TypeIsObject(e)&&(typeof e[ie]!=="undefined"||te(e))},GetIterator:function(e){if(te(e)){return new q(e,"value")}var t=ce.GetMethod(e,ie);if(!ce.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=ce.Call(t,e);if(!ce.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=ce.ToObject(e)[t];if(se(r)){return void 0}if(!ce.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=ce.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=ce.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!ce.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ce.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=ce.IteratorNext(e);var r=ce.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ae.construct){return ae.construct(e,t,o)}var i=o.prototype;if(!ce.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=ce.Call(e,a,t);return ce.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!ce.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(se(n)){return t}if(!ce.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=ce.ToString(e);var i="<"+t;if(r!==""){var a=ce.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!ce.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return re.regex(e)},ToString:function ToString(e){return ue(e)}};if(s&&oe){var le=function defineWellKnownSymbol(e){if(re.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!re.symbol($.search)){var pe=le("search");var ve=String.prototype.search;h(RegExp.prototype,pe,function search(e){return ce.Call(ve,e,[this])});var ye=function search(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,pe);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(ve,t,[ce.ToString(e)])};ne(String.prototype,"search",ye)}if(!re.symbol($.replace)){var he=le("replace");var be=String.prototype.replace;h(RegExp.prototype,he,function replace(e,t){return ce.Call(be,e,[this,t])});var ge=function replace(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,he);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(be,r,[ce.ToString(e),t])};ne(String.prototype,"replace",ge)}if(!re.symbol($.split)){var de=le("split");var me=String.prototype.split;h(RegExp.prototype,de,function split(e,t){return ce.Call(me,e,[this,t])});var Oe=function split(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,de);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(me,r,[ce.ToString(e),t])};ne(String.prototype,"split",Oe)}var we=re.symbol($.match);var je=we&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!we||je){var Se=le("match");var Te=String.prototype.match;h(RegExp.prototype,Se,function match(e){return ce.Call(Te,e,[this])});var Ie=function match(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,Se);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(Te,t,[ce.ToString(e)])};ne(String.prototype,"match",Ie)}}var Ee=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Pe=function(){return this};var Ce=function(e){if(s&&!z(e,J)){m.getter(e,J,Pe)}};var Me=function(e,t){var r=t||function iterator(){return this};h(e,ie,r);if(!e[ie]&&re.symbol(ie)){e[ie]=r}};var xe=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ne=function createDataPropertyOrThrow(e,t,r){xe(e,t,r);if(!ce.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ae=function(e,t,r,n){if(!ce.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!ce.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;ne(String,"fromCodePoint",function fromCodePoint(e){return ce.Call(Re,this,arguments)})}var _e={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!ce.SameValue(r,ce.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=ce.ToObject(e,"bad callSite");var r=ce.ToObject(t.raw,"bad raw value");var n=r.length;var o=ce.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=ce.ToString(a);s=ce.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=ce.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){ne(String,"raw",_e.raw)}b(String,_e);var ke=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Le=Infinity;var Fe={repeat:function repeat(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);if(r<0||r>=Le){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return ke(t,r)},startsWith:function startsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=ce.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(ce.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=ce.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:ce.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(ce.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=ce.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){ne(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var De=i(function(){return"/a/".startsWith(/a/)});var ze=a(function(){return"abc".startsWith("a",Infinity)===false});if(!De||!ze){ne(String.prototype,"startsWith",Fe.startsWith);ne(String.prototype,"endsWith",Fe.endsWith)}}if(oe){var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!qe){ne(String.prototype,"startsWith",Fe.startsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!We){ne(String.prototype,"endsWith",Fe.endsWith)}var Ge=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!Ge){ne(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var He=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Ve=new RegExp("(^["+He+"]+)|(["+He+"]+$)","g");var Be=function trim(){return ce.ToString(ce.RequireObjectCoercible(this)).replace(Ve,"")};var Ue=["\x85","\u200b","\ufffe"].join("");var $e=new RegExp("["+Ue+"]","g");var Je=/^[-+]0x[0-9a-f]+$/i;var Xe=Ue.trim().length!==Ue.length;h(String.prototype,"trim",Be,Xe);var Ke=function(e){return{value:e,done:arguments.length===0}};var Ze=function(e){ce.RequireObjectCoercible(e);this._s=ce.ToString(e);this._i=0};Ze.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ke()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ke(e.substr(t,o))};Me(Ze.prototype);Me(String.prototype,function(){return new Ze(this)});var Ye={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!ce.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(te(e)||ce.GetMethod(e,ie))!=="undefined";var u,f,s;if(a){f=ce.IsConstructor(r)?Object(new r):[];var c=ce.GetIterator(e);var l,p;s=0;while(true){l=ce.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){ce.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=ce.ToObject(e);u=ce.ToLength(y.length);f=ce.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ne(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!ce.IsCallable(t)?new Array(e):ce.Construct(t,[e]);for(var o=0;o<e;++o){Ne(n,o,arguments[o])}n.length=e;return n}};b(Array,Ye);Ce(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=ce.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ke(o)}}this.array=void 0;return Ke()}});Me(q.prototype);var Qe=Array.of===Ye.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Qe){ne(Array,"of",Ye.of)}var et={copyWithin:function copyWithin(e,t){var r=ce.ToObject(this);var n=ce.ToLength(r.length);var o=ce.ToInteger(e);var i=ce.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:ce.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=ce.ToObject(this);var o=ce.ToLength(n.length);t=ce.ToInteger(typeof t==="undefined"?0:t);r=ce.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!ce.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!ce.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ie]){b(Array.prototype,{values:Array.prototype[ie]});if(re.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var tt=Array.prototype.values;ne(Array.prototype,"values",function values(){return ce.Call(tt,this,arguments)});h(Array.prototype,ie,Array.prototype.values,true)}b(Array.prototype,et);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Me(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Me(Object.getPrototypeOf([].values()))}var rt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var nt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!rt||!nt){ne(Array,"from",Ye.from)}var ot=function(){return a(function(){return Array.from([0],void 0)})}();if(!ot){var it=Array.from;ne(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return ce.Call(it,this,arguments)}else{return t(it,this,e)}})}var at=-(Math.pow(2,32)-1);var ut=function(e,r){var n={length:at};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!ut(Array.prototype.forEach)){var ft=Array.prototype.forEach;ne(Array.prototype,"forEach",function forEach(e){return ce.Call(ft,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.map)){var st=Array.prototype.map;ne(Array.prototype,"map",function map(e){return ce.Call(st,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.filter)){var ct=Array.prototype.filter;ne(Array.prototype,"filter",function filter(e){return ce.Call(ct,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.some)){var lt=Array.prototype.some;ne(Array.prototype,"some",function some(e){return ce.Call(lt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.every)){var pt=Array.prototype.every;ne(Array.prototype,"every",function every(e){return ce.Call(pt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduce)){var vt=Array.prototype.reduce;ne(Array.prototype,"reduce",function reduce(e){return ce.Call(vt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduceRight,true)){var yt=Array.prototype.reduceRight;ne(Array.prototype,"reduceRight",function reduceRight(e){return ce.Call(yt,this.length>=0?this:[],arguments)},true)}var ht=Number("0o10")!==8;var bt=Number("0b10")!==2;var gt=y(Ue,function(e){return Number(e+0+e)===0});if(ht||bt||gt){var dt=Number;var mt=/^0b[01]+$/i;var Ot=/^0o[0-7]+$/i;var wt=mt.test.bind(mt);var jt=Ot.test.bind(Ot);var St=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(re.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(re.primitive(t)){return t}}throw new TypeError("No default value")};var Tt=$e.test.bind($e);var It=Je.test.bind(Je);var Et=function(){var e=function Number(t){var r;if(arguments.length>0){r=re.primitive(t)?t:St(t,"number")}else{r=0}if(typeof r==="string"){r=ce.Call(Be,r);if(wt(r)){r=parseInt(C(r,2),2)}else if(jt(r)){r=parseInt(C(r,2),8)}else if(Tt(r)||It(r)){r=NaN}}var n=this;var o=a(function(){dt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new dt(r)}return dt(r)};return e}();Ee(dt,Et,{});b(Et,{NaN:dt.NaN,MAX_VALUE:dt.MAX_VALUE,MIN_VALUE:dt.MIN_VALUE,NEGATIVE_INFINITY:dt.NEGATIVE_INFINITY,POSITIVE_INFINITY:dt.POSITIVE_INFINITY});Number=Et;m.redefine(S,"Number",Et)}var Pt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Pt,MIN_SAFE_INTEGER:-Pt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&ce.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){ne(Array.prototype,"find",et.find)}if([,1].findIndex(function(){return true})!==0){ne(Array.prototype,"findIndex",et.findIndex)}var Ct=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Mt=function ensureEnumerable(e,t){if(s&&Ct(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var xt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Nt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var At=function(e,t){var r=n(Object(t));var o;if(ce.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Ct(t))}return p(P(r,o||[]),Nt(t),e)};var Rt={assign:function(e,t){var r=ce.ToObject(e,"Cannot convert undefined or null to object");return p(ce.Call(xt,1,arguments),At,r)},is:function is(e,t){return ce.SameValue(e,t)}};var _t=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(_t){ne(Object,"assign",Rt.assign)}b(Object,Rt);if(s){var kt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!ce.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||ce.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,kt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Lt=!i(function(){return Object.keys("foo")});if(!Lt){var Ft=Object.keys;ne(Object,"keys",function keys(e){return Ft(ce.ToObject(e))});n=Object.keys}var Dt=i(function(){return Object.keys(/a/g)});if(Dt){var zt=Object.keys;ne(Object,"keys",function keys(e){if(re.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return zt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var qt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!qt){var Wt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Gt=Object.getOwnPropertyNames;ne(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=ce.ToObject(e);if(g(t)==="[object Window]"){try{return Gt(t)}catch(r){return P([],Wt)}}return Gt(t)})}}if(Object.getOwnPropertyDescriptor){var Ht=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Ht){var Vt=Object.getOwnPropertyDescriptor;ne(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Vt(ce.ToObject(e),t)})}}if(Object.seal){var Bt=!i(function(){return Object.seal("foo")});if(!Bt){var Ut=Object.seal;ne(Object,"seal",function seal(e){if(!ce.TypeIsObject(e)){return e}return Ut(e)})}}if(Object.isSealed){var $t=!i(function(){return Object.isSealed("foo")});if(!$t){var Jt=Object.isSealed;ne(Object,"isSealed",function isSealed(e){if(!ce.TypeIsObject(e)){return true}return Jt(e)})}}if(Object.freeze){var Xt=!i(function(){return Object.freeze("foo")});if(!Xt){var Kt=Object.freeze;ne(Object,"freeze",function freeze(e){if(!ce.TypeIsObject(e)){return e}return Kt(e)})}}if(Object.isFrozen){var Zt=!i(function(){return Object.isFrozen("foo")});if(!Zt){var Yt=Object.isFrozen;ne(Object,"isFrozen",function isFrozen(e){if(!ce.TypeIsObject(e)){return true}return Yt(e)})}}if(Object.preventExtensions){var Qt=!i(function(){return Object.preventExtensions("foo")});if(!Qt){var er=Object.preventExtensions;ne(Object,"preventExtensions",function preventExtensions(e){if(!ce.TypeIsObject(e)){return e}return er(e)})}}if(Object.isExtensible){var tr=!i(function(){return Object.isExtensible("foo")});if(!tr){var rr=Object.isExtensible;ne(Object,"isExtensible",function isExtensible(e){if(!ce.TypeIsObject(e)){return false}return rr(e)})}}if(Object.getPrototypeOf){var nr=!i(function(){return Object.getPrototypeOf("foo")});if(!nr){var or=Object.getPrototypeOf;ne(Object,"getPrototypeOf",function getPrototypeOf(e){return or(ce.ToObject(e))})}}var ir=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ce.IsCallable(e.get)}();if(s&&!ir){var ar=function flags(){if(!ce.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ar)}var ur=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var fr=oe&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var sr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var cr=sr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!sr||!cr){var lr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=ce.RequireObjectCoercible(this);if(re.regex(e)){return t(lr,e)}var r=ue(e.source);var n=ue(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,lr)}if(s&&(!ur||fr)){var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var vr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var yr=function(){return this.source};var hr=ce.IsCallable(vr.get)?vr.get:yr;var br=RegExp;var gr=function(){return function RegExp(e,t){var r=ce.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(re.regex(e)){o=ce.Call(hr,e);i=typeof t==="undefined"?ce.Call(pr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new br(e,t)}}();Ee(br,gr,{$input:true});RegExp=gr;m.redefine(S,"RegExp",gr)}if(s){var dr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(dr),function(e){if(e in RegExp&&!(dr[e]in RegExp)){m.getter(RegExp,dr[e],function get(){return RegExp[e]})}})}Ce(RegExp);var mr=1/Number.EPSILON;var Or=function roundTiesToEven(e){return e+mr-mr};var wr=Math.pow(2,-23);var jr=Math.pow(2,127)*(2-wr);var Sr=Math.pow(2,-126);var Tr=Math.E;var Ir=Math.LOG2E;var Er=Math.LOG10E;var Pr=Number.prototype.clz;delete Number.prototype.clz;var Cr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Y(t-1+D(1-r)*t)}var n=t/2;return Y(n+D(1-r)*n-1)+1/Ir},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=k(t);var n=r*r;var o=Z(t);if(r<1){return o*Y(r+n/(D(n+1)+1))}return o*(Y(r/2+D(1+1/n)*r/2-1)+1/Ir)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(X(t)||t<-1||t>1){return NaN}var r=k(t);return Z(t)*Y(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=L(F(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=ce.ToUint32(t);if(r===0){return 32}return Pr?ce.Call(Pr,r):31-_(F(r+.5)*Ir)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}var r=L(k(t)-1);return(r+1/(r*Tr*Tr))*(Tr/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return L(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return F(e)*Ir},log10:function log10(e){return F(e)*Er},log1p:Y,sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=k(t);if(r<1){var n=Math.expm1(r);return Z(t)*n*(1+1/(n+1))/2}var o=L(r-1);return Z(t)*(o-1/(o*Tr*Tr))*(Tr/2)},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=ce.ToUint32(e);var n=ce.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<Sr){return r*Or(n/Sr/wr)*Sr*wr}var o=(1+wr/Number.EPSILON)*n;var i=o-(o-n);if(i>jr||X(i)){return r*Infinity}return r*i}};var Mr=function withinULPDistance(e,t,r){return k(1-e/t)/Number.EPSILON<(r||8)};b(Math,Cr);h(Math,"sinh",Cr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",Cr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",Cr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Cr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",Cr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",Cr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",Cr.tanh,Math.tanh(-2e-17)!==-2e-17);
h(Math,"acosh",Cr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",Cr.acosh,!Mr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",Cr.cbrt,!Mr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",Cr.sinh,Math.sinh(-2e-17)!==-2e-17);var xr=Math.expm1(10);h(Math,"expm1",Cr.expm1,xr>22025.465794806718||xr<22025.465794806718);var Nr=Math.round;var Ar=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Rr=mr+1;var _r=2*mr-1;var kr=[Rr,_r].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Ar||!kr);m.preserveToString(Math.round,Nr);var Lr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Cr.imul;m.preserveToString(Math.imul,Lr)}if(Math.imul.length!==2){ne(Math,"imul",function imul(e,t){return ce.Call(Lr,Math,arguments)})}var Fr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}ce.IsPromise=function(e){if(!ce.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!ce.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(ce.IsCallable(t.resolve)&&ce.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&ce.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=ce.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(ce.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!ce.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!ce.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!ce.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ae(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=ce.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=ce.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(ce.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!ce.IsPromise(n)){throw new TypeError("not a promise")}var o=ce.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=ce.IsCallable(e)?e:a;var d=ce.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Fr==="function"){b(S,{Promise:Fr});var Dr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var zr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,W)});var qr=i(function(){return S.Promise.call(3,W)});var Wr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Gr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Hr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Hr.prototype=Promise.prototype;Hr.all=Promise.all;var Vr=a(function(){return!!Hr.all([1,2])});if(!Dr||!zr||!qr||Wr||!Gr||Vr){Promise=Fr;ne(S,"Promise",Fr)}if(Promise.all.length!==1){var Br=Promise.all;ne(Promise,"all",function all(e){return ce.Call(Br,this,arguments)})}if(Promise.race.length!==1){var Ur=Promise.race;ne(Promise,"race",function race(e){return ce.Call(Ur,this,arguments)})}if(Promise.resolve.length!==1){var $r=Promise.resolve;ne(Promise,"resolve",function resolve(e){return ce.Call($r,this,arguments)})}if(Promise.reject.length!==1){var Jr=Promise.reject;ne(Promise,"reject",function reject(e){return ce.Call(Jr,this,arguments)})}Mt(Promise,"all");Mt(Promise,"race");Mt(Promise,"resolve");Mt(Promise,"reject");Ce(Promise)}var Xr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Kr=Xr(["z","a","bb"]);var Zr=Xr(["z",1,"a","3",2]);if(s){var Yr=function fastkey(e,t){if(!t&&!Kr){return null}if(se(e)){return"^"+ce.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Zr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Qr=function emptyObject(){return Object.create?Object.create(null):{}};var en=function addIterableToMap(e,n,o){if(r(o)||re.string(o)){l(o,function(e){if(!ce.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!se(o)){a=n.set;if(!ce.IsCallable(a)){throw new TypeError("bad map")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!ce.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){ce.IteratorClose(i,true);throw s}}}}};var tn=function addIterableToSet(e,n,o){if(r(o)||re.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!se(o)){a=n.add;if(!ce.IsCallable(a)){throw new TypeError("bad set")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){ce.IteratorClose(i,true);throw s}}}}};var rn={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!ce.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ce.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ke()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ke(n)}}this.i=void 0;return Ke()}};Me(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ae(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Qr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){en(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Yr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Yr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(ce.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Yr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(ce.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Yr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(ce.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Qr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Me(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!ce.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+ce.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ae(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Qr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){tn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new rn.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Yr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Yr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Yr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Qr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Me(i.prototype,i.prototype.values);var f=function SetIterator(e){this.it=e};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};Me(f.prototype);return i}()};var nn=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(nn){S.Set=rn.Set}if(S.Map||S.Set){var on=a(function(){return new Map([[1,2]]).get(1)===2});if(!on){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var an=new Map;var un=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var fn=an.set(1,2)===an;if(!un||!fn){ne(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!un){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var sn=new Set;var cn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(sn);var ln=sn.add(1)===sn;if(!cn||!ln){var pn=Set.prototype.add;Set.prototype.add=function add(e){t(pn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,pn)}if(!cn){var vn=Set.prototype.has;Set.prototype.has=function has(e){return t(vn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,vn);var yn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(yn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],yn)}var hn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||bn||!gn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var dn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var mn=Object.setPrototypeOf&&!dn;var On=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||mn||!On){var wn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new wn;if(arguments.length>0){tn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=wn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,wn)}var jn=new S.Map;var Sn=!a(function(){return jn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||jn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof jn.keys().next!=="function"||Sn||!hn){b(S,{Map:rn.Map,Set:rn.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Me(Object.getPrototypeOf((new S.Map).keys()));Me(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var Tn=S.Set.prototype.has;ne(S.Set.prototype,"has",function has(e){return t(Tn,this,e)})}}b(S,rn);Ce(S.Map);Ce(S.Set)}var In=function throwUnlessTargetIsObject(e){if(!ce.TypeIsObject(e)){throw new TypeError("target must be an object")}};var En={apply:function apply(){return ce.Call(ce.Call,null,arguments)},construct:function construct(e,t){if(!ce.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!ce.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return ce.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){In(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){In(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(En,{ownKeys:function ownKeys(e){In(e);var t=Object.getOwnPropertyNames(e);if(ce.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Pn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(En,{isExtensible:function isExtensible(e){In(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){In(e);return Pn(function(){return Object.preventExtensions(e)})}})}if(s){var Cn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Cn(o,t,r)}if("value"in n){return n.value}if(n.get){return ce.Call(n.get,r)}return void 0};var Mn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Mn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!ce.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ae.defineProperty(o,r,{value:n})}else{return ae.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(En,{defineProperty:function defineProperty(e,t,r){In(e);return Pn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){In(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){In(e);var r=arguments.length>2?arguments[2]:e;return Cn(e,t,r)},set:function set(e,t,r){In(e);var n=arguments.length>3?arguments[3]:e;return Mn(e,t,r,n)}})}if(Object.getPrototypeOf){var xn=Object.getPrototypeOf;En.getPrototypeOf=function getPrototypeOf(e){In(e);return xn(e)}}if(Object.setPrototypeOf&&En.getPrototypeOf){var Nn=function(e,t){var r=t;while(r){if(e===r){return true}r=En.getPrototypeOf(r)}return false};Object.assign(En,{setPrototypeOf:function setPrototypeOf(e,t){In(e);if(t!==null&&!ce.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ae.getPrototypeOf(e)){return true}if(ae.isExtensible&&!ae.isExtensible(e)){return false}if(Nn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var An=function(e,t){if(!ce.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){ne(S.Reflect,e,t)}}};Object.keys(En).forEach(function(e){An(e,En[e])});var Rn=S.Reflect.getPrototypeOf;if(c&&Rn&&Rn.name!=="getPrototypeOf"){ne(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Rn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){ne(S.Reflect,"setPrototypeOf",En.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){ne(S.Reflect,"defineProperty",En.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){ne(S.Reflect,"construct",En.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var _n=Date.prototype.toString;var kn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return ce.Call(_n,this)};ne(Date.prototype,"toString",kn)}var Ln={anchor:function anchor(e){return ce.CreateHTML(this,"a","name",e)},big:function big(){return ce.CreateHTML(this,"big","","")},blink:function blink(){return ce.CreateHTML(this,"blink","","")},bold:function bold(){return ce.CreateHTML(this,"b","","")},fixed:function fixed(){return ce.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return ce.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return ce.CreateHTML(this,"font","size",e)},italics:function italics(){return ce.CreateHTML(this,"i","","")},link:function link(e){return ce.CreateHTML(this,"a","href",e)},small:function small(){return ce.CreateHTML(this,"small","","")},strike:function strike(){return ce.CreateHTML(this,"strike","","")},sub:function sub(){return ce.CreateHTML(this,"sub","","")},sup:function sub(){return ce.CreateHTML(this,"sup","","")}};l(Object.keys(Ln),function(e){var r=String.prototype[e];var n=false;if(ce.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){ne(String.prototype,e,Ln[e])}});var Fn=function(){if(!oe){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var Dn=a(function(){if(!oe){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(Fn||!Dn){var zn=JSON.stringify;ne(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=ce.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(re.symbol(n)){return Nt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return zn.apply(this,o)})}return S});
/*! jQuery v3.6.0 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){var t=S.cssProps[e]||_e[e];return t||(e in $e?e:_e[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Be.length;while(n--)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,function(){return Je(e,u,n)})},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}}),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}}),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,gt(this)))});if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,gt(this)))});if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=vt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=qt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport(function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},n=i[e]=i[e]||[];return n.indexOf(t)==-1&&n.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{},n=i[e]=i[e]||{};return n[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var n=i.indexOf(t);return n!=-1&&i.splice(n,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],o=0;o<i.length;o++){var r=i[o],s=n&&n[r];s&&(this.off(e,r),delete n[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){if(Array.isArray(e))return e;var t="object"==typeof e&&"number"==typeof e.length;return t?d.call(e):[e]}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var s=e;return"string"==typeof e&&(s=document.querySelectorAll(e)),s?(this.elements=n(s),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this))):void a.error("Bad element for imagesLoaded "+(s||e))}function r(e){this.img=e}function s(e,t){this.url=e,this.element=t,this.img=new Image}var h=e.jQuery,a=e.console,d=Array.prototype.slice;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&u[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var u={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new s(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(h=t,h.fn.imagesLoaded=function(e,t){var i=new o(this,e,t);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/dist/FileSaver.js */
(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:500000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{display:block;border:24px solid transparent;border-radius:50%;border-top-color:#7f7f7f;border-bottom-color:#7f7f7f;width:100px;height:100px;-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite}html[data-init=loading] #init-loading>div{text-indent:9999em;overflow:hidden;white-space:nowrap}html[data-init=loading] #passages,html[data-init=loading] #ui-bar{display:none}</style>
<style id="style-font" type="text/css">@font-face{font-family:tme-fa-icons;src:url('data:application/octet-stream;base64,d09GRgABAAAAADLAAA8AAAAAWHgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABWAAAADsAAABUIIslek9TLzIAAAGUAAAAQwAAAFY+IEkIY21hcAAAAdgAAAG8AAAF3rob9jFjdnQgAAADlAAAABMAAAAgBtX/BGZwZ20AAAOoAAAFkAAAC3CKkZBZZ2FzcAAACTgAAAAIAAAACAAAABBnbHlmAAAJQAAAI6gAADv+gJOpzGhlYWQAACzoAAAAMwAAADYY1IZaaGhlYQAALRwAAAAgAAAAJAfCBClobXR4AAAtPAAAAJEAAAFMBfb/0WxvY2EAAC3QAAAAqAAAAKhjiHI5bWF4cAAALngAAAAgAAAAIAFjDA9uYW1lAAAumAAAAY0AAAL94+zEpHBvc3QAADAoAAACHAAAA11cG/YjcHJlcAAAMkQAAAB6AAAAhuVBK7x4nGNgZGBg4GIwYLBjYHJx8wlh4MtJLMljkGJgYYAAkDwymzEnMz2RgQPGA8qxgGkOIGaDiAIAJjsFSAB4nGNgZNZgnMDAysDAVMW0h4GBoQdCMz5gMGRkAooysDIzYAUBaa4pDA4vGF4EMgf9z2KIYg5imAYUZgTJAQDSIQumAHic7dTVbltRAETR7dpNCikzQ8rMzMxt/M39mHnsU1/TfZz5jFpaV7pXJunMDLAZmOqaZjD5y4Tx+uPTyeL5lG2L5zN+L94zG8+ztr7ulXH1fra4bvK9M79xiWW2sNXPbWeFHexkF7vZw172sZ8DHOQQhznCUY5xnBOc5BSnOcNZVjnHeS5wkUtc5gpX/f3r3OAmt7jNHe5yj/s84CGPeMwTnvKM57zgJa94zRve8o73fOAjn/jMF77yje/84Ce/WGPun1zi/2tlXKbp3Xyc44bFyZanSWokJDXOOjXSk/LUSXn+pEwCKTNBaqQqZU5IjX+XMjukTBEp80TKZJEyY6RMGylzR8oEkjKLpEwlKfNJyqSSMrOkTC8pc0zKRJMy26RMOSnzTsrkk7IDpGwDKXtByoaQsiukbA0p+0PKJpGyU6RsFyl7RmosQcrukbKFpOwjKZtJyo6Ssq2k7C0pG0zKLpOy1aTsNymbTsrOk7L9pNwBUi4CKbeBlCtByr0g5XKQckNIuSak3BVSLgwpt4aUq0PK/SHlEpFyk0i5TqTcKVIuFim3i5QrRso9I+WykXLjXOYNzP8BuAPUwHicY2BAAxIQyBz0PwuEARJsA90AeJytVml300YUHXlJnIQsJQstamHExGmwRiZswYAJQbJjIF2crZWgixQ76b7xid/gX/Nk2nPoN35a7xsvJJC053Cak6N3583VzNtlElqS2AvrkZSbL8XU1iaN7DwJ6YZNy1F8KDt7IWWKyd8FURCtltq3HYdERCJQta6wRBD7HlmaZHzoUUbLtqRXTcotPekuW+NBvVXffho6yrE7oaRmM3RoPbIlVRhVokimPVLSpmWo+itJK7y/wsxXzVDCiE4iabwZxtBI3htntMpoNbbjKIpsstwoUiSa4UEUeZTVEufkigkMygfNkPLKpxHlw/yIrNijnFawS7bT/L4vead3OT+xX29RtuRAH8iO7ODsdCVfhFtbYdy0k+0oVBF213dCbNnsVP9mj/KaRgO3KzK90IxgqXyFECs/ocz+IVktnE/5kkejWrKRE0HrZU7sSz6B1uOIKXHNGFnQ3dEJEdT9kjMM9pg+Hvzx3imWCxMCeBzLekclnAgTKWFzNEnaMHJgJWWLKqn1rpg45XVaxFvCfu3a0ZfOaONQd2I8Ww8dWzlRyfFoUqeZTJ3aSc2jKQ2ilHQmeMyvAyg/oklebWM1iZVH0zhmxoREIgIt3EtTQSw7saQpBM2jGb25G6a5di1apMkD9dyj9/TmVri501PaDvSzRn9Wp2I62AvT6WnkL/Fp2uUiRen66Rl+TOJB1gIykS02w5SDB2/9DtLL15YchdcG2O7t8yuofdZE8KQB+xvQHk/VKQlMhZhViFZAYq1rWZbJ1awWqcjUd0OaVr6s0wSKchwXx76Mcf1fMzOWmBK+34nTsyMuPXPtSwjTHHybdT2a16nFcgFxZnlOp1mW7+s0x/IDneZZntfpCEtbp6MsP9RpgeVHOh1jeUELmnTfwZCLMOQCDpAwhKUDQ1hegiEsFQxhuQhDWBZhCMslGMLyYxjCchmGsLysZdXUU0nj2plYBmxCYGKOHrnMReVqKrlUQrtoVGpDnhJulVQUz6p/ZaBePPKGObAWSJfIml8xzpWPRuX41hUtbxo7V8Cx6m8fjvY58VLWi4U/Bf/V1lQlvWLNw5Or8BuGnmwnqjapeHRNl89VPbr+X1RUWAv0G0iFWCjKsmxwZyKEjzqdhmqglUPMbMw8tOt1y5qfw/03MUIWUP34NxQaC9yDTllJWe3grNXX27LcO4NyOBMsSTE38/pW+CIjs9J+kVnKno98HnAFjEpl2GoDrRW82ScxD5neJM8EcVtRNkja2M4EiQ0c84B5850EJmHqqg3kTuGGDfgFYW7BeSdconqjLIfuRezzKKT8W6fiRPaoaIzAs9kbYa/vQspvcQwkNPmlfgxUFaGpGDUV0DRSbqgGX8bZum1Cxg70Iyp2w7Ks4sPHFveVkm0ZhHykiNWjo5/WXqJOqtx+ZhSX752+BcEgNTF/e990cZDKu1rJMkdtA1O3GpVT15pD41WH6uZR9b3j7BM5a5puuiceel/TqtvBxVwssPZtDtJSJhfU9WGFDaLLxaVQ6mU0Se+4BxgWGNDvUIqN/6v62HyeK1WF0XEk307Ut9HnYAz8D9h/R/UD0Pdj6HINLs/3mhOfbvThbJmuohfrp+g3MGutuVm6BtzQdAPiIUetjrjKDXynBnF6pLkc6SHgY90V4gHAJoDF4BPdtYzmUwCj+Yw5PsDnzGHQZA6DLeYw2GbOGsAOcxjsMofBHnMYfMGcdYAvmcMgZA6DiDkMnjAnAHjKHAZfMYfB18xh8A1z7gN8yxwGMXMYJMxhsK/p1jDMLV7QXaC2QVWgA1NPWNzD4lBTZcj+jheG/b1BzP7BIKb+qOn2kPoTLwz1Z4OY+otBTP1V050h9TdeGOrvBjH1D4OY+ky/GMtlBr+MfJcKB5RdbD7n74n3D9vFQLkAAQAB//8AD3icrXsLcFzlleZ//v+++nb37dfte/VotVrdrW5JltuKpO6WJVluPyXbsmOEbGRjO4KVjWPZlsM4QIU4IYGlgCE2yxqKIQkJg2GreKQCTCZb1CZkiswjzOwOmSTATNVWTZLdDUwSMrVDsomD23vOf69assFAqgbk+773P4//nPOdc/5mwNjFl8WjosbaWblmxiOmIlTGYXzb11M7Z2ohAMbZCcZ5iG9prZl4whfwGju05xtttitUdwXYEUgkbQtWga5lC+XBaqJI285qpb8dVEc8Gnm5L5QM/f58yAlB399a7dD0mWAmdAqaMvBmKPKX9TdDwSjod9yhx03FAPcvI6Gk2lV33XoXUtKgL8C6Wa0WSzXbVjhg6JoqIPShCK0FOvOuE48K1V4B1VUQAVevugmP7Fz2CmTzW5/8+ZGP/+Kp7h/8oI4MuOZ7M5B9IvujH2Wf+PnCAjzn8ZK6AieMKRcvXnxWWSWCzGARlPcqtqs21WZzEBFgYIVDAYWzVJIrXBlH+hXGlWNM00GAJmYZ8sKBzTJFVZVppijqDFMVdTIWLa0o5JrdaHusPZGIG1IjFhQGK2mAZEe56kJnR1bTY7ZT7eivFGODBTdma3pHtlCNDVbwmgMHx/aO4R8ffeet5/ZCG6TfuV03IaSJU3oIzKsGO9+5PV+BwU5xqnOQx1aO8fW71yvD9fPn55/fA22PmsaFvfSgwZ8wzPiFvZ2DUMnzJ2hHVDMmHucPsSRrq7UQo4DMAV/AW7CANw/Zru3NIx20bBEpXwukArlxxOPReibaG63/SyQyiftzcBy3k1HuOHgjEgFHnkYfh4VodDJC4138Ff8hv5PlWbrWmm2O6grNEgGNCWGnbFtRm1Z04gzQPPWvkqMWF4eWU8DB267Df+gNe84bBvfRpfNI5Ny5yAmHDh5/PPLuByMlekDS9DsRR73nWHetwBShSO5PqCBQONO4E2wGlSvYZG6gMzeQ09SWFZC0tWION3oOVVXGTbGM+hrAzQj0O25yoN8R8YzzRsaZdzLwhpsGPEm783hAJ9+kq286eDX5pn/VydDjvk7i8EuchU21JJ3DNOqFzeABmywPcNXxhu/wB+3whrqwVw7Cn1j8vPfdDH6O7PR3fDV/Cb85wua/waSit309grZJHHOhHEQ9CA7zTGVCUb0ZvXzc1lrRe5Af+4An0aSL9op0IU9y6vRFtAYGKy7KJGFbQrdg2dXqGAwWilld0zUy9xLqd6A/zeFuy7gzYFmBOwOhZ6NNhZakm8YTI7S1pyM1mM032V26qevXGlzZ8+TKvROlB/BBkO9ACDalB7OZuBnuC5tRcAItpalENNOfhajVH1A2a1HjbHZ4N4r54oWLz4qPoe4jrMo2sonapm5QRQBQ3XycKVxwRRxjQuVCnWc6mrzOZ5FvBiraOmia5FubYRpok8n0ioRTKOQMNbWiszxYWAFZrQ1sB+dDJTFYghzyiBN3oB857ndIAha4Se/+YGUtjAkXXUO2xPE2eoe3TWPeMOXmzNi+j9w1HghvVbSAmu4c6nFac6MgbzXFU2baDr1241+98TfHtU/9t7df+MzU4msmfPYj06Wbw8Gqohda0/FkSyiyvtPGG/FsMKq1pLqmPvndkye/+y+08eYIHEJZpFmJra2Nop/VWuKcCwPvgRhnGlOFps6iIdAEmFVAKh53jblZyBU6nAFdbfX03tGwioZ9oGnEyDSWTQCyFzhoR+s/jdjgWLmc3L2K21zEmXCsM5aDm4g9Ny5v0PZVb+dY9Rcd/sl5eTiPj0nTaeiU+BhhW2qbuzJcUy2Nc2gCrjBkxWCqZiArGgOuwSzjAlDb5L91XfpvfYbpij6ZRIUWYoVcLqC2+UqNLddsMrekY3GZztVl2uQjpl4xjedIM+Uybc/r5viShuHgcgXuwQtpuoMHz8utCe/s8S+Y/7xMaYu2DX1yDrez3lp3cyyKdop+HLcLi878Uh9SKOSlj73cOIUFRVKVKHhaSS9JP452RCcYoJ3w85bz8Ckp9VN4xeZj9atpH4FnPCV4OtiDNIVYCrWwsbauK81VxUlaQnA+riFBisoUsiU0LbQpASCmmRAwg1MNJoH19uQ6WpriUV1jIQjphA5QjosiTfiy1tF+kPJKMTFYpAu6lkx40odnTv7VjYtC/QtTJyGH9HmMnKamGrcaqmaagRsMUwR9WeLmwsQREvIRevSvYa8uVFXo9Sc0w5A8/Rp5+jcxhXLuYAOIx/pbY+ggFp0FV8lNoLNAEQvyDkwBZR9T1ZC6xR0qFgsybix3DJcR7iIGwCsCHHQM0nYKVSBXQZPnqG7KDZiqrn8K524gpN9ghAx42k4GsvF3nohnA0kbnglkC9mrl7h4Db2TommKcVE1QOPRd97K5WJxsKO5nIjHbHtx/og3kK8iWys1he/EkKlqCbFOB6iKQp5Q5Yp6DB0AsjmPvHEFSGsoFraPaVpI2zLc2lmudErjJ/eeQwbKPoRBZulcwhwXYc6i1SdiEpiCF+KrFOIrAzKaHdhQ79tw4MAGuJv4rt8sQQu80jloGnnDfNVJBa+vn1WjSg1d8NHrg44FbTgdJ5+T77yy/gDI5wY7633yTbI7+CdyMDyEL2paDd0BvZjyfIYXH2/H+aqjDfXUisgnk3rFYMePoyZBegWanQpM5hKdlUSU1JnoQH2iG1d90IYADi0JPV2/oxMEeB7apm+aBngFw/ObMjzHzv7dgzyOh48fHZnmO9c8Wv+2RAGwHiP20UNnzx46mvYxyaMixDpZX22lQqQgRDqG4kYcMo92cpypAOo0Ti+iSYXJRGc5l8wvQhPfqpE0SYa7nDwkeQyh26OOlbecqVumoCwJ8+mDm+9/5T4eOyOt+4wk8WjavYTIG+7nD5Li2cWv8zGkMYoz51q2u3Y1JQSwfcumSn9JUxW0CZIWQ5isqKCo8zoGFPybx/lyHD2w4AaCBw7Ap1HIxAaHyZlr1tXG1owMt7h5Ox5QmxF4Iv6vDhaQoTFAYADuYIlnLa7b7RwtiOBDtVK1dbyCMXXxn5azOIIKfLFKaQP9K3HKIMYEQosvhkIWH23TQ9wIpCq9M4WxycnJsQIUYrEJ/bPGuOZohfHVzdmMaAmHm418c7DU3xdoyYPebFktPJtpHu7fefjw4R0VHiNTa06ZUTPe09a1sdTUVNrYtbo3nth11VW7tBa1d/U1a1t71rdG2u1IJNkWDYdbUs0pnnFT+OloWzISsdsjqVpvy9prqrNjed41POfPx2+J7TIXaWP5Wgf5bvToBEvpppQYOXPOJoda4gTQE6TsNK8sAvUSSHBFygfnfM9wL+8aK/Bddv0tZ8SufyKZ7ml7s20iCWdsPpPu4YVaXuur/2M6WX8riReTE21vtPUAnn4iyTxdf0vJ+/QM0pwsUL4D5BmUBQEeXpaU4W6RtExzN1In7eT9qHPpIoUdqAzSrdyHIPo1JNRps1uioCWJyIm2U/JG8oO4aZMXozF8b4RupRd5JJv7Nn8ZeUyxjlrakhJHcwO2gHMUDgGLR0MmS0GrIoMRWos0K81LUnPZYgmkw6sM8HtCoQTaT9y0Wu3f/MZuCYfijhMPhUVQNdL2hY8kMroS/8UvEqqeSfC/xzPV07k3vsqyrL+2ykYnhJjEz45OLIdbu4ncrbrWhImzltU7oqqaXAEdMWiHxPsSdvuF70K6/xf6FejjL13YBvFVP+UXrkwnyelZjBcltoLypQIoEmsoiDUw4C2QFS/I/J6yx5ybWOOqaMad0kJlKo+ElAdLqvRTMqOsgucuM64j3hgHU1H1mIkQ084Oje3eXT1lZwL1nwaD0BZMNfFTcHpv+sf7v6LEo4oZMlRbFNqH9tb60nEN0UkQ0mYawZNpR878eFuD1lWsl/Jb9J5iMbPlDKnkh3raBmS66U1M9Jm5rKUmMel1dKLOcxrVSgf5dJqU4o0g0pJyTlV37x4bytpCATOG8VUT4+m9cPoURiakE34ZMes/wbB0Roun+2p7h9oLSlwzQqZq2eIr+xe2/Rhp5QF8hHn5Hh/FfM9ibs32UrNG+l22ZbrnJ8N+fERAcD6YCp6nuPc2Aq/vWXiMfzKaye/BDfzTLPwe33MT8ns4P/y0uiLBdyZw3qRvNvGZegjF6H+escXvreOnkD7zm7IkADTbJEkU4sdw1jmwzpTj42smHLB82ijenjfx9YsXkccR+B5+I1azGtQk+4maTpnLlsBL75E7O1IPea+mzfPmUwQt00FJoG+nPxN/zruZzZprTljyx2GpXiHdYWBZtcINeB+2xVP16/GT9euDwf00TbqgK5gK7QvCmfp/wPn15WDa3BcM1l/Hy8F9wZQ31nf4Q2IjjrXyG+BnzXnMmqXiTuB5CLa01gINjvb8mesSTwHuSAEtzm8anp+uvwbdprkfhUs0wCNIxH6TP1l/vf6aPDThK0TXI5I+tjj+SX/8wIcaPxWX4y+CqsCiEIiAIzhsKrgfh+6qv+4L4RETPl6/zqMKukki9AA96OseZb3Zk7UKVKxZKt65tpR1J9p1sTGgP5Z4ah+KEzl73R/xEfr+I8H5fchlN/Jr0n0c3fSGkrz+vbhd5m2ZWltThDeKUaKh3WTZXWauS+WomBdMkjGvOCRuT9YfcIZxk0x24/5cT3q8redxe8TpTsLn03b9LIaFo/I0eQ7uxtjQm6rffI4elnTcJfbwX/qRFyG+Vw+SaJdyFIpugk0WXCcnaZFo1323viNAWHZPvk1+ugfjTf2sbcPR5LDT442bhwPj6Z5z9qi9wr8B85Ji51yXb3tISxlpSUtaZEYnFX8ZbHI6C8vk4ll2h5/YdRQbM0CUbSmXHsd5rH5zWz7fBnc/5iA1NLANwyQZ2+5JjiYfQ4mle+BxJA1prT9g+770dv4zTz9RnTPp+JlY4DJKoroOucmyT4fnsGIeFC3H9EtmB+qnGyP6413tPvs4BhIwipskDKakeIg+KKTgbl92JBkkHn1J3c8t+9ia2vBKhMFkGBJtEjrGDIzKE1SeAgTJiDAVRYpKmSGwMlksJor5gUWgjKlXYS0gurS4neaYflXJnaWBUjDKNAVhkWoF1WhHz7uJ2PapE8NHJkulySPD62/qVmLapMq10a997JqvnphQarc8dO3UQ2smYr38pfOWszK6fTs+eBKfHy4j8t2uWNrWnbDx5CNfe+TkxrHVE/EEW4ynxM9H2FhtpAeE2tnGFUH1J4xXChxD5hACLNXbLgOA3WU353rI37Y44SipbwdxwED/mEC0rOmuIzmlGkw7SBzNxZ6NN3519+zXRhV1Uosp3TdtGD68s4eXJo8uzHVtjyXc85gC9MYmRh+euuaRk+vhAG43Tm3RLGW7Clp52Oesq3N7dKVjnW9KxCdWjyFvi/nUs+Ja5CnPxtn+2t4NnVwLrELw76JqDMz1MacMGJoR0I5RVsA1lR/DLEdonLJLQWnOMcSamKlrszLnWWZ3mzcVOjsrnYWynTfVNmQ6aQFxrWtL9SQtgjqsojbxf5lp+qquSF1rVGyk02qZZEEKRkPdlv9ff3LVQ6MTFMas8xSft3fNVbd+vqg1KaF5w7RwBsirUye24UVXDS3oIcj/nz+56mF6qQlUAQ++gGoNytcxFG7P98DWMXMoHIL/6l/Z7p1riv8ko2oiyiru129WsSrmUjO1XdtWc0Pr7miOoWOV9YUQ07WQPmsCisWYDge5puAUAI3NIk6EQACmaQ+BGRaAwOSemV1TH90+vnlDrZBNFOi/nEUlLL96lYx5VZLqB5zDQLFQzGm6KuUX89L6YqxRuaPsCwXYTlJE1EVJt9ycWTo8bereoW7Wv38ewfOzmgI/N42Kn53LatjTxUCv85zbEyg+Y5hTcDddq99M2ysc8/51lABfjZ++8KvSxvUlnpCj7U+mIG3vR8yhXSbXEbaB3cDmatdds4lrhi9Z8hskNo2hkI+RQHWN6fMIUwKGFZiNhDmCNq6BoR1gejCoTzNdD86woB6cPDh33YFr91w99dHJLePr1tp525NylKZkzJtthLplN+ADzhOxjpiN1trRPwb/vhKfqIcMg8Mr3DDqd38o4cM36y9KWa+Tsn7v4/ocj134Vcg2TZsf/ABFKH4tYwrtObZYYxoF3QiQC+PjATwUho5+W8MkQlOOqUDxnlMNjZpsfB8zjJCxZe2afKeTjXeuboqT2XcOlsACB6XROFhWch7AeNy/VsZfx4fO5Aj8EjTVRPjLdtrmTS1NX7Azce6kmjZnnHf+1iuBiG0duzsmQTiZPzfjEoTGAqZ7xqt/nmmai8gXOWb0/sG9z8vyyPNOZjKDf9DlRgmQR93keVlHOU/9RTkfH8W8ieTQzWpsc21DGRM0Xw4soAUWDEDPtMB0oS9I5qeXC0PhMySPyTWjuYFctn9JEgWLp6FSXdz71TeSgzuQBmnXVHPXGqWhIhXkF+H2lQXxVqiSO5OthN9CQQSazmBOhdycwSgoZRJvQ28Yz8SVltDiwd3PUxMLN9De1dWehinH5783RvA9xhpyoHgnWAfGvE3sqtqOFT25rGIoMB4GBa0NAaepg2KYyiwVijQqFKGtopEeUFFYgQCboj0jZ8cCk7U1Q2W3MBBLjMRi0SCKxO0od6gD6Muon6Q35JGLDZS9DEpfLNZTA4aqrmrD0rwHCAO8Cs/Ur4a3J0Lql9WU4RfBJiYySfg+cviqaczLvipt59LuhbjXflPdSuRLUUd/9VV422jRv6SF/NbehYrcQ1p2AZ6jd80L5+kSRwE3WV+OVGTs9GvnU6yLDbJsrZ2aE+iijskqPtuHgTAktgz0r+xtaUaslZRRH6FKlRJrBwO9bK+lef8YXipg7j8GSJjM+GRPmSApRv6n//T4VrH3qqbRaNxoqoxSNMfwD6MV18yPulftrX+xZ7gXeka7vMCPgf2aQ8+N4bPuaKz7lg2LIGjjTT3x4T4jvubPYKL+cFtPTxscwm0DA+yVNaMjbFNt/cE9k+sUpoxgas8Gu1qjhG7GqUu+oAFel8B2gTDcgt+54If2XXv1VVsmVvRkM4m4TnnrYCGLtt5foc4F2rWO/NrIbxENvBHUy0WJBYqEg8hbyklAxoATvupfHMCZ3wAHaASEAFz/Y7pUPh+ZumWK7z65G1KGftgMJro0NbIzrOvbm1sCuhL9tBGKtrof1aLaZkdRjS4zYhzSDTDVw4bldnrPGtubWgKGiH0adR1JuR9VI/qErSgB72HMk0emp2+anr6F7kfTydZ+zdKSO0EdDRuTqaip3xAIjapaLa1aWqg/kmqNQEiXzza3ZFbqId3euezR4Iiqbkj5j7ZEIeTX7X4n9vLvLmKL2mAXILVUp0WPoyLCVJVGQ+/yNlGhjP8PNLq4y9vNy9rPrn+eW36OaPmdX0nTF7EIpu9XPlvW1XMgOiHbSHIL1ji1nsbpBdbAyXtlTRwjSHuCqyJvkjfAVEiMe317oeLEURlNKa/CI7tfVLxLp5qb4tFwUFVYJ3R6/STHqy1Xi1R9RLvvd6lSPIba14rZoo6zwa3w/7L18OGzRwC+N7B52+HD2zYPfA8OP3iIH9kyjkd4Fdwj9x85skUPzfXhQd9cSN96mB+97yjgoYUXvZ7kxYu/UW7mL7Eo+rwKK9byTKWsSWWz6N8VBaZxB5ShgDJZHerscm0J6L1at2fNGPH4CqQNZ+gAGTeaPZVNBB52IJ7nt/uI3N/B0707Do+8vmEH37rpdTLX8eEDd47Xr564Y3aIj+67azM8Q4dwYHjpHbJoOu1/8OkH++lk4s59Y2Lo+tsevG1ukA/N3uHb9f9TbkFebNRET61I/GEuOEtdCkxKcdfISpPptmSn01kdVNF4Y4NjHF1rWnh0cxWZKImsJdKcKPPIkZR5RIoYkcJ7dh665dDOHqV/4jgc2ILXkYz77zgwypGsH1zKst/L+ir6nJVsPdtR2zaC4aQTZC9CR4p0jigDQ6gmexJcUeeXdbS0xY7WslzDdpPF8uryAPX0L+tqoVNFD5QrFi7rbKGXwYnkJGCpwra4XMZe1th6JZcOCL0VgV445HepqL+l5jVdKMHP1VeH89a/WtYaK2/9Z/g4noyFYduzjf6WpSS0FIKDRovrC4aaQ9ZArQ9b1r/K58P0Yhi/4Msl4WPhFbUuzCTBb1OitsjmCVsAn+Qs3eokTJ1FeEQlI1nGXNlfnbS8tcc/sYz4wU8vsbd+lr/UII5u7mncOYBJ+WKc+5jsETe/L03AXCfmN4IlTVnCOYiVSxyWr5h45up7d/Lpu568c7ey4zRcu6yjzk9P3Xvu3im5qb9yaf98ab2AwZIsy0Zrq6nXxkG22zi121ScGiC71IoiZwcZqlAmzUCmvaU5GgkkzaQfoNCjlKimWnxvGhtR5b4r0roYFX59BZLFsvVB5NMRIVAGQ65bJoBsRuaFbLJM/0n3nZCLlZaWYKj+efWy88WezKv+yiG5dKnN23mX2uUJbi5bY+Rc4XgxBrHXGnlYb637gwLPEuXVBmD1ViiIyzgRfl5f9NddvfoB9NDxw0clWD9KV0FbdhMMjzfc+H7uJXEG8fo6Ns4O1q5fU+KCCq16PhXG3JuJcczFw6GwEaLSBXkQwNwF4DgLs1AgHDqA2FToAXEgCDpj+jTudDaDgUmnGsaG9bWx1UOVctJGzBlDf2HJWgZyh1HHkeV53RK5WC6Gc8fr45AzKSByxwlWHShTsxydSgfVLhALUZsXOiS8w0TlVOdJ006bC4ZayA43j7cN9WCqeCgYDTvGJzKnKG0Jn7ou6KSC18Frs8FUk2Jch1frv65/kWLdMMbf2fWfDKac4HFdaYpb8HY9ZDXZhnEylEgHP7t2L6YMcO46M22b111HA113zoFBDJQUpy/WLx6B36K+MxQdmlHBKerm0BIJKqUu68GgoLY0VSpexdChJiDC1WpC9qwK1cQYpS7U0BW0JAzeMrX6P+hRI2Dy4z/hqqmb4gS3jG8GLT77P1Ue5E4wfOFTFoioAS8NYVYZhv9umJapaPV6hct6wHdkHiowcqVYnvUivt5Qa+3vK/X2dBXy2Uy6pclBE4pR4XkwxWHTtq93vH+tv0l2U6pFvbNRePWrv51uBFbBWmgHbw/upXv+0LnRc1AxL/RjLrVgmvx/yP0Fq1KJxarV2A+PHct2HDvWwbvxJIYX60/THfzHrcdGH7shQm/iC2l6E/fXRumtaPU/ybeyx+p34UkVL0LJv9PAUHOomzL1w8q9uZaYoV3SIOoujHBKKii60eKMxhJHXUMgTQW0InVqqErq22AbYN6BHOMkFCMtlpWLDDc/0NM23tYLZ1uGMX5ZrWfPtkQj+chQ61lZiH+gZSiai0Sbz4JhDbeswXd2PSVr8E/twqtr8KXdu690Q2KpI6jHMMuhBjdRdbG9iQslEae6YVhDV7gBdOiHgK4iKtSERkv4yOpAP8ZMpimmNqtSRuUFG50FDD2AeaYRNrasGS0P2LTwuGDncpRJNtZ5Fpev85SVhMY6T3ewBJrtjAFIs8XZi95eSXOXLJkW75wKaXmE7afkst1TsjBDJxP3v3I//kG6Z9R+ce7WnfcfrvHRo6fPnT46CpteTMJZ7yXKMb2XTlHieMpspgUYLz+k3UsJV/LFTWNH7vvT08eHlfWHHtx+69yLSbZMRhHWhDn2SG0oYCC3qE/B0qAKuZqPg+b5XkErlwWmYkKlMkNY2eLmUAqF3OJinmKjrPIhuK1/W/IJ6z8kh5K1D2aK+/UTWqOzkz1fC4xVOgKKKqgjZqKV9nhTGGOgUGnZjiK4Mq8jJFKOMwJ0UxSLdlO/Ymvrtq8H3/UG+nBNcG0e7Vh79xt/yOf37KklDMPYaeyc3LZ1y8hwT671KoP8BApooL9agOqYUm2FATeRptTcdeQGxexmC3pWyw2u5ZSr4l9xsLCKW+DaaeqxVskXZql+XdTggY9NDrcHk331MoTzqZSj3fGlCe3GxJQT6IsGjeBkQOGQO53v+VKSb9E1EVMQ5vKs2/R7axiimWAmiVCh4/MZ1eYrecvvMWx9oa71KppmNkVhBs6G6m+veHkw8amOFi0QFY4pTI7RrikRxSd1jgBaCeytDEHmYSsUN/HTEEyqQVQ6ppY4937ER/nPmMXaWK6W8TvQy1cj+s28wcIlS70LHqQsSoS5rB18abP70ubwv0VMqrRhJALnb2SJXZ76vg7pAPc9++oF2+s8XzLyZUMt/3ajhy35encPGy4n+lIy4Xvvou1JERMJFmTa8zqHldSwlaBa9k6VC63heDzM/3cYttfndDMiKlbIwCN7eV2F8FS61toUNZhCzHltUoKChwg/yah6WVnr8jIXJer+ultoizj14CWn/GfvvEU5uIjTdtnx8nw86K1TlzWF5QsXBhYXGlw+3rLk/5IB/G8+gzZuYUagPa8ByoUaWfiRIuA35I4CrJOMVariLtOCaKD+Ryq3gvWTwSDci1AAfVtQi7zzsmWE4F5Vq/+RPKDe8714vX5SVSVGuXjxa2K/iCyN42qyOkbLkXwt6FIjmt5sRsHC11VB2yANZQl1HL+GWjFC9Em4Vx7Q2oKTeB2+oKkeL3xEkBU015zWlri4VEBrpICIlwZ7Eso2mgSVKs8GLeJN5YsLnmn7Lh7/45KS6ncSg5I/Por8NcaWi7UW27Te2JeyTGPqPg3VS9j2CzJyeznjn1qaGXCrpsq8ro655n7+1zi3WwkBRkGuRl5e3eMyi6L0TvDJcnYwTnM14fWG5Xyh5nXVLya56BmNJRUi25oYoiGRJBGXdaO+Rb1Y9R861mlZYzodsf21K8/wZ1mC8I75Hr9viTsF+fsW5BzxTSO1IFQNz6DJvnC/lPv9L6Ab4KcvfJU6gC94y9NfMP31s7i5XY5RIn6LJqKRxjAKDuOVppiQA65ycUhaEvVeQya8dVuF6uCYKClVFADVGd5FyGt9RTWAAgg50ahiNFm2YkcCarHv3QTW/6Jna0TY0VA0FEpnMkbciKJ0RGSrrMN/XzzKfy7p3saOsq21cUl7FVQ2Dboqxg8D38S4hnxooL2bGRU1qurqAtP1Q1M7xzd3Sd4MKlx9aN7cxtWq/1OQAi25ohrK0s0ilVHwbgmKVNGWD1T/IMmcmd2u68h5MhPsLpW6Mf7ZEUPfceC+0zfhdXy9uTm5cQffujnZrMQFzmZdv+n0HyDOnl33Z4RjOcFoIL338N50IIpBxBEd9+2+7fV+vGGHQ5Y18NCTDw1EwkITYRu/JwZe9fPMI+IfxFUsyjbSqvKhAcwt168pdedsTBbTzZxTnRzRxQyV/if8uggP8y2VcpqWw7iyTmgJOy3GuEu5oK35P5xC0L6GZFag308hopD9/6r3KyoE7rKG5Tqi3D9z8s6TM/3+7mEeeCxiPDanxdWDjxmRxwKIeebmVFVePajGtTl5VaWLcGDdLdMVpbTvxD0n9pWUyvQtew1RfioQFOU/1vU/Lotg4KmyMEz9nnuM2OINTVu8ETPuuUeXPuNZUcFYEmd9rFRbYSxfVUjLiN9dFerqyvd2yKWFBEEB548Fup3m1PWnBQHUERnjyKYur0O1v1pBfvl30u2Hnj4EwydOw/CBOyd23vd4+YefpuUbvHb84elmO9HXD1P3Tq1f48YM5VZ17msH5/d1fPtmWQndeOwTd1EnZNeXbtwsoBRbcbJ29T3T0GbGDO+3J95aen6KxViWDVCHL8i5wsPAxPLfE1FDb55RmQnmCYgrEoijOyX+6KeDoE66Tt5ONjkSgheKBA9LqL6qpqchU0E7QaSYtJ3+irSVimrrmpLJU3ej0gsK6vTRXbdlEXtnb9u17Z9B+Un9m9Hg5rmoE93YF4zCPwZ31H9b/6f6b3cEgzvAgAIYO4IwfMe64Q03nOX3fXzD8Lo7brzrLtiCz85tCkajwb6N0b9LJD738MOfSxTs2x7mj3yGsEgjzzBYB9Xw2hGCYAZOzYWG2uR6nFlvxlJeEZfO732ziNsX84be4ffMGz7/gRmQb1dyTX8Q/dtArU8Hb8Wybmgod53NBlQOilxbg9mPCIstK3sTAzE7O5BMJuTKkvJgwfulBskXM0CBMymXLQrpkSoDMVmJ6aA2QjGG4SJkRk38g5sd61dtYGoQ4St+jHY+U23r4aVWOEjtseoMnDgvfwCEm2+hp6r/X91AK4zYkU3HMVEaxnR3qBfqPzn+/wHPnsOreJxjYGRgYABi1vIsoXh+m68M3MwvgCIMt5YoxkDp2P9f/2exVDAHAbkcDEwgUQAz1Qu/AHicY2BkYGAO+p/FwMBS9v/r/68sFQxAERQQDACh8QbyeJxdT0sVwzAMy49AkAxAkbT3UQiAITGAISmAYQiA9th4ttUs7Q568UeSlVidiwSkB3PUPg+ESd6ZD/+8v7HyrtzwghY89ZB6BcyrYqc6RZhw48YhaA1Wc/v1PQtdeXJ/HppUmFM597nvBVK7D+Z+E8/uQZLBgDyaz3Llvxx02S3c/Hv813JrznryZP4F+6lSfQAAAAAAAAAAUAC2ATABaAGyAfoCJAKwAzYDmgQSBFwExgUyBbQF/AZOBvwHRAe2B/YISgigCPIJGglCCWQJignACgAKQAp2CroLAAtGC4oL8gxcDPINng5iDuYPag/6EF4RIBGGEeQSShKYEyQTbhOyFAoUYhS+FVoVphYoFooXHBeGGFoYnhjGGOwZChlOGXgZrBneGhwaWhqgGtIbLhvyHHQc2B1QHZ4d/wABAAAAUwBtAAYAAAAAAAIAIAAwAHMAAAB2C3AAAAAAeJx1kN9q2zAUh39q0441YxcbjN3tXJWWEcc1lEGvWkLbXZeSu8JUV/6T2VKQlY48w95ifYa9zt6jd/vFESUUYiP5O5/O8ZEE4AP+QWH9nHKsWeEdozXv4A0uIu/Sf488IN9G3sMQPyLv0/+MfICv+BV5iI/4wz+owVtGM/yNrPBZfYm8g/fqW+Rd+svIA/Jd5D18UovI+/S/Ix9gqp4iD3GoniduvvR1WQU5mhxLlmap3C/FUdVWN6IXoXK+k3MpnA2maVySuza0ZlToUZ07292YctFov6k2eWp8VzsrJ0m6qa+NNV4H87Dq1j2WWQiFFN61chX7yNy7mclDUoUwPxuPN/tjAoc5lvCoUaJCgOCI9pjfDGk/BPfMEGaus2pYaDQ0GgtWVP1Kx/ico2BkaQ0zGnKCnHNL09KNuK451721rLqhLfmfht5vzdrmp7Sr3nUfC07YL92afU1r+wrd7/Dh5WwdHrmLjDawanUK3+9acPXqPML7Wq3NaHL6pL+1QHuGMd8t5/8PvPGO3QAAAHicbZLnlpswEIV9DRiwvZtseu89Ib333vvmBWRZYMVC0pHEEufpg8BO/kTncOfTaLgMOtPr97o17P1/baKPACEiDBAjQYohRhhjDevYhu3YwA7sxC7sxh7sxT7sxwEcxCEcxhEcxTEcxwmcxCmcxhmcxTmcxwVcxCVkuIwruIpruI4buIlbuI07uIt7uI8HeIhHeIwneIpneI4XeIlXeI03eIt3eI8P+IhP+Iwv+Ipv+I5N/OiF1hEz9JKxUrtFrDl1lWF9NR9QIikToRaVjUouKxvOmNBjLxnlhgo2DbnM1djLKrNGnGPScSUzItzGv93yPP2bSQSX84z9cqFQdJ56yZRmMhW8mLlJJSaBI0XYPDaZKDUviZmvr6DrNjJMi0WcK1MTM02mqpbZlJtEsNx5SI238jSodJtoS7qv+BpPw67IY9xU+dg5TXjROTWwdGrIOzWhT+uA0jolxqjaZrSOnCF2Nmq16651EYpMm1fakAul9SJQeR5QVYQlk1VkZ8SwoVNFIVjWnKQrlBGdMToftdoZjrs77DajqXKrS02YEFxbbtdWkG0x44JJVUS5aBqKSlJwmhDrmOF2Hv9Wqsy4TNqoKhfmSrrQKuNSL5nvPG6p0s0AkEWkSWVZMy1Kx3ljk03qLuZ14lTmB8gNGmByGrGfjLrhlhJV2f7SaIneNF1ypQNbybBUSgZswQaWEUNngeay1/sD4l/60HicY/DewXAiKGIjI2Nf5AbGnRwMHAzJBRsZWJ02MTAyaIEYm7mYGDkgLD4GMIvNaRfTAaA0J5DN7rSLwQHCZmZw2ajC2BEYscGhI2Ijc4rLRjUQbxdHAwMji0NHckgESEkkEGzmYWLk0drB+L91A0vvRiYGFwAMdiP0AAA=') format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:-webkit-full-screen{height:100%;width:100%}:-ms-fullscreen{height:100%;width:100%}:fullscreen{height:100%;width:100%}body::-ms-backdrop{background:0 0}:focus{outline:thin dotted}:disabled{cursor:not-allowed!important}body{color:#eee;background-color:#111;overflow:auto}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}a[disabled],span.link-disabled{color:#aaa;cursor:not-allowed!important;text-decoration:none}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em;resize:vertical}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input[type=range]{-webkit-appearance:none;min-height:1.2em}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;margin-top:-5px;width:33px}input[type=range]:focus::-webkit-slider-runnable-track{background:#222}input[type=range]::-moz-range-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-moz-range-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;width:33px}input[type=range]::-ms-track{background:0 0;border-color:transparent;color:transparent;cursor:pointer;height:10px;width:calc(100% - 1px)}input[type=range]::-ms-fill-lower{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-fill-upper{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:16px;width:33px}input:not(:disabled):focus,input:not(:disabled):hover,select:not(:disabled):focus,select:not(:disabled):hover,textarea:not(:disabled):focus,textarea:not(:disabled):hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error-view{background-color:#511;border-left:.5em solid #c22;display:inline-block;margin:.1em;max-width:100%;padding:0 .25em;position:relative}.error-view>.error-toggle{background-color:transparent;border:none;line-height:inherit;left:0;padding:0;position:absolute;top:0;width:1.75em}.error-view>.error{display:inline-block;margin-left:.25em}.error-view>.error-toggle+.error{margin-left:1.5em}.error-view>.error-source[hidden]{display:none}.error-view>.error-source:not([hidden]){background-color:rgba(0,0,0,.2);display:block;margin:0 0 .25em;overflow-x:auto;padding:.25em}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error-view>.error-toggle:before,.error-view>.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before,a.link-external:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0\00a0"}[data-icon-after]:after{content:"\00a0\00a0" attr(data-icon-after)}.error-view>.error-toggle:before{content:"\e81a"}.error-view>.error-toggle.enabled:before{content:"\e818"}.error-view>.error:before{content:"\e80d\00a0\00a0"}a.link-external:after{content:"\00a0\e80e"}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}@media (prefers-reduced-motion:reduce){.passage{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-core-macro" type="text/css">@-webkit-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.macro-append-insert,.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-prepend-insert,.macro-repeat-insert,.macro-replace-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-append-in,.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-prepend-in,.macro-repeat-in,.macro-replace-in,.macro-timed-in{opacity:0}.macro-type-cursor:after{-webkit-animation:cursor-blink 1s infinite;-o-animation:cursor-blink 1s infinite;animation:cursor-blink 1s infinite;content:"\2590";opacity:1}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:100000;position:fixed;top:-50%;left:-50%;height:200%;width:200%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:100100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog>*{-webkit-box-sizing:border-box;box-sizing:border-box}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:92%;height:calc(100% - 2.1em)}@media (prefers-reduced-motion:reduce){#ui-overlay.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-overlay:not(.open){-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-dialog.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-close{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}</style>
<style id="style-ui" type="text/css">#ui-dialog-body.settings [id|=setting-body]>div:first-child{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.list{padding:0}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999;speak:none;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves .datestamp{font-size:75%;margin-left:1em}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-desc],#ui-dialog-body.settings p[id|=setting-desc]{font-size:87.5%;margin:0 0 0 .5em}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:1em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.settings input[type=range][id|=setting-control]{max-width:35vw}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}@media (prefers-reduced-motion:reduce){#story{-webkit-transition:margin-left 0s;-o-transition:margin-left 0s;transition:margin-left 0s}#ui-bar{-webkit-transition:left 0s;-o-transition:left 0s;transition:left 0s}}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-debug" type="text/css">#debug-bar{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:0;margin:0;max-height:75%;padding:.5em;position:fixed;right:0;z-index:99900}#debug-bar>div:not([id])+div{margin-top:.5em}#debug-bar>div>label{margin-right:.5em}#debug-bar>div>input[type=text]{min-width:0;width:8em}#debug-bar>div>select{width:15em}#debug-bar-toggle{color:#eee;background-color:#222;border:1px solid #444;height:101%;height:calc(100% + 1px);left:-2em;left:calc(-2em - 1px);position:absolute;top:-1px;width:2em}#debug-bar-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-hint{bottom:.175em;font-size:4.5em;opacity:.33;pointer-events:none;position:fixed;right:.6em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}#debug-bar-watch{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:102%;bottom:calc(100% + 1px);font-size:.9em;left:-1px;max-height:650%;max-height:65vh;position:absolute;overflow-x:hidden;overflow-y:scroll;right:0;z-index:99800}#debug-bar-watch[hidden]{display:none}#debug-bar-watch div{color:#999;font-style:italic;margin:1em auto;text-align:center}#debug-bar-watch table{width:100%}#debug-bar-watch tr:nth-child(2n){background-color:rgba(127,127,127,.15)}#debug-bar-watch td{padding:.2em 0}#debug-bar-watch td:first-child+td{padding:.2em .3em .2em .1em}#debug-bar-watch .watch-delete{background-color:transparent;border:none;color:#c00}#debug-bar-watch-all,#debug-bar-watch-none{margin-left:.5em}#debug-bar-views-toggle,#debug-bar-watch-toggle{color:#eee;background-color:transparent;border:1px solid #444;margin-right:1em;padding:.4em}#debug-bar-views-toggle:hover,#debug-bar-watch-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle,html[data-debug-view] #debug-bar-views-toggle{background-color:#282;border-color:#4a4}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:hover,html[data-debug-view] #debug-bar-views-toggle:hover{background-color:#4a4;border-color:#6c6}#debug-bar-hint:after,#debug-bar-toggle:before,#debug-bar-views-toggle:after,#debug-bar-watch .watch-delete:before,#debug-bar-watch-add:before,#debug-bar-watch-all:before,#debug-bar-watch-none:before,#debug-bar-watch-toggle:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#debug-bar-toggle:before{content:"\e838"}#debug-bar-hint:after{content:"\e838\202f\e822"}#debug-bar-watch .watch-delete:before{content:"\e804"}#debug-bar-watch-add:before{content:"\e805"}#debug-bar-watch-all:before{content:"\e83a"}#debug-bar-watch-none:before{content:"\e827"}#debug-bar-views-toggle:after,#debug-bar-watch-toggle:after{content:"\00a0\00a0\e830"}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:after,html[data-debug-view] #debug-bar-views-toggle:after{content:"\00a0\00a0\e831"}html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid:after,html[data-debug-view] .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]:before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript must be enabled to play.</noscript></div>
		<div id="init-lacking"><p>Browser lacks capabilities required to play.</p><p>Upgrade or switch to another browser.</p></div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<!-- UUID://E6BB8700-CDF1-4F0C-8375-398067E1F8E6// --><tw-storydata name="FTAG Twine" startnode="509" creator="Tweego" creator-version="2.1.1+81d1d71" ifid="E6BB8700-CDF1-4F0C-8375-398067E1F8E6" zoom="0.6" format="SugarCube" format-version="2.36.1" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">/* Removes fade-in between pages. Should be removed */
.passage {
	transition: 0.25s linear;
	-webkit-transition: 0.25s linear;
}
.cell{
  outline: grey solid 1px;
}
a{color:#000066;}
a:hover{color:#003366;}
#lowerGrid
{
  display: inline;
}
#upperGrid
{
  display: none;
}

.dark-theme {
  background-color: #121212;
  color: lightGray;
  background-image: none;
}
.dark-theme button {
  background-color: #121212;
  color: lightGray;
  background-image: none;
}
.dark-theme button:hover{background-image: none;}
.dark-theme button:active{background-image: none;}
.dark-theme input{color: white;}
.dark-theme input:hover{background-color: transparent;}
.dark-theme input:not(:disabled):focus{background-color: transparent;}
.dark-theme input:not(:disabled):hover{background-color: transparent;}
.dark-theme select{color: white;}
.dark-theme option{background: #121212;}
.dark-theme select:hover{background-color: transparent;}
.dark-theme select:not(:disabled):focus{background-color: transparent;}
.dark-theme select:not(:disabled):hover{background-color: transparent;}
.dark-theme #ui-dialog-body{background-image: none;}
.dark-theme #ui-dialog-titlebar{background-image: none;}
.dark-theme a{color: #68d;}
.dark-theme a:hover{color: #8af;}

#actionGrid{
  display:grid; 
  width:100%; 
  height:210px; 
  grid-template-rows:70px 70px 70px; 
  grid-template-columns:33% 33% 33%;
  /*background-color: #222222;*/
  background-color:rgba(22, 22, 22, 0.5);
}

#scenery{
  position: relative; 
  display: flex; 
  justify-content: center;
  width: 289px; 
  height: 426px;
}
#background{
  position: absolute; 
  left: 0; 
  top: 0;
}
#enemyPortrait{
  position: absolute; 
  bottom: 5px; 
}
#ui-dialog-body{
  background-image: url('images/bg.png');
  background-repeat: no-repeat;
  background-size: cover;
}
#ui-dialog-titlebar{
  background-image: url('images/bg.png');
  background-repeat: no-repeat;
  background-size: cover;
}
html, body{
  width: 100%;
  height: 100%;
  margin: 0;
  color: #000033;
}
body{
  background-image: url('images/bg.png');
  background-repeat: no-repeat;
  background-size: cover;
}
.row {
  height: 100%;
  display: flex;
  flex-direction: row;
}
input{color: #333366;}
input:hover{background-color: transparent;}
input:not(:disabled):focus{background-color: transparent;}
input:not(:disabled):hover{background-color: transparent;}
select{color: #333366;}
select:hover{background-color: transparent;}
select:not(:disabled):focus{background-color: transparent;}
select:not(:disabled):hover{background-color: transparent;}
button{
  background-image: url('images/buttonUp.png');
  background-repeat: no-repeat;
  background-size: 100% 100%;
  color: #000033;
  border:1px solid #444;
}
button:hover{
  background-image: url('images/buttonHover.png');
}
button:active{
  background-image: url('images/buttonDown.png');
}

#story{
  height:80%;
  width:100%;
  overflow:auto;
  flex-grow:0;
}
#passages{
  font-size: 16px;
  padding-left:3%;
  padding-right:3%; 
  padding-top:1em; 
  padding-bottom:5em;
}
#bottom-bar{
	position: fixed;
	left: 0;
	bottom: 0;
  	height: 5em;
  	/*min-height:5em;*/
	/*background-color: #222;
	box-shadow: 0 0 10px 0 #333;
	border-top: 1px solid #444;*/
  	background-color: transparent;
	z-index: 40;
    line-height:1.5;
	text-align: center;
  	width:85%; 
  	margin: auto auto;
  	flex-shrink:0;
}

hr{border-color:#444;}

#leftBar{
  width:25%;
  z-index:50;
  /*background-color:#222;*/
  background-color: transparent;
  border-right:1px solid #444;
  text-align:center;
  line-height:1.5;
  overflow-y:scroll;
  overflow-x: hidden;
  padding: 5px;
}
#leftBar button{
  /*line-height:inherit;
  color:#eee;*/
  /*background-color:transparent;
  border:1px solid #444;*/
}

#rightBar{
  /*width:30%;*/
  /*max-width: 289px;*/
  width: 289px;
  z-index:50;
 /* background-color:#222;*/
  /*background-color: transparent;*/
  border-left:1px solid #444;
  text-align:center;
  line-height:1.25;
  overflow-y:scroll;
  overflow-x: hidden;
  padding-right: 2px;
  flex-shrink:0;
}
#rightBar button{
  line-height:inherit;
  /*color:#eee;
  border:1px solid #444;*/
  background-color:transparent;
  width: 100%;
  height: 100%;
  font-size: 14px;
  padding:0;
}
#rightBar button:hover{
  background-color:#444;
  border-color:#eee;
}

#story-title{
  margin:0;
  font-size:162.5%
}

#story-author{
  margin-top:2em;
  font-weight:700;
}


@media screen and (max-width: 864px) {
  
  /*#lowerGrid
  {
	display: none;
  }
  #upperGrid
  {
	display: inline;
  }*/
  #story{font-size: 13px;}
  #leftBar{font-size: 13px;}
  #passages{font-size: 13px;}
  #rightBar{
	font-size: 13px;
	width: 268px;
  }
  #rightBar button{font-size: 11px;}
}

@media screen and (max-width: 768px) {
  
  /*#lowerGrid
  {
	display: none;
  }
  #upperGrid
  {
	display: inline;
  }*/
  #story{font-size: 12px;}
  #leftBar{font-size: 12px;}
  #passages{font-size: 12px;}
  #rightBar{
	font-size: 12px;
	width: 240px;
  }
  #rightBar button{font-size: 10px;}
}


#response-output {
  color: blue;
  background-color: white;
  border: 1px 'solid' rgb(59, 59, 59);
}

.chatbot__overview {
  background-color: #363636;
  display: flex;
  flex-flow: row nowrap;
  align-content: space-between;
  min-height: 40vh;
  max-height: 68vh;
  margin: 0 auto;
  padding: 1em;
  padding-bottom: 0;
  border-radius: 15px 15px 0px 0px;
}

.chatlist {
  list-style-type: none;
  font-family: inherit;
  font-size: 1em;
  display: flex;
  flex-flow: column nowrap;
  align-items: flex-end;
  overflow-x: hidden;
  width: 100%;
  max-height: 75vh;
  margin: 0 auto !important;
  padding: 0 !important;
}
.chatlist .user_input, .chatlist .bot_output {
  padding: 0.85em;
  margin: 0.5em;
  max-width: 100%;
  background-color: #fff;
  border-radius: 5px;
  border-bottom: 1px solid #777;
  color: rgb(83, 83, 83);
}
.chatlist .user_input {
  box-shadow: 1px 1px 2px #666;
  border-top: 4px solid #CC8914;
  margin-left: 30px;
  opacity: 0;
  animation-name: animateBubble;
  animation-duration: 400ms;
  animation-iteration-count: 1;
  animation-play-state: running;
  animation-fill-mode: forwards;
}
.chatlist .bot_output {
  align-self: flex-start;
  box-shadow: -1px 1px 2px #666;
  border-top: 4px solid #27ae60;
  margin-right: 30px;
  will-change: auto;
  height: auto;
  opacity: 0;
  animation-name: animateBubble;
  animation-duration: 400ms;
  animation-iteration-count: 1;
  animation-play-state: running;
  animation-fill-mode: forwards;
}
.chatlist .bot_output:last-child {
  display: none;
}
.chatlist .bot_output:last-child {
  display: block;
}


@keyframes animateBubble {
  0% {
    transform: translateY(-20%);
    opacity: 0;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}
.block--background {
  background-color: #363636;
  width: 100%;
  height: 40vh;
  position: relative;
  border-radius: 15px 15px 0px 0px;
}

#chatform {
  display: flex;
  justify-content: center;
  width: 80%;
  margin: 0 auto;
  padding-top: 1em;
  font-size: 1em;
  font-family: Helvetica;
  padding-bottom: 5px;
}

.chatbox-area {
  background-color: #363636;
  margin: 0 auto;
  position: relative;
  bottom: 0;
  height: auto;
  width: 100%;
  border-radius: 0px 0px 15px 15px;
}

#chatform>input {
  resize: none;
  border: 2px solid #27ae60;
  border-right: 0;
  width: 70%;
  background-color: transparent;
  color: #fff;
  margin: 0;
  padding: 0.75em;
  border-radius: 8px 0px 0px 8px;
  font-family: inherit;
  font-size: 1em;
}
#chatform>input:focus {
  outline: none;
  border: 2px solid #4bd786;
}

#chatform>a {
  -webkit-appearance: none;
  appearance: none;
  border: 0;
  width: 80px;
  margin: 0;
  background-color: #27ae60;
  color: #fff;
  border: 2px solid #27ae60;
  border-left: 0;
  border-radius: 0 8px 8px 0;
  font-family: inherit;
  font-size: 1em;
  transition: 200ms all ease-in;
  text-align: center; 
  line-height: 2.5;
}
#chatform>a:hover {
  background-color: #4bd786;
  border-color: #4bd786;
  color: #fff;
  width: 90px;
}

.input__nested-list {
  list-style: disc;
  list-style-position: inside;
  padding: 0.5em;
}
.input__nested-list:first-child {
  padding-top: 1em;
}</style><script role="script" id="twine-user-script" type="text/twine-javascript">/* twine-user-script #1: "StoryScript" */
$(document).on(":passageend", function (ev) {
	setTimeout(function () { window.scrollTo(0, 0); }, 20);
});

postrender["Associate Special Passages"] = function (content, taskName) {
	setPageElement("story-title", "StoryTitle", Story.title);
	setPageElement("story-banner","StoryBanner");
	setPageElement("story-subtitle","StorySubtitle");
	setPageElement("story-author","StoryAuthor");
	setPageElement("story-caption","StoryCaption");
	setPageElement("rightBar","rightBar Passage");
	setPageElement("bottom-bar","BottomBar");
}

//Removes the ability to go backwards in time
Config.history.maxStates = 5;

//Makes every passage ignore line breaks
Config.passages.nobr = true;

setup.toggleDarkMode = function(){
	document.body.classList.add('dark-theme')
}
setup.toggleLightMode = function(){
	document.body.classList.remove('dark-theme')
}

//Returns stamina cost
setup.staminaCost = function(time){
	var _cost = time * Math.pow(0.8,State.variables.end/40)
	return _cost;
}

//Calculates waist diameter
setup.waistDiameter = function(){
	var _waist = 2*Math.pow( ( (90 *(State.variables.ate + State.variables.inf + ((State.variables.fat + State.variables.tfat) * .21) ) )/(4*Math.PI) ),(1/3) ) - 5;
	if(_waist < 0){_waist = 0;}
	return _waist;
}

//Returns the character's weight
setup.weight = function(){
	var _weight = (State.variables.bstr * 3) + State.variables.fat + State.variables.ate + State.variables.infMass + 40;
	return _weight
}

//Returns a random herbivore
/*
setup.randomHerbivore = function(){
	var _random = Math.floor(Math.random() * State.variables.herbivores.length);
	var _creature = State.variables.herbivores[_random];
	return _creature;
}*/

//Returns a random carnivore
/*
setup.randomCarnivore = function(){
	var _random = Math.floor(Math.random() * State.variables.carnivores.length);
	var _creature = State.variables.carnivores[_random];
	return _creature;
}*/

//Returns a random species
/*
setup.randomSpecies = function(){
	
	if(Math.random() > 0.5){
		var _creature = setup.randomCarnivore();
	}
	else{
		var _creature = setup.randomHerbivore();
	}
	return _creature;
}*/


//Returns index of input item, or -1 if item is not owned
setup.hasItem = function (item) {
	var _itemIndex = -1;
	if(item == null){return _itemIndex;}
	for(var i = 0;i < State.variables.inventory.length;i++){
		if(State.variables.inventory[i].name == item.name){
				_itemIndex = i;
		}
	}
	return _itemIndex;
}

//Returns index of input item, or -1 if item is not owned
setup.numOwned = function (item) {
	var _owned = 0;
	if(item == null){return _owned;}
	for(var i = 0;i < State.variables.inventory.length;i++){
		if(State.variables.inventory[i].name == item.name){
				_owned = State.variables.inventory[i].stack;
		}
	}
	return _owned;
}

//Returns index of input spell, or -1 if item is not owned
setup.spellIndex = function (spell) {
	var _spellIndex = -1;
	
	for(var i = 0;i < State.variables.spells.length;i++){
		if(State.variables.spells[i].name == spell.name){
				_spellIndex = i;
		}
	}
	return _spellIndex;
}

//Returns index of input quest, or -1 if quest is not taken
setup.questIndex = function (quest) {
	var _questIndex = -1;
	for(var i = 0;i < State.variables.quests.length;i++){
		if(State.variables.quests[i].name == quest.name){
				_questIndex = i;
		}
	}
	return _questIndex;
}

//Returns wether player has started a quest
setup.questStarted = function (quest) {
	var _questStarted = false;
	
	if (setup.questIndex(quest) >= 0){
			_questStarted = true;
	}
	
	return _questStarted;
}
//Returns wether player has completed a quest
setup.questCompleted = function (quest) {
	var _questDone = false;
	
	if (setup.questIndex(quest) >= 0){
		if(State.variables.quests[setup.questIndex(quest)].completed){
				_questDone = true;
			 }
	}
	
	return _questDone;
}

//Returns whether play has a quest ready to be completed
setup.questReady = function (quest) {
	var _questReady = false;
	
	if (setup.questIndex(quest) >= 0){
		if(State.variables.quests[setup.questIndex(quest)].ready){
				_questReady = true;
			 }
	}
	
	return _questReady;
}

//Returns if the player is doing the quest
setup.questActive = function (quest) {
	var _questActive = false;
	if(setup.questStarted(quest) && !setup.questReady(quest) && !setup.questCompleted(quest)){
		_questActive = true;
	}
	return _questActive;
}

//Returns what stage a quest is at
setup.questStage = function (quest) {
	var _questStage = -1;
	
	if (setup.questIndex(quest) >= 0){
		var _testQuest = State.variables.quests[setup.questIndex(quest)];
		if(_testQuest.progress != undefined){
				_questStage = _testQuest.progress;
			 }
	}
	
	return _questStage;
}

//Returns wether your character is immobile or not
setup.testImmobile = function(){
	var _immobile = false;
	if(State.variables.fat + (State.variables.ate * 2) > (State.variables.str * 12)){_immobile = true;}
	return _immobile;
}

//Returns index of input spell, or -1 if spell is not known
setup.hasSpell = function (spell) {
	var _spellIndex = -1;
	for(var i = 0;i < State.variables.spells.length;i++){
		if(State.variables.spells[i].name == spell.name){
				_spellIndex = i;
		}
	}
	return _spellIndex;
}

setup.dodge = function(){
	var _player = State.variables.agi + State.variables.int + State.variables.dodge;
	
	var _enemy = State.variables.e.agi + State.variables.e.int;
	
	var _dodged = setup.skillTestRange(_player, _enemy, 5, 75);
	
	return _dodged;
}

setup.dodgeInstaDeath = function(){
	var _player = State.variables.agi + State.variables.int + State.variables.dodge;
	
	var _enemy = State.variables.e.agi + State.variables.e.int;
	
	var _dodged = setup.skillTestRange(_player, _enemy, 5, 95);
	
	return _dodged;
}

//Rolls X die with Y sides and returns the total
setup.xdy = function (dice, sides){
	var _roll = 0;
	
	for(var i=1;i<=dice;i++){
			_roll +=  Math.floor(Math.random() * sides) + 1;
	}
	
	return _roll;
}

/*Tests a skill*/
setup.skillTest = function(player, enemy){
	
	if((Math.random()*100) <= (player - enemy)){return true;}
	else{return false;}
	
}

/*Tests skills within a certain range of success chance*/
setup.skillTestRange = function(player, enemy, min, max){
	var successChance = player - enemy;
	if(successChance < min){successChance = min;}
	if(successChance > max){successChance = max;}
	return setup.skillTest(successChance,0);
}

/*Attempts to dodge instant death*/
setup.dodgeInstantDeath = function(){
	var _dodged = false;
	var _int = State.variables.int;
	var _agi = State.variables.agi;
	
	var _eint = State.variables.eint;
	var _eagi = State.variables.eagi;
	
	_dodged = setup.skillTestRange((_int+_agi),(_eint+_eagi),5,95);
	return _dodged;
}

// Autosaves every passage
//Config.saves.autosave = true;


(function () {
    'use strict';
    // meters.js, by Chapel; for SugarCube 2
    // v1.0.1

    var options = {
        tryGlobal : true, // attempt to send `Meter` to the global scope?
        allowClobbering : false, // allow a new meter to replace a previously defined meter with the same name instead of throwing
        IAmAGrownUp : false // make sure you have enough rope to hang yourself
    };


    var defaultSettings = {
        full : '#2ECC40', // color when the bar is full
        empty : '#FF4136', // color when the bar is empty
        back : '#DDDDDD', // color of the backing
        height : '12px', // height of the bar
        width : '180px', // width of the bar
        animate : 1000, // ms
        easing : 'swing', // animation easing
        text : '#111111', // label text color
        label : '', // label text
        align : 'center' // label alignment
    };

    var _validAlignments = ['center', 'left', 'right'];
    var _validEasing = ['swing', 'linear'];

    function _handleString (str, def) {
        if (str && typeof str === 'string') {
            str = str.toLowerCase().trim();
            if (str) {
                return str;
            }
        }
        return def || '';
    }

    function _colorEasing (t) {
        // from: https://gist.github.com/gre/1650294
        return (t < 0.5) ? 2 * t * t : -1 + (4 - 2 * t) *t;
    }

    function Meter (opts, value) {
        if (!(this instanceof Meter)) {
            return new Meter(opts, value);
        }

        var defs = clone(defaultSettings);

        this.settings = Object.assign(defs, opts);

        // default malformed settings

        this.settings.align = _handleString(this.settings.align);
        this.settings.easing = _handleString(this.settings.easing);

        if (!_validAlignments.includes(this.settings.align)) {
            this.settings.align = 'center';
        }

        if (!_validEasing.includes(this.settings.easing)) {
            this.settings.easing = 'swing';
        }

        // set the value, or default to 1

        value = Number(value);
        if (Number.isNaN(value)) {
            value = 1;
        }
        value = Math.clamp(value, 0, 1);
        this.value = value;

        // the backing of the meter, and the container
        var $wrapper = $(document.createElement('div'))
            .addClass('chapel-meter')
            .attr({
                'data-val' : value,
                'data-label' : this.settings.label
            })
            .css({
                'position' : 'relative',
                'background-color' : this.settings.back,
                'height' : this.settings.height,
                'width' : this.settings.width,
                'overflow' : 'hidden'
            });

        // the meter's label
        var $label = $(document.createElement('div'))
            .addClass('meter-label')
            .css({
                'top' : 0,
                'right' : 0,
                'font-size' : this.settings.height,
                'font-weight' : 'bold',
                'line-height' : '100%',
                'width' : '100%',
                'height' : '100%',
                'vertical-align' : 'middle',
                'text-align' : this.settings.align,
                'color' : this.settings.text,
                'z-index' : 1,
                'position' : 'relative',
                'bottom' : '100%'
            })
            .wiki(this.settings.label)
            .appendTo($wrapper);

        // this is just here to give the bar a smooth transitioning coloration
        var $barTop = $(document.createElement('div'))
            .addClass('meter-top')
            .css({
                'background-color' : this.settings.full,
                'opacity' : _colorEasing(this.value),
                'width' : '100%',
                'height' : '100%',
                'z-index' : 0
            });

        // this actually holds the value and the 'real' bar color
        var $barBottom = $(document.createElement('div'))
            .addClass('meter-bottom')
            .css({
                'position' : 'absolute',
                'top' : 0,
                'left' : 0,
                'background-color' : this.settings.empty,
                'opacity' : 1,
                'width' : (this.value * 100) + '%',
                'height' : '100%',
                'z-index' : 0
            })
            .append($barTop)
            .appendTo($wrapper);

        this.$element = $wrapper;
        this.$bars = { // undocumented
            top : $barTop,
            bottom : $barBottom
        };
        this.$label = $label; // undocumented

        // mostly a reminder
        $label.css('font-size', (parseInt($wrapper.css('height'), 10) < parseInt($('.passage').css('font-size'), 10)) ? 
            $wrapper.css('height') : $('.passage').css('font-size'));
        $label.css('line-height', $wrapper.css('height'));
    }

    Object.assign(Meter, {
        _list : new Map(), // undocumented; meter data dump
        is : function (thing) { // see if passed "thing" is a meter instance
            return thing instanceof Meter;
        },
        has : function (name) { // does the named meter exist?
            return Meter._list.has(name) && Meter.is(Meter._list.get(name));
        },
        get : function (name) { // return the meter instance
            if (Meter.has(name)) {
                return Meter._list.get(name);
            }
            return null;
        },
        del : function (name) { // delete the meter with the indicated name
            if (Meter.has(name)) {
                Meter._list.delete(name);
            }
        },
        add : function (name, opts, value) { // add a new meter; the constructor should not be used
            if (Meter.has(name) && !options.allowClobbering) {
                console.error('Meter "' + name + '" already exists.');
                return;
            }
            Object.assign(opts, { id : name });
            var meter = new Meter(opts, value);
            Meter._list.set(name, meter);
            return meter;
        },
        _emit : function (inst, name) { // undocumented; emit an event on the given meter
            if (!Meter.is(inst)) {
                return;
            }
            inst.$element.trigger({
                type : ':' + name,
                meter : inst
            });
        }
    });

    Object.assign(Meter.prototype, {
        constructor : Meter,
        _label : function (wait) { // undocumented; reprocess the meter label and set the sizes
            // THE LABEL IS AN ACTUAL NIGHTMARE
            var self = this;
            function process () {
                self.$label.empty().wiki(self.settings.label);
                self.$label.css('font-size', (parseInt(self.$element.css('height'), 10) < parseInt(self.$element.parent().css('font-size'), 10)) ? 
                    self.$element.css('height') : self.$element.parent().css('font-size'));
                self.$label.css('line-height', self.$element.css('height'));
            }
            if (wait) {
                setTimeout(process, Engine.minDomActionDelay);
            } else {
                process();
            }
            return this;
        },
        _width : function () { // undocumented; change the meter width
            var self = this;
            this.$bars.bottom.animate({
                'width' : (this.value * 100) + '%'
            }, this.settings.animate, this.settings.easing, function () {
                Meter._emit(self, 'meter-animation-complete');
            });
            return this;
        },
        _color : function () { // undocumented; blend the full and empty meter colors
            this.$bars.top.animate({
                'opacity' : _colorEasing(this.value)
            }, this.settings.animate, this.settings.easing);
            return this;
        },
        animate : function () { // animate bar changes
            Meter._emit(this, 'meter-animation-start');
            return this._color()._width()._label();
        },
        val : function (n) { // set and get bar value
            if (n !== undefined) {
                n = Number(n);
                if (Number.isNaN(n)) {
                    n = 1;
                }
                n = Math.clamp(n, 0, 1);

                this.value = n;
                this.animate();
            }
            return this.value;
        },
        options : function (opts) {
            // set or get bar settings
            if (opts && typeof opts === 'object') {
                Object.assign(this.settings, opts);
            }
            return this.settings;
        },
        unwrap : function () {
            // return unwrapped container element
            return this.$element[0];
        },
        place : function ($target, options) { // put the bar in a known element, with a wrapper
            var $wrapper = $(document.createElement('span'));
            if (!($target instanceof jQuery)) {
                $target = $($target);
            }
            if (!$target[0]) {
                console.warn('meter#place() -> no valid target');
            }
            if (options && typeof options === 'object') {
                // options can contain classes or attributes for the wrapper
                if (options.classes && (Array.isArray(options.classes) || typeof options.classes === 'string')) {
                    $wrapper.addClass(options.classes);
                }
                if (options.attr && typeof options.attr === 'object') {
                    $wrapper.attr(options.attr);
                }
            }
            $target.append($wrapper.append(this.$element));
            // make sure to process the label
            this._label(true);
            return this;
        },
        // event methods for meters
        on : function (eventType, cb) {
            if (typeof cb !== 'function') {
                return this;
            }
            if (!eventType || typeof eventType !== 'string' || !eventType.trim()) {
                return this;
            }
            eventType = eventType.split(' ').map( function (type) {
                type = type.split('.')[0];
                return type + '.userland';
            }).join(' ');
            this.$element.on(eventType, cb);
            return this;
        },
        one : function (eventType, cb) {
            if (typeof cb !== 'function') {
                return this;
            }
            if (!eventType || typeof eventType !== 'string' || !eventType.trim()) {
                return this;
            }
            eventType = eventType.split(' ').map( function (type) {
                type = type.split('.')[0];
                return type + '.userland';
            }).join(' ');
            this.$element.one(eventType, cb);
            return this;
        },
        off : function (eventType) {
            if (eventType && typeof eventType === 'string' && eventType.trim()) {
                eventType = eventType.split(' ').map( function (type) {
                    type = type.split('.')[0];
                    return type + '.userland';
                }).join(' ');
            } else {
                eventType = '.userland'; // remove all user events
            }
            this.$element.off(eventType);
            return this;
        },
        // ariaClick-style setup
        click : function (options, cb) {
            // let SugarCube handle the errors
            this.$element.ariaClick(options, cb);
            return this;
        },
        // for completeness and in case a meter winds up in the state
        clone : function () {
            return new Meter(this.settings, this.value);
        },
        toJSON : function () {
            return JSON.reviveWrapper('new setup.Meter(' + JSON.stringify(this.settings) + ', ' + this.value + ')');
        }
    });

    // setup-spaced API
    setup.Meter = Meter;

    if (options.tryGlobal) { // global API, if undefined
        window.Meter = window.Meter || Meter;
    }

    // <<newmeter '$variable' [optional: starting value (between 0 and 1)]>>...<</newmeter>>
    // optional child tags: <<metercolors full [empty] [backing]>>, <<metersizing height [width]>>, <<meteranimation timeOrBool [easing]>>, <<meterlabel labelText [textColor] [alignment]>>
    Macro.add('newmeter', {
        tags : ['colors', 'sizing', 'animation', 'label'],
        handler : function () {

            if (State.length > 0 && !options.IAmAGrownUp) {
                // you are not a grown up
                return this.error('The `<<newmeter>>` macro must be called in your `StoryInit` special passage. Seriously. No excuses. --Love, Chapel');
            }

            if (this.args.length < 1) {
                return this.error('The `<<newmeter>>` macro requires at least one argument: a meter name.');
            }

            var meterName = this.args[0], 
                colorsTag = null, 
                sizeTag = null, 
                animTag = null,
                labelTag = null;

            if (typeof meterName !== 'string') {
                return this.error('Invalid meter name.');
            }

            meterName = meterName.trim();

            if (Meter.has(meterName) && !options.allowClobbering) {
                return this.error('Cannot clobber the existing meter "' + meterName + '".');
            }

            if (this.payload.length) {
                // get each child tag for processing
                colorsTag = this.payload.find( function (pl) {
                    return pl.name === 'colors';
                });
                sizeTag = this.payload.find( function (pl) {
                    return pl.name === 'sizing';
                });
                animTag = this.payload.find( function (pl) {
                    return pl.name === 'animation';
                });
                labelTag = this.payload.find( function (pl) {
                    return pl.name === 'label';
                });
            }

            var opts = {};

            if (colorsTag) {
                // process the colors tag
                if (!colorsTag.args.length) {
                    return this.error('No arguments passed to the `<<colors>>` tag.');
                }

                switch (colorsTag.args.length) {
                    case 1:
                        opts.empty = colorsTag.args[0];
                        opts.full = 'transparent'; // make the meter one solid color
                        break;
                    case 2:
                        opts.full = colorsTag.args[0];
                        opts.empty = colorsTag.args[1];
                        break;
                    default:
                        opts.full = colorsTag.args[0];
                        opts.empty = colorsTag.args[1];
                        opts.back = colorsTag.args[2];
                }
            }

            if (sizeTag) {
                // process the sizin tag
                if (!sizeTag.args.length) {
                    return this.error('No arguments passed to the `<<sizing>>` tag.');
                }

                opts.width = sizeTag.args[0];

                if (sizeTag.args[1]) {
                    opts.height = sizeTag.args[1];
                }

            }

            if (animTag) {
                // process the animations tag
                if (!animTag.args.length) {
                    return this.error('No arguments passed to the `<<animation>>` tag.');
                }

                if (typeof animTag.args[0] === 'boolean' && !animTag.args[0]) {
                    opts.animate = 0; // functionally no animation--we still want the event, though, so we'll just 0 it out
                } else if (typeof animTag.args[0] === 'string') {
                    opts.animate = Util.fromCssTime(animTag.args[0]);
                } else {
                    return this.error('The argument to the `<<animation>>` tag should be `true`, `false`, or a valid CSS time value.');
                }

                if (animTag.args[1] && ['swing', 'linear'].includes(animTag.args[1])) {
                    opts.easing = animTag.args[1];
                }
            }

            if (labelTag) {
                // process the label tag
                var text = labelTag.args[0];
                if (text && typeof text === 'string') {
                    opts.label = text.trim();
                } else {
                   return this.error('The labelText argument for the `<<label>>` tag is required.');
                }

                if (labelTag.args[1] && typeof labelTag.args[1] === 'string') {
                    opts.text = labelTag.args[1];
                }
                if (labelTag.args[2] && typeof labelTag.args[2] === 'string') {
                    opts.align = labelTag.args[2];
                }
            }

            Meter.add(meterName, opts, this.args[1]);

        }
    });

    // <<showmeter '$variable' [value]>>
    Macro.add('showmeter', {
        handler : function () {

            if (this.args.length < 1) {
                return this.error('This macro requires at least one argument: the meter\'s name.');
            }

            // get the meter
            var meterName = this.args[0];

            if (typeof meterName !== 'string') {
                return this.error('Invalid meter name.');
            }

            meterName = meterName.trim();

            var meter = Meter.get(meterName);

            if (!meter || !Meter.is(meter)) {
                return this.error('The meter "' + meterName + '" does not exist.');
            }

            // set the meter, if necessary
            if (typeof this.args[1] === 'number') {
                meter.val(this.args[1]);
            }

            // render the meter
            meter.place(this.output, {
                classes : 'macro-' + this.name,
                attr : { id : 'meter-' + Util.slugify(meterName) }
            });

        }
    });

    // <<updatebar '$variable' value>>
    Macro.add('updatemeter', {
        handler : function () {

            if (this.args.length < 2) {
                return this.error('This macro requires two arguments: the meter\'s name and a value.');
            }

            // get the meter
            var meterName = this.args[0];

            if (typeof meterName !== 'string') {
                return this.error('Invalid meter name.');
            }

            meterName = meterName.trim();

            var meter = Meter.get(meterName);

            if (!meter || !Meter.is(meter)) {
                return this.error('The meter "' + meterName + '" does not exist.');
            }

            // set it
            meter.val(this.args[1]); // if it's on the page, should update and animate auto-magically.

        }
    });

}());

/* DOWNTIME MOD EDIT - START */

// Calculates the daily downtime food volume based on the player's selections
setup.downtime_getPlannedEat = function() {
	let _option = State.variables.downtime_optionsSelected.eating
	
	if ( isNaN(_option) ) { // If it's not a number, that means the player has chosen a fixed-size option
		// Fixed values are all stored in an object in the mod's tuning section
		let _tuningValue = State.variables.downtime_fixedEatAmounts[_option]
		
		if ( _tuningValue ) {
			return _tuningValue
		} else {
			// Should probably error...
			return 0
		}
		
	} else { // If it's numerical, it means the player's selected stomach scaling ones
		let _multiplier = State.variables.downtime_optionsSelected.eating / 100 // (wait why don't I have the values in this form from the start? eh, whatever)
		let _baseStomachStat = State.variables.bsto // Want to use the base stat rather than the temporarily modified version, as effects will expire during the downtime
		
		return Math.floor(_baseStomachStat * _multiplier) // Rounding down because this stat should be a hard maximum
	}
}

// Returns daily cost in gold for player's chosen eating amount
setup.downtime_getDailyEatCost = function() {
	let _goldPerEat = State.variables.downtime_eatCost
	let _eatAmount = setup.downtime_getPlannedEat()
	
	return Math.ceil(_goldPerEat * _eatAmount) // rounded up because half-gold doesn't exist
}

// Returns true if the player has selected any form of training for their downtime
setup.downtime_isTraining = function() {
	let _trainingSelections = State.variables.downtime_optionsSelected.training
	
	for (const [stat, isTraining] of Object.entries(_trainingSelections)) {
		if ( isTraining == true ) {
			return true
		}
	}
	
	// If we get here, we're not training anything
	return false
}

setup.downtime_isEating = function() {
	return setup.downtime_getPlannedEat() > 0
}


setup.downtime_getTrainingFatPerDay = function(){
	return State.variables.downtime_trainMinutes * State.variables.downtime_trainFatLoss
}

setup.downtime_getMetabolismFatPerDay = function(){
	return State.variables.downtime_metabolismRate * (60 * 24)
}


// Returns how many days the player could possibly train for given their fat stores
// Warning: can be a negative number of days if given negative fat!
/*
setup.downtime_getTrainingDaysPossible = function(_fat, _fullDaysOnly = false) {
	let _fatLossPerDay = setup.downtime_getTrainingFatPerDay() + setup.downtime_getMetabolismFatPerDay()
	
	let _days = _fat / _fatLossPerDay
	
	if ( _fullDaysOnly ) {
		return Math.floor(_days)
	} else {
		return _days
	}
}
*/

// Calculates the highest number of training days possible with the given fat amount
// If it could go on forever, a high number is returned instead (which will be longer than the built-in cap for downtimes)
setup.downtime_getTrainingDaysPossible = function(_startingFat = 0, _fullDaysOnly = false) {
	let _dailyFatLossToTraining = setup.downtime_getTrainingFatPerDay()
	let _dailyCalories = setup.downtime_getDailyCalories()
	
	let _dailyFatChange = _dailyCalories - _dailyFatLossToTraining
	
	// I am too dumb to do this algorithmically, so it's looping time
	let _remainingFat = _startingFat
	let _days = 0
	
	if ( _dailyFatChange >= 0 ) { /* Can train forever */
		return 9999
	}
	
	while (true) {
		let _newFat = _remainingFat + _dailyFatChange
		
		if ( _newFat >= 0 ) {
			_days += 1
			_remainingFat = _newFat
		} else {
			_days += _remainingFat / Math.abs(_dailyFatChange)
			break
		}
	}
	
	if ( _fullDaysOnly ) {
		return Math.floor(_days)
	} else {
		return _days
	}
}


// Returns how many days the player could possibly eat for given their gold balance
setup.downtime_getEatingDaysPossible = function(_gold, _fullDaysOnly = false) {
	let _goldLossPerDay = setup.downtime_getDailyEatCost()
	
	let _days = _gold / _goldLossPerDay
	
	if ( _fullDaysOnly ) {
		return Math.floor(_days)
	} else {
		return _days
	}
}

// Returns calories per Eat for the player's chosen diet
setup.downtime_getDietCalories = function() {
	return State.variables.downtime_dietCalories[State.variables.downtime_optionsSelected.diet]
}

setup.downtime_isStomachTraining = function() {
	return setup.downtime_getPlannedEat() > State.variables.bsto
}

// Returns how many calories the player would be gaining from their diet per day, also accounting for the loss of fat to metabolism
setup.downtime_getDailyCalories = function() {
	let _intake = 0
	let _metabolismLoss = State.variables.downtime_metabolismRate * (60 * 24)
	
	_intake += setup.downtime_getPlannedEat() * setup.downtime_getDietCalories()
	
	return _intake - _metabolismLoss
}

// Returns the number of training options selected
// (can then be used as a divisor for experience rates)
setup.downtime_getTrainingAmount = function(_trainingSelections) {
	let _trainingsSelectedCount = 0
	
	for (const [stat, isTraining] of Object.entries(_trainingSelections)) {
		if ( isTraining == true ) {
			_trainingsSelectedCount += 1
		}
	}
	
	return _trainingsSelectedCount
}

// Returns the number of days the player entered (which may not end up being the ultimate number of days)
// A sanity check is applied to avoid entries of days less than 1
setup.downtime_getIntendedDays = function() {
	let _enteredDays = State.variables.downtime_optionsSelected.days
	
	if ( _enteredDays < 1 ) {
		return 1
	} else {
		return _enteredDays
	}
}


// Returns the amount of stat increase that would be earned from training + losing this amount of fat
setup.downtime_getStatIncreaseFromFat = function(_fat, _focusType = "primary") {
	/* Both of these values are for changes per minute of training, so we'll have to convert that into stats per fat*/
	let _fatRate = State.variables.downtime_trainFatLoss
	let _statRate
	
	if ( _focusType == "primary" ) {
		_statRate = State.variables.downtime_trainPrimaryRate
	} else {
		_statRate = State.variables.downtime_trainSecondaryRate
	}
	
	return (_statRate / _fatRate) * _fat
}

// Returns an object containing the skill changes based on what's being trained
setup.downtime_calculateTrainingResults = function(_fatSpentOnTraining, _trainingSelections) {
	let _results = {
		strength: 0,
		agility: 0,
		endurance: 0,
		intelligence: 0,
	}
	
	let _divisor = setup.downtime_getTrainingAmount(_trainingSelections)
	
	if ( _trainingSelections.strength == true ) {
		let _strengthEarned = setup.downtime_getStatIncreaseFromFat(_fatSpentOnTraining , "primary")
		let _enduranceEarned = setup.downtime_getStatIncreaseFromFat(_fatSpentOnTraining , "secondary")
		
		_results.strength += _strengthEarned / _divisor
		_results.endurance += _enduranceEarned / _divisor
	}
	
	if ( _trainingSelections.agility == true ) {
		let _agilityEarned = setup.downtime_getStatIncreaseFromFat(_fatSpentOnTraining , "primary")
		let _enduranceEarned = setup.downtime_getStatIncreaseFromFat(_fatSpentOnTraining , "secondary")
		
		_results.agility += _agilityEarned / _divisor
		_results.endurance += _enduranceEarned / _divisor
	}
	
	if ( _trainingSelections.intelligence == true ) {
		let _intelligenceEarned = setup.downtime_getStatIncreaseFromFat(_fatSpentOnTraining , "primary")
		
		_results.intelligence += _intelligenceEarned / _divisor
	}
	
	return _results
}


// Returns an array. First value is the change in stomach stat, second value is the remaining $status.stomachStretch level
setup.downtime_calculateStomachStretch = function(_minutes, _stomachStretchValue){
	// Have to convert stomachStretch from its weirdo value into something usable. Which won't accurately reflect things if this is the first time the player is stretching their stomach, but we'll have to live with it, because it's weird.
	let _actualStomachStretchMinutes = _stomachStretchValue + State.variables.downtime_stretchMinutes
	
	let _minutesStretched = _minutes + _actualStomachStretchMinutes
	
	// Work out the results
	let _increases = Math.floor(_minutesStretched / State.variables.downtime_stretchMinutes)
	let _remainingMinutes = _minutesStretched % State.variables.downtime_stretchMinutes
	
	// Convert remaining minutes back into the $status.stomachStretch format
	let _newStomachStretch = State.variables.downtime_stretchCap - State.variables.downtime_stretchMinutes + _remainingMinutes
	
	return [_increases, _newStomachStretch]
}

setup.downtime_roundToDecimalPlace = function(_number, _decimalPlaces = 0) {
	return +_number.toFixed(_decimalPlaces)
}

// Used to reset all the daily quests. If more daily quests are added, be sure to include them here.
setup.downtime_resetDailyQuests = function(){
	$.wiki('<<removeQuest $washedDishes>>')
	$.wiki('<<removeQuest $cookedFood>>')
	$.wiki('<<removeQuest $smithedArmor>>')
}

// 
setup.downtime_doDowntime = function() {
	
}

/* DOWNTIME MOD EDIT - END */


/* FIXES AND EDITS - Add quick action shortcuts - START */

$(document).keydown( function (event) {
	// Avoid listening to inputs when the player is typing things in to a text / number box
	if ( document.activeElement != null && (document.activeElement.type == "text" || document.activeElement.type == "number") ) {
		return
	}
	
	// Also avoid listening to inputs if a Dialog is open
	if ( Dialog.isOpen() ) {
		return
	}
	
	const actionKeymaps = {
		Digit1: "#northwest-action button",
		Digit2: "#north-action button",
		Digit3: "#northeast-action button",
		Digit4: "#west-action button",
		Digit5: "#center-action button",
		Digit6: "#east-action button",
		Digit7: "#southwest-action button",
		Digit8: "#south-action button",
		Digit9: "#southeast-action button",
		Numpad7: "#northwest-action button",
		Numpad8: "#north-action button",
		Numpad9: "#northeast-action button",
		Numpad4: "#west-action button",
		Numpad5: "#center-action button",
		Numpad6: "#east-action button",
		Numpad1: "#southwest-action button",
		Numpad2: "#south-action button",
		Numpad3: "#southeast-action button",
	}
	
	if ( actionKeymaps[event.code] ) {
		$(actionKeymaps[event.code]).trigger("click")
	}
})

/* FIXES AND EDITS - Add quick action shortcuts - END */

/* FIXES AND EDITS - Alter Devour option availability - START */

// Returns the amount of stuffing required to reach bursting from the player's current state (reimplemented from widgets, but without the argument stuff)
setup.findBursting = function(){
	return setup.findMaxStuffing() - setup.getCurrentStuffing()
}

// Returns the highest amount of stuffing (in volume) the player can handle. Subtract 1 from the value to get their highest survivable limit
// (the rounding feature of the new max health calculation might mean this isn't entirely accurate, but if the base game does it, so shall we)
setup.findMaxStuffing = function(){
	return (State.variables.maxFul/100) * State.variables.sto
}

// Returns the player's current fullness in volume
setup.getCurrentStuffing = function() {
	return State.variables.ate + State.variables.inf
}

// Returns whether or not the "Devour" action should be displayed for the current enemy, accounting for options
setup.shouldShowDevour = function(_enemy) {
	// Option for the enemy's script to custom-handle if the devour option should be available, regardless of settings. (could be force always available, or force never available)
	if ( _enemy.showDevour != null ) {
		return _enemy.showDevour
	}
	
	// Obviously don't consider showing the option if they can't be vored at base
	// If you want to dynamically change whether an enemy can be vored, use the previous variable (showDevour) instead!
	if ( _enemy.voreable != true ) {
		return false
	}
	
	/* Option Modes:
		1 - The Devour option should always be available if the creature is one that can be eaten
		2 - The Devour option should only appear if the player could feasibly stomach it on empty (original game's function)
		3 - The Devour option should only appear if the player could currently stomach it with the space they have remaining.
	*/
	switch( State.variables.options.devourShowMode ) {
		case 1:
			return true
		
		case 2:
			if ( _enemy.weight != null && setup.findMaxStuffing() > _enemy.weight ) {
				return true
			} else {
				return false
			}
			
		case 3:
			if ( _enemy.weight != null && (setup.findBursting() - 1) >= _enemy.weight) {
				return true
			} else {
				return false
			}
	}
}

/* FIXES AND EDITS - Alter Devour option availability - END */




/* FIXES AND EDITS - Restructure Fixed NPC Data - START */

// Adds the gender descriptors to the given NPC, based on the provided gender
// _genderInfo can be either a gender object, or the variable name of a global key (though only a top-level one, so probably of very limited usefulness)
setup.appendNPCGenderInfo = function(_npc, _genderInfo) {
	// _genderInfo could either be an object (what we want), or the global key for that object (which we'll have to fetch)
	_genderInfo = setup.getGenderData(_genderInfo)

	// Set gender descriptors
	_npc.He = _genderInfo.He
	_npc.he = _genderInfo.he
	_npc.Him = _genderInfo.Him
	_npc.him = _genderInfo.him
	_npc.His = _genderInfo.His
	_npc.his = _genderInfo.his
	_npc.Himself = _genderInfo.Himself
	_npc.himself = _genderInfo.himself
	_npc.Man = _genderInfo.Man
	_npc.man = _genderInfo.man
	_npc.Boy = _genderInfo.Boy
	_npc.boy = _genderInfo.boy
	_npc.Male = _genderInfo.Male
	_npc.male = _genderInfo.male
	_npc.Sir = _genderInfo.Sir
	_npc.sir = _genderInfo.sir
	_npc.Mister = _genderInfo.Mister
	_npc.mister = _genderInfo.mister
	_npc.Brother = _genderInfo.Brother
	_npc.brother = _genderInfo.brother
	_npc.Guy = _genderInfo.Guy
	_npc.guy = _genderInfo.guy
	_npc.Fella = _genderInfo.Fella
	_npc.fella = _genderInfo.fella
	_npc.Buddy = _genderInfo.Buddy
	_npc.buddy = _genderInfo.buddy
	_npc.Gentleman = _genderInfo.Gentleman
	_npc.gentleman = _genderInfo.gentleman
	_npc.Lad = _genderInfo.Lad
	_npc.lad = _genderInfo.lad
	_npc.Laddie = _genderInfo.Laddie
	_npc.laddie = _genderInfo.Laddie
	_npc.Sport = _genderInfo.Sport
	_npc.sport = _genderInfo.sport
	
	// Also include the gender object itself
	_npc.gender = _genderInfo
	
	// Don't actually need to return this since we've modified the object itself, but we'll do it any way
	return _npc
}

// Same as `appendNPCGenderInfo`, but for species descriptors
setup.appendNPCSpeciesInfo = function(_npc, _speciesInfo) {
	_speciesInfo = setup.getSpeciesData(_speciesInfo)
	_speciesInfo = setup.validateSpecies(_speciesInfo)
	
	// Set species descriptors
	_npc.speciesType = _speciesInfo.id
	_npc.species = _speciesInfo.species
	_npc.Species = _speciesInfo.species.toUpperFirst()
	_npc.FurBack = _speciesInfo.furBack.toUpperFirst()
	_npc.furBack = _speciesInfo.furBack
	_npc.FurBelly = _speciesInfo.furBelly.toUpperFirst()
	_npc.furBelly = _speciesInfo.furBelly
	_npc.FurHead = _speciesInfo.furHead.toUpperFirst()
	_npc.furHead = _speciesInfo.furHead
	_npc.Feet = _speciesInfo.feet.toUpperFirst()
	_npc.feet = _speciesInfo.feet
	_npc.Foot = _speciesInfo.foot.toUpperFirst()
	_npc.foot = _speciesInfo.foot
	_npc.Hand = _speciesInfo.hand.toUpperFirst()
	_npc.hand = _speciesInfo.hand
	_npc.Hands = _speciesInfo.hands.toUpperFirst()
	_npc.hands = _speciesInfo.hands
	_npc.Fur = _speciesInfo.fur.toUpperFirst()
	_npc.fur = _speciesInfo.fur
	_npc.Furred = _speciesInfo.furred.toUpperFirst()
	_npc.furred = _speciesInfo.furred
	_npc.Furry = _speciesInfo.furry.toUpperFirst()
	_npc.furry = _speciesInfo.furry
	_npc.Hair = _speciesInfo.hair.toUpperFirst()
	_npc.hair = _speciesInfo.hair
	_npc.Tail = _speciesInfo.tail.toUpperFirst()
	_npc.tail = _speciesInfo.tail
	_npc.Teeth = _speciesInfo.teeth.toUpperFirst()
	_npc.teeth = _speciesInfo.teeth
	_npc.Mouth = _speciesInfo.mouth.toUpperFirst()
	_npc.mouth = _speciesInfo.mouth
	_npc.Angry = _speciesInfo.angry.toUpperFirst()
	_npc.angry = _speciesInfo.angry
	_npc.speciesHeight = _speciesInfo.speciesHeight
	_npc.speciesStats = _speciesInfo.speciesStats
	_npc.article = _speciesInfo.article
	_npc.Article = _speciesInfo.article.toUpperFirst()
	
	// Also mess with some species stuff
	_npc.nspecies = _speciesInfo.species
	_npc.fspecies = _speciesInfo.fname
	_npc.mspecies = _speciesInfo.mname
	
	// Include newly added properties
	_npc.adjective = _speciesInfo.adjective
	_npc.Adjective = _speciesInfo.adjective.toUpperFirst()
	
	if ( _speciesInfo.plural ) {
		_npc.plural = _speciesInfo.plural
		_npc.Plural = _speciesInfo.plural.toUpperFirst()
	} else {
		_npc.plural = _speciesInfo.species + "s"
		_npc.Plural = _speciesInfo.species.toUpperFirst() + "s"
	}
	
	// Also include the species object itself. Yeah it kinda defeats the point, but it's required for some stuff!
	_npc.speciesObject = _speciesInfo
	
	return _npc
}

// Returns the species data object for the given species. If it's already an object, it'll return that with the assumption it already is a species object
setup.getSpeciesData = function(_species) {
	if ( typeof _species == "string" ) { // ID of species, that we'll need to lookup
		return State.variables.speciesList[_species]
	} else { // Was already a species object
		return _species
	}
}

// as `getSpeciesData` but for gender stuff
setup.getGenderData = function(_gender) {
	if ( typeof _gender == "string" ) { // ID of gender, that we'll need to lookup
		return State.variables[_gender]
	} else { // Was already a gender object
		return _gender
	}
}

// Returns the gendered version of a name from an NPC data object
setup.getNPCGenderedName = function(_npcData, _gender) {
	if ( _gender == "male" && _npcData.mname ) {
		return _npcData.mname
	} else if ( _gender == "female" && _npcData.fname ) {
		return _npcData.fname
	} else {
		return _npcData.name
	}
}

// Places an already formed NPC into one of the game's NPC slots
setup.setNPCToSlot = function(_npc, _slot) {
	let _slotCode = "npc" + _slot
	
	State.variables[_slotCode] = _npc
}

// Merges an NPC object onto another object
// The main use is to add the NPC detail onto already loaded Enemy, for when fighting fixed NPCs
// The return value has to be used to replace the existing object manually - this function can't do that (it doesn't actually append!)
setup.appendNPCInfo = function(_objectToAddTo, _npc) {
	return {
		..._objectToAddTo,
		..._npc
	}
}

// Creates an NPC object for the given NPC
setup.createFixedNPC = function(_npcData) {
	// _npcData could be the NPC's ID instead of their object.
	if ( typeof _npcData == "string" ) {
		_npcData = State.variables.npcs[_npcData] // note the hardcoded location
	}
	
	let _npc = {..._npcData} // Start off by cloning the _npcData. Most of it will later get replaced, but this way we can maintain some data unique to the NPC where needed.
	
	// GENDER
	// Account for options that could change the NPC's gender
	let _gender = _npcData.gender
	
	switch (State.variables.options.fixedNPCGenders) {
		case "male":
			_gender = "male"
			break
		case "female":
			_gender = "female"
			break
		case "swap":
			// Intentionally hardcoded to only swap male and female - NPCs with custom-defined genders will be unaffected
			if ( typeof _npcData.gender == "string" ) {
				if ( _npcData.gender == "male" ) {
					_gender = "female"
					break
				} else if ( _npcData.gender == "female" )  {
					_gender = "male"
					break
				}
			} else {
				if ( _npcData.gender.male == "male" ) {
					_gender = "female"
					break
				} else if( _npcData.gender.male == "female" ) {
					_gender = "male"
					break
				}
			}
		
		default:
			_gender = _npcData.gender
	}
	
	setup.appendNPCGenderInfo(_npc, _gender)
	
	// SPECIES
	setup.appendNPCSpeciesInfo(_npc, _npcData.species)
	
	// Record the neutral species name in case we want it
	_npc.nspecies = _npc.species
	_npc.nSpecies = _npc.species.toUpperFirst()
	
	// Replace species with the correct gendered version (if possible)
	if ( _npc.male == "male" && _npc.mspecies ) {
		_npc.species = _npc.mspecies
		_npc.Species = _npc.mspecies.toUpperFirst()
	} else if ( _npc.male == "female" && _npc.fspecies ) {
		_npc.species = _npc.fspecies
		_npc.Species = _npc.fspecies.toUpperFirst()
	}
	
	// NAME
	let _name = setup.getNPCGenderedName(_npcData, _npc.male)
	_npc.name = _name
	_npc.Name = _name.toUpperFirst()
	
	return _npc
}

// Reimplementation of base game's `createNPC` widget. Used for "random" NPCs, as opposed to fixed ones
// Note: Unlike original, this doesn't then automatically assign the NPC to a slot!
setup.createNPC = function(_speciesInfo = "none", _genderInfo = "random") {
	let _npc = {}
	
	// Do species
	let _species
	
	switch( _speciesInfo ) {
		// Check if it's a string code with a specific function
		case "random":
			_species = setup.randomSpecies(false)
			break
		case "randomAll":
			_species = setup.randomSpeciesAll()
			break
		case "herbivore":
			_species = setup.randomHerbivore()
			break
		case "carnivore":
			_species = setup.randomCarnivore()
			break
		case "dinosaur":
			_species = setup.randomDinosaur()
			break
		case "none": // Tradition dictates defaulting to lion, but it shouldn't really matter what gets picked, as an npc marked with a species of "none" likely isn't using any species-specific narration.
			_species = setup.randomSpeciesAll()
			break
		default: // must be a species or species ID
			_species = setup.getSpeciesData(_speciesInfo)
	}
	
	setup.appendNPCSpeciesInfo(_npc, _species)
	
	// Do genders
	let _gender
	
	// Do gender rules
	// You can bypass the random rules by providing a gender object as _genderInfo
	let _randomMalesAllowed = State.variables.options.males
	let _randomFemalesAllowed = State.variables.options.females
	
	switch(_genderInfo) {
		case "male":
			if ( _randomMalesAllowed ) {
				_gender = setup.getGenderData("male")
			} else if ( _randomFemalesAllowed ) {
				_gender = setup.getGenderData("female")
			} else {
				_gender = setup.getGenderData("neuter")
			}
			break
		case "female":
			if ( _randomFemalesAllowed ) {
				_gender = setup.getGenderData("female")
			} else if ( _randomMalesAllowed ) {
				_gender = setup.getGenderData("male")
			} else {
				_gender = setup.getGenderData("neuter")
			}
			break
		
		case "random":
			let randomOptions = []
			
			if ( _randomMalesAllowed ) {
				randomOptions.push(setup.getGenderData("male"))
			}
			if ( _randomFemalesAllowed ) {
				randomOptions.push(setup.getGenderData("female"))
			}
			
			if ( randomOptions.length > 0 ) {
				_gender = either(randomOptions)
			} else {
				_gender = setup.getGenderData("neuter")
			}
			break
		
		case "none":
			_gender = setup.getGenderData("thing")
			break
		default:  // Assume was given a gender object / nonstandard gender code
			_gender = setup.getGenderData(_genderInfo)
	}
	
	setup.appendNPCGenderInfo(_npc, _gender)
	
	// Record the neutral species name in case we want it
	_npc.nspecies = _npc.species
	_npc.nSpecies = _npc.species.toUpperFirst()
	
	// Replace species with the correct gendered version (if possible)
	if ( _npc.male == "male" && _npc.mspecies ) {
		_npc.species = _npc.mspecies
		_npc.Species = _npc.mspecies.toUpperFirst()
	} else if ( _npc.male == "female" && _npc.fspecies ) {
		_npc.species = _npc.fspecies
		_npc.Species = _npc.fspecies.toUpperFirst()
	}
	
	return _npc
}

// Add an NPC to the NPCs list
// Also used for editing existing NPCs - provided data will be merged on top of existing data.
setup.registerNPC = function(_npcId, _npcData) {
	if ( State.variables.npcs[_npcId] ) { //npc already exists
		State.variables.npcs[_npcId] = {
			...State.variables.npcs[_npcId],
			..._npcData
		}
	} else {
		State.variables.npcs[_npcId] = clone(_npcData) // don't know if clone is necessary or not
	}
}

/* FIXES AND EDITS - Restructure Fixed NPC Data - END */



/* FIXES AND EDITS - Allow custom titles - START */

// Flush the previous title
$(document).on(':passageinit', function (ev) {
	State.variables.passageTitle = ""
});

/* FIXES AND EDITS - Allow custom titles - END */




/* FIXES AND EDITS - Restructure Species - START */
// (NOTE: Reliant on other functions declared as part of other edits)

// Adds a species to the species pool
// We funnel everything through this so that in the event we get around to changing how species are stored, no other code needs to change ;p
// This is also used to edit existing species - any data provided will be merged on top of what's already there, adding and/or replacing properties
setup.registerSpecies = function(_speciesData, _speciesId) {
	let _id
	if ( _speciesId ) { // species id is optional - otherwise it's taken from _speciesData
		_id = _speciesId
	} else {
		_id = _speciesData.id
	}
	
	// This function is sneakily not only a register, but a patcher, also
	// If a species with the same ID already exists, anything that's part of _speciesData will be added on top of what's already there (either adding new fields, or overwriting existing ones with new data)
	
	if ( State.variables.speciesList[_id]  ) { // species already exists
		State.variables.speciesList[_id] =	{
			...State.variables.speciesList[_id],
			..._speciesData
		}
	} else {
		// First time registers will be run through validation
		let validSpecies = setup.validateSpecies(_speciesData)
		
		State.variables.speciesList[_id] = clone(validSpecies) /* Not sure how _speciesData is actually handled, but we'll clone just to make sure nothing ends up editing the original */
	}
	
	// Safety checker, which is partially down to having made mistakes with previous versions...
	// Prevent species from having an `option` value if it's `core`
	if ( State.variables.speciesList[_id].core && State.variables.speciesList[_id].option ) {
		delete State.variables.speciesList[_id].option
	}
	
	// Pluraliser
	if ( State.variables.speciesList[_id].plural == null ) {
		State.variables.speciesList[_id].plural = State.variables.speciesList[_id].species + "s"
	}
	State.variables.speciesList[_id].Plural = State.variables.speciesList[_id].plural.toUpperFirst()
}

// We'll confusingly re-introduce some new versions of base game functions here

// Returns an array of all active species that have a truthy value for a given property
setup.getSpeciesPoolWithFlag = function(_property) {
	let pool = []
	
	for ( const [id, species] of Object.entries(State.variables.speciesList) ) {
		// Skip species that require an option to be enabled, when that option isn't
		if ( species.option && State.variables.options[species.option] == false ) {
			continue
		}
		
		// Add to options if has property, and the property is truthy
		if ( species[_property] ) {
			pool.push(species)
		}
	}
	
	return pool
}

// Returns an array of species objects that are both available to the player, and active
setup.getPlayableSpecies = function(){
	let pool = []
	
	for ( const [id, species] of Object.entries(State.variables.speciesList) ) {
		// Skip species that require an option to be enabled, when that option isn't
		if ( species.option && State.variables.options[species.option] == false ) {
			continue
		}
		if ( species.hidden || species.noPlayer ) { // flag was originally `hidden`, but is now `noPlayer` for species that the player shouldn't have access to
			continue
		}
		
		pool.push(species)
	}
	
	return pool
}

// Takes an array of species objects and sorts into alphabetical order
setup.sortSpeciesPool = function(pool){
	return pool.sort((a, b) => { // copypasting examples to the rescue!
		const nameA = a.species.toUpperCase(); // ignore upper and lowercase
		const nameB = b.species.toUpperCase(); // ignore upper and lowercase
		if (nameA < nameB) {
			return -1;
		}
		if (nameA > nameB) {
			return 1;
		}

		// names must be equal
		return 0;
	})
}

setup.getSortedPlayableSpecies = function() {
	let pool = setup.getPlayableSpecies()
	setup.sortSpeciesPool(pool)
	return pool
}

// Returns a random species with the given flag
setup.getRandomSpeciesWithFlag = function(_property) {
	return either(setup.getSpeciesPoolWithFlag(_property))
}

// Returns a random herbivore species object
setup.randomHerbivore = function() {
	let herbivores = setup.getSpeciesPoolWithFlag("herbivore")
	
	// For back-compatibility's sake, we'll update the old $herbivores list with this, just in case something is still relying on that list directly
	State.variables.herbivores = herbivores
	
	return either(herbivores)
}

// Returns a random carnivore species object
setup.randomCarnivore = function() {
	let carnivores = setup.getSpeciesPoolWithFlag("carnivore")
	
	// For back-compatibility's sake, we'll update the old $carnivores list with this, just in case something is still relying on that list directly
	State.variables.carnivores = carnivores
	
	return either(carnivores)
}

// Returns a random dinosaur species object
setup.randomDinosaur = function() {
	let dinosaurs = setup.getSpeciesPoolWithFlag("dinosaur")
	
	return either(dinosaurs)
}

// Returns a random flight-capable species object
setup.randomFlying = function() {
	let fliers = setup.getSpeciesPoolWithFlag("flying")
	
	return either(fliers)
}

// Returns a random dragon species object
setup.randomDinosaur = function() {
	let dragons = setup.getSpeciesPoolWithFlag("dragon")
	
	return either(dragons)
}

// Returns a random human species object
setup.randomHuman = function() {
	let human = setup.getSpeciesPoolWithFlag("human")
	
	return either(human)
}

// Returns a random species based on the original implementation (aka, not actually random, rather one from the curated lists of carnivore / herbivore / dino)
setup.randomSpecies = function(_yesDino = false, _yesHuman = State.variables.options.humans, _humanCount = 4) { // won't include an `_includeNoRandom` check like with `randomSpeciesAll` because `herbivore` `carnivore` and `dinosaur` are currently all intentionally opt-in flags specifically for including in random tables
	let options = [setup.randomHerbivore, setup.randomCarnivore]
	
	if ( _yesDino ) {
		options.push(setup.randomDinosaur)
	}
  
  	if ( _yesHuman ) {
      for (let i = 0; i < _humanCount; i++) {
      	options.push(setup.randomHuman)
      }
    }
	
	return either(options)()
}

// Returns an array of ALL available species objects, as opposed to from curated lists like `setup.randomSpecies`. Mostly for use with `setup.randomSpeciesAll`
setup.randomSpeciesPoolAll = function(_includeNoRandom = false) {
	// We'll do something lazy and hacky and use `setup.getSpeciesPoolWithFlag` with the "flag" being `id`, which should be truthy for all species, as that property is present for all of them
	let options = setup.getSpeciesPoolWithFlag("id")
	
	// Optionally filter out the species that have been specifically flagged to not be available for randomisation
	if ( _includeNoRandom == false ) {
		options = setup.scrubNoRandom(options)
	}
	
	return options
}

// Returns a random species object from ALL available options, as opposed to from curated lists like setup.randomSpecies
setup.randomSpeciesAll = function(_includeNoRandom = false) {
	return either(setup.randomSpeciesPoolAll(_includeNoRandom))
}

// Removes any species objects from a pool if they have a given property.
// Returns a new array with them filtered - doesn't operate on the original
setup.scrubSpeciesWithFlag = function(_pool, _property) {
	return _pool.filter((_species) => _species[_property] == null)
}

// Removes any species labelled with `noRandom` from a species pool.
// Returns a new array with them filtered - doesn't operate on the original
setup.scrubNoRandom = function(_pool) {
	return setup.scrubSpeciesWithFlag(_pool, "noRandom")
}

// Runs through all core species and makes a copy of them available as a global variable, to replicate how the original game system worked for backwards compatibility
// I don't know how object referencing works with twine, so I'd advise running this after any changes have been made to a species
setup.populateCoreGlobalSpecies = function(){
	for ( const [id, species] of Object.entries(State.variables.speciesList) ) {
		if ( species.core ) {
			State.variables[id] = species
		}
	}
}

// Ensures species has all the required values. Will return a validated version
setup.validateSpecies = function(_speciesObject) {
	let base = {
		article: "a",
		species: "lion",
		angry: "roar",
		furBack: "golden", furBelly: "white", furHead: "brown",
		foot: "paw", feet: "paws",
		hand: "paw", hands: "paws",
		fur: "fur", furred: "furred", furry: "furry",
		hair: "mane",
		tail: "long tail",
		teeth: "fangs",
		mouth: "muzzle",
		speciesHeight: 71,
		speciesStats: [5,5,5,0,10,4],
		adjective: "animalistic",
	}
	
	let validSpecies = {
		...base,
		..._speciesObject
	}
	
	if ( validSpecies.mname == null ){
		validSpecies.mname = validSpecies.species
	}
	if ( validSpecies.fname == null ){
		validSpecies.fname = validSpecies.species
	}
	if ( validSpecies.plural == null ){
		validSpecies.plural = validSpecies.species + "s"
	}
	
	return validSpecies
}


/* FIXES AND EDITS - Restructure Species - END */





/* FIXES AND EDITS - Automatic mod updater - START */
/* Passages might attempt to use these before they're declared, so declare them here, even though we'll ignore anything done to them */
setup.modUpdated = false
setup.modUpdatedList = []

Save.onLoad.add(function (save) {
	// When a save is being loaded, we want to queue up the update checks.
	// We can't do the changes now (well, we can but it'd require different patching methods),
	// so we'll leave it until the first passage is starting to load
	$(document).one(':passageinit', function (ev) {
		// Prepare some variables that'll be used
		setup.modUpdated = false // If a mod patcher successfully updates, it'll set this to true to let us know
		setup.modUpdatedList = [] // Names of mods that have updated 
		
		// Run the updates passages. They will check if they need updating, and set $modUpdated to let us know an update happened.
		$.wiki('<<include "mods patch and update">>')
		
		// Notify the player if something's been updated
		if ( setup.modUpdated == true ) {
			// Remove the flag
			setup.modUpdated = false
			
			// Cause the mod updated popup to show
			Dialog.setup("Mod Patches Applied!");
			
			let text = ""
			text += "Required patches for newly updated mods have been automatically applied!"
			
			if ( setup.modUpdatedList.length > 0 ) {
				text += " The following mods have been updated:<ul>"
				for (const modName of setup.modUpdatedList) {
					text += `<li>${modName}</li>`
				}
				text += "</ul>"
			} else {
				text += "<br><br>"
			}
			
			text += `Be aware that if you use the back function now, the changes will be undone, and you'll have to manually update your mods via the "Game fixes" menu.`
			
			Dialog.wiki(text);
			Dialog.open();
		}
	});
})
/* FIXES AND EDITS - Automatic mod updater - END */




/* FIXES AND EDITS - Restructure Spells - START */

/* First of the items that I'm actually moving out of globals */
setup.spells = {} /* Patchers will fill these with spells */

setup.registerSpell = function(spell, spellId) {
	let id
	if ( spellId ) {
		id = spellId
	} else {
		id = spell.id
	}
	
	if ( setup.spells[id] ) { // Already exists, so merge with existing
		setup.spells[id] = {
			...setup.spells[id],
			...spell
		}
	} else {
		setup.spells[id] = clone(spell) // still unsure if clone is necessary...
	}
}

// Gets spell object for given spell.
setup.getSpell = function(spell) {
	if ( typeof spell == "string" ) { // ID of spell, that we'll need to lookup
		return setup.spells[spell]
	} else { // Was already a spell object
		return spell
	}
}

// Returns true if the player knows the spell.
setup.knowsSpell = function (spell) {
	spell = setup.getSpell(spell)
	
	for (let currentSpell of variables().spells) {
		currentSpell = setup.getSpell(currentSpell) // Doing this makes this compatible with the old spellbook format (spell objects) and the newer format (string ids)
		
		if ( spell.id == currentSpell.id ) {
			return true
		}
	}
	
	return false
}

// returns an array with the reasons why the player can't learn the given spell. Will be an empty array if there's no reason they can't
setup.spellLearnFailReasons = function(spell){
	spell = setup.getSpell(spell)
	let reasons = []
	
	if ( spell.str > 0 && variables().bstr < spell.str ) {
		reasons.push(`${spell.str} strength`)
	}
	
	if ( spell.agi > 0 && variables().bagi < spell.agi ) {
		reasons.push(`${spell.agi} agility`)
	}
	
	if ( spell.end > 0 && variables().bend < spell.end ) {
		reasons.push(`${spell.end} endurance`)
	}
	
	if ( spell.int > 0 && variables().bint < spell.int ) {
		reasons.push(`${spell.int} intelligence`)
	}
	
	if ( spell.sto > 0 && variables().bsto < spell.sto ) {
		reasons.push(`${spell.sto} stomach`)
	}
	
	return reasons
}

setup.canLearnSpell = function(spell){
	spell = setup.getSpell(spell)
	
	// We'll be lazy, since we've already got a function to work out the reasons
	//  - if there's no reasons the player can't learn, then they must be able to learn it!
	return setup.spellLearnFailReasons(spell).length == 0
}

// Returns list of reasons why player can't cast a given spell, due to lacking resources
setup.spellCastFailReasons = function(spell){
	spell = setup.getSpell(spell)
	let reasons = []
	
	if ( spell.cost && variables().mana < spell.cost ) {
		reasons.push("mana")
	}
	
	let stamina = false
	if ( spell.staminaFixedCost && variables().sta < spell.staminaFixedCost ) {
		stamina = true
	}else if ( spell.staminaCost && variables().sta < setup.staminaCost(spell.staminaCost) ) {
		stamina = true
	}
	
	if ( stamina ) {
		reasons.push("stamina")
	}
	
	if ( spell.healthCost && variables().hea <= Math.round(spell.healthCost) ) { /* Use of <= is intended here, because even if the player has the exact amount, they shouldn't be able to cast, because that'll kill them!*/
		reasons.push("health")
	}
	
	if ( spell.goldCost && variables().gld < Math.round(spell.goldCost) ) {
		reasons.push("gold")
	}
	
	return reasons
}


// Uses up the required resources for the spell
setup.consumeSpellCosts = function(spell) {
	spell = setup.getSpell(spell)
	
	/* Consume mana */
	if ( spell.cost ) {
		$.wiki(`<<spendMana ${spell.cost}>>`) // We'll be lazy and use the actual official thing for it
	}
	
	/* Consume stamina */
	if ( spell.staminaFixedCost ) {
		variables().sta -= spell.staminaFixedCost
	}else if ( spell.staminaCost ) {
		variables().sta -= setup.staminaCost(spell.staminaCost)
	}
	variables().sta = Math.clamp(variables().sta, 0, 100)
	
	/* Consume health */
	if ( spell.healthCost ) {
		$.wiki(`<<damage ${spell.healthCost}>>`) // Will this report the health loss or not? (don't want it to)
	}
	
	/* Consume gold */
	if ( spell.goldCost ) {
		$.wiki(`<<doGld ${-spell.goldCost}>>`)
	}
	
	$.wiki("<<updateStats>>")
}

setup.canCastSpell = function(spell) {
	spell = setup.getSpell(spell)
	
	return setup.spellCastFailReasons(spell).length == 0
}

// Returns an object that details whether or not a spell should be available to cast
setup.spellIsAvailable = function(spell) {
	spell = setup.getSpell(spell)
	
	/* Custom checkers trump regular checks */
	if ( spell.availableCheck ) {
		return setup[spell.availableCheck](spell)
	} else {
		/* In combat, and spell isn't usable there */
		if ( variables().inCombat == true && !spell.combat ) {
			return {result: false, reason: "in combat"}
		}
		if ( variables().inCombat == false && !spell.ooc ) {
			return {result: false, reason: "not in combat"}
		}
	}
	
	return {result: true}
}


setup.getSpellCosts = function(spell) {
	spell = setup.getSpell(spell)
	let costs = []
	
	if ( spell.cost ) {
		costs.push(`${spell.cost} mana`)
	}
	
	if ( spell.staminaFixedCost ) {
		costs.push(`${spell.staminaFixedCost} stamina`)
	}else if ( spell.staminaCost ) {
		costs.push(`${spell.staminaCost} stamina`) // Don't adapt the displayed stamina costs
	}
	
	if ( spell.healthCost ) {
		costs.push(`${Math.round(spell.healthCost)} health`)
	}
	
	if ( spell.goldCost ) {
		costs.push(`${Math.round(spell.goldCost)} gold`)
	}
	
	return costs
}

// Sorts player's spellbook into alphabetical order
setup.sortSpellbook = function(){
	variables().spells.sort((a, b) => {
		let spellA = setup.getSpell(a)
		let spellB = setup.getSpell(b)
		
		let nameA = spellA.name.toUpperCase()
		let nameB = spellB.name.toUpperCase()
		
		if (nameA < nameB) {
			return -1;
		}
		if (nameA > nameB) {
			return 1;
		}

		// names must be equal
		return 0;
	})
}

// Replaces spells in the old format (objects) with their updated forms (spell IDs)
// Provide an array of spells to replace, or use the string "all" to update every spell regardless of its source (will default to "all" behaviour if an array isn't provided)
setup.patchOldSpellbook = function(spellList = "all"){
	/* Handle all */
	if ( spellList == "all" ) {
		spellList = []
		
		for ( const [id, spell] of Object.entries(setup.spells) ) {
			spellList.push(id)
		}
	}
	
	/* Get the names and IDs of the spells we're supposed to be updating */
	let lookup = {} /* Will store the names of the related spells, and what their IDs are */
	for (let currentSpell of spellList) {
		currentSpell = setup.getSpell(currentSpell)
		
		lookup[currentSpell.name] = currentSpell.id
	}
	
	/* Now loop through the player's spellbook, and find the old versions of spell objects that we need to update */
	let toUpdate = {} /* key is index in spellbook, value is string ID of the spell */
	for (let [index, currentSpell] of variables().spells.entries()) {
		/* Skip if is already in new format */
		if ( typeof currentSpell == "string" ) { 
			continue
		}
		
		currentSpell = setup.getSpell(currentSpell)
		
		/* Skip if spell is flagged as `unique` (i.e, is INTENDED to be a spell object in the spellbook) */
		if ( currentSpell.unique ) {
			continue
		}
		
		/* Otherwise, get to it */
		if ( lookup[currentSpell.name] ) {
			toUpdate[index] = lookup[currentSpell.name]
		}
	}
	
	/* Finally, make the actual replacements */
	/* (if you're not sure why I did this separately rather than in the previous loop - I wasn't sure if it was safe to modify an array while also looping through it :p) */
	for ( const [index, id] of Object.entries(toUpdate) ) {
		variables().spells[index] = id
	}
}

// Sets up core spells to have global variables, in order to provide backwards compatibility
setup.populateCoreGlobalSpells = function(){
	for ( const [id, spell] of Object.entries(setup.spells) ) {
		if ( spell.core ) {
			State.variables[id] = spell
		}
	}
}

/* Returns the % multiplier for the player's spellcast. Spell scaling is adjusted by weapon scaling when wielding and INT weapon. */
setup.getPlayerSpellScaling = function(){
	let scaling = setup.tuning("spellBonusDamageScalingBase")
	
	let weapon = variables().wea
	
	if ( weapon.stat == "int" && weapon.scaling > scaling ) {
		scaling = weapon.scaling
	}
	
	return scaling
}

/* Returns the amount of bonus damage a player should be dealing when casting spells, given their intelligence level and INT scaling */
setup.getPlayerSpellBonusDamage = function(){
	let scaling = setup.getPlayerSpellScaling()
	
	return Math.round(variables().int * scaling)
}

/* FIXES AND EDITS - Restructure Spells - END */




/* FIXES AND EDITS - Enemy etc. code - START */

setup.enemyHasWeakness = function(damageType = "notype", enemy = variables().e){
	// Special effect of soak
	if ( enemy.soak > 0 && damageType == "lightning"){
		return true
	}
	if ( enemy.icyspells_greased > 0 && damageType == "fire"){
		return true
	}
	
	if ( enemy.damageWeakness && enemy.damageWeakness.includes(damageType) ) {
		return true
	} else {
		return false
	}
}

setup.enemyHasResistance = function(damageType = "notype", enemy = variables().e){
	if ( enemy.damageResistance && enemy.damageResistance.includes(damageType) ) {
		return true
	} else {
		return false
	}
}

setup.getEnemyDamageTypeMultiplier = function(damageType = "notype", enemy = variables().e){
	/* This is going to slightly change how damage stuff works, but screw it */
	let weak = setup.enemyHasWeakness(damageType, enemy)
	let resists = setup.enemyHasResistance(damageType, enemy)
	
	if (weak && resists) {
		return 1
	} else if (weak) {
		return setup.tuning("damageWeaknessMultiplier")
	} else if (resists) {
		return setup.tuning("damageResistanceMultiplier")
	} else {
		return 1
	}
}

/* FIXES AND EDITS - Enemy etc. code - END */




/* FIXES AND EDITS - Utilise tuning variables for major variables - START */
/* Note: This is very much indev and not fully realised */

/* First time setup for main tuning values on game initialisation (will run once whenever the game is opened - not per game load) */
if ( setup.globalTuning == null ) {
	setup.globalTuning = {
		playerHeightMin: 48,
		playerHeightMax: 144,
		absoluteHeightMin: 6,
		absoluteHeightMax: 576,
		speciesStatsPoints: 25,
		speciesStartStatMin: 0,
		speciesStartStatMax: 25,
		speciesStartFatMin: 0,
		speciesStartFatMax: 30,
		baseStatMain: 15,
		baseStatStomach: 20,
		startingFat: 5,
		
		damageWeaknessMultiplier: 1.5,
		damageResistanceMultiplier: 1/1.5,
		
		burnProcDamageModifier: 0.2, /* When burn procs, the burn damage is set to the damage dealt multiplied by this number */
		
		spellBonusDamageScalingBase: 0.4,
		
		stretchFruitRescueInterval: 40,
		stoRescueInterval: 40,
	}
}
// Add a tuning variable to the global tuning
setup.registerTuning = function(id, value) {
	setup.globalTuning[id] = value
}

// Alter a tuning value for the current save
setup.registerSaveTuning = function(id, value) {
	// Ensure save tuning exists
	if ( State.variables.tuning == null ) {
		State.variables.tuning = {}
	}
	
	State.variables.tuning[id] = value
}

// Removes changes to the tuning at a local level
setup.unregisterSaveTuning = function(id) {
	// Ensure save tuning exists
	if ( State.variables.tuning == null ) {
		State.variables.tuning = {}
	}
	
	delete State.variables.tuning[id]
}

// Returns the value of the given tuning variable. Prioritises the tuning values in save files
setup.getTuningValue = function(id) {
	if ( State.variables.tuning != null && State.variables.tuning[id] != null  ) {
		return State.variables.tuning[id]
	} else {
		return setup.globalTuning[id]
	}
}

// aliases
setup.tuning = setup.getTuningValue
setup.tune = setup.registerTuning
setup.tuneSave = setup.registerSaveTuning

/* FIXES AND EDITS - Utilise tuning variables for major variables - END */
/* twine-user-script #2: "AI Widget" */
/* AI MOD - Initialize Metadata - START */
/* Load the AI Config metadata. */
/* This will also establish the defaults if used for the first time */

setup.aiconfig = recall('aiconfig', {
	text: {
		url: "https://api.openai.com/v1/chat/completions",
		model: "gpt-3.5-turbo",
		apikey: "",
		temperature: 0.9,
		frequency_penalty: 0.2,
		max_tokens: 500,
		extra_parameters: {},
	},
	image: {},
})
/* AI MOD - Initialize Metadata - END */
console.log(setup.aiconfig)


// Runs when a conversation page is loaded. If the conversation state is empty, it adds the starting messages to the conversation. 
window.createConversation = function(character) {
	console.log(State.variables.chats[character])
	const chatList = document.querySelector('.chatlist');
	const npc1 = State.variables.npc1;

	if (State.variables.chats[character] == undefined) {
		State.variables.chats[character] = [];
		State.variables.chats[character].push({ 'role': 'assistant', 'content': 'The bloated ' + npc1.species + ' lies there, seemingly unaware of your presence, ' + npc1.his + ' eyes half-closed as if in a daze. As you draw nearer, you contemplate your next move. You could introduce yourself or maybe you want to do something else...' });
	}

	// Create input bubble for each message in chat arr
	for (const chat of State.variables.chats[character]) {
		const chatBubble = document.createElement('li');

		if (chat.role == 'user') {
			chatBubble.classList.add('user_input');
		} else {
			chatBubble.classList.add('bot_output');
		}

		chatBubble.innerHTML = chat.content;
		chatList.appendChild(chatBubble);
	}
}

window.getPlayerContext = function() {
	const player = State.variables.p;
	// Provide a context for describing the player character to the chatbot
	const paragraph = [];
	paragraph.push(`The player is a ${player.male} ${player.species}. Their weight is: ${State.variables.bodyFatTier} with a belly that is ${State.variables.waist} and sticks out ${setup.waistDiameter()} inches.`);

	return paragraph.join('\n');
}

window.addChat = function(character, messageObj) {
	State.variables.chats[character].push(messageObj);
	createBubble(messageObj.content, messageObj.role == 'user');

	console.log(State.variables.chats[character]);
}

window.createBubble = function(inputText, user = true) {
	const chatList = document.querySelector('.chatlist');

	//create input bubble
	const chatBubble = document.createElement('li');
	user ? chatBubble.classList.add('user_input') 
	: chatBubble.classList.add('bot_output');

	//adds input of textarea to chatbubble list item
	chatBubble.innerHTML = inputText;

	//adds chatBubble to chatlist
	chatList.appendChild(chatBubble)
}


// Make a request for a message from the given character
window.makeAITextRequest = async function(character) {
	const settings = setup.aiconfig.text;

	const requestBody = {
		"model": settings.model,
		"user": character,
		"temperature": settings.temperature,
		"frequency_penalty": settings.frequency_penalty,
		"max_tokens": settings.max_tokens,
	}

	requestBody["messages"] = [
		{"role": "system","content": State.variables.npcs[character].chatContext}, 
		...State.variables.chats[character]
	];

	// Add any extra parameters to the request body
	Object.assign(requestBody, settings.extra_parameters);

    try {
		const response = await fetch(settings.url, {
			method: 'POST',
            headers: {
				'Authorization': `Bearer ${settings.apikey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        });

        if (!response.ok) {
			throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
		if (data) {
			// Parse the data for any special actions or effects


			addChat(character, data.choices[0].message);
		} else {
			addChat(character, {"role": "assistant","content": "An error occurred."});
		}
    } catch (error) {
		console.error('Request failed:', error);
        return null;
    }
};


// Make a request for text given the input prompt
window.makeAIStoryRequest = async function({systemText, promptText}) {
	const settings = setup.aiconfig.text;

	const requestBody = {
		"model": settings.model,
		// "user": "System_text",
		"temperature": settings.temperature,
		"frequency_penalty": settings.frequency_penalty,
		"max_tokens": settings.max_tokens,
	}

	// If we are generating a message for flavor text:
	requestBody["messages"] = [
		{"role": "system","content": systemText}, 
		{"role": "user","content": promptText}
	];	// This last message isn't actually from the user, it's just the prompt text for each specific situation


	// Add any extra parameters to the request body
	Object.assign(requestBody, settings.extra_parameters);

	    try {
		const response = await fetch(settings.url, {
			method: 'POST',
            headers: {
				'Authorization': `Bearer ${settings.apikey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        });

        if (!response.ok) {
			throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
		if (data) {
			// Parse the data for any special actions or effects

			return(data.choices[0].message.content);
		} else {
			return("An error occurred in retrieving API response.");
		}
    } catch (error) {
		console.error('Request failed:', error);
        return null;
    }
}


/*
 * AI Scenes Section
 */

const Stack = function() {
    this.items = [];
    this.push = function(item) {
        this.items.push(item);
    };
    this.pop = function() {
        return this.items.pop();
    };
	this.isEmpty = function() {
		return this.items.length === 0;
	};
}

const Queue = function() {
    this.stack1 = new Stack();
    this.stack2 = new Stack();

    this.enqueue = function(item) {
        this.stack1.push(item);
    };

    this.dequeue = function() {
        if (this.stack2.isEmpty()) {
            while (!this.stack1.isEmpty()) {
                this.stack2.push(this.stack1.pop());
            }
        }
        return this.stack2.pop();
    };
}

window.setAmbientText = function() {
	State.variables.ambientText = {
		centralTown: new Queue(),
	}

	State.variables.ambientPrompts = {
		centralTown: `
		Generate an ambient scene text output for a fantasy adventure game. The scene should be set in a world of anthropomorphic characters called "furs". The furs live in a state of excessive gluttony. This output text will be shown when the player is passing time in town. Include diverse scenarios, focusing on characters and the ambiance of the town. Keep the descriptions imaginative, aligning with the theme of fantasy and indulgence.

		STRICTLY follow any sentence count guidelines in the prompt.

		Available species are: wolf, fox, hawk, owl, penguin, dolphin, coyote, lion, cheetah, tiger, dragon, deer, pig, ferret, raccoon, rhino, panda, hippo

		Example ambient scene text outputs:
		"A very overweight fox waddles her way down the street with several bags of food under each arm."

		"Between a rare cart or a lone rider passing across it, the square is largely empty at the moment, allowing the birds to be heard above the subdued din of the working city."

		"There is a sense of sun-baked contentment in the almost empty square, but even with the lack of ruckus nearby, a low hum of busy life permeates the city, accentuated every now and then by a loud call, a door getting bashed shut, a sound of explosion from one of the hospital wards or a satisfied belch from one of the restaurant regulars."

		"A lean rabbit reaches for a shiny berry at the fruit stand. Upon taking a bite, he suddenly begins to puff up, his shirt buttons popping off as his stomach expands rapidly. Surprised and a bit amused, he chuckles, patting his newly rounded belly, now the size of a large watermelon. He pays the stand owner and waddles away with his newfound heft."

		"Amid the bustling town square, a rotund rhino, fattened to an almost comical size, is being wheeled around in a specially designed cart. Children giggle and point as he cheerfully waves, his belly jiggling like a bowl full of jelly with every movement."

		"A small group of furs gather near a quaint bakery. Their attention is fixed on a ferret customer devouring a mountainous tower of pastries. As the ferret's enjoyment intensifies, an extraordinary phenomenon unfolds before your eyes, her once slender form starts to rapidly expand, rounding out like a balloon of fat. You watch in awe as the ferret's size grows with each bite. The wicker chair snaps under the ferret's increasing weight, sending her tumbling. Soon, the portly ferret finds herself immobilized, her plump belly resting on the cobblestone ground, unable to move."
		`,
	}
}

const getRandomInt = function(max) {
  return Math.ceil(Math.random() * max);
}

// 
window.getAmbientText = function(area){
	// console.log(State.variables.ambientText[area]);
	// Check that any area exists, overwrite if not
	if (State.variables.ambientPrompts.centralTown == undefined) {
		window.setAmbientText();
	}

	// Output the next item from the queue if there is one available
	return State.variables.ambientText[area].dequeue();
}

window.generateAmbientText = async function(area) {
	// Generate another output for the queue on every request
	let promptText = '';
	const sentenceCount = getRandomInt(3); // 2,3,4

	// 20% chance for a special response
	switch (getRandomInt(1)) {
		case 1:
			// Special response
			console.log('Special response', sentenceCount + 3);

			switch (getRandomInt(3)) {
				case 1:
				promptText = `Provide an output for ${State.variables.timeOfDay} in exactly ${sentenceCount + 2} sentences about a fur who starts bloating up from something.`;
				break;
				case 2:
				promptText = `Provide an output for ${State.variables.timeOfDay} in exactly ${sentenceCount + 2} sentences about a fur who suddenly fattens up.`;
				break;
				default:
				promptText = `Provide an output for ${State.variables.timeOfDay} in exactly ${sentenceCount + 3} sentences about a fur who's belly inflates and they panic while floating away.`;
				break;
			}
			break;
		default:
			// Basic response
			console.log('Basic response', sentenceCount);
			promptText = `Provide an output for ${State.variables.timeOfDay} in exactly ${sentenceCount} sentences.`;
			break;
	
	}

	const data = await window.makeAIStoryRequest({
		systemText: State.variables.ambientPrompts[area], 
		promptText,
	})
	
	State.variables.ambientText[area].enqueue(data);
	// console.log(State.variables.ambientText[area]);
	console.log(data);
}


/* Provide an output for evening in exactly 6 sentences, about a fur who suddenly fattens up so much they become a massive blob */
/* Provide an output for daytime about a fur who starts bloating up from something. Describe their expansion in detail as they panic and burp. */
/* Provide an output for evening in exactly 5 sentences, about a fur who's belly inflates and panics while floating away */</script><tw-tag name="cutscene" color="red"></tw-tag><tw-tag name="feeder-expansion" color="yellow"></tw-tag><tw-tag name="fixes-and-edits" color="orange"></tw-tag><tw-tag name="forest" color="green"></tw-tag><tw-tag name="jungle" color="green"></tw-tag><tw-tag name="mod-support" color="red"></tw-tag><tw-tag name="Human" color="red"></tw-tag><tw-tag name="downtime-mod" color="blue"></tw-tag><tw-tag name="grasslands" color="yellow"></tw-tag><tw-tag name="pokemod" color="blue"></tw-tag><tw-tag name="widget" color="purple"></tw-tag><tw-tag name="beach" color="blue"></tw-tag><tw-passagedata pid="1" name="bubble orca ai" tags="" position="5150,625" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a bloated looking blue $npc1.species – $npc1.he has a magical aura around $npc1.him, and bubbles are constantly leaking from $npc1.his mouth. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Inflate&lt;/li&gt;
	$npc1.He takes in another breath and puffs again, continuing the assault on your stomach’s capacity. 
	&lt;&lt;inflate 5 -8&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if random(1,3) == 1&gt;&gt;
		&lt;li&gt;Grab&lt;/li&gt;
		The $npc1.species suddenly surges forward, grasping you with $npc1.his fins. 
		&lt;&lt;switch setup.dodge()&gt;&gt;
			&lt;&lt;case true&gt;&gt;
				Fortunately you manage to wriggle free before $npc1.he can get a good grip on you. 
				
			&lt;&lt;default&gt;&gt;
				$npc1.He abruptly plants $npc1.his lips on yours and begins to exhale air directly into your stomach, making it bulge further. 
				&lt;&lt;inflate 5 -8&gt;&gt;
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;Inflate&lt;/li&gt;
		The $npc1.species rears back, takes in a gulp of water, and lets out the converted air as a stream of missile-like bubbles directed straight at your face. You fail to dodge out of the way, and several of the bubbles force their way into your mouth, streaming down your throat and making your belly swell outwards. 
		&lt;&lt;inflate 5 -8&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.weight() &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You dash forward in the water and grab the $npc1.species around the middle. It squeaks and tries to wiggle out of your grasp, but you turn it around and bring it face to face, opening your mouth wide. The $npc1.species panics a little and exhales another bubble into your mouth, but you gulp it down and quickly follow it with $npc1.his head. Your jaws strain to force your mouth over the $npc1.species’s wide frame, but $npc1.his rather slippery skin makes it a lot easier than something else of that size. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	You nom your way over the $npc1.species’s large and somewhat squeaky, rubbery middle, sucking in the tail and swallowing it, burping and licking your lips in quiet satisfaction of your catch... Just as you’re feeling victorious, something worrying stirs in your stomach. It appears the $npc1.species doesn’t want to go down without a fight. You hear a very loud mix between a hiss and a belch as, in one last move of desperation, the $npc1.species unloads every last bit of air into you – Evidently $npc1.he had some sort of ability to compress air within $npc1.himself, and is giving you all $npc1.he’s got. Your already distended gut begins to blimp further and further outwards, the various bulges in your middle smoothing out into one, single round dome. 
	&lt;&lt;inflate 30 -48&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		You weren’t expecting to get more strain on your gut, but you refuse to let that stop you. You let out a several belches and pass wind a few times to alleviate the pressure, necessity winning out over any shyness you might feel about this. Your efforts aren’t enough to stop or reverse the $npc1.species’s last stand, but they do slow it enough to keep the pressure on your gut low enough for it to not be painful. Eventually, $npc1.he runs out of steam, and finally settles down. You bob to the surface and rest for a few minutes, giving yourself a few minutes to enjoy your meal before dipping back into the water and swimming on your way. 
		&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
		&lt;&lt;set $cal += _calories&gt;&gt;
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		Panic kicks in – you weren’t expecting to be put under more strain than you were already going through, and your stomach agrees. The feeling of pressure gets worse and worse until it becomes painful, and loud groans and creaks join the chorus of noises coming from within you as your stomach strains to hold its new contents. Eventually, the pain becomes too much and you fall unconscious. You wake up just in time to see that your prisoner managed to get out of you, and $npc1.his tail is accelerating right at your face. $npc1.He smacks you so hard you go spiralling through the water and break the surface, spiralling away through the sky. The $npc1.species, back in the water, dusts $npc1.himself off the best $npc1.he can, swimming off in annoyance at being eaten, and disappointment of being forced to do that to a potential inflate-y playmate. 
		&lt;&lt;inflateToFloating&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;floating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
			
&lt;&lt;else&gt;&gt;
	Unfortunately, your stomach isn’t finding it as easy to handle. It groans loudly as you keep trying to push the $npc1.species further in, but you already know you’re fighting a losing battle here. The $npc1.species, noticing that you’re beginning to struggle, takes in a breath and exhales as hard as it can, firing back out of your mouth like a rocket. Both of you fly apart, with $npc1.him flying out of the water and you smashing into the sand on the ocean floor below. The horrible sensation and the impact has stunned you, and you come to your senses to find the $npc1.species face to face with you again, only this time it seems $npc1.he’s the one in control. $npc1.He locks lips with you, and puffs hard into your mouth. Your gut swells forth, but it barely even registers due to the numbness of your stomach. Once you’ve been puffed up to about the appropriate size, the $npc1.species licks $npc1.his lips and opens wide, stretching over your bloated body and works on a little bit of appropriate retribution. $npc1.His large maw contains rows of slightly blunt teeth and a fleshy tongue, and you can see deep into $npc1.his gullet. $npc1.He closes $npc1.his mouth around you, decreasing your vision to practically nothing. As $npc1.he forces you down, $npc1.he coats your body with saliva, the thick substance mixing with the salty water your body is drenched by. It’s a surprise how little time it is until you’re inside the astonishingly wide and roomy prison that is $npc1.his stomach. $npc1.He gulps down some more sea water, and it turns into slightly salt-scented air by the magic of the pills before it reaches $npc1.his stomach. Your continued dizziness and large size are making escape somewhat unlikely, and the steady supply of oxygen you now have means that it looks like you’re going to be stuck in here for a while. After an hour of intermittent struggling, you nod off on your own intent as opposed to the lack of oxygen, resigning yourself to your fate and hoping the digestion comes soon. 
	&lt;&lt;inflateToFloating&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn tail and attempt to flee from the battle. The $npc1.species blinks in confusion, and then tries to pursue you. However, $npc1.he begins to fall behind and eventually runs out of puff, drooping down and panting, letting out clouds of bubbles with every exhale. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You turn tail and attempt to flee from the battle. The $npc1.species blinks in confusion and then tries to pursue you. The vast amount of activity however strains you and gives you a cramp, forcing you to stop and the $npc1.species quickly catches up to you. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	Be it through losing the will to fight, or through you enjoying the ordeal, you stop fighting against the $npc1.species and loosen up somewhat, and $npc1.he notices your submission. $npc1.He breaks off the kiss, seeing if this is some sort of trick, but soon catches on and tugs you close and rears $npc1.his head back, drinking down several mouthfuls of water, it hissing and turning into air within $npc1.his body. $npc1.He grins mischievously at you before locking lips with you once more and puffing hard. Your belly swells out further and further, and you can feel the buoyancy within you making your entire body want to float to the surface. The $npc1.species senses this, and swims as best it can to the surface. $npc1.He puffs into you a few more times, before letting go and watching you glide away through the air. $npc1.He rolls onto $npc1.his belly and waves with $npc1.his tail as you drift away. 
	&lt;&lt;inflateToFloating&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;floating&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if random(1,2) == 1&gt;&gt;
		You lower your $wea.name, conveying you no longer want to fight. You would expect $npc1.him to pounce on you and start making you more spherical, but a loud rumble from $npc1.him indicates that $npc1.his hunger is winning out over $npc1.his inflation lust. $npc1.He still pounces, but outstretched jaws instead of outstretched arms. You have second thoughts and try to swim off, but as you do you feel $npc1.his jaws fix themselves around your ankles. You violently flail with your arms to try and escape, but you feel the $npc1.species let go before $npc1.he thrusts forward, biting further up your gut, before doing it again, and again. You can already feel your legs in $npc1.his stomach, and realise that escape is impossible, and give up once more. The $npc1.species works $npc1.his way over your chest, licking at your head before sucking it in and swallowing. You flop into $npc1.his rather spacious gut, which is surprisingly dry and somewhat comfortable. The $npc1.species lets out a burp and swims away back into the depths, and it’s a long while before your consciousness wanes. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You lower your $wea.name, conveying you no longer want to fight. The $npc1.species descends on you, blowing more bubbles into your mouth before $npc1.he even realises you’ve given up the fight. $npc1.He smiles, and gently bites your leg, pulling you down to the ocean floor before lying down on you, pinning you to the sandy floor. $npc1.He pins your arms down with $npc1.his fins, before rearing back and taking a huge intake of water. The lasting effects of the pills turn it into air as soon as it enters $npc1.his body, and you can see and hear $npc1.his middle swell up with air before $npc1.he locks lips with you, puffing air into your mouth like the most overenthusiastic act of CPR ever practiced, and your middle springs out with light gas. As your midriff becomes wider and wider, $npc1.he eventually doesn’t need to hold you down, due to the air pushing its way into your arms, making them unbendable and useless. You can see $npc1.him being lifted up by your rising stomach, eventually becoming vertical. $npc1.He’s so lost in $npc1.his enjoyment of the situation that $npc1.he’s rather startled when you become too big and $npc1.he rolls off of you. Unfortunately, $npc1.he was the only thing that was holding you down, and you begin to float up. $npc1.He quickly recovers and grabs you but your momentum towards the surface makes $npc1.his attempts to stop you futile. You break the surface, and the warm air within you catapults you into the air and makes you begin to drift back towards the shore. The $npc1.species surfaces, looking up at you drifting away, and you can see $npc1.him waving at you happily. There’s no malice or mocking in it – $npc1.he evidently thinks you enjoyed this as much as $npc1.he did. You feel pretty helpless as you’re carried away by the tidal breeze. 
		&lt;&lt;inflateToFloating&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;floating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The constant pressure on your stomach is getting far too much to bear, becoming quite painful, but that’s the least of your concerns right now – You’re floating to the surface of the water and try as you might, you can’t swim back down. The $npc1.species giggles and swims over to you, either uncaring or unaware that you’re quite panicked by this lack of mobility, and locks lips with you, puffing a bit more air into your already overstretched body. $npc1.His contact with you only breaks when you’re lifted off the surface of the water completely and begin to drift off. The $npc1.species smiles, before diving back off into the water, treating this like the end of a game you two were playing and not an actual victory against you. 
&lt;&lt;inflateToFloating&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;floating&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The $npc1.species spins through the water from your last hit, rolling onto $npc1.his back and bobbing to the surface in a daze. You take this opportunity to quickly swim away, looking behind you for a moment to see the unconscious $npc1.species still burping out bubbles which float off into the sky. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false &quot;ocean randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="2" name="hydra ai" tags="" position="5025,625" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your enemy is a giant three headed serpent the colour of sand. Each head stares at you as their tongues flick up and down, tasting the air. It seems hungry, waiting to add you to the list of victims in its cauldron-like belly. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Devour&lt;/li&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			You attempt to crawl back out from the $npc1.species&#39;s stifling throat, but can&#39;t quite manage to get out. A second gulp pulls you farther down the $npc1.species&#39;s muscular throat. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 1&gt;&gt;
			Your attempts to escape are in vain, as a third gulp sets you sliding into the $npc1.species’s stomach below. You fall into a surprisingly roomy cavern, where the others that were eaten earlier are unconscious. The oppressive heat of your surroundings causes your senses to dull, but you could still escape, if you move quickly. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 0&gt;&gt;
			Trying to ignore the heat, you look up at the hole you entered from, and run up the slope to try and escape. You snatch for the edge, but slip and fall, sliding back down. The heat of the area causes your head to swim and your body to continue to weaken. 
			&lt;&lt;set _damage = $maxHea * 0.15&gt;&gt;
			&lt;&lt;damage _damage&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,5)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Devour&lt;/li&gt;
			&lt;&lt;switch setup.dodgeInstaDeath()&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					The middle head lunges at you, maw agape. You jump to dodge but the heads work together as a second head waits for your next move. With its maw agape, you unintentionally fall into the waiting jaws of the left head. You brace for pain, but nothing happens. As you scramble out of its mouth, it closes quickly as it realised it missed its cue. The right head stares disdainfully as the middle one screeches in fury at it. 
					
				&lt;&lt;default&gt;&gt;
					The middle head lunges at you, maw agape. You jump to dodge, but the heads work together as a second head waits for your next move. With its maw agape, you unintentionally fall into the waiting jaws of the right head. The jaws slam shut behind you and a loud gulp sends you down. 
					&lt;&lt;set $e.special =  2&gt;&gt;
					&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
		&lt;&lt;default&gt;&gt;
			&lt;&lt;switch random(1,3)&gt;&gt;
				&lt;&lt;case 1&gt;&gt;
					&lt;li&gt;Attack&lt;/li&gt;
					One of the heads lunges at you, maw agape. You manage to dodge and avoid being eaten whole, but you are injured for $edmg damage by $npc1.his teeth. 
					&lt;&lt;damage $edmg&gt;&gt;
					
				&lt;&lt;case 2&gt;&gt;
					&lt;li&gt;Sweep&lt;/li&gt;
					The beast crouches somewhat, bringing its tail around and sweeping it at you – it catches you off guard and slams into you, dealing $edmg damage and winding you. 
					&lt;&lt;if $end &gt; 13&gt;&gt;
						&lt;&lt;set _debuff = random(-8,-12)&gt;&gt;
						&lt;&lt;tempBuff &quot;end&quot; _debuff&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					&lt;&lt;damage $edmg&gt;&gt;
					
				&lt;&lt;case 3&gt;&gt;
					&lt;li&gt;Sand Attack&lt;/li&gt;
					The $npc1.species rears back, smashing the ground with $npc1.his forepaws and knocking sand into the air, blowing it at you with a gust of wind. The sand gets in your eyes and irritates your wounds, making it hard to focus. 
					&lt;&lt;if $end &gt; 7&gt;&gt;
						&lt;&lt;set _debuff = random(-4,-6)&gt;&gt;
						&lt;&lt;tempBuff &quot;end&quot; _debuff&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					&lt;&lt;if $agi &gt; 7&gt;&gt;
						&lt;&lt;set _debuff = random(-4,-6)&gt;&gt;
						&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					&lt;&lt;set $edmg = Math.round($edmg*0.2)&gt;&gt;
					&lt;&lt;damage $edmg * 0.2&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
The $npc1.species looks around at the rest of the beach, thinking that the people around $npc1.him are too far away to bother with, and it’s about to retreat into the water before the middle mouth gags. The other two look at it before it retches and brings you up onto the sand. You’re dazed and confused by the impact and light, but get back up and yell at the $npc1.species defiantly. The middle head roars in rage, while the right one looks on in a mix of bemusement and genuine admiration. 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
Your resolve falters and you quickly turn tail on the fight, running as fast as you can. The $npc1.species smashes $npc1.his tail down on the ground, hoping to incapacitate you or stop your retreat, but $npc1.he’s too slow and $npc1.his tail crashes into the ground behind you. By the time $npc1.he pulls it back up, you’re too far away for $npc1.him to catch. The element of surprise was all $npc1.he had, so now that there’s no one within range $npc1.he slips back into the water. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
Your resolve falters and you quickly turn tail on the fight, running as fast as you can. The $npc1.species smashes $npc1.his tail down on the ground, hoping to incapacitate you or stop your retreat. You stop yourself just in time to avoid being made into a pancake against the sand and look away from the impassable wall of flesh in front of you. You have no choice but to return to the fight. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	For whatever reason, be it fatigue or the acceptance of fate, you flop down against the walls of your prison, the dizzying heat making you drift off. Your digestion is painless. 
&lt;&lt;else&gt;&gt;
	You throw yourself on the $npc1.species’s mercy. They stop their assault and look at you inquisitively. You get on your knees and ask the $npc1.species to return the others it ate in return for yourself. One head stares blankly at you, another hisses in annoyance and the last one seems to consider the offer. They quickly exchange words in a strange, hiss and snarl-based language. The left and right heads come to an agreement, as the middle one rolls its eyes. All three of them move to the ground and spit out the three they had eaten. As soon as their previous victims are released, the middle one darts forward and catches you in $npc1.his jaws before you have any chance to back out. $npc1.He flings her head back and swallows, sending you into a long trip down into the cavernous pit below. You give up midway through the journey down, drifting into a sleep before you reach your journey’s end. 
&lt;&lt;/if&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	After sliding down the wall again, you feel what little energy you have left get sapped away by the encroaching heat. Knowing you won’t have the energy for another run-up, you try crawling up to freedom, but your consciousness flickers and fails before you get even halfway up. 
&lt;&lt;else&gt;&gt;
	You drop to the ground as you pant from over exertion. Your vision blurs as you watch in vain as one of the heads lunges towards you. You fall into darkness as you feel the walls of the $npc1.species&#39;s throat work your way down into its stomach before you drop into an open space, the heat feeling like a sauna as you land in a deep pool. Your body begins to tingle almost immediately, before you succumb to your exhaustion and fall unconscious. 
&lt;&lt;/if&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The $npc1.species recoils, all heads screeching in pain. The outer two stop, but the middle one continues screeching in rage, and while you can’t understand the word, you understand it’s yelling at the other two. They share a gaze, then both headbutt the middle one, knocking it unconscious. The two look at you, obviously conceding defeat, lower their heads and spit out the others they ate. The $npc1.species turns and leaves, glaring back at you. It might try to strike again while you’re not around. As the medical services arrive to tend to the vomited anthros, a female from the crowd walks over to you, thanking you for saving her husband and emptying her purse into your hands while all the while thanking you and wishing she had more to give. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="3" name="sand snake ai" tags="" position="4900,625" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a large, &lt;&lt;if $npc1.name == &quot;sand snake&quot;&gt;&gt;orange, $npc1.species&lt;&lt;else&gt;&gt;$npc1.species&lt;&lt;/if&gt;&gt; – Only the first five feet of it are poking out of the sand, and you have no idea how long it really is. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Poison&lt;/li&gt;
	As you move around in the vice-like wrap of the $npc1.species, you feel a spreading warmth from the bitemark. Your confines are getting tighter, but the $npc1.species isn’t gripping harder – you’re getting bigger! 
	&lt;&lt;set _cram = random(5,8)&gt;&gt;
	&lt;&lt;set _calories = _cram * 0.6&gt;&gt;
	&lt;&lt;set _debuff = _cram * -0.5&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
	&lt;&lt;tempBuff &quot;int&quot; _debuff&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Attack&lt;/li&gt;
			The $npc1.species lunges at you and bites you, dealing $edmg damage. You quickly pry $npc1.him off before he can inject you with any venom. 
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Hypnotize&lt;/li&gt;
			&lt;&lt;switch setup.skillTest($int,$e.int + 35)&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					The $npc1.species falls oddly still as it locks eyes with you. It grins as it tries to put you under a hypnotic stare, but it doesn’t manage to get proper eye contact. Looking at it blankly, you reach over and gently poke it as a general message for the $npc1.species to cut it out. It blinks as the hypnotic glimmer in its eyes disappears, scowling at you. 
					
				&lt;&lt;default&gt;&gt;
					The $npc1.species falls oddly still as it locks eyes with you. You go to attack once more, but can’t bring yourself to strike. You stare back into the $npc1.species’s eyes, and you find something utterly entrancing about them. Time seems to slow as $npc1.his tongue flickers slower than it did before. 
					&lt;&lt;set _debuff = random(-4,-6)&gt;&gt;
					&lt;&lt;tempBuff &quot;int&quot; _debuff&gt;&gt;
					&lt;&lt;if $int &gt; 0&gt;&gt;
						You find yourself slowly pacing towards the $npc1.species, arm outstretched towards it, but something in your mind makes you snap out of it and break your gaze. You didn’t fall entirely under $npc1.his spell, but your head hurts and your mind feels unhinged from it. 
					&lt;&lt;/if&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Grab&lt;/li&gt;
			The $npc1.species rushes forward and coils around you, trapping you within its thick, &lt;&lt;if $npc1.name == &quot;sand snake&quot;&gt;&gt;orange&lt;&lt;else&gt;&gt;$npc1.furBack&lt;&lt;/if&gt;&gt; grasp. 
			&lt;&lt;switch setup.dodge()&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					You pull the $npc1.species’s grasp off you and slap it away, the disorientation making its grip loosen, and you jump out of its coils! 
					
				&lt;&lt;default&gt;&gt;
					It opens its mouth wide and bites deep into your belly. 
					&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
					&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;if !$alive or $int &lt; 0&gt;&gt;
	You stagger and fall to the ground, to weak to carry on fighting. As you look up at your victorious enemy, you can&#39;t help but fall into its gaze. You stare back into the $npc1.species’s eyes, and you find something utterly entrancing about them. Time seems to slow as $npc1.his tongue flickers slower than it did before. 
	&lt;&lt;set $int = 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
Your stomach growls, and you decide the nearby coconuts aren’t something you’re interested in. You whack the $npc1.species with your $wea.name, dazing it somewhat. You grab it by the neck and pull $npc1.him over to you, holding your mouth wide and stuff its head into your mouth. It suddenly snaps out of its daze and wiggles against you, but the fact that it doesn’t have arms or other methods of resisting directly makes swallowing it down rather easily. Or rather, it would be if it wasn’t for the length. You gulp again and again, more and more of the $npc1.species’s long body emerging from the sand.
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;						
	Eventually the tip of $npc1.his tail breaks the surface of the sand. You suck that down as well, letting the flickering tailtip stay in your mouth for a few moments before swallowing, letting the $npc1.species coil up in your gut. You gently slap your tightened stomach, letting loose a loud belch, before wandering off on your way. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;						
	It’s becoming apparent that you’re running out of room rapidly. The tightness in your belly is soon making your eyes water, and not long after you can’t keep yourself standing, and fall to your knees, hopelessly overstuffed and nauseous. The $npc1.species seizes $npc1.his moment. $npc1.He wraps $npc1.his tail around you, and begins to yank itself backwards out of you. Again and again it reels itself out of you, before the sensation triggers a gag reflex and you retch, bringing the rest of the $npc1.species up. As it falls to the floor, $npc1.he stays still for a few moments before coming to $npc1.his senses, facing you and shaking off the saliva, before grinning and diving at you, chomping over your head. You’re too delirious and shaky to resist, and it isn’t long before the vice-like grip of the $npc1.species’s innards are pressing against every inch of your body. You hear the noise of sand grinding as the $npc1.species burrows back into the ground, and you feel too exhausted to fight back again, and slowly pass out. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You decide to try to run, be it through cowardice or unwillingness to fight. You quickly begin to charge at $npc1.him, but rather than attacking, you vault over one of its coils and flee. The $npc1.species blinks, confused, and then realises it should give chase, and dives back under the sand. You hear tunnelling below you, and it bursts out of the sand and flies out with its mouth outstretched... right into a nearby coconut tree. The impact knocks a coconut out, and it falls right onto the $npc1.species’s head, dazing it. By the time it’s stopped seeing stars, you’re already gone. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You decide to try to run, be it through cowardice or unwillingness to fight. You quickly begin to charge at $npc1.him, but rather than attacking you vault over one of its coils and flee. The $npc1.species blinks, confused, then realises it should give chase and dives back under the sand. You hear tunnelling below you, and it bursts out of the sand and flies out with its mouth outstretched. You duck and it misses you by millimeters. It burrows down in front of you, its head resurfacing and facing you again, and it’s on the offensive before you can react. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	You shrug and decide not to fight any more, going limp against the coils. The $npc1.species smirks, and proceeds to pump more and more venom into you, and the warmth and continues to build. Eventually, it’s becoming a bit too much to bear, and you feel yourself almost ready to fall asleep. As your awareness flickers, the $npc1.species looks at you, before uncoiling itself from you and moving back to see how big you’ve become. The $npc1.species opens $npc1.his mouth, measuring you against it, and it realises that it bloated you a little TOO big, to the point where $npc1.he doesn’t think you’re edible. It sighs with self-disdain as it burrows back into the sand, leaving you alone. The venom is still working on your system, however, and the feeling of bloating continues to grow, which eventually makes you pass out in something rather akin to a food coma. 
	&lt;&lt;stuffToBursting&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You sigh from exhaustion, putting any weapons you have away. The $npc1.species latches onto your arm, biting you, before it realises you aren’t retaliating. It rears back a little, flashing its fangs at you, before opening its mouth wide and chomping down over your head. You hear movement outside before you feel the impact of $npc1.his tail sweeping your legs from under you and knocking you to the floor. Helpless, you feel the $npc1.species work its way over you, with long, deep gulps, and feel the wet, muscular grip of its throat working you down further into $npc1.his body. Eventually, you feel your journey slow as you reach $npc1.his stomach. You don’t bother struggling, but your head knocks against something fuzzy and hard in your fleshy prison. You prod at it, and realise it’s a whole coconut. Sighing, you poke at the one other thing in here with you, knowing that you won’t be able to open it. Evidently, the $npc1.species senses your intentions, and after a bit of movement, you hear another gulp and something hard hits your foot. You curl up and reach down, grabbing at it, and from touch alone, you discover it’s a somewhat pointed rock, and hear the $npc1.species let out something between a hiss and a chuckle. For a vorish captor, the $npc1.species’s at least a tiny bit generous. You break the coconut open with a few hits from the rock, gnawing at it as best you can. Sated and slightly calmed from your fate, you lie down and eventually fall unconscious. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	The warmth continues to spread through you, and you’re feeling extremely bloated and tired. The fight finally goes out of you and you can’t struggle any more. You wiggle like the overstuffed meal that you now are, and the $npc1.species proceeds to treat you as such. $npc1.He opens wide, easing $npc1.his jaws over you, wriggling $npc1.his way down you. It isn’t long before you’re in $npc1.his tight, wet insides, and $npc1.he lets out a satisfied burp. There’s a large pause after that though, when it dawns on the $npc1.species – by moving down over you while still in a coil, it’s effectively tied itself in a knot. It lets out more aggravated hisses, and you smirk a little as your consciousness fades, glad to see you’re not the only one suffering. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You find yourself slowly pacing towards the $npc1.species, arm outstretched towards it, totally and utterly enraptured by $npc1.him, and even though a tiny voice in your mind knows that it’s completely and utterly stupid to feel like this, you feel totally enamoured with the $npc1.species. It smiles at you, staring deep into your eyes before moving down to your belly and gently, almost tenderly, planting $npc1.his fangs into you. You wince a little, but you can’t bring yourself to object to it. With the $npc1.species deeply biting you, you feel a spreading warmth flowing through you. The $npc1.species brings $npc1.his tail up to you, caressing your gut, which you realise is growing wider and wider. Evidently the venom of the $npc1.species is doing this, but you don’t care. The warmth coupled with the love of the $npc1.species is enthralling. You lean your cheek into the $npc1.species’s, nuzzling it in total, dopey bliss, and the feelings overwhelm you and you drift off to sleep. You awake from your long rest, and stretch a little, blinking the sleep out of your eyes... before you realise you can’t see anything – it’s totally dark. A small inspection of your surroundings confirms your suspicions – the $npc1.species fattened you up and ate you. At first, you feel kind of pleased about it, feeling glad $npc1.he’s happy, but this soon devolves into feelings of regret and sadness at $npc1.him betraying you like this. You begin to cry... before you feel something snap in your mind, and your senses come back. Your feelings of love for the $npc1.species and the memories of the last few minutes instantly vanish. You look around, and realise what happened again without the filter of the hypnosis clouding your judgement. You swear loudly at how easily you were duped, and try to wriggle free, but the long tube shape of the $npc1.species’s insides leave you unsure if you’re going towards or away from $npc1.his mouth. Eventually, you give up and stop fighting. Unconsciousness takes you soon after. 
	&lt;&lt;stuffToBursting&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your final hit knocks the serpent back. It rocks back and forth in a stunned daze, before flopping over onto the ground, unconscious. &lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;beach randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="4" name="spherical shark ai" tags="" position="5275,625" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a $npc1.male $npc1.species, almost ball-shaped from its colossal girth. $npc1.He stares at you with a glint in its eyes, making $npc1.his intentions of using you to make $npc1.himself even wider very clear indeed. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if random(1,5) == 1 and $hea/$maxHea &lt; .25&gt;&gt;
	&lt;li&gt;Devour&lt;/li&gt;
	&lt;&lt;switch setup.dodgeInstaDeath()&gt;&gt;
		&lt;&lt;case true&gt;&gt;
			The $npc1.species attacks, spinning in the water and trying to smack you with $npc1.his tail. You quickly duck down and it sails past your head harmlessly. 
			
		&lt;&lt;default&gt;&gt;
			The $npc1.species attacks, spinning in the water and trying to smack you with $npc1.his tail. Although you move back in the water, you feel a small sting of pain and realise you were still hit by just the tip of $npc1.his tail, leaving you with a small cut. You and the $npc1.species ready yourselves to clash again, but notice the tiny cloud of blood in the water. Both of you share a quick glance of dread, but for different reasons; you, for the fact it’ll attract more wildlife, and $npc1.him for the fact $npc1.he might lose the meal $npc1.he’s been fighting for. Sure enough, a few moments later, another $npc1.species suddenly barges into the one you were fighting - The blood in the water acted like a $npc1.species magnet, and the two of them are squabbling with each other over you. Two $npc1.plural becomes four, then six, all ramming, fin-slapping and generally fighting over you in a manner that could only be more comical if there was a dust cloud building in the fight. You decide to take the chance to slink off, but as soon as you turn, you&#39;re greeted by the sight of a colossal, many-fanged mouth before everything goes black. Evidently, yet another $npc1.species noticed your predicament and went in for an easy meal. You would ordinarily struggle, but the rows of backwards-facing teeth put you off that idea, because they would slice you to ribbons if you tried to back out. The $npc1.species chomps its way over you, sucking in your legs and swallowing, burping in satisfaction as it quickly swims off before the others notice. 
			&lt;hr&gt;
			&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if random(1,2) == 1&gt;&gt;
		&lt;li&gt;Bite&lt;/li&gt;
		The $npc1.species surges forwards, biting at you and dealing $edmg damage. You manage to punch $npc1.him in the gills and $npc1.he lets go before $npc1.he draws blood. 
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;Charge&lt;/li&gt;
		The $npc1.species pulls back then charges, crashing into your gut and dealing $edmg damage. 
		&lt;&lt;if $hea &gt; 0&gt;&gt;
			It winds you, and you expend time and effort getting a breath of air from the surface, and you’re left sore and rattled by the experience. 
			&lt;&lt;if $end &gt; 3&gt;&gt;&lt;&lt;tempBuff &quot;end&quot; -3&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;stamina -10&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;damage $edmg&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You rear back then thrust at the $npc1.species, trying to catch it in your grasp. $npc1.He tries to pull back but you barrel into the $npc1.species’s ample gut, catching $npc1.him off guard. Pinning $npc1.his jaw shut, you push the $npc1.species’s snout into your mouth, grasping at $npc1.his sides and pulling them towards you, forcing its neck and fins into your mouth. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	You crane your jaws wider to move over the $npc1.species, and once you’re past $npc1.his widest part, the rest of $npc1.his wet body slips in, with only a tail hanging out of your mouth. You push the rest of the tail into your mouth, close it and swallow, and you can hear several loud, gnashing snaps from inside your stomach. Fortunately, $npc1.plural have mouths that are positioned in a bad way to get a grip on curved surfaces like the inside of your stomach, because you can feel $npc1.his snout pushing against your stomach walls and presumably getting in the way. You float in the water and gently rub your squirming stomach until it slows till a stop, waiting around for a little bit to give yourself time to digest before you swim off, to stop yourself getting a cramp. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	However, as your gut pushes outwards, a horrible feeling of dread kicks in as you start to suspect your meal is too big, but it’s too far in to spit out, so you press on. The discomfort in your stomach grows, and before long it becomes unbearable. Noticing your diminishing strength and resolve, your prey butts at the inside of your stomach and wiggles in your throat, making both a stomachache and your gag reflex kick in. Your body chooses to completely defy you, and you bring the $npc1.species back up, feeling exhausted enough for you to drift off in the process. In your flickering consciousness, you feel the $npc1.species nom its way over you, taking its time now that its predator turned prey has stopped fighting. 
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You swim under the $npc1.species and then over it, in an attempt to confuse it to give you time to escape. It tries to follow you with its eyes by turning around in the water, and the momentum of its weight makes it spin feebly in the water, flailing a little. By the time $npc1.he&#39;s righted itself and shaken off the dizziness, you’re already gone. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You swim under the $npc1.species and then over it, in an attempt to confuse it and give you time to escape. It quickly rears downwards and slaps you with $npc1.his tail, knocking you away and winding you, making you have to go up for air. By the time you’ve done so the $npc1.species’s already righted itself and is back within attacking distance. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You don’t like the idea of continuing the fight and giving the $npc1.species more reason to bite and otherwise harm you, so you hold out your hand in a halting hand-sign, trying to stop the $npc1.species, wordlessly conveying that you no longer want to fight. The $npc1.species practically screeches to a halt, but bumps into you from $npc1.his inertia. $npc1.He pauses and looks at you, seeing if this is some sort of ploy, but soon opens its mouth wide, swims above you and darts down at you, getting to your waist before it stops, spins in the water so it’s facing up, and swallowing you as best it can. The teeth are thankfully not painful, due to them being backward-facing – They’d only hurt if you tried to tug yourself out. You enter the $npc1.species’s stomach, and soon the gentle sway of the $npc1.species swimming off on its way is enough to rock you to sleep. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The last hit from the $npc1.species takes the last of your strength from you, and you float to the surface of the water and pass out, with your head mercifully above water. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your final attack sends the $npc1.species reeling backwards, rolling in the water so it ends belly up. $npc1.He flaps $npc1.his fin at you a few times in stunned desperation before it falls unconscious. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;ocean randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="5" name="water elemental ai" tags="" position="4775,625" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This strange creature appears to be a blob of water, approaching you with crudely-shaped limbs. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Punch&lt;/li&gt;
		The elemental pummels you with its fist, knocking you for a loop! 
		&lt;&lt;doEdmg&gt;&gt;
		&lt;&lt;damage $edmg&gt;&gt;
		
	&lt;&lt;default&gt;&gt;
		&lt;li&gt;Water Blast&lt;/li&gt;
		The water elemental points it&#39;s dribbling arm towards you face. With a sudden rush of bubbles it fires a blast of water towards your mouth, much of it forcing it&#39;s way down your throat as the rest of it soaks into your $p.fur. You feel your stomach rapidly expand with, thankfully, the cleanest water you&#39;ve ever tasted. 
		&lt;&lt;set _cram = random(4,8)&gt;&gt;
		&lt;&lt;eDamage _cram&gt;&gt;
		&lt;&lt;consume _cram 0&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;

&lt;&lt;if $e.hea &lt;= 0 and $alive&gt;&gt;
	The final blast fires what little remains of the water elemental down your throat. You&#39;re left standing there soaking wet but with no enemy left to fight. It appears you&#39;ve won...? 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You quickly turn and flee, the creature unable to keep up with you as it staggers in pursuit. Within a minute it&#39;s totally out of sight. &lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You kneel on the ground and open your mouth wide for the bubbling water elemental. It wastes no time as it draws in upon itself and fires a watery whirlwind down your waiting throat. You stomach rapidly fills and expands with water. 
&lt;&lt;consume $e.hea 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	You rapidly gulp down the remaining elemental and over time the deluge of water coursing down your throat slows to a trickle and eventually stops as you consume your opponent entirely. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	Your stomach gurgles and groans as it swiftly approaches and passes it&#39;s maximum capacity. You flop over onto your back, causing your stomach to painfully slosh back and forth as it continues to swell outwards. 
	&lt;&lt;if $options.popping&gt;&gt;
		The water elemental slaps your belly to cause it to continue to slosh back and forth as it fills you tighter and tighter. Finally your belly &#39;&#39;bursts&#39;&#39; like a water balloon, spraying water all around. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
As you collapse to your knees in pain, the water elemental grabs you and forces its arm into your mouth, beginning to fill your stomach with itself. You can hear your belly bubbling and creaking as gallon after gallon of water is forced into it...
&lt;&lt;consume $e.hea 0&gt;&gt;


&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
		The water elemental begins punching your belly as it fills, the watery fist squishing in less and less until your water balloon of a belly can&#39;t handle the blows anymore and &#39;&#39;bursts&#39;&#39; open, showering the sand around you. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
		The water elemental slaps your belly to cause it to continue to slosh back and forth as it fills you tighter and tighter. Finally your belly &#39;&#39;bursts&#39;&#39; like a water balloon, spraying water all around. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;battle&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;hr&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the elemental splashes violently apart, sinking into the ground. Nothing remains except a large puddle. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;if $feeder_itemFed.flavors != null and $feeder_itemFed.flavors.includes(&quot;water&quot;)&gt;&gt;
		You ready your $feeder_itemFed.name but hesitate for a moment when you realise that the water elemental doesn&#39;t really have a mouth to insert it into. Just then, a tendril of water shoots from the elemental, sucking up the whole contents of the $feeder_itemFed.name and incorporating the water into its form.
		&lt;&lt;eHealth $feeder_fedAmount&gt;&gt;
		&lt;&lt;feeder_tryRemoveFedItem&gt;&gt;
		
	&lt;&lt;elseif $feeder_itemFed.flavors != null and $feeder_itemFed.flavors.includes(&quot;drink&quot;)&gt;&gt;
		You ready your $feeder_itemFed.name but hesitate for a moment when you realise that the water elemental doesn&#39;t really have a mouth to insert it into. Just then, a tendril of water shoots from the elemental, sucking up the whole contents of the $feeder_itemFed.name. The colors of the liquid slowly fade as it&#39;s incorporated into the elemental&#39;s form.
		&lt;&lt;eHealth $feeder_fedAmount * 0.5&gt;&gt;
		&lt;&lt;feeder_tryRemoveFedItem&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You cram $feeder_itemFed.article $feeder_itemFed.name into the water elemental. It floats harmlessly within the creature&#39;s watery body, before slopping back out onto the floor. You grab the now soggy $feeder_itemFed.name before the elemental retaliates - can&#39;t let good food go to waste!
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="6" name="drunk ai" tags="" position="4900,750" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a bloated drunken $npc1.species who appears to be raring to pick a fight with whoever $npc1.he runs into. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Attack&lt;/li&gt;
		The bloated drunk rears $npc1.his fist back and hits you with a haymaker. 
		&lt;&lt;damage $edmg&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Attack&lt;/li&gt;
		The swollen drunk appears to be nodding off. You pause for a moment, wondering if $npc1.he&#39;s passed out when $npc1.he suddenly slumps forward and headbutts you right in the nose. 
		&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;eHealth -1&gt;&gt;
		
	&lt;&lt;default&gt;&gt;
		&lt;li&gt;Attack?&lt;/li&gt;
		The sloshing drunk tries to rear back $npc1.his fist but somehow manages to get $npc1.his hand caught in $npc1.his own shirt sleeve. 
		
&lt;&lt;/switch&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You lunge at your enemy in an attempt to devour the $npc1.species and you succeed in tackling $npc1.him to the ground. The drunk $npc1.species sloshes about on top of $npc1.his gut as you begin to move $npc1.him. Turning $npc1.him over, $npc1.his stomach lists to one side and then the other from the momentum, making $npc1.him groan. Sitting down, you grab $npc1.his $npc1.feet and pull them into your mouth. As you work $npc1.him down your throat to $npc1.his waist, $npc1.his keg of a belly spills over $npc1.his chest, triggering a drunken, wet belch. $npc1.He groans anew as you work $npc1.his paunch into your mouth, making it slosh with every inch you swallow. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	As you reach $npc1.his armpits, you are forced to lift $npc1.his arms above $npc1.his head. $npc1.He begins to curl in a fetal position around $npc1.his belly as you swallow past $npc1.his head. With a few more great gulps, $npc1.he is forced the rest of the way in as you swallow $npc1.his hands. You stand and saunter off, your own gut giving a heave. After you take a few steps, $npc1.he gives one final great belch, the sensation tickling its way through your belly. After about 15 minutes, you feel a great warmth surge through your belly. Your thoughts slow as you begin to stumble, the warmth suffusing your entire being. It seems that alcohol had to go somewhere. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	As you work $npc1.him down to your stomach, it gives an audible groan. With a sudden surge of pressure, you realize you&#39;ve bitten off more than you could chew. As your mouth closes around his hands, your gut spills forth faster and faster, and you pass out from the strain with a few quiet hiccups. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
The drunk closes $npc1.his eyes for a second and wavers on $npc1.his $npc1.feet. You take this as a good opportunity to run away. As you look over your shoulder, you see the drunk wake up and look around in confusion, $npc1.he shouts something about you just disappearing like magic. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $gld &gt; 3&gt;&gt;
	You grab a few coins out of your pocket and toss them at the drunk. $npc1.He tries to punch the coins out of the air but misses and stumbles. $npc1.He staggers for a bit before noticing those were coins you threw at $npc1.him and $npc1.he bends over to pick the coins up. $npc1.He&#39;s almost pulled off $npc1.his feet by $npc1.his sloshing stomach, but $npc1.he manages to regain his balance and stand up. &quot;Ah, thanksh you kind $p.sir. Believe me thish won&#39;t go to washte!&quot; $npc1.he says before drunkenly sloshing off into the night towards the nearest bar, singing a jaunty tune. 
	&lt;&lt;doGld -3&gt;&gt;
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;elseif $gld &gt; 0&gt;&gt;
	You grab the last of your gold out of your pocket and toss it at the drunk. $npc1.He tries to punch the coins out of the air but misses and stumbles. $npc1.He staggers for a bit before noticing those were coins you threw at $npc1.him and $npc1.he bends over to pick the coins up. $npc1.He&#39;s almost pulled off $npc1.his feet by $npc1.his sloshing stomach, but $npc1.he manages to regain $npc1.his balance and stand up. &quot;What? Thatsh it!&quot; $npc1.he tosses and beer bottle at your head before $npc1.he wobbles off into the night, complaining about people&#39;s lack of charity these days. 
	&lt;&lt;set _gold = $gld * -1&gt;&gt;
	&lt;&lt;doGld _gold&gt;&gt;
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You search your person for any gold you could toss at the $npc1.guy, but you can only shrug your shoulders when you find none. &quot;You thinks I&#39;m fallin&#39; for that? I know you&#39;re holdin&#39; out on me! 
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	
&lt;&lt;/if&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Your vision fades to black as you fall unconscious. 
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The bloated drunk spins around on $npc1.his heel in an attempt to flee but ends up falling flat on $npc1.his swollen gut instead. $npc1.He sloshes back and forth for a second, &quot;//belch// I could takes yous alls outsh if I washn&#39;t soooo... tired.&quot; The drunk passes out and begins snooring and occasionally hiccuping very loudly. Apparently you&#39;ve won. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;set _randomization = &quot;market square movement&quot;&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;
		&lt;&lt;set _randomization = &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false _randomization&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="7" name="takeout terror ai" tags="" position="5025,750" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
&lt;p&gt;You’re brought up short as a hugely fat $npc1.species waddles towards you- practically so wide that there’s no space in the street to avoid him. The ground shakes beneath his thunderous footfalls. His shirt and denim pants are bursting at the seams, his belly so bloated it hangs past his knees. He resembles a hot-air balloon stuffed into a set of clothes. Obviously having been gorging for hours, the $npc1.species is occupied greedily devouring something from a crumpled parchment bag, accompanied by a strong smell of fried food, but as you watch he balls the now-empty bag up and tosses it away, obviously STILL not satisfied. Catching sight of you, he pants, &quot;Hey, y-you there! You’ve gotta lend me some GOLD!&quot; His enormous middle emits a subterranean rumble, and he adds desperately. &quot;You don’t understand, I just… gotta get some more CHOW!&quot; A slightly crazed look enters his food-fuddled gaze, and he looms over you like a wrecking ball. &quot;In fact… you’re look mighty tasty there… if you’ve not got any gold maybe I’ll j-just eat YOU!&quot; &lt;/p&gt;

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Devour&lt;/li&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 3&gt;&gt;
			As you squirm helplessly against in your vast opponent’s obese embrace, you feel his gigantic blubbersome belly rumble ominously against you. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			All this fighting has worked up an appetite. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 1&gt;&gt;
			He moans, and then $npc1.angry ravenously. &quot;More food... MORE... FOOOOOD...!&quot; Still compressed against that mountain of chub, you feel yourself being bodily lifted off your $p.feet, scraping against the rolls and folds of his overfed frame as you go. You’re brought face-to-face with him, both of you sweating with exertion, though his face is the fatter by far. His eyes have a distant, hungry quality. He&#39;s not seeing &#39;you&#39;, just one of the biggest portions of takeout he’s ever seen. His gut emits another deep gurrrrrgling sound and he opens wiiiiiiiide, stuffing you head-first down his gullet. It takes him some time, but he manages to stuff all of you in in one bite, aided by the grease from all the fried foods he&#39;s inhaled previously. 
			&lt;&lt;if setup.weight() &gt; 600&gt;&gt;
				Your $fatness belly gives him some difficulty, but he stolidly pushes more and more of you in with his hands, mouth stretching wider and wider to accommodate all of it. 
			&lt;&lt;/if&gt;&gt;
			By the time your nose is tickling at his stomach, you can feel his jaws pressing on your backside while your legs kick helplessly. A muffled rrrrrip! sound tells you that your devourer has just burst out of his clothes, followed by a shuddering THUMP that suggests he’s just fallen onto his enormous butt, too stuffed to move. You’re pressed into his capacious stomach, stretching it 
			&lt;&lt;if setup.weight() &lt; 300&gt;&gt;slightly
			&lt;&lt;elseif setup.weight() &lt; 450 and setup.weight() &gt;= 300&gt;&gt;moderately
			&lt;&lt;elseif setup.weight() &lt; 600 and setup.weight() &gt;= 450&gt;&gt;significantly
			&lt;&lt;else&gt;&gt;hugely
			&lt;&lt;/if&gt;&gt;. You can feel your devourer’s fat hands rubbing weakly at his stretched sides, pressing against you through the deep layers of blubber. It’s very hot and stuffy in there, and mercifully you quickly lose consciousness. You can only imagine how fat this guy’s going to be after digesting YOU... 
			&lt;hr&gt;
			&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,6)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Squash&lt;/li&gt;
			&lt;&lt;if setup.dodge() and setup.weight() &lt; 500&gt;&gt;
				With a growl the vastly-overfed $npc1.species tries to pin you against the nearest wall with his stomach, but fortunately for you you’re able to dodge free just in time. There’s a loud SMACK as his bare belly hits the stonework. Ouch, that’s got to SMART... 
				
			&lt;&lt;elseif setup.weight() &lt; 500&gt;&gt;
				With a growl the vastly-overfed $npc1.species steps forward and literally bulldozes you against the nearest wall with his blubber-blown belly- it’s a wonder the collision doesn’t knock the wall down. Squashed against the stonework like an insect, you wheeze as all the breath is pressed out of you. 
				&lt;&lt;damage $edmg&gt;&gt;
			
			&lt;&lt;else&gt;&gt;
				&lt;&lt;if $fat &gt; 100&gt;&gt;
					With a growl, the vastly-overfed $npc1.species steps forward and attempts to bulldoze you with his blubber-blown belly. His belly squishes against your own oversized belly as he tries to shove you into the nearest wall, but you&#39;re just too heavy to be pushed around. He eventually gives up and stumbles back in frustration, causing both your bellies to ripple and jiggle furiously as they come apart. 
				&lt;&lt;else&gt;&gt;
					With a growl, the vastly-overfed $npc1.species steps forward and attempts to bulldoze you with $npc1.his blubber-blown belly. $npc1.His overabundant flab squishes against your hardened, muscular body as $npc1.he tries to shove you into the nearest wall, but you manage to brace yourself and push back with all your considerable strength, upsetting $npc1.his balance. $npc1.He’s forced to stumble back, $npc1.his belly rippling and jiggling furiously. 
				&lt;&lt;/if&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Punch&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				Your jumbo-sized adversary swings a podgy fist at you, but luckily he’s so lumbering that you see it coming in time and duck. His fist sails through empty air and he has to windmill violently to retain balance, giving you time to move clear. 
				
			&lt;&lt;else&gt;&gt;
				Your jumbo-sized adversary swings a podgy fist at you in a roundhouse punch. It connects with your chin and you practically spin around. He may be slow, but that swing’s got a LOT of weight behind it. 
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Snack&lt;/li&gt;
			Squaring up to you, your opponent’s nose starts to twitch. He spots a discard food wrapper on the floor, and forgetting all about you for the moment bends down and grabs it. You expect the seam of his pants to burst at any second. There’s obviously some of the snack remaining, because he upends the wrapper over his snout and devours the contents. Wiping his greasy lips with a fat $npc1.hand, the massively obese $npc1.species returns his attention to you... 
			&lt;&lt;eHealth 10&gt;&gt;
			
		&lt;&lt;case 4&gt;&gt;
			&lt;li&gt;Button-burst&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				Your fat opponent swings a punch at you violently, clothes //creeeaking// in protest at the sudden movements. With a loud POP a button SNAPS free of his shirt and ricochets harmlessly off the wall behind you. A bit more of his vast paunch hangs free of his clothing and he grunts in irritation.
				
			&lt;&lt;else&gt;&gt;
				Your fat opponent swings a punch at you violently, clothes //creeeaking// in protest at the sudden movements. With a loud POP a button SNAPS free of his shirt and hits you with near ballistic speed. You stagger painfully, while your adversary grunts and looks satisfied now that he can move a bit more freely. 
				&lt;&lt;set $edmg *= 0.8&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;if random(1,100) &lt; 30&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
					
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 5&gt;&gt;
			&lt;li&gt;Belch&lt;/li&gt;
			As you prepare to attack an ominous GLORP arises from you massive opponent’s belly. He puts both hands to the sides of his stomach and lets out a colossal BURRRRRAP! It’s worse than standing underneath a church bell when it’s struck. The noise echoes down the darkened streets and sends you reeling, clutching your ears defensively. 
			&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
			
		&lt;&lt;case 6&gt;&gt;
			&lt;li&gt;Grab&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				Your hugely obese opponent makes a sudden lunge at you, trying to catch you off-guard. Fortunately he’s so colossally lumbering that you manage to dodge, and he stampedes right past you, unable to change course in time. 
				
			&lt;&lt;else&gt;&gt;
				Your hugely obese opponent makes a sudden lunge at you, taking you by surprise. His blubbery bulk SER-MACKS against you and he manages to get one fat arm wrapped around you in a headlock. You can feel the rolls of flab on his bloated arm wobble and smoosh against your face as you struggle to breathe, while that mammoth belly rolls up and rests on your back like some gargantuan boulder, pinning you down. Talk about... throwing your weight around... 
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				&lt;&lt;set $e.special = 3&gt;&gt;
					
			&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
With a sharp kick you manage to trip up the huge fatso, who &#39;&#39;SLAMS&#39;&#39; down onto his huge stomach and sprawls there on top of it, panting and winded. With a loud //POP// his clothes finally burst, leaving a lot of bare fur on display. He looks extremely... appetising. Greedily you grab the overblown $npc1.species under his fat armpits and haul him to his knees, his belly wobbling heavily against you. Then you open your jaws WIDE and stuff him in, face-first! Even his head is something of a mouthful, with those bloated cheeks to squeeze in and that chubby neck to follow. He lets out a muffled protest and tries to squirm free. Bracing yourself, you HEAVE upwards and stretch your maw to encompass his flabby chest, then slide your hands down to grab under his bloated sides for more grip. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Heaving and hauling, you stuff the struggling superchub down your throat like some massively-oversized marshmallow, having some difficulty with those chubby arms but eventually getting them licked- quite literally. By the time it comes to his stomach you’re seated heavily on the floor and are hefting his spherical bulk above your head with your arms. You struggle to pass his equator, but after that it’s really just a matter of swallowing. It takes the biggest GULP of your life, but down he slides, distorting your neck hugely as he descends, your entire body stretching to accommodate him in your middle. You sprawl onto your back in the street, stomach ready to pop, and let out a deep moan, jostling your gut weakly with your $p.hands to settle it. Finally a deep //BURRRP// wells up from within you, and you start to feel a little better. Sluggishly you heave yourself back onto your $p.feet, belly weighing like an anchor, and slowly waddle off, arms stuck out to your sides. Now THAT’s what you call takeout... 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	Heaving and hauling, you try to stuff the struggling superchub down your throat like some massively-oversized marshmallow, but by the time you reach his stomach you realise you’ve bitten off more than you can chew. Seated heavily on the ground, you heave his weight above your head in an effort to swallow him. All that blubber bears down on you and you feel your jaws stretch, and stretch, and stretch... he sinks down unstoppably, and your eyes widen as you feel yourself expand far more than you ever should as he fills you to capacity, and then more, and more, and more, until you’re so stretched out he’s wearing you like a second skin. You’re left helpless, imprisoned from within by the vast bulk of the huge fatso you’ve just golloped down. The strain is making you dizzy, and your ears start to ring as if you’re underwater. 
	&lt;&lt;if !$options.popping&gt;&gt;
		The world begins to fade, replaced by white light that grows brighter, and brighter, and brighter... 
		
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You let out a stifled moan, but this is drowned out by a deep, muffled //BURRRP// from your super-swollen stomach. You feel yourself shift and rock around as your ‘meal’ squirms and tries to sit up inside of you, stretching your hide to near transclucent-tightness. You feel a couple of loud, organic-sounding //pops// inside you, and suddenly you’re stretching further again. This can’t be good. The pressure inside you grows to unbearable levels, and you shut your eyes and whimper as you grow tighter, and tighter, and tighter... 
		
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
Going purple in the face, you squirm and struggle against this overfed brute’s huge bulk, which wobbles and ripples as you try to break free- it’s like fighting a vast ball of dough. You manage to prize his obese arm off of your neck, and SHOVE him backwards- though mostly you wind up just bouncing free of him as his gut rebounds against you. 


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
Going purple in the face, you squirm and struggle against this overfed brute’s huge bulk, which wobbles and ripples as you try to break free- it’s like fighting a vast ball of dough. Try as you might, you’re unable to escape from this lardball’s chubby grip. You shove hard against him, but all you do is sink into his soft blubber. And he STINKS of fried food... 


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
People who say a fat animal isn’t intimidating have obviously never been up close and personal with one. You suddenly dodge left, then right, and try to sprint past the colossally chubby $npc1.species. Caught off-balance, you make it past and get behind him! Fortunately he’s so unwieldy that by the time he’s managed to turn around, you’re well up the street and too far off for him to catch. You here a bellow of anger- followed by a deafening belly-rumble- but, for today at least, you’re nobody’s snack. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
People who say a fat animal isn’t intimidating have obviously never been up close and personal with one. You suddenly dodge left, then right, and try to sprint past the colossally chubby $npc1.species. Unfortunately, he picks the same direction as you and so stomps into your path. There’s not enough room to get past! You SMACK into his huge belly and rebound as firmly as if you’d hit a crash-mat. He, in contrast, barely registers the collision with nothing more than a stifled grunt. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $gld &gt;= 8&gt;&gt;
	A look of gluttonous glee spreads over the super-fattened $npc1.species’s face as you hand over 8 gold. &quot;Oof, thanks, I- BURRP!-just got time to make it for DESSERT!&quot; Without another word he squeezes past you, practically smooshing you into the wall. You’re left a little bruised, but otherwise unharmed. 
	&lt;&lt;doGld -8&gt;&gt;
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;if $gld &gt; 1&gt;&gt;
		You take out you last $gld gold and toss them at him. The coins bounce of his gut with several pings and he looks back at you, apparently still not satisfied. 
		&lt;&lt;set _gold = $gld * -1&gt;&gt;
		&lt;&lt;doGld _gold&gt;&gt;


	&lt;&lt;elseif $gld == 1&gt;&gt;
		You take out the last gold coin you have and toss it at him. It bounces off his gut with a soft ping and falls to the ground. He looks back up at you, clearly still not satisfied. 
		&lt;&lt;doGld -1&gt;&gt;

	&lt;&lt;else&gt;&gt;
		With a sigh you rummage in your inventory, but find yourself embarrassingly short of cash. 

	&lt;&lt;/if&gt;&gt;
		
	A look of desperation and annoyance begins to crease the fatso’s face, 
	&lt;&lt;set _takeoutTerrorFood = &quot;&quot;&gt;&gt;
	
	&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;
		&lt;&lt;capture _i&gt;&gt;
			&lt;&lt;if $inventory[_i].type == &quot;food&quot;&gt;&gt;
				&lt;&lt;set _takeoutTerrorFood = $inventory[_i]&gt;&gt;
				&lt;&lt;break&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/capture&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	
	&lt;&lt;if _takeoutTerrorFood == &quot;&quot;&gt;&gt;
		and you frantically look for some food as a substitute, but there’s nothing that’ll satisfy an appetite like THIS. Suddenly losing patience, the butterball $npc1.species grabs hold of you with his fat, surprisingly strong hands, belly rolling up against you like a soft wrecking-ball. &quot;More food... MORE... FOOOOOD...!&quot; Still compressed against that mountain of chub, you feel yourself being bodily lifted off your $p.feet, scraping against the rolls and folds of his overfed frame as you go. You’re brought face-to-face with him, both of you sweating with exertion, though his face is the fatter by far. His eyes have a distant, hungry quality. He&#39;s not seeing &#39;you&#39;, just one of the biggest portions of takeout he’s ever seen. His gut emits another deep gurrrrrgling sound and he opens wiiiiiiiide, stuffing you head-first down his gullet. It takes him some time, but he manages to stuff all of you in in one bite, aided by the grease from all the fried foods he&#39;s inhaled previously. 
		&lt;br&gt;&lt;br&gt;
		
		&lt;&lt;if setup.weight() &gt; 600&gt;&gt;
			Your $fatness belly gives him some difficulty, but he stolidly pushes more and more of you in with his hands, mouth stretching wider and wider to accommodate all of it. 
		&lt;&lt;/if&gt;&gt;
		By the time your nose is tickling at his stomach, you can feel his jaws pressing on your backside while your legs kick helplessly. A muffled rrrrrip! sound tells you that your devourer has just burst out of his clothes, followed by a shuddering THUMP that suggests he’s just fallen onto his enormous butt, too stuffed to move. You’re pressed into his capacious stomach, stretching it 
		&lt;&lt;if setup.weight() &lt; 300&gt;&gt;slightly
		&lt;&lt;elseif setup.weight() &lt; 450 and setup.weight() &gt;= 300&gt;&gt;moderately
		&lt;&lt;elseif setup.weight() &lt; 600 and setup.weight() &gt;= 450&gt;&gt;significantly
		&lt;&lt;else&gt;&gt;hugely
		&lt;&lt;/if&gt;&gt;
		. You can feel your devourer’s fat hands rubbing weakly at his stretched sides, pressing against you through the deep layers of blubber. It’s very hot and stuffy in there, and mercifully you quickly lose consciousness. You can only imagine how fat this guy’s going to be after digesting YOU... 
		&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		but at the last minute you manage to rustle up _takeoutTerrorFood.article _takeoutTerrorFood.Name, and his face lights up. Without another word he snatches it from you and crams it into his mouth with greedy grunts. While he’s distracted, you make a hasty getaway, appalled equally by the fact that that you were so easily bullied and by the table-manners you’ve just witnessed. 
		&lt;&lt;removeItem _takeoutTerrorFood&gt;&gt;
		&lt;&lt;endCombat&gt;&gt;
		&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
		
		
	&lt;&lt;/if&gt;&gt;
			

&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;p&gt;You slump weakly against this monster’s massive stomach, defeated by his sheer BULK. You sink to your knees, face resting against that huge stomach, which lets out a cavernous rumble. You feel your opponent’s fat arms grab you, smooshing and pinning you against all that flab, but you’re too weak to fight back. Your face winds up pressed into his gargantuan chest. He lets out a ravenous $npc1.angry. &quot;More food... MORE... &#39;&#39;FOOOOOD&#39;&#39;...!&quot; Still compressed against that mountain of chub, you feel yourself being bodily lifted off your $p.feet, scraping against the rolls and folds of his overfed frame as you go. You’re brought face-to-face with him, both of you sweating with exertion&lt;&lt;if $fat &lt; 500&gt;&gt;, though his face is the fatter by far&lt;&lt;/if&gt;&gt;. His eyes have a distant, hungry quality. He’s not seeing &#39;you&#39;, just one of the biggest portions of takeout he’s ever seen. His gut emits another deep //gurrrrrgling// sound and he opens wiiiiiiiide, stuffing you head-first down his gullet. It takes him some time, but he manages to stuff all of you in in one bite, aided by the grease from all the fried foods he’s inhaled previously. &lt;/p&gt;

&lt;&lt;if setup.weight() &gt; 600&gt;&gt;
	Your $fatness belly gives him some difficulty, but he stolidly pushes more and more of you in with his hands, mouth stretching wider and wider to accommodate all of it. 
&lt;&lt;/if&gt;&gt;

By the time your nose is tickling at his stomach, you can feel his jaws pressing on your backside while your legs kick helplessly. A muffled //rrrrrip//! sound tells you that your devourer has just burst out of his clothes, followed by a shuddering THUMP that suggests he’s just fallen onto his enormous butt, too stuffed to move. You’re pressed into his capacious stomach, stretching it &lt;&lt;if setup.weight() &lt; 300&gt;&gt;slightly
&lt;&lt;elseif setup.weight() &lt; 450 and setup.weight() &gt;= 300&gt;&gt;moderately
&lt;&lt;elseif setup.weight() &lt; 600 and setup.weight() &gt;= 450&gt;&gt;significantly
&lt;&lt;else&gt;&gt;hugely
&lt;&lt;/if&gt;&gt;. You can feel your devourer’s fat hands rubbing weakly at his stretched sides, pressing against you through the deep layers of blubber. It’s very hot and stuffy in there, and mercifully you quickly lose consciousness. You can only imagine how fat this guy’s going to be after digesting YOU... 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The massively obese $npc1.species staggers one last time and teeters precipitously on his $npc1.feet, until the weight of his he backside pulls him down with a THUMP that makes the surrounding buildings shake, accompanied by a RRIP as his clothes finally burst apart. He moans and topples onto his back, belly rising up level with your chin, heaving in time with his panting breath. Looks like this guy won’t be hassling anyone soon- not until he can get up. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;set _randomization = &quot;market square movement&quot;&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;
		&lt;&lt;set _randomization = &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false _randomization&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="8" name="thief ai" tags="" position="4775,750" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a thief who’s clearly packed on a few pounds. $npc1.His leather armor is bursting at the seams all over and appears to be comically held together with bits of rope. $npc1.He’s wielding a vicious-looking dagger though. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;set _chance = random(1,5)&gt;&gt;
&lt;&lt;if _chance == 1 and $e.gld &gt;= 15&gt;&gt;
	&lt;li&gt;Run&lt;/li&gt;
	The thief, satisfied with $npc1.his &quot;earnings&quot; turns to run away
	&lt;&lt;if $e.agi &gt; $agi&gt;&gt;
		 and leaves you behind in the dust. 
		&lt;&lt;endCombat&gt;&gt;
		&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;
			&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;include &quot;market square movement&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		, but you catch up to $npc1.him before $npc1.he can get away. 
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;elseif _chance == 2 and $agi &gt; $e.agi&gt;&gt;
	&lt;li&gt;Pocket Sand!&lt;/li&gt;
	&lt;&lt;if $str &gt; 250&gt;&gt;
	The thief reaches into $npc1.his pocket and shouts, &quot;Pocket sand!&quot; before throwing a handful of sand in your face. You stumble back in surprise as you cough and cover your eyes. When you uncover them, the thief is nowhere to be seen. The sound of panicked footsteps recedes into the distance as the thief makes good $npc1.his escape. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;
		&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;include &quot;market square movement&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
	The thief reaches into $npc1.his pocket and shouts, &quot;Pocket sand!&quot; before throwing a handful of sand in your face. You stumble back in surprise as you cough and cover your eyes. Your speed is lowered from the irritation. 
	&lt;&lt;set _debuff = random(-2,-4)&gt;&gt;
	&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;elseif _chance == 3 or _chance == 4 and $e.gld &lt; 15&gt;&gt;
	&lt;li&gt;Steal&lt;/li&gt;
	&lt;&lt;set _tempInt = random(0,$gld * .1)&gt;&gt;
	The fat thief feints right. As you&#39;re distracted, $npc1.his hand darts into one of your pockets 
	&lt;&lt;if $gld &lt;= 0 or _tempInt &lt;= 0&gt;&gt;
		but $npc1.he comes up dissapointed as $npc1.he finds no gold in that pocket. 
	&lt;&lt;else&gt;&gt;
		stealing _tempInt gold, $npc1.his weight clearly not hindering $npc1.his thieving abilities. 
		&lt;&lt;set $e.gld += _tempInt&gt;&gt;
		&lt;&lt;set _tempInt *= -1&gt;&gt;
		&lt;&lt;doGld _tempInt&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;else&gt;&gt;
	&lt;li&gt;Attack&lt;/li&gt;
	The thief deftly slashes at you with $npc1.his dagger. 
	&lt;&lt;damage $edmg&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You lunge at your enemy in an attempt to devour the $e.name and you succeed in tackling $npc1.him to the ground. You roll the $npc1.species thief onto $npc1.his back, $npc1.his stomach swaying back and forth a bit from the momentum. As you untie the rope holding $npc1.his armor together, it bursts off from $npc1.his strained form piece by piece, $npc1.his pudgy features jiggling a bit after the relieved pressure. Even so, $npc1.his stomach is still barely contained by $npc1.his jeans, let alone $npc1.his torn tunic. Grabbing his tunic, you haul $npc1.him to $npc1.his feet and start to devour $npc1.him face first. You shove $npc1.his face into your throat, your swallowing pulling $npc1.him in bit by bit. Pinning $npc1.his arms to the side, you pull $npc1.him in up to $npc1.his chest, then $npc1.his stomach, your jaw sinking into $npc1.his belly. You begin to hear muffled shouts coming from your belly as $npc1.his head and arms enter it. He begins to kick $npc1.his feet, forcing you to swallow rapidly to pin them together and stop $npc1.him from escaping. 
&lt;&lt;consume $e.weight 0&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
	Your gut bulges as $npc1.he presses on your belly in an attempt to push himself out. As your mouth finally closes around $npc1.his feet, you give a final massive gulp and curl $npc1.him up in your belly. Your gut lurches from side to side from $npc1.his struggles as you $walk off, rubbing it as you listen to $npc1.his muffled cursing. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	As you try to swallow $npc1.him further, you gag as you realize your stomach won&#39;t stretch any further. Your stomach bulges as $npc1.he begins to push himself out with $npc1.his hands, aided by $npc1.his leg thrashing. You gag again as you disgorge $npc1.him, the momentum causing you to tumble to the ground. As you hack and cough from your painful failed attempt to devour the thief, $npc1.he takes it upon $npc1.himself to rifle through your pockets. 
	&lt;&lt;set _tempGLD = -15&gt;&gt;
	&lt;&lt;if $gld &gt; 0&gt;&gt;
		$npc1.He managed to pilfer 
		&lt;&lt;if $gld + _tempGLD &lt;= 0&gt;&gt;
			&lt;&lt;set _tempGLD = $gld * -1&gt;&gt;
			all your gold 
		&lt;&lt;else&gt;&gt;
			some of your gold 
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _tempGLD = 0&gt;&gt;
		You hear $npc1.him cursing you for being so poor 
	&lt;&lt;/if&gt;&gt;
	before whacking you hard over the back of your head, knocking you unconcious. 
	&lt;&lt;if _tempGLD != 0&gt;&gt;&lt;&lt;doGld _tempGLD&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;defeated &quot;battle&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;&lt;if $str &gt; 250&gt;&gt;
&lt;li&gt;&quot;Escaped!&quot;&lt;/li&gt;
You lower your $wea.name and make a shooing motion toward the thief. $npc1.He takes the hint and sprints away as fast as $npc1.his legs can carry $npc1.him. 
&lt;&lt;else&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You find an opportunity to flee and take advantage of it. The thief, not one for heroics, runs off also. 
&lt;&lt;/if&gt;&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;&lt;if $str &gt; 250&gt;&gt;
	&lt;li&gt;&quot;Escaped!&quot;&lt;/li&gt;
	You lower your $wea.name and make a shooing motion toward the thief. $npc1.He takes the hint and sprints away as fast as $npc1.his legs can carry $npc1.him. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;li&gt;Run failed!&lt;/li&gt;
	You failed to escape! 
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;





/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;if $gld &gt; 8&gt;&gt;
	&lt;&lt;if $str &gt; 250&gt;&gt;
	Against your better judgment, you reach into your pocket for a few coins and toss them at the thief. $npc1.He&#39;s so surprised that $npc1.he almost fails to catch the gold. &quot;Um... thanks?&quot; The $npc1.species quickly runs off before you can change your mind. 
	&lt;&lt;else&gt;&gt;
	You quickly toss a handful of gold at the $npc1.species in hopes that it&#39;ll make $npc1.him go away. $npc1.He deftly snatches the gold out of the air. &quot;Good choice, sucker.&quot; And with that, $npc1.he dashes off into the night. 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -8&gt;&gt;


&lt;&lt;elseif $gld &gt; 0&gt;&gt;
	&lt;&lt;if $str &gt; 250&gt;&gt;
	Against your better judgment, you reach into your pocket for what gold you have left and toss it at the thief. $npc1.He&#39;s so surprised that $npc1.he almost fails to catch the gold. &quot;Um... thanks?&quot; The $npc1.species quickly runs off before you can change your mind. 
	&lt;&lt;else&gt;&gt;
	You quickly toss what gold you have left at the $npc1.species in hopes that it&#39;ll make $npc1.him go away. $npc1.He deftly snatches the gold out of the air. &quot;Good choice, sucker.&quot; And with that, $npc1.he dashes off into the night. 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set _gold = -1 * $gld&gt;&gt;
	&lt;&lt;doGld _gold&gt;&gt;


&lt;&lt;else&gt;&gt;
	You search your person for any gold you might have, but you can only shrug your shoulders at $npc1.him when you come up with nothing. The $npc1.species sighs angrily. &quot;What a waste.&quot; and with that $npc1.he angrily skulks off into the night. 
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Your vision fades to black as you fall unconscious. 

&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The fat thief stumbles and kneels to the ground. &quot;I just needed money... for another... dozen doughnuts!&quot; he sighs before collapsing unconscious. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;&lt;&lt;include &quot;central square movement&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;include &quot;market square movement&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;set _randomization = &quot;market square movement&quot;&gt;&gt;
	&lt;&lt;if $e.exit == &quot;Central Square&quot;&gt;&gt;
		&lt;&lt;set _randomization = &quot;central square movement&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false _randomization&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="9" name="bear ai" tags="" position="4900,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is an enormous $npc1.species that&#39;s clearly prepared for several years worth of hibernation. Thick layers of fat ripple accross $npc1.his entire body, $npc1.his gut nearly dragging on the floor. $npc1.He bares $npc1.his $npc1.teeth at you, clearly eager to add even more to $npc1.his ponderous waist. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
	&lt;&lt;doEdmg&gt;&gt;
	&lt;&lt;set _random to random(1,4)&gt;&gt;

	/*Devour attack*/
	&lt;&lt;if _random == 1 and $npc1.hea &lt; 20&gt;&gt;
  	&lt;li&gt;&#39;&#39;Devour&#39;&#39;&lt;/li&gt;
  
  	&lt;&lt;if setup.dodgeInstantDeath()&gt;&gt;
  	The overfed $npc1.species senses a moment of weakness and lunges at you, but you deftly manage to dodge out of the way. 
  
  	&lt;&lt;else&gt;&gt;
	The overfed $npc1.species senses a moment of weakness and grabs you. $npc1.He clumsily picks you up in $npc1.his paws and pulls you into $npc1.his massive maw. You struggle against $npc1.him, but $npc1.he proves too strong for you as your slowly pulled into $npc1.his waiting mouth. $npc1.He swallows you down whole in several large gulps as you slide into $npc1.his stomach.

	&lt;&lt;if setup.weight() &lt; 200&gt;&gt;You barely make a bulge in $npc1.his tremendously fat frame. 
	&lt;&lt;elseif setup.weight() &lt; 500&gt;&gt;You make a significant bulge in $npc1.his gut, even through the several inches of fat. 
	&lt;&lt;else&gt;&gt;You make a tremendous bulge in the $npc1.species&#39;s already well widened frame. $npc1.His gut stretches out to the sides and rests solidly on the ground. 
	&lt;&lt;/if&gt;&gt;
	&lt;br&gt;&lt;br&gt;

	The $npc1.species sleepily smacks $npc1.his lips and rolls over to sleep off $npc1.his most recent feast in preparation for the next one. Your vision fades to black as you drift into unconsciousness. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	/*Roar*/
	&lt;&lt;elseif _random == 2&gt;&gt;
  	&lt;li&gt;&#39;&#39;Roar&#39;&#39;&lt;/li&gt;
  	The massive $npc1.species lets out a similarly massive roar, causing you to shake in fear, temporarily lowering your strength and speed. 
 	&lt;&lt;set _debuff = random(-1,-3)&gt;&gt;
 	&lt;&lt;tempBuff &quot;str&quot; _debuff&gt;&gt;
 
 	&lt;&lt;set _debuff = random(-1,-3)&gt;&gt;
	&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;

	/*Normal attack*/
	&lt;&lt;else&gt;&gt;
  	&lt;li&gt;&#39;&#39;Attack!&#39;&#39;&lt;/li&gt;
  	The fat $npc1.species lets out a roar and swipes at you with $npc1.his massive paw. 
  	&lt;&lt;damage $edmg&gt;&gt;

	&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
	You lunge at your enemy in an attempt to devour the obese $npc1.species and you succeed in tackling $npc1.him to the ground. You approach the massive $npc1.species as it rests on its back, its belly moving up and down as $npc1.he pants. You grab $npc1.his front paws and pull them so $npc1.he sits up. Holding them, you pull backwards, lifting them and stuffing them into your mouth. Your mouth stretches wider and wider as you use your arms to pull the $npc1.species inward, slowly engulfing $npc1.him bit by bit. 
&lt;br&gt;&lt;br&gt;

	It is a massive undertaking, your feet digging grooves into the ground as you fight the $npc1.species&#39;s inertia. Your jaws strain as you engulf the $npc1.species&#39;s flabby head and neck. Your stomach grumbles in anticipation of the feast, causing you to drool copiously. You slowly and agonizingly work your way across the chest and around the gut, your lips making a deep groove in $npc1.his adipose. 
&lt;&lt;set _calories = $e.weight*0.5&gt;&gt;
&lt;&lt;consume $e.weight _calories&gt;&gt;
&lt;br&gt;&lt;br&gt;

	&lt;&lt;if $alive&gt;&gt;
	As the $npc1.species&#39;s arms enter your stomach, $npc1.he begins to curl up. Your gut begins to splay out as you swallow more, the size of the $npc1.species&#39;s gut making it almost impossible to swallow, but somehow, you manage. As you get your jaws around the widest part, gravity takes over and causes the $npc1.species to surge into your mouth, knocking you onto your rump as you no longer need to pull the bear in. As your jaws close around $npc1.his feet, you lay back down to rest, giving one final swallow to curl $npc1.him in your gut, which heaves up and down as you breathe like the $npc1.species&#39;s did. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

	&lt;&lt;else&gt;&gt;
	As the $npc1.species&#39;s arms enter your stomach, you begin to struggle as the arms fill it completely. Your feet slip at the sudden stop in motion, and as you fall on your back, the $npc1.species pulls itself out of your maw and stands, an angry, hungry look in $npc1.his eyes. 
	&lt;&lt;set _undo = $e.weight * -1&gt;&gt;
	&lt;&lt;set _calories *= -1&gt;&gt;
	&lt;&lt;consume _undo _calories&gt;&gt;

	&lt;br&gt;&lt;br&gt;
	The overfed $npc1.species senses a moment of weakness and grabs you. $npc1.He clumsily picks you up in $npc1.his paws and pulls you into $npc1.his massive maw. You struggle against $npc1.him, but $npc1.he proves too strong for you as your slowly pulled into $npc1.his waiting mouth. $npc1.He swallows you down whole in several large gulps as you slide into $npc1.his stomach.
							
	&lt;&lt;if setup.weight() &lt; 200&gt;&gt;
	You barely make a bulge in $npc1.his tremendously fat frame. 

	&lt;&lt;elseif setup.weight() &lt; 500&gt;&gt;
	You make a significant bulge in $npc1.his gut, even through the several inches of fat. 
					
	&lt;&lt;else&gt;&gt;
	You make a tremendous bulge in the $npc1.species&#39;s already well widened frame. $npc1.His gut stretches out to the sides and rests solidly on the ground. 
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;

	The $npc1.species sleepily smacks $npc1.his lips and rolls over to sleep off $npc1.his most recent feast in preparation for the next one. Your vision fades to black as you drift into unconsciousness.

	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
	&lt;li&gt;Escaped!&lt;/li&gt;
	You flee from the battle. The rotund $npc1.species chases after you for a while, looking like a roiling sea of $npc1.furBack fat, but $npc1.he quickly becomes tired and decides to look for easier prey. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
	You slump to the ground, too weak to continue fighting. The overfed $npc1.species senses a moment of weakness and grabs you. $npc1.He clumsily picks you up in $npc1.his paws and pulls you into $npc1.his massive maw. You struggle against $npc1.him, but $npc1.he proves too strong for you as your slowly pulled into $npc1.his waiting mouth. $npc1.He swallows you down whole in several large gulps as you slide into $npc1.his stomach.
	&lt;&lt;if setup.weight() &lt; 200&gt;&gt;You barely make a bulge in $npc1.his tremendously fat frame. 
	&lt;&lt;elseif setup.weight() &lt; 500&gt;&gt;You make a significant bulge in $npc1.his gut, even through the several inches of fat. 				
	&lt;&lt;else&gt;&gt;You make a tremendous bulge in the $npc1.species&#39;s already well widened frame. $npc1.His gut stretches out to the sides and rests solidly on the ground. &lt;&lt;/if&gt;&gt;
	&lt;br&gt;&lt;br&gt;
	The $npc1.species sleepily smacks $npc1.his lips and rolls over to sleep off $npc1.his most recent feast in preparation for the next one. Your vision fades to black as you drift into unconsciousness. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
	You slump to the ground, too weak to continue fighting. The overfed $npc1.species senses a moment of weakness and grabs you. $npc1.He clumsily picks you up in $npc1.his paws and pulls you into $npc1.his massive maw. You struggle against $npc1.him, but $npc1.he proves too strong for you as your slowly pulled into $npc1.his waiting mouth. $npc1.He swallows you down whole in several large gulps as you slide into $npc1.his stomach.
	&lt;&lt;if setup.weight() &lt; 200&gt;&gt;You barely make a bulge in $npc1.his tremendously fat frame. 
	&lt;&lt;elseif setup.weight() &lt; 500&gt;&gt;You make a significant bulge in $npc1.his gut, even through the several inches of fat. 				
	&lt;&lt;else&gt;&gt;You make a tremendous bulge in the $npc1.species&#39;s already well widened frame. $npc1.His gut stretches out to the sides and rests solidly on the ground. &lt;&lt;/if&gt;&gt;
	&lt;br&gt;&lt;br&gt;
	The $npc1.species sleepily smacks $npc1.his lips and rolls over to sleep off $npc1.his most recent feast in preparation for the next one. Your vision fades to black as you drift into unconsciousness. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
	The obese $npc1.species is too weak to continue fight and collapses to the ground with a tremendous thud that nearly shakes you off your feet. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;forest randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="10" name="dryad ai" tags="" position="5275,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Standing before you is only what you can describe as an otherworldly beautiful $p.species. $npc1.He is a definite pear shape, in a long flowing gown that flows over $npc1.his features effortlessly. $npc1.He wears a wooden tiara brimming with delicious looking fruit, though to be honest they appear as if they are literally growing from $npc1.his head rather then simply decorative. $npc1.He chants a beautiful melodious song in some language you cannot identify. &lt;br&gt;&lt;br&gt;You are entranced for a few seconds before the oddest sensation comes over you. You look down and see your $p.fur starting to change color, starting from the base becoming a brilliant blue. You also feel a gurgling sensation in the pit of your stomach, which you can only describe as //&quot;funny&quot;//...

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
	&lt;li&gt;Charm&lt;/li&gt;
	The Dryad turns its gaze on you batting her eyelashes as she looks you in the eyes as she continues her song, which becomes exceedingly sweet. &lt;br&gt;&lt;br&gt;
	&lt;&lt;set _player = $int+50&gt;&gt;
	&lt;&lt;set _enemy = $eint&gt;&gt;
	
	&lt;&lt;switch setup.skillTestRange(_player,_enemy,25,90)&gt;&gt;
		&lt;&lt;case true&gt;&gt;
		Unphased by the haunting innocence, you continue your assault. Though you feel the gurgle in your stomach as the melody continues working it’s magic on you, and you continue changing blue as your body swells. 
		&lt;&lt;default&gt;&gt;
		As you bare your $wea.name at her, you feel the sudden compulsion to stop, and find yourself reluctant to harm this innocent creature, even as your body continues to swell and change blue, growing bigger and heavier by the moment. 
		&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
		
	&lt;&lt;/switch&gt;&gt;
	&lt;&lt;set _enemy = random(2,4)&gt;&gt;
	&lt;&lt;consume _enemy 1&gt;&gt;
	
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
		&lt;&lt;tempBuff &quot;end&quot; -1&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; -1&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; -1&gt;&gt;
		&lt;&lt;tempBuff &quot;agi&quot; -1&gt;&gt;
		&lt;&lt;default&gt;&gt;
		&lt;&lt;tempBuff &quot;agi&quot; -1&gt;&gt;
		&lt;&lt;tempBuff &quot;end&quot; -1&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;default&gt;&gt;
	&lt;li&gt;Chant&lt;/li&gt;
	The Dryad continues its beautiful melody, which echoes about like a heavenly choir. You feel the sensation in your stomach growing at a steady pace, as you continue turning blue. You body swells with a gurgling slosh, your features filling out as whatever strange power continues its work on you. You feel heavier and slower from the unaccustomed weight and pressure this strange effect is having on your body. 
	&lt;&lt;set _enemy = random(2,4)&gt;&gt;
	&lt;&lt;consume _enemy 1&gt;&gt;
	
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
		&lt;&lt;tempBuff &quot;end&quot; -1&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; -2&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; -1&gt;&gt;
		&lt;&lt;tempBuff &quot;agi&quot; -2&gt;&gt;
		&lt;&lt;default&gt;&gt;
		&lt;&lt;tempBuff &quot;agi&quot; -1&gt;&gt;
		&lt;&lt;tempBuff &quot;end&quot; -2&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	
&lt;&lt;/switch&gt;&gt;

&lt;&lt;if $agi &lt;= 0 or $str &lt;= 0 or $end &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn and run, your belly sloshing with every bound as you attempt to escape the dryad, who calmly follows after, singing all the while. However, you manage to outdistance her, and soon her singing fades away in the distance as you feel the strange sensation begin to fade. As you watch the swelling recedes and the color starts fading back to your normal $p.furBelly hue. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You turn and run, your belly sloshing with every bound as you attempt to escape the dryad who calmly follows after, singing all the while. Unfortunately, your growing frame has put you off balance, and a misstep sends you tumbling onto your growing stomach. You rise to your feet, but the dryad is upon you once more. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;p&gt;You relax and take in the music, ignoring the sensation throughout your body as you swell and change color. Slowly and steadily you swell outward as the dryad serenades you with the haunting and beautiful melody. &lt;/p&gt;

&lt;p&gt;Your legs fill out first, becoming thick and heavy as your stomach grows outward. The effect works it’s way up your body, all the while your $p.fur changing to a vivid blue. Soon it reaches your arms and face, which fill out and sag, becoming heavy and sloshy. From here it intensifies, and your body begins rapidly expanding. &lt;/p&gt;

&lt;p&gt;Your legs are forced apart as they become as thick as tree trunks while your belly surges out like a tide. Pretty soon, even the slightest motion causes you to wobble, and you finally lose balance, toppling backward. Your body wobbles back and forth like a great tide as it becomes completely blue. &lt;&lt;stuffToBursting&gt;&gt;&lt;/p&gt;

You begin to think that maybe, just maybe, you&#39;re in trouble, as you watch your body grow. When your stomach is $waist, the pressure becomes too much for you and you pass out. 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;dryad submit 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
As the Dryads song continues to echo around you, &lt;&lt;if $hea &lt;= 0&gt;&gt;
the pressure in your swelling gut starts to overpower you, sending you to your knees as you clutch at it, as if you could stop it from getting any fuller by doing so. Even so the Dryad doesn’t let up, her features looking triumphant, reflecting in her chant as it picks up tempo. The pressure builds and you fall to the ground, losing consciousness as you continue swelling. Your $p.fur becomes unnaturally blue before you pass out completely. 
								
&lt;&lt;elseif $agi &lt;= 0&gt;&gt;
you feel yourself swelling even more, the sensation of heavy thickness weighing on you. As you try to move, you find resistance daunting every attempt to bend your extremities as they swell and grow beyond your now limited dexterity. Even your face feels like its bloated and tight as your $p.fur turns a complete shade of blue. You frantically try to cause some motion in your body, but only manage to roll onto your back, the pressure in your body building as you swell and swell. You are helpless to listen to the Dryad chant and watch as your waist becomes $waist, before finally the pressure overwhelms you and you lose consciousness. 
								
&lt;&lt;elseif $str &lt;= 0&gt;&gt;
you feel yourself swelling even more becoming heavier and heavier as you do. As you try to muster your next move, your movements become sluggish, slowing to a crawl before you find your limbs weighing down on you. Panicking, you pour all your energy into budging yourself, only to find yourself losing ground, your movements managing only to send waves of rolling flab through your $p.fur. You find yourself rolling onto your back, pinned underneath the weight. Your frantic motions generate less and less of an effect, until even all of your might doesn’t cause even a ripple through your bloated frame. You are helpless to listen to the Dryad chant and watch as you grow larger and larger with each passing moment, your $p.fur becoming completely blue. When your waist is $waist, you finally pass out from the pressure. 

&lt;&lt;else&gt;&gt;
you feel yourself swelling even more, weighing you down and making every move difficult. You find yourself soft of breath, your sagging arms and legs sweating as their load only grow greater with every moment. Even as you try to make your next move, your limb rebel, and you sag onto your back like a bloated water balloon, panting as your frame continues to spread. Even as you try to muster the energy to try and move, any attempt just leaves you lightheaded and panting. You are helpless to listen to the Dryad chant watch as your body continues to bloat outward, your $p.fur becoming completely blue. When you become $waist, the pressure is finally to much for you, and you pass out. 
								
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Pass out&quot; &quot;dryad submit 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
As your last attack hits, the dryad stumbles, her song coming to an abrupt end as she grasps at her wound. She looks at you briefly, anger blazing in her eyes, before she turns toward the nearest tree and sprints gracefully into it. She slides into it as effortlessly as if it was air and is gone without a trace. You begin to feel somewhat normal again as the last of the dryad&#39;s words fade from your mind. You look at yourself and see the color staining your $p.fur starting to fade as your swelling subsides. Within a few moments you&#39;re back to you original shade of $p.furBelly. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
	
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false &quot;forest randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="11" name="dryad submit 2" tags="" position="5275,125" size="100,100">&lt;&lt;setPassageTitle &quot;At nature&#39;s mercy&quot;&gt;&gt;

&lt;&lt;set _berried = $sto + 4000&gt;&gt;
&lt;&lt;consumeQuiet _berried 0&gt;&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;p&gt;As you begin to regain consciousness, you become aware of an extremely bloated sensation all over. As you try to shift, you can only feel the sensation of muscle working, but you get no sense of motion out of any part of your body. You are almost afraid to open your eyes, but realize that there is no escaping it. As color floods back into the world, you notice an overwhelming amount of blue. You are confused for a moment before you realize that what you are looking at is yourself. &lt;/p&gt;

&lt;p&gt;You don’t recognize yourself, as you resemble little more then an enormous blimp. Every feature about you is bloated beyond anything you thought capable. Your cheeks resemble beach balls for all their size. Your hands and fingers are thick little balls incapable of movement, and your arms and legs are little more than tires half swallowed up by your enormously round body. Your stomach and chest have blown outward, until they are spherical in nature, encasing your limbs in a vice-like grip which makes any attempt at motion an impossibility. Honestly with your vibrant blue hue, you resemble a giant piece of fruit more then anything else. You attempt a shout, but only get a muffled mumble, your head too bloated to talk, let alone make such a yell. &lt;/p&gt;

&lt;p&gt;Your eyes dart about, for the first time taking in your surroundings after the shock of finding yourself in this state. Wherever you are, it seems very green. There are trees plants and vines everywhere, though the configuration seem a little more structured then one would expect from wild undergrowth. The vines above form a natural cathedral ceiling, trees acting as pillars, while their roots carpet the ground, forming tiers around the central feature of the area. The middle of the cathedral is a pit that all the roots and vines seem to gravitate towards. How deep it is you can’t tell, as it is filled with some sort of multi-colored liquid that swirls about in different shades of the rainbow. &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Look around&quot; &quot;dryad submit 3&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="12" name="dryad submit 3" tags="nobr" position="5150,125" size="100,100">&lt;&lt;setPassageTitle &quot;At nature&#39;s mercy&quot;&gt;&gt;

&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
You&#39;re also not the only one here. Littered about, you see a number of giant fruit-like spheres of different colors. You suddenly realize you’re not the only one who has ended up in this predicament. Everyone seems to be at different stages of bloat. You see a $npc2.species that seems halfway full, gut spreading outward over the ground like a water balloon with short limbs wobbling helplessly, while others, like you are little more then rounded balls. Then there are the Dryads, many of them wandering about and inspecting their &#39;harvest&#39; of helpless fruit people. Occasionally, you see them singing to a fur, and watch them slowly fill out. 
&lt;br&gt;&lt;br&gt;

Then you see the dryad that you had faced, inspecting you. &quot;You look about ripe,&quot; she says, before she begins chanting once more. 
&lt;br&gt;&lt;br&gt;

As the chanting begins again, you feel the pressure in you intensify, as if it could get any worse, and your features swell even more, swallowing up your limbs and almost swallowing your face in the folds of your cheeks. That is not the only thing happening, as the vines in the ceiling come alive, snaking their way through the air towards you, encircling you and lifting you even as you bloat outward, your insides sloshing violently. 
&lt;br&gt;&lt;br&gt;

&lt;&lt;if $options.popping&gt;&gt;
It carries you toward the center pit, holding you there as the pressure in you builds tremendously. You feel a gurgle in the pit of your stomach, and a strange stretching sound like an overfilled balloon. Your cheeks start enveloping your head as you feel liquid rising from your throat. You taste juice as it begins dribbling from your mouth and nose, even as you begin tearing up, you see the same color flowing from your tear ducts. 
&lt;br&gt;&lt;br&gt;

The pressure surges even more, and the flow of juice from your orifices, intensifies, as your body swells outwards one last time, and the vines drop you. You fall, your body suddenly springing leaks, juice spraying violently before you hit the surface of the juice filled pit, exploding in a tsunami of juice like a water balloon. 
&lt;&lt;else&gt;&gt;
It carries you toward the center pit, wrapping around you again and again before tilting you towards the pit, where you can see the colored liquid swirling. You pick up a sweet fruity smell, and recognize it as juice. Your view suddenly becomes blocked as your swelling body envelops your head, and just as you think you are about to burst, the vines start squeezing. 
&lt;br&gt;&lt;br&gt;

The vines around your middle start tightening, both ends of you bulging as your inside are force both ways. You feel the pressure building even more, before the vine at you bottom end start tightening as well, forcing everything one way towards your top end. You feel a surge of liquid flowing outwards, and finally, it erupts from your mouth like a geyser, shooting into the pit like a fire hose of blue water. You taste a huge amount of fruit juice as it if forced out of your body, the vines constricting gradually as you feel the unbearable internal pressure lesson slowly. Like a deflating balloon, your body sags and shrinks, slowly starting to regain some of its features. And the vines squeeze more and more out of you, juicing you until the flow starts to recede, first to a slow stream, then a trickle. Finally, only a few drops fall from your mouth, even as the vines shake you downward. Seemingly satisfied, it deposits you onto the ground, disorientated and shaking on the ground nearby. 
&lt;br&gt;&lt;br&gt;

Exhausted, you fall over and pass out. 
							
&lt;&lt;/if&gt;&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="13" name="fatWolf ai" tags="" position="4775,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a decidedly overweight $wolf.species. $npc1.He has a coat of thick $wolf.furBack $wolf.fur over a layer of fat several inches thick. $npc1.He jiggles with every labored move $npc1.he makes and $npc1.he&#39;s eyeing you hungrily. 

&lt;&lt;case &quot;attack&quot;&gt;&gt;
  &lt;&lt;doEdmg&gt;&gt;
  &lt;&lt;set _random to random(1,6)&gt;&gt;

  /*Devour attack*/
  &lt;&lt;if _random == 1 and $hea &lt; 20&gt;&gt;&lt;li&gt;&#39;&#39;Devour&#39;&#39;&lt;/li&gt;
  &lt;&lt;if setup.dodgeInstantDeath()&gt;&gt;
  The $wolf.species senses an opportunity and $npc1.He rears back and attempts to tackle you, $npc1.his jaws opened wide, but you are able to fight $npc1.him off and throw $npc1.him to the ground. 

  &lt;&lt;else&gt;&gt;
  Your opponent sees that you are weakened. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. You try to dodge him, but $npc1.he&#39;s too strong and fast for you. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. From the outside, the $wolf.species&#39;s stomach stretches to the ground and then some. The $wolf.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $wolf.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. &lt;br&gt;&lt;br&gt;

  You can only pray that someone up there is looking out for you.

  &lt;&lt;endCombat&gt;&gt;
  &lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;

  /*Do nothing*/
  &lt;&lt;elseif _random == 2&gt;&gt;&lt;li&gt;&#39;&#39;Wait&#39;&#39;&lt;/li&gt;
  The fat $wolf.species pants to catch $npc1.his breath. 

  /*Heal*/
  &lt;&lt;elseif _random == 3&gt;&gt;&lt;li&gt;&#39;&#39;Heal&#39;&#39;&lt;/li&gt;
  The fat $wolf.species pauses to lick $npc1.his wounds.
  &lt;&lt;eHealth 10&gt;&gt;

  /*Normal attack*/
  &lt;&lt;else&gt;&gt;
  &lt;&lt;if random(1,2) == 1&gt;&gt;&lt;li&gt;&#39;&#39;Swipe!&#39;&#39;&lt;/li&gt;
  The fat $wolf.species waddles up and swipes at you with $npc1.his paw, dealing $edmg damage. 

  &lt;&lt;else&gt;&gt;&lt;li&gt;&#39;&#39;Bite!&#39;&#39;&lt;/li&gt;
  The fat $wolf.species licks $npc1.his chops before jumping forward and biting you, dealing $edmg damage. 
  &lt;&lt;/if&gt;&gt;

  &lt;&lt;damage $edmg&gt;&gt;

  &lt;&lt;/if&gt;&gt;

&lt;&lt;case &quot;vore&quot;&gt;&gt;
	You lunge at your enemy in an attempt to devour the fat $wolf.species and you succeed in tackling $npc1.him to the ground. You pick the $wolf.species up in your hands and stuff $npc1.him into your cavernous mouth. $npc1.He begins to writhe in your grasp trying to get away, $npc1.his body jiggling wildly with the motion. You pull the $wolf.species further in and pin $npc1.his legs to $npc1.his chest. $npc1.His tail is clenched between $npc1.his hind legs in a position of fear as you reach $npc1.his stomach. 
	&lt;br&gt;&lt;br&gt;

	Your gut juts forward as $npc1.his $wolf.mouth emerges into your stomach. You slurp $npc1.him further in as you gulp, pulling $npc1.his flabby stomach in for the last few swallows. $npc1.He kicks a bit as you reach $npc1.his hind legs. Holding $npc1.his feet like drumsticks, you push the $wolf.species down your gullet without bothering to swallow, and only give one last massive gulp as you push the hind $wolf.feet to the back of your throat. 
	&lt;&lt;set _calories = $e.weight*0.5&gt;&gt;
	&lt;&lt;consume $e.weight _calories&gt;&gt;

	&lt;&lt;if $alive&gt;&gt;
	$npc1.He finishes the descent into your belly, which heaves wildly as $npc1.he struggles for freedom. Your stomach finally settles after a few good pats and burps, letting you continue on your way.

	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

	&lt;&lt;else&gt;&gt;
	You immediately feel a tightening in your belly as the $wolf.species surges into it. It escalates into discomfort and then pain as your stomach strains around a meal it was never meant to hold, and you pass out gripping your writhing gut.
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

	&lt;&lt;/if&gt;&gt;
  
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
	&lt;li&gt;Escaped!&lt;/li&gt;
	You flee from the battle. The $wolf.species chases after you for a moment, $npc1.his fat gut wobbling like a sea of jello, but $npc1.he quickly runs out of breath and gives up the chase.
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
	You surrender to your opponent and $npc1.he&#39;s quick to rear back and lunge toward you, $npc1.his jaws stretched almost impossibly wide. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. 
	&lt;br&gt;&lt;br&gt;

	From the outside, the $wolf.species&#39;s stomach stretches to the ground and then some. The $wolf.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $wolf.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. 
	&lt;br&gt;&lt;br&gt;

	You can only pray that someone up there is looking out for you. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;case &quot;defeat&quot;&gt;&gt;
	You slump to the ground in defeat. Your opponent sees that you are weakened. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. You try to dodge him, but $npc1.he&#39;s too strong and fast for you. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. From the outside, the $wolf.species&#39;s stomach stretches to the ground and then some. The $wolf.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $wolf.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast.
	&lt;br&gt;&lt;br&gt;

	You can only pray that someone up there is looking out for you.
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;case &quot;victory&quot;&gt;&gt;
	&lt;p&gt;The fat $wolf.species pants with exertion before collapsing to the ground, too weak to continue fighting. $npc1.He hits the ground $npc1.his body jiggles like a large jello mold before finally settling. &lt;/p&gt;

	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_tryFeedEnemy &quot;hunter&quot; false&gt;&gt;
	&lt;&lt;if $feeder_feedCheck&gt;&gt;
		/* Narrate the feeding */
		&lt;&lt;feeder_enemyHasWeaknessToFedFood&gt;&gt;
		&lt;&lt;if $feeder_hasWeakness&gt;&gt;
			You manage to cram a $feeder_itemFed.name into the $wolf.species&#39;s gnashing jaws. $npc1.He pauses for a moment to savour the taste, and you notice $npc1.his $wolf.tail wagging.
		&lt;&lt;else&gt;&gt;
			You manage to cram a $feeder_itemFed.name into the $wolf.species&#39;s gnashing jaws, which $npc.he wolfs down. 
		&lt;&lt;/if&gt;&gt;
		
		/* Use up the item */
		&lt;&lt;feeder_tryRemoveFedItem&gt;&gt;
		
		/*Add food to belly*/
		&lt;&lt;feeder_enemyConsume $feeder_fedAmount&gt;&gt;
		
		/* Handle special item effects */
		&lt;&lt;feeder_genericSpecialItemProcess _archetype _isBoss&gt;&gt;

		/*Check to see if has won*/
		&lt;&lt;feeder_genericActionDefeatCheck &quot;forest randomization&quot; &quot;After such a stuffing, the hunger in the $wolf.species&#39;s eyes seems to be gone. With a satisfied sigh, $npc1.he flops over onto $npc1.his side, jiggling as $npc1.he hits the forest floor.&quot;&gt;&gt;
		&lt;&lt;if $e.ate &lt; $e.sto&gt;&gt; /*Not defeated from stuffing, so continue*/
			/*Check to see if should trigger halfway debuffs*/
			&lt;&lt;feeder_genericActionHalfFullCheck &quot;The $wolf.species&#39;s panting grows heavier alongside $npc1.his filling belly. With a lick of $npc1.his lips, $npc1.he returns to $npc1.his hunt, though $npc1.his movements are a bit more sluggish and labored than before.&quot;&gt;&gt;
			
			/*Check to see if the enemy should be stunned*/
			&lt;&lt;feeder_genericActionStunCheck &quot;hunter&quot; false&gt;&gt;
			
			/* Perform their turn (which will be interrupted if they were stunned from the feeding) */
			&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;feeder_genericActionText &quot;hunter&quot; false false&gt;&gt; /* Never seen, because can&#39;t fail to feed wolf atm */
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="14" name="lemon ai" tags="" position="5150,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a large gelatinous cube about &lt;&lt;sayDistance 36&gt;&gt; long on each side. The translucent yellow blob smells deliciously lemony! 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;li&gt;Feed&lt;/li&gt;
The slime monster draws back in on itself before spraying a blast of slime directly into your mouth. You can&#39;t help but swallow several mouthfuls and feel it slide into your gut. It tastes delightfully fruity! 
&lt;&lt;set _fill = random(1,3)&gt;&gt;
&lt;&lt;set _calories = _fill * 0.5&gt;&gt;
&lt;&lt;consume _fill _calories&gt;&gt;
&lt;&lt;eDamage _fill&gt;&gt;

&lt;&lt;if $e.hea &lt;= 0 and $alive&gt;&gt;
&lt;br&gt;&lt;br&gt;
What&#39;s remaining of the slime monster slides down your throat. With nothing left to fight, I guess you can call this a victory?

&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt; 

&lt;&lt;elseif $e.hea &gt; 0 and !$alive&gt;&gt;
&lt;br&gt;&lt;br&gt;
You fall to the ground, too painfully full to stand. You wince in pain and grab your achingly bloated gut. When you open your eyes, you look up to see the slime monster rising over you like a tidal wave. You look on in horror as the monster crashes down upon you, cramming it&#39;s entire mass down your throat. Your stomach starts groaning and gurgling as it stretches massively.  
&lt;&lt;set _fill = $e.hea&gt;&gt;
&lt;&lt;set _calories = _fill * 0.5&gt;&gt;
&lt;&lt;consume _fill _calories&gt;&gt;

&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;						

&lt;&lt;elseif $e.hea &lt;= 0 and !$alive&gt;&gt;
&lt;br&gt;&lt;br&gt;
The last of the slime monster slides down your throat. For a moment you feel a sense of triumph, but you swiftly realize you&#39;re practically too full to stand. You collapse to the ground and roll over onto your back before passing out in an overstuffed coma. 

&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;					

&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You flee from the battle. The slime chases after you in a weird jumping/sloshing motion, like an ocean wave on land, but it can&#39;t manage to keep up with you. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;endCombat&gt;&gt;
You open your mouth wide and beckon the slime monster in. It seems to cheerily oblige as a large tendril flys out and slides down your throat. You don&#39;t even have to swallow as the slime forcefully pumps itself into you. You rub your $waist stomach as it stretches outward with sentient lemony sweetness. 
&lt;&lt;set _calories = $e.hea * 0.6&gt;&gt;
&lt;&lt;consume $e.hea _calories&gt;&gt;
&lt;br&gt;&lt;br&gt;

&lt;&lt;if $alive&gt;&gt;
You slurp up the last of the slime monster down. With nothing left to fight, I guess you can call this a victory? 
&lt;br&gt;
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
Your stomach keeps growing larger and larger, but there&#39;s still more lemon slime to go. You hold onto your aching gut as lemon goo pumps almost endlessly down your gullet. You slowly lower yourself down and sit on the ground as you feel your stomach stretch painfully bloated. You&#39;re not sure how much more you can take, but you&#39;re determined to win this gastronomical battle. If you can just hold out a little longer. 
&lt;br&gt;&lt;br&gt;

You begin losing the test of will though as you become too painfully full to stay awake. You collapse on your back on the ground and pass out even as the rest of the slime monster slides down your throat. 
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $e.hea &gt; 0&gt;&gt;
You fall to the ground, too painfully full to stand. You wince in pain and grab your achingly bloated gut. When you open your eyes, you look up to see the slime monster rising over you like a tidal wave. You look on in horror as the monster crashes down upon you, cramming it&#39;s entire mass down your throat. Your stomach starts groaning and gurgling as it stretches massively.  
&lt;&lt;set _fill = $e.hea&gt;&gt;
&lt;&lt;set _calories = _fill * 0.5&gt;&gt;
&lt;&lt;consume _fill _calories&gt;&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;	

&lt;&lt;else&gt;&gt;
&lt;br&gt;&lt;br&gt;
The last of the slime monster slides down your throat. For a moment you feel a sense of triumph, but you swiftly realize you&#39;re practically too full to stand. You collapse to the ground and roll over onto your back before passing out in an overstuffed coma. 
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;	
&lt;&lt;/if&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your final attack splatters what remains of the slime, sending lemony flavored goo across the ground. Rather than reforming, the goo quickly soaks into the ground, leaving you the victor! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;

&lt;&lt;if setup.questActive($slimeQuest1) and setup.hasItem($lemonSampleItem) &lt; 0&gt;&gt;
	You just manage to scoop up some for Bronk the innkeeper before it completely disappears. 
	&lt;&lt;getItem $lemonSampleItem&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/*===Capture a slime===*/
&lt;&lt;case &quot;capture&quot;&gt;&gt;
&lt;li&gt;Capture&lt;/li&gt;
&lt;&lt;if setup.skillTestRange($agi+$str+$int, $e.agi+$e.str+$e.int+$e.hea, 10, 90)&gt;&gt;
	You lunge for the large lemon cuboid and land on top of it, squashing it down with a //THRRRRRRP// noise as though it were a whoopee cushion. The slime monster squirts lemon-scented goo and bounces frantically beneath you, but you 
	&lt;&lt;if setup.weight() &lt; 150&gt;&gt;cling on frantically like a rodeo rider 
	&lt;&lt;elseif setup.weight() &lt; 300&gt;&gt;keep it pinned beneath you with your sizeable belly while it wriggles and wobbles 
	&lt;&lt;else&gt;&gt;use your enormous weight to squash it into submission 
	&lt;&lt;/if&gt;&gt;
	until it eventually subsides, apparently exhausted. Getting up cautiously, you prize the inert jello-like cuboid from the ground with a rather unpleasant sucking noise. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;getItem $lemonSlimeItem&gt;&gt;
	
	&lt;hr&gt;
	&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You make a lunge for the large yellow cuboid, but it proves to be particularly slippery- and wobbly! Making a strange squeaking noise the slime squeezes out of your grip like a bar of soap, landing on the forest floor a couple of feet away and leaving your arms and chest covered in citrus-smelling gunge. 
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="15" name="store room ai" tags="" position="5525,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is presumably the storeroom owner, and $npc1.he seems none to happy with you breaking into $npc1.his storeroom and helping yourself. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;li&gt;Attack&lt;/li&gt;
&lt;&lt;switch random(1,4)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&quot;Think you can get away with eatin&#39; all my food eh!?&quot;, $npc1.he shouts before whacking you in the head with $npc1.his stick. 
		
	&lt;&lt;case 2&gt;&gt;
		&quot;Think ye can just gobble up all my hard work jus&#39; like that!?&quot; $npc1.He jabs you hard in the gut with $npc1.his stick, eliciting a pained grunt from you. 
		
	&lt;&lt;case 3&gt;&gt;
		&quot;I was gonna have myself a grand &#39;ol feast and you had to cram it all in your fat face!&quot; $npc1.he slaps you across the face with $npc1.his walking stick. 
		
	&lt;&lt;default&gt;&gt;
		&quot;Eat this!&quot; $npc1.He picks up a nearby apple and pegs you right in the head with it. 
		
&lt;&lt;/switch&gt;&gt;
&lt;&lt;damage $edmg&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower your defences and admit defeat.&quot;Well that&#39;s mighty kind of &#39;ya, but I think it&#39;s a bit too late for apologies now.&quot; $npc1.he whacks you over the head and you fall to the floor. You collapse flat on your back and start panting as the angered local looms over you. &quot;Oh I&#39;m gonna&#39; have some fun with you, heh heh heh.&quot; Your vision slowly fades to black as you lose consciousnes and the $npc1.species laughs maliciously over your head. 

&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Some time later...&quot; &quot;Wake up in the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Unable to take anymore of $npc1.his onslaught, you slowly sink to the ground. You collapse flat on your back and start panting as the angered local looms over you. &quot;Oh I&#39;m gonna&#39; have some fun with you, heh heh heh.&quot; Your vision slowly fades to black as you lose consciousnes and the $npc1.species laughs maliciously over your head. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Some time later...&quot; &quot;Wake up in the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your opponent stumbles and falls to $npc1.his knees! You see the open door behind $npc1.him and take this opportunity to beat a hasty retreat. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false &quot;forest randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="16" name="vine ai" tags="" position="5025,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a mass of deep amber colored vines. There are several vines that taper off and ooze some kind of sweet smelling syrup. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
&lt;li&gt;Feed!&lt;/li&gt;
The vines that are crammed in your mouth start oozing huge globs of sickeningly sweet syrup down your throat. 
&lt;&lt;set _fed = random(2,5)&gt;&gt;
&lt;&lt;set _calories = _fed * 0.6&gt;&gt;
&lt;&lt;consume _fed _calories&gt;&gt;
&lt;&lt;set $e.weight -= _fed&gt;&gt;

&lt;&lt;if $e.weight &lt;= 0 and $alive&gt;&gt;
You notice the rate of syrup flow is slowly dwindling before coming to a stop. The vines seem to loose their strength as they start limply falling to the ground. Cautiously picking up a vine, you notice that it appears you&#39;ve actually sucked the entire mass of vines dry. Apparently you&#39;ve won! 

&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;

&lt;&lt;if random(1,2) == 1 and $agi &gt; 6&gt;&gt;
&lt;li&gt;Syruped&lt;/li&gt;
Sweet amber syrup leaks from the ends of several vines, covering whatever parts of you they touch in sticky syrup and slowing you down. 
&lt;&lt;set _debuff = random(-2,-6)&gt;&gt;
&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;


&lt;&lt;else&gt;&gt;
&lt;li&gt;Grab&lt;/li&gt;
The vines coil in upon themselves before leaping out at you
&lt;&lt;if setup.dodge()&gt;&gt;, but you manage to dodge out of their way.
&lt;&lt;else&gt;&gt; and wrap themselves around your arms and legs. In your constricted state, several tentacles cram themselves between your jaws. 
&lt;&lt;set $grapple = $e.agi + $e.str&gt;&gt;
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You attempt to escape from the syrup vines. As you try to run you trip over several vines on the ground as they gently attempt to stop you, but you manage to dodge through them and eventually escape. The vines are too anchored to their spot to chase after you. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;p&gt;You lower your defences and fall into the tangle of vines. They quickly wrap around your arms and legs as one large vine crams itself into your mouth. You bite down on the vine and start sucking down sweet thick syrup. Just like maple syrup and yet somehow intoxicating, like this could be all you eat for the rest of your days and you&#39;d be fine. 
&lt;&lt;set _calories = $e.weight * 0.6&gt;&gt;
&lt;&lt;consume $e.weight _calories&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
You gladly suck down more and more syrup. Your stomach is now $waist. The vines seem to weaken and you&#39;re slowly lowered to the ground. You continue sucking on the vine in your mouth, but the flow of syrup slows down to a trickle before finally stopping. Disappointedly, you pull the vine out of your mouth and it flops to the ground. Apparently you were able to drain the creature dry and it now appears to just be a tangle of ordinary vines. 
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;You keep sucking down more and more syrup, yet there seems to be almost no end in sight. Your stomach starts feeling dangerously full yet more and more syrup continues to pour from this creature. You can no longer force yourself to swallow due to the intense fullness stretching your wobbly gut. A vine wraps around your waist and periodically squeezes your $waist stomach as it&#39;s slowly pumped fuller and fuller. &lt;/p&gt;

&lt;p&gt;You try to open your jaws to spit out the vines, but your mouth is practically welded to the vine with sticky syrup. The vines sense you&#39;re no longer sucking down any syrup and begins actively pumping it down your throat. You can&#39;t help but swallow despite your aching groaning stomach. &lt;/p&gt;

  &lt;&lt;if $options.popping&gt;&gt;
	&lt;p&gt;The wobbles of your gut decrease as it becomes more taut, and the squeezing from the vine puts more and more pressure on your belly until it just can&#39;t handle it anymore. Your gut explodes, and globs of syrup leak out of you as the vine continues pumping, trying to refill its suddenly empty container. &lt;/p&gt;
	&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
  &lt;&lt;else&gt;&gt;
	&lt;p&gt;In little time you&#39;re just too full to stay awake and you eventually drift off to sleep as you are slowly inflated with globs sticky syrup. &lt;/p&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You&#39;re so full you no longer have the strength to fight the vines. The syrup is so sweet you find yourself only craving more even as your stomach slowly inflates larger and larger. You slowly close your eyes and finally enjoy the flavor as you drift into unconsciousness. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your last attack causes the mass of vines to tense up before limply falling to the ground. You poke at the mass of vines suspiciously, but the vines don&#39;t seem to react aside from leeking sweet smelling syrup accross the ground. 
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
	
&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="17" name="witch ai" tags="" position="5400,250" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a hunched over witch with an evil grin and a cackling laugh. $npc1.He&#39;s wielding a gnarled stick at you in a menacing manner. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;set _random to random(1,6)&gt;&gt;
&lt;li&gt;Feed&lt;/li&gt;
&lt;&lt;switch _random&gt;&gt;

&lt;&lt;case 1&gt;&gt;
The witch cackles as a slice of cake appears in a puff of purple smoke and flies towards your mouth, cramming itself down your throat. You swallow instinctively and lick your face clean. Against your will, you open your mouth, waiting for more. 
&lt;&lt;consume 4 2&gt;&gt;

&lt;&lt;case 2&gt;&gt;
The witch grins evilly as a cupcake poofs into existence in a shower of green sparks and flies towards your face, practically leaping down your throat. You swallow instinctively, the sweet taste of the cupcake filling your mouth. Against your will, you open your mouth, waiting for more. As the cupcake settles in your stomach, you can feel a noticeable increase in your fullness. Your belly feels heavier, and you can&#39;t help but place a hand on it, feeling it gently expand from the additional volume.
&lt;&lt;consume 3 1.5&gt;&gt;

&lt;&lt;case 3&gt;&gt;
A shower of red sparks heralds a lemon meringue pie rocketing out of thin air and smacking you in the face. You swallow large sweet and tart globs of lemon and meringue. As the pie settles in your stomach, you can feel a noticeable increase in your fullness. Your belly feels tight and bloated, and you can&#39;t help but place a hand on it, feeling it distend from the additional volume. You feel stuffed, the pie filling you up more than you thought possible.
&lt;&lt;consume 5 2.5&gt;&gt;

&lt;&lt;case 4&gt;&gt;
With a flourish of her wand, the witch conjures a large donut out of a burst of blue sparks. The donut floats in the air momentarily before it propels itself towards you, finding its way into your mouth. You can&#39;t help but swallow, the rich sweetness of the donut filling your senses. Despite yourself, you find your mouth opening in anticipation of more. As the donut settles in your stomach, you become acutely aware of your increasing fullness. Your belly feels denser, and you instinctively rub it, feeling the subtle expansion from the added volume. Your clothes tighten around your swelling form, a clear indication of the donut&#39;s impact.
&lt;&lt;consume 4 2&gt;&gt;

&lt;&lt;case 5&gt;&gt;
A mischievous glint in the witch&#39;s eye precedes a deluge of jelly doughnuts, raining from a sudden purple cloud above you. They plop into your open mouth, one after another, their sugary filling oozing down your throat. You can&#39;t help but chew and swallow, even as your stomach protests with a dull ache. Each doughnut makes your belly rounder and more distended, the skin stretched tight as it tries to accommodate the sudden influx of sugary treats. You groan softly, feeling uncomfortably full and heavy.
&lt;&lt;consume 5 2.5&gt;&gt;

&lt;&lt;case 6&gt;&gt;
The witch waves her wand, and a series of thick, chocolate milkshakes appear, floating in the air. They tip over one by one, their thick, creamy contents flowing into your mouth. You have no choice but to gulp them down, feeling the cold liquid fill your stomach to the brim. Your belly becomes increasingly tight and swollen, each shake making you feel more and more like an overstuffed balloon. The sensation of fullness is overwhelming, leaving you feeling sluggish and heavy.
&lt;&lt;consume 6 3&gt;&gt;


&lt;&lt;default&gt;&gt;
The witch raises $npc1.his arms in the air and you hear the ceiling above you quake. You look up just as a large hunk of gingerbread ceiling falls down and lands in your mouth, the momentum painfully ramming down it your throat and crashing into your stomach. 
&lt;&lt;consume 6 3&gt;&gt;

&lt;&lt;/switch&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&quot;That&#39;s a good dear. I think you deserve a reward. Here-&quot; the witch raises $npc1.his arms over $npc1.his head as a swirling orb of thick chocolate coalesces into being. Just the smell is enough to make your mouth water and you open your mouth without even thinking. 
&lt;br&gt;&lt;br&gt;

A thick tendril of warm chocolate spirals out from the orb and pours itself down your throat. You feel your stomach slowly swell with warm sweet chocolate and as your gut expands larger and larger you find yourself unable to stay awake.
&lt;&lt;stuffToBursting&gt;&gt;
You eventually collapse to the floor, too full and contented to stay awake. 

&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Your overtaxed stomach can handle no more. You stumble and fall to the ground, holding on to your overstuffed belly as you fall. The witch stands over you. 
&lt;br&gt;&lt;br&gt;

&quot;Don&#39;t tell me you&#39;re full already, I was just getting ready for the second course! Hee hee hee hee!&quot; You attempt to stand again, but you&#39;re just too full. You pass out in a food coma as the witch stands over you, cackling evilly.

&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
&lt;&lt;switch $e.special&gt;&gt;
&lt;&lt;case &quot;book&quot;&gt;&gt;
&quot;Oh what a world!&quot; the witch screams as $npc1.he collapses to the floor. As soon as $npc1.he does so, the house is stricken with an ominous rumbling. The shaking quickly intensifies and you start to have trouble staying on your feet. You look around and see the walls cracking and tearing apart as they seem to fall upwards. 
&lt;br&gt;&lt;br&gt;

You struggle to make it down the stairs. Out of the corner of your eye you notice the witch has mysteriously vanished without a trace. You brace yourself against the walls as you shakily make your way to the front door. Furniture and bits of wall burst into green flame as they fall upward. There&#39;s a deep and ominous cracking sound as the floor tears in half and starts drifting upward as it&#39;s eaten at the edges by cold green flames. 
&lt;br&gt;&lt;br&gt;

You barely make it to the front door before the floor beneath your feet tilts upward and burns away. You dive out of the front door as what remains of the sundered gingerbread house burns away into nothing. You keep running and don&#39;t stop until you reach the cover of the trees. The last of the house vanishes in a puff of strange sweet smelling green smoke in the sky. 
&lt;br&gt;&lt;br&gt;

A moment later you see a distant figure crawl out of the hole where the house once stood. $npc2.He looks away perplexedly before hefting $npc2.his considerable bulk and running off into trees on the far side of the clearing.
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;case &quot;no captive&quot;&gt;&gt;
&quot;Oh what a world!&quot; the witch screams as $npc1.he collapses to the floor. As soon as $npc1.he does so, the house is stricken with an ominous rumbling. The shaking quickly intensifies and you start to have trouble staying on your feet. You look around and see the walls cracking and tearing apart as they seem to fall upwards. You struggle to make it through the kitchen and out of the corner of your eye you notice the witch has mysteriously vanished without a trace. 
&lt;br&gt;&lt;br&gt;

You brace yourself against the walls as you shakily make your way to the front door. Furniture and bits of wall burst into green flame as they fall upward. There&#39;s a deep and ominous cracking sound as the floor tears in half and starts drifting upward as it&#39;s eaten at the edges by cold green flames. You barely make it to the front door before the floor beneath your feet tilts upward and burns away. You dive out of the front door as what remains of the sundered gingerbread house burns away into nothing. You keep running and don&#39;t stop until you reach the cover of the trees. The last of the house vanishes in a puff of strange sweet smelling green smoke in the sky. A moment later you see a distant figure crawl out of the hole where the house once stood. $npc2.He looks away perplexedly before hefting $npc2.his considerable bulk and running off into trees on the far side of the clearing. 
&lt;br&gt;&lt;br&gt;

&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;


&lt;&lt;case &quot;yes captive&quot;&gt;&gt;
&quot;Oh what a world!&quot; the witch screams as $npc1.he collapses to the floor. As soon as $npc1.he does so, the house is stricken with an ominous rumbling. The shaking quickly intensifies and you start to have trouble staying on your feet. You look around and see the walls cracking and tearing apart as they seem to fall upwards. You quickly turn around and attempt to pick up your overstuffed companion. $npc2.He was heavy enough when $npc2.he could stand, now that $npc2.he&#39;s out cold $npc2.he&#39;s like a sack of soft bricks. It takes some doing but, you eventually pick $npc2.him up and sling $npc2.his arm over your shoulder. A weak groan lets you know that $npc2.he&#39;s at least slowly regaining consciousness. 
&lt;br&gt;&lt;br&gt;

None too soon either as every bit of candy around you begins crumbling to pieces and floating upwards as green flames consume them. You slowly shuffle your way towards the front door. You notice that that witch has vanished without a trace when you weren&#39;t looking. You get through the door and have to wait as your bloated $npc2.species in distress has become wedged in the front door. With a few pulls you manage to pull $npc2.him through as the entire floor breaks in half and gently drifts upwards. $npc2.He pops out of the door frame and the momentum flings $npc2.him into you. You both roll down the hill to the tree line. You stumble dizzily up to your feet and $npc2.he follows suit, albeit somewhat slower. You both stand there and watch as the last of the house drifts into the sky and burns up in a puff of sweet smelling green smoke. 
&lt;br&gt;&lt;br&gt;

&quot;Hhhhhhhhhhuh.&quot; the $npc2.species says ineffectualy. &quot;Well, that was certainly strange.&quot; $npc2.He stumbles back and leans against a nearby tree. &quot;Well thank you so much.&quot; $npc2.he says as $npc2.he rubs $npc2.his taut stomach. &quot;I never would have made it out of there alive if it weren&#39;t for you.&quot; $npc2.He holds onto $npc2.his gut as $npc2.he slowly sinks to the ground. &quot;I think I can make it back home from here, I don&#39;t live far. You should go. I just need a moment to rest. And here, take this with you.&quot; $npc2.He reaches into pants you couldn&#39;t even tell $npc2.he was wearing and pulls out a small bag of coins from $npc2.his pocket. $npc2.He tosses it on the ground and with that, $npc2.he passes out in a food coma. 
&lt;br&gt;&lt;br&gt;

&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;doGld 25&gt;&gt;
&lt;hr&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Witch victory error&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="18" name="cheese ai" tags="" position="5850,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
You’ve never seen a cheese quite like this. It looks hard and crumbly, with a reddish rind and swiss-cheese type holes. It seems to be quivering slightly, with steam rising off it. It doesn’t look too dangerous, although you can’t help but notice a dagger sticking out of the top of it like a cheese-knife, and a number of other cut-marks in the rind. You take a step towards it, then back up hurriedly as the rind cracks to reveal a kind of mouth set in a feral, hungry grin, strands of soft cheese hanging between the jaws. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;

&lt;&lt;switch random(1,3)&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;li&gt;Charge&lt;/li&gt;
&lt;&lt;if setup.dodge()&gt;&gt;
You see the huge cheese hurtling towards you through the air, but dodge to one side. The cheese flies past you and smacks hard into a wooden beam, making a crack appear in the rind. It crashes to the floor and sits dazed for a moment, then seems to shake itself and bounces around to face you again. This thing just doesn&#39;t give up! 

&lt;&lt;else&gt;&gt;
The wheel of cheese bounces heavily on the wooden floor in front of you, snarling, making the boards shake. Then it suddenly launches itself at you in a furious bound and catches you squarely in the stomach! You let out a loud &#39;&#39;OOF&#39;&#39; and are knocked backwards, winded. The cheese rebounds off your $waist belly, flips through the air like a gigantic coin and lands back on the boards with a thud. 
&lt;&lt;damage $edmg&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;&lt;if ($e.hea * 2) &lt; $e.maxHea and random(1,2) == 1&gt;&gt;
&lt;li&gt;Melt&lt;/li&gt;
Sitting on the floor, the battle-damaged cheese quivers on the spot, seeming to strain in effort. As you watch, the rind begins to reseal itself, and some of the gouges in the wheel begin to refill as surrounding cheese softens and flows into the cracks before rehardening. When it stops straining, the cheese looks a lot less nibbled than it did. Looks like you&#39;ve still got a lot on your plate. 
&lt;&lt;set $e.maxhea -= 25&gt;&gt;
&lt;&lt;set _healing = random(45,55)&gt;&gt;
&lt;&lt;eHealth _healing&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;li&gt;Roar&lt;/li&gt;
As you approach the cheese like someone trying to wrestle a bronco, it lets out a bellow- deep and bassy, but with an edge of goat&#39;s bleat, a throaty hint of a lion&#39;s roar and the piercing keen of a hunting eagle thrown in. It echoes in the confined space and saws across your ears, making spots appear before your eyes. You stumble back, clutching your ears. The cheese&#39;s bellow drops into what sounds suspiciously like a snigger. 
&lt;&lt;set _debuff = random(-4,-8)&gt;&gt;
&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&lt;li&gt;Stench&lt;/li&gt;
You advance on the cheese, but it quivers on the spot and snorts out a cloud of steam which envelops you. You&#39;re overwhelmed by the foulest, cheesiest stench you&#39;ve even encountered, and you stagger back, coughing and clutching your nose. Urgh, you think you can even smell it though your &#39;&#39;EARS&#39;&#39;, it&#39;s that vile. It&#39;s like Limburger, Munster and Camembert, cubed! You feel your face going green, and you&#39;re left feeling distinctly unwell. A smell like that is enough to make you lose your appetite. 
&lt;&lt;set _debuff = random(-6,-10)&gt;&gt;
&lt;&lt;tempBuff &quot;sto&quot; _debuff&gt;&gt;

&lt;&lt;set $edmg *= 0.25&gt;&gt;
&lt;&lt;damage $edmg&gt;&gt;

&lt;&lt;/switch&gt;&gt;

/* FIXES AND EDITS */
/* Since there&#39;s no cap to the cheese&#39;s debuffing ability, it can be assumed that it&#39;s intended to be able to take the player out by reducing their stat below 0 like all the other enemies. Add in the missing check to make that happen: */
&lt;&lt;if $agi &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
As the cheese lunges at you, you grab hold. As it struggles and bucks in your arms, you open wide and take a BIG bite out of it, your mouth sinking through the tough rind and into the hard cheese beneath. The cheese lets out a squeaky keen of anguish. It tastes strong, sharp and slightly fruity- a bit like &lt;&lt;set _cheese = either(&quot;caerphilly&quot;,&quot;wensleydale&quot;,&quot;gouda&quot;,&quot;pecorino&quot;,&quot;manchego&quot;)&gt;&gt;_cheese, perhaps?- but you don&#39;t really have much time to concentrate on the flavour as the cheese lets out a furious growl and wrenches itself out of your grip. You swallow your mouthful hurriedly, feeling the highly-calorific contents slide down to fill your stomach, just in time to carry on the fight. 

&lt;&lt;set _calories = $e.weight * 0.6&gt;&gt;
&lt;&lt;consume $e.weight _calories&gt;&gt;
&lt;&lt;set $e.maxhea -= 12&gt;&gt;
&lt;&lt;eDamage 12&gt;&gt;

&lt;&lt;if !$alive&gt;&gt;
&lt;br&gt;
&lt;&lt;if !$options.popping&gt;&gt;
Letting out a stuffed, painful &#39;&#39;BELCH&#39;&#39;, you fall back onto your butt and sprawl on the milking shed floor, weakly rubbing at your massively overstuffed belly. The cheese bounces to and fro, growling at you, but you&#39;re too full to pay it any more attention, and it seems to realise the fact. As the world begins to spin around you, your last coherent thought is that you&#39;re going to have some pretty spectacular nightmares tonight. The cheese suddenly launches itself into the air, and bounces on your aching, over-pressurised belly with a heavy &#39;&#39;BWOOMPH!&#39;&#39; You let out a weak cry and mercifully black out... 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
Letting out a stuffed, painful &#39;&#39;BELCH&#39;&#39;, you fall back onto your butt and sprawl on the milking shed floor, weakly rubbing at your massively overstuffed belly. The cheese bounces to and fro, growling at you, but you&#39;re too full to pay it any more attention, and it seems to realize the fact. The cheese suddenly launches itself into the air, and bounces on your aching, over-pressurized belly with a heavy &#39;&#39;BWOOMPH!&#39;&#39; Your gut bulges outward from the hefty blow and explodes with a gooey &quot;BANG!&quot;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;elseif $e.hea &lt;= 0&gt;&gt;
The demonic cheese is finally weakening, large cracks appearing across its rind as it tries to keep itself together. You make a grab for it, catch hold of a gash in its side with your fingers and &#39;&#39;HEAVE&#39;&#39;. With a noise like a tree-trunk splitting apart you tear the remains of the cheese in two, right down the middle. You then viciously stuff one of the chunks into your mouth, and chew, and chew, and chew... 
&lt;br&gt;&lt;br&gt;

Eventually you&#39;re found sitting on the floor, legs spread apart, swollen belly sitting in your lap. All that remains of your adversary is a single solitary chunk of cheese in your hand, and a rather unpleasantly lingering smell. You gulp this last mouthful heavily, and feel the lump heading down to join the queue for your stomach. Bits of gnawed rind litter the floor, and there are little heaps of cheesy crumbs scattered around. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
Catching the cheese off guard, you turn and sprint for the shed door. With the cheese in hot pursuit, you slam it shut behind you and lean on it, hard. The doors resound with a mighty &#39;&#39;THUD&#39;&#39; as the cheese collides with them. You listen for a few minutes, breathing hard, but there&#39;s no further noises from inside the shed. Panting, you look up to find that the bull standing in front of you- evidently he returned to find out how the fight was going. He gives you a worried look as your expression says it all. 

&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You turn and try to make a dash for the shed door, but the cheese cannons into the back of your knees, dropping you onto your front. As you try to stagger upright, the cheese launches itself at you again, smacking into your $fatness rump, sending you sprawling to the floor again. As you try to scramble on your hands and knees towards the door, it lands on your back like some kind of wrestling move, squashing you to the floorboards and squeezing the air out of you. 
&lt;br&gt;&lt;br&gt;

You&#39;re not getting away from this dairy derivative without a fight! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You give up. With a groan, you slump to your knees, resigned to the fact that you&#39;ve bitten off more than you can chew here. The cheese bounces on the spot and hoots at you in triumph, seeming to grow slightly bigger. Then it thuds forwards and launches itself high into the air. You look up to follow it, and the last thing you see before the world turns black is the underside of a large wheel of cheese, hurtling down towards your head, getting bigger and bigger and bigge- 

&lt;&lt;defeated &quot;battle&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
Letting out a stuffed, painful BELCH, you fall back onto your butt and sprawl on the milking shed floor, weakly rubbing at your massively overstuffed belly. The cheese bounces to and fro, growling at you, but you&#39;re too full to pay it any more attention, and it seems to realise the fact. As the world begins to spin around you, your last coherent thought is that you&#39;re going to have some pretty spectacular nightmares tonight. The cheese suddenly launches itself into the air, and bounces on your aching, over-pressurised belly with a heavy &#39;&#39;BWOOMPH!&#39;&#39; You let out a weak cry and mercifully black out... 
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;					

&lt;&lt;else&gt;&gt;
You stagger drunkenly, stomach aching and head ringing from the overpowering smell of cheese in your nostrils. You never want to touch the stuff again! As you drop your guard, the cheese senses your weakness and suddenly launches itself toward you at head height, spinning like a discus! By the time you look up and see it you&#39;re too slow and fuddled to react in time. You manage to get your arm half up to defend yourself but the cheese whizzes past your guard and cannons into the side of your head. You drop to your knees, seeing stars and feeling the room spin around you. It&#39;s all too much, and you gratefully let yourself fall forwards into the black unconsciousness that rushes up to greet you... 
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;			
&lt;&lt;/if&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The demonic cheese is finally weakening, large cracks appearing across its rind as it tries to keep itself together. You make a grab for it, catch hold of a gash in its side with your fingers and &#39;&#39;HEAVE&#39;&#39;. With a noise like a tree-trunk splitting apart you tear the remains of the cheese in two, right down the middle. You then viciously stuff one of the chunks into your mouth, and chew, and chew, and chew... 
&lt;br&gt;&lt;br&gt;

Eventually you&#39;re found sitting on the floor, legs spread apart, swollen belly sitting in your lap. All that remains of your adversary is a single solitary chunk of cheese in your hand, and a rather unpleasantly lingering smell. You gulp this last mouthful heavily, and feel the lump heading down to join the queue for your stomach. Bits of gnawed rind litter the floor, and there are little heaps of cheesy crumbs scattered around. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="19" name="cheetah ai" tags="" position="4900,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is an extremely well fed $npc1.species whose stomach hangs down from $npc1.his otherwise sleek frame like a lead balloon. $npc1.His bulging belly sways back and forth with every step as $npc1.he eyes you hungrily, apparently still wanting to cram even more into $npc1.his overstretched gut. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;

/*Vore attack*/
&lt;&lt;if random(1,4) == 1 and $hea &lt; 20&gt;&gt;
  &lt;li&gt;&#39;&#39;Devour&#39;&#39;&lt;/li&gt;
  
  &lt;&lt;if setup.dodgeInstantDeath()&gt;&gt;
  Your opponent believes you are weakened. $npc1.He rears back and attempts to tackle you, $npc1.he jaws opened wide, but you are able to fight $npc1.him off and throw $npc1.him to the ground. 
  
  &lt;&lt;else&gt;&gt;
  Your opponent senses $npc1.his opportunity. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. You try to dodge $npc1.him, but $npc1.he&#39;s too strong and fast for you. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. From the outside, the $npc1.species&#39;s stomach stretches to the ground and then some. The $npc1.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $npc1.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. You can only pray that someone up there is looking out for you. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;

/*Normal attack*/
&lt;&lt;else&gt;&gt;
  &lt;&lt;if random(1,2) == 1&gt;&gt;
	&lt;li&gt;Bite&lt;/li&gt;
	The bloated $npc1.species waddles up and swipes at you with $npc1.his claws, dealing $edmg damage. 
  &lt;&lt;else&gt;&gt;
	&lt;li&gt;Swipe&lt;/li&gt;
	The bloated $npc1.species licks $npc1.his chops before jumping forward and biting you, dealing $edmg damage. 
  &lt;&lt;/if&gt;&gt;
  
  &lt;&lt;damage $edmg&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You lunge at your enemy in an attempt to devour the gorged $npc1.species and you succeed in tackling $npc1.him to the ground. You circle around to the front of the $npc1.species. $npc1.He struggles to back away, but after the battle $npc1.his legs are too tired to do more than scrape the ground, much less pick $npc1.himself back up. Opening your mouth, you kneel forward, engulfing the $npc1.species&#39;s $npc1.mouth.
&lt;&lt;set _calories = $e.weight*0.5&gt;&gt;
&lt;&lt;consume $e.weight _calories&gt;&gt;
&lt;br&gt;&lt;br&gt;

With a loud snap, your jaw dislocates and begins to stretch around $npc1.his head. As you swallow the big &lt;&lt;if $npc1.nspecies == &quot;cheetah&quot;&gt;&gt;cat&lt;&lt;else&gt;&gt;$npc1.species&lt;&lt;/if&gt;&gt; down, you force its legs back, but begin to have a bit of trouble as you reach the stomach. Packed as tight as it is, the round dome has no give whatsoever, and you&#39;ve no choice but to work the $npc1.species&#39;s stomach in bit by bit. Moving your jaws like a snake would, you gradually work your way to the widest point of the stomach. As you work past the widest point, your overstretched mouth begins to rapidly close, causing the $npc1.species to shoot down your gullet - you&#39;ve passed the point of no return. 

&lt;&lt;if $alive&gt;&gt;
The $npc1.species surges into your stomach like a ton of bricks, and as you swallow more, $npc1.he is curled into a tight ball, thrashing with desperation in a vain attempt for freedom. You swallow down the hind $npc1.feet, and suck down the twitching tail like a wet noodle. As the struggles slow, you let out a quiet burp and slowly heave yourself to your feet. Waddling forward, you rub your rounded gut as you lumber onward. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
							
&lt;&lt;else&gt;&gt;
The $npc1.species surges into your stomach like a ton of bricks, and as you swallow more, you feel a jolt of pain as you realize your stomach has gone way past its limits. You gag and fall forward, passing out as your stomach surges outward. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You flee from the battle. The $npc1.species attempts to chase you down, but $npc1.his heavy swaying belly makes it too hard for $npc1.him to chase after you and $npc1.he quickly gives up. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Your opponent senses $npc1.his opportunity. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. From the outside, the $npc1.species&#39;s stomach stretches to the ground and then some. The $npc1.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $npc1.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. You can only pray that someone up there is looking out for you. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You collapse to the ground, too battered to stay awake, as the $npc1.species pads towards you.
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The bloated $npc1.species is panting from exhaustion. $npc1.He turns and attempts to run away, but $npc1.his swaying stomach gets the better of $npc1.him and $npc1.he topples to the ground. $npc1.He tries to get up, but $npc1.he&#39;s too weakened from the fight to lift $npc1.his tremendous stomach. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="20" name="elephant ai" tags="" position="5150,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
You feel the ground shaking beneath you, making the grass around you sway sibilantly. Suddenly ahead of you out bursts a rampaging $npc1.nspecies! &lt;&lt;if $npc1.nspecies == &quot;elephant&quot;&gt;&gt;$npc1.He is quite possibly the roundest pachyderm you’ve ever seen, stomach swollen so much that that famously wrinkled hide is stretched completely taut and smooth. You notice that their trunk is curled around peculiarly purple fruit.&lt;&lt;else&gt;&gt;$npc1.He is quite possibly the roundest creature you’ve ever seen, stomach swollen so much that it looks like a perfectly smooth sphere of $npc1.fur. You notice that $npc1.he&#39;s clutching a peculiarly purple fruit in $npc1.his grip.&lt;&lt;/if&gt;&gt; As you watch, the $npc1.nspecies greedily stuffs it into $npc1.his mouth. The liberal purplish staining around $npc1.his lips suggests that they’ve already eaten far too many of those things. Even as that belly gurgles and stretches slightly larger before your very eyes, the highly elastic $npc1.nspecies advances ponderously towards you, eyes gleaming hungrily. It’s going to take more just than peanuts to fill &#39;&#39;THAT&#39;&#39; stomach now. In fact, it looks like $npc1.he thinks $npc1.he&#39;ll stretch enough to fit &#39;&#39;YOU&#39;&#39; in, as well! 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;

/*Non-grapple attacks*/
&lt;&lt;if $grapple &lt;= 0&gt;&gt;

&lt;&lt;switch random(1,4)&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;li&gt;Charge&lt;/li&gt;
&lt;&lt;if setup.dodge()&gt;&gt;
As the &lt;&lt;if $npc1.nspecies == &quot;elephant&quot;&gt;&gt;$npc1.species’s tusks scythe&lt;&lt;else&gt;&gt;$npc1.species swipes&lt;&lt;/if&gt;&gt; at you, you dodge away from them, rolling neatly in the dust, safely out of range, for now. The $npc1.species squeals in outrage at being cheated in this way. 
&lt;&lt;else&gt;&gt;
Eyes crazed with the feral need to stuff itself, the $npc1.species lowers $npc1.his mighty head and charges you, the impact almost knocking you off your $p.feet! However, the $npc1.species seems a little surprised when $npc1.he rebounds slightly with a rubbery &#39;BWOING!&#39;, their charge stopped dead. Not half as surprised as you are. $npc1.He rears up to try to trample you underfoot, but you manage to dodge back to a safe distance. 
&lt;&lt;set $edmg *= Math.round(0.75)&gt;&gt;
&lt;&lt;damage $edmg&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;case 2&gt;&gt; /* icy - okay, I realise it&#39;ll be hard to remove all the elephantness from these attacks, so I won&#39;t bother */
&lt;li&gt;Gore&lt;/li&gt;
&lt;&lt;if setup.dodge()&gt;&gt;
As the &lt;&lt;if $npc1.nspecies == &quot;elephant&quot;&gt;&gt;$npc1.species’s tusks scythe&lt;&lt;else&gt;&gt;$npc1.species swipes&lt;&lt;/if&gt;&gt; at you, you dodge away from them, rolling neatly in the dust, safely out of range, for now. The $npc1.species squeals in outrage at being cheated in this way. 
&lt;&lt;else&gt;&gt;
Enraged, the $npc1.species brings $npc1.his head down and tries to spear you on their gleamingly-white tusks. Those at least don’t seem to have become rubbery yet! You manage to dodge enough to avoid being impaled, but one tusk hits your side. 
&lt;&lt;damage $edmg&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&lt;li&gt;Trumpet&lt;/li&gt;
Eyes narrowing, the $npc1.species suddenly extends $npc1.his trunk and lets out a deafening trumpeting. You reel back, clutching your ears to try to blot out some of the awful noise. 
&lt;&lt;if $agi &gt; 3&gt;&gt;
&lt;&lt;set _debuff = random(-1,-3)&gt;&gt;
&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if random(1,5) == 1&gt;&gt;
&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case 4&gt;&gt;
&lt;li&gt;Grab&lt;/li&gt;
&lt;&lt;if setup.dodge()&gt;&gt;
As the $npc1.species’s tusks scythe at you, you dodge away from them, rolling neatly in the dust, safely out of range, for now. The $npc1.species squeals in outrage at being cheated in this way. 
&lt;&lt;else&gt;&gt;
The $npc1.species suddenly lunges forwards. You step back, anticipating another attack, but- too slow! $npc1.His bloated trunk lunges out and wraps around your shoulders and stomach, pinning you in place! The trunk tightens its grip on you, and you wheeze- it’s like being in the coils of a grey &lt;&lt;=setup.getSpeciesData(&quot;anacondaSpecies&quot;).species&gt;&gt;! You find yourself face-to-nostrils with the business end of the $npc1.species’s trunk, panting for breath as you struggle. Then with what sounds suspiciously like an evil chuckle, the tip of the trunk jams itself in your gasping mouth! 
&lt;br&gt;&lt;br&gt;

A sudden, shocking blast of air fills your cheeks until they’re straining, and you groan as you feel your chest and middle beginning to bloat out too
&lt;&lt;if $arm.name != $unarmored.name&gt;&gt;
, your $arm.name beginning to feel increasingly tight around your stomach and under your armpits
&lt;&lt;/if&gt;&gt;
. This stretch-crazy $npc1.species is trying to blow you up like a party balloon! 
&lt;&lt;set _inf = random(2,5)&gt;&gt;
&lt;&lt;inflate _inf 0&gt;&gt;
&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;

/*Grappled attacks*/
&lt;&lt;else&gt;&gt;
&lt;li&gt;Blow&lt;/li&gt;
Behind you you can hear the $npc1.species drawing in a deep breath through $npc1.his mouth. Then you’re given &#39;&#39;ANOTHER&#39;&#39; long, hard puff through the trunk, your body slowly being forced to stretch larger and larger, your $waist belly blowing up even larger! 
&lt;&lt;set _inf = random(2,5)&gt;&gt;
&lt;&lt;inflate _inf 0&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
Your stomach letting out an intimidating roar, you launch yourself at the bemused $npc1.species, colliding so hard that it bounces onto its back! You grab one of the $npc1.species’s hind legs and embark on one of the biggest meals of your life, cramming its foot into your mouth and working your way from there. Getting the other hind foot into your mouth isn’t easy, but you manage it, aided by the $npc1.species’s own elasticity. By the time the stunned creature realises what you’re doing, you’ve managed to stuff both legs AND its collosal hiney into your mouth, stretching your cheeks and stomach to ludicrous proportions. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	It squeals and quivers as it thrashes its legs and trunk, but you’ve now reached its equator, jaws stretching hugely around it, suggesting that you’ve picked up some of the $npc1.species’s own elasticity. It certainly helps you to shovel more and more of the pooltoy pachyderm down your gullet, inching slowly forward. Then you’re over the hump so to speak, and with the greatest bulk of the $npc1.species inside you, its more of a challenge to stop the rest of it being pulled in too quickly! Like a balloon being squeezed most of the way through a narrow opening the $npc1.species’s bulk now literally drags its front end into your mouth after it, your body stretched to colossal proportions but somehow keeping it together. The $npc1.species’s front feet frantically scrabble at the packed earth for a moment, looking for purchase, and then it’s pulled in further, only its trunk sticking out of your mouth like a periscope. And then that too is gone, sliding down your throat like thick spaghetti. Your stomach lets out a huge GURGLE, whether of complaint or contentment you’re unsure. Wow, you’ve just eaten a whole &lt;&lt;=$npc1.species.toUpperCase()&gt;&gt;! 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	But then you find that you’ve bitten off more than you can chew- quite literally! You realise that your overstretched jaws are wedged around the $npc1.species’s equator-like waist: it’s too large to swallow and you’re stuck, unable to let go! The $npc1.species recovers from its shock and lets out an outraged, trumpeting bellow. Then you hear a noisy sucking sound, and feel the $npc1.species’s middle growing bigger between your jaws! It’s blowing itself up like a balloon! You feel your body creeak and begin to change shape as the $npc1.species pumps itself bigger and bigger, that part of it you’ve swallowed blowing up larger and larger inside you. Your hide starts to straaiiin to contain such an enormous volume and your eyes water, jaws getting stretched wider and wider and wider. The world starts to spin around you as you become nothing more than a balloon yourself. 
	&lt;&lt;if $options.popping&gt;&gt;
		You feel the $npc1.species suck in another breath through its trunk, and it all becomes too much- the world starts to turn white at the edges of your vision as you feel seams inside your body beginning to pop apart as the $npc1.species fills you, then overfills you! You begin to swell faster now, out of control, and as the world fades to a blinding, pure white you feel and hear what might be the start of a devastating explosi-
	&lt;hr&gt;
	&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		Mercifully, the immense pressure inside you finally causes you to black out, sinking into unconsciousness with a deep longing for some bicarbonate of soda...
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You manage to get out of range of that flailing trunk and turn and run into the grassland. With a furious bellow the $npc1.species sets after you, but almost immediately you hear a squeal of satisfaction. Risking a look over your shoulder, you see the $npc1.species clasping a pile of stretchy-fruits in $npc1.his trunk, which $npc1.he stuffs into $npc1.his mouth. As they’re gulped down that huge grey belly swells even larger, and the $npc1.species finally beaches itself on $npc1.his own stomach, trumpeting after you as you get safely out of range- either from being eaten, or from the $npc1.species exploding! 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to flee from this overly-elasticated $npc1.species, but $npc1.his trunk whips out and tangles with your legs, sending you sprawling on the hard ground. You roll and heave yourself upright, this time careful not to take your eyes off your opponent. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
With an exhausted sigh you lower your arms from their defensive stance
&lt;&lt;if $wea.name != $unarmed.name&gt;&gt;
, your $wea.Name falling to the ground
&lt;&lt;/if&gt;&gt;
.  The $npc1.species flaps its ears and trumpets in triumph, while you lower your head, an acknowledgement that you are beaten. You lift your $fatness arms out from your sides as if to embrace your fate, and the $npc1.species tramples towards you. As $npc1.his shadow falls across you you close your eyes and are knocked to the ground with a tremendous swipe from its trunk. 
&lt;br&gt;&lt;br&gt;

Exhausted from the fight, a final, contemptuous swipe from the $npc1.species’s trunk sends you sprawling to the ground, too weak to even get up. Something wraps around your ankle and you’re suddenly hoisted upwards, and find yourself dangling upside-down in front of the $npc1.species’s jaws. You swear those lips curve into a smile before $npc1.he stuffs you in greedily, like the biggest peanut in history! It takes some cramming 
&lt;&lt;if setup.waistDiameter() &gt; 15&gt;&gt;
- in particular your $waist belly is quite a mouthful - 
&lt;&lt;/if&gt;&gt;
but the $npc1.species’s mouth and throat both seem to stretch around you to let $npc1.him force you down. You feel the $npc1.species’s trunk shoving on your $fatness butt as $npc1.he attempts to squeeze you in. Finally though, despite your struggles you feel yourself slip all the way into the pachyderm’s highly-elastic gullet, and you slowly surf down $npc1.his throat like a grapefruit that’s been swallowed by a worm until you hit the cramped surroundings of $npc1.his stomach. 
&lt;br&gt;&lt;br&gt;

You feel the sides of the $npc1.species around you quiver, and you realise the creature that’s eaten you must have just let out a huge burp of satisfaction. If it’s any consolation, from the feel of it $npc1.he&#39;s now beached on $npc1.his stomach, so with a bit of luck you’ll weigh them down for a good long time to come. With a sigh you close your eyes, and try not to think about what’s going to happen to you now... 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
/*If you&#39;re overfilled*/
&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
The pneumatic pachyderm delivers puff after puff into you, swelling you up into the land’s one-and-only $p.species-balloon! You squirm helplessly, but nothing seems to stop your expansion, and quite soon your arms and legs become helplessly bloated and taut, sticking out from your body at right angles. The $npc1.species blows you up bigger and bigger until you’re a parade-float parody of a $p.species, vast, round body floating off the ground, &#39;tethered&#39; by the $npc1.species’s trunk as $npc1.he empties even more hot air into you! Finally you feel your hide begin to creak and strain, unwilling to stretch any further. 
&lt;br&gt;&lt;br&gt;

&lt;&lt;if $options.popping&gt;&gt;
But the $npc1.species seems too far gone to realise this- to your horror you see $npc1.him drawing in yet another deep breath to puff into you! You desperately try to shake your head, but you’re so swollen you can’t budge an inch! You whimper and shut your eyes as the $npc1.species’s trunk trembles with pent up force, and another gout of stretchy-fruit scented air blasts into you! You feel your body trembling with tension as you grudgingly stretch even further, swelling out of shape, no longer even recognisable as $p.article $p.species but just a huge round $p.furBack balloon in the sky. The $npc1.species’s breath seems to go on and on, and as you feel yourself stretch too far you open your eyes, only to see everything white-out followed by a deafening...&#39;&#39;BANG&#39;&#39; 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
With a drunken gleam in their eye the $npc1.species puffs one last lungful of air into you that sets you creaking, before your lips finally &#39;&#39;POP&#39;&#39; free of their trunk, bobbing above their head like some huge novelty balloon. The $npc1.species reaches up with $npc1.his trunk and &#39;&#39;BONG&#39;&#39;s it against your side, setting you tumbling up, up and away, completely unable to stop yourself and terrified that if you let all that air out at once you’ll blow yourself to Bermuda! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;floating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If you&#39;re not overfilled*/
&lt;&lt;else&gt;&gt;
Exhausted from the fight, a final, contemptuous swipe from the $npc1.species’s trunk sends you sprawling to the ground, too weak to even get up. Something wraps around your ankle and you’re suddenly hoisted upwards, and find yourself dangling upside-down in front of the $npc1.species’s jaws. You swear those lips curve into a smile before $npc1.he stuffs you in greedily, like the biggest peanut in history! It takes some cramming 
&lt;&lt;if setup.waistDiameter() &gt; 15&gt;&gt;
- in particular your $waist belly is quite a mouthful - 
&lt;&lt;/if&gt;&gt;
but the $npc1.species’s mouth and throat both seem to stretch around you to let $npc1.him force you down. You feel the $npc1.species’s trunk shoving on your $fatness butt as $npc1.he attempts to squeeze you in. 
&lt;br&gt;&lt;br&gt;

Finally though, despite your struggles you feel yourself slip all the way into the pachyderm’s highly-elastic gullet, and you slowly surf down $npc1.his throat like a grapefruit that’s been swallowed by a worm until you hit the cramped surroundings of $npc1.his stomach. You feel the sides of the $npc1.species around you quiver, and you realise the creature that’s eaten you must have just let out a huge burp of satisfaction. If it’s any consolation, from the feel of it $npc1.he&#39;s now beached on $npc1.his stomach, so with a bit of luck you’ll weigh them down for a good long time to come. With a sigh you close your eyes, and try not to think about what’s going to happen to you now... 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The $npc1.species eventually tires, and with a final &#39;&#39;THUMP&#39;&#39; you at last manage to send it staggering back. You follow up the blow with a haymaker to the $npc1.species’s rubbery chin that actually causes the thing to fall backwards and roll right over onto its back! Squealing and trumpeting in rage, the pneumatic pachyderm waggles its bloated, stubby legs in the air helplessly as it rocks from side to side, unable to right itself! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="21" name="lion ai" tags="" position="4775,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/* FIXES AND EDITS - Correct Lion&#39;s narration to use NPC gender */

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a large $npc1.male $npc1.species who has a huge round belly that reaches halfway to the ground. $npc1.He&#39;s eyeing you hungrily, apparently ready to add a little more to $npc1.his overstretched stomach. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;set _chance = random(1,4)&gt;&gt;

/*Vore attack*/
&lt;&lt;if _chance == 1 and $hea &lt; 20&gt;&gt;
  &lt;li&gt;&#39;&#39;Devour&#39;&#39;&lt;/li&gt;
  
  &lt;&lt;if setup.dodgeInstantDeath()&gt;&gt;
  Your opponent believes you are weakened. $npc1.He rears back and attempts to tackle you, $npc1.his jaws opened wide, but you are able to fight $npc1.him off and throw $npc1.him to the ground. 
  
  &lt;&lt;else&gt;&gt;
	Your opponent senses $npc1.his opportunity. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. You try to dodge $npc1.him, but $npc1.he&#39;s too strong and fast for you. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. 
	&lt;br&gt;&lt;br&gt;
	
	From the outside, the $npc1.species&#39;s stomach stretches to the ground and then some. The $npc1.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $npc1.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. You can only pray that someone up there is looking out for you. 
	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;

/*Debuff attack*/
&lt;&lt;elseif _chance == 2 and $agi &gt; 5&gt;&gt;
&lt;li&gt;Roar!&lt;/li&gt;
The bloated $npc1.species lets out a deafening &#39;&#39;roar&#39;&#39;, leaving you feeling weak in the knees and slowed. 
&lt;&lt;tempBuff &quot;agi&quot; -5&gt;&gt;

/*Normal attack*/
&lt;&lt;else&gt;&gt;
  &lt;&lt;if random(1,2) == 1&gt;&gt;
	&lt;li&gt;Bite&lt;/li&gt;
	The bloated $npc1.species licks $npc1.his chops before jumping forward and biting you, dealing $edmg damage. 
  &lt;&lt;else&gt;&gt;
	&lt;li&gt;Swipe&lt;/li&gt;
	The bloated $npc1.species waddles up and swipes at you with $npc1.his paw, dealing $edmg damage. 
  &lt;&lt;/if&gt;&gt;
  
  &lt;&lt;damage $edmg&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You lunge at your enemy in an attempt to devour the $e.name and you succeed in tackling $npc1.him to the ground. Sitting down, you grasp the $npc1.species&#39;s hind paws in your hands. You guide them to your mouth and open wide, shoving them down your throat.	With each swallow, the $npc1.species is pulled in a bit further. Progress slows as you reach the stomach, as you have to constantly push the $npc1.species&#39;s corpulent belly over your teeth. The hindpaws enter your stomach as you finally get the majority of $npc1.his gut into your maw, and work your way to $npc1.his &lt;&lt;if $npc1.male == &quot;male&quot;&gt;&gt;mane&lt;&lt;else&gt;&gt;head&lt;&lt;/if&gt;&gt;. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	&lt;&lt;if $npc1.male == &quot;male&quot;&gt;&gt;You pin it to $npc1.his body so that it doesn&#39;t mess with your face as you swallow.&lt;&lt;/if&gt;&gt; You&#39;re able to finally close your mouth over $npc1.his maw, and finish up by working $npc1.his fore legs in. With one final gulp, $npc1.he is sent on a one way trip into your rounded stomach, which heavily hangs much closer to the ground, much as &lt;&lt;if $npc1.male == &quot;male&quot;&gt;&gt;his&lt;&lt;else&gt;&gt;hers&lt;&lt;/if&gt;&gt; did earlier. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You feel a constriction in your gut as your reach it, however. Try as you might, you are unable to swallow a single bit more; it seems you are at your limit! To make things worse, the $npc1.species chooses this exact moment to awaken. Thrashing wildly, $npc1.he manages to lurch $npc1.his way out, slowly deflating your gut. 
	Your opponent senses $npc1.his opportunity. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. You try to dodge $npc1.him, but you&#39;re too busy recovering from your failed attempt to devour $npc1.him. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. From the outside, the $npc1.species&#39;s stomach stretches to the ground and then some. The $npc1.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $npc1.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. You can only pray that someone up there is looking out for you. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You flee from the battle. The $npc1.species waddles after you, but the weight in $npc1.his stomach slows $npc1.him down and $npc1.he decides $npc1.he&#39;s too stuffed and lazy to chase anything down. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Your opponent senses $npc1.his opportunity. $npc1.He rears back and lunges toward you, $npc1.his jaws stretched almost impossibly wide. $npc1.He tackles you to the ground and locks $npc1.his mouth around your head. $npc1.He slowly and laboriously swallows you whole as you struggle against $npc1.him. You feel yourself slide into $npc1.his large stomach as $npc1.he swallows you down. $npc1.His stomach stretches massively to contain you. 
&lt;br&gt;&lt;br&gt;
	
From the outside, the $npc1.species&#39;s stomach stretches to the ground and then some. The $npc1.species grunts and rolls onto $npc1.his side as $npc1.his humongous stomach towers several feet over $npc1.him. The $npc1.species lets out a pained but contented sigh as $npc1.he sets about digesting $npc1.his painfully large feast. You can only pray that someone up there is looking out for you. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You collapse to the ground, too battered to stay awake, as the $npc1.species pads towards you.
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;		
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The bloated $npc1.species heaves out a sigh and collapses to the ground, too weakened by the fight to hold up $npc1.his heavy stomach. $npc1.He rolls on $npc1.his side and passes out. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="22" name="lizard wizard ai" tags="" position="5975,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This smallish $npc1.species is dressed in snappy, colorful garb. It fails to hide $npc1.his pudgy belly, but between the feathered cap, colorful patterns, and the wand that leaves slight magical trails as $npc1.he waves it idly, it does the job of letting you know that you&amp;#39;re up against a wizard. The wicked grin lets you know that $npc1.he&amp;#39;s a confident one, at that. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
/*Attacks while not grappled*/
&lt;&lt;if $grapple &lt;= 0&gt;&gt;

&lt;&lt;switch random(1,3)&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;li&gt;Leaden&lt;/li&gt;
The $npc1.species flicks $npc1.his wand at an odd angle, then points it at you. Your flesh seems to stiffen and your body slows; $npc1.his magic is adversely affecting your mobility! 
&lt;&lt;set _debuff = random(-3,-6)&gt;&gt;
&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;li&gt;Soften&lt;/li&gt;
The wizard slowly curves $npc1.his wand to point at you, and your gear grows heavy. $npc1.His magic is causing your strength to fade, formerly hard muscles becoming soft! 
&lt;&lt;set _debuff = random(-3,-6)&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; _debuff&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&lt;li&gt;Grasp&lt;/li&gt;
&lt;&lt;set _player = $int + $agi + 50&gt;&gt;
&lt;&lt;set _enemy = $e.int + $e.int&gt;&gt;

&lt;&lt;if setup.skillTestRange(_player, _enemy, 10, 90)&gt;&gt;
The wizard twirls $npc1.his wand, but you circle about $npc1.him as $npc1.he points towards you. The plants reach out for you, but only manage to scrape lightly against you as you deftly evade them. $npc1.He growls in frustration, $npc1.his grin becoming an angry scowl at this. 

&lt;&lt;else&gt;&gt;
The wizard twirls $npc1.his wand as $npc1.he raises it above $npc1.his head, $npc1.his free $npc1.hand pointing at you. Before you can react, the mass of limbs and vines ensnares you, and $npc1.his grin spreads wider as the plants begin to force their enormous fruit into your mouth! 
&lt;&lt;set $grapple = $e.int * 3&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;

/*Attacks while grappled*/
&lt;&lt;else&gt;&gt;
&lt;li&gt;Feed!&lt;/li&gt;
The $npc1.species taunts you as several fruits are rammed into your mouth and face. You have no choice but to take a bite and gulp it down to clear your view and get some air. 
&lt;&lt;set _stuff = random (3,6)&gt;&gt;
&lt;&lt;set _calories = _stuff * 0.5&gt;&gt;
&lt;&lt;consume _stuff _calories&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;if $agi &lt;= 0 or $str &lt;= 0 or $end &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You decide to solve this conflict in short order and lunge for the little $npc1.species. Caught off guard, $npc1.he lets out a squeak as you grasp $npc1.his round body. As you lift $npc1.him up towards your hungering maw, $npc1.he cries out, weakly beating you on the head with $npc1.his wand. It avails $npc1.him not, your mouth closing about $npc1.his head as you begin to force $npc1.his flailing body down your throat. With a bit of a shove, you work your jaws to slide $npc1.him up to $npc1.his chest, $npc1.his muffled cries stifled inside you. Putting a hand to $npc1.his squishy belly, you upend $npc1.him and tilt your head back, sending $npc1.him sliding towards your stomach. $npc1.His writhing tickles your insides as your stomach muscles work to squeeze $npc1.him into $npc1.his new place as a rolled-up lump in your stretched gut. You give your belly a pat and a rub as $npc1.he struggles inside you... 
&lt;&lt;consume 30 10&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
As $npc1.he suddenly goes still, you realize that you&#39;ve swallowed $npc1.his wand along with $npc1.him; $npc1.his grasp on it never failed the whole time. Before you can be impressed by $npc1.his tenacity, you can feel the warm tingling of a spell going to work inside you. Your $waist belly suddenly begins to swell, something dense and squishy stretching you from inside. You let out a groan as the mass in your stomach redoubles, making you bulge and round out, your stomach sagging as it grows and over-fills. You are $hungry when it stops, but it appears that that was all the little wizard had. The farm fades away around you, and an empty cart led by a $horse.species begins to roll away into the distance. 
&lt;&lt;set $cal += 18&gt;&gt;
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
As the struggle in your belly stops, you have just enough time to realize that $npc1.he never released $npc1.his magic wand. The tell-tale warm tingling of magic suddenly spreading through your stomach confirms your fears, and your $waist belly begins to stretch anew. You fall to your knees as your stomach bloats and fills, a pained groan escaping your lips as you fill far beyond your capacity. You grasp your swelling belly in both $p.hands, rubbing it desperately as the pressure mounts. Alas, your treatments are in vain, and you soon fall to your back, your overfull belly rising into the air above you. As your hide stretches thinner, you can just make out the glow of the wizard’s wand through your overtaxed $p.fur before you burst with a thunderous BANG!
&lt;br&gt;&lt;br&gt;

The little wizard brushes $npc1.himself off, collects $npc1.his feathered cap and heads off into the grasslands.
&lt;hr&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
As the struggle in your belly stops, you have just enough time to realize that $npc1.he never released $npc1.his magic wand. The tell-tale warm tingling of magic suddenly spreading through your stomach confirms your fears, and your $waist belly begins to stretch anew. You fall to your knees as your stomach bloats and fills, a pained groan escaping your lips as you fill far beyond your capacity. You grasp your swelling belly in both $p.hands, rubbing it desperately as the pressure mounts. Alas, your treatments are in vain and you soon fall to your back, your overfull belly rising into the air above you as you lose consciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
With great effort, you rip your limbs from the mass of plants, sending several fruits crashing to the ground. The $npc1.species screeches angrily at you as you make a mess of $npc1.his farm. 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against the plants, but to no avail, the sheer amount of vines, bushes, and tree limbs and roots encircling your body proving too much for you. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn to make a run for it. Vines claw at your $p.feet but eventually you manage to outrun their grasp leave the $npc1.species wizard behind!
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Surrounded and overwhelmed by magic and plants, you lower yourself to the ground, bowing your head in submission. The $npc1.species just cocks $npc1.his head in confusion and frowns. 
&lt;br&gt;&lt;br&gt;

&quot;You give up?&quot; $npc1.he asks, a slightly annoyed tone in $npc1.his voice. &quot;Shame,&quot; $npc1.he sighs, &quot;I was going to play with you more.&quot; The smile comes back across $npc1.his face as $npc1.he continues, &quot;But I suppose we can skip straight to the part where I punish you for theft.&quot; 
&lt;br&gt;&lt;br&gt;

$npc1.He taps your head with $npc1.his wand, then pokes it into your belly as $npc1.his plants wrap around you to hold you in place. Your belly seems to loosen just in time for the plants to begin forcing their fruit into your mouth, and you find yourself without the will to resist. 
&lt;&lt;stuffToBursting&gt;&gt;

You can only watch as your belly stretches bigger and bigger, an endless stream of delicious flavors parading into your mouth. Against your desire and better judgement, you find yourself slowly chewing and swallowing down enormous fruit after enormous fruit. Oranges, pears, grapes, apples, watermelon, all of it is swallowed down as you are stuffed to the brim, and pushed beyond it again and again. It seems to last for days, all the while the little $npc1.species is laughing softly and playing with your oversized belly like it was $npc1.his own personal plaything. 
&lt;&lt;consume 200 0&gt;&gt;

At length, your jaw stops moving, your body seeming to be unable to take anymore and simply halting entirely. You should have burst what seems like a few hundred gigantic feedings ago, but your tremendous gut rests on the ground now. 
&lt;br&gt;&lt;br&gt;

Giving it a scrutinizing look and letting out an appraising hum, the $npc1.species pats it, and declares, &quot;That&#39;ll do, I think.&quot; Gently, $npc1.he places $npc1.his wand on your head. &quot;Now I&#39;m going to be nice and let you sleep. Take a good rest, for your bulk will be serving me well...&quot; Your consciousness slowly fades, and your body begins to feel stiff. Where you touch the ground, you seem to sink into it, and as your vision goes dark, the last thing you see is your skin turning to bark and a leafy growth sprouting from it. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
With your will to fight sapped to nothing, you are left at the mercy of a wizard that you have wronged. While there are concievably worse situations to be in, this is certainly near the top of the list, and the wide grin on the $npc1.species&#39;s face shows that $npc1.he means to prove it. 
&lt;br&gt;&lt;br&gt;

&quot;You wanted to eat my fruit?&quot; $npc1.He taunts, $npc1.his plants wrapping around you and lowering you to your knees. &quot;Well, you&#39;re going to have to eat a whole lot of it if you&#39;re going to be of use around here,&quot; $npc1.he continues, tapping your head with $npc1.his wand, then poking it into your belly. Though the pressure inside it seems to lessen, your helplessness does not fade, and the plants begin to feed you their fruit. 
&lt;&lt;stuffToBursting&gt;&gt;

You can only watch as your belly stretches bigger and bigger, an endless stream of delicious flavors parading into your mouth. Against your desire and better judgement, you find yourself slowly chewing and swallowing down enormous fruit after enormous fruit. Oranges, pears, grapes, apples, watermelon, all of it is swallowed down as you are stuffed to the brim, and pushed beyond it again and again. It seems to last for days, all the while the little $npc1.species is laughing softly and playing with your oversized belly like it was $npc1.his own personal plaything. 
&lt;&lt;consume 200 0&gt;&gt;

At length, your jaw stops moving, your body seeming to be unable to take anymore and simply halting entirely. You should have burst what seems like a few hundred gigantic feedings ago, but your tremendous gut rests on the ground now. 
&lt;br&gt;&lt;br&gt;

Giving it a scrutinizing look and letting out an appraising hum, the $npc1.species pats it, and declares, &quot;That&#39;ll do, I think.&quot; Gently, $npc1.he places $npc1.his wand on your head. &quot;Now I&#39;m going to be nice and let you sleep. Take a good rest, for your bulk will be serving me well...&quot; Your consciousness slowly fades, and your body begins to feel stiff. Where you touch the ground, you seem to sink into it, and as your vision goes dark, the last thing you see is your skin turning to bark and a leafy growth sprouting from it. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;	


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
As your last attack connects, the little wizard suddenly disappears. With a hurried glance, you see that the plants have returned to their original, spaceous placement. The $npc1.species is a ways away from you, picking $npc1.himself up and dusting $npc1.his hat off. 
&lt;br&gt;&lt;br&gt;

&quot;You&#39;re lucky this time!&quot; $npc1.he growls angrily, and with a snap of $npc1.his wrist, $npc1.he points $npc1.his wand straight upward. With a brilliant flash and disorienting sound somewhere between a rush of wind and an explosion, the farm is gone, and a distant cart is hurrying away towards the horizon. 
&lt;br&gt;&lt;br&gt;

&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="23" name="ritualist ai" tags="" position="5275,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
A $npc1.species wildling with colored markings painted on $npc1.him in vaguely ritualistic designs. Behind $npc1.him is a large bag of assorted foods, presumably taken from society. After many years in the wild, $npc1.he has become very adept in their methods of preparing the perfect sacrifice. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;set _chance = random(1,4)&gt;&gt;

&lt;&lt;if _chance == 1 and ($e.hea * 2) &lt;= $e.maxhea and $e.mana &lt; $heal2.cost&gt;&gt;
&lt;li&gt;Heal&lt;/li&gt;
The wildling kneels down and quietly chants to $npc1.himself as he&#39;s enveloped in a soft green light. $npc1.His injuries visibly heal as $npc1.he restores $edmg health. 
&lt;&lt;enemyCast $heal2&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;li&gt;Feed&lt;/li&gt;
&lt;&lt;set $eventCounterB = either($cupcake,$cake,$sausage)&gt;&gt;
The wildling grabs $eventCounterB.article $eventCounterB.name from $npc1.his bag and runs at a frightening speed towards you. Before you know it, the entire $eventCounterB.name has been shoved down your gullet, the wildling already heading back for more of the contents of $npc1.his bag. 

&lt;&lt;set _eat = ($eventCounterB.eat * 2)&gt;&gt;
&lt;&lt;set _calories = $eventCounterB.calories&gt;&gt;
&lt;&lt;consume _eat _calories&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You attempt to flee from the battle and manage to escape from the yelling wild $npc1.man. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower your defences and surrender to your opponent. $npc1.He grins widely before saying something you can almost understand and smashing a watermelon over your head. Your vision fades to black and you fall to the ground unconscious. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by wildlings&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
As $eventCounterB.article $eventCounterB.name is pushed down your throat, your gut seems to groan with the pain of being pushed over the limit. You struggle to keep your stomach at ease while fending off the force-feeding wildling. You try to constantly avoid the ready $eventCounterB.name in the wildling&#39;s hand. Fed up with having to struggle with you, the wildling grabs a watermelon and smacks it against your head. You notice the wild glee on the wildling&#39;s face as your vision fades to unconsciousness. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by wildlings&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Upon realising defeat, the wildling runs away, throwing one final cupcake in your direction as a distraction. As you try to catch the cupcake, you see the wildling flee to the undergrowth in the corner of your eye. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="24" name="shaman ai" tags="" position="5400,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Walking out of the long grass, you come unexpectedly upon a canine figure standing with their back to you, staring into the distance. A ragged loincloth and blanket makes you think that this is a wilding, and you tense to defend yourself, but you relax slightly when you observe that $npc1.he carries no weapon, and not even any food. The only thing you can see is an old, gnarled staff and a small medicine-bag at their feet. The creature slowly turns to face you- soot black, hatchet-muzzled and quite the thinnest creature you’ve seen in a long time, $npc1.his face is decorated with tribal markings that even you can interpret. A shaman! Err... whoops! $npc1.He regards you with an inscrutable, hawk-like expression for a few moments, then $npc1.his weathered muzzle breaks slowly into a fathomless, predatory smile. This doesn’t look good...

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;set _attack = random(1,3)&gt;&gt;

&lt;&lt;if $grapple &lt;= 0 and _attack == 1&gt;&gt;
&lt;li&gt;Grab&lt;/li&gt;
The shaman fixes $npc1.his piercing gaze on you and their lips begin to move soundlessly. You feel a breeze pick up and swirl fitfully around you, sweeping across your $p.furBelly $p.fur. At the same time $npc1.he brings $npc1.his paws up as if holding a ball, and then slowly moves them closer together. The air around you seems to set like stone- you feel as though you’re clamped in the fingers of an invisible giant! You can’t move! 
&lt;&lt;set $grapple = 1 + $e.int * 3&gt;&gt;
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

/*Attack when you&#39;re not fattened*/
&lt;&lt;if $tfat &lt;= 0&gt;&gt;
&lt;li&gt;Chant&lt;/li&gt;
The shaman slowly raises one scrawny paw towards you, as if in greeting. $npc1.he smiles as your stomach lets out a deep gurgle, and you feel your $waist belly bulge even bigger!

&lt;&lt;set _food = random(3,6)&gt;&gt;
&lt;&lt;set _calories = random(2,4)&gt;&gt;
&lt;&lt;set _fat = _food * 2&gt;&gt;

&lt;&lt;tempBuff &quot;fat&quot; _fat&gt;&gt;
&lt;&lt;consume _food _calories&gt;&gt;

You stumble slightly, unbalanced by the extra weight, and a deep &#39;&#39;BURP&#39;&#39; forces its way up grudgingly from inside you. Hefting your growing gut, you realise that you’re not getting much fuller, but you ARE getting a lot fatter! This shamanistic stuffing leaves you feeling $hungry. 

/*Attack when you are fattened*/
&lt;&lt;else&gt;&gt;


&lt;&lt;set _food = random(3,6)&gt;&gt;
&lt;&lt;set _calories = random(2,4)&gt;&gt;
&lt;&lt;set _fat = _food * 2&gt;&gt;

&lt;&lt;if random(1,2) == 1&gt;&gt;
&lt;li&gt;Chant&lt;/li&gt;
The shaman raises $npc1.his paw once again, chanting soundlessly in an unknown language. Another loud &#39;&#39;BELCH&#39;&#39; escapes your muzzle, and your $p.hands go to your belly as you bulge with yet more added bulk, your stomach and sides spreading wider while your caboose balloons behind you. 
&lt;&lt;tempBuff &quot;fat&quot; _fat&gt;&gt;
&lt;&lt;consume _food _calories&gt;&gt;

&lt;&lt;else&gt;&gt;
The shaman raises $npc1.his paw once again, chanting soundlessly in an unknown language. You struggle to bite down a deep, rolling &#39;&#39;BURRRP&#39;&#39; as another jolt of forced-fullness hits you. 

&lt;&lt;tempBuff &quot;fat&quot; _fat&gt;&gt;
&lt;&lt;consume _food _calories&gt;&gt;

More blubber &#39;softening&#39; your now downright $fatness girth to even greater curvaceousness. You feel your thickening arms push up slightly from your sides, while your stance widens to accommodate your increasingly chubby thighs. 
&lt;&lt;/if&gt;&gt;

As your expansion subsides, you are left feeling $hungry. 

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn on your tail and run into the long grass, leaving your foe standing. As the distance lengthens you risk a glance over your shoulder to check for pursuit, but the shaman is merely watching your hurried departure with interest, head to one side. Just before $npc1.he vanishes into the distance $npc1.he smiles and raises one paw in a meaning that you can guess all too well- //&#39;be seeing you&#39;//. It looks like you’ve been let go, but why? 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You turn on your tail and run into the long grass, leaving your foe standing. Hearing no sounds of pursuit, you come to a halt after a few minutes, panting and wiping your brow. But when you stand up and happen to glance to your side you nearly jump out of your skin to find the shaman standing there exactly as before, apparently without having moved a muscle. You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Your ears and shoulders droop, and you spread your arms in a gesture of resignation. The shaman cocks $npc1.his head and regards you with an inscrutable stare for a few moments, then slowly reaches into $npc1.his medicine bag and produces an old wooden flute. $npc1.He brings it to $npc1.his lips and begins to play. You don’t hear anything but almost immediately you start to feel fuller. Looking down, you see your $waist belly begin to soften and swell larger. You heft it in your $p.hands and just stand there as you steadily balloon fatter, and fatter, and fatter. 

&lt;&lt;tempBuff &quot;fat&quot; 500&gt;&gt;
&lt;br&gt;

Within minutes you’ve grown enormously fat, your chubby features jiggling as you look down at your obese frame 

&lt;&lt;if $top.name != $shirtless.name or $btm.name != $pantsless.name&gt;&gt;
&lt;&lt;if $top.popped or $btm.popped&gt;&gt;
bulging out of the ripped and torn remains of your burst clothing
&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

, arms struggling to support the increasing weight of your belly while your backside is rapidly approaching barn-sized. With a soft groan you feel your belly-blubber beginning to slip through your fingers, and it finally touches ground, bouncing and then spreading. Your chubby legs widen and begin to ache from the effort of holding so much of you up, so you slowly topple onto your oh-so-generous rump, causing the ground to shake and raising a crater of dust around you. As the shaman continues to play your eyelids begin to droop irresistibly. You feel so, sooo sleepy... 
&lt;hr&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;wildlingShaman submit 2&quot;&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; 5000&gt;&gt;
&lt;&lt;/action&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You pant and groan as you struggle to keep standing on your own two increasingly porky $p.feet. Another tonsil-rattling &#39;&#39;BURRRRP&#39;&#39; forces itself out from between your jaws, and you feel the underside of your ever-increasing belly bounce against the hard-packed ground, then spread. 

&lt;&lt;set _stuffing = random(75,125)&gt;&gt;
&lt;&lt;set _fattening = _stuffing * 2&gt;&gt;

&lt;&lt;consume _stuffing 0&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; _fattening&gt;&gt;

You desperately try to haul yourself backwards, belly dragging, but the weight of your still-swelling butt presses down through your tired legs, and you finally sink to the floor, exhausted, landing with an earth-shaking plop onto your expansive backside. Seeing that you’re not going anywhere, the shaman produces an old wooden flute from their medicine bag, and begins to play. Absolutely no sound hits your ears, but almost at once your eyelids begin to droop irresistibly. You feel so, sooo sleepy... 
&lt;hr&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;wildlingShaman submit 2&quot;&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; 5000&gt;&gt;
&lt;&lt;/action&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
You prove too big a mouthful for the shaman to tackle. $npc1.He slips away from your last attack, $npc1.his eyes still fixed on you coldly. You lunge forwards in an attempt to grab $npc1.him before $npc1.he gets away, but land flat on your face in the dust, $fatness arms wrapped around thin air! You look up from your prone position on the floor laying atop your $waist belly, but all you see is the outline of a soaring eagle as it disappears into the horizon. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="25" name="shaman boss ai" tags="" position="5625,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
You face the wilding shaman, as skinny and dark as a shadow at noon, with ritualistic markings across the hatchet-like planes of $npc1.his chiselled canine features and adorned with a full ceremonial headdress and robe. Scrawny and completely unarmed, carrying only an old wooden flute, you still feel the skin crawl on the back of your neck when those eyes fix on you speculatively. The face is expressionless, but $npc1.his eyes are alight at this turn of good fortune. TWO captives for sacrifice... Looks like you&#39;ll have to fight your way out! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;if $tfat == 0&gt;&gt;
&lt;li&gt;Feed&lt;/li&gt;
The shaman slowly raises one scrawny $npc1.hand towards you, as if in greeting. $npc1.He smiles as your stomach lets out a deep gurgle, and you feel your $waist belly bulge even bigger! You stumble slightly, unbalanced by the extra weight, and a deep &#39;&#39;BURP&#39;&#39; forces its way up grudgingly from inside you. Hefting your growing gut, you realise that you&#39;re not getting much fatter, but you ARE getting a lot fuller! 
&lt;&lt;tempBuff &quot;fat&quot; 1&gt;&gt;
&lt;&lt;set _feed = random(4,8)&gt;&gt;
&lt;&lt;set _calories = random(3,6)&gt;&gt;
&lt;&lt;consume _feed _calories&gt;&gt;

&lt;&lt;else&gt;&gt;

&lt;&lt;if $grapple &lt;= 0 and random(1,3) == 1&gt;&gt;
&lt;li&gt;Grab&lt;/li&gt;
The shaman fixes $npc1.his piercing gaze on you and their lips begin to move soundlessly. You feel a breeze pick up and swirl fitfully across your $p.furBack $p.fur. At the same time $npc1.he brings $npc1.his $npc1.hands up as if holding a ball, and then slowly moves them closer together. The air around you seems to set like stone- you feel as though you&#39;re clamped in the fingers of an invisible giant! You can&#39;t move! 
&lt;&lt;set $grapple = $e.int * 3&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;li&gt;Feed&lt;/li&gt;
The shaman raises $npc1.his $npc1.his once again, chanting soundlessly in an unknown language. 

&lt;&lt;if random(1,2) == 1&gt;&gt;
Another loud &#39;&#39;BELCH&#39;&#39; escapes your muzzle, and your $p.hands go to your belly as you bulge with yet more added bulk, your stomach and sides spreading wider while your caboose balloons behind you. 
&lt;&lt;else&gt;&gt;
You struggle to bite down a deep, rolling BURRRP as another jolt of forced-fullness hits you, more blubber &#39;softening&#39; your now downright $waist girth to even greater curvaceousness. You feel your thickening arms push up slightly from your sides, while your stance widens to accommodate your increasingly chubby thighs. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _calories = random(3,6)&gt;&gt;
&lt;&lt;set _feed = _calories + random(1,2)&gt;&gt;
&lt;&lt;set _fat = _feed * 2&gt;&gt;
&lt;&lt;consume _feed _calories&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; _fat&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn on your tail and run into the long grass, leaving your foe standing. As the distance lengthens you risk a glance over your shoulder to check for pursuit, but the shaman is merely watching your hurried departure with interest, head to one side. Obviously they must have their hands full with just one prisoner- and given the size of $npc2.him, you&#39;re not surprised. You can still just hear the faint, frantic pleading of the enormous captive from the enclosure. You keep running, coward that you are. Just before the shaman vanishes from sight $npc1.he smiles and points a sticklike finger toward you in a gesture you can interpret only too well- &#39;next time it could be you&#39;. 
&lt;br&gt;&lt;br&gt;

You lost your pride, but at least you escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
Sweating with exertion, your heave and strain your shoulders and with a mighty effort of will manage to break free of the shaman&#39;s magical grip! You shout in triumph while the shaman growls angrily. 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
Under the amused gaze of your foe, you squirm and flex inside the vice-like grip of the magical wind, but are left panting for breath, unable to break free of whatever spell is holding you to the spot. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You turn on your tail and run into the long grass, leaving your foe standing. Hearing no sounds of pursuit, you stagger to a stop after a few minutes, panting and wiping your brow. But when you stand up and happen to glance to your side you nearly jump out of your skin to find the shaman standing there exactly as before, apparently without having moved a muscle. You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Your shoulders droop, and you spread your arms in a gesture of resignation. The shaman cocks $npc1.his head and regards you with an inscrutable stare for a few moments, then slowly brings the flute $npc1.he&#39;s carrying to $npc1.his lips, and begins to play. You don&#39;t hear anything but almost immediately you start to feel fuller. Looking down, you see your $fatness gut begin to soften and swell larger. You heft it in your $p.hands and just stand there as you steadily balloon fatter, and fatter, and fatter. &lt;&lt;stuffToBursting&gt;&gt;
&lt;br&gt;&lt;br&gt;

Within minutes you&#39;ve grown enormously fat, your chubby features jiggling as you look down at your obese frame,arms struggling to support the increasing weight of your belly while your backside is rapidly approaching barn-sized. With a soft groan you feel your belly-blubber beginning to slip through your fingers, and it finally touches ground, bouncing and then spreading. Your chubby legs widen and begin to ache from the effort of holding so much of you up, so you slowly topple onto your oh-so-generous rump, causing the ground to shake and raising a crater of dust around you. As the shaman continues to play your eyelids begin to droop irresistibly. You feel so, sooo sleepy... 
&lt;hr&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;wildlingShamanBoss submit 2&quot;&gt;&gt;
	&lt;&lt;tempBuff &quot;fat&quot; 5000&gt;&gt;
	&lt;&lt;consume 100 0&gt;&gt;
&lt;&lt;/action&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You pant and groan as you struggle to keep standing on your own two increasingly porky $p.feet. Another tonsil-rattling &#39;&#39;BURRRRP&#39;&#39; forces itself out from between your jaws, and you feel the underside of your ever-increasing belly bounce against the hard-packed ground, then spread. 
&lt;&lt;consume 25 0&gt;&gt;&lt;br&gt;&lt;br&gt;

You desperately try to haul yourself backwards, belly dragging, but the weight of your still-swelling butt presses down through your tired legs, and you finally sink to the floor, exhausted, landing with an earth-shaking plop onto your expansive backside. Seeing that you&#39;re not going anywhere, the shaman brings the flute $npc1.he&#39;s carrying to $npc1.his lips, and begins to play. Absolutely no sound hits your ears, but almost at once your eyelids begin to droop irresistibly. You feel so, sooo sleepy... 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;wildlingShamanBoss submit 2&quot;&gt;&gt;
	&lt;&lt;tempBuff &quot;fat&quot; 5000&gt;&gt;
	&lt;&lt;consume 100 0&gt;&gt;
&lt;&lt;/action&gt;&gt;



/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;

&lt;&lt;switch $e.special&gt;&gt;
/*If you haven&#39;t freed the captive*/
&lt;&lt;case $wildlingShamanBoss.special&gt;&gt;
You prove too tough a piece of meat for it to be worth chewing. The shaman lowers $npc1.his paw and slowly backs away from you, keeping between you and the stockade. The message in that fathomless stare is clear- &#39;leave now, before I change my mind&#39;. You cautiously back away to the edge of the clearing, still locked in a stare. Then you turn and make a break for it, pounding through the long grass. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

/*If you have freed the captive*/
&lt;&lt;default&gt;&gt;
With a snarl the shaman jumps back from your last attack, beaten, and utters a shrill cry of rage. You lunge forwards in an attempt to grab $npc1.him, but land flat on your face in the dust as a flock of ravens scatters in all directions, cawing and shrieking. 
&lt;br&gt;&lt;br&gt;

A hollow rumbling shakes the ground beneath you, and you look up into the super-fattened features of probably the world&#39;s fattest $npc2.species still beached on $npc2.his mind-bogglingly big belly. &quot;Oof! S-sorry, guess all that excitement worked up an appetite&quot; $npc2.he comments. $npc2.He blinks, and a smile stretches $npc2.his swollen features. &quot;Hey! I&#39;m not getting any BIGGER!&quot; $npc2.He whoops and punches the air, sending a heavy wobble through $npc2.his blimped-up form. With an immense effort, and some shoulder-work from you, $npc2.he manages to roll back onto $npc2.his feet, although $npc2.his stomach is still spread firmly on the ground. 
&lt;br&gt;&lt;br&gt;

&quot;Thanks $p.buddy, you&#39;ve just saved my bacon! I owe you, BIG TIME! I lost most of my gear back there-&quot; you don&#39;t offer to go and retrieve it, and $npc2.he doesn&#39;t look surprised. &quot;I don&#39;t even have the clothes I stand up in! But...&quot; $npc2.he reaches up, with difficulty, around $npc2.his neck and fumbles with something, &quot;...I can offer you THIS as a reward! With a final tug, a cord hidden beneath $npc2.his juicy chins comes loose and a money-pouch drops down into the valley between $npc2.his collosally bloated pecs. $npc2.He picks it up and tosses it to you, and it makes a satisfying //&#39;chink&#39;// in your $p.hands.

&lt;&lt;set _reward = random(34,47)&gt;&gt;
&lt;&lt;doGld _reward&gt;&gt;&lt;br&gt;

Just at that moment, the $npc2.species&#39;s cavernous stomach growls at $npc2.him again. $npc2.He absent-mindedly slaps a hand to $npc2.his belly, sinking in a couple of feet at least. &quot;Oof... don&#39;t you worry about me, I&#39;ll be fine from here. At least, I WILL be once I find some FOOD. There&#39;s gotta be a snack-bar or something around here...&quot; And with that, the colossal ex-captive ploughs laboriously away into the grasslands in search of a meal. 

&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="26" name="wildling ai" tags="" position="5025,375" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent was once a $npc1.species member of your society who has for some reason left to live in the wilderness. $npc1.He is wearing tattered rags of what were clothes manufactured in the city. $npc1.He is grinning at you malevolently as $npc1.he points a wooden spear at you. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;set _chance = random(1,3)&gt;&gt;

/*Self heal*/
&lt;&lt;if _chance == 1 and $e.item != &quot;&quot; and $e.hea &lt; ($e.maxhea - $e.item.heal)&gt;&gt;
&lt;li&gt;Potion&lt;/li&gt;
The wildling pulls out a glass bottle full of red liquid. $npc1.He chugs it down and $npc1.his wounds start healing. 
&lt;&lt;eHealth 25&gt;&gt;
&lt;&lt;set $e.item = &quot;&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

/*Normal attack*/
&lt;&lt;if random(1,2) == 1&gt;&gt;
&lt;li&gt;Jab&lt;/li&gt;
The wildling jabs at you with $npc1.his spear. 

&lt;&lt;else&gt;&gt;
&lt;li&gt;Whack&lt;/li&gt;
The wildling swings the spear around and catches you off guard, whacking you in the head. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;damage $edmg&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You attempt to flee from the battle and manage to escape from the yelling wild $npc1.man. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower your defences and surrender to your opponent. $npc1.He grins widely before saying something you can almost understand and whacking you hard over the head with the butt of $npc1.his spear. Your vision fades to black and you fall to the ground unconscious. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by wildlings&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Your vision fades to black and you fall to the ground unconscious. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by wildlings&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your opponent senses $npc1.his eminent defeat and decides to kick some dirt into your eyes. You cough and spit as you wipe the dirt out of your eyes and by the time you can see again, your foe seems to have vanished into the wilderness. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false &quot;grasslands randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="27" name="wildlingShaman submit 2" tags="nobr" position="5500,375" size="100,100">&lt;&lt;setPassageTitle &quot;At the shaman&#39;s mercy&quot;&gt;&gt;
&lt;&lt;rest&gt;&gt;&lt;&lt;rest&gt;&gt;
You jerk awake with a start. From the position of the $sun
you must have been fast asleep for hours! Feeling something pressing softly under your chin, you try to look down, but find that you can’t. When you eventually do manage to crane your neck forwards, it slowly dawns on you that you must have been putting on weight all the time that you were dozing. You’re a $p.furBelly &#39;&#39;BALL&#39;&#39;! Your truly colossal chest fills the base of your vision like a pair of rounded foothills, perched atop the absolutely mountainous blob that your belly has become. It sticks far out in front of you, the sides rolling on top of your widespread, hamlike legs. Vast, doughy lovehandles bulge atop your massive backside, which you can feel covering an embarrassingly large half-circle of ground behind you. Your obese arms stick out uselessly at your sides, too soft and bloated now to even bend, and unable to reach past the curve of your spreading sides and belly even if they could. Rocking your head from side to side you can feel the thick collar of blubber bloating out your neck- it’s an effort to just lean your head back. Even your &#39;&#39;FACE&#39;&#39; feels big and fat. 
&lt;br&gt;&lt;br&gt;

The shaman is sitting to one side, still playing $npc1.his pipe. A small shudder runs through your jumbo-sized bulk and you feel yourself swell even fatter. Your hide //creeeaks// in protest, and you manage to let out a little whimper. $npc1.He lower the flute from $npc1.his lips, much to your super-rounded relief. Then you hear a rustling in the long grass around you, and a group of wilding braves emerges in a loose circle. You gulp. You feel paws, shoulders and backs press against your mind-blowingly blubberous bulk, and with a muffled $p.angry of protest you tip sideways, and find yourself being literally ROLLED out of there! It’s slow, and squashy, but boy do you pick up momentum! They roll you along like some gargantuan rubber ball, leaving a trail of flattened grass wide enough to drive a $horse.species and cart along. You have the nasty certainty that you’ve just become the biggest, fattest sacrificial animal that their tribe have ever had. The constant rolling makes you dizzy, and your final thought before you pass out is that at least you won’t have to go on a diet plan... 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="28" name="wildlingShamanBoss submit 2" tags="nobr" position="5725,375" size="100,100">&lt;&lt;setPassageTitle &quot;At the shaman&#39;s mercy&quot;&gt;&gt;
&lt;&lt;rest&gt;&gt;
You finally surface to wakefulness again, blinking and smacking your lips sleepily, feeling very warm and comfortable, although for the moment you can&#39;t quite remember where yo- 
&lt;br&gt;&lt;br&gt;

You jolt fully awake, and at the same time realise what&#39;s keeping you so warm and comfortable is &#39;&#39;YOU&#39;&#39;! With an effort you manage to lean your chin forward, meeting resistance from your apparently-sizable chest, and are confronted by the huge, curving vista of your stomach. You&#39;re &#39;&#39;HEW-MUNG-GOUS&#39;&#39;- you can feel the underside of your $p.furBelly belly pressing on the ground, spreading your legs wide apart, while your backside is taking up an awful lot of room by the feel of it. Worse than that, you&#39;re surrounded by a circle of wooden stakes. With an audible &#39;&#39;GULP&#39;&#39; you slowly twist your head, and to one side catch sight of the $npc2.species who asked for your help, likewise penned, but even bigger than $npc2.he was before! Mobility obviously well beyond $npc2.him, $npc2.his now-stubby arms have lifted above horizontal by the sheer amount of blubber surrounding them and pressing up from underneath, while $npc2.his backside is in danger of pushing the enclosure down all by itself. $npc2.His gargantuan girth makes you look merely a bit chunky. $npc2.His superfattened features cast you a wordless look of disgust, and with visible effort turns $npc2.his gaze away from you. Just then the pair of you stifle slightly out-of-synch belches, and you immediately feel yourself expand, gut and butt both inching outwards across the ground. Panicking, you try to run, to stand, to move &#39;&#39;ANYTHING&#39;&#39;, but straining your muscles only produces a few wobbles on your weighed-down frame, your backside not even leaving the floor. Even that leaves you panting and in a sweat. You&#39;re BOTH captives now. 
&lt;&lt;sleep&gt;&gt;
&lt;br&gt;&lt;br&gt;

You both remain in silence throughout the following day, gradually getting fatter, and fatter, and fatter. By sundown you&#39;ve grown considerably more massive, while your fellow captive is now so obesely spherical the stockade holding $npc2.him looks ready to burst if $npc2.he so much as breathes deeply. At that time a procession of wildings arrives, carrying torches and strange symbols, headed by the shaman who captured the pair of you. At a gesture from $npc1.him, a number of the &#39;heftier&#39; wildings lumber forward and prize open the pen holding your friend, the stakes tumbling down in their paws. Then after a few ritual dances and some ceremonial-looking drinking, they form up and with obvious practice begin to roll the $npc2.species away into the gathering gloom, presumably for sacrifice. 
&lt;br&gt;&lt;br&gt;

It&#39;s a long, slow, above all heavy job, and under any other circumstances would be hilarious, if not for the thought that this was likely to happen to YOU, too. With their captive making muffled protests all the way and leaving a furrow pressed into the earth that they can all fit in, the remaining members of the procession leave, trailing their victim. As night falls completely another small //burrrp// escapes your increasingly chubby lips, and as you begin to drift off to sleep, still inflating with flab, you&#39;re rather depressingly certain that you&#39;ve just seen the &#39;fat&#39; that &#39;a-weights&#39; you come tomorrow... 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="29" name="bloat bee ai" tags="" position="5275,500" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a group of &lt;&lt;if $npc1.nspecies == &quot;bee&quot;&gt;&gt;rather oversized bees the size of humming birds&lt;&lt;else&gt;&gt;rather intimidatingly sized $npc1.plural&lt;&lt;/if&gt;&gt;. From their oversized abdomen protrude sharp stingers, which drip with an amber looking fluid. 
&lt;&lt;set _bees = Math.ceil($e.hea/25)&gt;&gt;
&lt;&lt;if _bees &gt; 1&gt;&gt;There are _bees left still flying. 
&lt;&lt;else&gt;&gt;There is only 1 bee left still flying. 
&lt;&lt;/if&gt;&gt;



/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;set _beesLeft = Math.ceil($e.hea/25)&gt;&gt;
&lt;&lt;set _damage = 0&gt;&gt;
&lt;&lt;set _bloat = 0&gt;&gt;

&lt;&lt;for _i = 1;_i &lt;= _beesLeft;_i++&gt;&gt;
	&lt;li&gt;Sting&lt;/li&gt;
	$npc1.Article $npc1.species dives toward you, it&#39;s stinger flaired. 
	&lt;&lt;switch setup.dodge()&gt;&gt;
		&lt;&lt;case false&gt;&gt;			
			&lt;&lt;doEdmg&gt;&gt;
			&lt;&lt;if $edmg != 0&gt;&gt;
				The stinger pierces your skin, and you feel a slight burning as you take $edmg damage. 
				&lt;&lt;set _damage += $edmg&gt;&gt;
				&lt;&lt;set _bloat += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
				The stinger doesn&#39;t manage to pierce your defenses, leaving you completely unharmed. 
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;default&gt;&gt;
			You manage to avoid it&#39;s needle like stinger. 
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/for&gt;&gt;

/*Deals total damage bloat*/
&lt;&lt;if _damage &gt; 0&gt;&gt;
	&lt;&lt;damage _damage&gt;&gt;
	&lt;&lt;buff &quot;bloat&quot; _bloat&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;set _beesLeft = Math.ceil($e.hea/25)&gt;&gt;
You decide not to fight against your $npc1.adjective foe. 
&lt;&lt;if _beesLeft &gt; 1&gt;&gt;
The $npc1..plural turn to each other and appear to communicate with each other through a series of buzzes. After a moment, they continue with the general $npc1.species plan and sting you several times over. 
&lt;&lt;else&gt;&gt;
The lone remaining $npc1.species hovers warily for a second, before continuing with the general $npc1.species strategy of stinging the crap out of everything. &lt;&lt;/if&gt;&gt;
You feel your stomach start to expand faster and faster as you&#39;re stung over and over again. 
&lt;&lt;stuffToBursting&gt;&gt;

&lt;&lt;if $options.popping&gt;&gt;
Eventually, you&#39;re far too bloated to stand and you fall to the ground as your stomach continues to inflate above you, rounding you out into a massive, helpless sphere. It seems most of the $npc1.plural have withdrawn. One lone bloat $npc1.species crawls across your taut hide. Its stinger flicking in and out as it scans for any sign of aggression. The bloat venom continues its work and you slowly grow larger and tighter. Your strained body emits a loud //CREEEEAAK// and the startled $npc1.species plummets its stinger down into the delicate surface of your belly. Your hide splits open at the speed of sound, sending a mighty &#39;&#39;POW&#39;&#39; echoing through the hills. 
&lt;hr&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
Eventually, you&#39;re far too bloated to stand and you fall to the ground as your stomach continues to inflate above you. Eventually you pass out from the pain of your overinflated stomach. 
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $ful &gt;= $maxFul&gt;&gt;
	You collapse to the ground clutching you bulging stomach. You can feel it stretched taut like an overinflated balloon. As you lay on your back nursing your overinflated gut, a new swarm of several $npc1.plural slowly hover towards you. As you&#39;re about to pass out from the pain of your overpressurized stomach, several $npc1.plural sting you in the stomach at once. 
	&lt;&lt;stuffToBursting&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
		You are stretched far too thin to be pierced like this. Your hide splits open at the speed of sound, sending a mighty &#39;&#39;POW&#39;&#39; echoing through the hills. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	You collapse to the ground, overwhelmed by the painful stings of you enemies. You can hear the sound of several more $npc1.plural buzzing their way into the area. As you&#39;re too weakened to fight them off, they all surround you and sting you at once. For a brief moment you feel the several stingers pierce your skin, but that&#39;s quickly overpowered as you feel your stomach rapidly blow up as being inflated like a balloon. 
	&lt;&lt;stuffToBursting&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
		As your stomach stretches and grows, your whole body begins to creak and groan at being stretched. The venom doesn’t let up and your taut hide gives way with a mighty &#39;&#39;POW&#39;&#39; that echoes though the hills. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

	&lt;&lt;else&gt;&gt;
		As your stomach stretches and grows, eventually the pain becomes too much and you pass out even as you feel your stomach slowly inflating larger and larger. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;



/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
You won! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="30" name="blueberry slime ai" tags="" position="5025,500" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a huge gelatinous cube about &lt;&lt;sayDistance 48&gt;&gt; long on each side. The translucent blue blob smells strongly of blueberries! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Feed&lt;/li&gt;
	The slime monster begins pushing itself down your throat, occasionaly making room for you to breath. You can&#39;t help but gulp it down between breaths as it squeezes itself into your stomach. 
	&lt;&lt;set _cram = random(4,9)&gt;&gt;
	&lt;&lt;eDamage _cram&gt;&gt;
	&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Feed&lt;/li&gt;
			The slime monster draws back in on itself before spraying a huge blast of slime directly towards your mouth. You can&#39;t help but swallow several mouthfuls and feel it slide into your gut. Almost as much slime gets on you as in you. It tastes delightfully like blueberries! 
			&lt;&lt;set _cram = random(5,9)&gt;&gt;
			&lt;&lt;eDamage _cram&gt;&gt;
			
			&lt;&lt;set _missed = _cram&gt;&gt;
			&lt;&lt;set _cram = random(3, _cram-2)&gt;&gt;
			&lt;&lt;set _missed += _cram&gt;&gt;
			&lt;&lt;set _missed *= -1&gt;&gt;
			&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
			
			&lt;&lt;tempBuff &quot;agi&quot; _missed&gt;&gt;
			&lt;&lt;consume _cram _calories&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Feed&lt;/li&gt;
			The slime monster draws back in on itself before firing a blast of slime towards you. If it was aiming at your mouth though, it appears to have missed. 
			&lt;&lt;set _slimed = random(2,6)&gt;&gt;
			&lt;&lt;eDamage _slimed&gt;&gt;
			&lt;&lt;set _slimed += random(3,_slimed)&gt;&gt;
			&lt;&lt;if _slimed &gt; 0&gt;&gt;
				&lt;&lt;set _slimed *= -1&gt;&gt;
				&lt;&lt;tempBuff &quot;agi&quot; _slimed&gt;&gt;
				The blast still manages to hit your legs, causes them to become sticky and hard to move. 
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;default&gt;&gt;
			&lt;li&gt;Grab&lt;/li&gt;
			The slime monster lunges towards you, 
			&lt;&lt;switch setup.dodge()&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					but you manage to dodge out of its way in time. 
					
				&lt;&lt;default&gt;&gt;
					engulfing your head and upper body in blue goo. 
					&lt;&lt;set $grapple = $e.hea * .75&gt;&gt;
					&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;if $e.hea &lt;= 0&gt;&gt;
	The last of the slime monster slides down your throat. 
	&lt;&lt;if !$alive&gt;&gt;
	For a moment you feel a sense of triumph, but you swiftly realize you&#39;re practically too full to stand. You collapse to the ground and roll over onto your back, your stomach sloshing back and forth, before passing out in an overstuffed coma. 
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	
	&lt;&lt;else&gt;&gt;
	With nothing left to fight, I guess you can call this a victory? 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;		
	
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $agi &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You open your mouth wide and beckon the slime monster in. You don&#39;t even have to swallow as the slime forcefully pumps itself into you. You rub your $waist stomach as it stretches outward with sentient blueberry sweetness. 
&lt;&lt;set _cram = $e.hea&gt;&gt;
&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
&lt;&lt;consume _cram _calories&gt;&gt;
&lt;&lt;eDamage _cram&gt;&gt;

&lt;&lt;switch $alive&gt;&gt;
	&lt;&lt;case true&gt;&gt;
		You slurp up the last of the slime monster down. With nothing left to fight, I guess you can call this a victory? 
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;		
		
	&lt;&lt;case false&gt;&gt;
		&lt;&lt;if $options.popping&gt;&gt;
		Your stomach keeps growing larger and larger, but there&#39;s still more blueberry slime to go. You hold onto your aching gut as blueberry goo pumps almost endlessly down your gullet. You slowly lower yourself down and sit on the ground as you feel your stomach stretch painfully bloated. You&#39;re not sure how much more you can take, but you&#39;re determined to win this gastronomical battle. If you can just hold out a little longer. You begin losing the test of will though as you collapse fully to the ground. The remainder of the slime monster rises menacingly and dives towards your mouth in a final onslaught. A wet GLOOORP resonates deep within your gut as the slime pushes into every available nook and cranny. Ultimately out of room, your belly lurches forward and bursts scattering globs of blue slime across the hillside.
Each glob creeps off to grow into a new blueberry slime. The cycle continues...
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

		&lt;&lt;else&gt;&gt;		
		Your stomach keeps growing larger and larger, but there&#39;s still more blueberry slime to go. You hold onto your aching gut as blueberry goo pumps almost endlessly down your gullet. You slowly lower yourself down and sit on the ground as you feel your stomach stretch painfully bloated. You&#39;re not sure how much more you can take, but you&#39;re determined to win this gastronomical battle. If you can just hold out a little longer. You begin losing the test of will though as you become too painfully full to stay awake. You collapse on your back on the ground and pass out even as the rest of the slime monster slides down your throat. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $e.hea &gt; 0 and $agi &gt; 0&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
	You fall to the ground, too painfully full to stand. You wince in pain and grab your achingly bloated gut. When you open your eyes, you look up to see the slime monster rising over you like a tidal wave. You look on in horror as the monster crashes down upon you, cramming it&#39;s entire mass down your throat. Your stomach starts groaning and gurgling as it stretches massively. You can feel the slime move around in your gut as it explore its new confines. Unfortunately, these new accommodations won’t do. Your bloated orb of a belly detonates with a wet BLOORP!
	&lt;&lt;set _cram = $e.hea * 0.5&gt;&gt;
	&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
	The slime creeps off in search of a new home. It seems the previous housing bubble has burst...
	&lt;hr&gt;
	&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

	&lt;&lt;else&gt;&gt;
	You fall to the ground, too painfully full to stand. You wince in pain and grab your achingly bloated gut. When you open your eyes, you look up to see the slime monster rising over you like a tidal wave. You look on in horror as the monster crashes down upon you, cramming it&#39;s entire mass down your throat. Your stomach starts groaning and gurgling as it stretches massively. 
	&lt;&lt;set _cram = $e.hea * 0.5&gt;&gt;
	&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
		Your $p.fur is so soaked through with with sticky blue gunk that you have trouble even moving. You eventually find you can&#39;t move your arms or legs and fall to the ground in a pile of blueberry slime. You look up to see the slime monster rising over you like a tidal wave. You look on in horror as the monster crashes down upon you, cramming it&#39;s entire mass down your throat. Your stomach starts groaning and gurgling as it stretches massively. You can feel the slime move around in your gut as it explore its new confines. 
		&lt;&lt;set _cram = $e.hea&gt;&gt;
		&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
		&lt;&lt;consume _cram _calories&gt;&gt;
		&lt;&lt;if $hea &lt;= 0&gt;&gt;
			Unfortunately, these new accommodations won’t do. Your bloated orb of a belly detonates with a wet BLOORP! 
			
			&lt;p&gt;The slime creeps off in search of a new home. It seems the previous housing bubble has burst...&lt;/p&gt;
			&lt;hr&gt;
			&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $alive = true&gt;&gt;
			However you manage to swallow it all down! Having swallowed the majority of the slime down, the remaining goo you&#39;re covered in starts sliding off of you and soaking into the ground. Apparently you&#39;ve won! 
			&lt;&lt;include &quot;Victory&quot;&gt;&gt;
			&lt;hr&gt;
			&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;				
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;else&gt;&gt;
		Your $p.fur is so soaked through with with sticky blue gunk that you have trouble even moving. You eventually find you can&#39;t move your arms or legs and fall to the ground in a pile of blueberry slime. You look up to see the slime monster rising over you like a tidal wave. You look on in horror as the monster crashes down upon you, cramming it&#39;s entire mass down your throat. Your stomach starts groaning and gurgling as it stretches massively. 
		&lt;&lt;set _cram = $e.hea&gt;&gt;
		&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
		&lt;&lt;consume _cram _calories&gt;&gt;
		&lt;&lt;if $hea &lt;= 0&gt;&gt;
			&lt;hr&gt;
			&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $alive = true&gt;&gt;
			However you manage to swallow it all down. Having swallowed the majority of the slime down, the remaining goo you&#39;re covered in starts sliding off of you and soaking into the ground. Apparently you&#39;ve won! 
			&lt;&lt;include &quot;Victory&quot;&gt;&gt;
			&lt;hr&gt;
			&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
You won! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===Capture a slime===*/
&lt;&lt;case &quot;capture&quot;&gt;&gt;
&lt;li&gt;Capture&lt;/li&gt;
&lt;&lt;if setup.skillTestRange($agi+$str+$int, $e.agi+$e.str+$e.int+$e.hea, 10, 90)&gt;&gt;
	You charge the large blue cuboid, 
	&lt;&lt;if setup.weight() &lt; 150&gt;&gt;scrabbling for purchase across its wide sides.
	&lt;&lt;elseif setup.weight() &lt; 300&gt;&gt;colliding with a gelatinous SLAP.
	&lt;&lt;else&gt;&gt;smacking into it so hard as to make it ripple.
	&lt;&lt;/if&gt;&gt;
	It seems stunned by this novel tactic, and seizing the opportunity you 
	&lt;&lt;if setup.weight() &lt; 150&gt;&gt;spring lightly on top of it.
	&lt;&lt;elseif setup.weight() &lt; 300&gt;&gt;leap laboriously on top of it.
	&lt;&lt;elseif setup.weight() &lt; 500&gt;&gt;heave yourself weightily on top of it.
	&lt;&lt;else&gt;&gt;flop whale-like on top of it.
	&lt;&lt;/if&gt;&gt;
	The Blueberry slime makes strange bubbling, glorping noises as it sinks down under your weight, spraying slime and struggling to free itself from your grip. But although by now thoroughly slime-soaked, you 
	&lt;&lt;if setup.weight() &lt; 150&gt;&gt;cling on frantically like a rodeo rider as it bucks and bounces,
	&lt;&lt;elseif setup.weight() &lt; 300&gt;&gt;keep it pinned beneath you with your sizeable belly while it wriggles and wobbles,
	&lt;&lt;else&gt;&gt;use your enormous weight to squash it into submission,
	&lt;&lt;/if&gt;&gt;
	until finally it shows signs of tiring out. With a struggle you manage to heave the large jello-like mass from the ground. After a few astonished quivers it subsides, apparently completely confused as to where it is. Thus subdued, you are able to stash it safely. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;getItem $blueSlimeItem&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You charge the large blue cuboid, 
	&lt;&lt;if setup.weight() &lt; 150&gt;&gt;scrabbling for purchase across its wide sides
	&lt;&lt;elseif setup.weight() &lt; 300&gt;&gt;colliding with a gelatinous &#39;&#39;SLAP&#39;&#39;
	&lt;&lt;else&gt;&gt;smacking into it so hard as to make it ripple
	&lt;&lt;/if&gt;&gt;, but it flings you off with a mighty quiver. 
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;	
&lt;&lt;/if&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="31" name="honey slime ai" tags="" position="5150,500" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a large chunk of amporphous honey that smells too sweet. Still, the $sunlight perforating through the slime makes your gurgle with possibly oncoming gastronomical onslaught - or feast! This slime seems reasonably slower than its counterparts in its rather sticky, honeyish form. As it trudges towards you, it actually leaves a viscous trail behind! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;if $grapple &lt;= 0&gt;&gt;
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Honey blast&lt;/li&gt;
			&lt;&lt;switch setup.dodge()&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					Shrinking for a mere instant, the slime several lumps of sweet honey towards you. As the slime&#39;s marksmanship is nothing to rival your maneuvers, several lumps of honey splash on the ground. 
					&lt;&lt;set _damage = random(4,6)&gt;&gt;
					&lt;&lt;eDamage _damage&gt;&gt;
					
				&lt;&lt;case false&gt;&gt;
					Shrinking for a mere instant, the slime several lumps of sweet honey towards you. In superb precision, the lumps seem to land right into your mouth. You are but to savor the &lt;&lt;print either(&quot;delicious&quot;, &quot;cloying&quot;)&gt;&gt; honey as orange, glistening lumps of deliciousness slowly fill your belly. 
					&lt;&lt;set _cram = random(4,6)&gt;&gt;
					&lt;&lt;set _calories = _cram * 0.8&gt;&gt;
					&lt;&lt;consume _cram _calories&gt;&gt;
					&lt;&lt;eDamage _cram&gt;&gt;
					
					&lt;&lt;set _buff = random(0,-2)&gt;&gt;
					&lt;&lt;if _buff != 0&gt;&gt;&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;&lt;&lt;/if&gt;&gt;
					&lt;&lt;set _buff = random(0,-2)&gt;&gt;
					&lt;&lt;if _buff != 0&gt;&gt;&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;&lt;&lt;/if&gt;&gt;
					&lt;&lt;set _buff = random(0,-2)&gt;&gt;
					&lt;&lt;if _buff != 0&gt;&gt;&lt;&lt;tempBuff &quot;end&quot; _buff&gt;&gt;&lt;&lt;/if&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Honey blast&lt;/li&gt;
			&lt;&lt;switch setup.dodge()&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					The slime seems to melt into the ground, only to launch several chunks of honey! As you duck beneath the airborne honey, all chunks splatter across the ground in a warm, orange glisten. Still, a driblet or two of honey splatters onto you do nothing more than whetting your appetite. Some drops to spice, or sweeten, things up! 
					&lt;&lt;eDamage 1&gt;&gt;
					
				&lt;&lt;case false&gt;&gt;
					The slime seems to melt into the ground, only to launch several chunks of honey! While some of the fragrant and tacky projectiles fall into ground in a dull glisten, a few finds their way onto you. Your motion seems restricted by the orange sweet on your $fatness body. However much you attempt, you cannot seem to liberate your $p.hands from the sweet. Moreover, the honey dripping on your tummy seems to elicit some growls from your midriff. 
					&lt;&lt;set _buff = random(-3,-5)&gt;&gt;
					&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;
					&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
					&lt;&lt;eDamage 1&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Grab&lt;/li&gt;
			&lt;&lt;switch setup.dodge()&gt;&gt;
				&lt;&lt;case true&gt;&gt;
					The slime jolts towards you as a cavity opens inside the slime. As you sidestep your fragrant foe, the blob collapses flat onto the ground. Instead of an ample gourmand like you, brushings seem to taste the delicious honey. What a waste! 
					
				&lt;&lt;case false&gt;&gt;
					The slime jolts towards you as a cavity opens inside the slime. The slime rapidly engulfs you into the cavity as a floating sensation takes the hold of you. Eventually, your head gets engulfed, just then you begin wriggling inside the amorphous blob. Trying to keep your eyes open, you behold the world in an amber tint as light slowly nullifies. Soon, your perception is overwhelmed by sweet deliciousness. 
					&lt;&lt;set _buff = random(-1,-2)&gt;&gt;
					&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
					&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Feed&lt;/li&gt;
	The delicious honey, all less viscous, seems to surge into your mouth as you gasp for air - and find more honey indeed! The treat is to be relished as you literally breathe the onslaught of rich and sweet honey. 
	&lt;&lt;set _cram = random(4,6)&gt;&gt;
	&lt;&lt;set _calories = _cram * 0.8&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
	&lt;&lt;eDamage _cram&gt;&gt;
	You feel $hungry. 
&lt;&lt;/if&gt;&gt;


&lt;&lt;if $agi &lt;= 0 or $str &lt;= 0 or $end &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You open your mouth wide and beckon the slime monster in. You don&#39;t even have to swallow as the slime forcefully pumps itself into you. You rub your $waist stomach as it stretches outward with sentient honey sweetness. 
&lt;&lt;set _cram = $e.hea&gt;&gt;
&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
&lt;&lt;consume _cram _calories&gt;&gt;
&lt;&lt;eDamage _cram&gt;&gt;

&lt;&lt;switch $alive&gt;&gt;
	&lt;&lt;case true&gt;&gt;
		You slurp up the last of the slime monster down. With nothing left to fight, I guess you can call this a victory? 
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;		
		
	&lt;&lt;case false&gt;&gt;
		&lt;&lt;if $options.popping&gt;&gt;
		&lt;p&gt;Your stomach keeps growing larger and larger, but there&#39;s still more honey slime to go. You hold onto your aching gut as honey goo pumps almost endlessly down your gullet. You slowly lower yourself down and sit on the ground as you feel your stomach stretch painfully bloated. You&#39;re not sure how much more you can take, but you&#39;re determined to win this gastronomical battle. If you can just hold out a little longer. You begin losing the test of will though as you collapse fully to the ground. The remainder of the slime monster rises menacingly and dives towards your mouth in a final onslaught. A wet GLOOORP resonates deep within your gut as the slime pushes into every available nook and cranny. Ultimately out of room, your belly lurches forward and bursts scattering globs of blue slime across the hillside. &lt;/p&gt;
		
		Each glob creeps off to grow into a new honey slime. The cycle continues...
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

		&lt;&lt;else&gt;&gt;		
		Your stomach keeps growing larger and larger, but there&#39;s still more honey slime to go. You hold onto your aching gut as honey goo pumps almost endlessly down your gullet. You slowly lower yourself down and sit on the ground as you feel your stomach stretch painfully bloated. You&#39;re not sure how much more you can take, but you&#39;re determined to win this gastronomical battle. If you can just hold out a little longer. You begin losing the test of will though as you become too painfully full to stay awake. You collapse on your back on the ground and pass out even as the rest of the slime monster slides down your throat. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
/*Slime is alive*/
&lt;&lt;if $e.hea &gt; 0&gt;&gt;
	As the sticky honey slime wrestles you down onto the ground, it begins spraying honey relentlessly into your mouth. You gasp, for a breath or two, while inhaling  the seemingly endless stream of honey. Eventually, a drowsy sugar rush takes you before a stuffed slumber. 
	&lt;&lt;set _calories = $e.hea * 0.8&gt;&gt;
	&lt;&lt;consume $e.hea _calories&gt;&gt;

	/*You&#39;re alive*/
	&lt;&lt;if $hea &gt; 0&gt;&gt;
		As you begin swallowing the large chunk of honey, a restful warmth begins spreading through your stomach. As your belly begins surging out, you soon become oblivious to the cloying sweetness of honey, absorbed into its soothing comfort and deliciousness. A minute? An hour? A day? You just seem to lose the track of time as your feast endures. Soon awaken from your feeding lethargy as you lick bland air instead of honey! &lt;&lt;print $hungry.toUpperFirst()&gt;&gt; and a bit sticky, you rise to continue your journey, with the honey still warm in your belly. 
		&lt;&lt;set $alive = true&gt;&gt;
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
	/*You&#39;re dead*/
	&lt;&lt;else&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

/*Slime is dead*/
&lt;&lt;else&gt;&gt;
	After lodging it&#39;s last attack, you look down to find the last of the honey slime dissipate into a pool of regular honey. 
	
	/*You&#39;re alive*/
	&lt;&lt;if $hea &gt; 0&gt;&gt;
		Apparently you won! 
		&lt;&lt;set $alive = true&gt;&gt;
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
		
	/*You&#39;re dead*/
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $options.popping&gt;&gt;
		Before you can feel too triumphant however, you stumble forward to the ground under the painful weight of your overdistended stomach, landing heavily on your belly. The sudden load put too much strain on your strained gut and you bust open at the seams with a wet GLOOOP! 
		&lt;br&gt;&lt;br&gt;
		You sink slowly into the viscous mass you previously contained as you mercifully drift to unconsciousness...
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

		&lt;&lt;else&gt;&gt;
		Before you can feel too triumphant however, you stumble to the ground under the painful weight of your overdistended stomach and pass out facedown in the pool of honey. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
After lodging it&#39;s last attack, you look down to find the last of the honey slime dissipate into a pool of regular honey. Apparently you won! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="32" name="meat monster ai" tags="" position="4900,500" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent appears to be a &lt;&lt;sayDistance 72&gt;&gt; tall semi-sentient animated golem made of several different types of cooked meat. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;

&lt;&lt;set _random = random(1,3)&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Feed&lt;/li&gt;
	The meat monster man takes advantage of your restrained state and grabs a hunk of himself and forcefully crams it down your throat. 
	&lt;&lt;set _cram = random(1,4)&gt;&gt;
	&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
	&lt;&lt;set $e.hea -= _cram&gt;&gt;
&lt;&lt;elseif _random == 1 and ($e.hea/$e.maxhea) &gt; .5&gt;&gt;
	&lt;li&gt;Grab&lt;/li&gt;
	&lt;&lt;switch setup.dodge()&gt;&gt;
		&lt;&lt;case false&gt;&gt;
		&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
		The meat monster man launches forward and wraps his meaty sausage arms around you. 
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
		
		&lt;&lt;case true&gt;&gt;
		The meat monster lunges at you, but you dodge out of the way before he can grab you. 
		
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;li&gt;Attack&lt;/li&gt;
	The meat monster rears back and decks you in the face with his sausagey fist. 
	&lt;&lt;doEdmg&gt;&gt;
	&lt;&lt;damage $edmg&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.hea &lt;= 0 and $alive&gt;&gt;
	And with that, there&#39;s nothing left of the meat man. He&#39;s managed to entirely feed his entire self into you. You stand up and brush yourself off and find yourself with nothing left to fight...? You shake your gut suspiciously, but there&#39;s seemingly no reaction from the monster inside. It appears you&#39;ve won? 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You manage to flee from your opponent. He lets out a meaty roar before slowly stalking you down, but you think you manage to lose him before too long. It appears you have escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
You relax in his greasy meaty embrace and eagerly chomp down on whatever he crams into you. 
&lt;&lt;else&gt;&gt;
You leap into his meaty grasp and look up at him, mouth agape. 
&lt;&lt;/if&gt;&gt;
You see a look of what might be perplexity, or possibly happiness cross his face. It&#39;s pretty hard to tell though. In either case, he begins tearing off hunks of steak/sausage/ham/bacon from himself. He hardly waits for you to swallow the previous mouthful before he crams the next one in, practically shoving meat into your stomach. As you consume more and more of him, his body shifts and reconstructs into a smaller and smaller meat golem. Eventually, as he senses you don&#39;t plan on struggling and he becomes too weak to hold you, he lowers you to the ground as he continues cramming himself into you. 
&lt;&lt;set _cram = $e.hea&gt;&gt;
&lt;&lt;set _calories = _cram * 0.5&gt;&gt;
&lt;&lt;consume _cram _calories&gt;&gt;

&lt;&lt;switch $alive&gt;&gt;
	&lt;&lt;case true&gt;&gt;
		You&#39;ve managed to devour most of him, leaving you with a $waist stomach. The meat monster has shrunken to only a foot tall stickman made out of a few sausages. You look over when you notice you aren&#39;t being fed anymore and find that what was once a meat monster is now just a pile of inanimate sausage. Whatever force animated him apparently can no longer function in such a small vessel. It looks like you&#39;ve &quot;Won&quot;. 
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
		
	&lt;&lt;case false&gt;&gt;
		&lt;&lt;if $options.popping&gt;&gt;
		Your stomach steadily bulges larger and larger as he stuffs you with unwavering dedication. You rub your taut stomach as you force yourself to swallow another mouthful and you can feel your belly grow slightly. You start to wonder how much more you can take, but you don&#39;t want to stop him, and he probably doesn&#39;t even know how to stop. Your musing is interrupted as another handful is crammed into your mouth. Eventually you are little more than a meat balloon, quivering at the edge of ruin. 
		&lt;&lt;stuffToBursting&gt;&gt;
		A final sausage is forced down your throat. Much like a sausage casing that’s been overfilled, you split open, showering the hillside with chunks of meat.
		&lt;hr&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
		
		&lt;&lt;else&gt;&gt;
		Your stomach steadily bulges larger and larger as he stuffs you with unwavering dedication. You rub your taut stomach as you force yourself to swallow another mouthful and you can feel your belly grow slightly. You start to wonder how much more you can take, but you don&#39;t want to stop him, and he probably doesn&#39;t even know how to stop. You start to drift off into a glutted stupor, but every few seconds you&#39;re jolted awake as another handful is crammed into your mouth and your gut slowly stretches. Eventually you&#39;re just too stuffed to stay awake and you fall asleep to the rhytmic sensation of your stomach continuing to bulge out larger and larger....
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		
&lt;&lt;/switch&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
You&#39;re so stuffed you find it almost impossible to struggle against your captor. He grabs the end of a sausage rope and begins to cram it link after link down your throat. Every sausage causes your stomach to swell, but as the final link disappears into your mouth, you feel something split deep inside. Your belly suddenly surges outwards, and you burst in a shower of meat chunks. 
&lt;hr&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
You&#39;re so stuffed you find it almost impossible to struggle against your captor. Your vision fades to black as you see the meat monster cram a particularly large hunk of meat down your throat. 
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;	
&lt;&lt;/if&gt;&gt;


&lt;&lt;else&gt;&gt;
Your vision fades to black as you fall unconscious. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;	

&lt;&lt;/if&gt;&gt;



/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your final attack causes what remains of the meat monster man to fall to the ground, apparently becoming nothing more than a pile of regular meat... it seems.... 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;if $feeder_itemFed.flavors != null and $feeder_itemFed.flavors.includes(&quot;meat&quot;)&gt;&gt;
		You try cramming your $feeder_itemFed.name into what could best be interpreted as the golem&#39;s mouth. The moment the $feeder_itemFed.name makes contact it suddenly begins twitching and moving, fusing into the masses of meat that already make up the meaty creature.
		&lt;&lt;eHealth $feeder_fedAmount&gt;&gt;
		Oops?
		&lt;&lt;removeItem $feeder_itemFed&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You pull out $feeder_itemFed.article $feeder_itemFed.name, but then pause as you look the animated pile of meat up and down. It doesn&#39;t really have a mouth to stuff food into, nor any sign of a stomach to fill up - well, you think you notice some tripe amidst the variety of meats that make up the golem, but that&#39;s besides the point. You decide to put the $feeder_itemFed.name away.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="33" name="milk machine ai" tags="" position="4775,500" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a large, steam-powered, wheeled, brass amalgamation of flailing mechanical arms and hoses surrounding a massive cylindrical storage tank. The mechanical hoses are each tipped with a rubber suction cup-like tip that occasional spurts out milk. This mechanical monster has found a new container to store its harvest in. (Hint: it&#39;s you.) 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Pump&lt;/li&gt;
	The mechanical hose crammed in your mouth starts forcefully pumping large quantities of warm milk down your throat. You can&#39;t help but swallow as the rubber suction cup completely fills your mouth. All this warm milk bloating your stomach is starting to make you feel very very drowsy. 
	&lt;&lt;tempBuff &quot;str&quot; -2&gt;&gt;
	&lt;&lt;tempBuff &quot;agi&quot; -2&gt;&gt;
	&lt;&lt;tempBuff &quot;end&quot; -2&gt;&gt;
	&lt;&lt;tempBuff &quot;int&quot; -2&gt;&gt;
	&lt;&lt;set _stuff = random(3,7)&gt;&gt;
	&lt;&lt;set _calories = _stuff * 0.5&gt;&gt;
	&lt;&lt;consume _stuff _calories&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;li&gt;Grab&lt;/li&gt;
	One of the mechanical arms attempts to sweep you off of your feet. 
	&lt;&lt;switch setup.dodge()&gt;&gt;
		&lt;&lt;case true&gt;&gt;
		Luckily, you&#39;re &lt;&lt;if $int &gt; $agi&gt;&gt;smart&lt;&lt;else&gt;&gt;fast&lt;&lt;/if&gt;&gt; enough that you manage to keep your footing. 
			
		&lt;&lt;default&gt;&gt;
		Unfortunately, you&#39;re not &lt;&lt;if $int &gt; $agi&gt;&gt;smart&lt;&lt;else&gt;&gt;fast&lt;&lt;/if&gt;&gt; enough to keep your footing and your knocked to the ground and left dazed. The mechanical monstrosity pinches your head in one of it&#39;s claws as one of it&#39;s hoses coils around your chest before cramming it&#39;s rubber suction cup into your mouth. 
		&lt;&lt;set $grapple = $e.str * 2.5&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $str &lt;= 0 or $agi &lt;= 0 or $int &lt;= 0 or $end &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn to flee from the mechanical monstrosity and manage to outrun it as it slowly trundles after you, spitting out steam and angrily flailing its arms all the while. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;You forego struggling against your enemy and relax in its metallic embrace. 
&lt;&lt;else&gt;&gt;You forego fighting your enemy and allow it to snatch you up in its metallic grasp. &lt;&lt;/if&gt;&gt;

&lt;&lt;if $options.popping&gt;&gt;
A particularly large hose crams itself into your jaws as it starts gushing warm milk down your throat quarts at a time. Your stomach rapidly swells as it&#39;s pumped full of warm creamy milk, filling you up like a water balloon.
&lt;br&gt;&lt;br&gt;

You quickly begin to feel drowsy as the warmth of the milk spreads through your body, sapping your will to resist. As your stomach grows larger and heavier, you watch a dial on the side of the large storage tank slowly drift from &quot;F&quot; towards &quot;E&quot;. The dial is nearly on empty when a deep gurgling rises from your bloated belly. 
&lt;&lt;stuffToBursting&gt;&gt;
Your turgid gut gives out one final groan, then bursts with a wet BLOOOSH!. 
&lt;br&gt;&lt;br&gt;

The milk machine’s simple programming can’t process what just happened. The contraption trundles off in search of more milk. And a new container...
&lt;hr&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
A particularly large hose crams itself into your jaws as it starts gushing warm milk down your throat quarts at a time. Your stomach rapidly swells as it&#39;s pumped full of warm creamy milk, filling you up like a water balloon. 
&lt;&lt;stuffToBursting&gt;&gt;

You quickly begin to feel drowsy as the warmth of the milk spreads through your body, making you feel incredibly tired. You drift off to sleep as you watch a dial on the side of the large storage tank slowly drift from &quot;F&quot; to &quot;E&quot; as your stomach grows larger and heavier. 
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;



/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
Your stomach groans and gurgles as it swells to its limit with warm creamy milk. You find it harder and harder to remain conscious as your stomach painfully swells before your eyes like an overinflated balloon. Your waist slowly pulses larger and larger with each jet of milk sprayed down your throat. 
&lt;&lt;stuffToBursting&gt;&gt;
After a few minutes of pumping, you notice your belly has ceased growing with each blast, instead getting tighter, and tighter until you finally burst with a wet BLOOOSH! 
&lt;br&gt;&lt;br&gt;

The milk machine’s simple programming can’t process what just happened. The contraption trundles off in search of a new container...

&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
Your stomach groans and gurgles as it swells to its limit with warm creamy milk. You find it harder and harder to remain concious as your stomach painfully swells before your eyes like an overinflated balloon. Eventually you drift into unconsciousness as your waist slowly pulses larger and larger with each jet of milk sprayed down your throat. 

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;else&gt;&gt;
You find it harder and harder to stay awake as the warm relaxing milk fills up your stomach. You attempt to yawn between the repeated jets of milk spraying down the back of your throat. Eventually your eyes drift close as your stomach continues to inflate with milk. 
&lt;hr&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;



/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The large machine squeals and hisses as its mechanical arms flail about until, with a final crunching, grinding, exploding noise, it falls still. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;if $feeder_itemFed.flavors != null and $feeder_itemFed.flavors.includes(&quot;milk&quot;)&gt;&gt;
		You pull out a $feeder_itemFed.name and hold it out towards the machine. The mechanical monstrosity freezes for a moment, processing the sudden appearance of a new milk source. It extends a snaking hose into the $feeder_itemFed.name and drains it dry.
		&lt;&lt;feeder_tryRemoveFedItem&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You pull out $feeder_itemFed.article $feeder_itemFed.name, only to realise there isn&#39;t really any way to //feed// a hulking mechanical monstrosity. Does a tank count as a stomach? Shaking your head, you put the $feeder_itemFed.name back into your pack.
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="34" name="anaconda boss ai" tags="" position="5400,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This $npc1.species is a bit different from other jungle snakes, bearing strikingly colored patterns, numerous scars on its head and torso, and the fact that it&#39;s longer than you can readily see and its gigantic body rises up as big as the buildings in the city when flat along the ground. It&#39;s encircled you and is preparing to make you into a light lunch. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;

&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;&lt;if $hea &gt; $maxHea * 0.6 and !$e.special&gt;&gt;
		&lt;li&gt;Squeeze&lt;/li&gt;
		The snake squeezes at you with incredible strength, like being crushed by a mountain. 
		&lt;&lt;set $edmg *= 1.1&gt;&gt;
		&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;if $hea &lt;= $maxHea * 0.6&gt;&gt;
			Deciding that you&#39;ve weakened enough, the snake opens its jaws and engulfs you from the head down. Everything goes dark as you find yourself in the long belly of the beast! 
			&lt;&lt;set $e.special = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;Squeeze&lt;/li&gt;
		The walls of the snake&#39;s long stomach squeezes down around you! 
		&lt;&lt;set $edmg *= 1.3&gt;&gt;
		&lt;&lt;damage $edmg&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;&lt;if random(1,3) == 3&gt;&gt;
				&lt;li&gt;Earthquake&lt;/li&gt;
				The giant snake suddenly rears up high, then comes crashing back to the ground. The earth shakes violently beneath your feet, knocking you to the ground! 
				&lt;&lt;set $edmg *= 1.5&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;if random(1,100) &lt; 40&gt;&gt;
					&lt;&lt;tempBuff &quot;stun&quot; 2&gt;&gt;
					You are disoriented by the intense shaking! 
				&lt;&lt;/if&gt;&gt;
				
			&lt;&lt;else&gt;&gt;
				&lt;li&gt;Timber&lt;/li&gt;
				&lt;&lt;if setup.dodge()&gt;&gt;
					The enormous snake&#39;s entire body writhes, causing trees to collapse around you. You are able to avoid being hit by them through equal parts speed and luck. 
					
				&lt;&lt;else&gt;&gt;
					The enormous snake&#39;s entire body writhes, and the trees all around you begin to collapse. You are caught under several that fall upon you. 
					&lt;&lt;set $edmg *= 1.3&gt;&gt;
					&lt;&lt;damage $edmg&gt;&gt;
						
				&lt;&lt;/if&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Acid spray&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The giant serpent rears back and opens its mouth, suddenly spraying out foul-smelling bile, but you manage to put some trees between you and it and stay unmelted. 
				
			&lt;&lt;else&gt;&gt;
				The giant serpent rears back and opens its mouth, suddenly spraying out foul-smelling bile all over you! 
				&lt;&lt;set $edmg *= 1.3&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
					
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Grab&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The giant snake constricts its thick and muscular torso, but you leap well clear of it before it can grab you. 
				
			&lt;&lt;else&gt;&gt;
				The giant snake constricts its thick and muscular torso, clamping down tight around you as it tries to crush you into submission! 
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
	
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
Something snaps inside your mind, and you decide that this seemingly endlessly long, tremendously thick-bodied beast would be just perfect for a snack. You give its head a solid bashing, dazing it for a moment while you set about the task of finding a part small enough to start eating it. Fortune smiles on your insane endeavor, and you chance upon the very tail end of the creature. Without a moment&#39;s hesitation, you shove it into your mouth, bite down, and begin to suck it down your throat. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Once you&#39;ve started, you simply can&#39;t bring yourself to stop. Even as the tail thickens out to the creature&#39;s full girth, you keep gulping it down, swallow after swallow of a creature large enough to eat an entire house in one gulp slides down your massively stretched throat and into your rapidly ballooning belly. It curls up in a ball inside you, writhing and slithering over itself in a futile attempt to escape your hunger, but it simply cannot. Your belly grows tremendous with the body of the centuries-old predator, and it just doesn&#39;t seem to stop. But you don&#39;t even mind. The immense filling is just what you wanted, and when it finally ends, the hissing serpent&#39;s head passing down your throat, the intense fullness has long since become nothing but pleasant, your massive belly serving as a gigantic monument to your bottomless gluttony. You can&#39;t even reach around it, but you rub what you can of it, relishing this moment. After a few minutes, you remember that there was a reason you came out here, and go into the beast&#39;s layer, recovering a chunk of White Gold. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;advanceQuest $spearQuest&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You manage to suck down a few hundred feet of it before a part of you starts to wonder if this was a bad idea. A few dozen more, and reality suddenly crashes down upon you, the immense stretching of your belly suddenly agonizing and disabling. You stop dead in your tracks, slack-jawed around the body of the biggest creature you have ever encountered and unable to do anything at all as it slithers back out of you. It brings its head around to look at you, and you think you see respect in its eyes before it turns away, slithering off to leave you there on the ground. You attempted something that, in hindsight, you should have known was impossible, but what the heck? It was worth a try. You tell yourself this as you lose consciousness, and it doesn&#39;t seem so bad. 
	&lt;hr&gt;
	&lt;defeated &quot;battle&quot;&gt;&gt;
	
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
&lt;&lt;if $e.special&gt;&gt;
You wriggle and writhe, forcing yourself against the slippery snake&#39;s insides and are ejected out of the snake&#39;s mouth! 
&lt;&lt;set $e.special = false&gt;&gt;
&lt;&lt;else&gt;&gt;
You pry at the snake&#39;s tremendous body and just manage to wriggle out of its grip! 
&lt;&lt;/if&gt;&gt;

&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
&lt;&lt;if $e.special&gt;&gt;
	You struggle and strain, but can&#39;t manage to free yourself from the snake&#39;s squeezing stomach! 
&lt;&lt;else&gt;&gt;
	You pry at the snake&#39;s tremendous body, but can&#39;t manage to loosen it! 
&lt;&lt;/if&gt;&gt;
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to get away, but as far as you go, you only find more giant snake barring your path! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to get away, but as far as you go, you only find more giant snake barring your path! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You stop your struggles, unwilling to fight this gigantic creature any more. The enormous creature crushes you with its body, and you swiftly lose consciousness as your strength is squeezed out of you. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The intense battering the enormous $npc1.species has delivered to you proves to be too much, and your body goes limp, unresponsive to your commands. You are just another tiny meal to the giant snake, but are fortunate enough to lose consciousness before things can get any worse. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Letting out a hissing roar, the enormous snake rears up, then collapses to the ground, still. You celebrate your victory for a moment, then search the hole it emerged from. Sure enough, the White Gold that you were sent to find is in there, and in great quantities. You grab a hunk of it and pull it free, taking it with you. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;advanceQuest $spearQuest&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="35" name="dinosaur rider ai" tags="" position="5275,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
&lt;&lt;if $e.hea/$e.maxhea &lt;= 0.7&gt;&gt;
	The tyrannosaurus rider has been knocked unconcious by your attacks, but that&#39;s not stopping the tyrannosaurus from continuing its last orders to stomp you into the ground! 
&lt;&lt;else&gt;&gt;
	You are up against a tyrannosaurus being ridden by $npc1.article $npc1.species. The tyrannosaurus is moving to squash you flat, and the $npc1.species has a bundle of javelins that $npc1.he&#39;s obviously just itching to introduce you to. 
&lt;&lt;/if&gt;&gt;



/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if random(1,3) == 3 and $e.hea/$e.maxhea &gt; 0.7&gt;&gt;
	&lt;li&gt;Javelin Toss&lt;/li&gt;
	&lt;&lt;if setup.dodge() and setup.dodge()&gt;&gt;
		The tyrannosaurus postures at you, but you manage to keep sight of the rider and evade the javelin $npc1.he throws at you. 
		
	&lt;&lt;else&gt;&gt;
		The tyrannosaurus postures at you, distracting you just long enough for the rider to nail you with a javelin! 
		&lt;&lt;damage $edmg&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;	
&lt;&lt;else&gt;&gt;
	&lt;&lt;if random(1,2) == 1&gt;&gt;
		&lt;li&gt;Tail Whack&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The tyrannosaurus lets out a grunt and whips around, but you dodge with it, and its tail harmlessly swipes through the air where you once were. 
			
		&lt;&lt;else&gt;&gt;
			The tyrannosaurus lets out a grunt, its body whipping around, sending its massive tail crashing into you! 
			&lt;&lt;set $edmg *= 1.3&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;Stomp&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			With a growl, the tyrannosaurus lifts up a foot, but you manage to narrowly avoid getting stomped as the ground shudders from the impact. 
			
		&lt;&lt;else&gt;&gt;
			With a growl, the tyrannosaurus lifts up a foot and brings it down on top of you with earth-shaking force! 
			&lt;&lt;set $edmg *= 1.3&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
&lt;&lt;if $e.hea/$e.maxhea &gt; 0.7&gt;&gt;
	You manage to cause the tyrannosaurus to lose its balance for a moment with a sudden attack to its leg, sending the $npc1.species plummetting off its back and to the ground, where you are more than ready to meet $npc1.him. As $npc1.he tries to collect $npc1.his senses, you dive on top of $npc1.him, eliciting a surprised grunt from $npc1.him as you pull $npc1.his head into your maw and rapidly devour $npc1.him. Quickly shoving the $npc1.species down your throat, you flip $npc1.him into the air, sending $npc1.him on a gravity-assisted trip to your $waist belly. 
	&lt;&lt;set _eat = $e.weight + $npc1.speciesStats[5] * 5&gt;&gt;
	&lt;&lt;consume  _eat&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		Gulping feverishly, you force $npc1.him into a ball in your stomach as $npc1.his fat body gives you a fair filling. You barely have time to enjoy it, however, as the massive tyrannosaurus is still right on top of you! 
		&lt;&lt;set $e.hea = $e.maxhea * 0.7&gt;&gt;
		&lt;&lt;set $cal += _eat * 0.6&gt;&gt;
		&lt;&lt;set $e.weight = 6000&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		Your rapid eating proves to be foolhardy, though, as the $npc1.species squirms about inside your pained, overfilled belly, proving to be just a bit too much for you. Unable to stop $npc1.him from sliding down into your stomach, you are quickly confronted with immense pain and forced to a seat. The $npc1.species looks on confused for a few moments, then turns to stomp away, leaving you alone to rub at your belly in a futile attempt to stop it from hurting. Soon, the pressure and pain in your belly cause you to lose consciousness. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You look at the enormous tyrannosaurus and find yourself thinking of very little aside from what an excellent meal it would make. Giving in to what can only be called complete madness, you give the creature a strike to the leg, causing it to let out a roar as it topples over. Before it can right itself, you are already at its thick tail and shoving it in your hungering maw. Somewhere inside your mind, the tiny voice of sanity reminds you that this is completely crazy, but you&#39;re too hungry to care, and your powerful throat is already sucking down dinosaur tail. Letting out a confused grunt, the tyrannosaurus turns on the ground to face you, its face clearly displaying its complete shock. Down your throat it goes, and you refuse to stop until you physically can&#39;t go on. 
	&lt;&lt;consume $e.weight 0&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		Tail gives way to massive rump, and massive rump gives way to enormous torso flanked by enormous legs. Your hunger is endless and your belly is bottomless, and you know it full well when you swallow up this massive beast. Its upper half writhes, unable to free itself from your inescapable vacuum of a gullet. By the time you&#39;ve reached its chest, it is letting out terrified roars, and when you swallow down its throat and head, it has given up and gone silent. With a few more swallows, the creature is nothing but a massive bulge in your $waist belly. Leaning forward onto it, you give it a loving stroke, feeling immensely satisfied with yourself. 
		&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
		&lt;&lt;set $cal += _calories&gt;&gt;
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		It takes approximately seven seconds for your sanity to kick back in, but that&#39;s just long enough for the massive beast&#39;s tail to reach your stomach. It wriggles around a bit, stretches you far fuller than any $p.species was meant to be, and your body simply shuts off, going limp as you loosely slide back off of the tyrannosaurus. Completely confused by what just happened, the tyrannosaurus slowly gets back to its feet and wanders off, seemingly trying to forget this ever happened. You, meanwhile, lie on the ground for a little while. It hurt an unbelievable amount, and your body didn&#39;t have any of it, but for a brief moment, you were in bliss. The same part of you that made you want to eat that thing in the first place urges you to try again some day. The rest of you tells you that it&#39;s time to take a nap. You concur. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;battle&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You decide that it&#39;s time to leave, and flee as quickly as you can into the jungle. The sound of thundering footfalls and crashing trees eventually fades as you go far and fast in the direction of Anywhere Else. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower yourself to the ground in submission, not wanting to fight anymore. The $npc1.species calls out a command, and the tyrannosaurus gives you one last stomping for good measure. You are driven hard into the ground and every part of you hurts as the world spins around you. You can feel a shuffling, and can just make out that the $npc1.species has attached some kind of harness to you, and soon you are dragged off, pulled by the enormous tyrannosaurus to destinations unknown. Eventually, you are placed before a robed shaman. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 600&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 1000&gt;&gt;Half a dozen reptillian bystanders haul you haphazardly onto an altar. 
&lt;&lt;else&gt;&gt;What feels like an entire village of reptillian bystanders struggle to haul your massive body onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The last attack causes you to stagger and drop to the ground, barely capable of holding yourself upright anymore. As you look up, you see the tyrannosaurus&#39;s foot coming down on top of you again, and you are smashed into the ground. The earth shakes around you as the tyrannosaurus stomps away, leaving every part of you in immense pain. You figure that this is as good a time for a nap as any, and slip into unconsciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The tyrannosaurus staggers, letting out a pained roar from your last attack, and crashes to the ground with an earth-shaking thud. You take some time to revel in your victory before continuing on through the jungle. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="36" name="fat jaguar ai" tags="" position="4900,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This husky, &lt;&lt;if $npc1.nspecies == &quot;jaguar&quot;&gt;&gt;spotted &lt;&lt;/if&gt;&gt;$npc1.species appears to have been quite successful in its recent hunts, sporting a thick body and an impressively fat gut. Now it looks like it wants to add you to its list of accomplishments. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			The $npc1.species opens its mouth surprisingly wide, engulfing your head in its maw. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 1&gt;&gt;
			Biting down on you, it pulls at you, forcing you deeper into its surprisingly flexible throat and down towards its stomach. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 0&gt;&gt;
			Scooping you up in its jaws, it swallows you down bit by bit, eventually making you an oversized lump in its gigantic stomach. You can hear it rumble as it lays down, overburdened by the meal it&#39;s made of you and taking a rest. Between your injuries and its stomach squeezing at you, you slip into unconsciousness. 
			&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if random(1,3) == 3 and $hea/$maxHea &lt;= 0.25&gt;&gt;
		&lt;li&gt;Pounce&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The $npc1.species jumps at you, but you narrowly avoid it. 
		&lt;&lt;else&gt;&gt;
			The $npc1.species jumps on you, knocking you to the ground under it. It&#39;s going to eat you! 
			&lt;&lt;set $grapple = $e.agi * 3&gt;&gt;
			&lt;&lt;set $e.special =  2&gt;&gt;			
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;	
		&lt;&lt;if random(1,2) == 1&gt;&gt;
			&lt;li&gt;Maul&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The large $npc1.adjective swipes at you with its claws, but you jump back to avoid it. 
			&lt;&lt;else&gt;&gt;
				The large $npc1.adjective swipes you with its claws, giving you a lovely matching set of scratches! 
				&lt;&lt;damage $edmg&gt;&gt;				
			&lt;&lt;/if&gt;&gt;			
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Bite&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species lunges at you, its jaws snapping, but you keep it from biting you with some deft maneuvering. 
			&lt;&lt;else&gt;&gt;
				The $npc1.species lunges at you and crunches into you with its powerful jaws! 
				&lt;&lt;set $edmg *= 1.2&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;				
			&lt;&lt;/if&gt;&gt;
												
		&lt;&lt;/if&gt;&gt;		
	&lt;&lt;/if&gt;&gt;							
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You decide to make the $npc1.species your meal, and clamp down on its face with your $p.hand, keeping its dangerous maw shut. It swipes a clawed paw at you, but you grasp it, pinning it to its side as you shove its face into your mouth. Muffled growls emanate from your throat as you pull at the big $npc1.adjective, its hind legs flailing as you pin its front legs together. Your jaw unhinging, you shove the $npc1.species roughly down your throat, ravenously forcing it down to inevitably fill your belly. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Pulling and swallowing again and again, the $npc1.species&#39;s big belly soon squishes against your maw, the entirety of its front half squeezed into your throat. Grasping its rump, you pull hard, your throat stretching wider around the bulbous stomach. Pinning its legs, you lift it upwards, using gravity as an aid to slurp down its hind quarters, legs, and tail. With a few more swallows, the predator has become your prey, and your belly has become $waist for it. You give it a pat and a rub, and move on. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You swallow it down as best you can, your stomach already groaning even before you&#39;ve gotten to its oversized midsection. Unwilling and unable to stop now, you pull the creature into your maw, forcing its bulbous stomach to slip down your throat. Swallowing again and again, your stomach grows taut, the immense fullness quickly growing painful. As the beast&#39;s hind quarters slip into your belly, you lower yourself to a seat, rubbing your $waist stomach gently and letting out a groan. Knowing full well that it was too much, you lay back and slowly drift into unconsciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
With a solid shove, you force the $npc1.species off of you, escaping being the big $npc1.adjective&#39;s next meal! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You try to shove it off of you, but it&#39;s too determined for you to move! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You get away from the $npc1.species and run through the trees to put some distance between the two of you. Ill suited for chasing, the $npc1.species only follows you for a short ways before stopping to skulk in the shadows again. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You decide to stop fighting and lower yourself to the ground in submission. The $npc1.species seizes the opportunity, and opens its mouth surprisingly wide, engulfing your head in its maw. Biting down on you, it pulls at you, forcing you deeper into its surprisingly flexible throat and down towards its stomach. Scooping you up in its jaws, it swallows you down bit by bit, eventually making you an oversized lump in its gigantic stomach. You can hear it rumble as it lays down, overburdened by the meal it&#39;s made of you and taking a rest. Between your injuries and its stomach squeezing at you, you slip into unconsciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The $npc1.species&#39;s last attack proves too much for you, and you collapse in a heap. Unable to fight back, you can only watch as the $npc1.species opens its mouth surprisingly wide, engulfing your head in its maw. Biting down on you, it pulls at you, forcing you deeper into its surprisingly flexible throat and down towards its stomach. Scooping you up in its jaws, it swallows you down bit by bit, eventually making you an oversized lump in its gigantic stomach. You can hear it rumble as it lays down, overburdened by the meal it&#39;s made of you and taking a rest. Between your injuries and its stomach squeezing at you, you slip into unconsciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With a groaning growl, the $npc1.species staggers for a moment, then flops onto its side, chest gently heaving with deep, pained breaths. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;jungle randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="37" name="glutton seperatist ai" tags="" position="5025,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This fat-bellied $npc1.species is wearing segmented armor marked with the sigil of the Glutton Separatists of the island and wielding a metal spear decorated with feathers near its tip, which is currently pointing in your direction. Looks like $npc1.he has some nasty ideas in mind for what he wants to do with you. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Jab&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			$npc1.He jabs at you with $npc1.his spear, but you deftly evade.
			
		&lt;&lt;else&gt;&gt;
			$npc1.He jabs at you with $npc1.his spear, catching you with the pointed tip! 
			&lt;&lt;set $edmg *= 1.2&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Stick Beat&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			$npc1.He suddenly swipes $npc1.his spear at you, intending to bash you with the shaft, but you carefully duck out of the way. 
			
		&lt;&lt;else&gt;&gt;
			$npc1.He suddenly swipes $npc1.his spear at you, the shaft of it making a solid thwack as it slaps hard into you! 
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 3&gt;&gt;
		&lt;li&gt;Body Slam&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			Suddenly the fat $npc1.species rushes at you and jumps into the air, but you keep well clear as $npc1.he crashes down onto the ground! $npc1.He slowly gets back up to face you again, clearly worse for wear after that. 
			&lt;&lt;if random(1,100) &lt; 33&gt;&gt;
				Looks like $npc1.he is a bit dizzy, to boot. 
				&lt;&lt;eBuff &quot;stun&quot; 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;else&gt;&gt;
			Suddenly the fat $npc1.species rushes at you and jumps into the air, $npc1.his weight crashing down on you as you are both sent sprawling! 
			&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;if random(1,100) &lt; 33&gt;&gt;
				The impact makes your head spin! 
				&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You tackle the $npc1.species to the ground, a flick of your $p.hand knocking $npc1.his spear away to roll off into the jungle. You lick your chops hungrily as $npc1.he starts yelling complaints in a language you don&#39;t understand below your $fatness body. The complaints soon become muffled cries as you shove $npc1.his head into your gaping maw. Pulling at the leather straps on the sides of $npc1.his armor, you peel it off, revealing $npc1.his rotund midsection. Clearly the separatists take their beliefs quite seriously, as $npc1.he has obviously been quite the glutton. Pinning $npc1.his arms to the side, you pull hard, swallowing as you do to force $npc1.him on a one-way trip to your belly. 
&lt;&lt;set _eat = $e.weight + $npc1.speciesStats[5] * 5&gt;&gt;
&lt;&lt;consume  _eat&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Slurping and gulping, you feel your throat stretch around the struggling $npc1.species, $npc1.his body writhing inside you as your mouth stretches wide, jaw unhinged to accomodate $npc1.his thick, fatty torso. It gently squishes around your mouth before sliding into your throat, and with a few more swallows, your belly begins to stretch and shudder, filling with the pudgy $npc1.species. With a few more gulps, $npc1.his hips have passed into your gullet and you are slurping up $npc1.his legs and tail. You pick yourself up and dust yourself off as the $npc1.species is forced into a gently-struggling wad in your $waist belly, giving it a good pat and a hum. When your belly grows still, you set off, $hungry and ready to move on. 
	&lt;&lt;set $cal += _eat * .6&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	Slowly, you gulp down the $npc1.species, feeling your throat stretch around $npc1.his writhing body. As you approach $npc1.his fatty midsection, you already know that you&#39;ve overstepped your limits, but it&#39;s too late to stop now. Unable to do anything but keep swallowing and rub at your achingly-full belly, $npc1.his hips soon pass into your gullet and $npc1.his legs and tail dangle from your mouth. Swallowing hard, you slurp down the last of $npc1.him, resting on your $waist belly and rubbing it as it shakes and buckles, the $npc1.species still struggling inside you. Letting out a groan, you find yourself unable to do anything but pant for breath and rub your overstuffed belly, and soon, the painful pressure causes you to lose consciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You turn tail and flee, not wanting to be stuck in this fight anymore. The $npc1.species chases you for a short ways, yelling tauntingly in a language you don&#39;t understand, but only just far enough to see that you&#39;re well and truly gone. You escape with no further injury but to your ego. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower yourself to the ground, submitting before your opponent. $npc1.He grumbles angrily and bashes the back of your head with the butt of $npc1.his spear, sending you sprawling to the ground and the world spinning. 
&lt;&lt;set _damage = $maxHea * 0.25&gt;&gt;
&lt;&lt;if _damage &gt;= $hea&gt;&gt;&lt;&lt;set _damage = $hea - 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;damage _damage&gt;&gt;
You are dragged off, eventually placed before a robed shaman. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;else&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The $npc1.species&#39;s last attack sends you to the ground hard, and try as you might, you can&#39;t pick yourself back up. The painful beating causes you to lose consciousness, with the last thing you feel being a sense of being dragged somewhere. When you awaken later, you are somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your last attack sends the $npc1.species flopping onto $npc1.his side groaning in pain. Looks like you showed $npc1.him whatfor. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false &quot;jungle randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="38" name="glutton seperatist boss ai" tags="" position="5150,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This fat-bellied $npc1.species is wearing segmented armor marked with the sigil of the Glutton Separatists of the island and wielding a metal spear decorated with feathers near its tip, which is currently pointing in your direction as you have just intruded on $npc1.his territory with malicious intent. Judging by the snarl on $npc1.his face, you feel pretty certain that the malice is mutual. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Jab&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			$npc1.He jabs at you with $npc1.his spear, but you deftly evade.
			
		&lt;&lt;else&gt;&gt;
			$npc1.He jabs at you with $npc1.his spear, catching you with the pointed tip! 
			&lt;&lt;set $edmg *= 1.2&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Stick Beat&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			$npc1.He suddenly swipes $npc1.his spear at you, intending to bash you with the shaft, but you carefully duck out of the way. 
			
		&lt;&lt;else&gt;&gt;
			$npc1.He suddenly swipes $npc1.his spear at you, the shaft of it making a solid thwack as it slaps hard into you! 
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 3&gt;&gt;
		&lt;li&gt;Body Slam&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			Suddenly the fat $npc1.species rushes at you and jumps into the air, but you keep well clear as $npc1.he crashes down onto the ground! $npc1.He slowly gets back up to face you again, clearly worse for wear after that. 
			&lt;&lt;if random(1,100) &lt; 33&gt;&gt;
				Looks like $npc1.he is a bit dizzy, to boot. 
				&lt;&lt;eBuff &quot;stun&quot; 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;else&gt;&gt;
			Suddenly the fat $npc1.species rushes at you and jumps into the air, $npc1.his weight crashing down on you as you are both sent sprawling! 
			&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;if random(1,100) &lt; 33&gt;&gt;
				The impact makes your head spin! 
				&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You tackle the $npc1.species to the ground, a flick of your $p.hand knocking $npc1.his spear away to roll off into the jungle. You lick your chops hungrily as $npc1.he starts yelling complaints in a language you don&#39;t understand below your $fatness body. The complaints soon become muffled cries as you shove $npc1.his head into your gaping maw. Pulling at the leather straps on the sides of $npc1.his armor, you peel it off, revealing $npc1.his rotund midsection. Clearly the separatists take their beliefs quite seriously, as $npc1.he has obviously been quite the glutton. Pinning $npc1.his arms to the side, you pull hard, swallowing as you do to force $npc1.him on a one-way trip to your belly. 
&lt;&lt;set _eat = $e.weight + $npc1.speciesStats[5] * 5&gt;&gt;
&lt;&lt;consume  _eat&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Slurping and gulping, you feel your throat stretch around the struggling $npc1.species, $npc1.his body writhing inside you as your mouth stretches wide, jaw unhinged to accomodate $npc1.his thick, fatty torso. It gently squishes around your mouth before sliding into your throat, and with a few more swallows, your belly begins to stretch and shudder, filling with the pudgy $npc1.species. With a few more gulps, $npc1.his hips have passed into your gullet and you are slurping up $npc1.his legs and tail. You pick yourself up and dust yourself off as the $npc1.species is forced into a gently-struggling wad in your $waist belly, giving it a good pat and a hum. When your belly grows still, you set off, $hungry and ready to move on. 
	&lt;&lt;set $cal += _eat * .6&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter the cultist village&quot; &quot;Got inside cultist village&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	Slowly, you gulp down the $npc1.species, feeling your throat stretch around $npc1.his writhing body. As you approach $npc1.his fatty midsection, you already know that you&#39;ve overstepped your limits, but it&#39;s too late to stop now. Unable to do anything but keep swallowing and rub at your achingly-full belly, $npc1.his hips soon pass into your gullet and $npc1.his legs and tail dangle from your mouth. Swallowing hard, you slurp down the last of $npc1.him, resting on your $waist belly and rubbing it as it shakes and buckles, the $npc1.species still struggling inside you. Letting out a groan, you find yourself unable to do anything but pant for breath and rub your overstuffed belly, and soon, the painful pressure causes you to lose consciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower yourself to the ground, submitting before your opponent. $npc1.He grumbles angrily and bashes the back of your head with the butt of $npc1.his spear, sending you sprawling to the ground and the world spinning. 
&lt;&lt;set _damage = $maxHea * 0.25&gt;&gt;
&lt;&lt;if _damage &gt;= $hea&gt;&gt;&lt;&lt;set _damage = $hea - 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;damage _damage&gt;&gt;
You are dragged off, eventually placed before a robed shaman. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;else&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The $npc1.species&#39;s last attack sends you to the ground hard, and try as you might, you can&#39;t pick yourself back up. The painful beating causes you to lose consciousness, with the last thing you feel being a sense of being dragged somewhere. When you awaken later, you are somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
Your last attack sends the $npc1.species flopping onto $npc1.his side groaning in pain, leaving you free to march on past and see what&#39;s inside.
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter the cultist village&quot; &quot;Got inside cultist village&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; true&gt;&gt;
    /* Custom ending */
	&lt;&lt;if $e.ate &gt; $e.sto&gt;&gt; /* defeated */
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter the cultist village&quot; &quot;Got inside cultist village&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="39" name="golem boss ai" tags="" position="5775,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Looks like the obsidian deposit you were looking for has decided to come to you, and has risen up into the form of a &lt;&lt;sayDistance 180&gt;&gt; tall anthropomorphic monstrosity. It&#39;s also decided to pound you into the ground like a tent stake, so it might be a good idea to do something about that. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $e.hea &lt; $e.maxhea * 0.5 and $e.special &lt; $e.hea&gt;&gt;
	&lt;li&gt;Shard shatter&lt;/li&gt;
	&lt;&lt;set _damage = Math.round($edmg * 0.4)&gt;&gt;
	Your attack causes the golem to shatter, sending viciously sharp shards at you for _damage damage! 
	&lt;&lt;damage _damage&gt;&gt;
	&lt;&lt;set $e.special = $e.hea&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Heavy blow&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The obsidian golem swings its arms in an unnatural sweep, but you are quick enough to avoid getting smashed! 
		&lt;&lt;else&gt;&gt;
			The obsidian golem swings its arms in an unnatural sweep, catching you in the side with a tremendous blow and doing $edmg damage! 
			&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Shockwave&lt;/li&gt;
		&lt;&lt;if setup.dodge() and setup.dodge()&gt;&gt;
			The giant obsidian creature clasps its &#39;hands&#39; together above its &#39;head&#39; and smashes them downward to the ground, sending a magical shockwave at you, but you are ready for it, and dodge to the side! 
		&lt;&lt;else&gt;&gt;
			The giant obsidian creature clasps its &#39;hands&#39; together above its &#39;head&#39; and smashes them downward to the ground, sending a magical shockwave at you that catches you off-guard, crashing into you and doing $edmg damage! 
			&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 3&gt;&gt;
		&lt;li&gt;Magma call&lt;/li&gt;
		&lt;&lt;if setup.dodge() or setup.dodge()&gt;&gt;
			The obsidian golem seems to lower its body and force its &#39;hands&#39; into the side of the volcano. The ground begins to rumble, and a few moments later, spouts of molten rock burst forth around you! Fortunately, they&#39;re far enough away that you don&#39;t get burned! 
		&lt;&lt;else&gt;&gt;
			The obsidian golem seems to lower its body and force its &#39;hands&#39; into the side of the volcano. The ground begins to rumble, and a few moments later, spouts of molten rock burst forth around you! You are painfully close to the superheated earth and take $edmg damage! 
			&lt;&lt;if random(1,100) &lt; 50&gt;&gt;
				Just being this close is enough to cause painful burns! 
				&lt;&lt;set _burn = $edmg * 0.5&gt;&gt;
				&lt;&lt;tempBuff &quot;burn&quot; _burn&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to escape, but the magical barrier has you completely encircled! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to escape, but the magical barrier has you completely encircled! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Unwilling to fight further, you lower yourself to the ground, hoping that this creature understands what submission is. The golem stops for a moment, then picks you up with surprising gentleness in its stone hand as a deep, growling voice rumbles through it: &quot;FOR YOUR OWN SAKE, DO NOT SEEK THE SWORD.&quot; With this warning, the world is replaced by a brilliant white flash, and you find yourself back in the eastern island village, none the worse for wear. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Get up&quot; &quot;Island Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You fall to your knees, thoroughly battered by the large obsidian golem. It picks you up, holding you in one &#39;hand&#39; as a deep, growling voice seems to rumble through it: &quot;DO NOT SEEK THE SWORD.&quot; With this warning, the world is replaced by flaring white, and you find yourself back in the eastern island village, battered and bruised, but still intact. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;set $hea = 1&gt;&gt;
&lt;&lt;set $alive = true&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Get up&quot; &quot;Island Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The golem&#39;s body groans, shudders violently, and finally collapses into a pile of rocks. Victorious, you take one of the chunks with you. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;advanceQuest $swordQuest&gt;&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="40" name="massive anaconda ai" tags="" position="4775,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This huge snake is roughly two feet thick and approxiately Very Very Long, its body disappearing behind the jungle foliage in a way that makes it nearly impossible to tell where it ends. Where it begins is more obvious: The hungry snake head that&#39;s hissing at you and preparing to make you its lunch. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &lt;= 0&gt;&gt;
	&lt;li&gt;Coil&lt;/li&gt;
	&lt;&lt;if setup.dodge()&gt;&gt;
		The huge snake constricts its thick and muscular torso, but you leap well clear of it before it can grab you. 
	&lt;&lt;else&gt;&gt;
		The huge snake constricts its thick and muscular torso, clamping down tight around you as it tries to crush you into submission! 
		&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;li&gt;Squeeze&lt;/li&gt;
	&lt;&lt;if !$e.special&gt;&gt;
		The snake squeezes you with incredible strength. You can feel your bones creaking in protest! 
		&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;if $hea &lt;= $maxHea * 0.6 and !$e.special&gt;&gt;
			Deciding that you&#39;re weakened enough, the snake opens its jaws and engulfs you from the head down. Everything goes dark as you find yourself in the long belly of the beast! 
			&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
			&lt;&lt;set $e.special = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	/*Swallowed*/
	&lt;&lt;else&gt;&gt;
		The walls of the snake&#39;s long stomach squeezes down around you! 
		&lt;&lt;damage $edmg&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You grasp the $npc1.species&#39;s head, clamping its mouth shut as you open yours wide. Shoving it straight into your throat, you begin to gulp down the massive, wriggling snake. Like a tremendous noodle, you suck it into your mouth, swallowing again and again, your throat bulging around its thick body. Wherever you look, you see its torso being pulled towards you, but what you don&#39;t see is where it ends. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	You refuse to be deterred, and gulp at it again and again, the tremendous tube of snake meat piling up in your belly, stretching it fuller and fuller as it seems to incessantly stretch on. All the while you can feel the snake wriggling in your throat and tickling at your insides, helpless to stop you from devouring it. After minutes of this, the end of its tail comes into view, and with a few more hungry swallows, you have devoured it entirely, your $waist belly squirming with the snake for a few more minutes as you gently rub it. When it stops, you carry on into the jungle, looking for your next meal. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You refuse to be deterred, and gulp at it again and again, the tremendous tube of snake meat making your belly groan as it stretches fuller and fuller with its seemingly endless body. As your belly grows painfully tight, you can feel every inch of the snake as it wriggles inside you, teasing your already strained insides. It&#39;s much too late to stop, though, and you are stuck swallowing again and again in an agonizing eternity of devouring the long snake. Its tail finally comes into view, but you know it&#39;s already too late, and when it disappears down your throat, all you can do is lie on the ground, rubbing your overstuffed belly and groaning until you lose consciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
&lt;&lt;if $e.special&gt;&gt;
	You wriggle and writhe, forcing yourself against the slippery snake&#39;s insides and are ejected out of the snake&#39;s mouth! 
	&lt;&lt;set $e.special = false&gt;&gt;
&lt;&lt;else&gt;&gt;
	You pry at the snake&#39;s heavy body and just manage to wriggle out of its grip! 
&lt;&lt;/if&gt;&gt;
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
&lt;&lt;if $e.special&gt;&gt;
	You struggle and strain, but can&#39;t manage to free yourself from the snake&#39;s squeezing stomach! 
&lt;&lt;else&gt;&gt;
	You pry at the snake&#39;s heavy body, but can&#39;t manage to loosen it at all! 
&lt;&lt;/if&gt;&gt;
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You manage to find the end of the snake&#39;s lengthy body and run around it, not stopping until you&#39;re far off into the distance and well away. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You stop resisting, unwilling to fight any further. The snake squeezes down on you, causing you to black out in pain. As you are devoured, you quickly lose consciousness, thankfully before you become anything worse than a large bulge in the $npc1.species&#39;s belly. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
You can feel the edges of your vision begin to blur as you&#39;re squeezed into submission. The pain causes you to lose consciousness thankfully quickly. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the $npc1.species lets out a gasping hiss, its long body writhing for a moment before slowing to a near stop. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;jungle randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="41" name="shaman boss normal ai" tags="" position="5525,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Dressed in feathered robes that fail to cover $npc1.his round belly bearing the mark of the Glutton Separatists, this $npc1.species is wielding a totem and already chanting incantations in a tongue you don&#39;t understand. Given the way that the world itself seems to shift around $npc1.him, it&#39;s obvious that $npc1.he&#39;s not as defenseless as $npc1.his empty hands would imply. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $e.special &lt;= 0 and !$e.attacked&gt;&gt;
	&lt;li&gt;Thorn wrap&lt;/li&gt;
	The shaman chants a few words, and the ground ruptures below your feet, thorned vines erupting forth and biting into your flesh as they wrap tightly around you! 
	&lt;&lt;set $e.special = 7&gt;&gt;
	&lt;&lt;set $e.attacked = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.special &gt; 0&gt;&gt;
	&lt;&lt;set $e.special--&gt;&gt;
	
	&lt;&lt;if $e.special &gt; 3&gt;&gt;
		&lt;li&gt;Thorns&lt;/li&gt;
		The thorny vines dig into you. 
		&lt;&lt;set _damage = random(6,10)&gt;&gt;
		&lt;&lt;damage _damage&gt;&gt;
		&lt;&lt;if random(1,100) &lt; 15&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $e.special &lt;= 0&gt;&gt;
		&lt;&lt;set $e.special = 0&gt;&gt;
		The vines around you retract back into the ground, expended of their magic! 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$e.attacked&gt;&gt;
	&lt;&lt;if random(1,2) == 1&gt;&gt;
		&lt;&lt;if random(1,3) == 1 or $agi &lt; 10 or $str &lt; 10&gt;&gt;
			&lt;li&gt;Geyser&lt;/li&gt;
			The shaman bends low to the ground, hands facing upwards before he suddenly rises, throwing $npc1.his hands up in the air. Below you, the earth rumbles, then cracks open as a geyser of water pounds into you, sending you flying into the air before you land hard on the ground. 
			&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Fatten&lt;/li&gt;
			The shaman waves his hands, chanting curses at you in a language you don&#39;t understand. The world suddenly seems heavier, your strength leaving you as your muscles turn into thick, heavy fat on your body! 
			&lt;&lt;set _buff = random(-4,-9)&gt;&gt;
			&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(-4,-9)&gt;&gt;
			&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(8,18)&gt;&gt;
			&lt;&lt;tempBuff &quot;fat&quot; _buff&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $e.hea &gt; $e.maxhea * 0.5&gt;&gt;
				&lt;li&gt;Rock pelt&lt;/li&gt;
				&lt;&lt;if setup.dodge()&gt;&gt;
					The shaman swipes $npc1.his hand at you, sending small hunks of the ground flying at you, but you neatly dodge away.
				&lt;&lt;else&gt;&gt;
					The shaman swipes $npc1.his hand at you, causing small hunks of the ground to fly at you, pelting you for $edmg damage!
					&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;li&gt;Boulder smash&lt;/li&gt;
				&lt;&lt;if setup.dodge() and setup.dodge()&gt;&gt;
					The shaman raises $npc1.his hand and clenches it into a fist, causing the ground around you to hurl itself at you in dozens of large chunks. Fortunately, you are able to get yourself away from its epicenter without getting crushed thanks to a quick leap to the side. 
				&lt;&lt;else&gt;&gt;
					The shaman raises $npc1.his hand and clenches it into a fist, causing the ground around you to hurl itself at you in dozens of large chunks, smashing into you! 
					&lt;&lt;set $edmg *= 1.2&gt;&gt;
					&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $e.attacked = false&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You give the $npc1.species a shoulder check and pin $npc1.him against the stone altar, pressing your body against $npc1.him to keep $npc1.him held. $npc1.He starts to chant a spell in a loud, panicked tone, but you open your maw wide, clamping down on $npc1.his head as you voraciously begin to devour $npc1.him. You gulp $npc1.him down, going from head to neck and down to shoulders hungrily, your jaw unhinging as your throat muffles $npc1.his cries. Grabbing $npc1.him by the waist, you hoist $npc1.him up onto the altar and force yourself down upon $npc1.him, starting the $npc1.species on an inescapable path to your stomach. 					
&lt;&lt;set _eat = $e.weight + $npc1.speciesStats[5] * 5&gt;&gt;
&lt;&lt;consume  _eat&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	More and more of the fat $npc1.species&#39;s body is forced into your hungering maw and down your throat as you lower yourself down steadily further upon $npc1.him, $npc1.his arms and legs flailing below you. Ravenously, you pull $npc1.him into you again, violently shoving $npc1.his rotund midsection into your mouth as $npc1.his muffled cries begin to emanate from your $waist stomach. Swallowing with ferocious greed, you suck down $npc1.his massive belly before flipping $npc1.him up into the air, gravity assisting you with pulling $npc1.his legs and tail into your throat. With a few more gulps, the shaman is a large, struggling ball in your belly, and as you let out a contented hum and give your stretched belly a rub, it grows still. 
	&lt;&lt;set $cal += _eat * .6&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Shaman defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	You slowly swallow $npc1.him down, gravity forcing his heavy body down your throat much faster than you&#39;d wanted, but you doubt it would&#39;ve helped anyways. Forcing down its legs and tail, you fall to your knees, rubbing your $waist belly and groaning in pain, unable to do much else. As you lose consciousness, you can see a raptor looming over you, seeming to prepare for some kind of ritual. 
	&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower yourself to the ground, unwilling to fight any further. Seeing this, the shaman raises $npc1.his hands palm up, slowly. Below you, vines erupt forth, and you are soon bound by them, unable to move. With a gesture and a call, others begin to gather around. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 600&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 1000&gt;&gt;Half a dozen reptillian bystanders haul you haphazardly onto an altar. 
&lt;&lt;else&gt;&gt;What feels like an entire village of reptillian bystanders struggle to haul your massive body onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. 
&lt;br&gt;&lt;br&gt;

When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The shaman&#39;s last attack proves too much for you, and you stumble to the ground, too injured to fight on. Seeing this, the shaman raises $npc1.his hands palm up, slowly. Below you, vines erupt forth, and you are soon bound by them, unable to move. With a gesture and a call, others begin to gather around. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 600&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 1000&gt;&gt;Half a dozen reptillian bystanders haul you haphazardly onto an altar. 
&lt;&lt;else&gt;&gt;What feels like an entire village of reptillian bystanders struggle to haul your massive body onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The shaman wobbles a bit on $npc1.his feet after your last attack, then crashes to the ground on $npc1.his big, round stomach, letting out a groan as $npc1.he goes. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Shaman defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; true&gt;&gt;
    /* Custom ending */
	&lt;&lt;if $e.ate &gt; $e.sto&gt;&gt; /* defeated */
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Shaman defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="42" name="star shaman ai" tags="" position="5650,1125" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This shaman is an abnormally large and heavily-muscled $npc1.species, dressed in robes that bear an unusual symbol that makes your head hurt and your eyes water when you look at it too long. $npc1.He is wielding a totem topped by the Fallen Star in $npc1.his powerful arms, and that&#39;s what you&#39;re here to get. Only one way to do so now... 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $e.specialB == 2 and $e.hea &lt;= $e.maxhea * 0.5 and !$e.attacked&gt;&gt;
	&lt;li&gt;Stardust&lt;/li&gt;
	The $npc1.species raises the totem high, looking up to the heavens and calling out in a language you don&#39;t understand. The sky streaks with falling stars, and in a few moments you are pelted with countless small, burning stones. 
	&lt;&lt;damage $edmg * 1.7&gt;&gt;
	&lt;&lt;set $e.specialB = 1&gt;&gt;
	&lt;&lt;set $e.attacked = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.specialB == 1 and $e.hea &lt;= $e.maxhea * 0.25 and !$e.attacked&gt;&gt;
	&lt;li&gt;Dragon breath&lt;/li&gt;
	&lt;&lt;if setup.dodge()&gt;&gt;
		With a bit of panic on his face, the $npc1.species begins to utter deep, rumbling words of power. As $npc1.he utters the last syllable, $npc1.he lurches forward, mouth open wide. Taking this as a sign to get out of the way, you put as many objects between $npc1.him and you as possible, and a gout of fire erupts from $npc1.his mouth, but fails to do more than cause you to sweat! 
	&lt;&lt;else&gt;&gt;
		With a bit of panic on $npc1.his face, the $npc1.species begins to utter deep, rumbling words of power. As $npc1.he utters the last syllable, $npc1.he lurches forward, mouth open wide as a gout of flame erupts from it, engulfing you in fire! 
		&lt;&lt;damage $edmg * 1.5&gt;&gt;
		&lt;&lt;tempBuff &quot;burn&quot; $edmg * 0.5&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $e.specialB = 0&gt;&gt;
	&lt;&lt;set $e.attacked = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.specialA &lt;= 0 and !$e.attacked&gt;&gt;
	&lt;li&gt;Thorn wrap&lt;/li&gt;
	The shaman chants a few words, and the ground ruptures below your feet, thorned vines erupting forth and biting into your flesh as they wrap tightly around you! 
	&lt;&lt;set $e.specialA =  5&gt;&gt;
	&lt;&lt;set $e.attacked = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$e.attacked&gt;&gt;
	&lt;&lt;if random(1,2) == 1&gt;&gt;
		&lt;&lt;if random(1,3) == 1 or $agi &lt; 10 or $str &lt; 10&gt;&gt;
			&lt;li&gt;Geyser&lt;/li&gt;
			The shaman bends low to the ground, $npc1.hands facing upwards before $npc1.he suddenly rises, throwing $npc1.his hands up in the air. Below you, the earth rumbles, then cracks open as a geyser of water pounds into you, sending you flying into the air before you land hard on the ground. 
			&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Fatten&lt;/li&gt;
			The shaman waves $npc1.his $npc1.hands, chanting curses at you in a language you don&#39;t understand. The world suddenly seems heavier, your strength leaving you as your muscles turn into thick, heavy fat on your body! 
			&lt;&lt;set _buff = random(-4,-9)&gt;&gt;
			&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(-4,-9)&gt;&gt;
			&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(8,18)&gt;&gt;
			&lt;&lt;tempBuff &quot;fat&quot; _buff&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;Boulder smash&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The shaman raises $npc1.his $npc1.hand and clenches it into a fist, causing the ground around you to hurl itself at you in dozens of large chunks. Fortunately, you are able to get yourself away from its epicenter without getting crushed thanks to a quick leap to the side. 
		&lt;&lt;else&gt;&gt;
			The shaman raises $npc1.his $npc1.hand and clenches it into a fist, causing the ground around you to hurl itself at you in dozens of large chunks, smashing into you! 
			&lt;&lt;damage $edmg&gt;&gt;
		&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.specialA &gt; 0&gt;&gt;
	&lt;li&gt;Thorns&lt;/li&gt;
	The thorny vines dig into you. 
	&lt;&lt;set _damage = random(8,15)&gt;&gt;
	&lt;&lt;damage _damage&gt;&gt;
	&lt;&lt;if random(1,100) &lt; 20&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $e.specialA--&gt;&gt;
	&lt;&lt;if $e.specialA &lt;= 0&gt;&gt;
		&lt;&lt;set $e.specialA = 0&gt;&gt;
		The vines around you retract back into the ground, expended of their magic! 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $e.attacked = false&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
&lt;&lt;createNPC &quot;dinosaur&quot; &quot;random&quot; 2&gt;&gt;

&lt;&lt;if $e.victims == 10&gt;&gt;
	You lunge for the $npc1.species, grabbing $npc1.him in your arms and holding $npc1.him in place as you open your mouth wide. Lifting $npc1.him up, you force $npc1.him into your maw, jaw unhinging and throat stretching as you gulp $npc1.him down. 
&lt;&lt;elseif $e.victims &gt; 1&gt;&gt;
	Again you manage to get a hold of the $npc1.species and cram $npc1.him into your maw, not satisfied until $npc1.he&#39;s in your belly. Swallowing furiously, you raise $npc1.him up and pull $npc1.him into you, trying to eat $npc1.him faster than last time to keep $npc1.him from escaping. 
&lt;&lt;else&gt;&gt;
	Once more, you get your hands on the $npc1.species and force $npc1.him into your maw, absolutely determined to devour $npc1.him once and for all. Keeping a firm grip on $npc1.him, you pull at $npc1.him, forcing $npc1.him down your stretched throat and towards your now very crowded stomach as you swallow with fervent conviction. 
&lt;&lt;/if&gt;&gt;
&lt;&lt;consume $e.weight 0&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
	&lt;&lt;if $e.victims == 10&gt;&gt;
		About midway down $npc1.his muscular torso, something curious happens and you find that $npc2.article &lt;&lt;if $npc2.species == $npc1.species&gt;&gt;different &lt;&lt;/if&gt;&gt;$npc2.species is in your mouth instead. As you gulp down its fat waist and slurp its legs down, you see that the shaman is growling and wiping some of your saliva off $npc1.his face, still wielding $npc1.his totem. A brief looking around shows that there seems to be one less person watching the battle. Looks like this is still a fight. 
		&lt;&lt;set $cal += $e.weight*.6&gt;&gt;
	&lt;&lt;elseif $e.victims &gt; 1&gt;&gt;
		Again you only make it halfway down $npc1.his body before $npc1.he is replaced by someone else. Swallowing down your unintended victim hastily, you quickly find $npc1.him again, the look on $npc1.his face one of even greater aggravation than before. You give your $hungry $waist belly a quick rub and get back to the fight again. 
		&lt;&lt;set $cal += $e.weight*.6&gt;&gt;
	&lt;&lt;else&gt;&gt;
		As you watch carefully, you notice that the flailing legs and tail that stick out of your mouth do not change. Slurping them down hastily, you take a look around. The stronghold is now completely empty, it seems, as everyone else that was here is now in your $waist belly. 
		&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
		&lt;&lt;consume 150 _calories&gt;&gt;
		&lt;&lt;if $alive&gt;&gt;
			Well, that&#39;s certainly one way to do it. 
			&lt;&lt;include &quot;Victory&quot;&gt;&gt;
			&lt;&lt;advanceQuest $hammerQuest&gt;&gt;
			&lt;hr&gt;
			&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			As you slowly gulp $npc1.him down towards your already full stomach, you notice that the flailing legs and tail that stick out of your mouth don&#39;t change. Agonizingly, you swallow again and again, vigor renewed by the thought that, finally, you have eaten the shaman. As you sink to the ground rubbing your painfully overstretched belly, you are comforted by that thought, and as you slip into unconsciousness, you still consider it a victory. 
			&lt;hr&gt;
			&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $e.victims == 10&gt;&gt;
		You slowly swallow him down, gravity forcing $npc1.his heavy body down your throat much faster than you&#39;d wanted, but you doubt it would&#39;ve helped anyways. The pain of your stretched stomach is so great that you only barely notice that the creature you&#39;re eating doesn&#39;t seem to be the $npc1.species anymore. Forcing down its legs and tail, you fall to your knees, rubbing your $waist belly and groaning in pain, unable to do much else. As you lose consciousness, you can see the $npc1.species looming over you, seeming to prepare for some kind of ritual. 
	&lt;&lt;elseif $e.victims &gt; 1&gt;&gt;
		Unfortunately, it seems that this time, you don&#39;t have it in you to eat another whole person, and when you spot that $npc1.he&#39;s been replaced, you let out a muffled groan. You were certain this time would do it, but now all you have for your trouble is the lower half of $npc2.article $npc2.species to suck down to an overfull belly. Having no choice but to swallow it down, you fall to your knees, $waist belly just too full for you to keep going. Groaning in pain and rubbing your aching stomach, you are fortunate enough to lose consciousness before the $npc1.species can perform whatever spell $npc1.he started to use as you pass out. 
	&lt;&lt;else&gt;&gt;
		As you slowly gulp $npc1.him down towards your already full stomach, you notice that the flailing legs and tail that stick out of your mouth don&#39;t change. Agonizingly, you swallow again and again, vigor renewed by the thought that, finally, you have eaten the shaman. As you sink to the ground rubbing your painfully overstretched belly, you are comforted by that thought, and as you slip into unconsciousness, you still consider it a victory. 
	&lt;&lt;/if&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;
	
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $e.victims--&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to get out, but with the gate closed, there isn&#39;t any good way to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to get out, but with the gate closed, there isn&#39;t any good way to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
Unwilling to fight the shaman any further, you lower yourself to the ground in submission before the $npc1.species. $npc1.He scoffs and barks out a command in the island language. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 600&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 1000&gt;&gt;Half a dozen reptillian bystanders haul you haphazardly onto an altar. 
&lt;&lt;else&gt;&gt;What feels like an entire village of reptillian bystanders struggle to haul your massive body onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The raptor&#39;s last spell proves to be too much, and you slump to the ground, defeated. 
&lt;&lt;if setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 300&gt;&gt;Two reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 600&gt;&gt;Four reptillian bystanders haul you onto an altar. 
&lt;&lt;elseif setup.weight() &lt;= 1000&gt;&gt;Half a dozen reptillian bystanders haul you haphazardly onto an altar. 
&lt;&lt;else&gt;&gt;What feels like an entire village of reptillian bystanders struggle to haul your massive body onto an altar. 
&lt;&lt;/if&gt;&gt;
From there, the shaman begins to chant, the unfamiliar island language interspersed with unnatural sounding words that you can barely even comprehend, let alone identify. As magic flows around you, the world goes dark, the altar and village seeming to fade away, leaving you with the distinct feeling of falling. When the sensation stops, you find yourself somewhere cold and dark. All you can see is five glowing lights, like sets of eyes staring at you. A whispy, deep voice echoes around you in an unnatural tongue, and your pulse quickens, a cold feeling spreading through you. Before you can fully comprehend what is happening, your body dissipates, absorbed by something in the darkness, and you are no more. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last blow, the $npc1.species staggers backwards and falls to the ground. Crying out words in a language that makes your brain hurt just hearing them, $npc1.he is suddenly consumed by a roaring mist of horrendous purple magic. A scream escapes $npc1.him and is cut short, and just like that, $npc1.he is gone. The totem and the Fallen Star, however, are still there. You smash the totem and take the hunk of star metal with you. It&#39;s huge! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;advanceQuest $hammerQuest&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="43" name="beach enemies" tags="" position="4475,675" size="100,100">&lt;&lt;set $hydra = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Hydra&quot;,
  name: &quot;hydra&quot;,
  gender: &quot;random&quot;,
  
  str: 60,
  agi: 40,
  int: 20,
  def: 5,
  maxhea: 400,
  lvl: 15,
  damageResistance: [&quot;bashing&quot;],
  damageWeakness: [],

  gld: 150,
  xp: 300,  
  item: $spectrumGem,
  itemChance: 100,

  voreable: false,
  runnable: true,

  ai: &quot;hydra ai&quot;,
  
  species: &quot;hydra&quot;,
}&gt;&gt;

&lt;&lt;set $waterElemental = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Water Elemental&quot;,
  name: &quot;water elemental&quot;,
  
  str: 18,
  agi: 18,
  int: 14,
  def: 3,
  maxhea: 260,
  lvl: 4,
  damageResistance: [&quot;piercing&quot;,&quot;slashing&quot;],
  damageWeakness: [&quot;lightning&quot;],

  gld: 12,
  xp: 16,  
  item: $waterJug,
  itemChance: 35,

  voreable: false,
  runnable: true,

  itemFound: &quot;You do however find a jug of water mysteriously sitting on the ground. You&#39;re pretty sure it wasn&#39;t there before...?&quot;,
  ai: &quot;water elemental ai&quot;,
}&gt;&gt;


&lt;&lt;set $sandSnake = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Sand Snake&quot;,
  name: &quot;sand snake&quot;,
  
  str: 18,
  agi: 18,
  int: 14,
  def: 3,
  maxhea: 120,
  lvl: 5,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 15,
  xp: 30,  
  item: $snakeVenom,
  itemChance: 40,

  voreable: true,
  weight: 200,
  runnable: true,

  itemFound: &quot;You&#39;re about to turn away and go on your way but you notice the snake’s fangs are dripping orange venom. You get an empty drink bottle from your bag and hold it up to the fang and the venom oozes into it. You could probably use this for more controlled use later. &quot;,
  ai: &quot;sand snake ai&quot;,
  
  species: &quot;snake&quot;,
}&gt;&gt;


&lt;&lt;set $bubbleOrca = {
	Name: &quot;Bubble Orca&quot;,
	name: &quot;bubble orca&quot;, 
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	image: &quot;bubbleOrcaImage&quot;, 
	species: &quot;orca&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 220,
	str: 20, 
	agi: 18, 
	int: 12, 
	def: 3, 
	maxhea: 120, 
	lvl: 5,
	damageWeakness: [&quot;piercing&quot;],
	gld: 15, 
	xp: 30,

	ai: &quot;bubble orca ai&quot;,
}&gt;&gt;


&lt;&lt;set $sphericalShark = {
	Name: &quot;Spherical Shark&quot;,
	name: &quot;spherical shark&quot;, 
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	image: &quot;sphereSharkImage&quot;, 
	species: &quot;shark&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 240,
	str: 20, 
	agi: 18, 
	int: 12, 
	def: 3, 
	maxhea: 120, 
	lvl: 5,
	gld: 15, 
	xp: 30,

	ai: &quot;spherical shark ai&quot;,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="44" name="city enemies" tags="" position="4475,375" size="100,100">&lt;&lt;set $drunk = {
	Name: &quot;Drunk&quot;,
	name: &quot;drunk&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: &quot;random&quot;,
	species: &quot;random&quot;,
	voreable: true,
	weight: 125,
	str: 15, 
	agi: 5, 
	int: 10, 
	def: 2, 
	maxhea: 60, 
	lvl: 2,
	gld: 3, 
	xp: 8,
	ai: &quot;drunk ai&quot;,
	exit: &quot;Central Square&quot;,
}&gt;&gt;


&lt;&lt;set $thief = {
	Name: &quot;Thief&quot;,
	name: &quot;thief&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: $male,
	species: &quot;random&quot;,
	voreable: true,
	weight: 120,
	str: 10, 
	agi: 15, 
	int: 15,
	def: 3, 
	maxhea: 70, 
	lvl: 3,
	gld: 0, 
	xp: 12,
	ai: &quot;thief ai&quot;,
	exit: &quot;Central Square&quot;,
}&gt;&gt;


&lt;&lt;set $takeoutTerror = {
	Name: &quot;Takeout Terror&quot;,
	name: &quot;takeout terror&quot;, 
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: $male,
	species: &quot;random&quot;,
	voreable: true,
	weight: 250,
	str: 24, 
	agi: 10, 
	int: 15, 
	def: 2, 
	maxhea: 140, 
	lvl: 5,
	gld: 15, 
	xp: 30,
	ai: &quot;takeout terror ai&quot;,
	exit: &quot;Central Square&quot;,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="45" name="enemy stats" tags="" position="4475,250" size="200,100">&lt;&lt;include &quot;city enemies&quot;&gt;&gt;
&lt;&lt;include &quot;forest enemies&quot;&gt;&gt;
&lt;&lt;include &quot;swamp enemies&quot;&gt;&gt;
&lt;&lt;include &quot;grasslands enemies&quot;&gt;&gt;
&lt;&lt;include &quot;hills enemies&quot;&gt;&gt;
&lt;&lt;include &quot;mountain enemies&quot;&gt;&gt;
&lt;&lt;include &quot;beach enemies&quot;&gt;&gt;
&lt;&lt;include &quot;jungle enemies&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="46" name="enemy variables" tags="" position="4475,125" size="100,100">&lt;&lt;set $inCombat = false&gt;&gt;
&lt;&lt;set $dmg = 500&gt;&gt;
&lt;&lt;set $edmg = 12&gt;&gt;</tw-passagedata><tw-passagedata pid="47" name="swamp enemies" tags="nobr" position="4475,475" size="100,100">&lt;&lt;set $obeseBear = {

  Article: &quot;An&quot;,
  article: &quot;an&quot;,
  Name: &quot;Obese bear&quot;,
  name: &quot;obese bear&quot;,
  species: &quot;brownBear&quot;,
  gender: &quot;random&quot;,
  image: &quot;bearImage&quot;,
  
  str: 15,
  agi: 13,
  int: 12,
  def: 2,
  maxhea: 70,
  lvl: 3,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 8,
  xp: 15,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: true,
  weight: 160,
  runnable: true,

  ai: &quot;bear ai&quot;,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="48" name="forest enemies" tags="nobr" position="4475,475" size="100,100">&lt;&lt;set $fatWolf = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Fat wolf&quot;,
  name: &quot;fat wolf&quot;,
  species: &quot;wolf&quot;,
  gender: &quot;random&quot;,
  image: &quot;wolfImage&quot;,
  
  str: 10,
  agi: 10,
  int: 7,
  def: 1,
  maxhea: 40,
  lvl: 1,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 4,
  xp: 8,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: true,
  weight: 120,
  runnable: true,

  ai: &quot;fatWolf ai&quot;,
}&gt;&gt;

&lt;&lt;set $obeseBear = {

  Article: &quot;An&quot;,
  article: &quot;an&quot;,
  Name: &quot;Obese bear&quot;,
  name: &quot;obese bear&quot;,
  species: &quot;brownBear&quot;,
  gender: &quot;random&quot;,
  image: &quot;bearImage&quot;,
  
  str: 15,
  agi: 13,
  int: 12,
  def: 2,
  maxhea: 70,
  lvl: 3,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 8,
  xp: 15,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: true,
  weight: 160,
  runnable: true,

  ai: &quot;bear ai&quot;,
}&gt;&gt;

&lt;&lt;set $syrupVines = {

  Article: &quot;A bunch of&quot;,
  article: &quot;a bunch of&quot;,
  Name: &quot;Syrup vines&quot;,
  name: &quot;syrup vines&quot;,
  
  str: 8,
  agi: 5,
  int: 4,
  def: 1,
  maxhea: 55,
  lvl: 1,
  damageResistance: [],
  damageWeakness: [&quot;slashing&quot;],
  
  gld: 5,
  xp: 10,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: false,
  weight: 100,
  runnable: true,

  ai: &quot;vine ai&quot;,
}&gt;&gt;

&lt;&lt;set $lemonSlime = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Lemon slime&quot;,
  name: &quot;lemon slime&quot;,
  image: &quot;lemonslime&quot;,
  
  str: 5,
  agi: 10,
  int: 10,
  def: 4,
  maxhea: 70,
  lvl: 1,
  damageResistance: [],
  damageWeakness: [&quot;lightning&quot;],
  
  gld: 4,
  xp: 8,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: false,
  weight: 100,
  runnable: true,

  ai: &quot;lemon ai&quot;,
}&gt;&gt;

&lt;&lt;set $fruitDryad = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Fruit dryad&quot;,
  name: &quot;Fruit dryad&quot;,
  species: &quot;random&quot;,
  gender: &quot;female&quot;,
  
  str: 4,
  agi: 7,
  int: 17,
  def: 0,
  maxhea: 60,
  lvl: 2,
  edamageResistance: [&quot;bashing&quot;, &quot;piercing&quot;],
  edamageWeakness: [&quot;fire&quot;],
  
  gld: 7,
  xp: 12,  
  item: $bloatedBlueberry,
  itemChance: 25,
  itemFound: &quot;It looks like the dryad dropped something during $npc1.his escape. &quot;,

  voreable: false,
  runnable: true,

  ai: &quot;dryad ai&quot;,
}&gt;&gt;

/*===Bosses===*/

&lt;&lt;set $gingerbreadWitch = {

  Name: &quot;Witch&quot;,
  name: &quot;witch&quot;,
  Article: &quot;The&quot;,
  article: &quot;the&quot;,
  str: 5,
  agi: 15,
  int: 25,
  def: 2,
  maxhea: 120,
  lvl: 4,
  gld: 25,
  xp: 20,
  species: &quot;random&quot;,
  gender: &quot;random&quot;, /* FIXES AND EDITS - make random - why not? */
  runnable: false,
  item: &quot;&quot;,
  itemChance: 0,
  damageResistance: [&quot;lightning&quot;, &quot;fire&quot;, &quot;ice&quot;],
  damageWeakness: [],

  voreable: false,
  runnable: false,
  special: &quot;book&quot;,

  ai: &quot;witch ai&quot;,

}&gt;&gt;

&lt;&lt;set $storeRoomOwner = {
	Name: &quot;Angry Local&quot;,
	name: &quot;angry local&quot;,
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	gender: &quot;random&quot;, /* FIXES AND EDITS - Set to random because there&#39;s no reason not to */
	species: &quot;random&quot;,
	runnable: false,
	str: 15, 
	agi: 10, 
	int: 10, 
	def: 2, 
	maxhea: 150, 
	lvl: 3,
	gld: 25, 
	xp: 16,
	ai: &quot;store room ai&quot;,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="49" name="grasslands enemies" tags="nobr" position="4575,475" size="100,100">&lt;&lt;set $bloatedLion = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Bloated lion&quot;,
  name: &quot;bloated lion&quot;,
  species: &quot;lion&quot;,
  gender: &quot;male&quot;,
  image: &quot;lionImage&quot;,
  
  str: 10,
  agi: 15,
  int: 10,
  def: 2,
  maxhea: 60,
  lvl: 2,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 5,
  xp: 10,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: true,
  weight: 140,
  runnable: true,

  ai: &quot;lion ai&quot;,
}&gt;&gt;

&lt;&lt;set $gorgedCheetah = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Gorged cheetah&quot;,
  name: &quot;gorged cheetah&quot;,
  species: &quot;cheetah&quot;,
  gender: &quot;random&quot;,
  image: &quot;cheetahImage&quot;,
  
  str: 7,
  agi: 18,
  int: 10,
  def: 2,
  maxhea: 60,
  lvl: 2,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 5,
  xp: 10,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: true,
  weight: 120,
  runnable: true,

  ai: &quot;cheetah ai&quot;,
}&gt;&gt;

&lt;&lt;set $expandedElephant = {

  Article: &quot;An&quot;,
  article: &quot;an&quot;,
  Name: &quot;Expanded elephant&quot;,
  name: &quot;expanded elephant&quot;,
  gender: &quot;random&quot;,
  image: &quot;&quot;,
  species: &quot;elephant&quot;,
  
  str: 20,
  agi: 8,
  int: 13,
  def: 3,
  maxhea: 80,
  lvl: 4,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 11,
  xp: 16,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: true,
  weight: 2000,
  runnable: true,

  ai: &quot;elephant ai&quot;,
}&gt;&gt;

&lt;&lt;set $wildling = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Wildling&quot;,
  name: &quot;wildling&quot;,
  species: &quot;random&quot;,
  gender: &quot;random&quot;,
  image: &quot;&quot;,
  
  str: 15,
  agi: 15,
  int: 10,
  def: 3,
  maxhea: 80,
  lvl: 3,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 5,
  xp: 14,  
  item: $sHealthPotion,
  itemChance: 100,

  voreable: false,
  runnable: true,
 
  itemFound:&quot;In $npc1.his haste to leave $npc1.he happened to have left a small health potion behind. &quot;,
  ai: &quot;wildling ai&quot;,
}&gt;&gt;

&lt;&lt;set $wildlingRitualist = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Wildling ritualist&quot;,
  name: &quot;wildling ritualist&quot;,
  species: &quot;random&quot;,
  gender: &quot;random&quot;,
  image: &quot;&quot;,
  
  str: 10,
  agi: 17,
  int: 20,
  def: 2,
  maxhea: 80,
  maxMana: 50,
  lvl: 3,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 5,
  xp: 14,  
  item: $cupcake,
  itemChance: 100,

  voreable: false,
  runnable: true,
  
  itemFound:&quot;Fortunately you&amp;#39;re able to at least catch that final cupcake before it hits the ground. &quot;,
  ai: &quot;ritualist ai&quot;,
}&gt;&gt;

&lt;&lt;set $wildlingShaman = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Wildling shaman&quot;,
  name: &quot;wildling shaman&quot;,
  species: $dog,
  gender: &quot;random&quot;,
  image: &quot;&quot;,
  
  str: 10,
  agi: 17,
  int: 27,
  def: 2,
  maxhea: 110,
  lvl: 5,
  damageResistance: [&quot;bashing&quot;,&quot;slashing&quot;,&quot;piercing&quot;],
  damageWeakness: [&quot;fire&quot;,&quot;ice&quot;,&quot;lightning&quot;,&quot;arcane&quot;],
  
  gld: 12,
  xp: 24,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: false,
  runnable: true,

  ai: &quot;shaman ai&quot;,
}&gt;&gt;

/*===Bosses===*/

&lt;&lt;set $wildlingShamanBoss = {

	Name: &quot;Wise wildling shaman&quot;,
	name: &quot;wise wildling shaman&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	str: 13,
	agi: 20,
	int: 34,
	def: 3,
	maxhea: 160,
	lvl: 7,
	gld: 19,
	xp: 38,
	species: $dog,
	gender: &quot;random&quot;,
	item: &quot;&quot;,
	itemChance: 0,
	damageResistance: [&quot;bashing&quot;,&quot;slashing&quot;,&quot;piercing&quot;],
	damageWeakness: [&quot;fire&quot;,&quot;ice&quot;,&quot;lightning&quot;,&quot;arcane&quot;],

	voreable: false,
	runnable: true,
	special: &quot;no captive&quot;,

	ai: &quot;shaman boss ai&quot;,

}&gt;&gt;

&lt;&lt;set $lizardWizard = {

	Name: &quot;Lizard wizard&quot;,
	name: &quot;lizard wizard&quot;,
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	str: 5,
	agi: 10,
	int: 30,
	def: 2,
	maxhea: 160,
	lvl: 3,
	gld: 13,
	xp: 17,
	gender: &quot;male&quot;,
	item: &quot;&quot;,
	itemChance: 0,
	damageResistance: [],
	damageWeakness: [],
    
    species: &quot;lizard&quot;,

	voreable: true,
	weight: 180,
	runnable: true,

	ai: &quot;lizard wizard ai&quot;,

}&gt;&gt;


&lt;&lt;set $cheeseMonster = {

	Name: &quot;Monster cheese&quot;,
	name: &quot;monster cheese&quot;,
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	str: 35,
	agi: 15,
	int: 10,
	def: 6,
	maxhea: 300,
	lvl: 10,
	gld: 0,
	xp: 0,
	gender: &quot;male&quot;,
	item: &quot;&quot;,
	itemChance: 0,
	damageResistance: [],
	damageWeakness: [],

	voreable: true,
	weight: 12,
	runnable: true,
	
	ai: &quot;cheese ai&quot;,

}&gt;&gt;</tw-passagedata><tw-passagedata pid="50" name="hills enemies" tags="nobr" position="4475,575" size="100,100">&lt;&lt;set $milkMachine = {

  Article: &quot;The&quot;,
  article: &quot;the&quot;,
  Name: &quot;Malevolent Milk Machine&quot;,
  name: &quot;malevolent milk machine&quot;,
  image: &quot;milkmachine&quot;,
  
  str: 30,
  agi: 5,
  int: 5,
  def: 8,
  maxhea: 150,
  lvl: 4,
  damageResistance: [&quot;piercing&quot;, &quot;slashing&quot;],
  damageWeakness: [&quot;lightning&quot;, &quot;bashing&quot;],
  
  gld: 15,
  xp: 35,  
  item: $milkBottle,
  itemChance: 60,
  itemFound: &quot;With one last cough and sputter, a single milk bottle falls out of a hatch on the side of the machine and rolls towards you. &quot;,

  voreable: false,
  runnable: true,

  ai: &quot;milk machine ai&quot;,
}&gt;&gt;

&lt;&lt;set $blueberrySlime = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Blueberry Slime&quot;,
  name: &quot;blueberry Slime&quot;,
  
  str: 15,
  agi: 20,
  int: 10,
  def: 5,
  maxhea: 220,
  lvl: 4,
  damageResistance: [],
  damageWeakness: [&quot;ice&quot;],
  
  gld: 8,
  xp: 16,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: false,
  runnable: true,

  ai: &quot;blueberry slime ai&quot;,
}&gt;&gt;

&lt;&lt;set $honeySlime = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Honey Slime&quot;,
  name: &quot;honey Slime&quot;,
  species: &quot;none&quot;,
  gender: &quot;thing&quot;,
  
  str: 15,
  agi: 10,
  int: 15,
  def: 1,
  maxhea: 250,
  lvl: 4,
  damageResistance: [&quot;piercing&quot;],
  damageWeakness: [&quot;fire&quot;],
  
  gld: 86,
  xp: 17,  
  item: $honeyDipper,
  itemChance: 7,
  itemFound: &quot;You find a wooden honey dipper in the honey lumps! &quot;,

  voreable: false,
  runnable: true,

  ai: &quot;honey slime ai&quot;,
}&gt;&gt;

&lt;&lt;set $meatMonster = {

  Article: &quot;A&quot;,
  article: &quot;a&quot;,
  Name: &quot;Meat monster man&quot;,
  name: &quot;meat monster man&quot;,
  species: &quot;none&quot;,
  gender: &quot;thing&quot;,
  
  str: 15,
  agi: 10,
  int: 5,
  def: 2,
  maxhea: 130,
  lvl: 3,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 8,
  xp: 10,  
  item: $sausage,
  itemChance: 30,
  itemFound: &quot;You look down and notice a single lonely sausage on the ground that hasn&#39;t been damaged from the fight and isn&#39;t too dirty. Considering it probably falls within the 5 second rule, you pick up the sausage and dust it off. &quot;,

  voreable: false,
  runnable: true,

  ai: &quot;meat monster ai&quot;,
}&gt;&gt;

&lt;&lt;set $bloatBees = {

  Article: &quot;A swarm of&quot;,
  article: &quot;a swarm of&quot;,
  Name: &quot;Bloat Bees&quot;,
  name: &quot;bloat bees&quot;,
  species: &quot;bee&quot;,
  gender: &quot;none&quot;,
  attackStat: &quot;str&quot;,
  
  str: 4,
  agi: 15,
  int: 5,
  def: 1,
  maxhea: 100,
  lvl: 3,
  damageResistance: [],
  damageWeakness: [],
  
  gld: 6,
  xp: 15,  
  item: &quot;&quot;,
  itemChance: 0,

  voreable: false,
  runnable: true,

  ai: &quot;bloat bee ai&quot;,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="51" name="jungle enemies" tags="" position="4575,675" size="100,100">&lt;&lt;set $anaconda = {
	Name: &quot;Massive anaconda&quot;,
	name: &quot;massive anaconda&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 650,
	str: 40, 
	agi: 35, 
	int: 17, 
	def: 5, 
	maxhea: 200, 
	lvl: 9,
	gld: 25, 
	xp: 55,
	ai: &quot;massive anaconda ai&quot;,
	special: false,
    
    species: &quot;anaconda&quot;,
}&gt;&gt;


&lt;&lt;set $fatJaguar = {
	Name: &quot;Fat Jaguar&quot;,
	name: &quot;fat jaguar&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 350,
	str: 25, 
	agi: 45, 
	int: 20,
	def: 3, 
	maxhea: 190, 
	lvl: 9,
	gld: 25, 
	xp: 55,
	ai: &quot;fat jaguar ai&quot;,
    
    species: &quot;jaguar&quot;,
}&gt;&gt;


&lt;&lt;set $gluttonSeparatist = {
	Name: &quot;Glutton Separatist&quot;,
	name: &quot;glutton separatist&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;dinosaur&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 250,
	str: 45, 
	agi: 15, 
	int: 15, 
	def: 4, 
	maxhea: 250, 
	lvl: 9,
	gld: 35, 
	xp: 70,
	ai: &quot;glutton seperatist ai&quot;,
}&gt;&gt;


&lt;&lt;set $dinosaurRider = {
	Name: &quot;Dinosaur Rider&quot;,
	name: &quot;dinosaur rider&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;dinosaur&quot;, 
	gender: &quot;random&quot;,
	voreable: true,
	weight: 250,
	str: 48, 
	agi: 20, 
	int: 14, 
	def: 5, 
	maxhea: 275, 
	lvl: 10,
	gld: 40, 
	xp: 80,
	ai: &quot;dinosaur rider ai&quot;,
}&gt;&gt;


&lt;&lt;set $shamanBossNormal = {
	Name: &quot;Glutton Shaman&quot;, 
	name: &quot;glutton shaman&quot;, 
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;dinosaur&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 350, 
	bossOf: &quot;cultistVillage&quot;,
	runnable: false,
	str: 20, 
	agi: 20, 
	int: 55,
	def: 3, 
	maxhea: 220, 
	lvl: 9,
	gld: 40, 
	xp: 75,
	ai: &quot;shaman boss normal ai&quot;,
	special: 0,
}&gt;&gt;


&lt;&lt;set $gluttonSeparatistBoss = {
	Name: &quot;Glutton Separatist&quot;,
	name: &quot;Glutton Separatist&quot;,
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	species: &quot;dinosaur&quot;,
	voreable: true,
	weight: 250, 
	bossOf: &quot;cultistVillage&quot;,
	str: 45, 
	agi: 15, 
	int: 15, 
	def: 4, 
	maxhea: 250, 
	lvl: 9,
	gld: 35, 
	xp: 70,
	ai: &quot;glutton seperatist boss ai&quot;,
}&gt;&gt;


&lt;&lt;set $anacondaBoss = {
	Name: &quot;Giant Anaconda&quot;,
	name: &quot;giant anaconda&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	voreable: true,
	weight: 1500, 
	str: 50, 
	agi: 30, 
	int: 20, 
	def: 7, 
	maxhea: 450, 
	lvl: 15,
	gld: 60, 
	xp: 110, 
	item: $whiteGoldChunk, 
	itemChance: 100,
	ai: &quot;anaconda boss ai&quot;,
	special: false,
    
    species: &quot;anaconda&quot;,
}&gt;&gt;


&lt;&lt;set $golemBoss = {
	Name: &quot;Obsidian Golem&quot;,
	name: &quot;obsidian golem&quot;,
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	str: 65, 
	agi: 10, 
	int: 20,
	def: 10, 
	maxhea: 450, 
	lvl: 15, 
	damageResistance: [&quot;bashing&quot;,&quot;slashing&quot;,&quot;piercing&quot;],
	gld: 60, 
	xp: 110, 
	item: $magicalObsidian, 
	itemChance: 100,
	ai: &quot;golem boss ai&quot;,
	special: 0,
}&gt;&gt;


&lt;&lt;set $starShaman = {
	Name: &quot;Star Shaman&quot;,
	name: &quot;Star Shaman&quot;,
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	species: &quot;raptor&quot;, 
	gender: &quot;male&quot;,
	voreable: true,
	weight: 250, 
	str: 20, 
	agi: 20, 
	int: 60,
	def: 5, 
	maxhea: 400, 
	lvl: 15,
	gld: 60, 
	xp: 110, 
	item: $fallenStar, 
	itemChance: 100,
	ai: &quot;star shaman ai&quot;,
	specialA: 0,
	specialB: 2,
	victims: 10,
	attacked: false,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="52" name="mountain enemies" tags="" position="4575,575" size="100,100">&lt;&lt;set $soldierAnts = {
	Name: &quot;Soldier Ants&quot;,
	name: &quot;soldier ants&quot;,
	Article: &quot;A swarm of&quot;,
	article: &quot;a swarm of&quot;,
	itemFound: &quot;Fortunately, you manage to grab some before they all escape you! &quot;,
	str: 20, 
	agi: 15, 
	int: 10, 
	def: 3, 
	maxhea: 250, 
	lvl: 10,
	gld: 60, 
	xp: 70, 
	itemChance: 100,
	ai: &quot;soldier ant ai&quot;,
    species: &quot;ant&quot;,
}&gt;&gt;


&lt;&lt;set $thinFur = {
	Name: &quot;Crazed thin person&quot;,
	name: &quot;crazed thin person&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;random&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 98,
	itemFound: &quot;One of the daggers appears to still be in decent shape. &quot;,
	str: 20, 
	agi: 50, 
	int: 10,
	def: 3, 
	maxhea: 175, 
	lvl: 10,
	gld: 40, 
	xp: 75, 
	item: $nastyDagger, 
	itemChance: 15,
	ai: &quot;thin fur ai&quot;,
}&gt;&gt;


&lt;&lt;set $toughFur = {
	Name: &quot;Crazed tough person&quot;,
	name: &quot;crazed tough person&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;random&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 350,
	itemFound: &quot;$npc1.His spear is lying on the ground and in good shape. &quot;,
	str: 35, 
	agi: 15, 
	int: 10, 
	def: 5, 
	maxhea: 300, 
	lvl: 10, 
	damageResistance: [&quot;ice&quot;,&quot;piercing&quot;,&quot;bashing&quot;,&quot;slashing&quot;],
	gld: 40, 
	xp: 75, 
	item: $obsidianSpear, 
	itemChance: 15,
	ai: &quot;tough fur ai&quot;,
}&gt;&gt;


&lt;&lt;set $magicalFur = {
	Name: &quot;Crazed magic person&quot;,
	name: &quot;crazed magic person&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;random&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 120,
	itemFound: &quot;The ugly wand is still in as good a shape as could be expected. &quot;,
	str: 10, 
	agi: 25, 
	int: 55,
	def: 2, 
	maxhea: 250, 
	lvl: 10,
	gld: 40, 
	xp: 75, 
	item: $charredWand, 
	itemChance: 15,
	ai: &quot;magical fur ai&quot;,
}&gt;&gt;


&lt;&lt;set $muscleFur = {
	Name: &quot;Crazed muscular person&quot;,
	name: &quot;crazed muscular person&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	species: &quot;random&quot;,
	gender: &quot;random&quot;,
	voreable: true,
	weight: 250,
	itemFound: &quot;Looks like that gigantic club is still in usable condition, too. You take it with you. &quot;,
	str: 45, 
	agi: 15, 
	int: 5, 
	def: 4, 
	maxhea: 250, 
	lvl: 10,
	gld: 40, 
	xp: 75, 
	item: $greatClub, 
	itemChance: 15,
	ai: &quot;muscle fur ai&quot;,
}&gt;&gt;



&lt;&lt;set $feederAnt = {
	Name: &quot;Feeder Ant&quot;,
	name: &quot;feeder ant&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	itemFound: &quot;Thinking quickly and creatively, you grab an empty, dried eggshell and scoop some of the honey into it to take with you, then quickly show yourself out.&quot;,
	str: 30, 
	agi: 20, 
	int: 15, 
	def: 5, 
	maxhea: 350, 
	lvl: 12,
	gld: 70, 
	xp: 90, 
	item: $magicalHoney, 
	itemChance: 100,
	ai: &quot;feeder ant ai&quot;,
    
    species: &quot;ant&quot;,
}&gt;&gt;


&lt;&lt;set $manticore = {
	Name: &quot;Manticore&quot;,
	name: &quot;manticore&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: &quot;male&quot;, /* icy - I&#39;ll leave it as only male, if only so I don&#39;t have to bother considering whether a female manticore should have a mane :p */
    species: &quot;manticore&quot;,
	voreable: true,
	weight: 650,
	str: 45, 
	agi: 40, 
	int: 30, 
	def: 6, 
	maxhea: 400, 
	lvl: 13,
	gld: 70, 
	xp: 100,
	ai: &quot;manticore ai&quot;,
}&gt;&gt;


&lt;&lt;set $snookums = {
	Name: &quot;Snookums&quot;,
	name: &quot;Snookums&quot;,
	Article: &quot;Ms.&quot;,
	article: &quot;Ms.&quot;,
	species: &quot;squirrel&quot;, 
	gender: &quot;female&quot;, 
	str: 40, 
	agi: 17, 
	int: 13, 
	def: 6, 
	maxhea: 320, 
	lvl: 13, 
	damageResistance: [&quot;ice&quot;,&quot;piercing&quot;,&quot;bashing&quot;,&quot;slashing&quot;],
	gld: 50, 
	xp: 90,
	ai: &quot;snookums ai&quot;,
}&gt;&gt;


&lt;&lt;set $fatWyvern = {
	Name: &quot;Fat Wyvern&quot;,
	name: &quot;fat wyvern&quot;,
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	gender: &quot;random&quot;, 
	voreable: true,
	weight: 600,
	str: 45, 
	agi: 30, 
	int: 15, 
	def: 6, 
	maxhea: 275, 
	lvl: 14, 
	damageResistance: [&quot;lightning&quot;],
	gld: 60, 
	xp: 115,
	ai: &quot;fat wyvern ai&quot;,
    species: &quot;wyvern&quot;,
}&gt;&gt;


&lt;&lt;set $royalGuardWasp = {
	Name: &quot;Royal Guard Wasp&quot;,
	name: &quot;royal guard wasp&quot;, 
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	str: 60, 
	agi: 50, 
	int: 20, 
	def: 6, 
	maxhea: 500, 
	lvl: 14,
	gld: 120, 
	xp: 120,
	ai: &quot;royal guard wasp ai&quot;,
    species: &quot;wasp&quot;,
}&gt;&gt;


&lt;&lt;set $smarty = {
	Name: &quot;Smarty&quot;,
	name: &quot;Smarty&quot;,
	Article: &quot;Mr.&quot;,
	article: &quot;Mr.&quot;,
	species: &quot;rabbit&quot;, 
	gender: &quot;male&quot;, 
	str: 10, 
	agi: 25, 
	int: 80,
	def: 3, 
	maxhea: 260, 
	lvl: 14,
	gld: 50, 
	xp: 100,
	ai: &quot;smarty ai&quot;,
}&gt;&gt;


&lt;&lt;set $mountainousTiger = {
	Name: &quot;Mountainous Tiger Sorcerer&quot;,
	name: &quot;mountainous tiger sorcerer&quot;,
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	species: &quot;tiger&quot;, 
	gender: &quot;male&quot;,
	voreable: true,
	weight: 600,
	itemFound: &quot;You scour the area to see if there&#39;s anything you missed, and find a long strand of the same gold thread that the sack had been embroidered with. &quot;,
	str: 70, 
	agi: 35, 
	int: 60,
	def: 6, 
	maxhea: 450, 
	lvl: 17,
	gld: 200, 
	xp: 350, 
	item: $goldThread, 
	itemChance: 100,
	ai: &quot;mountainous tiger ai&quot;,
}&gt;&gt;


&lt;&lt;set $cabalDragon = {
	Name: &quot;Rogue Cabal Dragon&quot;,
	name: &quot;rogue cabal dragon&quot;,
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	species: &quot;blackDragon&quot;, 
	gender: &quot;male&quot;,
	itemFound: &quot;With the dragon beaten, you are now able to return the cauldron to the Cabal, and will surely be rewarded handsomely for it. On closer inspection, the simplistic cauldron is quite compact and light, certainly due to the magical enchantments on it. It is easy enough to safely stash in your pack, and the lid is secured by a simple lock to prevent its contents from spilling forth. &quot;,
	special: 1,
	str: 60, 
	agi: 30, 
	int: 50,
	def: 8, 
	maxhea: 400, 
	lvl: 21, 
	damageResistance: [&quot;bashing&quot;,&quot;slashing&quot;,&quot;fire&quot;,&quot;ice&quot;,&quot;arcane&quot;],
	gld: 300, 
	xp: 425, 
	item: $cabalCauldron, 
	itemChance: 100,
	ai: &quot;cabal dragon ai&quot;,
	attacked: false,
	immobile: 0,
	special: 0,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="53" name="cabal dragon ai" tags="" position="5275,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This anthropomorphic $npc1.color $npc1.species is tremendously large, far bigger than what is naturally possible, and sports both a gigantic musculature and a massively round belly. $npc1.He is looking at you with hunger in $npc1.his eyes, and a malicious grin upon $npc1.his face. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Unrelenting Bite&lt;/li&gt;
			The $npc1.species&#39;s jaws squeeze around you, $npc1.his vice-like bite not relenting as $npc1.he lets out a stifled, beast-like growl! Yikes! 
			&lt;&lt;set $edmg *= 1.2&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
			
			&lt;&lt;if !$alive&gt;&gt;
				The pain overwhelms you, causing you to go slack in the $npc1.species&#39;s grasp.... But surprisingly, rather than gulp you down as you might have expected, $npc1.he instead tosses you harshly to the ground. Evidently $npc1.he&#39;s not done with you yet. 
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Drain Life&lt;/li&gt;
			The glyph pulses in time with a distinctive pain that wracks your body. You feel yourself getting weaker, and the $npc1.species growls, growing visibly stronger as $npc1.his wounds close! 
			&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
			&lt;&lt;tempBuff &quot;int&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
			&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
			&lt;&lt;tempBuff &quot;end&quot; _buff&gt;&gt;
			&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
			&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;
			&lt;&lt;set _damage = $edmg * 1.3&gt;&gt;
			&lt;&lt;damage _damage&gt;&gt;
			&lt;&lt;set _healing = $edmg * 0.65&gt;&gt;
			&lt;&lt;eHealth _healing&gt;&gt;
			
			&lt;&lt;if !$alive or $agi &lt; 1 or $end &lt; 1 or $str &lt; 1 or $int &lt; 1&gt;&gt;
				Your struggling grows weaker and weaker, and finally you go slack in the $npc1.species&#39;s grasp, unable to raise a hand to resist any longer... 
			&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $e.special == 1&gt;&gt;
		&lt;li&gt;Consume&lt;/li&gt;
		The enormous $npc1.species raises $npc1.his $npc1.hands, and the floor of the chamber is set alight with a magical circle. 
		&lt;&lt;if $fat &lt;= 0&gt;&gt;
			You look about in confusion, and the $npc1.species&#39;s wicked smile turns into a scowl. The room darkens again, and $npc1.he lets out a furious roar, apparently not getting any results from the spell! 
		&lt;&lt;elseif $fat &lt;= 50&gt;&gt;
			You are suspended in the air, unable to move, as a whispy red tendril emanates from your body. You grow slightly thinner as it leaves you and slides into the body of the huge $npc1.species. Slowly, you return to the ground, control returning to your body as you find yourself completely fatless. The $npc1.species seems to be a bit more bulky than $npc1.he was before... 
		&lt;&lt;elseif $fat &lt;= 100&gt;&gt;
			You are suspended in the air, unable to move, as whispy red tendrils emanate from your body. You grow significantly thinner as they leave you and slide into the body of the huge $npc1.species, who lets out a quiet growl as $npc1.his bulky form expands slightly and huge belly swells. The tendrils cease to emanate from you, leaving you fatless, before you are slowly lowered back to the ground and control returns to your body. The $npc1.species seems to have grown stronger from that... 
		&lt;&lt;elseif $fat &lt;= 200&gt;&gt;
			You are suspended in the air, unable to move, as glowing red tendrils emanate from your body. Fat melts off of your form as the tendrils drift out of you and into the body of the huge $npc1.species, who lets out a snarl as $npc1.his thick bulk expands, muscles swelling and belly ballooning even larger. The tendrils cease to emanate from you, leaving you fatless, before you are slowly lowered back to the ground and control returns to your body. The $npc1.species growls, flexing significantly stronger muscles and looming a bit larger than before... 
		&lt;&lt;elseif $fat &lt;= 500&gt;&gt;
			You are suspended in the air, unable to move, as bright red tendrils emanate from your body. Your body seems to melt away, rapidly shrinking to fatlessness as the tendrils drift out of you and into the body of the huge $npc1.species. $npc1.He flinches, $npc1.his body shaking as it grows, muscles bulging thicker and $npc1.his belly swelling and redoubling in size. When the tendrils finally cease to flow from you, you are lowered to the floor and control returns to your body. The $npc1.species throws $npc1.his head back and lets out a roar, stretching $npc1.his massively thickened limbs before returning $npc1.his attention to you... 
		&lt;&lt;else&gt;&gt;
			You are suspended in the air, unable to move, as brilliant red tendrils emanate from your body. Your $fatness body rapidly melts away, reducing quickly to a fatless state as the tendrils drift out of you and into the body of the huge $npc1.species. $npc1.He shudders, $npc1.his body shaking as $npc1.he lets out a growl, the tendrils making $npc1.him grow rapidly. $npc1.His muscles thicken to massive proportions, and $npc1.his tremendous gut blimps outward, swelling and filling on your stolen fat. When the tendrils finally stop flowing from you, you are lowered slowly to the floor and control returns to your body. For a brief moment, the $npc1.species looks immensely pleased with $npc1.his now monstrous bulk, but $npc1.his smile suddenly becomes a shocked grimace, and $npc1.he lowers himself to a seat, moaning loudly and placing $npc1.his huge $npc1.hands on $npc1.his over-stuffed belly... 
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _drainedFat = $fat&gt;&gt;
		&lt;&lt;if _drainedFat &gt; 1500&gt;&gt;&lt;&lt;set _drainedFat = 1500&gt;&gt;&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _drained = _drainedFat * -1&gt;&gt;
		&lt;&lt;tempBuff &quot;fat&quot; _drained&gt;&gt;
		
		&lt;&lt;set _strBuff = _drainedFat / 15&gt;&gt;		
		&lt;&lt;set $e.str += _strBuff&gt;&gt;
		
		&lt;&lt;set _heaBuff = _drainedFat / 3&gt;&gt;		
		&lt;&lt;set $e.maxhea += _heaBuff&gt;&gt;
		
		&lt;&lt;set _heal = $e.maxhea - $e.hea&gt;&gt;
		&lt;&lt;eHealth _heal&gt;&gt;
		
		&lt;&lt;set $e.special = 0&gt;&gt;
		&lt;&lt;if _drainedFat &gt; 500&gt;&gt;&lt;&lt;set $e.immobile += Math.round((_drainedFat - 250) / 250)&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $e.attacked = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if !$e.attacked and $e.immobile &lt;= 0&gt;&gt;
		&lt;&lt;if $e.hea &lt; $e.maxhea * 0.75 and random(1,8) == 1&gt;&gt;
			&lt;&lt;if $e.hea &lt;= $e.maxhea * 0.5 and !$e.attacked&gt;&gt;
				&lt;li&gt;Magic Breath&lt;/li&gt;
				&lt;&lt;if setup.dodge()&gt;&gt;
					The $npc1.species takes a deep breath, and you take that as a good sign to start evading. $npc1.He lets out a roar as a flood of magical energy erupts from $npc1.his maw, but $npc1.he fails to do anything more than leaving huge gouges on the floor and walls! 
				&lt;&lt;else&gt;&gt;
					The $npc1.species takes a deep breath, and with a roar, a flood of magical energy erupts from $npc1.his maw, smashing into you and pelting you with a stream of arcane bolts! 
					&lt;&lt;damage $edmg*1.5&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;set $e.attacked = true&gt;&gt;
			&lt;&lt;elseif $e.hea &gt; $e.maxhea * 0.5 and !$e.attacked&gt;&gt;
				&lt;li&gt;Furious Claw&lt;/li&gt;
				&lt;&lt;if setup.dodge()&gt;&gt;
					The $npc1.species growls fiercely, slashing at you with $npc1.his $npc1.hands, but is too enraged to catch you with them! 
				&lt;&lt;else&gt;&gt;
					The $npc1.species growls fiercely, slashing you with $npc1.his $npc1.hands like an enraged beast! 
					&lt;&lt;damage $edmg*1.2&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;set $e.attacked = true&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;elseif $e.hea &lt; $e.maxhea * 0.5 and random(1,9) == 1&gt;&gt;
			&lt;li&gt;Recover&lt;/li&gt;
			The $npc1.species growls angrily, reaching a hand back towards the magical container to beckon forth a glowing red tendril of arcane energy. As it seeps into $npc1.him, $npc1.his wounds close, and $npc1.his massive belly grows heavier. 
			&lt;&lt;set _heal = random($e.maxhea * 0.2,$e.maxhea * 0.3)&gt;&gt;
			&lt;&lt;eHealth  _heal&gt;&gt;
			&lt;&lt;set $e.str *= 0.95;&gt;&gt;
			&lt;&lt;set $e.attacked = true&gt;&gt;
		
		&lt;&lt;elseif $e.hea &lt; $e.maxhea * 0.5 and random(1,8) == 1&gt;&gt;
			&lt;&lt;if $e.hea &lt;= $e.maxhea * 0.25&gt;&gt;
				&lt;li&gt;Desperate Grasp&lt;/li&gt;
				&lt;&lt;if setup.dodge()&gt;&gt;
					The $npc1.species leaps at you ferally, attempting to get a hold of you, but you manage to keep out of $npc1.his grasp. 
				&lt;&lt;else&gt;&gt;
					The $npc1.species suddenly leaps on you, wrapping $npc1.his limbs and tail around you to ensnare you. &quot;Give me your strength!&quot; $npc1.he roars, reaching a $npc1.hand over you. A glowing glyph appears in the air in front of it, and you can feel its magic beginning to pull at you... 
					&lt;&lt;set $e.special = 3&gt;&gt;
					&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;set $e.attacked = true&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;li&gt;Furious Bite&lt;/li&gt;
				&lt;&lt;if setup.dodge()&gt;&gt;
					The $npc1.species roars in fury, lunging at you head first as $npc1.he attempts to snap you up in $npc1.his massive jaws. $npc1.His $npc1.teeth clack shut on nothing though as you deftly manage to avoid $npc1.his bite. 
				&lt;&lt;else&gt;&gt;
					The $npc1.species roars in fury, lunging at you head first and sinking $npc1.his massive $npc1.teeth into you! You are caught in $npc1.his jaws! It hurts and stings! 
					&lt;&lt;set $e.special = 2&gt;&gt;
					&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
					&lt;&lt;damage $edmg*1.2&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;set $e.attacked = true&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;else&gt;&gt;
			&lt;&lt;switch random(1,5)&gt;&gt;
				&lt;&lt;case 1&gt;&gt;
					&lt;li&gt;Sting&lt;/li&gt;
					&lt;&lt;if setup.dodge()&gt;&gt;
						The $npc1.species&#39;s tail suddenly comes flying through the air at you, seeming to stretch and elongate as it lashes at you, but you avoid it before it punches into you. As it retracts, you can see a pointed tip dripping with venom change back to a normal $npc1.adjective tail. 
					&lt;&lt;else&gt;&gt;
						The $npc1.species&#39;s tail suddenly comes lashing around $npc1.his side, seeming to stretch and elongate as it flies towards you. Just as it strikes into you, the tip develops a vicious point and seeps with venom, and you are left both punctured and poisoned! 
						&lt;&lt;damage $edmg&gt;&gt;
						&lt;&lt;set _poison = random(4,7)&gt;&gt;
						&lt;&lt;buff &quot;poison&quot; _poison&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					
				&lt;&lt;case 2&gt;&gt;
					&lt;li&gt;Confuse&lt;/li&gt;
					&lt;&lt;if setup.dodge()&gt;&gt;
						The $npc1.species suddenly holds a $npc1.hand out, palm up, towards you. You catch a glimpse of a prismatic, glowing orb and fight the inexplicable desire to stare into it, covering your eyes for a moment. As you do, you can see a bright flash of various color at the peripherals of your vision, but are fortunately unaffected. 
					&lt;&lt;else&gt;&gt;
						The $npc1.species suddenly holds a $npc1.hand out, palm up, towards you. Your eyes are drawn to a prismatic, glowing orb that levitates above $npc1.his grasp, and you are dazzled when it suddenly bursts into an array of lights and shapes. When the colors fade, the world seems to make less sense, and your brain feels like it&#39;s on fire! 
						&lt;&lt;damage $edmg&gt;&gt;
						&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
						&lt;&lt;tempBuff &quot;int&quot; _buff&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					
				&lt;&lt;case 3&gt;&gt;
					&lt;li&gt;Drain&lt;/li&gt;
					&lt;&lt;if setup.dodge()&gt;&gt;
						The $npc1.species waves $npc1.his $npc1.hands, summoning several dull red orbs. With a gesture, they streak through the air and begin to converge on you, but you are too fast and elude them until they fizzle out of existence. 
					&lt;&lt;else&gt;&gt;
						The $npc1.species waves $npc1.his $npc1.hands, summoning several dull red orbs. With a gesture, they streak through the air and converge on you. Where they touch you, you can feel an intense burning, and the orbs glow brilliant red as they return to the $npc1.species. As they fly off, you feel weaker, and when they meld into the $npc1.species&#39;s body, $npc1.he seems stronger! 
						&lt;&lt;set _buff = random(4,7)&gt;&gt;
						&lt;&lt;set $e.str += _buff&gt;&gt;
						&lt;&lt;set _buff *= -1&gt;&gt;
						&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;
						&lt;&lt;damage $edmg&gt;&gt;
						&lt;&lt;set _heal = $edmg * 0.3&gt;&gt;
						&lt;&lt;eHealth _heal&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					
				&lt;&lt;case 4&gt;&gt;
					&lt;li&gt;Withering Scratch&lt;/li&gt;
					&lt;&lt;if setup.dodge() and setup.dodge()&gt;&gt;
						The $npc1.species lightly swipes $npc1.his $npc1.hands at you, but doesn&#39;t manage to touch you even once as you stay well clear of them. $npc1.He growls in frustration. 
					&lt;&lt;else&gt;&gt;
						The $npc1.species lightly swipes $npc1.his $npc1.hands at you, managing to just nick you. While it doesn&#39;t seem to do much at first, it hurts steadily more, and you start to shudder, your mobility suffering! 
						&lt;&lt;set $edmg *= 0.8&gt;&gt; 
						&lt;&lt;damage $edmg&gt;&gt;
						&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
						&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					
				&lt;&lt;case 5&gt;&gt;
					&lt;li&gt;Toxic Breath&lt;/li&gt;
					The $npc1.species takes a deep breath, then blows out an unnatural violet-black fog, which envelopes you. Even without breathing it in, you can feel yourself getting weaker, your constitution suffering! 
					&lt;&lt;set _buff = random(-4,-7)&gt;&gt;
					&lt;&lt;tempBuff &quot;end&quot; _buff&gt;&gt;
					&lt;&lt;set _buff *= -1&gt;&gt;
					&lt;&lt;buff &quot;poison&quot; _buff&gt;&gt;
					
			&lt;&lt;/switch&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $e.immobile &gt; 0&gt;&gt;
		&lt;li&gt;Immobilized&lt;/li&gt;
		&lt;&lt;if $e.immobile &gt; 1&gt;&gt;
			The $npc1.species groans, rubbing $npc1.his gigantic belly with a pained look on $npc1.his face. It seems to shrink a bit, but $npc1.he&#39;s still in no state to be resisting your attacks. 
		&lt;&lt;elseif $e.immobile == 1&gt;&gt;
			The $npc1.species rubs $npc1.his gigantic belly for just a moment more, then slowly brings himself to $npc1.his $npc1.feet, letting out an angry growl as $npc1.he prepares to get back into the fight. 
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;Set $e.immobile--&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;set $e.attacked = false&gt;&gt;

&lt;&lt;if $agi &lt; 1 or $end  &lt; 1 or $str &lt; 1 or $int &lt; 1&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
&lt;&lt;if $e.special == 3&gt;&gt;
You summon all your strength and force yourself out of the massive $npc1.species&#39;s grasp, prying $npc1.his huge limbs off of you! 
&lt;&lt;else&gt;&gt;
You manage to pry the $npc1.species&#39;s massive jaws apart and pull yourself away! 
&lt;&lt;/if&gt;&gt;
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
&lt;&lt;if $e.special == 3&gt;&gt;
You struggle against the massive $npc1.species&#39;s hold, but are unable to free yourself, $npc1.his grip on you just too strong! 
&lt;&lt;else&gt;&gt;
You attempt to pry open the $npc1.species&#39;s massive jaws, but $npc1.he simply won&#39;t let go! 
&lt;&lt;/if&gt;&gt;
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to get away, but a magical barrier is barring the only path out of this chamber! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You try to get away, but a magical barrier is barring the only path out of this chamber! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You bring yourself to your hands and knees, lowering your head in surrender. Cautiously, the $npc1.species approaches you, and rumbles out bemused, &quot;You would submit yourself to me?&quot; before placing one of $npc1.his massive $npc1.hands under your chin, lifting it so your eyes meet $npc1.his. &quot;Then you will serve me before I consume you,&quot; $npc1.he rumbles. Your thoughts and fears fall away as new strength fills you, and you are left in rapture at the notion of serving your new master. What happens next is a blur of confused senses. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Some time later...&quot; &quot;Controlled by the Cabal Dragon&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;li&gt;Control&lt;/li&gt;
Suddenly, the $npc1.species reaches forth and grabs your head, turning you to face $npc1.him. &quot;This has gone on long enough,&quot; $npc1.he rumbles, then gazes deep into your eyes. &quot;Stop fighting,&quot; $npc1.he commands, and the words ring and echo in your mind. For a moment, you resist, but soon find yourself unable to disobey. You go limp under $npc1.his grasp, and everything seems to go hazy... Thoroughly beaten and drained of the ability to fight further, you slump to the ground in a heap, only to find yourself picked up by the massive beast of a $npc1.species. &quot;You will be a meal to me, weak little creature, but first, you will do my bidding,&quot; $npc1.he rumbles, putting a $npc1.hand to your head. Your thoughts and fears fade away, and you can feel your strength return to you. After a few more moments, you are filled with rapture at the notion of serving this titanic beast, and then the world becomes a bit of a blur. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Some time later...&quot; &quot;Controlled by the Cabal Dragon&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
The $npc1.species lets out an anguished roar, arcane red energy leaking out in whisps from $npc1.his battered form, causing him to shrink considerably. Some of the energy flows back into your body, returning you to your original state. As $npc1.he lowers to the floor, $npc1.he groans out, &quot;I can&#39;t be bested here, Master.&quot; Looking up from the floor, $npc1.he snarls at you. &quot;I&#39;ll have my revenge. I&#39;m not done with you, I swear it!&quot; For a moment it appears $npc1.he continues to shrink, but it quickly becomes apparent that $npc1.he is turning into some sort of grey ooze. The viscous fluid flows into cracks in the cavern walls, retreating from you, and as the magical barrier fades away, you are left alone in the chamber with the magical container you were sent to retrieve. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;advanceQuest $cabalRogue&gt;&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="54" name="fat wyvern ai" tags="" position="5025,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This &lt;&lt;if $npc1.nspeces == &quot;wyvern&quot;&gt;&gt;blue-grey wyvern&lt;&lt;else&gt;&gt;$npc1.furBack $npc1.species&lt;&lt;/if&gt;&gt; is even bigger and fatter than the ones that can normally be found around the mountain, and is also unusual in that its tail is dotted with boney protrusions that crackle with lightning when it&#39;s angry. Given that you&#39;ve threatened its young, that would be now. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Devour&lt;/li&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			You try to break the monster&#39;s hold on you, but it&#39;s simply too strong for you to get free. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 1&gt;&gt;
			As its mouth comes down on you, you don&#39;t have the space to get out of the way. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 0&gt;&gt;
			You push against it as your head goes into its maw, but are unable to deter it. It forces itself downward on you, its throat opening as it begins to swallow you head-first. You&#39;re in up to your chest, your arms pinned to your sides by its stretched mouth before it flips you upwards, its head and neck straightening to allow gravity to assist in pulling you straight for its belly. It swallows you again and again, pulling you towards its stomach several inches at a time. Your struggles prove fruitless as you simply can&#39;t get the leverage you need to escape, and as your hips enter its stretched throat, you begin to slide down its wet insides to its dark and cramped stomach. You can hear and feel the beast let out a satisfied rumble as its stomach begins to churn about you. The pressure and lack of air soon cause you to lose consciousness. 
			&lt;hr&gt;
			&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;	
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,5)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Bite&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species strikes its head out at you, but you manage to evade it. Its maw makes a crack as its fangs meet in what would&#39;ve been a painful bite. 
				
			&lt;&lt;else&gt;&gt;
				The $npc1.species strikes its head out at you, sinking its nasty, pointed fangs into you. As if that wasn&#39;t bad enough, its bite courses with lightning on top of it! 
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Breath&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species rears its head back, and you take that as a sign to get well out of the way. It begins to spew lightning at you, but it can&#39;t turn to direct it at you faster than you evade it. 
				
			&lt;&lt;else&gt;&gt;
				The $npc1.species rears its head back and lets loose a crackling wave of electricity, catching you right in the middle of it. Your body shakes and your teeth grit as it surges painfully through you! 
				&lt;&lt;set $edmg *= 0.8&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;if random(1,100) &lt; 50&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Dive&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				&lt;&lt;if random(1,2) == 1&gt;&gt;
					With an angry growl, the $npc1.species launches itself into the air, its wings whipping up wind. You have just enough time to react and move before it dives for you, taloned feet first where you were previously. 
				&lt;&lt;else&gt;&gt;
					With an angry growl, the $npc1.species beats its wings and jumps upwards. It makes it about five feet before it slowly sinks back to the ground, panting for breath after failing to carry its own weight.
				&lt;&lt;/if&gt;&gt;				
			&lt;&lt;else&gt;&gt;
				With an angry growl, the $npc1.species launches itself into the air, beating its wings furiously for a few moments, then forces itself forward with surprising speed. Its taloned feet plow into you, knocking you over and both crushing and cutting into you! 
				&lt;&lt;set $edmg *= 1.2&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 4&gt;&gt;
			&lt;li&gt;Tail whip&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species takes a half step towards you and swings its body around, but you dodge opposite of its turn and avoid getting lashed by its electrified tail. 
			&lt;&lt;else&gt;&gt;
				With a half-step towards you, the $npc1.species swings its body to the side, and its crackling tail whips around to crash into you. The speed lends it vicious force, and the lightning makes you violently shudder! 
				&lt;&lt;set $edmg *= 0.9&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;if random(1,100) &lt; 34&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 5&gt;&gt;
			&lt;li&gt;Grab&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species suddenly charges at you, and you immediately hurl yourself to the side, hitting the ground and rolling to a stand as its wings close around where you once stood, the violent motion making a loud whoosh. 
			&lt;&lt;else&gt;&gt;
				The $npc1.species suddenly charges forth, clasping its winged arms down around you. Its intentions become clear as it opens its mouth wide, rearing its head back in preparation to lunge down upon you and swallow you whole! 
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				&lt;&lt;set $e.special =  2&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;							
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You suddenly shove the $npc1.species&#39;s chest, the unexpected force sending it stumbling backwards a few steps, its tail curling up under it and wings flapping unevenly before it crashes onto its back with a loud thud. You immediately follow up by jumping on its tail and starting to slurp it down your throat. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	As it slides down your throat, you grasp at its legs, shoving one into your mouth, then the other, your jaws spreading wide and throat stretching around its meaty body. It growls at you, but is helpless to right itself, and its massive stomach prevents its head from snaking down upon you. Your stomach stretches and swells as you engorge yourself, forced to slow down to nearly a halt as you swallow at its massive gut. Inch by inch, you slide it steadily further into your stretched form, finally gulping down its tremendous belly. Pulling yourself forward as much as you drag it into your mouth, the creature raises its wings in a desperate attempt to resist, but you&#39;ve come too far to be stopped by this point. You grasp its arms, shoving them into your mouth and swallowing down, your hungry gullet overpowering even its mighty wings. Your belly is massively stretched even before you suck down its long, thick neck, and you are tremendously stretched by the time it is forced into a ball inside your enormous gut. You stand up and give your belly a quick rub as you hoist its now massive burden, and your breath crackles with a bit of electricity as you let out a bit of a belch. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Claim reward&quot; &quot;Pillage the Wyvern nest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	Gulping at it again and again, you already start to have doubts that you can consume it entirely even as you&#39;re grabbing at its legs and shoving them into your mouth. Your stomach begins to protest as you reach its waist, and just looking at the mountainous gut that awaits you makes you feel overly full. Determined, you slowly work it into your stretched throat, painfully aware of its twitching tail poking around in your belly. You manage to fit it into your throat, but as the $npc1.species is sliding inextricably into your gullet, you already know that you&#39;ve made a mistake. You can&#39;t stop yourself from swallowing the beast down even as your stomach grows and grows from its bulk. It lets out an angry roar, seemingly aware that it&#39;s too much for you. As its long, thick neck slips into your throat, you can feel the beast growling as a painful vibrating through your body. As you lie on your massively overfilled stomach, you groan, unable to work up the strength to keep going. 
	
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You push one of the beast&#39;s wings aside with your whole body, its hungry maw getting nothing but air before you force yourself out of its grasp. The $npc1.species roars furiously at your escape. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt; You cease your struggles and submit to your inevitable fate.  
&lt;&lt;else&gt;&gt;
	You fall to your hands and knees, unwilling to continue fighting. The $npc1.species pauses, marching up to you cautiously. It growls softly for a moment while it comes to understand your surrender, then cranes its neck down, taking your head into its mouth. The $npc1.species forces itself downward on you, its throat opening as it begins to swallow you head-first. You&#39;re in up to your chest, your arms pinned to your sides by its stretched mouth before it flips you upwards, its head and neck straightening to allow gravity to assist in pulling you straight for its belly. 
&lt;&lt;/if&gt;&gt;
It swallows you again and again, pulling you towards its stomach several inches at a time. Your struggles prove fruitless as you simply can&#39;t get the leverage you need to escape, and as your hips enter its stretched throat, you begin to slide down its wet insides to its dark and cramped stomach. You can hear and feel the beast let out a satisfied rumble as its stomach begins to churn about you. The pressure and lack of air soon cause you to lose consciousness. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
&lt;&lt;if $grapple &lt;= 0&gt;&gt;
	You fall to the ground, the beast&#39;s last attack bowling you over and knocking you on your back. You groan and lift your head to see that it is wasting no time; the $npc1.species has scooped your legs into its mouth with its tongue, and is quickly swallowing you into its throat. Pulling its head back with you in it, it lunges forward onto you, securing your body in its teeth as it forces you down its throat. After a few more of these, it marches forward slowly, its momentum causing you to slide into its maw and towards its stomach. When you are entirely in its mouth, it lifts its head upward, gravity and squeezing muscles sending you into its belly. You lose consciousness from your painful injuries and the beast&#39;s crushing stomach. 
&lt;&lt;else&gt;&gt;
	You push against it as your head goes into its maw, but are unable to deter it. It forces itself downward on you, its throat opening as it begins to swallow you head-first. You&#39;re in up to your chest, your arms pinned to your sides by its stretched mouth before it flips you upwards, its head and neck straightening to allow gravity to assist in pulling you straight for its belly. It swallows you again and again, pulling you towards its stomach several inches at a time. Your struggles prove fruitless as you simply can&#39;t get the leverage you need to escape, and as your hips enter its stretched throat, you begin to slide down its wet insides to its dark and cramped stomach. You can hear and feel the beast let out a satisfied rumble as its stomach begins to churn about you. The pressure and lack of air soon cause you to lose consciousness. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With a howl of pain, the giant $npc1.species lurches, then collapses onto its side, thoroughly beaten by your attacks. It lets out a groan as it slowly writhes on the ground, the fight taken out of it. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Claim reward&quot; &quot;Pillage the Wyvern nest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false&gt;&gt;
	/* Custom ending */
	&lt;&lt;if $e.ate &gt; $e.sto&gt;&gt; /* defeated */
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Claim reward&quot; &quot;Pillage the Wyvern nest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="55" name="feeder ant ai" tags="" position="4775,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This appears to be similar to &lt;&lt;if $npc1.nspecies == &quot;ant&quot;&gt;&gt;a honeypot ant&lt;&lt;else&gt;&gt;$npc1.article $npc1.species&lt;&lt;/if&gt;&gt;, but scaled up to about eight feet in height and nearly twice that in length. Fortunately, it doesn&#39;t seem to have much in the way of natural weapons. Unfortunately, that&#39;s not deterring it from wanting to beat you into submission and stuff you to bursting. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Feed&lt;/li&gt;
	A stream of thick honey gushes into your mouth, and you automatically find yourself swallowing it. It is incredibly sweet, and you feel a bit stronger... 
	&lt;&lt;set _cram = random(6,9)&gt;&gt;
	&lt;&lt;set _calories = _cram / 3&gt;&gt;
	&lt;&lt;consume _cram _calories&gt;&gt;
	&lt;&lt;tempBuff &quot;str&quot; 1&gt;&gt;
	&lt;&lt;if !$alive&gt;&gt;
		As the last bit of honey is forced down your throat, the pressure and sweetness become too much, and even the magical boon to your strength can&#39;t keep you fighting. 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Bash&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The creature swings its wobbly thorax at you from overhead. You dodge to the side, and it makes a squishy sound as it pounds down where you once stood. 
			&lt;&lt;else&gt;&gt;
				The creature swings its massively swollen thorax right on top of you. It&#39;s soft, but the floor that you are smashed into is decidedly not. 
				&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Pin&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The &lt;&lt;if $npc1.nspecies == &quot;ant&quot;&gt;&gt;ant-like monster&lt;&lt;else&gt;&gt;monstrous $npc1.species&lt;&lt;/if&gt;&gt; suddenly thrusts its thorax at you, but you slip out from the side of it before it can press you against the floor. 
			&lt;&lt;else&gt;&gt;
				The &lt;&lt;if $npc1.nspecies == &quot;ant&quot;&gt;&gt;ant-like monster&lt;&lt;else&gt;&gt;monstrous $npc1.species&lt;&lt;/if&gt;&gt; suddenly pushes its thorax against you and forces you down to the ground. The squishy bulk of it squeezes around you like a very big water balloon being held against you very insistently. With a bit of wriggling, the tip of its thorax is forced into your mouth. 
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Goop&lt;/li&gt;
			The $npc1.name suddenly exudes some of its honey, making a sticky mess of you. It hardens slightly, making movement more difficult! 
			&lt;&lt;set _debuff = random(-6,-9)&gt;&gt;
			&lt;&lt;tempBuff &quot;agi&quot; _debuff&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;							
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $agi &lt;= 0&gt;&gt;
	&lt;&lt;set $alive = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
Using your immense strength, you force the tremendous, squishy $npc1.species torso off of you, shoving it away and scrambling back to your feet. 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You push at the massively swollen thorax, but simply cannot muster the strength to actually move the enormous thing. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You decide to stop resisting and embrace the feeding that the $npc1.species wants to give you, lowering your arms and opening your mouth wide. The $npc1.name responds by putting the tip of its thorax into your mouth, and you are almost immediately overwhelmed by the immense amount of honey that flows from it and down your throat. Your stomach balloons out, gurgling and groaning as it fills to enormous size. 
&lt;&lt;consume 500 300&gt;&gt;
&lt;&lt;buff &quot;str&quot; 30 300&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
		The creature&#39;s thorax thins as your belly swells, and you can feel the magic in its honey making you stronger. Both your stomach and your muscles are significantly bigger when it pulls away from you. You give your $waist belly a gentle rubbing to attempt to alleviate some of its pressure, then notice that all the insects have frozen up around you, stopping their activities and just watching in confusion. It appears that they didn&#39;t expect you to still be mobile and have no idea what to do. You take the opportunity brought on by the confusion and haul your massive new bulk back out of the cave and to the mountains. 
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		As gallon follows gallon, you feel more and more painfully full. Even the increased strength you feel coursing through you isn&#39;t enough to keep you on your feet as you are stuffed well beyond what should be making you burst. You fall forward onto your massive belly, groaning in pain as the $npc1.species unloads the last of its contents into you. In spite of your great new strength, you can&#39;t work up the energy to get away. Which is unfortunate for you, because as the $npc1.name walks away, another moves up to take its place. You are helpless as your belly is made to swell to tremendous size by another... 
		&lt;&lt;consume 500 300&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; 30&gt;&gt;
		And another... 
		&lt;&lt;consume 500 300&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; 30&gt;&gt;
		And another... 
		&lt;&lt;consume 500 300&gt;&gt;
		&lt;&lt;tempBuff &quot;str&quot; 30&gt;&gt;
		And another. By the time they&#39;re done, your massive gut is the size of the passageway you came down, and in spite of how enormous your muscles have become, you can do little but flail your limbs about, unable to move the tremendous load of honey housed inside you. You have little time to contemplate this before a pack of worker insects start to roll you towards what appears to be an offshoot of the chamber. When you&#39;re inside it, however, it becomes apparent that you have been shoved into a hollowed out comb, as you feel the waxy walls all around you. As the insects finish jamming you into the chamber, a few of the &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).plural&gt;&gt; begin to disgorge wax on you. Where it makes contact with your $p.fur, there&#39;s an odd itching and stiffening that slowly spreads through you. When it coats your limbs, you can only watch as you lose the ability to move, your body coming to match the wax&#39;s consistency. The realization dawns on you that you are becoming a storage chamber for all the honey that was forced into you, but before you have time to ponder the implications, the change is complete, and you lose all sense of being. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;
		
&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The fight is thoroughly taken out of you by the &lt;&lt;if $npc1.nspecies == &quot;ant&quot;&gt;&gt;ant-like creature&#39;s&lt;&lt;else&gt;&gt;$npc1.name&#39;s&lt;&lt;/if&gt;&gt; last attack, and you are left groaning face-first on the ground. It slides the tip of its thorax under you and uses it to lift and press you against a wall before working it into your mouth. You can barely lift your hands to hold onto its squishy bulk as it begins to pump its honey into your mouth and down your throat. You are leaned up against the wall in a bruised heap as the beast&#39;s thorax thins, its contents finding a home in your massively swelling stomach. You can feel yourself getting stronger, but it doesn&#39;t ease the pain of trying to move, and it certainly doesn&#39;t help the tight fullness of your belly as it bulges well beyond what you thought it was normally capable of holding. 
&lt;&lt;consume 500 300&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; 30&gt;&gt;
As you lose consciousness, you sink down to the ground, held up only by your massive gut as the &lt;&lt;if $npc1.nspecies == &quot;ant&quot;&gt;&gt;ant-like creature&#39;s&lt;&lt;else&gt;&gt;$npc1.name&#39;s&lt;&lt;/if&gt;&gt; trots off, its thorax slim. The last thing you see is another four lining up in front of you, all of them filled to almost completely spherical shape with honey. 
&lt;&lt;consume 2000 1200&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; 150&gt;&gt;
When you regain consciousness, you find your stomach significantly bigger than even the stuffing you received had left you, and if you weren&#39;t being rolled along the waxy floor, you might even be able to lift it with how incredibly strong you feel. Unfortunately, before you can figure out how to use your new strength to escape, you&#39;re shoved into a small chamber. After packing you in tightly, some of the &lt;&lt;if setup.getSpeciesData(&quot;wasp&quot;).species == &quot;wasp&quot;&gt;&gt;bee-like creatures&lt;&lt;else&gt;&gt;&lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).plural&gt;&gt;&lt;&lt;/if&gt;&gt; begin covering you with a waxy substance. Where it makes contact with your $p.fur, there&#39;s an odd itching and stiffening that slowly spreads through you. When it coats your limbs, you can only watch as you lose the ability to move, your body coming to match the wax&#39;s consistency. The realization dawns on you that you are becoming a storage chamber for all the honey that was forced into you, but before you have time to ponder the implications, the change is complete, and you lose all sense of being. 
&lt;hr&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the creature lets out a disturbing shrieking noise and falls to the ground, honey leaking everywhere. The other insects respond by getting into a bit of a tizzy, scrambling about in a panic and generally demonstrating that it might be a good time to leave. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="56" name="magical fur ai" tags="" position="5150,875" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
As you traverse the mountains, you come across $npc1.article $npc1.species in tattered robes holding $npc1.his head in both hands and walking in an almost drunken stagger. Given that $npc1.he is grunting and groaning with pain, you feel safe in assuming they aren&#39;t having that kind of fun at the moment. &quot;Head hurts...&quot; $npc1.he gasps out, &quot;ALWAYS hurts...&quot; As $npc1.he approaches, you can see that $npc1.his head does appear to be a bit swollen, but not nearly as much as $npc1.his gut. $npc1.He manages to lift $npc1.his head enough to see you, and hisses out, &quot;...except when I get to EAT.&quot; With a staggered sweep, $npc1.he throws open one side of $npc1.his robe and pulls out an ugly, bent stick of a wand, pointing it at you menacingly! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,5)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Wand Zap&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			$npc1.He lets out a gutteral, wordless growl, levelling $npc1.his wand at you. The growl becomes a pained scream as an unstable bolt of raw magic flies out. Its trail washes over the $npc1.species, but the missile goes wide, flying off into the air before exploding harmlessly. 
			
		&lt;&lt;else&gt;&gt;
			$npc1.He lets out a gutteral, wordless growl, gripping $npc1.his head with one hand and levelling $npc1.his wand at you with the other. The growl becomes a scream as an unstable bolt of raw magic flies out, its trail washing over $npc1.him and its missile erupting into an explosion as it hits you! 
			&lt;&lt;set $edmg *= 1.2&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set _burn = $e.maxhea * 0.02&gt;&gt;
		&lt;&lt;eDamage _burn&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Splitting Fire&lt;/li&gt;
		&lt;&lt;if setup.dodge() or setup.dodge()&gt;&gt;
			Growling through gritted teeth, the $npc1.species draws a triangle in the air with $npc1.his wand, then points it at you. A burst of flame spits out, emitting tremendous heat even from a distance, then splits apart into three smaller bursts that you barely manage to avoid unscathed. 
			
		&lt;&lt;else&gt;&gt;
			Growling through gritted teeth, the $npc1.species draws a triangle in the air with $npc1.his wand, then points it at you. A burst of flame spits out, emitting tremendous heat even from a distance, then splits apart into three smaller bursts which scatter towards you in a way that you fail to avoid! 
			&lt;&lt;set $edmg *= 0.8&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set _burn = $e.maxhea * 0.03&gt;&gt;
		&lt;&lt;eDamage _burn&gt;&gt;
		
	&lt;&lt;case 3&gt;&gt;
		&lt;li&gt;Unpredictable Ice&lt;/li&gt;
		&lt;&lt;if setup.dodge() or setup.dodge()&gt;&gt;
			$npc1.He lets out an angry groan and violently slashes the air with $npc1.his wand before slapping it to the ground. A ball of ice appears, rolling towards you in odd spiralling, but you jump away at the last moment, sending it careening into a large rock, where it bursts in a frigid cloud. 
			
		&lt;&lt;else&gt;&gt;
			Letting out an angry groan, the $npc1.species makes three violent slashing motions with $npc1.his wand, then slaps it onto the ground. A ball of ice appears and rolls in odd spiralling curves at you, catching you off guard and bursting in a cold blast on your side! 
			&lt;&lt;set $edmg *= 1.2&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;if random(1,100) &lt; 33&gt;&gt;
				The immense chill causes you to stiffen! 
				&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set _burn = $e.maxhea * 0.03&gt;&gt;
		&lt;&lt;eDamage _burn&gt;&gt;
		
	&lt;&lt;case 4&gt;&gt;
		&lt;li&gt;Trapping Lightning&lt;/li&gt;
		&lt;&lt;if setup.dodge() or setup.dodge()&gt;&gt;
			$npc1.He raises $npc1.his wand in the air, making spiralling motions above $npc1.his head, then slashes the wand down violently in your direction. Countless bolts of lightning strike down around you in an unpredictable pattern that closes in on you, but you leap headlong into an opening and avoid being struck. 
			
		&lt;&lt;else&gt;&gt;
			Raising $npc1.his wand in the air, the $npc1.species makes spiralling motions above $npc1.his head before slashing the wand down violently in your direction. Blistering bolts of lightning rain down all about you in a wildly unpredictable pattern which closes around you, and several bolts strike you, singing your $p.fur and shaking you! 
			&lt;&lt;damage $edmg&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set _burn = $e.maxhea * 0.05&gt;&gt;
		&lt;&lt;eDamage _burn&gt;&gt;
		
	&lt;&lt;case 5&gt;&gt;
		&lt;&lt;if random(1,2) == 1&gt;&gt;
			&lt;li&gt;Arcane Explosion&lt;/li&gt;
			&lt;&lt;if setup.dodge() or setup.dodge()&gt;&gt;
				The $npc1.species suddenly stops, doubling over in pain and grasping $npc1.his head in both hands. gasps in pain, and an odd glow starts to emanate from $npc1.him. You know impending doom when you see it and make a break for the far side of the nearest large rock, and none too soon, for $npc1.his scream of pain is followed up by a loud burst and a bright red flash that scorches the dirt and shatters small rocks near $npc1.him! 
				
			&lt;&lt;else&gt;&gt;
				The $npc1.species suddenly stops, doubling over in pain and grasping $npc1.his head in both hands. $npc1.He gasps in pain, and an odd glow starts to emanate from $npc1.him. With a scream, the glow erupts in a loud burst and bright red flash strong enough to take you off your feet and send you flying! 
				&lt;&lt;set $edmg *= 4&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set _burn = $e.maxhea * 0.25&gt;&gt;
			&lt;&lt;eDamage _burn&gt;&gt;
				
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Headache&lt;/li&gt;
			The $npc1.species suddenly stops, doubling over in pain and grasping $npc1.his head in both hands. $npc1.He pants breathlessly for a moment, then lets out a pained scream. Slowly, $npc1.he regains what little composure $npc1.he has, looking back up to you and levelling $npc1.his wand at you again. 
			&lt;&lt;set _burn = $e.maxhea * 0.02&gt;&gt;
			&lt;&lt;eDamage _burn&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;


&lt;&lt;if $e.hea &lt;= 0 and $alive&gt;&gt;
	With the last spell&#39;s effect washing over $npc1.him, the $npc1.species lets out a pained moan, and slowly lowers $npc1.himself to the ground. $npc1.He lies down, letting out a long, relaxed sigh, and seems content to fall asleep right then and there. Looks like whatever was bothering $npc1.him got worked out of $npc1.his system with that fight. You decide you can call that a victory. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You rush up and give $npc1.him a shoulder check, which easily knocks the frail $npc1.species to the ground. Before $npc1.he can get up, you are on $npc1.him, pinning $npc1.him under you and holding $npc1.his arms against $npc1.his sides. You&#39;re not sure what eating $npc1.article $npc1.species with this much magic might do to you, but you&#39;re more than willing to find out. $npc1.He barely seems to pay attention to anything besides the headache already plaguing $npc1.him as you open your mouth wide and pull $npc1.him into it head-first. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	$npc1.He doesn&#39;t even put up a struggle as your throat closes around $npc1.his head, and you relentlessly pull $npc1.him into your hungering gullot. By the time you&#39;ve swallowed $npc1.him up to $npc1.his chest, you can feel the wild magics starting to tingle and spark inside you. You quickly gulp $npc1.him down further, forcing the $npc1.species into a ball in your stomach as you slurp down $npc1.his legs, and your $waist belly begins to thrum, buzz and vibrate violently. You hold it in your hands, giving it a pat and a rub as you wait for it to settle down. Fortunately, it isn&#39;t too much longer before it finally dies out and your belly grows still. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;if $status.int &lt; 10 or $status.mana &lt; 15&gt;&gt;
		The magical energy courses through you, spreading out from your somewhat-abused stomach, and you feel oddly over-filled on it. If this was what the $npc1.species had going on just in $npc1.his head, it&#39;s no wonder $npc1.he had such a headache. 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.intTime &lt; 60&gt;&gt;&lt;&lt;set $status.intTime = 60&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.int &lt; 10&gt;&gt;&lt;&lt;set $status.int = 10&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.manaTime &lt; 60&gt;&gt;&lt;&lt;set $status.manaTime = 60&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.mana &lt; 15&gt;&gt;&lt;&lt;set $status.mana = 15&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	$npc1.He doesn&#39;t even put up a struggle as your throat closes around $npc1.his head, and you slowly pull $npc1.him into your gullot. By the time you&#39;ve swallowed $npc1.him up to $npc1.his chest, you can feel the wild magics starting to tingle and spark inside you. You try to redouble your efforts in devouring $npc1.him, but your protesting, groaning stomach is already full enough without the addition of $npc1.article $npc1.species. You stubbornly continue to gulp $npc1.him down, but the wild magic is already starting to sting, not to mention your $waist belly beginning to feel overfull. Sucking down the last of $npc1.his legs, you can feel $npc1.him curl up into a lump in your stomach, causing painful pressure just by virtue of being there. On top of that, the violent release of magical energy is sending your belly violently vibrating and bouncing. You let out a groan, grabbing your stomach and lowering yourself to the ground. The pain, pressure, and magical sparking and thrumming send you drifting to unconsciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You raise your hands in a gesture of surrender, and reach into your pack, intending to find something to appease $npc1.him. Before you can even check, however, the $npc1.species suddenly doubles over, clutching $npc1.his head and letting out a pained scream. A bright red glow begins to emanate from $npc1.him, and it is soon followed by a tremendous magical explosion. You are caught in the deafening blast and swept off your feet by its force! 
&lt;&lt;set $edmg *= 100&gt;&gt;
&lt;&lt;damage $edmg&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Fortunately, as you stagger back to your feet, you see the $npc1.species slowly lower $npc1.himself to the ground, lying on $npc1.his back and letting out a relieved sigh. Looks like whatever was bothering $npc1.him has been worked out. You go along your way, nursing your injuries. 
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You lie on the ground, battered and sore, unwilling to keep going, but from the sounds of things, it appears that your assailant is in a similar state. You hear $npc1.him let out a relieved sigh, apparently free of whatever was causing $npc1.him such a headache, and use that as an excuse as good as any to drift into unconsciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;battle&quot;&gt;&gt;				
&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The last spell overwhelms your defense, sending you crashing to the rocky ground. You think you can hear some of your flesh sizzling as you lose consciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the $npc1.species is knocked on $npc1.his back, and lets out a pained cry. As $npc1.he tries to get back up, $npc1.he stops, letting out a moan, and lies back down. When $npc1.he is on $npc1.his back, $npc1.he lets out a long, relaxed sigh, seemingly content to just take a nap. $npc1.He appears to be in less pain than where $npc1.he started, so you decide to just leave it at that. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="57" name="manticore ai" tags="" position="4900,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
With the body of a massive feral lion, giant feathered wings, and an intimidatingly huge scorpion stinger for a tail, there&#39;s no question that this magical creature was made to &#39;change minds&#39; without mercy. Its stinger is raised, and its body is low to the ground, ready to pounce at you. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Claw&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The manticore rushes towards you and rises up on its hind legs, but you&#39;re already out of the way before it brings its claws down at you. 
			
		&lt;&lt;else&gt;&gt;
			The great beast rushes at you, rises onto its hind legs, and mauls you with its huge claws! 
			&lt;&lt;damage $edmg&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Tackle&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The creature flaps its wings and jumps through the air, but you&#39;re fast enough to duck under it and evade its huge bulk. 
			
		&lt;&lt;else&gt;&gt;
			The manticore suddenly leaps into the air, its wings beating a few times to lend it speed. You are too slow to escape, and it smashes the bulk of its body into you, sending you sprawling! 
			&lt;&lt;if random(1,100) &lt; 50&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;damage $edmg&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 3&gt;&gt;
		&lt;li&gt;Sting&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			You see the beast lower its head, and duck to the side as its stinger comes lancing towards where you were. 
			
		&lt;&lt;else&gt;&gt;
			The beast lowers its head a bit further, and suddenly its stinging tail comes lashing over top of it, jabbing you full of poison! It makes you feel sluggish, and also... full? 
			&lt;&lt;set _buff = random(-3,-6)&gt;&gt;
			&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
			&lt;&lt;set _buff *= -1&gt;&gt;
			&lt;&lt;buff &quot;bloat&quot; _buff&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;
&lt;&lt;if $agi &lt;= 0&gt;&gt;&lt;&lt;set $alive = false&gt;&gt;&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You duck under the manticore&#39;s chin and plow your head into it, giving it a vicious headbutt and sending it staggering. As it attempts to find its footing, you duck behind it, grasping the end of its stinging tail and carefully shoving it into your mouth and down your throat. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	With the major problem hopefully handled, you work your way down its insectoid tail, feeling it curl up in your stomach. The beast regains its senses about the time you are working your mouth around its rump. It lets out a panicked growl, trying to crawl away from you, but as the tops of its rear legs enter your mouth, you aren&#39;t about to let it get away. Slowly but surely, you take more and more of the giant cat-beast into your mouth and down your throat, your belly bulging with its furred mass. You have to grab and pin its wings to get them into your maw, and when you reach its front legs, the beast&#39;s shoulders prove surprisingly broad, but your tenacity has you swallowing them down as well. The chimera gives a groan as you rapidly gulp down its neck, then head, and with a few more swallows, you have the whole thing inside your $waist belly. Hopefully things won&#39;t be too bad once you start digesting the poison... 
	&lt;&lt;buff &quot;bloat&quot; 10&gt;&gt;
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return to the wizard&quot; &quot;Manticore defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	As you slowly work your way down its insectoid tail, you have to pause to give your belly a rest, and unfortunately, the manticore comes to its senses before you&#39;ve fully downed it. You can feel a poke on the inside of your stomach, and you can feel it bulging further even as you begin to gulp down the beast&#39;s hind quarters. You&#39;re already feeling painfully full as its thick limbs slide down your throat and make a home in your belly, but you&#39;ve gone too far to stop, and are helpless to do anything but swallow again and again, more and more of the manticore becoming a huge bulge in your midsection. You&#39;re lying on your back and rubbing at your groaning stomach even as you swallow down its shoulders, and when the rest of its body slides easily into your stuffed belly, you can&#39;t do anything but moan in pain, the immense pressure a sure sign that this meal was too much for you. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower yourself to the ground and bow your head, unwilling to fight any further. From above, the $npc2.species&#39;s voice rings out again, &quot;Good! I knew I could convince you.&quot; The manticore pounces at you, but before it can eat you, you are transported again, this time to a sterile, well-lit chamber. Beside you is an extremely obese $npc3.species munching on handfuls of grain scooped out of a large bag. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;The experiment begins&quot; &quot;Begin the Wizard&#39;s experiment&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The manticore proves too much for you to handle, and the pain and poison send you sprawling to the ground. It marches over to you and opens its mouth, rows of pointed teeth glinting above you, when you suddenly hear the wizard call out, &quot;I think I&#39;ve made my point.&quot; The world blurs just before the creature sets on you to devour you, and you find yourself just able to stand. It appears you&#39;ve been moved to a sterile, well-lit chamber. Beside you is an extremely overweight $npc3.species eating handful after handful of grain, which he takes from a large bag beside $npc3.him. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;The experiment begins&quot; &quot;Begin the Wizard&#39;s experiment&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the beast lets out a moan of pain, then collapses onto its side, its heavy chest rising and falling in panting breaths. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return to the wizard&quot; &quot;Manticore defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; true&gt;&gt;
	/* Custom ending */
	&lt;&lt;if $e.ate &gt; $e.sto&gt;&gt; /* defeated */
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return to the wizard&quot; &quot;Manticore defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="58" name="mountainous tiger ai" tags="" position="5150,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
$npc1.Article $npc1.species of obscene muscularity bears down on you, $npc1.teeth bared. Save $npc1.his loincloth, you can see that every inch of $npc1.him has been toned and filled to bursting, forcing $npc1.his arms up and $npc1.his legs apart. $npc1.His $npc1.hands begin to burn with a blue arcane fire, which travels up $npc1.his forearms. You may have bitten off more than you can chew... 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Punch&lt;/li&gt;
	With you pinned, the $npc1.species contents $npc1.himself to punching your stomach as many times as $npc1.he can. 
	&lt;&lt;damage $edmg&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,4)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Quake&lt;/li&gt;
			The $npc1.species lifts one of $npc1.his overswollen legs into the air, before slamming it down with magical force. 
			&lt;&lt;if setup.dodge()&gt;&gt;
				You quickly adjust your center of gravity, deftly avoiding slabs of earth that had erupted from the ground. 
				
			&lt;&lt;else&gt;&gt;
				You completely lose your footing just in time for a slab of rock to blast out of the ground, slamming into your stomach and knocking the wind out of you. 
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Backhand&lt;/li&gt;
			The $npc1.species lets $npc1.his $npc1.hand fly, $npc1.his magic reshaping around it into a much larger $npc1.hand. 
			&lt;&lt;if setup.dodge()&gt;&gt;
				You manage to just barely sidestep the exaggerated swipe, angling away just as the $npc1.hand sweeps past you. 
				
			&lt;&lt;else&gt;&gt;
				&lt;&lt;if $fat + $tfat &gt; 30&gt;&gt;
					The force of the impact sends you tumbling, and you feel lighter, as if the $npc1.species just slapped the fat out of you. 
					&lt;&lt;set _buff = random(2,4)&gt;&gt;
					&lt;&lt;tempBuff &quot;agi&quot; _buff&gt;&gt;
					&lt;&lt;tempBuff &quot;fat&quot; -30&gt;&gt;												
					
				&lt;&lt;else&gt;&gt;
					The force of the impact sends you tumbling. 
					
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
					
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Arcane Blast&lt;/li&gt;
			The $npc1.species slaps $npc1.his paws together, firing a ball of arcane fire squarely at your gut. 
			&lt;&lt;if setup.dodge()&gt;&gt;
				You duck and tumble, the ball of fire grazing your $p.fur before it flies into the distance. 
				
			&lt;&lt;else&gt;&gt;
				Too slow to dodge, the magic slams into you with excessive force, sweeping you off your $p.feet and onto your back. 
				&lt;&lt;if $fat + $tfat &gt; 30&gt;&gt;
					Aside from the pain, you feel different, as if $npc1.he somehow blasted your fat out of you. 
					&lt;&lt;set _buff = random(2,4)&gt;&gt;
					&lt;&lt;tempBuff &quot;str&quot; _buff&gt;&gt;
					&lt;&lt;tempBuff &quot;fat&quot; -30&gt;&gt;	
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 4&gt;&gt;
			&lt;li&gt;Body Slam&lt;/li&gt;
			The $npc1.species squats down, before launching $npc1.himself in the air, $npc1.his body clearly not just for show. 
			&lt;&lt;if setup.dodge()&gt;&gt;
				You dive away just in time, the $npc1.species crashing to the ground with enough force to make a deep indent. $npc1.He&#39;s back up to $npc1.his feet in only a second. 
				
			&lt;&lt;else&gt;&gt;
				You are caught off guard as several tons of $npc1.species muscle slams into you from above. 
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
				&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You decide it&#39;s time the $npc1.species saw what it felt like to be stuffed away. Slipping in close, you wait for $npc1.him to slap $npc1.his $npc1.hands together, before swiftly dodging the magic and getting your maw around $npc1.his $npc1.color $npc1.hands, holding $npc1.his wrists in your $p.teeth as you pull back, making $npc1.him lose $npc1.his footing, before you suck $npc1.him up to $npc1.his elbows. $npc1.He begins to roar and writhe, and you can feel $npc1.his magic seeping into you, eating away at your fatness, but imbuing you with a rush of strength, easily enough to keep pulling the $npc1.adjective in. $npc1.He starts to yell, &quot;NO! I won&#39;t be just another meal! I refuse to be nothing but a layer of fat on a nobody like y-rfnrnf!&quot; $npc1.His voice is cut off as your maw swallows past $npc1.his head, silencing $npc1.him as your maw gapes to its limits to get past the beast&#39;s shoulders. Once beyond that, $npc1.his body seems to force itself into you as $npc1.his torso slims, only to be stopped again by $npc1.his enormous rump and tree-trunk legs. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Getting your second wind, you open wide once again, steadily and hungrily working over $npc1.his backside, focusing intently on $npc1.his legs, working them in inch by inch,&lt;&lt;if $npc1.nspecies == &quot;tiger&quot;&gt;&gt; stripe after stripe&lt;&lt;/if&gt;&gt; before finally you manage to get those big, $npc1.feetColor-$npc1.furred $npc1.feet into your maw, forcibly shoving them down with your $p.hand. Proud of yourself, you flop back onto your rump, ready for digestion, before your gut starts to grumble, there is a surge of power, before you feel your entire stomach give a lurch, and the form inside starts to reshape. You feel yourself filling up even more. Confused, you let forth a belch, and realize that the flavor you&#39;re tasting isn&#39;t $npc1.species at all! It tastes like two or three other anthros. The $npc1.species must have teleported out of your belly, only to replace $npc1.himself with some of what $npc1.he&#39;d caught, and then some! 
	&lt;&lt;consume 360 216&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		You start to feverishly rub at your gut, before you feel yet another anthro appear in your stomach, and then another, and another! Your gut becomes so full and heavy that it pins you to the ground, to the point that you can&#39;t even see over it. The only thing keeping you going is all the struggling. You sigh with contentment as you reailze you can actually hold this meal. It&#39;s a long time before all that movement dies down, but it does. You give you swollen midsection a loving pat, before heaving yourself up. It finally dawns on you that both the $npc1.species and $npc1.his bag have long since disappeared, but at least you got quite the meal out of this! 
		&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
		&lt;&lt;set $cal += _calories&gt;&gt;
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		Just the $npc1.species alone was difficult enough, but this is outright impossible. You think maybe you can keep control, only to feel the rushing sensation of yet -another- fatty appearing in your belly, followed by another, and another! You desperately wriggle as you are pinned to the ground by your growing meal, and with one more lurch, you feel yourself be completely overwhelmed. 
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	Unfortunately, by this point you&#39;re already as full as you can get, and there&#39;s no way you can polish off the second half of this meal. Sensing your pause, you can feel the magic surge again within you, only this time the $npc1.species seems to mean business. The world seems to shift, and before you even know what happened, you&#39;ve traded places. You can feel the hot, powerful confines of the $npc1.species&#39;s gut around you, and your rump being hoisted high into the air, framed by the $npc1.species&#39;s $npc1.teeth. Unlike you, though, $npc1.he has no problem working your waistline down, and less than no trouble keeping your legs together as $npc1.he forces you completely into $npc1.him. $npc1.He gives your feet one final, taunting lick before gulping them down. You curl up into a ball, completely disoriented, before you can feel the $npc1.species giving $npc1.his gut a few powerful pats. $npc1.He makes a show of licking $npc1.his chops, growling assertively. Before losing consciousness, the last thing you hear is: &quot;You&#39;re gonna make some great muscle...&quot; 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
Working both $npc1.his weight and yours to your advantage, you manage to get out from under $npc1.him as $npc1.he tumbles to the ground. 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
Despite your best efforts, the $npc1.species keeps you firmly trapped beneath $npc1.his bulk, content to keep wailing on you. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
Realizing you really have bitten off more than you can chew, you wait for an opening in $npc1.his attacks, before tripping $npc1.him up with your weapon, sending $npc1.him to the ground. By the time $npc1.he&#39;s back up, you&#39;ve already put a good deal of distance between the both of you. $npc1.He gives a start, preparing to give chase, before letting out an echoing growl and going back to $npc1.his bag. Seems you weren&#39;t worth risking $npc1.his catch. 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
Deciding to cut your losses, you attempt to give the $npc1.adjective the slip. You only make it a few yards before a blast of blue fire erupts in front of you as the $npc1.species teleports squarely in your line of escape. &quot;Going somewhere?&quot; $npc1.He growls. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
With no interest to be pummelled further, you drop to your knees and throw up your $p.hands. &quot;Smart move.&quot; The $npc1.species says, smiling proudly. $npc1.He puts $npc1.his enormous $npc1.color $npc1.hand on your face. &quot;Though. I&#39;m full up, and I can&#39;t have you following me.&quot; The world around you seems to be consumed in blue flame, and you feel as if you&#39;re falling endlessly through darkness. With a soft thud, you collapse onto a bed, the world around you coming back into focus, all of it feeling as if you&#39;d had a very strange dream. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
With a groan, you feel your knees give way. You slump to the ground, and can hear the $npc1.species step up to your defeated body. &quot;Pathetic.&quot; $npc1.He grunts, before stepping away, letting you slip out of consciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With a roar of pain and frustration, the $npc1.species swears at you. &quot;Fine, you win!&quot; But before you can stop $npc1.him, $npc1.he&#39;s summoned a bright flash of light, and like that, both $npc1.him and the black sack full of fatties is gone. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="59" name="muscle fur ai" tags="" position="5275,875" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your path is suddenly crossed by a lumbering hulk of $npc1.article $npc1.species. $npc1.He is exceptionally large, in height, musculature, and weight, $npc1.his massive belly easily being a third of $npc1.his mass, and is dragging something that could be called a club, but would be better described as a small tree. Upon spotting you, $npc1.he rumbles in a deep voice, &quot;Eat more... Get bigger... Eat YOU... GET BIGGER!&quot; $npc1.he rushes you, mouth open wide and club raised! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Devour&lt;/li&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			You push with all your might, but just can&#39;t manage to budge the monstrous $npc1.species&#39;s powerful arms. 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;case 1&gt;&gt;
			Things go from bad to worse as $npc1.his open mouth comes rushing down at you... 
			&lt;&lt;set $e.special--&gt;&gt;
			
		&lt;&lt;default&gt;&gt;
			Unable to escape, you are helpless as the massive $npc1.species takes you into $npc1.his mouth, your entire head fitting neatly in $npc1.his slobbering maw. $npc1.He adjusts $npc1.his grip on you, grabbing your waist to pick you up and force you further into $npc1.his mouth, which stretches to accomodate you. $npc1.his jaw unhinges as you are thrust into the squeezing, wet prison of $npc1.his throat, your pushing against $npc1.him proving fruitless. Effortlessly, $npc1.he flips you upwards and pulls at you, your descent down $npc1.his gullet suddenly becoming extremely quick. In a matter of moments, you are in $npc1.his belly. For as voluminous as $npc1.his gut looked on the outside, it&#39;s a very tight fit that doesn&#39;t even leave room to struggle as $npc1.his stomach walls begin to squeeze down around you. The crushing process of digestion and lack of air soon robs you of consciousness. 
			&lt;hr&gt;
			&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;							
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $hea/$maxHea &lt; 0.25 or $e.hea/$e.maxhea &lt; 0.15 and random(1,3) == 1&gt;&gt;
		&lt;li&gt;Grab&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			You notice just in time that $npc1.he has gotten quite a bit closer to you than before, and back off just as $npc1.he lunges forth and swings both arms in to grab at you. 
			
		&lt;&lt;else&gt;&gt;
			Before you notice that $npc1.he has gotten much closer than is comfortable, $npc1.he suddenly lunges at you, wrapping $npc1.his gigantic arms around you. Your bones creak under $npc1.his immensely strong grip as $npc1.he prepares to pull you into $npc1.his gaping mouth! 
			&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
			&lt;&lt;set $e.special = 2&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if random(1,2) == 1&gt;&gt;
			&lt;li&gt;Smash&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				$npc1.He starts to swing $npc1.his club, but $npc1.his wide swing telegraphs the attack, and you swiftly evade. 
				
			&lt;&lt;else&gt;&gt;
				With a violent motion, $npc1.he twists $npc1.his whole body around in a massive swing. $npc1.His club catches you in the side, and the impact sends you tumbling! 
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Bite&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				$npc1.He lunges at you greedily, jaws wide to take a bite out of you, but $npc1.he overextends and you are able to avoid $npc1.him. 
				
			&lt;&lt;else&gt;&gt;
				$npc1.He suddenly lunges for you, jaws wide open. It&#39;s not enough to devour you whole, but $npc1.he does take a nasty bite out of you! 
				&lt;&lt;damage $edmg&gt;&gt;
				
			&lt;&lt;/if&gt;&gt;				
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You suddenly strike the great $npc1.species in $npc1.his stomach, knocking the wind out of $npc1.him and making $npc1.him double over. Seizing the opportunity, you grab $npc1.his shoulders, open your mouth wide, and lunge forward on $npc1.him. $npc1.He lets out a surprised grunt, then $npc1.his head is engulfed by your mouth. Though $npc1.he pushes back at you with tremendous strength, you aren&#39;t about to let a good meal get away. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	Your jaw unhinges as you force your way down to $npc1.his thick neck, lowering your grip to $npc1.his hips to get a better angle as you pull $npc1.him down your throat. You can hear muffled grunts and wordless yells as $npc1.his shoulders enter your stretched mouth. Pinning $npc1.his arms to the side, you force yourself down on $npc1.his massive torso, your stomach already stretching out with the giant $npc1.species. As you lift $npc1.him up to swallow $npc1.him down past $npc1.his hips, your stretched belly jostles violently, the $npc1.species struggling inside you to no avail. You lift your head up to slurp down the last of $npc1.his legs, and with a few more swallows, the giant $npc1.species is a giant bulge in your $waist midsection. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;if $status.sto &lt; 10 and $status.str &gt;= 10&gt;&gt;
		As $npc1.his struggling dies down, you can feel an odd magical tingling start to spread through you. It seems that whatever spell was on $npc1.him has started to bleed through into you. The urge to eat even more starts to fill your mind. No wonder $npc1.he was so eager... 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.sto &lt; 10 and $status.str &lt; 10&gt;&gt;
		As $npc1.his struggling dies down, you can feel an odd magical tingling start to spread through you. It seems that whatever spell was on $npc1.him has started to bleed through into you. The urge to eat even more starts to fill your mind, and you feel the magic bolstering your strength. No wonder $npc1.he was so eager... 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.str &lt; 10 and $status.sto &gt;= 10&gt;&gt;
		As $npc1.his struggling dies down, you can feel an odd magical tingling start to spread through you. It seems that whatever spell was on $npc1.him has started to bleed through into you. You feel the magic bolstering your strength. No wonder $npc1.he was so eager... 							
	&lt;&lt;/if&gt;&gt;							
	&lt;&lt;if $status.stoTime &lt; 60&gt;&gt;&lt;&lt;set $status.stoTime = 60&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.sto &lt; 10&gt;&gt;&lt;&lt;set $status.sto = 10&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.strTime &lt; 60&gt;&gt;&lt;&lt;set $status.strTime = 60&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.str &lt; 10&gt;&gt;&lt;&lt;set $status.str = 10&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;updateStats&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	Your jaw unhinges as you force your way down to $npc1.his thick neck, lowering your grip to $npc1.his hips to get a better angle as you pull $npc1.him down your throat. You can hear muffled grunts and wordless yells as $npc1.his shoulders enter your stretched mouth. Pinning $npc1.his arms to the side, you force yourself down on $npc1.his massive torso, your stomach already stretching out with the giant $npc1.species. You&#39;re already starting to regret this decision, and you&#39;re able to tell this will be too much even before $npc1.he starts making things worse by violently thrashing about in your soon-to-be overstuffed belly. Already past the point of no return, $npc1.his legs begin to slide down your throat, and you fall onto your bottom, nursing your swelling stomach as it fills incessantly with entirely too much $npc1.species. When the last of $npc1.him falls into your gut, you hiccup and groan, lowering yourself to your back. The painful shaking of the great $npc1.species inside you doesn&#39;t die down nearly fast enough, and the pressure is enough to send you off to unconsciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
Grunting with effort, you pry the twisted $npc1.species monster&#39;s arms off of you just long enough to escape $npc1.his grasp. Not a moment too soon, as $npc1.his mouth comes plunging down, teeth clacking as they snap shut where your head once was! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You lower yourself to all fours, unwilling to fight any further. The massive $npc1.species lets out a pleased sounding groan as $npc1.he grabs you by your waist to pick you up. You are forced headfirst into $npc1.his slobbering maw, the $npc1.species rumbling happily the whole time. $npc1.His jaw unhinges as you are thrust into the squeezing, wet prison of $npc1.his throat, your pushing against $npc1.him proving fruitless. Effortlessly, $npc1.he flips you upwards and pulls at you, your descent down $npc1.his gullet suddenly becoming extremely quick. In a matter of moments, you are in $npc1.his belly. For as voluminous as $npc1.his gut looked on the outside, it&#39;s a very tight fit that doesn&#39;t even leave room to struggle as $npc1.his stomach walls begin to squeeze down around you. The crushing process of digestion and lack of air soon robs you of consciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
With $npc1.his last attack, you stumble, stagger, and collapse to the ground. The $npc1.species lets out a pleased, wordless groan before descending upon your fallen form. $npc1.He grabs you under the arms, $npc1.his grip steely and inescapable, and shoves you into $npc1.his slobbering maw. $npc1.His mouth stretches to accomodate you, jaw unhinging as you are thrust into the squeezing, wet prison of $npc1.his throat. Effortlessly, $npc1.he flips you upwards and pulls at you, your descent down $npc1.his gullet suddenly becoming extremely quick. In a matter of moments, you are in $npc1.his belly. For as voluminous as $npc1.his gut looked on the outside, it&#39;s a very tight fit that doesn&#39;t even leave room to struggle as $npc1.his stomach walls begin to squeeze down around you. Between the pounding you took and the digestion processes, you soon lose consciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the giant $npc1.species crashes to $npc1.his knees, letting out a low moan and reaching towards you before falling on $npc1.his face. Looks like you&#39;ve put an end to $npc1.his rampage. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;hunter&quot; false &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="60" name="royal guard wasp ai" tags="" position="5400,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
An ordinary $npc1.species is bad enough, but this one is bigger than some houses you&#39;ve seen in the city. It hovers expertly and waves its stinger at you, which is not only massive, but drips with some sort of nasty poison. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;li&gt;Tackle&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The $npc1.species streaks towards you, but you duck out of its way before it collides with you. 
		&lt;&lt;else&gt;&gt;
			The $npc1.species dashes through the air and plows into you with its chitinous torso, stunning you! 
			&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;case 2&gt;&gt;
		&lt;li&gt;Envenom&lt;/li&gt;
		The $npc1.species suddenly flicks its stinger at you, a surprisingly voluminous spray of its poison spattering all around. It slowly starts to burn where it touches your skin, the pain intensifying with each passing moment! 
		&lt;&lt;buff &quot;poison&quot; 3&gt;&gt;
		
	&lt;&lt;case 3&gt;&gt;
		&lt;li&gt;Sting&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			The $npc1.species launches itself at you stinger-first, but a combination of a parry and a partial dodge keeps you safe from its venomous pierce. 
		&lt;&lt;else&gt;&gt;
			The $npc1.species jabs its stinger at you, piercing your armor and stabbing into your flesh. Its poison makes the wound even more painful, and it&#39;s getting worse by the second! 
			&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;buff &quot;poison&quot; 6&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You decide that you don&#39;t want to fight any more and lower your defenses, hoping to get this over with quickly. The $npc1.species seizes the advantage and impales you on its stinger, the huge amount of poison overwhelming your body and leaving you unable to move. Though you are wracked with pain, you can still see the relatively small insects tending to the queen come over to you and crawl beneath you. As they congregate beneath you, you are dragged into the queen&#39;s chamber, at which point a flying insect picks you up. In a manner almost choreographed, you are buzzed over to the great, unmoving, somehow fat looking bloated insect&#39;s head. It opens its mandibles, and you are dropped into its mouth and swallowed easily. The buzzing of the hive becomes muted as you are engulfed by its innards, and the squeezing of its stomach on you causes you to finally lose consciousness. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The pain, poison, and blood loss prove to be too much and you fall to the ground, thoroughly beaten. 

&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With a hideous insectoid screech, the $npc1.species falls to the ground, its limbs twitching before slowing to a halt. You have defeated the guardian insect and are free to advance to the queen insect&#39;s chamber.
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Claim reward&quot; &quot;Wasp Defeated&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="61" name="smarty ai" tags="" position="5650,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This robed $npc1.male $npc1.species has a slightly large head that appears to be throbbing. $npc1.He has one $npc1.hand on it, rubbing it gently, and the other pointing a wand at you. From the looks of things, $npc1.he has a headache and you just hurt $npc1.his giant &lt;&lt;=$npc2.boy&gt;&gt;friend. This could get ugly. 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $e.hea &lt;= $e.maxhea/3 and $e.hea &gt; 1&gt;&gt;
	&lt;li&gt;Calamity&lt;/li&gt;
	The $npc1.species utters a curse, glaring at you for a moment before staring at a point directly in front of $npc1.him. $npc1.His $npc1.hands shake as $npc1.he focuses, and a brilliantly shining bead appears in front of $npc1.him. &quot;Goodbye, troublemaker,&quot; $npc1.he growls, then reaches out and touches the bead with $npc1.his wand. Before you can react, the world is replaced with a tumult of roiling magical energies, a massive explosion engulfing the two of you! 	
	&lt;&lt;damage 1000&gt;&gt;
	&lt;&lt;eDamage $e.hea - 1&gt;&gt;
	&lt;&lt;eBuff &quot;stun&quot; 3&gt;&gt;
	&lt;&lt;eBuff &quot;slow&quot; 3&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	&lt;&lt;switch random(1,3)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;li&gt;Flame Leviathan&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species throws $npc1.his arm in a wild circle, then points at you through it. You, however, have gotten on the far side of the cave entrance and are only made uncomfortably hot when an enormous, fiery serpent flies through the air, roaring past you. When it passes, you duck back inside. 
			&lt;&lt;else&gt;&gt;
				The $npc1.species throws $npc1.his arm in a wild circle, then points at you through it. An enormous gout of fire erupts from the air, taking the form of a roaring serpent. Its maw opens wide as it flies forth and engulfs you, its long body forming a tunnel of flames that scorch you as it passes! 
				&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;if random(1,100) &lt; 75&gt;&gt;
					&lt;&lt;set _buff = Math.round($edmg * 0.1)&gt;&gt;
					&lt;&lt;tempBuff &quot;burn&quot; _buff&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 2&gt;&gt;
			&lt;li&gt;Avalanche&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				The $npc1.species holds an arm out towards you, fingers curled. With a hiss, several boulders of ice congeal around you, but you fortunately spot a gap you can fit through. As $npc1.he clenches $npc1.his $npc1.hand into a fist, you dive between them, narrowly escaping being crushed and frozen, as the ice blocks slam together and burst. 
			&lt;&lt;else&gt;&gt;
				The $npc1.species holds an arm out towards you, fingers curled. With a hiss, several boulders of ice congeal around you, blocking all sides of you. Before you can figure out how to escape, $npc1.he clenches $npc1.his $npc1.hand into a fist, and the boulders smash into you, then burst in frigid blasts! 
				&lt;&lt;set $edmg *= 1.5&gt;&gt;
				&lt;&lt;damage $edmg&gt;&gt;
				&lt;&lt;if random(1,100) &lt; 20&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case 3&gt;&gt;
			&lt;li&gt;Heaven&#39;s Lightning&lt;/li&gt;
			The $npc1.species takes a knee, holding $npc1.his $npc1.hand in front of $npc1.his face and uttering an invokation to the gods. As $npc1.he finishes, $npc1.he points accusatively at you. The clouds part outside, giving way to a brilliant, shimmering light. As you look out, an enormous bolt of lightning strikes you, the light blinding and the crack of thunder deafening! 
			&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;if random(1,100) &lt; 30&gt;&gt;&lt;&lt;tempBuff &quot;stun&quot; 1&gt;&gt;&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
	
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You hold up your $p.hands in submission, not wanting to be on $npc1.Name&#39;s bad side, but this only seems to make $npc1.him angrier. &quot;You think you can just attack $npc2.Name and everything&#39;ll be fine?!&quot; $npc1.he yells, $npc1.his head throbbing more visibly. &quot;GET OFF MY MOUNTAIN!&quot; $npc1.he bellows, pointing $npc1.his wand at you. This proves to not be a request as a magical force bursts out at you, sending you flying! You crash back down to the rocks below, sliding and bouncing as you go further and further down the mountain&#39;s steep side. You can&#39;t bring yourself to a halt until well after you&#39;ve hit the base of it. You slowly get to your feet, rubbing at your bruises before staggering off to find somewhere else to explore. Maybe $npc1.he&#39;ll cool down a bit later... 
&lt;&lt;set _damage = $hea - 1&gt;&gt;
&lt;&lt;damage _damage&gt;&gt;
&lt;&lt;set $alive = true&gt;&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
As the last spell smashes into you, you are sent crashing to the ground, unable to put up any more resistance. Before you lose consciousness, you hear $npc1.Name ask, &quot;Was that really necessary?&quot; 
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
$npc1.Name falls to $npc1.his knees, a look of disbelief on $npc1.his face. &quot;How...&quot; $npc1.he starts, then collapses to the ground, groaning in pain. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Defeated Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false&gt;&gt;
	/* Custom ending */
	&lt;&lt;if $e.ate &gt; $e.sto&gt;&gt; /* defeated */
		&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Defeated Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="62" name="snookums ai" tags="" position="5525,1000" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
This giant and giant-muscled $npc1.species $npc1.male is very angry at you for trying to leave without permission, and the way $npc1.he holds $npc1.his stone mace makes it clear how $npc1.he handles things that make $npc1.him angry! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if $grapple &gt; 0&gt;&gt;
	&lt;li&gt;Devour&lt;/li&gt;
	&lt;&lt;switch $e.special&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			Unable to escape, you are helpless as the massive $npc1.species takes you into $npc1.his mouth, your entire head fitting neatly in $npc1.his maw. 
			&lt;&lt;set $e.special--&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			$npc1.He adjusts $npc1.his grip on you, grabbing your waist to pick you up and force you further into $npc1.his mouth, which stretches to accomodate you. 
			&lt;&lt;set $e.special--&gt;&gt;
		&lt;&lt;case 0&gt;&gt;
			$npc1.His jaw unhinges as you are thrust into the squeezing, wet prison of $npc1.his throat, your pushing against $npc1.him proving fruitless. Effortlessly, $npc1.he flips you upwards and pulls at you, your descent down $npc1.his gullet suddenly becoming extremely quick. In a matter of moments, you are in $npc1.his belly. For as voluminous as $npc1.his gut looked on the outside, it&#39;s a very tight fit that doesn&#39;t even leave room to struggle as $npc1.his stomach walls begin to squeeze down around you. Before you lose consciousness, you hear a $npc2.male voice say &quot;$npc1.Name, did you eat a new arrival?&quot; You can hear $npc1.him let out a guilty, affirmative grunt, then the voice responds, &quot;$npc1.Name, I told you not to do that.&quot; 
			&lt;hr&gt;
			&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $e.hea &lt;= $e.maxhea * 0.5 and random(1,3) == 3&gt;&gt;
		&lt;li&gt;Grab&lt;/li&gt;
		&lt;&lt;if setup.dodge()&gt;&gt;
			You notice just in time that $npc1.he has gotten quite a bit closer to you than before, and back off just as $npc1.he lunges forth and swings both arms in to grab at you. 
		&lt;&lt;else&gt;&gt;
			Before you notice that $npc1.he has gotten much closer than is comfortable, $npc1.he suddenly lunges at you, wrapping $npc1.his gigantic arms around you. Your bones creak under $npc1.his immensely strong grip as $npc1.he prepares to pull you into $npc1.his gaping mouth! 
			&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
			&lt;&lt;set $e.special =  2&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if random(1,2) == 1&gt;&gt;
			&lt;li&gt;Smash&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				$npc1.He starts to swing $npc1.his club, but $npc1.his wide swing telegraphs the attack, and you swiftly evade. 
			&lt;&lt;else&gt;&gt;
				With a violent motion, $npc1.he twists $npc1.his whole body around in a massive swing. $npc1.His mace catches you in the side, and the impact sends you tumbling! 
				&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Bite&lt;/li&gt;
			&lt;&lt;if setup.dodge()&gt;&gt;
				$npc1.He lunges at you greedily, jaws wide to take a bite out of you, but $npc1.he overextends and you are able to avoid $npc1.him. 
			&lt;&lt;else&gt;&gt;
				$npc1.He suddenly lunges for you, jaws wide open. It&#39;s not enough to devour you whole, but $npc1.he does take a nasty bite out of you! 
				&lt;&lt;damage $edmg&gt;&gt;
			&lt;&lt;/if&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
Grunting with effort, you pry the twisted $npc1.species monster&#39;s arms off of you just long enough to escape $npc1.his grasp. Not a moment too soon, as $npc1.his mouth comes plunging down, $npc1.teeth clacking as they snap shut where your head once was! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You push with all your might, but just can&#39;t manage to budge the monstrous $npc1.species&#39;s powerful arms. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You hold up your hands in surrender, not wanting to fight the massive $npc1.species. $npc1.He nods and lets out a grunt, then leads you inside. 
&lt;&lt;endCombat&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;talk&quot; &quot;Talk to Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
With $npc1.his last attack, you stumble, stagger, and collapse to the ground. The $npc1.species lets out a pleased, wordless groan before descending upon your fallen form. $npc1.He grabs you under the arms, $npc1.his grip steely and inescapable, and shoves you into $npc1.his maw. $npc1.His mouth stretches to accomodate you, jaw unhinging as you are thrust into the squeezing, wet prison of $npc1.his throat. Effortlessly, $npc1.he flips you upwards and pulls at you, your descent down $npc1.his gullet suddenly becoming extremely quick. In a matter of moments, you are in $npc1.his belly. For as voluminous as $npc1.his gut looked on the outside, it&#39;s a very tight fit that doesn&#39;t even leave room to struggle as $npc1.his stomach walls begin to squeeze down around you. Before you lose consciousness, you hear a $npc2.male voice say &quot;$npc1.Name, did you eat a new arrival?&quot; You can hear $npc1.him let out a guilty, affirmative grunt, then the voice responds, &quot;$npc1.Name, I told you not to do that.&quot; 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, $npc1.he doubles over, groaning in pain, and grunts out &quot;$npc2.Name&quot; before collapsing to the ground. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Defeated snookums&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;resister&quot; false&gt;&gt;
	/* Custom ending */
	&lt;&lt;if $e.ate &gt; $e.sto&gt;&gt; /* defeated */
		&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Defeated snookums&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="63" name="soldier ant ai" tags="" position="4775,875" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
As you hike along the side of a mountain, you come across a line of $npc1.plural marching in formation. This wouldn&#39;t be particularly noteworthy if they weren&#39;t the size of housecats and carrying away what looks to be an entire banquet. Several of them turn to you, mandibles flexing in a threatening manner. 

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;set _antsLeft = Math.ceil($e.hea / 50)&gt;&gt;
&lt;&lt;set _poisonStacks = 0&gt;&gt;
&lt;&lt;set _damage = 0&gt;&gt;

&lt;li&gt;Swarm&lt;/li&gt;
&lt;&lt;for _i = 1;_i &lt;= _antsLeft;_i++&gt;&gt;
	&lt;&lt;if setup.dodge()&gt;&gt;
			$npc1.Article $npc1.species crawls on you, but you shake it off before it can hurt you. 
		
	&lt;&lt;else&gt;&gt;
		&lt;&lt;doEdmg&gt;&gt;
		&lt;&lt;if random(1,2) == 1&gt;&gt;
			$npc1.Article $npc1.species crawls up you, finding a weakness in your defenses, and bites you! 
			&lt;&lt;set _damage += $edmg&gt;&gt;
			&lt;&lt;if random(1,100) &lt; 20&gt;&gt;&lt;&lt;set _poisonStacks += random(1,2)&gt;&gt;&lt;&lt;/if&gt;&gt;
				
		&lt;&lt;else&gt;&gt;
			You feel a stabbing pain and look just in time to see $npc1.article $npc1.species stinging your body! 
			&lt;&lt;set _damage += $edmg * 0.7&gt;&gt;
			&lt;&lt;if random(1,100) &lt; 70&gt;&gt;&lt;&lt;set _poisonStacks += random(1,3)&gt;&gt;&lt;&lt;/if&gt;&gt;
				
		&lt;&lt;/if&gt;&gt;
			
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/for&gt;&gt;

&lt;&lt;if _damage &gt; 0&gt;&gt;&lt;&lt;damage _damage&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if _poisonStacks &gt; 0&gt;&gt;
	A burning pain spreads outward from your wounds. 
	&lt;&lt;buff &quot;poison&quot; _poisonStacks&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You decide to stop resisting, and lower yourself to your hands and knees. Being creatures of raw instinct, the $npc1.plural climb on you and give you a few more bites and stings for your trouble. Their poison causes you to slump the rest of the way to the ground, the world becoming a painful haze. You awaken somewhere dark, the sound of insects all around you. At first it feels like you&#39;re hovering over the ground, but the lumps underneath you make it clear, after a few moments to gather your senses, that you&#39;re being carried by some of the $npc1.plural you fought. It hurts too much to move, and you can only watch as they carry you past a giant abomination of &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).article&gt;&gt; &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt; and into a large, waxy chamber. In the low light, you can just make out the massive, bloated form of some kind of queen insect, its relatively tiny legs wriggling uselessly under its bulk. A buzzing above you heralds what look to be a few large &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).plural&gt;&gt; hovering down to grab you. They lift you up to the queen&#39;s head, and it opens its mandibles greedily. With exceptional accuracy, you are dropped into the queen&#39;s mouth, and swallowed down without a fuss. The buzzing and chittering of insects is muffled as the queen&#39;s stomach begins to churn upon you. The pressure on your injuries and poisoned insides is enough to send you back to unconsciousness in short order. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Grunting and swearing, you desperately try to get the $npc1.plural off of you, but the combination of bleeding bites and envenomed limbs sends you crashing to the ground. It only gets worse, more and more nasty pain piling up before you finally lose consciousness. You awaken somewhere dark, the sound of insects all around you. At first it feels like you&#39;re hovering over the ground, but the lumps underneath you make it clear, after a few moments to gather your senses, that you&#39;re being carried by some of the $npc1.plural you fought. It hurts too much to move, and you can only watch as they carry you past a giant abomination of &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).article&gt;&gt; &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt; and into a large, waxy chamber. In the low light, you can just make out the massive, bloated form of some kind of queen insect, its relatively tiny legs wriggling uselessly under its bulk. A buzzing above you heralds what look to be a few large &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).plural&gt;&gt; hovering down to grab you. They lift you up to the queen&#39;s head, and it opens its mandibles greedily. With exceptional accuracy, you are dropped into the queen&#39;s mouth, and swallowed down without a fuss. The buzzing and chittering of insects is muffled as the queen&#39;s stomach begins to churn upon you. The pressure on your injuries and poisoned insides is enough to send you back to unconsciousness in short order. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the last $npc1.species aggressor falls, knocked onto its back and legs twitching in the air. The others seem far less interested in fighting, picking up the pace and dashing off in all directions, finding a stunning number of nooks and crannies to carry their food into. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="64" name="thin fur ai" tags="" position="4900,875" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
As you explore the mountains, a thin shell of $npc1.article $npc1.species staggers across your path, holding $npc1.his stomach. Surprisingly, it is flat, though given that $npc1.he is currently taking the last few bites of what looks to have been an entire hock of ham, that seems very unusual. &quot;Never lasts,&quot; $npc1.he grumbles quietly, &quot;always need more. Never stay full.&quot; $npc1.He suddenly looks up and sees you, $npc1.his face turning into a twisted, angry grimace. &quot;GIVE ME MORE FOOD!&quot; $npc1.he suddenly bellows, dropping the meatless bone and suddenly pulling a nasty looking pair of daggers out! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if random(1,2) == 1&gt;&gt;
	&lt;li&gt;Slash&lt;/li&gt;
	&lt;&lt;if setup.dodge()&gt;&gt;
		$npc1.He swings $npc1.his arms wildly, but $npc1.his daggers don&#39;t hit home thanks to your quick evasion.
		
	&lt;&lt;else&gt;&gt;
		$npc1.He swings $npc1.his arms wildly, $npc1.his daggers cutting into you! 
		&lt;&lt;set $edmg *= 0.8&gt;&gt;
		&lt;&lt;damage $edmg&gt;&gt;
		/*add dot effect*/
			
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	&lt;li&gt;Stab&lt;/li&gt;
	&lt;&lt;if setup.dodge()&gt;&gt;
		$npc1.He suddenly rushes at you, daggers forward, but you narrowly dodge the attack. 
		
	&lt;&lt;else&gt;&gt;
		$npc1.He suddenly rushes at you, plowing forward with both daggers out and catching you in the midsection! 
		&lt;&lt;damage $edmg&gt;&gt;			
	&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/if&gt;&gt;

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
Taking advantage of the $npc1.species&#39;s frail condition, you shove $npc1.him to the ground. $npc1.He grunts with efforts as $npc1.he feebly tries to force you off $npc1.him, but in short order, you have forced $npc1.his weapons away and trapped $npc1.him under your $fatness body. You lick your teeth, grabbing $npc1.him under the arms as you open your mouth wide. $npc1.He lets out a whimper as you pull $npc1.his head into your gaping maw, getting a taste of $npc1.his fear as well as $npc1.his $npc1.fur. Your throat bulges as you start to swallow $npc1.him down, $npc1.his cries become muffled and $npc1.his fists beating at you weakly, but rapidly. You grab $npc1.his wrists and force them down against $npc1.his hips, squeezing $npc1.his arms against $npc1.him as you force $npc1.his shoulders into your mouth, spreading it wide open in the process. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	As you swallow $npc1.him up to $npc1.his chest, you lift $npc1.him up, $npc1.his legs kicking frantically and fingers twitching as you hold $npc1.his light body parallel to the ground. Hungrily, you pull $npc1.him into your mouth, your grip adjusting to be lower and lower on $npc1.his body as $npc1.he begins to pile up in your stomach. $npc1.His struggles become a futile pushing on your insides as your throat fully engulfs $npc1.him, and with a few more swallows, $npc1.his entire body is in your $waist belly. You give it a satisfied rub, and after a few moments, the struggling dies down to nothing. 
	&lt;&lt;if $status.agiTime &lt; 60&gt;&gt;&lt;&lt;set $status.agiTime = 60&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.agi &lt; 10&gt;&gt;
		As time passes, an odd magical energy flows outward from your stomach and through your body and you feel a good bit faster
		&lt;&lt;set $status.agi = 10&gt;&gt;
		&lt;&lt;updateStats&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You swallow $npc1.him up to $npc1.his chest, your rapid feast slowing as you start to feel too full. Refusing to let this little meal go to waste, you redouble your efforts, swallowing down more and more of $npc1.him, but when $npc1.he begins to fold up in your stomach, the violent thrashing $npc1.he&#39;s doing inside of you not helping to assuage matters. Sucking down the last of $npc1.his flailing feet and tail cements your mistake, the relentless pounding your insides receive only adding to the mounting pressure as $npc1.he makes the journey down your throat and to your over-stuffed belly. You fall to a seat, gingerly rubbing your $waist gut, but the struggling inside doesn&#39;t die down anywhere near fast enough, and the pressure and pain eventually cause you to lose consciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
You hold up your hands signalling surrender, then reach into your pack to try to find something to satisfy $npc1.him. 
&lt;&lt;set _offering = &quot;&quot;&gt;&gt;
	
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $inventory[_i].type == &quot;food&quot;&gt;&gt;
			&lt;&lt;set _offering = $inventory[_i]&gt;&gt;
			&lt;&lt;break&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;if _offering == &quot;&quot;&gt;&gt;
	Unfortunately, you have nothing in your pack to satisfy $npc1.him, and she shouts angrily, suddenly pouncing on you and furiously bashing the hilts of $npc1.his daggers against you. You eventually collapse under the barrage of blows and fall unconscious. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;battle&quot;&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	Fortunately, you do find _offering.article _offering.name, which the $npc1.species snatches out of your hands almost immediately. $npc1.He is already hungrily devouring it as $npc1.he begins to walk away. You take the opportunity to put a great distance between the two of you. 
	&lt;&lt;removeItem _offering&gt;&gt;
	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
			
&lt;&lt;/if&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
The rain of blows is too much for you, and the last attack sends you slowly slumping to the ground, your consciousness fading away as $npc1.he already starts to pat you down for food. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the $npc1.species is sent sprawling to the ground. $npc1.He twitches for a bit, lets out a deep sigh, and falls into unconsciousness. Looks like that&#39;s that. 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="65" name="tough fur ai" tags="" position="5025,875" size="100,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
You are wandering through a particularly cold mountainside when your path is crossed by $npc1.article $npc1.species that is abnormally fat, even given the current state of things. $npc1.He appears to be completely unbothered by the inclimental weather, waddling up to you bare $npc1.furred. The sheer girth of $npc1.him becomes more apparent as $npc1.he gets closer--$npc1.his belly nearly hangs down to $npc1.his knees, and every inch of $npc1.his body bulges with thick fat. $npc1.He raises a wooden spear tipped with obsidian at you and demands, &quot;Give me your food, or I&#39;ll squash you!&quot; And with that, it&#39;s time to fight! 


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;
&lt;&lt;if random(1,2) == 1&gt;&gt;
	&lt;li&gt;Spear Thrust&lt;/li&gt;
	&lt;&lt;if setup.dodge()&gt;&gt;
		$npc1.He tries to line you up to jab you with $npc1.his spear, but you&#39;re too slippery and the shot only causes a swoosh in the air. 
		
	&lt;&lt;else&gt;&gt;
		$npc1.He lines you up and thrusts $npc1.his spear at you, catching you with the surprisingly sharp tip! 
		&lt;&lt;damage $edmg&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	&lt;li&gt;Body Splash&lt;/li&gt;
	&lt;&lt;if setup.dodge() and setup.weight() &lt; 700&gt;&gt;
		$npc1.He rushes and leaps at you, but you skillfully evade. $npc1.He hits the ground with an earth-shaking thud, but rolls up to face you again without hesitation. 

	&lt;&lt;elseif setup.weight() &lt; 700&gt;&gt;
		Suddenly, $npc1.he rushes and leaps at you. The weight of $npc1.his body smashes into you and knocks you to the ground, and $npc1.his bulk crushes you painfully before you get out from under $npc1.him! 
		&lt;&lt;set $edmg *= 1.3&gt;&gt;
		&lt;&lt;damage $edmg&gt;&gt;
			
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $fat &gt; 100&gt;&gt;
			Suddenly, $npc1.he rushes and leaps at you, smashing $npc1.his blubbery body into your own. The impact sends visible shockwaves through the thick fat enrobing both of you, but your massive bulk proves too much to topple. The $npc1.species growls in frustration as $npc1.he backs away, both $npc1.his belly and yours still wobbling as $npc1.he does so. 
		&lt;&lt;else&gt;&gt;
			Suddenly, $npc1.he rushes and leaps at you. You manage to brace yourself just in time as $npc1.he smashes $npc1.his blubbery body into your unyielding, muscular bulk. Calling upon your formidable reserves of strength, you stand firm and thrust the $npc1.species back, sending ripples through $npc1.his oversized belly as $npc1.he stumbles away.
		&lt;&lt;/if&gt;&gt;
				
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
You violently shove $npc1.his chest, sending $npc1.him sprawling backwards. $npc1.He lands on $npc1.his back with a tremendous thump, and as $npc1.he looks up, you are already pinning $npc1.his thick legs together and opening your mouth wide. With a wordless cry, $npc1.he rolls over and as you shove $npc1.his feet into your mouth and begin to swallow $npc1.him down, $npc1.he claws at the ground, desperately trying to slow your feast. 
&lt;&lt;consume $e.weight 0&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
	$npc1.His broad hips slide into your mouth easily, your hungry swallowing bringing $npc1.his bulk ever closer to your belly. When you reach $npc1.his tremendous, flabby midsection, you snake your way forward, your jaw stretching wider and wider around the crest of $npc1.his jiggling belly. As you crest the mountain of flab, $npc1.he begins to slickly slide down your throat, the force of your gluttonous swallows easily outmatching $npc1.his desperate tugs at whatever handhold $npc1.he can get. $npc1.he lets out a frustrated growl as you suck down $npc1.his chest, your belly stretching with $npc1.his lower body. You respond with a growl of your own, but from your hungering stomach. $npc1.He pushes at your face in a bid to free $npc1.himself, but only manages to get $npc1.his arms stuck outside your mouth as you gulp $npc1.him down past the shoulders. $npc1.He lets out a defeated groan as $npc1.his blubbery neck starts to pass down yours, and $npc1.his arms slip down to follow $npc1.him into your $waist belly. You give your stomach a pat and a rub, feeling $hungry as you prepare to set off again. 
	&lt;&lt;if $status.endTime &lt; 60&gt;&gt;&lt;&lt;set $status.endTime = 60&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.end &lt; 10&gt;&gt;
		As you begin to digest $npc1.him, you can feel whatever magic $npc1.he was changed by flow out through your stomach. After a few moments, you feel quite tough, and the cold of the mountains bothers you a good bit less. 
		&lt;&lt;set $status.end = 10&gt;&gt;
		&lt;&lt;updateStats&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	Not a bad meal, all in all. 
	&lt;&lt;set _calories = $e.weight*.6&gt;&gt;
	&lt;&lt;set $cal += _calories&gt;&gt;
	&lt;&lt;include &quot;Victory&quot;&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	You slowly suck down $npc1.his broad hips, scarcely able to believe just how bulky this $npc1.species is. $npc1.His tremendously blubbery midsection hurts your stomach to even look at, but giving up never got anyone anywhere, so you make a valiant effort to get $npc1.him all down. $npc1.He sneers at you as you take your time, and taunts, &quot;What&#39;s wrong? Does it hurt if I do THIS?&quot; before beginning to move $npc1.his legs about inside you. It does indeed, but it also makes you swallow faster, and $npc1.he is in up to $npc1.his chest even before you&#39;re done wincing. &quot;C&#39;mon, $p.species!&quot; $npc1.he continues mocking as you work your way around $npc1.his shoulders, grabbing your painfully stretched belly, &quot;don&#39;t tell me little old me is gonna be too much for you!&quot; You put your hands on $npc1.his head and violently shove $npc1.him down, $npc1.his taunts becoming muffled shouts. $npc1.His arms are the last thing down your throat, and as you swallow down the last of $npc1.him, you lean forward, your $waist stomach is the only thing holding you upright, splayed out and spread across the ground. You give it a slow rubbing, but can&#39;t even buy yourself much time before the immense fullness is too much for you and sends you drifting out of consciousness. 
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;
&lt;&lt;set _surrenderFoodA = &quot;&quot;&gt;&gt;
&lt;&lt;set _surrenderFoodB = &quot;&quot;&gt;&gt;
&lt;&lt;set _surrenderFoodC = &quot;&quot;&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;
	&lt;&lt;capture _i&gt;&gt;
	
	&lt;&lt;if $inventory[_i].type == &quot;food&quot;&gt;&gt;
		&lt;&lt;if _surrenderFoodA == &quot;&quot;&gt;&gt;
			&lt;&lt;set _surrenderFoodA = $inventory[_i]&gt;&gt;
		&lt;&lt;elseif _surrenderFoodB == &quot;&quot;&gt;&gt;
			&lt;&lt;set _surrenderFoodB = $inventory[_i]&gt;&gt;
		&lt;&lt;elseif _surrenderFoodC == &quot;&quot;&gt;&gt;
			&lt;&lt;set _surrenderFoodC = $inventory[_i]&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;break&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;/capture&gt;&gt;
	
&lt;&lt;/for&gt;&gt;


You hold up your hands in a sign of surrender, and the $npc1.species halts in $npc1.his tracks while you reach into your pack. 


&lt;&lt;if _surrenderFoodA == &quot;&quot;&gt;&gt;
Unfortunately, you can&#39;t find anything, and can only offer an empty-handed shrug. $npc1.He obviously doesn&#39;t appreciate this, $npc1.his face becoming an angry scowl. &quot;Then I guess I&#39;m just gonna have to eat YOU!&quot; $npc1.he bellows, tromping up to you and wrapping $npc1.his arms around you, pinning your arms to your sides in a firm grasp. You can&#39;t even struggle properly as $npc1.his mouth opens wide, the world becoming dark and wet as your head is forced into $npc1.his throat. $npc1.He eagerly forces you into $npc1.his elastic gullot, your bulk barely even slowing $npc1.him as $npc1.he greedily pulls you in. It is tight and slick before you are pulled into $npc1.his expansive stomach, which loosely and easily stretches to contain you. You curl up into a ball as the last of you is sucked down, and you hear a loud thumping as $npc1.he pats $npc1.his stomach. As the stomach walls clench down upon you, you are squeezed steadily tighter. The pressing and lack of air soon cause you to lose consciousness. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;elseif _surrenderFoodB == &quot;&quot; or _surrenderFoodC == &quot;&quot;&gt;&gt;
You pull out what food you have, and $npc1.he beckons impatiently. You try to find more, but simply don&#39;t have enough to appease $npc1.him. &quot;Well then, I guess I&#39;ll just take that from you and rough you up a bit!&quot; $npc1.he declares. You start to run, but $npc1.he has already slipped $npc1.his spear in front of your legs, and you trip, falling face down onto the ground. Before you can stand, there is a tremendous thud as $npc1.he jumps onto your back, knocking the wind out of you. &quot;That oughta do it,&quot; $npc1.he says triumphantly, then gets up off you and slowly walks off, already eating your food. You stand up, brush yourself off, and go back to exploring. 
&lt;&lt;set _damage = $maxHea * 0.5&gt;&gt;
&lt;&lt;if _damage &gt;= $hea&gt;&gt;&lt;&lt;set _damage = $hea - 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;damage _damage&gt;&gt;
&lt;&lt;removeItem _surrenderFoodA&gt;&gt;
&lt;&lt;if _surrenderFoodB != &quot;&quot;&gt;&gt;&lt;&lt;removeItem _surrenderFoodB&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
You pull out a little food, to which $npc1.he responds by beckoning for more. When you present a second, $npc1.he does so a bit more impatiently. Upon presenting the third, $npc1.he nods acceptingly, taking them from you and starting to slowly devour them, heavy footsteps thumping down the road as $npc1.he walks steadily away. You decide to call this one a draw. 

&lt;&lt;removeItem _surrenderFoodA&gt;&gt;
&lt;&lt;removeItem _surrenderFoodB&gt;&gt;
&lt;&lt;removeItem _surrenderFoodC&gt;&gt;
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
$npc1.His last attack is enough to take the fight out of you, and you crash to the ground, slowly losing consciousness. The last thing you remember is feeling the ground shake in time to $npc1.his steps as $npc1.he strides over and pats you down for food. 
&lt;hr&gt;
&lt;&lt;defeated &quot;battle&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
With your last attack, the corpulent $npc1.species falls to $npc1.his knees, grunting out a curse before collapsing to the ground, which shakes a bit under $npc1.his bulk. Chalk up another victory for you! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;feeder_genericActionFull &quot;eater&quot; false &quot;mountain randomization&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="66" name="A break from adventuring" tags="downtime-mod" position="6200,1200" size="100,100">/* Begin by calculating how many days this can actually go on for */
/* We&#39;ll figure out what the limiting factor will be out of all the possibilities, and record what to &quot;blame&quot; for later narration */
&lt;&lt;set _actualDays = $downtime_daysCap&gt;&gt;
&lt;&lt;set _downtimeEndReason = &quot;cap&quot;&gt;&gt;

&lt;&lt;if setup.downtime_isEating()&gt;&gt;
	&lt;&lt;set _eatingDays = setup.downtime_getEatingDaysPossible($gld)&gt;&gt;

	&lt;&lt;if _eatingDays &lt; _actualDays&gt;&gt;
		&lt;&lt;set _actualDays = _eatingDays&gt;&gt;
		&lt;&lt;set _downtimeEndReason = &quot;eat&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _enteredDays = setup.downtime_getIntendedDays()&gt;&gt;
&lt;&lt;if _enteredDays &lt; _actualDays&gt;&gt;
	&lt;&lt;set _actualDays = _enteredDays&gt;&gt;
	&lt;&lt;set _downtimeEndReason = &quot;intended&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.downtime_isTraining()&gt;&gt;
	/* Training has to be worked out a bit differently, because other options could increase / decrease the available fat */
	&lt;&lt;set _trainingDays = setup.downtime_getTrainingDaysPossible($fat)&gt;&gt;
	
	&lt;&lt;if _trainingDays &lt; _actualDays&gt;&gt;
		&lt;&lt;set _actualDays = _trainingDays&gt;&gt;
		
		/* Prevent days being lower than 0, as training days can reach that if there&#39;s not enough calories incoming */
		&lt;&lt;if _actualDays &lt; 0&gt;&gt;
			&lt;&lt;set _actualDays = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _downtimeEndReason = &quot;train&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Work out the changes that WILL happen, but don&#39;t make them happen yet */
&lt;&lt;set _statChanges = {
	strength: 0,
	agility: 0,
	endurance: 0,
	intelligence: 0,
	stomach: 0,
	fat: 0,
	gold: 0,
}&gt;&gt;

/* Training */
&lt;&lt;if setup.downtime_isTraining()&gt;&gt;
	&lt;&lt;set _fatSpentOnTraining = _actualDays * setup.downtime_getTrainingFatPerDay()&gt;&gt;
	&lt;&lt;set _trainingResults = setup.downtime_calculateTrainingResults(_fatSpentOnTraining, $downtime_optionsSelected.training)&gt;&gt;
	
	&lt;&lt;set _statChanges.strength += _trainingResults.strength&gt;&gt;
	&lt;&lt;set _statChanges.endurance += _trainingResults.endurance&gt;&gt;
	&lt;&lt;set _statChanges.agility += _trainingResults.agility&gt;&gt;
	&lt;&lt;set _statChanges.intelligence += _trainingResults.intelligence&gt;&gt;

	&lt;&lt;set _statChanges.fat -= _fatSpentOnTraining&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Eating */
/* Fat levels were change regardless of eating, but we&#39;ll do them here anyways */
&lt;&lt;set _statChanges.fat += setup.downtime_getDailyCalories() * _actualDays&gt;&gt;


&lt;&lt;if setup.downtime_isStomachTraining() and _actualDays &gt;= 1&gt;&gt; /* Additional clause to ensure the player needs to be able to afford a full day&#39;s worth of stuffing to start out on the stuffing training */
	/* Stomach training works weirdly, so we will actually be changing one aspect (the stomachStretch counter) right now while calculating what happens */
	&lt;&lt;set _minutesStretched = $downtime_stretchPerDay * _actualDays&gt;&gt;
	&lt;&lt;set _stretchCalcResults = setup.downtime_calculateStomachStretch(_minutesStretched, $status.stomachStretch)&gt;&gt;
	
	&lt;&lt;set _increases = _stretchCalcResults[0]&gt;&gt;
	&lt;&lt;set _newStomachStretch = _stretchCalcResults[1]&gt;&gt;
	
	&lt;&lt;set _statChanges.stomach += _increases&gt;&gt;
	&lt;&lt;set $status.stomachStretch = _newStomachStretch&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Misc */
/* expenses */
&lt;&lt;set _statChanges.gold -= setup.downtime_getDailyEatCost() * _actualDays&gt;&gt;

/* NARRATE */

/* Prepare some things for narration */
&lt;&lt;set _workingOut = false&gt;&gt;
&lt;&lt;set _studying = false&gt;&gt;
&lt;&lt;if $downtime_optionsSelected.training.intelligence == true&gt;&gt;
	&lt;&lt;set _studying = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $downtime_optionsSelected.training.strength == true or $downtime_optionsSelected.training.agility == true&gt;&gt;
	&lt;&lt;set _workingOut = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _eatingCategory = &quot;none&quot;&gt;&gt;
&lt;&lt;if $downtime_optionsSelected.eating == &quot;normal&quot;&gt;&gt;
	&lt;&lt;set _eatingCategory = &quot;modest&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if typeof $downtime_optionsSelected.eating === &quot;number&quot;&gt;&gt;
	&lt;&lt;if $downtime_optionsSelected.eating == 0&gt;&gt;
		&lt;&lt;set _eatingCategory = &quot;none&quot;&gt;&gt;
	&lt;&lt;elseif $downtime_optionsSelected.eating &lt;= 50&gt;&gt;
		&lt;&lt;set _eatingCategory = &quot;modest&quot;&gt;&gt;
	&lt;&lt;elseif $downtime_optionsSelected.eating &lt;= 100&gt;&gt;
		&lt;&lt;set _eatingCategory = &quot;indulgent&quot;&gt;&gt;
	&lt;&lt;elseif $downtime_optionsSelected.eating &gt; 100&gt;&gt;
		&lt;&lt;set _eatingCategory = &quot;extreme&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _isGainingWeight = false&gt;&gt;
&lt;&lt;if _statChanges.fat &gt; 0&gt;&gt;
	&lt;&lt;set _isGainingWeight = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _bedStatus = &quot;bed&quot;&gt;&gt;
&lt;&lt;if setup.weight() &gt; 400&gt;&gt;
	&lt;&lt;set _bedStatus = &quot;your creaking bed&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _actualDays &lt; 2&gt;&gt;
	&lt;&lt;if _downtimeEndReason != &quot;intended&quot;&gt;&gt;
		&lt;&lt;if _downtimeEndReason == &quot;train&quot;&gt;&gt;
			&lt;&lt;set _plans = &quot;&quot;&gt;&gt;
			&lt;&lt;set _problem = &quot;&quot;&gt;&gt;
			
			&lt;&lt;if _workingOut == true and _studying == true&gt;&gt;
				&lt;&lt;set _plans = &quot;of daily visits to the training grounds and the library, to hone both your body and mind&quot;&gt;&gt;
				&lt;&lt;set _problem = &quot;The exercise proves to be far more draining than you originally thought, which makes it hard to focus on your studies&quot;&gt;&gt;
			&lt;&lt;elseif _workingOut == true and _studying == false&gt;&gt;
				&lt;&lt;set _plans = &quot;for an in-depth daily workout routine&quot;&gt;&gt;
				&lt;&lt;set _problem = &quot;The exercise proves to be far more draining than you originally thought, and you find yourself wishing the effort was going towards more adventurous pursuits instead&quot;&gt;&gt;
			&lt;&lt;elseif _studying == true and _workingOut == false&gt;&gt;
				&lt;&lt;set _plans = &quot;for many study topics to explore nose-deep in books at the library&quot;&gt;&gt;
				&lt;&lt;set _problem = &quot;The thought of another mind-numbing minute pouring through musty tomes is almost too much to bear, and you yearn for a bit more excitement&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			You put together plans _plans, but are soon hit with quite the reality check. Scarcely a day goes by and you already exhausted with it all. _problem. You end up cutting your plans short - you&#39;re not sure you could take any more training.
		&lt;&lt;else&gt;&gt; /* Must be eat */
			While you had planned for a longer break, your budget has other plans. It&#39;s barely been a day before you&#39;re reaching in to your coin purse to pay for another snack, only to find it empty. You end up cutting your plans short - you&#39;re going to need to make some gold if you want to be able to afford to feed your appetite.
			
			/* cut because I wrote these basic ones not realising I&#39;d already had a decent generic one above
			&lt;&lt;if _eatingCategory == &quot;modest&quot;&gt;&gt;
				Even your more modest-sized diet isn&#39;t enough to sustain your planned days of rest and relaxation. Your gold runs out with scarcely a day going by.
			&lt;&lt;elseif _eatingCategory == &quot;indulgent&quot;&gt;&gt;
				Your plans for days of pleasant indulgence are brought short by the unpleasant reality of your less than sizeable coin purse. You barely manage to scrape together enough gold for a day&#39;s indulgence, though enjoy yourself while it lasts.
			&lt;&lt;elseif _eatingCategory == &quot;extreme&quot;&gt;&gt;
				Your plans of blissful days spent wantonly gorging on all the food your heart desires and then some are abruptly yanked back into reality by your budget, or lack thereof. Hardly a day&#39;s worth of feasting goes by before your gold supply runs dry, and you&#39;re left having to seek more funds if you want to experience such a good time.
			&lt;&lt;/if&gt;&gt;
			*/
		&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;else&gt;&gt;

		Deciding that a day off is just what you need, 
		
		&lt;&lt;if setup.downtime_isTraining()&gt;&gt;
			you set your sights on taking some time off to better yourself. 
			&lt;&lt;if _workingOut == true and _studying == true&gt;&gt;
				Morning takes you to the training grounds, where you work up a sweat working out, then you cool off in the afternoon at the library, brushing up on your knowledge. 
			&lt;&lt;elseif _workingOut == true and _studying == false&gt;&gt;
				You spend the day at the training grounds getting a good workout. It&#39;s tiring work, but you can already feel yourself growing just that bit fitter from your day&#39;s dedication. 
			&lt;&lt;elseif _studying == true and _workingOut == false&gt;&gt;
				The library is where you choose to spend your day, studying up on various topics. Even though it&#39;s just a day spent studying, you feel smarter than you were this morning. 
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
			you seize the opportunity to take things easy for the day. Lazing around, practising your hobbies, and enjoying the slow life in the comfortable safety of the city. 
		&lt;&lt;/if&gt;&gt;
		
		
		&lt;&lt;if _eatingCategory == &quot;none&quot;&gt;&gt;
			While the temptation to indulge in food is all around you, you opt to tighten your belt and purse strings and resist the call of food for the time being.
		&lt;&lt;elseif _eatingCategory == &quot;modest&quot;&gt;&gt;
			You do your best to only eat a comfortable amount of food, resisting the urge to join in with the scenes of overindulgence unfolding around you.
		&lt;&lt;elseif _eatingCategory == &quot;indulgent&quot;&gt;&gt;
			An evening of indulgence calls to you, and you join the many other furs in the restaurant merrily eating more than their fill. You leave with a belly comfortably full.
		&lt;&lt;elseif _eatingCategory == &quot;extreme&quot;&gt;&gt;
			You end the day with a feast far beyond your abilities, glutting yourself on a feast of flavors until you&#39;re so stuffed it feels like you could burst if you breathed wrong. Lying back in _bedStatus, you do your best to soothe your painfully stuffed gut as you drift off into a pleasant food coma.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	/* Beginning */
	/* (skipping because I hate writing) */
	
	/* What gets up to */
	&lt;&lt;if setup.downtime_isTraining()&gt;&gt;
		Settling back into city life comes easy to you, though you resolve to spend your time in training rather than allowing yourself to be lulled into the easy, lazy comfort the lifestyle tries to pull you towards. 
		
		&lt;&lt;if _workingOut == true and _studying == true&gt;&gt;
			Your efforts are split between the training grounds and the library, working up a sweat while you hone your body one moment, while honing your mind in the moments of rest. Each day you can feel your abilities improving, little by little, and that satisfaction is all the motivation you need to keep up your efforts. 
		&lt;&lt;elseif _workingOut == true&gt;&gt;
			&lt;&lt;if $downtime_optionsSelected.training.strength == true and $downtime_optionsSelected.training.agility == true&gt;&gt;
				You immerse yourself fitness training, putting your body through a mix of regimes that neglect no aspects - training strength, agility, and endurance. You end each day aching from the effort, but the way you can feel yourself improving just that little with each personal best bested makes it all worth it. 
			&lt;&lt;elseif $downtime_optionsSelected.training.strength == true&gt;&gt;
				You spend much of your time around musclebound furs, training your muscles so hard that come the evening you can barely lift your limbs. Despite how weak you feel by the end of a gruelling workout session you can tell you&#39;re getting stronger from your efforts, which drives you on to bench even greater weights. 
			&lt;&lt;else&gt;&gt; /* agility only */
				You spend most of your time on runs, $p.feet pounding along well-worn tracks until you feel like you can&#39;t take another step. You can feel yourself making steady progress, managing to beat your personal best times and distances more often than not with each passing day. 
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt; /* studying */
			You spend your days in quiet contemplation in the library, pouring through books as you study through all the topics you had planned. There&#39;s a great satisfaction to be had at seeing concepts you struggled with slowly unravel into something you understand, and the prospect of unpacking more nuggets of wisdom keeps you going. 
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _eatingCategory == &quot;indulgent&quot;&gt;&gt;
			You reward yourself for your hard work with an indulgent meal as you unwind at the end of each day, as well as with plenty of snacks throughout your training. 
		&lt;&lt;elseif _eatingCategory == &quot;extreme&quot;&gt;&gt;
			It&#39;s all hungry work, and you reward yourself at the end of each day by unleashing your voracious appetite on a feast as grand as you can handle. The sheer gluttony is a training in its own right as you force your stomach to cope with as much food as it can possibly bear. 
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _isGainingWeight == true&gt;&gt;
			In fact, your generous self-rewards are causing you to undo any weight loss that could&#39;ve resulted from your hard work. 
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		It doesn&#39;t take long for city life to pull you back in to its comfortable embrace of idyllic simplicity. You relish the opportunity to rest, take the weight off your feet, and settle in to a peaceful time of relaxation.
		&lt;&lt;if _eatingCategory == &quot;none&quot;&gt;&gt;
			When you aren&#39;t taking it easy, you&#39;re finding opportunities to enjoy your hobbies and catch up with old friends, who seem to be larger each time you see them.
		&lt;&lt;elseif _eatingCategory == &quot;modest&quot;&gt;&gt;
			When you aren&#39;t taking it easy, you&#39;re finding opportunities to enjoy your hobbies and catch up with old friends, who indulge a lot more liberally than you allow yourself to whenever you meet over a meal.
		&lt;&lt;elseif _eatingCategory == &quot;indulgent&quot;&gt;&gt;
			When you aren&#39;t taking it easy, you&#39;re finding opportunities to enjoy your hobbies and catch up with old friends. As with most of the citizens, your friends seem to be just as lax about restraining their appetites as you are. Every meeting over some food or drinks leaves everyone present with a pleasantly full belly.
		&lt;&lt;elseif _eatingCategory == &quot;extreme&quot;&gt;&gt;
			Much of your daily life revolves around food - sitting at the restaurant gorging on a buffet of delicious flavors to the very limits of your body, waddling back home nursing your painfully stuffed gut in your $p.hands, and sleeping off the monumental meal to prepare your body for the next feast.
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;/if&gt;&gt;
	
	
	/* Ending */
	&lt;br&gt;
	
	&lt;&lt;if _downtimeEndReason == &quot;intended&quot;&gt;&gt;
		All-in-all, your break is a satisfying experience, with you getting done everything you wanted to. Freshened and invigorated, you can&#39;t wait to return to your adventuring, ready for anything.
		
	&lt;&lt;elseif _downtimeEndReason == &quot;eat&quot;&gt;&gt;
		&lt;&lt;if _eatingCategory == &quot;indulgent&quot; &gt;&gt;
			Food flows freely as you allow yourself to indulge your appetite here and there on treats that catch your fancy, though matching this flow of food into your belly runs the stream of gold leaving your coin purse. After one final indulgence, you&#39;re clean out of money, your appetite bringing your break to a close earlier than you intended.
		&lt;&lt;elseif _eatingCategory == &quot;extreme&quot; &gt;&gt;
			The extreme amount of food you&#39;re cramming down your gullet each day carries an equally sizeable price tag. The only thing that doesn&#39;t feel heavier about you after each of your monumental meals is your coin purse, which grows lighter at a rapid pace. Your hefty appetite ends up outpacing your budget, and you&#39;re forced to end your break early, having glutted on everything you could possibly afford.
		&lt;&lt;elseif _eatingCategory == &quot;modest&quot; &gt;&gt;
			Even your more modest budgeting of food isn&#39;t enough to see you all the way through your planned break, so you have to end things earlier than anticipated.
		&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif _downtimeEndReason == &quot;train&quot;&gt;&gt;
		/* Being lazy for the time being and not writing a combo for exercise + studying */
		&lt;&lt;if _workingOut == true&gt;&gt;
			Eventually your regular training regime starts to wear on you, and it feels like you&#39;re not making any more progress. Rather than continue the draining efforts, you decide it&#39;d be for the best to cut your training short.
		&lt;&lt;else&gt;&gt; /* studying */
			After a while holed up in the library, it feels like you&#39;ve learned everything you&#39;re willing to from pouring over books for now, and it would be better to get out into the world for some $p.hands-on experience. So you end your study break early.
		&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif _downtimeEndReason == &quot;cap&quot;&gt;&gt;
		With each peaceable day that passes in the comfort of your homely corner of the city, you can&#39;t help but feel an &lt;i&gt;itch&lt;/i&gt; at the back of your mind, growing with each passing day. Tonight you lay awake in _bedStatus, restless as you reflect on the routine you&#39;ve settled into. The thought of carrying on for even one more day feels almost unbearable - it isn&#39;t until you decide to cut your plans short that you finally manage to drift off to sleep. Come morning, you&#39;re up and ready for more exciting ways to pass the time.
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/if&gt;&gt;

&lt;hr&gt;

/* UPDATE TIME + RELATED */
/* Reset player to a neutral state */
&lt;&lt;set $mana = $maxMana&gt;&gt; /* We&#39;ll give the player a free top-up (even though it should cost fat), as mana rechages to max far quicker than a single day */
&lt;&lt;set $sta = 100&gt;&gt;
&lt;&lt;set $ate = 0&gt;&gt;
&lt;&lt;set $inf = 0&gt;&gt;
&lt;&lt;set $infMass = 0&gt;&gt;

/* Store calories before resetting them */
&lt;&lt;set _statChanges.fat += $cal&gt;&gt;
&lt;&lt;set $cal = 0&gt;&gt;

&lt;&lt;removeStatus&gt;&gt;
&lt;&lt;updateStats&gt;&gt;

&lt;&lt;set $hea = $maxHea&gt;&gt;

/* First, we jump to the end of the day that downtime is being started */
&lt;&lt;set $day += 1&gt;&gt;
/* Then we jump the number of days based on the downtime, leaving off at the start of the day after the downtime */
&lt;&lt;set $day += Math.ceil(_actualDays)&gt;&gt;

&lt;&lt;set $hour = 9&gt;&gt;
&lt;&lt;set $tensMinute = 0&gt;&gt;
&lt;&lt;set $onesMinute = 0&gt;&gt;

/* Reset daily quests */
&lt;&lt;run setup.downtime_resetDailyQuests()&gt;&gt;

&lt;&lt;doTime 0&gt;&gt; /* Will cause all the other minutiae like AM/PM, time of day, etc. to get fixed */

/* PROVIDE THE STAT CHANGES */
&lt;&lt;if _statChanges.gold != 0&gt;&gt;
	&lt;&lt;doGld _statChanges.gold&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _statChanges.fat != 0&gt;&gt;
	&lt;&lt;changeStats &quot;fat&quot; setup.downtime_roundToDecimalPlace(_statChanges.fat,3)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _statChanges.strength != 0&gt;&gt;
	&lt;&lt;changeStats &quot;str&quot; setup.downtime_roundToDecimalPlace(_statChanges.strength,2)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _statChanges.agility != 0&gt;&gt;
	&lt;&lt;changeStats &quot;agi&quot; setup.downtime_roundToDecimalPlace(_statChanges.agility,2)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _statChanges.endurance != 0&gt;&gt;
	&lt;&lt;changeStats &quot;end&quot; setup.downtime_roundToDecimalPlace(_statChanges.endurance,2)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _statChanges.intelligence != 0&gt;&gt;
	&lt;&lt;changeStats &quot;int&quot; setup.downtime_roundToDecimalPlace(_statChanges.intelligence,2)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _statChanges.stomach != 0&gt;&gt;
	&lt;&lt;changeStats &quot;sto&quot; _statChanges.stomach&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return to adventuring&quot; &quot;Your House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="67" name="Beachside chef&#39;s taste-test" tags="feeder-expansion" position="6500,1000" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;
	&lt;&lt;case 0&gt;&gt;
		&lt;&lt;set _hasFood = 0&gt;&gt;
		&lt;&lt;if setup.numOwned($feeder_mealMeat) &gt; 0&gt;&gt;
			&lt;&lt;set _hasFood += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if setup.numOwned($feeder_mealVeg) &gt; 0&gt;&gt;
			&lt;&lt;set _hasFood += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if setup.numOwned($feeder_mealDessert) &gt; 0&gt;&gt;
			&lt;&lt;set _hasFood += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;p&gt;The $npc1.species grins, rubbing $npc1.his $npc1.hands together with anticipation. &quot;Well then, let&#39;s see what ya got!&quot; &lt;/p&gt;
		
		&lt;&lt;if _hasFood &gt; 0 and _hasFood &lt; 3&gt;&gt; /* Player has brought some food, but not all of it */
			&lt;&lt;if _hasFood == 1&gt;&gt;
				&lt;p&gt;You carefully lay out the plateload of food you brought on the counter, then take a seat on one of the stools. The $npc1.species continues to look at you expectantly, then when $npc1.he realises you&#39;re done, $npc1.his smile wavers a bit. &quot;That all ya brought? Not much of meal, that!&quot; $npc1.he says. &quot;Bulk it up with a bit of variety, an&#39; I&#39;ll try it out all in one go.&quot; &lt;/p&gt;
			&lt;&lt;else&gt;&gt;
				&lt;p&gt;You carefully lay out the couple plateloads of food you brought on the counter, then take a seat on one of the stools. The $npc1.species continues to look at you expectantly, then when $npc1.he realises you&#39;re done, $npc1.his smile wavers a bit. &quot;That all ya brought? Not much of meal, that!&quot; $npc1.he says. &quot;Bulk it up with a bit of variety, an&#39; I&#39;ll try it out all in one go.&quot; &lt;/p&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;p&gt;&quot;Don&#39; worry about lil old me, I can handle it!&quot; $npc1.he chuckles, slapping $npc1.his ample belly. &lt;/p&gt;
			
			&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Okay&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = &quot;ending&quot;&gt;&gt;
			&lt;&lt;/action&gt;&gt;
		&lt;&lt;elseif _hasFood == 0&gt;&gt; /* Player brought no food */
			&lt;p&gt;You&#39;ve... got nothing. The $npc1.species sees you standing there sheepishly, and $npc1.he chuckles. &quot;Way to get a $npc1.guy&#39;s hopes up, heh!&quot; $npc1.he says, waving $npc1.his hand dismissively. &quot;Whenever ya ready&#39;s fine, just bring it all together in one go.&quot; &lt;/p&gt;
			
			&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Okay&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = &quot;ending&quot;&gt;&gt;
			&lt;&lt;/action&gt;&gt;
		&lt;&lt;else&gt;&gt; /* Player brought all the necessary food */
			&lt;p&gt;You carefully lay out the selection of your best food on the counter, then take a seat on one of the stools. &lt;/p&gt;
			
			&lt;&lt;removeItem $feeder_mealMeat 1&gt;&gt;
			&lt;&lt;removeItem $feeder_mealVeg 1&gt;&gt;
			&lt;&lt;removeItem $feeder_mealDessert 1&gt;&gt;
			
			&lt;p&gt;$npc1.He gives them all a once over with a scrutinising glance, sizing up the selection, then gives an approving nod. &quot;Not bad, not bad. Though the proof of the puddin&#39; is in the eatin&#39;!&quot; &lt;/p&gt;
			
			&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA += 1&gt;&gt;
			&lt;&lt;/action&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;p&gt;Licking $npc1.his chops, the $npc1.species digs in with gusto, alternating mouthfuls of veggies and meats. It feels slightly awkward to be sitting there watching $npc1.him eat - you kind of wish you&#39;d asked $npc1.him to make you something first so $npc1.he wouldn&#39;t be the only one eating. $npc1.He tries to fill the silence with the occasional //mmm//, or //that&#39;s good//, as well as some feedback and questions about how you prepared this or that. &lt;/p&gt;
		&lt;p&gt;After what feels like forever, though in reality must only been a handful of minutes given how quickly $npc1.he eats, $npc1.he&#39;s mopping up cream with one last piece of cake. $npc1.He drops it into his maw and smiles, wiping $npc1.his mouth on his apron like a napkin. Then, $npc1.he looks to you. &lt;/p&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;The verdict...&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA += 1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;case 2&gt;&gt;
		&lt;p&gt;&quot;That was good!&quot; $npc1.he says, patting his ample belly. &quot;You&#39;ve definitely got promise, tha&#39;s for sure.&quot; $npc1.He gives you a strong clap on the arm as $npc1.he gets up and ambles over to the side of the bar, scooping some gold coins out of a box. $npc1.He drops them into you hand with a wink. &quot;For ya troubles. Seems only fair.&quot; &lt;/p&gt;
		&lt;&lt;questReward $feeder_questRaccoonCook&gt;&gt;
		
		&lt;p&gt;$npc1.He returns to $npc1.his prep work, delicately rolling up some sushi rolls while the question of whether $npc1.he&#39;s willing to share $npc1.his techniques lingers in the air. $npc1.He finishes making a few rolls while $npc1.he stares off at the gently glittering sea, pondering. Then $npc1.he tips $npc1.his head to see you still sat at the bar watching with anticipation, and $npc1.he smirks. &quot;&#39;Suppose it couldn&#39;t hurt to share some of my secrets to a fellow chef, //but//,&quot; $npc1.he says, waggling a finger. &quot;Ya gotta demonstrate to me that you can handle it. Don&#39;t wanna teach someone just for &#39;em to make &#39;emself burst from their breakfast, do I? Finish a feast of my menu, all in one go, and I&#39;ll know ya can be trusted.&quot; &lt;/p&gt;
		&lt;&lt;getQuest $feeder_questRaccoonFeast&gt;&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA += 1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;default&gt;&gt;
		&lt;p&gt;&quot;Now... in the spirit of sharin&#39;, fancy somethin&#39; of mine? Ya still gotta pay, though. Heh!&quot; &lt;/p&gt;
		&lt;&lt;if $eventCounterB == &quot;beach&quot;&gt;&gt;
			&lt;&lt;vendor &quot;beach raccoon&quot;&gt;&gt;
			&lt;&lt;store&gt;&gt;
			&lt;&lt;action &quot;c&quot; &quot;beach&quot; &quot;Done&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;vendor &quot;ocean raccoon&quot;&gt;&gt;
			&lt;&lt;store&gt;&gt;
			&lt;&lt;action &quot;c&quot; &quot;ocean&quot; &quot;Done&quot; &quot;Goodbye ocean vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		&lt;&lt;/if&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="68" name="Check Larder" tags="feeder-expansion" position="6600,400" size="100,100">&lt;&lt;feeder_getProvisionCount &quot;all&quot;&gt;&gt;
&lt;&lt;set _totalCount = $feeder_provisionCount&gt;&gt;
&lt;&lt;if _totalCount == 0&gt;&gt;
The larder is pitifully bereft of any ingredients. Not even cobwebs occupy the empty space on each shelf.
&lt;&lt;elseif _totalCount &lt; 4&gt;&gt;
There&#39;s only a very small handful of ingredients stored in your larder. It&#39;s barely even enough to make a meal, and doesn&#39;t really lend itself to many options...
&lt;&lt;elseif _totalCount &lt; 16&gt;&gt;
Your larder is decently well-stocked with a small variety of food. There&#39;s enough ingredients there for a week or so of meals - or one day, if if you felt the urge to cook up one massive feast.
&lt;&lt;elseif _totalCount &lt; 56&gt;&gt;
Your larder boasts a wealth and variety of foods and ingredients.&lt;&lt;if $sto &gt; _totalCount * 5&gt;&gt; A normal person could get by on this collection for a few weeks, but you reckon you could manage it all in one gluttonous binge if the whim took you...&lt;&lt;else&gt;&gt; It&#39;s enough to get by for a few weeks.&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
Your larder is overflowing with ingredients just begging to be made into a scrumptious feast. Every shelf is so loaded with food that you&#39;d struggle to find room for more, but you&#39;re sure you&#39;ll find space somewhere if needs must...
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;feeder storage info&quot;&gt;&gt;
&lt;hr&gt;
Select any of your items to scrap for ingredients:&lt;br&gt;
&lt;&lt;feeder_larderProvisionsOptions&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Kitchen&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="69" name="Cooking up some grub!" tags="feeder-expansion" position="6500,400" size="100,100">With the fire in your stove heating up and your range of cooking utensils at your disposal, you&#39;re ready to cook up something tasty.
&lt;br&gt;&lt;br&gt;
&lt;&lt;include &quot;feeder storage info&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;feeder_crafting&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Kitchen&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="70" name="Core Species - Vanilla Patch" tags="fixes-and-edits" position="6800,1200" size="100,100">/* This one doesn&#39;t actually do much, because the base game species (with Fixes and Edits additions) are loaded by default - don&#39;t need to overwrite things with the exact same details! */
&lt;&lt;set $options.coreSpeciesBase = true&gt;&gt; /* TODO - don&#39;t know if going to be using this? */</tw-passagedata><tw-passagedata pid="71" name="Core Species Mod Options" tags="mod-support fixes-and-edits" position="6200,1800" size="200,100">/* Add any Core Species Mods options here */
/* The player will be presented with this dropdown during game setup */
&lt;&lt;listbox &quot;$coreSpeciesPassage&quot; autoselect&gt;&gt;
	&lt;&lt;option &quot;Base game species&quot; &quot;Core Species - Vanilla Patch&quot;&gt;&gt;
    &lt;&lt;option &quot;Pokemod Core&quot; &quot;pokemod core patch core species&quot;&gt;&gt;
&lt;&lt;/listbox&gt;&gt;</tw-passagedata><tw-passagedata pid="72" name="Creatorium" tags="feeder-expansion" position="6700,600" size="100,100">&lt;&lt;createFixedNPC &quot;creatoriumTeacher&quot;&gt;&gt;

&lt;p&gt;You arrive in the Creatorium at what you assume to be a &lt;&lt;if $daytime == &quot;morning&quot;&gt;&gt;breakfast&lt;&lt;elseif $daytime == &quot;day&quot;&gt;&gt;lunch&lt;&lt;else&gt;&gt;dinner&lt;&lt;/if&gt;&gt; break - every seat filled with portly students munching on food. $npc1.Article $npc1.species in an ostentatiously bejewelled robe walks between them, inspecting their food and giving the occasional taste-test alongside feedback, which eventually clues you in that all this food is the product of a creation magic lesson.&lt;/p&gt;

The $npc1.species lingers by an apprentice, who grins sheepishly as they present the hock of bread they&#39;ve somehow created. &quot;Focus on making one component at a time,&quot; $npc1.he advises, before walking over to you.&lt;br&gt;
&quot;Here to devote yourself to learning the vast wonders that creation magic can bestow upon you, or are you just here for the //the popular spells//?&quot; $npc1.he asks, casting a tired sideways glance at the students stuffing their faces behind $npc1.him.
&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Creatorium teacher says&quot;&gt;&gt;

&lt;&lt;feeder_vendor &quot;Creatorium&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells&quot; &quot;Learn spells from Creatorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Study hall&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="73" name="Creatorium teacher says" tags="feeder-expansion" position="6900,600" size="100,100">&lt;&lt;setPassageTitle &quot;Talk to the creatorium teacher&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;My name&#39;s $npc1.Name, and I&#39;m sure I could grace your presence with a smidgen of my //precious// time. The misjudgements of my recent past are what have led me to teaching the //riff-raff// here the secrets of creation at this... //fine// establishment. The guildmaster told me my art would prove popular, but oh at what cost...&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Fine works of art, delicate and complex machinery, wealth beyond all imagining - the path of creation, with a proper application of mastery, can yield a mage anything of their wildest fantasies! And yet all these students seem to be interested in is how to conjure ham sandwiches, or chocolate cake, or whatever //basic foodstuffs// seem to be popular in the moment...&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Ever been to the capital? Not that you look the sort. The exquisite statuary at the centrepiece of the main plaza? One of my creations, willed into form by my skill, sharp intellect, and refined tastes. And that foxy hero who has been quite the talk around these parts? Don&#39;t think he would&#39;ve lived long enough to boast of his exploits to every wench who catches his eye, if he hadn&#39;t had the prudence to entrust me with creating his armor! Ah, my talents are wasted here...&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Since the recent //abundance// of food, newer food-based conjurations have somehow been flouting the previously accepted laws regarding the conservation of energy. It&#39;s rather amusing to see the academic fellows around here so riled up on the issue, so at least something interesting has come from this food magic obsession.&quot;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="74" name="Custom Spell Configurations" tags="mod-support fixes-and-edits" position="6500,1900" size="200,100">&lt;&lt;set _spell = setup.getSpell($spellConfig.spell)&gt;&gt;
&lt;&lt;setPopupTitle &quot;Configure: _spell.Name&quot;&gt;&gt;

&lt;&lt;switch _spell.id&gt;&gt;
	/* ICY SPELLS - START */
	&lt;&lt;case &quot;icyspells_enlarge&quot;&gt;&gt;
    &lt;&lt;if not $spellConfig.init&gt;&gt;
			&lt;&lt;set $spellConfig.powerFactor = 0&gt;&gt;
			&lt;&lt;set $spellConfig.mode = &quot;enlarge&quot;&gt;&gt;
			
			&lt;&lt;set $spellConfig.init = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		/* For now, we&#39;ll have fixed stages */
		&lt;&lt;set _enlargeUp = [
			/* RANK 1 */
			{cost: setup.getSpell(&quot;icyspells_enlarge&quot;).cost,
			power: 3/2,
			int: setup.getSpell(&quot;icyspells_enlarge&quot;).int},
			/* RANK 2 */
			{cost: setup.getSpell(&quot;icyspells_enlarge&quot;).cost*3,
			power: 4/2,
			int: setup.getSpell(&quot;icyspells_enlarge&quot;).int+20},
			/* RANK 3 */
			{cost: setup.getSpell(&quot;icyspells_enlarge&quot;).cost*6,
			power: 6/2,
			int: setup.getSpell(&quot;icyspells_enlarge&quot;).int+40},]&gt;&gt;

		&lt;&lt;set _enlargeDown = [
			/* RANK 1 */
			{cost: setup.getSpell(&quot;icyspells_enlarge&quot;).cost,
			power: 2/3,
			int: setup.getSpell(&quot;icyspells_enlarge&quot;).int},
			/* RANK 2 */
			{cost: setup.getSpell(&quot;icyspells_enlarge&quot;).cost*3,
			power: 2/4,
			int: setup.getSpell(&quot;icyspells_enlarge&quot;).int+20},
			/* RANK 3 */
			{cost: setup.getSpell(&quot;icyspells_enlarge&quot;).cost*6,
			power: 2/6,
			int: setup.getSpell(&quot;icyspells_enlarge&quot;).int+40},]&gt;&gt;

		&#39;&#39;Rank &lt;&lt;=$spellConfig.powerFactor+1&gt;&gt;&#39;&#39; 
		
		/* Record currently selected tier */
		&lt;&lt;if $spellConfig.mode == &quot;shrink&quot;&gt;&gt;
			&lt;&lt;set $spellConfig.tieredSpell = _enlargeDown[$spellConfig.powerFactor]&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $spellConfig.tieredSpell = _enlargeUp[$spellConfig.powerFactor]&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		/* Determine what options should be shown */
		/* PLUS OPTION */
		&lt;&lt;set _showPlus = false&gt;&gt;
		&lt;&lt;set _spellTable = _enlargeUp&gt;&gt;
		&lt;&lt;if $spellConfig.mode == &quot;shrink&quot;&gt;&gt;
			&lt;&lt;set _spellTable = _enlargeDown&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;set _nextUp = _spellTable[$spellConfig.powerFactor + 1]&gt;&gt;

		&lt;&lt;if _nextUp and setup.canLearnSpell(_nextUp) and setup.canCastSpell(_nextUp)&gt;&gt;
			&lt;&lt;set _showPlus = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;if _showPlus&gt;&gt;
			&lt;&lt;link &quot;[+]&quot;&gt;&gt;
				&lt;&lt;set $spellConfig.powerFactor += 1&gt;&gt;
				&lt;&lt;run Dialog.wiki(Story.get(&quot;Custom Spell Configurations&quot;).processText())&gt;&gt;
			&lt;&lt;/link&gt;&gt; 
		&lt;&lt;/if&gt;&gt;

		/*&quot;&amp;amp;nbsp;&quot;*/

		/* MINUS OPTION */
		&lt;&lt;set _showMinus = false&gt;&gt;
		&lt;&lt;set _spellTable = _enlargeDown&gt;&gt;
		&lt;&lt;if $spellConfig.mode == &quot;shrink&quot;&gt;&gt;
			&lt;&lt;set _spellTable = _enlargeDown&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;set _nextDown = _spellTable[$spellConfig.powerFactor - 1]&gt;&gt;

		&lt;&lt;if _nextDown and setup.canLearnSpell(_nextDown) and setup.canCastSpell(_nextDown)&gt;&gt;
			&lt;&lt;set _showMinus = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;if _showMinus&gt;&gt;
			&lt;&lt;link &quot;[-]&quot;&gt;&gt;
				&lt;&lt;set $spellConfig.powerFactor -= 1&gt;&gt;
				&lt;&lt;run Dialog.wiki(Story.get(&quot;Custom Spell Configurations&quot;).processText())&gt;&gt;
			&lt;&lt;/link&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;br&gt;
		/* Print the correct costs */
		&lt;&lt;if $spellConfig.mode == &quot;enlarge&quot;&gt;&gt;
			&lt;&lt;=setup.getSpellCosts(_enlargeUp[$spellConfig.powerFactor]).join(&quot;, &quot;)&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;=setup.getSpellCosts(_enlargeDown[$spellConfig.powerFactor]).join(&quot;, &quot;)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;br&gt;&lt;br&gt;
		/* Mode selection - Triggering stuff on radio buttons is a pain, so we&#39;ll just be using links here :p */
		Select a mode: 
		&lt;&lt;if $spellConfig.mode == &quot;enlarge&quot;&gt;&gt;
			GROW | &lt;&lt;link &quot;SHRINK&quot;&gt;&gt;
				&lt;&lt;set $spellConfig.mode = &quot;shrink&quot;&gt;&gt;
				&lt;&lt;set $spellConfig.powerFactor = 0&gt;&gt; /* reset power factor in case costs / requirements are different */
				&lt;&lt;run Dialog.wiki(Story.get(&quot;Custom Spell Configurations&quot;).processText())&gt;&gt;
			&lt;&lt;/link&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;link &quot;GROW&quot;&gt;&gt;
				&lt;&lt;set $spellConfig.mode = &quot;enlarge&quot;&gt;&gt;
				&lt;&lt;set $spellConfig.powerFactor = 0&gt;&gt; /* reset power factor in case costs / requirements are different */
				&lt;&lt;run Dialog.wiki(Story.get(&quot;Custom Spell Configurations&quot;).processText())&gt;&gt;
			&lt;&lt;/link&gt;&gt; | SHRINK
		&lt;&lt;/if&gt;&gt;

		/* setup.getSpellCosts() */
  
	&lt;&lt;case &quot;icyspells_ward&quot;&gt;&gt;
		&lt;&lt;set $spellConfig.init = true&gt;&gt;
		&lt;&lt;set $spellConfig.extraMana = 0&gt;&gt;
		
		Enter the extra mana you&#39;d like to invest in the spell. Each point of mana will increase the ward&#39;s strength by &lt;&lt;=setup.tuning(&quot;icyspells_wardReinforceRate&quot;)&gt;&gt; points.&lt;br&gt;
		&lt;&lt;numberbox &quot;$spellConfig.extraMana&quot; 0&gt;&gt;
	/* ICY SPELLS - END */
	&lt;&lt;default&gt;&gt;
		&#39;&#39;Error in &quot;Custom Spell Logic&quot; - $spellCast.Name missing entry&#39;&#39;
&lt;&lt;/switch&gt;&gt;

/* Always display the option to cast the spell at the end */
&lt;hr&gt;
&lt;div style=&quot;text-align: center;&quot;&gt;[ &lt;&lt;link &quot;Cast&quot;&gt;&gt;
    &lt;&lt;set $spellCast = $spellConfig.spell&gt;&gt;
    &lt;&lt;run Dialog.close()&gt;&gt;
    
    &lt;&lt;if $inCombat &gt;&gt;
    	&lt;&lt;set $action = &quot;Cast&quot;&gt;&gt;
        &lt;&lt;run Engine.play(&quot;Combat&quot;)&gt;&gt;
    &lt;&lt;else&gt;&gt;
    	&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;cast spell&quot;);
				Dialog.wiki(Story.get(&quot;cast spell&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/link&gt;&gt; ]&lt;/div&gt;</tw-passagedata><tw-passagedata pid="75" name="Custom Spell Logic" tags="mod-support fixes-and-edits" position="6500,1800" size="200,100">/* Spells tagged with a `type` of `&quot;custom&quot;` that don&#39;t have their own `castPassage` or `castFunction` will end up looking here for their logic. */
/* Add your spell and it&#39;s logic to the entries here, above the DEFAULT */

&lt;&lt;switch $spellCast.id&gt;&gt;
	/* ICY SPELLS - START */
	&lt;&lt;case &quot;icyspells_levitate&quot;&gt;&gt;
		/* TODO: Implement spell configuring */
		&lt;&lt;if $status.levitateTime &lt;= 0&gt;&gt; /* Spell isn&#39;t already active */
			$spellCast.cast
			
			&lt;&lt;set $status.levitate = setup.tuning(&quot;icyspells_levitateBaseStrength&quot;)&gt;&gt;
			&lt;&lt;set $status.levitateTime = setup.tuning(&quot;icyspells_levitateBaseLength&quot;)&gt;&gt;
		&lt;&lt;else&gt;&gt;
			You renew the strength of the energy keeping your body aloft.
			&lt;&lt;set $status.levitateTime = setup.tuning(&quot;icyspells_levitateBaseLength&quot;)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
        &lt;&lt;updateDescriptions&gt;&gt;
	
	&lt;&lt;case &quot;icyspells_enlarge&quot;&gt;&gt;
		&lt;&lt;set _power = 3/2&gt;&gt;
		&lt;&lt;set _mode = &quot;enlarge&quot;&gt;&gt;
		&lt;&lt;set _costData = $spellCast&gt;&gt;
		
		&lt;&lt;if $spellConfig.init&gt;&gt; /* The spell cast was configured! */
			&lt;&lt;set _power = $spellConfig.tieredSpell.power&gt;&gt;
			&lt;&lt;set _mode = $spellConfig.mode&gt;&gt;
			&lt;&lt;set _costData = $spellConfig.tieredSpell&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _change = &quot;growing&quot;&gt;&gt;
		
		&lt;&lt;if _power &lt; $status.enlarge&gt;&gt; /* shrinking */
			Energy crackles through your body which shrinks to a more diminutive size. 
		&lt;&lt;elseif _power &gt; $status.enlarge&gt;&gt; /* growing */
			Energy crackles through your body as it starts to grow larger and taller. 
		&lt;&lt;elseif _power == $status.enlarge and $status.enlargeTime &gt;=0 &gt;&gt; /* spell is already active, so renew length */
			&lt;&lt;if _power &gt; 1&gt;&gt;
				You renew the power keeping you in your enlarged form. 
			&lt;&lt;else&gt;&gt;
				You renew the power keeping you in your shrunken form. 
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set $status.enlarge = _power&gt;&gt;
		&lt;&lt;set $status.enlargeTime = setup.tuning(&quot;icyspells_enlargeBaseLength&quot;)&gt;&gt;
		
		&lt;&lt;run setup.consumeSpellCosts(_costData)&gt;&gt;
		
		/* Update stats, in a way that won&#39;t defeat the player if they happen to shrink small enough their stomach will have troubles */
		&lt;&lt;set _wasAlive = $alive&gt;&gt;
		
		&lt;&lt;updateStats&gt;&gt; /* The stat changes are all handled here */
		
		&lt;&lt;if _wasAlive and not $alive&gt;&gt; /* Player was KO&#39;d by fullness... honestly could do a better check for this, but whatever xP */
			&lt;&lt;set _failPassage = &quot;As your body shrinks, you feel a growing fullness in your stomach. It seems that while your stomach is shrinking alongside your body, the contents of it aren&#39;t. The sensation in your gut grows concerningly tighter and tighter, the $p.fur on your belly creaking as it reaches an eye-watering strain. Just as you reach the point of exploding, the shrinking around your belly halts. While you watch the rest of your body continue growing smaller, your belly maintains its size, becoming more proportionally mismatched as the remaining seconds of shifting pass. It seems like the effect will hold off on shrinking your stomach any further, for now... &quot;&gt;&gt;
			&lt;&lt;stomachResizeRescue _failPassage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	
   &lt;&lt;case &quot;icyspells_ignite&quot;&gt;&gt;
			/* For whatever reason I&#39;ve decided I want the burning to always be a standardised type, so instead weaknesses and resistances are used for success rates */
			&lt;&lt;set _successChance = setup.tuning(&quot;icyspells_igniteChanceBase&quot;)&gt;&gt;
			
			&lt;&lt;if setup.enemyHasWeakness($spellCast.dType, $e)&gt;&gt;
				&lt;&lt;set _successChance = setup.tuning(&quot;icyspells_igniteChanceWeakness&quot;)&gt;&gt;
			&lt;&lt;elseif setup.enemyHasResistance($spellCast.dType, $e)&gt;&gt;
				&lt;&lt;set _successChance = setup.tuning(&quot;icyspells_igniteChanceResistance&quot;)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;if random(1,100) &lt;= Math.round(_successChance * 100)&gt;&gt; /* Spell succeeded */
				/* Narrate the effect */
				&lt;&lt;if $e.burnTime &gt; 0&gt;&gt; /* The enemy was already burning */
					You shoot a flare of flame from you fingertips, fuelling the flames even more. 
				&lt;&lt;else&gt;&gt;
					Like striking a match, your foe begins to burn in a flare of flames. 
				&lt;&lt;/if&gt;&gt;
				
				/* Get the damage */
				&lt;&lt;set $dmg = setup.xdy($spellCast.damage, $spellCast.dRange)&gt;&gt;
				&lt;&lt;set $dmg += setup.getPlayerSpellBonusDamage()&gt;&gt;
				
				/* Modify it to the spell&#39;s burn amount */
				&lt;&lt;set $dmg *= $spellCast.power&gt;&gt;
				
				/* Then add it to the existing burn damage... */
				&lt;&lt;set $dmg += $e.burn&gt;&gt;
				
				/* TODO: Maybe cap the damage? */
				
				/* Finally, modify it so it&#39;s applied at full damage (the burn buff uses a fraction of damage for burn damage) */
				&lt;&lt;set $dmg /= setup.tuning(&quot;burnProcDamageModifier&quot;)&gt;&gt;
				
				/* Now BURN*/
				&lt;&lt;eBuff &quot;burn&quot; $spellCast.time&gt;&gt;
				
				/* Reset damage in case anything else is planning on using it for things - wouldn&#39;t want this insanely high number to confuse things! */
				&lt;&lt;set $dmg = 0&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;if setup.enemyHasResistance($spellCast.dType, $e)&gt;&gt;
					You shoot a flare of flame from your fingertips, but it fails to ignite your heat-resistant foe. 
				&lt;&lt;else&gt;&gt;
					You shoot a flare of flame from your fingertips, but it doesn&#39;t quite ignite your foe.
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
	
	&lt;&lt;case &quot;icyspells_lesserWard&quot; &quot;icyspells_ward&quot;&gt;&gt; /* Both use the same spell for simplicity
		/* Establish base power */
		&lt;&lt;set _power = setup.xdy($spellCast.damage, $spellCast.dRange)&gt;&gt;
		&lt;&lt;set _power += setup.getPlayerSpellBonusDamage()&gt;&gt;
		
		/* Add bonus power from extra mana spent when configuring the non-lesser version of the spell */
		&lt;&lt;if $spellConfig.init&gt;&gt;
			&lt;&lt;set _bonusPower = $spellConfig.extraMana&gt;&gt;
			&lt;&lt;set _bonusPower = Math.clamp(_bonusPower, 0, variables().mana)&gt;&gt;
			/* Could further cap if planning on implementing a max mana % limit per cast */
			
			&lt;&lt;set _power += _bonusPower * setup.tuning(&quot;icyspells_wardReinforceRate&quot;)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Describe the spell */
		&lt;&lt;if $icyspells_ward &gt; 0&gt;&gt; /* Reinforcing */
			You direct your magic towards your wards, reinforcing those that are waning and patching up gaps in their protection.
		&lt;&lt;else&gt;&gt;
			$spellCast.cast
			&lt;&lt;if $spellConfig.init &gt;&gt; The wards thrum with power as you focus even more energy into them.&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _power = Math.round(_power)&gt;&gt;
		
		/* Functional stuff */
		&lt;&lt;tempBuff &quot;icyspells_ward&quot; _power $spellCast.power&gt;&gt;
		&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
	
	&lt;&lt;case &quot;icyspells_meditate&quot;&gt;&gt;
		/* Do the standard stuff */
		$spellCast.cast
		
		/* Mana is set to not regenerate from the rest, so we&#39;ll need to handle that */
		&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
		&lt;&lt;set _postCastMana = $mana&gt;&gt;
		
		/* Do the actual effect stuff */
		&lt;&lt;doTime $spellCast.time&gt;&gt;
		&lt;&lt;stamina $spellCast.stamina&gt;&gt;
		&lt;&lt;health $end*$spellCast.enduranceMult&gt;&gt;
		&lt;&lt;digest $spellCast.bonusDigest&gt;&gt;
		
		&lt;&lt;set $mana = Math.min(_postCastMana, $mana)&gt;&gt;
		&lt;&lt;set $mana = Math.clamp($mana, 0, $maxMana)&gt;&gt;
		/* does anything need to be run to update these values? */
		
		&lt;&lt;updateClock&gt;&gt;
		
	&lt;&lt;case &quot;icyspells_grease&quot;&gt;&gt;
		/* Do the standard stuff */
		$spellCast.cast
		&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
		
        /* most of the actual effect is handled elsewhere */
		//&lt;li&gt;(Enemy greased)&lt;/li&gt;//
		&lt;&lt;set $e.icyspells_greased = 1&gt;&gt;
	
	&lt;&lt;case &quot;icyspells_explode&quot;&gt;&gt;
		/* Do standard stuff */
		&lt;&lt;if $e.burnTime &gt; 0&gt;&gt;
			A dense orb of swirling energy builds up at your fingertips. You flick it forwards, sending it arching through the air. When it collides with your opponent it explodes outwards into a vortex of flames. The rush of energy fans the already burning flames, bursting with intensity in a brilliant flash. 
		&lt;&lt;else&gt;&gt;
			A dense orb of swirling energy builds up at your fingertips. You flick it forwards, sending it arching through the air. When it collides with your opponent it explodes outwards into a vortex of flames. 
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
		
		/* Do the damage stuff */
		&lt;&lt;set $dmg = setup.xdy($spellCast.damage, $spellCast.dRange)&gt;&gt;
		&lt;&lt;set $dmg += setup.getPlayerSpellBonusDamage()&gt;&gt;
		
		/* Specifically don&#39;t want this spell to trigger the burn effect of grease, so instead we&#39;ll have the option of boosting that damage */
		&lt;&lt;if $e.icyspells_greased &gt; 0&gt;&gt;
			&lt;&lt;set $dmg *= $spellCast.greaseMult&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Boost by all the burning stacks */
		&lt;&lt;if $e.burnTime &gt; 0&gt;&gt;
			&lt;&lt;set $dmg += $e.burn * $e.burnTime&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _damageTypeMultiplier = setup.getEnemyDamageTypeMultiplier($spellCast.dType, $e)&gt;&gt;
		&lt;&lt;set $dmg = Math.round($dmg * _damageTypeMultiplier)&gt;&gt;
		
		/* Manually remove grease now (after it&#39;s contributed to damage effectiveness) */
		&lt;&lt;if $e.icyspells_greased &gt; 0&gt;&gt;
			&lt;&lt;set $e.icyspells_greased = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* End burning */
		&lt;&lt;if $e.burnTime &gt; 0&gt;&gt;
			&lt;&lt;set $e.burn = 0&gt;&gt;
			&lt;&lt;set $e.burnTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;reportEffectiveness $spellCast.dType &quot;enemy&quot;&gt;&gt;
		&lt;&lt;eDamage $dmg&gt;&gt;
	
	&lt;&lt;case &quot;icyspells_heatwave&quot;&gt;&gt;
		/* Do standard stuff */
		&lt;&lt;if $e.burnTime &gt; 0&gt;&gt;
			Oppressive waves of heat radiate from your palms as you thrust them forwards at your foe. They languish beneath the combined heat of the waves and their burning body. 
		&lt;&lt;else&gt;&gt;
			Oppressive waves of heat radiate from your palms as you thrust them forwards at your foe. Small embers start to ignite across their form. 
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
		
		/* Do damage / start burn */
		&lt;&lt;if $e.burnTime &gt; 0&gt;&gt;
			&lt;&lt;eDamage $e.burn&gt;&gt;
			&lt;&lt;set $e.burnTime += $spellCast.extendTime&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $dmg = setup.xdy($spellCast.damage, $spellCast.dRange)&gt;&gt;
			&lt;&lt;set $dmg += setup.getPlayerSpellBonusDamage()&gt;&gt;
			&lt;&lt;set _damageTypeMultiplier = setup.getEnemyDamageTypeMultiplier($spellCast.dType, $e)&gt;&gt;
			&lt;&lt;set $dmg = Math.round($dmg * _damageTypeMultiplier)&gt;&gt;
			
			&lt;&lt;eBuff &quot;burn&quot; $spellCast.time&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	/* ICY SPELLS - END */
	
	
	
	
	/* Add spells ABOVE here */
	&lt;&lt;default&gt;&gt;
		&#39;&#39;Error in &quot;Custom Spell Logic&quot; - $spellCast.Name missing entry&#39;&#39;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="76" name="Enter your basement" tags="feeder-expansion" position="6400,200" size="100,100">/* Not strictly necessary as a passage, but whatever*/
&lt;p&gt;With a sense of apprehension you unlock the basement door and creep inside. The rough stairway down is slick with food stains, a patch of slippery sriracha strawberry sauce heats your $p.feet as you tread in and almost slip on it. Your $p.hands are almost white with how tightly you&#39;re clutching the hand rail, each step bringing you closer to the still yet unseen monster of your creation lurking somewhere in the dim light. As you take the final step you narrowly avoid squashing an unfortunate $rat.species underfoot. It&#39;s lying on its back with a spherical gut bulging out bigger than it is, letting out a few strained squeaks as it languidly tries and fails to scurry away. An unlucky - or lucky, depending on how they see it - victim of your living feast. &lt;/p&gt;
&lt;p&gt;While you&#39;re distracted by the $rat.species you almost don&#39;t notice the tendril of food shoot out from the poorly lit corner of the room. It splatters onto the floor a pace or two away, evidently you&#39;re just out of its reach, reforming and retracting away back into the monstrous mound of living food, as other tendrils pull it from the shadows. It unsteadily shifts its way towards you with a single intent - to have its mad combination of flavors devoured by you! &lt;/p&gt;

&lt;hr&gt;
&lt;&lt;setEnemy $feeder_foodBoss&gt;&gt;
&lt;&lt;set $e.special = &quot;basement&quot;&gt;&gt; /* Let the fight know this is the basement version. */
&lt;&lt;set $e.runnable = true&gt;&gt;
&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="77" name="General Mod Toggles" tags="mod-support fixes-and-edits" position="5800,1800" size="100,100">/* Add the option(s) to enable or disable mods here! */
/* This passage will be automatically included as part of the Mod Options menu, and the Mod Setup passage that appears at the start of the game */
/* Might do something fancy some day to automatically make these, but this&#39;ll do for now */
&lt;ul&gt;
&lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$options.feeder_expansionEnabled&quot; false true autocheck&gt;&gt; &#39;&#39;Feeder expansion&#39;&#39; - Adds the ability to feed enemies in combat, as well as a basic cooking system, spells to create food, and a few basic quests to enhance both.&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$options.downtimeEnabled&quot; false true autocheck&gt;&gt; &#39;&#39;Downtime mod&#39;&#39; - Adds downtime options to quickly eat / train&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$options.icyspells_enabled&quot; false true autocheck&gt;&gt; &#39;&#39;Spellbook selection&#39;&#39; - Adds a selection of new spells&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</tw-passagedata><tw-passagedata pid="78" name="Human Species Add" tags="Human" position="7100,300" size="100,100"></tw-passagedata><tw-passagedata pid="79" name="Kitchen" tags="feeder-expansion" position="6500,500" size="100,100">&lt;&lt;if setup.questCompleted($feeder_questRaccoonFeast) == true and setup.questCompleted($feeder_questWitchSpice) == true and setup.questStarted($feeder_questUltimateCreation) == false&gt;&gt; /* Start ultimate creation quest if meet the requirements */
	&lt;p&gt;As you $walk into your humble kitchen, your thoughts - as they often are nowadays - are of food. With your growing proficiency in the culinary arts, it feels like so many delectable paths have been opening up to you - taste sensations you never knew you were capable of creating. It makes you wonder how much more you&#39;re missing out on. How many recipes //are// there that you&#39;ve yet to learn or taste the fruits of? How many more still are yet to be thought up, because nobody&#39;s dared to pioneer them? &lt;/p&gt;
	&lt;p&gt;Your $waist belly grumbles hungrily as you spend a few lazy moments daydreaming about food. Then, inspiration strikes!&lt;/p&gt;
	&lt;p&gt;All of a sudden your mind is racing with the most delicious idea. You hastily start writing down plans - ideas and timings for the most astounding recipe. //Nobody// would have dared to conceive something like this! &lt;/p&gt;
	
	&lt;&lt;doTime 180&gt;&gt;
	
	&lt;p&gt;After several frenzied hours of writing non-stop, a crazed multi-page long recipe sits before you. You wince slightly as you flex your aching wrist, before gathering up all the pages and embracing them close to your chest. The anticipation of bringing this creation into the world is almost too much to bear, but a lot of preparation is required first... &lt;/p&gt;
	
	&lt;&lt;getItem $feeder_ultimateRecipe&gt;&gt;
	&lt;&lt;getQuest $feeder_questUltimateCreation&gt;&gt;
	
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Kitchen&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt; /* Standard Kitchen */
	&lt;p&gt;You&#39;re standing in your kitchen. The room&#39;s slightly cramped, but it&#39;s got everything you need to cook up some food when the mood takes you. There&#39;s a larder in the corner where you keep stock of all your food and ingredients, and a rustic wood-burning stove where you put those ingredients to good use. &lt;/p&gt;

	/* Reset selected crafting option. One of the least hacky ways I could think to do this... */
	&lt;&lt;set $feeder_selectedRecipe = null&gt;&gt;

	&lt;&lt;action &quot;n&quot; &quot;restaurant&quot; &quot;Cook food&quot; &quot;Cooking up some grub!&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;ne&quot; &quot;inventory&quot; &quot;Check ingredients stock&quot; &quot;Check Larder&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;s&quot; &quot;return&quot; &quot;Main room&quot; &quot;Your House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

	/* While the monster is active, add some extra narration, as well as the enter basement option. */
	&lt;&lt;if $feeder_ultimateMonsterAlive == true&gt;&gt;
		&lt;p&gt;The thick scent of a mighty feast wafts into the room through the locked door to the basement in the corner of the room. Occasionally there&#39;s the wet thumps of the monster you created shifting around down there, its frustration growing as its desire to be eaten goes unanswered. &lt;/p&gt;
		&lt;&lt;action &quot;nw&quot; &quot;leave&quot; &quot;Enter the basement&quot; &quot;Enter your basement&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="80" name="Learn spells from Creatorium" tags="feeder-expansion" position="6800,600" size="100,100">&lt;&lt;teach&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Creatorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="81" name="Mod Options" tags="fixes-and-edits" position="6900,1200" size="100,100">/* Popup menu that&#39;s displayed by an option in &quot;Options&quot; */
&lt;&lt;include &quot;manual mod patch option&quot;&gt;&gt;
&lt;hr&gt;
&lt;b&gt;&lt;u&gt;Configure Mod Settings&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
&lt;i&gt;(Settings for mods you don&#39;t have enabled will still be shown here)&lt;/i&gt;
&lt;&lt;include &quot;Mod Settings&quot;&gt;&gt;
&lt;hr&gt;
&lt;div id=&quot;modOptionsSpeciesMods&quot;&gt;
&lt;b&gt;&lt;u&gt;Enable / Disable Mods&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
&lt;&lt;include &quot;Species Mod Toggles&quot;&gt;&gt;
&lt;/div&gt;
&lt;div id=&quot;modOptionsGeneralMods&quot;&gt;
&lt;&lt;include &quot;General Mod Toggles&quot;&gt;&gt;
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="82" name="Mod Settings" tags="mod-support" position="5900,1800" size="100,100">/* Place any settings for your mods here! They will appear in the Mod Options menu */
/* For enabling / disabling mods, use `General Mod Toggles` or `Species Mod Toggles` instead */
/* If your mods are complicated enough, you could instead link to a dedicated menu that holds all your settings */
/* TODO:
- Make it so only active mods show?
- Put settings in alongside their mod toggles?
*/</tw-passagedata><tw-passagedata pid="83" name="Mod Setup" tags="fixes-and-edits intro" position="6700,1200" size="100,100">/* This passage is displayed during the start of game process, to enable / disable mods */

/* Let&#39;s enable some mods from the pack by default :3 */
&lt;&lt;set $options.feeder_expansionEnabled = true&gt;&gt;
&lt;&lt;set $options.downtimeEnabled = true&gt;&gt;
&lt;&lt;set $options.icyspells_enabled = true&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;What&#39;s your name&quot;&gt;&gt;
    /* Run patch so core species will be available later at the species editing stage */
    &lt;&lt;include &quot;mods patch and update&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;p&gt;
&lt;b&gt;&lt;u&gt;Mod Setup&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
Select what mods you would like to have enabled. Most can be enabled and disabled later on during gameplay.
&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;
&lt;b&gt;&lt;u&gt;Core Species&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
&lt;&lt;include &quot;Core Species Mod Options&quot;&gt;&gt; Select the style of species you want to have available in-game. Unlike most options, this one isn&#39;t intended to be changed after this point.
&lt;/p&gt;
&lt;p&gt;
&lt;div id=&quot;setupSpeciesMods&quot;&gt;
&lt;b&gt;&lt;u&gt;Additional Species Mods&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
Additional species can be added or removed at any time.
&lt;&lt;include &quot;Species Mod Toggles&quot;&gt;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div id=&quot;setupGeneralMods&quot;&gt;
&lt;b&gt;&lt;u&gt;Other Mods&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
&lt;&lt;include &quot;General Mod Toggles&quot;&gt;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;
&lt;b&gt;&lt;u&gt;Configure Mod Settings&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
&lt;i&gt;(Settings for mods you don&#39;t have enabled will still be shown here)&lt;/i&gt;
&lt;&lt;include &quot;Mod Settings&quot;&gt;&gt;
&lt;/p&gt;</tw-passagedata><tw-passagedata pid="84" name="Modding Support - README" tags="fixes-and-edits mod-support" position="5800,1500" size="200,100">(This is very much in development, and also suffered a *slight* setback when I accidentally deleted everything)


=========
	PATCHING
=========
The concept of patchers exist as an attempt to help minimise the number of edits required to be made to the base game passages, and to help in updating mods or introducing them to existing saves. A patcher is essentially just a passage designed to set up any variables a mod may need, as well as alter existing variables - it won&#39;t eliminate the need for core edits, but will at least cover those scenarios.

== WHEN PATCHING OCCURS ==
Patches will run whenever:
- A fresh save has started. This means all fresh games will have your patches ready at the get-go, no need to hard edit things in (well, things that can be patched, anyway).
- Character creation finishes. This one is here just in case you want to conditionally want to patch something about the once you know the mod is active, before the player experiences anything in the world.
- A save is loaded. This helps automatically update old saves to newer mod versions.
- Patches are manually run through the options menu.

== PATCH RESETS ==
The following aspects of the game are always completely reverted back to default when a patch process runs, and so edits or additions to them made by patches should be done *every time* your patcher runs:
- Species
- NPCs
- Enemies
- Spells

In the future, more aspects will likely be added to this list.

== MAKING A PATCHER ==
At its most basic, a patcher is just a passage where you make any necessary modifications.

= Writing the passage =
Just write in all the variable declarations or variable changes you want to make inside the passage. That&#39;s basically it. You could do something smart and track mod versions so you don&#39;t have to apply the patches all the time, but there&#39;s not really any reason for it, and in fact it could harm you if you accidentally include a patch for an element that *should* be patched every run (see: patch resets) in a section that&#39;s only run once.

You can utilise one of the mod support features to inform the player that a mod has been updated when they load a save from an older version of the mod. Use this once when your mod is updating:
```
&lt;&lt;set setup.modUpdated = true&gt;&gt; /* Flag that an update has happened */
&lt;&lt;set setup.modUpdatedList.push(&quot;Your mod name&quot;)&gt;&gt; /* Add to list of updated mods */
```

- Recommended Setup -
Here&#39;s how I would recommend setting up a patch passage:
- At the top of the file, use a temporary variable to track the current mod release version. Whenever you update the mod, increase that version. Also keep track of the save&#39;s version through use of a global variable. Include a check to compare those two variables, and when they don&#39;t match you can trigger the mod updated message, and update the global variable to reflect this new version.
- I&#39;d honestly not bother trying to split up what gets patched at what version - just allow everything to run every time the patch passage is run. Unless you&#39;re doing something crazy, there shouldn&#39;t be any performance impact, and even if there is it only effects starting / loading a game.
- If your patch passage gets too long to be manageable, split it up into multiple passages. In the main patch passage, `&lt;&lt;include&gt;&gt;` the others.

Example setup:
```
&lt;&lt;set _modVersion = 1&gt;&gt; /* Manually update this hardcoded value each time you make a new version of the mod */

&lt;&lt;if $myMod_saveVersion &lt; _modVersion&gt;&gt; /* Check to see if the mod has been updated since the last save */
	&lt;&lt;set setup.modUpdated = true&gt;&gt; /* Flag that an update has happened */
	&lt;&lt;set setup.modUpdatedList.push(&quot;Your mod name&quot;)&gt;&gt; /* Add to list of updated mods */
	
	/* (If you absolutely need to do something when changing between versions in a save, you could add checks for what version it&#39;s being updated from, and perform special things here) */
	
	/* Either write out what needs patching here, or include passages containing them if that&#39;s too long and you like neatness */
	&lt;&lt;include &quot;my mod patch enemies&quot;&gt;&gt;
	&lt;&lt;include &quot;my mod patch npcs&quot;&gt;&gt;
	
	/* Update the recorded version in the save, so this doesn&#39;t happen again */
	&lt;&lt;set $myMod_saveVersion = _modVersion&gt;&gt;
&lt;&lt;/if&gt;&gt;
```

*(Note that actually none of my mods thus far use this setup, because I&#39;ve only recently figured this all out.)*

= Making it used =
To make it so your patcher is actually run, find the passage `mods patch and update` and include your passage there (using the `&lt;&lt;include&gt;&gt;` macro). That&#39;s all that&#39;s necessary - now your patch will be automatically run whenever patching occurs.

Example: `&lt;&lt;include &quot;icyibis patch and update&quot;&gt;&gt;`

== USEFUL THINGS ==
- `setup.registerSpecies(object, id)` - Add / update a species. Properties in `object` are merged on top of the existing species, or used as the species object in the case of it being a new species. `id` is the identifier for the species - if it&#39;s missing, then the `id` property inside `object` will be used instead.
- `setup.getSpeciesData(species)` - Returns the species object of the given species. For most cases `species` should be the string ID for the species you want. Useful in scenarios where you want to make passages core species agnostic e.g. `&quot;I&#39;m so hungry I could eat a &lt;&lt;=setup.getSpeciesData(&quot;horse&quot;).species&gt;&gt;!&quot;`
- `setup.registerNPC(id, object)` - Add / update an NPC. Properties in `object` are merged on top of the existing NPC, or used as the NPC object in the case of it being a new NPC.
- `setup.registerSpell(object, id)` - Add / update a spell. Properties in `object` are merged on top of the existing spell, or used as the spell object in the case of it being a new spell.

=======
	TUNING
=======
Tunings are variables used to govern how game mechanics work, like outlining how many points can be spent on stats during character creation, or how much food gets digested per minute. They aren&#39;t intended to be changed during gameplay, however there is the option to set tuning values on a per-save basis, so options can be used to configure the values.

For example, the player&#39;s maximum height is required to be known in several places - rather than hardcoding a value in each place it&#39;s used, we can use a tuning variable for it instead. That way, it&#39;s much easier to later change the values if we want to.

== TUNING FUNCTIONS ==

- `setup.getTuningValue(id)` - Gets the value of a tuning variable. Prioritises fetching per-save tuning variables, defaulting to the global version if one isn&#39;t found. You can also use `setup.tuning(id)` as a shortcut.
- `setup.registerTuning(id, value)` - Adds a global tuning variable (or overwrites an existing one with that id). You can also use `setup.tune(id, value)` as a shortcut.
- `setup.registerSaveTuning(id, value)` - Adds a per-save version of a tuning variable (or overwrites and existing per-save variable with that id). When fetching a tuning variable&#39;s value, per-save tuning variables are prioritised over the global versions. You can also use `setup.tuneSave(id, value)` as a shortcut.
- `setup.unregisterSaveTuning(id)` - Deletes a per-save tuning variable.

*(Note: tuning is very much early in implementation and very few things are actually hooked up to it at the moment)*

==============
	SETUP LOWDOWN
==============

- Most executable functions can be found in the `widgets` passages.
- Definitions for most *things* (like items, species, quests) are defined in their own dedicated passages with the names either mentioning `variables`, `objects`, or `enemies`.

==============
	MISC/UNSORTED
==============

- `&lt;&lt;setPassageTitle &quot;New title&quot;&gt;&gt;` - Place within a passage to change the title that&#39;s displayed. Useful in situations where you need to be able to adapt certain sections of it based on variables (such as mention of a species name).
- `&lt;&lt;setPopupTitle &quot;New title&quot;&gt;&gt;` - As `setPassageTitle`, but intended for when the passage is viewed as a popup.

== Making Statuses ==
- Widgets / removeStatus: Set it to its default values.
- player status: Add a description for the status being active.
- time widgets / eventTime: Track the status duration for expiry, and narrate the expiry when it&#39;s over.

Optional:
- status effects: If the status has a per-turn effect in combat, add the effect here.</tw-passagedata><tw-passagedata pid="85" name="Plan some downtime" tags="downtime-mod" position="6100,1200" size="100,100">/* Set options to their defaults once this screen is entered */
&lt;&lt;set $downtime_optionsSelected = {
	training: {
    	strength: false,
        agility: false,
        intelligence: false,
    },
    eating: 100,
    diet: &quot;mixed&quot;,
    days: 1,
}&gt;&gt;

/* Begin the actual text */
&lt;p&gt;Despite your yearning for adventure, the call of an easy life at home does sound appealling. Perhaps a break wouldn&#39;t hurt, if only for a little while...&lt;br&gt;
&lt;br&gt;
Use the options below to set what you want to do in your downtime.&lt;/p&gt;
&lt;hr&gt;

&lt;p&gt;&lt;u&gt;&lt;b&gt;Train&lt;/b&gt;&lt;/u&gt;&lt;br&gt;
Hone your skills during your free time. Your attention will be split evenly across all the activities you choose.
&lt;ul&gt;
  &lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$downtime_optionsSelected.training.strength&quot; false true autocheck&gt;&gt; Lift weights&lt;/label&gt;&lt;/li&gt;
  &lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$downtime_optionsSelected.training.agility&quot; false true autocheck&gt;&gt; Run track&lt;/label&gt;&lt;/li&gt;
  &lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$downtime_optionsSelected.training.intelligence&quot; false true autocheck&gt;&gt; Study&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;p&gt;&lt;u&gt;&lt;b&gt;Eat&lt;/b&gt;&lt;/u&gt;&lt;br&gt;
Plan the level of indulgence you wish to enjoy in your downtime
&lt;ul&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; 0 autocheck&gt;&gt; Go hungry&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;
In normal terms:
&lt;ul&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; &quot;normal&quot; autocheck&gt;&gt; Eat a normal amount&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;
Accounting for your stomach size:
&lt;ul&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; 25 autocheck&gt;&gt; Fast&lt;/label&gt;&lt;/li&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; 50 autocheck&gt;&gt; Eat modestly&lt;/label&gt;&lt;/li&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; 75 autocheck&gt;&gt; Splurge a little&lt;/label&gt;&lt;/li&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; 100 autocheck&gt;&gt; Overindulge&lt;/label&gt;&lt;/li&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.eating&quot; 130 autocheck&gt;&gt; Push your limits (stomach will grow)&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;p&gt;&lt;u&gt;&lt;b&gt;Diet&lt;/b&gt;&lt;/u&gt;&lt;br&gt;
Plan what sort of diet you&#39;ll stick to.
&lt;ul&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.diet&quot; &quot;healthy&quot; autocheck&gt;&gt; Healthy&lt;/label&gt;&lt;/li&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.diet&quot; &quot;mixed&quot; autocheck&gt;&gt; Mixed&lt;/label&gt;&lt;/li&gt;
	&lt;li&gt;&lt;label&gt;&lt;&lt;radiobutton &quot;$downtime_optionsSelected.diet&quot; &quot;fattening&quot; autocheck&gt;&gt; Fattening&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;p&gt;&lt;u&gt;&lt;b&gt;Time&lt;/b&gt;&lt;/u&gt;&lt;br&gt;
Decide how many days you want to take a break from adventuring for. If you run out of gold (if eating), or fat (if training), your break will end earlier than planned.&lt;/p&gt;
&lt;p&gt;&lt;label&gt;Days to spend: &lt;&lt;numberbox &quot;$downtime_optionsSelected.days&quot; 1&gt;&gt;&lt;/label&gt; (&lt;&lt;link &quot;Preview costs and results&quot;&gt;&gt;&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Downtime forecast...&quot;);
	Dialog.wiki(Story.get(&quot;downtime forecast&quot;).processText());
	Dialog.open();
&lt;&lt;/script&gt;&gt;&lt;&lt;/link&gt;&gt;)&lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Enjoy some downtime&quot; &quot;A break from adventuring&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Keep adventuring&quot; &quot;Your House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="86" name="Pokemod" tags="pokemod" position="7000,800" size="200,100">Pokemod Core is a core species mod that replaces the core species with the closest Pokemon equivalents. Pokemod Plus adds additional species.

(I just made this as a passage to look more organised)</tw-passagedata><tw-passagedata pid="87" name="Questioning the beachside chef" tags="feeder-expansion" position="6400,1000" size="100,100">&lt;p&gt;The $npc1.species chuckles loudly, slapping $npc1.his belly a couple of times. &quot;I betcha&#39;d like to know!&quot; &lt;/p&gt;
&lt;p&gt;$npc1.He settles down and sighs, grabbing up $npc1.his knives ready for cooking, before noticing you&#39;re still looking at $npc1.him expectantly. &quot;Wait, are ya serious?&quot; &lt;/p&gt;
&lt;p&gt;You nod. &lt;/p&gt;
&lt;p&gt;&quot;Well, I can&#39;t exactly go &#39;round givin&#39; out my secret techniques to jus&#39; about anyone, can I?&quot; $npc1.He says, casually chatting as $npc1.he tops, tails, guts, and slices a fish in several flashes of expert knifemanship. &quot;Though it is flatterin&#39; for a fellow chef to take an interest!&quot;&lt;/p&gt;
&lt;p&gt;In one fluid motion $npc1.he empties the chopped fish into a sizzling pot of oil, sets aside the chopping board, and leans over on the counter. &quot;&#39;Course, it&#39;d be pretty rude of me to turn ya away without givin&#39; you a shake. Tell ya what, why don&#39;t you bring me a spread so I can see whatcha got? Nothin&#39; fancy mind, jus&#39; some good ol&#39; regular meals. I&#39;m not promisin&#39; anything, mind you!&quot;&lt;/p&gt;
&lt;p&gt;&quot;Deal?&quot; $npc1.he asks, wiping $npc1.his $npc1.hand on $npc1.his apron before holding it out to you. You shake on it, $npc1.his firm and slightly fishy grasp squeezing your $p.hand tightly. &quot;Atta $p.boy! Be nice to have someone else cook for //me// for a change. Heh!&quot;&lt;/p&gt;

&lt;&lt;getQuest $feeder_questRaccoonCook&gt;&gt;

&lt;p&gt;The $npc1.species goes back to prepping up some more seafood, adding a pinch of spices to the sizzling pot. &quot;While ya here, fancy buyin&#39; anythin&#39;?&lt;/p&gt;
&lt;&lt;if $eventCounterB == &quot;beach&quot;&gt;&gt;
	&lt;&lt;vendor &quot;beach raccoon&quot;&gt;&gt;
	&lt;&lt;store&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;beach&quot; &quot;Done&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;vendor &quot;ocean raccoon&quot;&gt;&gt;
	&lt;&lt;store&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;ocean&quot; &quot;Done&quot; &quot;Goodbye ocean vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="88" name="Recreating your ultimate creation!" tags="feeder-expansion cutscene" position="6600,200" size="100,100">/* This passage should be given the `cutscene` tag! */

&lt;&lt;if $feeder_ultimateMonsterAlive != true&gt;&gt; /* Setting up the encounter, and presenting the player with a choice */
	&lt;p&gt;With a perhaps misplaced sense of nostalgia, you find yourself thinking back on the living food abomination you accidentally created with a fondness. Ah, all that passion and freedom, breaking all the rules of gastronomy; a hard day&#39;s work rewarded with the taste of exotic flavor combinations! Your mouth waters at the memories. Perhaps it&#39;s time enjoy that experience once again... &lt;/p&gt;
	&lt;p&gt;Digging out the old recipe, your pour through your notes with growing anticipation. Soon, every surface of your kitchen is covered once more in mixing bowls and pots and various ingredients in different states of preparation. You move between them in a maddened frenzy, chopping here, mixing there, cooking up a storm. &lt;/p&gt;
	&lt;p&gt;The hours pass by without you noticing, that is until the last piece is put in place and you&#39;re finally hit by the exhausted ache of your body. You step back, wiping sweat from your brow with the back of your $p.hand, smearing food on your forehead in the process, and take a moment to bask in the glory of your creation. The towering monument of culinary hubris stands as tall as you, a multi-tiered mound of forbidden food fusions, glistening with toppings of creams, sauces, and every sort of topping you&#39;d see on a pizza. &lt;/p&gt;
	&lt;p&gt;All that&#39;s left is the final touch, though this time you have the foresight to move the feast into the basement first in case things go awry. It&#39;s an exhausting and messy task, but after a few minutes and spillages you manage to heave it down the stairs, placing it in the center of the room. You crack the spectrum gem in your $p.hand, sprinkling a generous dusting of the rainbow glitter across the whole feast, having to stand on your toes to reach the top. The mound shudders once, then again twice more. Its movements start to become slowly more fluid as if the abomination is just waking up from a deep slumber. &lt;/p&gt;
	&lt;p&gt;While the creation still stirs into life, you still have the option to leave before it can try to stop you. &lt;/p&gt;

	&lt;&lt;set $feeder_ultimateMonsterAlive = true&gt;&gt;
	
	&lt;&lt;action &quot;w&quot; &quot;attack&quot; &quot;Fight&quot; &quot;Recreating your ultimate creation!&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;fight&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Kitchen&quot;&gt;&gt;
		&lt;&lt;addPretext &quot;You hurry off up the stairs just as the abomination starts reaching out foody tendrils towards you. Slamming the basement door shut, you lock that meal up to be enjoyed at a later date. &quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
	
&lt;&lt;else&gt;&gt; /* Player has made their choice */
	&lt;&lt;if $eventCounterA == &quot;fight&quot;&gt;&gt;
		&lt;p&gt;Licking your lips, you prepare to enjoy the reward to all your hard work. &lt;/p&gt;
		&lt;hr&gt;
		
		&lt;&lt;setEnemy $feeder_foodBoss&gt;&gt;
		&lt;&lt;set $e.special = &quot;basement&quot;&gt;&gt; /* Let the fight know this is the basement version. */
		&lt;&lt;set $e.runnable = true&gt;&gt;
		&lt;&lt;startCombat&gt;&gt;
	&lt;&lt;else&gt;&gt;
		/* No other options atm */
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="89" name="Search the Cupboards" tags="feeder-expansion" position="6500,800" size="100,100">/* (Cupboards are option in witch&#39;s kitchen to find the black spice) */
&lt;p&gt;Snubbing the delicious-looking food, you begin digging through the cupboards for anything valuable...&lt;/p&gt;
&lt;p&gt;In place of ingredients, most of the cupboards are filled completely full with walls of desserts and confectioneries. Every time you open a door, you&#39;re assaulted by a fresh mouthwatering assortment of sights and scents. A few contain non-food items like cutlery, plates, and cooking utensils, though they&#39;re all made of candy, so you&#39;re not sure you can fully classify them as //non-food//.&lt;/p&gt;
&lt;p&gt;After a while of searching, you open up what looks and smells to be a spice cupboard, with multiple containers set out in a gingerbread spice rack. The large shakers are made of peppermint - which you&#39;re not sure is the best way to store spices without tainting them - each with different colored swirls. Thinking they might be color-coded based on contents, you grab the one made up of black-and-white swirls and peak inside.&lt;/p&gt;
&lt;p&gt;The powder inside is inky black, and you experimentally dab a bit on your tongue. Almost immediately your mouth is drooling, and you feel a strong urge to return to one of those dessert-filled cupboards. Yep, this is the highly-appetizing spice the witch&#39;s notes talked about alright.&lt;/p&gt;
&lt;&lt;getItem $feeder_addictiveSpice&gt;&gt;
&lt;&lt;questReward $feeder_questWitchSpice&gt;&gt;
&lt;li&gt;You can now cook &#39;&#39;appetizing meals&#39;&#39;.&lt;/li&gt;
You smile to yourself as you open up your pack, and almost drop the shaker on the floor as a voice startles you from behind.
&lt;br&gt;&lt;br&gt;
&quot;Think you can just help yourself to whatever you feel like, hm?&quot; the witch asks, grinning a wicked grin. &quot;Well, I&#39;ve got plenty more things you greedily little thing can have - open wide! Hee hee hee!&quot;
&lt;hr&gt;
&lt;&lt;setEnemy $gingerbreadWitch&gt;&gt;
&lt;&lt;set $e.special = &quot;no captive&quot;&gt;&gt;
&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="90" name="Seaside Feast" tags="feeder-expansion" position="6600,1000" size="100,100">&lt;&lt;set _stage = $eventCounterA&gt;&gt;
&lt;&lt;set _location = $eventCounterB&gt;&gt;
&lt;&lt;set _quest = $quests[setup.questIndex($feeder_questRaccoonFeast)]&gt;&gt;

/* Used in descriptions later */
&lt;&lt;set _warmThing = &quot;the sun&quot;&gt;&gt;
&lt;&lt;if $daytime == &quot;night&quot;&gt;&gt;
	&lt;&lt;set _warmThing = &quot;the toasty cooking flames&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _stage == &quot;before&quot; or _stage == 0&gt;&gt;
	&lt;&lt;if _location == &quot;ocean&quot;&gt;&gt;
		&lt;p&gt;The $npc1.species winces through $npc1.his teeth. &quot;Let&#39;s do this some other time on dry land, eh? Don&#39;t wanna find out ya sea legs aren&#39;t up to snuff halfway through a big feast.&quot; &lt;/p&gt;
		&lt;p&gt;&quot;Though while you&#39;re here, why not grab something for the road?&quot; &lt;/p&gt;
		&lt;&lt;vendor &quot;ocean raccoon&quot;&gt;&gt;
		&lt;&lt;store&gt;&gt;
		&lt;&lt;action &quot;c&quot; &quot;ocean&quot; &quot;Done&quot; &quot;Goodbye ocean vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $gld &lt; 100&gt;&gt; /* Player doesn&#39;t have enough gold (technically costs come to 110 but 100 is a nicer number :p) */
			&lt;p&gt;You plop yourself onto a stool, eager to prove yourself. You give the $npc1.species a look, and $npc1.he nods. &lt;/p&gt;
			&lt;p&gt;&quot;Ya ready, then?&quot; $npc1.he chuckles grabbing $npc1.his knife and cutting board. You nod, and $npc1.he smiles, leaning over the counter with $npc1.his palm outstretched. &quot;Well, there is the small matter o&#39; payment... Don&#39; wanna really have ta bring it up, but I can&#39;t afford to go outta pocket if ya can&#39;t finish it all, now can I?&quot; &lt;/p&gt;
			&lt;p&gt;Your gold clatters into $npc1.his $npc1.hand as you empty your whole coin purse, and $npc1.he takes a moment to count it all, $npc1.his smile turning to a polite grimace. &quot;That&#39;s... not exactly enough to cover it, sorry,&quot; $npc1.he says, handing the gold back to you. &quot;Come back when you&#39;ve got the cash. Don&#39;t worry, I&#39;m not goin&#39; anywhere.&quot; &lt;/p&gt;
			&lt;&lt;if $gld &lt; 20&gt;&gt;
				&lt;p&gt;&quot;I would ask if ya wanted to buy anything, but well...&quot; &lt;/p&gt;
				
				&lt;&lt;action &quot;c&quot; &quot;beach&quot; &quot;Oh...&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;p&gt;&quot;While ya here, maybe ya wanna buy something a lil smaller?&quot; &lt;/p&gt;
				
				&lt;&lt;vendor &quot;beach raccoon&quot;&gt;&gt;
				&lt;&lt;store&gt;&gt;
				&lt;&lt;action &quot;c&quot; &quot;beach&quot; &quot;Done&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt; /* Player has enough money */
			&lt;p&gt;You plop yourself onto a stool, eager to prove yourself. You give the $npc1.species a look, and $npc1.he nods. &lt;/p&gt;
			&lt;p&gt;&quot;Ya ready, then?&quot; $npc1.he chuckles grabbing $npc1.his knife and cutting board. You nod, and $npc1.he smiles, leaning over the counter with $npc1.his palm outstretched. &quot;Well, there is the small matter o&#39; payment... Don&#39; wanna really have ta bring it up, but I can&#39;t afford to go outta pocket if ya can&#39;t finish it all, can I?&quot; &lt;/p&gt;
			&lt;p&gt;Your gold clatters into $npc1.his $npc1.hand and $npc1.he takes a moment to count it all. &quot;Looks good ta me!&quot; &lt;/p&gt;
			&lt;&lt;if _quest.triedAndFailed == true&gt;&gt; /* Player failed their previous attempt at this */
				&lt;p&gt;As $npc1.he sharpens $npc1.his knives $npc1.he gives you a wary glance. &quot;Reckon ya can take it, this time? Don&#39;t really wanna see a repeat of last time...&quot; &lt;/p&gt;
			&lt;&lt;elseif $sto &lt; 50 &gt;&gt; /* Way off the 133 requirement */
				&lt;p&gt;$npc1.He goes too and fro readying up ingredients, before giving you a once-over and wincing. &quot;Ya really sure ya wanna go through with this, $p.buddy? This isn&#39;t some regular ol&#39; feast...&quot; &lt;/p&gt;
			&lt;&lt;else&gt;&gt;
				&lt;p&gt;$npc1.He goes too and fro readying up ingredients, &quot;Ya ready for this? Last chance to back down, if not.&quot; &lt;/p&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Yes&quot; &quot;Seaside Feast&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = &quot;start&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
			&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;No&quot; &quot;Seaside Feast&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = &quot;decline&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif _stage == &quot;decline&quot;&gt;&gt;
	&lt;p&gt;$npc1.He chuckles to $npc1.himself, &quot;Fair enough! Can I get ya somethin&#39; a lil less sizeable while ya here?&quot; &lt;/p&gt;
	
	&lt;&lt;vendor &quot;beach raccoon&quot;&gt;&gt;
	&lt;&lt;store&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;beach&quot; &quot;Done&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _stage == &quot;start&quot;&gt;&gt;
	&lt;&lt;doGld -100&gt;&gt;
	
	&lt;p&gt;In a blur of speed, flashes of knifemanship, and the hiss of sizzling oil, the $npc1.species gets to preparing all the dishes at once. You&#39;re content to sit and watch $npc1.his work closely, and in almost no time at all $npc1.he&#39;s bringing you the first serving. &lt;/p&gt;
	&lt;&lt;if _quest.triedAndFailed == true&gt;&gt;
		&lt;p&gt;&quot;Here&#39;s hopin&#39; ya fare better than last time, eh?&quot; &lt;/p&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _quest.roundsLeft = [&quot;rice&quot;, &quot;shrimp&quot;, &quot;calamari&quot;, &quot;sushi&quot;]&gt;&gt;
	&lt;&lt;set _quest.triedAndFailed = false&gt;&gt;
	
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;It begins...&quot; &quot;Seaside Feast&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;newDish&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _stage == &quot;newDish&quot;&gt;&gt;
	&lt;&lt;set _quest.currentDish = _quest.roundsLeft.pluck()&gt;&gt;
	
	/* Narrate each dish */
	&lt;&lt;switch _quest.currentDish&gt;&gt;
		&lt;&lt;case &quot;rice&quot;&gt;&gt;
			&lt;p&gt;The $npc1.species sets down a steaming bowl of fluffy rice in front of you, delicately topping it with an herb garnish placed perfectly in the center. &lt;/p&gt;
		&lt;&lt;case &quot;shrimp&quot;&gt;&gt;
			&lt;p&gt;The $npc1.species lays out a ringed platter of jumbo, deep fried shrimp fresh from the pan. The golden-brown pieces of crispy seafood are arranged around a generously sized pot of dip in the middle. &lt;/p&gt;
		&lt;&lt;case &quot;calamari&quot;&gt;&gt;
			&lt;p&gt;Scooped straight out of the oil, the $npc1.species plates up the fried calamari, adds the creamy dipping sauce, then sets it down on the counter in front of you. &lt;/p&gt;
		&lt;&lt;case &quot;sushi&quot;&gt;&gt;
			&lt;p&gt;You watch the $npc1.species rolling up each sushi roll with surprising dexterity before $npc1.he seasons them with seeds and sauce, then dishes them up to you. &lt;/p&gt;
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Seaside Feast&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;eat&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Give up&quot; &quot;Seaside Feast&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;quit&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _stage == &quot;eat&quot;&gt;&gt;
	/* Narrate each dish */
	/* (currently using item eat for now) */
	
	&lt;&lt;switch _quest.currentDish&gt;&gt;
		&lt;&lt;case &quot;rice&quot;&gt;&gt;
			&lt;&lt;set _item = $riceBowl&gt;&gt;
			&lt;p&gt;_item.itemUse&lt;/p&gt;
			
			&lt;&lt;consume _item.eat _item.calories&gt;&gt; 
		&lt;&lt;case &quot;shrimp&quot;&gt;&gt;
			&lt;&lt;set _item = $tempuraShrimp&gt;&gt;
			&lt;p&gt;_item.itemUse&lt;/p&gt;
			
			&lt;&lt;consume _item.eat _item.calories&gt;&gt; 
		&lt;&lt;case &quot;calamari&quot;&gt;&gt;
			&lt;&lt;set _item = $calamari&gt;&gt;
			&lt;p&gt;_item.itemUse&lt;/p&gt;
			
			&lt;&lt;consume _item.eat _item.calories&gt;&gt; 
		&lt;&lt;case &quot;sushi&quot;&gt;&gt;
			&lt;&lt;set _item = $sushiRoll&gt;&gt;
			&lt;p&gt;_item.itemUse&lt;/p&gt;
			
			&lt;&lt;consume _item.eat _item.calories&gt;&gt; 
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;if $alive&gt;&gt;
		&lt;&lt;if _quest.roundsLeft.length &gt; 0&gt;&gt;
			&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Another!&quot; &quot;Seaside Feast&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = &quot;newDish&quot;&gt;&gt;
			&lt;&lt;/action&gt;&gt;
			&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Give up&quot; &quot;Seaside Feast&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = &quot;quit&quot;&gt;&gt;
			&lt;&lt;/action&gt;&gt;
		&lt;&lt;else&gt;&gt; /* That was the last dish */
			&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Another...?&quot; &quot;Seaside Feast&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = &quot;victory&quot;&gt;&gt;
			&lt;&lt;/action&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt; /* being dead is already handled later */

&lt;&lt;elseif _stage == &quot;victory&quot;&gt;&gt;
	&lt;p&gt;Finishing the rest of a delicious mouthful, you let out a satisfied //UURP//. You wipe your mouth clean with the back of your $p.hand while glancing over to the $npc1.species, ready for whatever&#39;s next. Though instead of preparing another tasty dish of deceptively filling food, $npc1.he&#39;s stood casually leaning on the counter, watching you with a grin. &lt;/p&gt;
	&lt;p&gt;&quot;That&#39;s the last of it - good job!&quot; $npc1.he says, patting your $waist belly rather strongly. &quot;To tell ya the truth, I wasn&#39; really expectin&#39; ya to pull through. A promise is a promise though, and since ya proved ya can handle it I&#39;ll let ya in on what ya want to know...&quot; &lt;/p&gt;
	
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;The art of the heft&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = 0&gt;&gt;
	&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _stage == &quot;quit&quot;&gt;&gt;
	&lt;&lt;if _quest.roundsLeft.length == 3&gt;&gt; /* Player quit early (either before eating or after one course) */
		&lt;p&gt;Your stomach is tied up in knots from nerves, and you&#39;re not sure how well you can eat in this state. You wave to the busy$npc1.species to get $npc1.his attention and tell $npc1.him you want to stop now. &lt;/p&gt;
		&lt;p&gt;&quot;Throwin&#39; in the towel already?&quot; $npc1.he shrugs. &quot;Fair enough, though since I&#39;ve already started cookin&#39; I can&#39;t give ya yer gold back.&quot; &lt;/p&gt;
	&lt;&lt;else&gt;&gt;
		&lt;p&gt;Unsure of how many more especially filling morsels you can manage, and a little nervous, you decide to stop while you still can. The $npc1.species&#39;s flurry of cooking calms down to a stop, and $npc1.he comes to rest on the counter. $npc1.He shrugs $npc1.his broad shoulders - if $npc1.he&#39;s disappointed, $npc1.he isn&#39;t really showing it. &lt;/p&gt;
		
		&lt;&lt;if _quest.roundsLeft.length == 0&gt;&gt;
			&lt;p&gt;&quot;Really? Ya were so close, too. Well, better to know ya limits. Can&#39;t say a lotta people these days do,&quot; $npc1.he says with a light chuckle. &lt;/p&gt;
		&lt;&lt;else&gt;&gt;
			&lt;p&gt;&quot;Good to know when ya&#39;ve had enough, I s&#39;pose,&quot; $npc1.he says, starting to clear up. &lt;/p&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;p&gt;&quot;Come on back any time ya wanna have another go,&quot; $npc1.he adds. &quot;I&#39;ll be waitin&#39;.&quot; &lt;/p&gt;
		&lt;p&gt;You lean back in your stool and pat your $waist belly contently, happy to rest for a bit before you go. Between the nice fullness of your stomach, the warmth of _warmThing, and the gentle rushing of the waves, you almost nod off to sleep. Eventually you manage to haul yourself to your feet, yawning sleepily. &lt;/p&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _quest.triedAndFailed = true&gt;&gt;
	
	&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$alive&gt;&gt;
	&lt;p&gt;The feast is proving all too much. Breathing heavily, you rub your rock solid gut as you psyche yourself up to carry on. One more bite - surely you can manage that! You force yourself to swallow one more mouthful, failing to account for just how extra filling the $npc1.species&#39;s cooking is. You were struggling with just a mouthful before, so when that food hits your overstuffed belly feeling like you ate an entire meal, you&#39;re completely overwhelmed. Groaning, you roll back in your seat with your $waist belly clutched in both $p.hands, praying you don&#39;t explode. &lt;/p&gt;
	&lt;p&gt;The $npc1.species notices you&#39;ve had more than enough and sets aside your plate, chuckling. &quot;Well $p.buddy, ya gave it a good shot,&quot; $npc1.he says, giving your overstuffed gut a couple of friendly pats a bit too hard for your liking. &quot;Come back again when ya a bit better prepared to handle it.&quot; &lt;/p&gt;
	&lt;p&gt;Unable to budge from your seat, you sit where you are, groaning. With the warmth of _warmThing on your $p.fur and the soft //hiss// of waves rolling in and out, you find your eyes sleepily drifting shut... &lt;/p&gt;
	
	&lt;&lt;set _quest.triedAndFailed = true&gt;&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="91" name="Species Editor" tags="fixes-and-edits intro" position="7200,1200" size="200,100">/* This section is included as part of the character generation species editor */
/* It&#39;s only included during the character generation form of species editing - not the when editing at the cabal */
&lt;&lt;setPassageTitle &quot;Edit Species&quot;&gt;&gt;

&lt;&lt;set _editingSpecies = clone($species)&gt;&gt; /* Make a copy so we aren&#39;t actually editing the core species */

/* Set up some things */
&lt;&lt;set _editingSpecies = setup.validateSpecies(_editingSpecies)&gt;&gt;
&lt;&lt;set _editingSpecies.speciesStats = clone(_editingSpecies.speciesStats)&gt;&gt; /* not sure if this is covered by the initial clone or not, so will do this just to be safe */

&lt;&lt;if $eventCounterB == &quot;charGen&quot;&gt;&gt; /* Only display the species stat editor during character generation, not during Cabal editing */
	&lt;&lt;include &quot;species editor - stats&quot;&gt;&gt;
	&lt;hr&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;include &quot;species editor - terms&quot;&gt;&gt;

&lt;&lt;if $eventCounterB == &quot;charGen&quot; or $eventCounterB == &quot;cabal&quot;&gt;&gt;
	&lt;&lt;action &quot;sw&quot; &quot;spells&quot; &quot;Save species&quot; &quot;species editor - save&quot; true&gt;&gt;
		&lt;&lt;setPopupTitle &quot;Save species&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;se&quot; &quot;spells&quot; &quot;Load species&quot; &quot;species editor - load&quot; true&gt;&gt;
		&lt;&lt;setPopupTitle &quot;Load species&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Display actions */
&lt;&lt;if $eventCounterB == &quot;charGen&quot;&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Done&quot; &quot;Begin your journey&quot;&gt;&gt;
		&lt;&lt;applyPlayerSpecies _editingSpecies true&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt; /* Assume cabal editing */
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Confirm changes&quot; &quot;Change your body&quot;&gt;&gt;
		&lt;&lt;applyPlayerSpecies _editingSpecies false&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;species selected&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="92" name="Species Mod Toggles" tags="mod-support fixes-and-edits" position="6200,1900" size="200,100">/* Mod toggles, but exclusively for species-based mods */
&lt;ul&gt;
&lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$options.pokemodPlusEnabled&quot; false true autocheck&gt;&gt; &#39;&#39;Pokemod Plus&#39;&#39; - Adds additional popular pokemon as species. Intended to be used in addition to Pokemod Core, but can be used separately.&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$options.humans&quot; false true autocheck&gt;&gt; &#39;&#39;Humans&#39;&#39; - Adds additional human based species.&lt;/label&gt;&lt;/li&gt;
/* ADD ENTRIES ABOVE HERE */
&lt;/ul&gt;</tw-passagedata><tw-passagedata pid="93" name="Species Modding - README" tags="mod-support" position="6200,1700" size="200,100">There are two formats a species mod can take, a core mod, or an addon mod.

- Core Mod: Core mods overwrite the existing selection of species in the core game. There can only be one core mod active in a game at a time. You&#39;ll need a species to replace every single one of the base species (actually, that&#39;s not true - any species not changed will default to the base game one). Ideally, mods wouldn&#39;t have to be in this format, but this way ensures better compatibility with the core game and other mods.

- Addon Mod: Addon mods add extra species options ontop of whatever is already available. Any number can be active / inactive at a time, and they can also be freely toggled at any time. Ideally all species mods should take this form, the only exception being &quot;total conversion&quot; style species mods, which should be core.

================
	MAKING A CORE MOD
================
The core (heh) of a core species mod is made up of a core species patch passage that makes the  species changes, and a manual entry to the `Core Species Mod Options` passage to make it available as an option.

While they have a special selection method, you can also treat core species mods as regular mods, too - just make additional normal patchers as you would for any mod. This might be necessary if you want to change things such as NPC or enemy names to fit your species changes or the like.

== MAKING A CORE SPECIES PATCH ==
Create a passage that&#39;ll be used to patch in your core species edits.

At the start, enable your mod&#39;s option, for example: `&lt;&lt;set $options.pokemodCoreEnabled = true&gt;&gt;`.

After that, use `setup.registerSpecies()` to make changes to any of the game&#39;s core species. Anything you provide will be overlaid on top of the existing species, this means that it&#39;ll replace the values of properties that are already there, or introduce new ones if the species didn&#39;t originally have it.

An example for one species could look like this:
```
&lt;&lt;run setup.registerSpecies({
	id: &quot;dolphin&quot;,
	species: &quot;palafin&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;white&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [7,5,5,5,3,3],
	
	waterType: true,
})&gt;&gt;
```
In this example, the dolphin species will be modified, with its `species`, `furBack`, `furBelly`, `furHead`, and `speciesStats` being replaced with these new values. Meanwhile a new, previously not existing, property - `waterType` - will also be added to the dolphin.

== ADDING THE OPTION ==
Find the `Core Species Mod Options` passage, and add the option for selecting your core species mod. The option consists of the display name, and the name of the core species patch passage for the mod.

An example would look like:
```
&lt;&lt;option &quot;Pokemod Core&quot; &quot;pokemod core patch core species&quot;&gt;&gt;
```

===================
	MAKING AN ADDON MOD
===================
The 2 main steps for adding an addon mod are:
- Adding the species to the list
- Adding the option to select them

== ADDING TO THE SPECIES LIST ==
Within your patch passage, register your species using the specialised `setup.registerSpecies()` function. So long as your mod is enabled, the species will automatically occur wherever needed - for example as random species if it&#39;s part of one of the random tables (like `carnivore`), or in the start of game species selector if it&#39;s not got `noPlayer`.

An example would look like:
```
&lt;&lt;run setup.registerSpecies({
	id: &quot;insectmod_butterfly&quot;,
	option: &quot;insectSpeciesEnabled&quot;,
	/* etc */
})&gt;&gt;
```

== ADDING THE OPTION ==
Find the `Species Mod Toggles` passage, and add in a checkbox for toggling your species. This will automatically be included in the start of game screen, and the species mods section of the options menu. The recieverName value should be the option that governs the species mod.

An example would look like:
```
&lt;li&gt;&lt;label&gt;&lt;&lt;checkbox &quot;$options.pokemodBonusEnabled&quot; false true autocheck&gt;&gt; &#39;&#39;Pokemod Bonus&#39;&#39; - Adds additional popular pokemon as species. Intended to be used in addition to Pokemod Core&lt;/label&gt;&lt;/li&gt;
```

=================
	DEFINING A SPECIES
=================
Since there&#39;s been some new properties added to species for this system, it&#39;s probably a good idea to both go over those additions, and explain the base game species formats, too.

== NEW ADDITIONS ==
These new elements have been added on via Fixes and Edits.

= Technical =
- `option` (optional) - The species will only be available when the given option is true. Format should be the string name of the option. Example: For your species to be available when `$options.mySpeciesMod` is `true`, then `option` should be `&quot;mySpeciesMod&quot;`.
- `noPlayer` (optional) - The species won&#39;t be available as an option for the player to use.
- `noRandom` (optional) - The species won&#39;t be available as a random option in when doing random all. Note: This flag isn&#39;t checked when doing normal randomisation of random `carnivore`s, `herbivore`s, or `dinosaur`s, because those flags are specifically for opting-in to being included in the random tables!
- `core` (optional) - Species is part of the core base game species. You shouldn&#39;t include this in mod-added species.

= Randomisation =
Think of these labels more as identifiers for *general* creatures. For example, use the `carnivore` tag to label carnivore species that you might expect to generally find around the place (would fit in the random table), rather than strictly as a label for their diet (for example dolphins are carnivorous, but you wouldn&#39;t give them the `carnivore` tag since you wouldn&#39;t expect them to be around outside of the sea, if that makes sense...).
- `herbivore` (optional) - If set to true, this species will be an option when the game makes a random herbivore NPC.
- `carnivore` (optional) - If set to true, this species will be an option when the game makes a random carnivore NPC.
- `dinosaur` (optional) - If set to true, this species will be an option when the game makes a random dinosaur NPC.
- `aquatic` (optional) - If set to true, this species will be an option when the game makes a random aquatic NPC.
- `dragon` (optional) - If set to true, this species will be an option when the game makes a random dragon NPC. Which I think is never.
- `flying` (optional) - If set to true, this species will be an option when the game makes a random flying NPC. Which I think is never.

= Misc =
- `adjective` - An animal adjective used to describe the species, like &quot;bovine&quot;, &quot;feline&quot;, etc. I prefer to keep to the more general terms rather than the specific ones, e.g. a tiger is &quot;feline&quot; rather than &quot;tigrine&quot;, though end up using the specific forms when I don&#39;t know the general ones.
- `plural` (optional) - The plural form of the species. If not included, it&#39;ll just add an &quot;s&quot; onto the end of what&#39;s given for `species`.

== ORIGINAL ==
Most of the original properties are self-explanatory and/or explained by the species editor enough that I&#39;ll only cover the ones that are a bit more complex:
- `speciesStats` - The array of stat bonuses that player characters of this species have. The order is Strength, Agility, Endurance, Intelligence, Stomach, then Fat. The rule is that the bonuses (excluding fat) should total 25 points, distributed as you see fit - it&#39;s fairly arbitrarily done, so I suggest basing values off of a similar species from the core game. Fat is added as a small flavourful bonus (it doesn&#39;t count towards the 25 points), but is again done very arbitrarily.
- `speciesHeight` - The starting height for the species in inches. The gameplay limits for the heights in the game are 48 and 144, however you won&#39;t find any of the base species with sizes in this range. I suggest using the more modest values of a similar species that already exists, for both ease of creating and also for gameplay purposes - if one of the stats is already maxed out to one of the extremes, it robs the player for an opportunity to play out scenarios of growing/shrinking.</tw-passagedata><tw-passagedata pid="94" name="Spell Modding - README" tags="mod-support" position="6500,1700" size="200,100">==============
	DEFINING SPELLS
==============

== SPELL PROPERTIES ==
= Technical =
- `id` - The unique identifier for the spell.
- `option` (optional) - The spell will only be available when the given option is true. Format should be the string name of the option. Example: For your species to be available when `$options.mySpellMod` is `true`, then `option` should be `&quot;mySpellMod&quot;`.
- `core` (optional) - Spell is a base game spell. You shouldn&#39;t include this in mod-added species.
- `unique` (optional) - When true, the spell will be stored in the player&#39;s spellbook as a spell object, rather than an ID. This allows you to store information that would be saved alongside the spell. I wouldn&#39;t recommend doing this, as it makes updating the spell a bit of a hassle - if you want to track spell-related variables, use global variables for that.

= Usability =
General usability:
- `ooc` (optional) - The spell can be used outside of combat.
- `combat` (optional) - The spell can be used inside of combat. Note that the game originally would allow any spell to be cast during combat - with these changes it&#39;s now necessary to include this flag.

Special usability:
- `availableCheck` - String of a setup function that&#39;ll be run to check if the player can cast the spell in the current circumstances - return `true` to allow, and `false` to deny. Bypasses `ooc` and `combat` checks. Example: If your function is `setup.myCheckFunction`, then you should use the value `&quot;myCheckFunction&quot;`.

= Costs =
The resource costs for casting the spell. If the player can&#39;t afford the listed costs, they won&#39;t be able to cast the spell. Costs will be deducted automatic upon casting the spell, unless the spell&#39;s `type` is `custom` - the custom cast logic will have to do that itself via `setup.consumeSpellCosts(spell)`.

- `cost` (optional) - The mana cost to cast the spell.
- `healthCost` (optional) - The cost in health to cast the spell.
- `staminaCost` (optional) - The cost in stamina to cast the spell. It&#39;s a percent, that&#39;s then reduced by the player&#39;s endurance stat like all other exertions in the game. Write it in terms of percent - for an ability that uses ten percent of the stamina bar, the value would be `10`.
- `staminaFixedCost` (optional) - As `staminaCost` except it doesn&#39;t get reduced by the player&#39;s stats - the cost is always a fixed percent.
- `goldCost` (optional) - The cost in gold to cast the spell.

= Custom Cast Logic =
A spell with a `type` of `&quot;custom&quot;` will use custom logic for its casting. Custom spells are required to narrate the spell casting and consume the casting resources themselves - these won&#39;t be done automatically.

- `castPassage` (optional) - Name of passage to include when casting the spell. Use that passage to handle the logic of casting the spell.
- `castFunction` (optional) - Name of setup function to run when casting the spell. Use that function to handle the logic of casting the spell.

If a spell has neither of these properties, the game will fall back to running the &quot;Custom Spell Logic&quot; passage - if not using these properties, you must include your logic in that passage.

= Empower =</tw-passagedata><tw-passagedata pid="95" name="The art of the heft" tags="feeder-expansion cutscene" position="6700,1000" size="100,100">/* This passage should be given the `cutscene` tag! */

&lt;&lt;switch $eventCounterA&gt;&gt;
	&lt;&lt;case 0&gt;&gt;
		&lt;p&gt;Offering a strong arm, the $npc1.species helps heft you up off your stool and beckons you follow $npc1.him behind the counter. You plod along behind $npc1.him, your excitedness at learning new cooking techniques helping to balance out your lethargy from the heavy feast digesting in your gut. &lt;/p&gt;
		&lt;p&gt;$npc1.He guides you around $npc1.his humble setup, lazily munching on a few mouthfuls of $npc1.his own goods as $npc1.he does so. $npc1.He sets you out a copy of $npc1.his utensils so you can follow along as $npc1.he happily explains $npc1.his cooking techniques. &lt;/p&gt;
		&lt;p&gt;//&quot;Now, I know it ain&#39;t exactly part of the cookin&#39;, but any self-respectin&#39; chef needs good tools! Keep ya knives nice n&#39; sharp and...&quot;// &lt;/p&gt;

	&lt;&lt;case 1&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;//&quot;Now everyone knows when ya batterin&#39; yer go powder mix, then wash, but why stop at jus&#39; the one pass? Double the layerin&#39;, double the tastin&#39;, I always say. &#39;Course you could go fer even more but...&quot;// &lt;/p&gt;
	&lt;&lt;case 2&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;//&quot;Really not hard to get real big, quality ingredients nowadays. Don&#39;t settle for anythin&#39; but the best n&#39; freshest. Yer&#39;ll be trippin&#39; over &#39;em if ya go lookin&#39; for &#39;em anyway. When I&#39;m not catchin&#39; my own, I head t&#39;...&quot;// &lt;/p&gt;
	&lt;&lt;case 2&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;//&quot;Ya&#39;d be surprised how much ya can manage to pack int&#39; a single meal, but ya gotta be careful. Don&#39;t want someone up &#39;n explodin&#39; from one bite, do we? So make sure...&quot;// &lt;/p&gt;
	&lt;&lt;case 3&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;//&quot;... aaaand, that&#39;s that! Phew! Go on then, show me what yer learned.&quot;// &lt;/p&gt;
	&lt;&lt;default&gt;&gt; /* Final */
		&lt;&lt;doTime 60&gt;&gt;
		&lt;p&gt;Sweating under the sizzling heat of the flame, you toil away at your own seafood dish. You put absolutely everything you&#39;ve learned in the past few hours into practice - prepwork, cooking, and attitude. You can feel the $npc1.species watching you over your shoulder as you work, finally clapping you hard on the back once you finish dishing up. &lt;/p&gt;
		&lt;p&gt;$npc1.He takes it from you, and your body swells with anticipation as $npc1.he takes a bite. &quot;Wew!&quot; $npc1.he exclaims, thumping his sizeable gut. &quot;Yer got the fillin&#39; part down, that&#39;s fer sure!&quot; &lt;/p&gt;
		&lt;p&gt;&quot;Here ya go, it&#39;s only fair ya get to enjoy the fruits of ya labor,&quot; $npc1.he says, returning the dish to you with a wink. &lt;/p&gt;
		
		&lt;&lt;getItem $feeder_mealMeatHefty&gt;&gt; /* player gets the item they made for practice */
		
		&lt;p&gt;&quot;Yer a good student, or I&#39;m a good teacher. Heh! &#39;m surprised ya picked things up so fast...&quot; with a big yawn, $npc1.he settles down onto one of the stools. &quot;Now that&#39;s done, I think I deserve a good nap. Been a pleasure to work with a fellow chef - maybe next time you&#39;ll be the one teachin&#39; me something, eh?&quot; &lt;/p&gt;
		
		&lt;&lt;questReward $feeder_questRaccoonFeast&gt;&gt;
		&lt;li&gt;You can now cook &#39;&#39;hefty meals&#39;&#39;.&lt;/li&gt;
		
		&lt;&lt;set $eventCounterA = &quot;done&quot;&gt;&gt;
&lt;&lt;/switch&gt;&gt;

/* Give options */
&lt;&lt;if $eventCounterA == &quot;done&quot;&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Thanks for the insights!&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _affirmation = either(&quot;Uh huh...&quot;, &quot;Oh of course...&quot;, &quot;Makes sense...&quot;, &quot;I see...&quot;, &quot;I&#39;d never have thought of that...&quot;, &quot;Interesting...&quot;)&gt;&gt;
	
	&lt;&lt;action &quot;c&quot; &quot;next&quot; _affirmation &quot;The art of the heft&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA += 1&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="96" name="To Go Counter" tags="feeder-expansion" position="6500,600" size="100,100">A few portly furs-on-the-go come and go from a counter in the corner of the room, where a tired waitress is constantly handing overly neatly-packaged boxes of food.

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Restaurant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
/* Can&#39;t be named using the normal feeder expansion formatting because the passage names are displayed to the player! */</tw-passagedata><tw-passagedata pid="97" name="Your ultimate creation!" tags="feeder-expansion cutscene" position="6500,200" size="100,100">/* This passage should be given the `cutscene` tag! */

&lt;&lt;set _stage = $eventCounterA&gt;&gt;
&lt;&lt;set _quest = $quests[setup.questIndex($feeder_questUltimateCreation)]&gt;&gt;

&lt;&lt;switch _stage&gt;&gt;
	&lt;&lt;case 0&gt;&gt; /* First */
		&lt;p&gt;Reading through your lengthy recipe, you begin unpacking all the utensils and ingredients you&#39;re going to need. Soon every surface of the kitchen around you is covered in things, spilling out over onto the floor as well. With every one of the instruments with which to create your masterpiece assembled, your heart is racing with excitement. You almost don&#39;t know where to get started, and after quickly checking and then re-checking your convoluted notes, you get working on what you //think// is the first step. &lt;/p&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Your ultimate creation!&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA += 1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;case 1&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;The kitchen is filled with activity and a cacophony of mouthwatering scents. Pans packed to overflowing with mostly meats sizzle away, trays of baked goods are swapped for others inside the roaring oven, and partly-prepped goods litter the sides. The first few parts of your masterpiece are already being assembled on the table, though there&#39;s still a lot to go before your vision is realised. &lt;/p&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Your ultimate creation!&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA += 1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;case 2&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;The heat is almost unbearable, but what great artist doesn&#39;t suffer for their art? You finish the first and biggest layer of what will be your multi-tiered masterpiece, troweling out a few bowls of blueberry barbecue sauce to serve as an //inspired// filling between layers. &lt;/p&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Your ultimate creation!&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA += 1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;case 3&gt;&gt;
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;Another layer finished now. You make sure to leave a big cavity in the middle of the chocolate battered fish ring, so you can pour in the heavy pot of beetroot custard. You can vividly picture the awe and delight the diner will have on their face when they happen upon //that// foodtastic bomb mid-meal. It&#39;s truly genius! &lt;/p&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Your ultimate creation!&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA += 1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;case 4&gt;&gt; /* last of the normal progression */
		&lt;&lt;doTime 60&gt;&gt;
		
		&lt;p&gt;With the final few layers of the towering feast complete, all that&#39;s left is the decorating. It takes pipe after pipe of frosting to contain the whole thing, and even more random assortments of toppings to decorate it with. You get creative with both the ingredients and the patterning, pasting on so many toppings is such wonderful combinations that the whole masterpiece is buried beneath a layer of toppings in multiple collections of colorful configurations. Then, with a lot of stretching and standing on tiptoes, you just about manage to gently place the singular cherry on top. &lt;/p&gt;
		&lt;p&gt;With an exhausted sigh, you take a step back to admire the fruits of your labor. The grand feast - your magnum opus - towers up taller than you. Every layer, upwards and inwards, an indescribable combination of foods, flavors, and textures, unbound by those restrictive rules of //convention//. It&#39;s a mouthwatering sight to behold, and mouths will water the world over once you unleash it to the public! But first, there&#39;s one last thing that needs to be done... &lt;/p&gt;
		
		&lt;&lt;removeItem $feeder_ultimateRecipe&gt;&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;spectrumGem&quot; &quot;The finishing touch...&quot; &quot;Your ultimate creation!&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = &quot;penultimate&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;case &quot;penultimate&quot;&gt;&gt; /* last passage before combat starts */
		&lt;p&gt;You crack the spectrum gem in your $p.hand, sprinkling a generous dusting of the rainbow glitter across the whole feast. The glittering rainbow of sparkling toppings truly completes the masterpiece - what wonders that&#39;ll do for the mouthfeel! As you bask in the glory of your creation, you can feel yourself almost welling up. While you wonder what you&#39;re going to do next, the whole tower shudders. All you can do is watch wide-eyed as it shudders again, tendrils of food extending out of it and slapping down on the table as it starts to move on its own accord. &lt;/p&gt;
		&lt;p&gt;&#39;&#39;//IT&#39;S ALIVE!//&#39;&#39; &lt;/p&gt;
		
		&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Uh oh...&quot; &quot;Your ultimate creation!&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = &quot;final&quot;&gt;&gt; /* will trigger `default` */
		&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;default&gt;&gt; /* final */
		&lt;p&gt;With one great swipe of a foody tendril, the abomination sends bowls and cutlery smashing to the ground, before throwing itself off the table towards you. You&#39;re frozen to the spot at the sight of what you&#39;ve created, as it splats onto the kitchen floor, slowly dragging itself ever closer. Before you can regain your wits, the writhing abomination of food has blocked off your exit. The pile leans over forwards, pointing its peak and a number of tendrils towards one destination: your mouth. &lt;/p&gt;
		
		&lt;hr&gt;
		&lt;&lt;set $feeder_ultimateMonsterAlive = true&gt;&gt;
		&lt;&lt;setEnemy $feeder_foodBoss&gt;&gt;
		&lt;&lt;set $e.special = &quot;kitchen&quot;&gt;&gt; /* Let the fight know this is the kitchen version, rather than the basement version. */
		&lt;&lt;startCombat&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="98" name="downtime forecast" tags="downtime-mod" position="6100,1100" size="100,100">&lt;&lt;set _intendedDays = $downtime_optionsSelected.days&gt;&gt;
&lt;&lt;if _intendedDays &lt; 1&gt;&gt;
	&lt;&lt;set _intendedDays = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _eatCostDaily = setup.downtime_getDailyEatCost()&gt;&gt;
&lt;&lt;set _eatCostTotal = _eatCostDaily * _intendedDays&gt;&gt;

&lt;&lt;set _dailyCalories = setup.downtime_getDailyCalories()&gt;&gt;
&lt;&lt;set _dailyFatLossToTraining = 0&gt;&gt;

&lt;&lt;if setup.downtime_isTraining()&gt;&gt;
	&lt;&lt;set _dailyFatLossToTraining = setup.downtime_getTrainingFatPerDay()&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _dailyFatChange = _dailyCalories - _dailyFatLossToTraining&gt;&gt;
&lt;&lt;set _totalFatChange = _dailyFatChange * _intendedDays&gt;&gt;

&lt;&lt;set _dailyTrainingResults = setup.downtime_calculateTrainingResults(setup.downtime_getTrainingFatPerDay(), $downtime_optionsSelected.training)&gt;&gt; /* Will just multiply the values when it comes time to display them... */
&lt;&lt;set _dailyStomach = 0&gt;&gt;
&lt;&lt;if setup.downtime_isStomachTraining()&gt;&gt;
	&lt;&lt;set _stretchCalcResults = setup.downtime_calculateStomachStretch($downtime_stretchPerDay, $status.stomachStretch)&gt;&gt;
	&lt;&lt;set _dailyStomach = _stretchCalcResults[0]&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _totalStomach = 0&gt;&gt; /* Need to fully calculate this rather than merely multiplying _dailyStomach */
&lt;&lt;if setup.downtime_isStomachTraining()&gt;&gt;
	&lt;&lt;set _stretchCalcResults = setup.downtime_calculateStomachStretch($downtime_stretchPerDay * _intendedDays, $status.stomachStretch)&gt;&gt;
	&lt;&lt;set _totalStomach = _stretchCalcResults[0]&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;u&gt;&lt;b&gt;Per Day&lt;/b&gt;&lt;/u&gt;&lt;br&gt;
&lt;ul&gt;
&lt;&lt;if _eatCostDaily != 0&gt;&gt;
	&lt;li&gt;Gold Cost: &lt;&lt;print _eatCostDaily&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;

&lt;li&gt;Fat Change: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyFatChange, 3)&gt;&gt;&lt;/li&gt; /* There&#39;s always going to be fat change */

&lt;&lt;if _dailyTrainingResults.strength &gt; 0&gt;&gt;
	&lt;li&gt;Strength: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.strength, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyTrainingResults.agility &gt; 0&gt;&gt;
	&lt;li&gt;Agility: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.agility, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyTrainingResults.endurance &gt; 0&gt;&gt;
	&lt;li&gt;Endurance: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.endurance, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyTrainingResults.intelligence &gt; 0&gt;&gt;
	&lt;li&gt;Intelligence: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.intelligence, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyStomach &gt; 0&gt;&gt;
	&lt;li&gt;Stomach: _dailyStomach&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;/ul&gt;

&lt;u&gt;&lt;b&gt;In Total&lt;/b&gt;&lt;/u&gt;&lt;br&gt;
&lt;i&gt;(Information assumes that everything goes to plan)&lt;/i&gt;
&lt;ul&gt;
&lt;&lt;if _eatCostTotal != 0&gt;&gt;
	&lt;li&gt;Gold Cost: _eatCostTotal&lt;/li&gt;
&lt;&lt;/if&gt;&gt;

&lt;li&gt;Fat Change: &lt;&lt;print setup.downtime_roundToDecimalPlace(_totalFatChange, 3)&gt;&gt;&lt;/li&gt;

&lt;&lt;if _dailyTrainingResults.strength &gt; 0&gt;&gt;
	&lt;li&gt;Strength: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.strength * _intendedDays, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyTrainingResults.agility &gt; 0&gt;&gt;
	&lt;li&gt;Agility: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.agility * _intendedDays, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyTrainingResults.endurance &gt; 0&gt;&gt;
	&lt;li&gt;Endurance: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.endurance * _intendedDays, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _dailyTrainingResults.intelligence &gt; 0&gt;&gt;
	&lt;li&gt;Intelligence: &lt;&lt;print setup.downtime_roundToDecimalPlace(_dailyTrainingResults.intelligence * _intendedDays, 2)&gt;&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _totalStomach &gt; 0&gt;&gt;
	&lt;li&gt;Stomach: _totalStomach&lt;/li&gt;
&lt;&lt;/if&gt;&gt;
&lt;/ul&gt;</tw-passagedata><tw-passagedata pid="99" name="downtime patch and update" tags="downtime-mod" position="6000,1200" size="100,100">&lt;&lt;set _PATCHVERSION = 1&gt;&gt; /* Update this to reflect most recent version */

&lt;&lt;if $downtimeVersion == null&gt;&gt;
	&lt;&lt;set $downtimeVersion = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $downtimeVersion &lt; _PATCHVERSION &gt;&gt;
	&lt;&lt;set setup.modUpdated = true&gt;&gt;
	&lt;&lt;set setup.modUpdatedList.push(&quot;Downtime&quot;)&gt;&gt;
    
    /* Version 1 Patch */
    &lt;&lt;if $downtimeVersion &lt; 1&gt;&gt;
    	/*nothing lol*/
        &lt;&lt;set $downtimeVersion = 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;include &quot;downtime tuning&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="100" name="downtime tuning" tags="downtime-mod" position="6000,1300" size="100,100">/* TODO:
- Some of these values will need to be edited if/when adding tuning for base game values
*/

/* TRAINING*/
/* Minutes spent on training for each day in downtime */
/* With normal endurance + exercise it usually works out to 1:1 minutes spent working out vs resting. 8 total hours dedicated to training per day seems reasonable, which works out to 4 hours actually spent training. However, studying doesn&#39;t have the stamina restrictions, so we bump up the training time a bit to try and meet in the middle. */
&lt;&lt;set $downtime_trainMinutes = 360&gt;&gt;

/* Rate fat is lost per minute of training */
&lt;&lt;set $downtime_trainFatLoss = 0.1&gt;&gt; /* 0.1 matches in-game conversions */

/* Amount main stat increases per minute of training */
&lt;&lt;set $downtime_trainPrimaryRate = 0.01&gt;&gt; /* 0.01 matches in-game training rates */

/* Amount secondary stat increases per minute of training (Endurance, when running track or lifting weights) */
&lt;&lt;set $downtime_trainSecondaryRate = 0.0033&gt;&gt; /* 0.0033 mostly matches in-game training rates */

/* EATING */
/* Gold cost for each unit of Eat */
&lt;&lt;set $downtime_eatCost = 0.5&gt;&gt; /* 0.5 roughly matches best items and restaurant costs */

/* Daily eat volumes for any of the non-scaled eat options */
&lt;&lt;set $downtime_fixedEatAmounts = {
	normal: 20,
}&gt;&gt;

/* Calorie values per Eat for each diet option */
&lt;&lt;set $downtime_dietCalories = {
	healthy: 0.5,
	mixed: 0.625,
	fattening: 0.75
}&gt;&gt;

/* MISC */
/* Limit to how long one length of downtime can go on for, as a safety cap in case something goes wrong */
&lt;&lt;set $downtime_daysCap = 28&gt;&gt;

/* Amount of fat lost per minute due to metabolism */
&lt;&lt;set $downtime_metabolismRate = 0.004&gt;&gt; /* loss of 0.004 matches base game rates */

/* Values used by the basegame stretch calculations */
&lt;&lt;set $downtime_stretchMinutes = 500&gt;&gt;
&lt;&lt;set $downtime_stretchCap = 120&gt;&gt;

/* Number of minutes per day that stomach is counted as stretched out for per day. */
/* In normal gameplay it takes ~10 hours for maxed stomach to drop below 100%. Since it&#39;s easy to keep yourself manually topped up, we&#39;ll throw in a couple bonus hours to simulate a dedicated player doing that */
&lt;&lt;set $downtime_stretchPerDay = 720&gt;&gt;</tw-passagedata><tw-passagedata pid="101" name="feeder crafting objects" tags="feeder-expansion" position="6300,500" size="100,100">/*
quests: [] //variables of quests to check. Only available when all provided quests are completed
keyItems: [] // Requires all quest items to be possessed
items: {
	&quot;itemId&quot;: amount // Requires items of given amount to craft. `itemId` should be the items variable
}

name // Name to use for item. If not provided, will default to using item&#39;s name
description // description to use for the item. If not provided, will use item&#39;s description

passage // completion moves to passage

itemId // Adds item on completion
amount // number of items to give. Optional, defaults to 1

time // how long it takes to craft. defaults to 15 minutes

noSubstitutions // If true, player can&#39;t use `other` ingredients as substitutions for ingredients

icon
*/

/* Standard meals */
&lt;&lt;set $feeder_craftMealMeat = {
	provisions: {
		meat: 2
	},
	itemId: &quot;$feeder_mealMeat&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealVeg = {
	provisions: {
		veg: 2
	},
	itemId: &quot;$feeder_mealVeg&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealDessert = {
	provisions: {
		dessert: 2
	},
	itemId: &quot;$feeder_mealDessert&quot;,
}&gt;&gt;

/* High-calorie meals */
&lt;&lt;set $feeder_craftMealMeatCalorific = {
	provisions: {
		meat: 2
	},
	items: {
		&quot;$sManaPotion&quot;: 1
	},
	description: &quot;A meaty meal marinaded in magical mana potion to make it heavier on the calories. Fat translates to mana, so it makes sense that it works the other way, right?&quot;,
	itemId: &quot;$feeder_mealMeatCalorific&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealVegCalorific = {
	provisions: {
		veg: 2
	},
	items: {
		&quot;$sManaPotion&quot;: 1
	},
	description: &quot;A veggie variety glazed with mana potion to make it heavier on the calories. Fat translates to mana, so it makes sense that it works the other way, right?&quot;,
	itemId: &quot;$feeder_mealVegCalorific&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealDessertCalorific = {
	provisions: {
		dessert: 2
	},
	items: {
		&quot;$sManaPotion&quot;: 1
	},
	description: &quot;A selection of desserts with mana potion mixed into the cream and batter to make it heavier on the calories. Fat translates to mana, so it makes sense that it works the other way, right?&quot;,
	itemId: &quot;$feeder_mealDessertCalorific&quot;,
}&gt;&gt;

/* Low-calorie meals */
&lt;&lt;set $feeder_craftMealMeatLowCal = {
	provisions: {
		meat: 2
	},
	items: {
		&quot;$dietPill&quot;: 1
	},
	description: &quot;A meaty meal no more calorific than a salad thanks to a dose of diet pill mixed in. You&#39;re pretty sure this isn&#39;t how low-calorie food is normally made, but this way doesn&#39;t compromise on the taste!&quot;,
	itemId: &quot;$feeder_mealMeatLowCal&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealVegLowCal = {
	provisions: {
		veg: 2
	},
	items: {
		&quot;$dietPill&quot;: 1
	},
	description: &quot;A veggie meal no more calorific than a salad thanks to a dose of diet pill mixed in. You&#39;re pretty sure this isn&#39;t how low-calorie food is normally made, but this way doesn&#39;t compromise on the taste!&quot;,
	itemId: &quot;$feeder_mealVegLowCal&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealDessertLowCal = {
	provisions: {
		dessert: 2
	},
	items: {
		&quot;$dietPill&quot;: 1
	},
	description: &quot;A selection of desserts no more calorific than a salad thanks to a dose of diet pill mixed in. You&#39;re pretty sure this isn&#39;t how low-calorie food is normally made, but this way doesn&#39;t compromise on the taste!&quot;,
	itemId: &quot;$feeder_mealDessertLowCal&quot;,
}&gt;&gt;

/* Addictive */
&lt;&lt;set $feeder_craftMealMeatAddictive = {
	provisions: {
		meat: 3
	},
	keyItems: [&quot;$feeder_addictiveSpice&quot;],
	description: &quot;An utterly irresistible meaty meal, thanks to an added pinch of craving-inducing spice.&quot;,
	itemId: &quot;$feeder_mealMeatAddictive&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealVegAddictive = {
	provisions: {
		veg: 3
	},
	keyItems: [&quot;$feeder_addictiveSpice&quot;],
	description: &quot;An utterly irresistible veggie meal, thanks to an added pinch of craving-inducing spice.&quot;,
	itemId: &quot;$feeder_mealVegAddictive&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealDessertAddictive = {
	provisions: {
		dessert: 3
	},
	keyItems: [&quot;$feeder_addictiveSpice&quot;],
	description: &quot;An utterly irresistible selection of desserts, thanks to an added pinch of craving-inducing spice.&quot;,
	itemId: &quot;$feeder_mealDessertAddictive&quot;,
}&gt;&gt;

/* Hefty */
&lt;&lt;set $feeder_craftMealMeatHefty = {
	provisions: {
		meat: 6
	},
	itemId: &quot;$feeder_mealMeatHefty&quot;,
	quests: [&quot;$feeder_questRaccoonFeast&quot;],
}&gt;&gt;
&lt;&lt;set $feeder_craftMealVegHefty = {
	provisions: {
		veg: 6
	},
	itemId: &quot;$feeder_mealVegHefty&quot;,
	quests: [&quot;$feeder_questRaccoonFeast&quot;],
}&gt;&gt;
&lt;&lt;set $feeder_craftMealDessertHefty = {
	provisions: {
		dessert: 6
	},
	itemId: &quot;$feeder_mealDessertHefty&quot;,
	quests: [&quot;$feeder_questRaccoonFeast&quot;],
}&gt;&gt;

/* Omni */
&lt;&lt;set $feeder_craftMealMeatOmni = {
	provisions: {
		meat: 6
	},
	items: {
		&quot;$lManaPotion&quot;: 1
	},
	quests: [&quot;$feeder_questUltimateCreation&quot;],
	keyItems: [&quot;$feeder_addictiveSpice&quot;],
	itemId: &quot;$feeder_mealMeatOmni&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealVegOmni = {
	provisions: {
		veg: 6
	},
	items: {
		&quot;$lManaPotion&quot;: 1
	},
	quests: [&quot;$feeder_questUltimateCreation&quot;],
	keyItems: [&quot;$feeder_addictiveSpice&quot;],
	itemId: &quot;$feeder_mealVegOmni&quot;,
}&gt;&gt;
&lt;&lt;set $feeder_craftMealDessertOmni = {
	provisions: {
		dessert: 6
	},
	items: {
		&quot;$lManaPotion&quot;: 1
	},
	quests: [&quot;$feeder_questUltimateCreation&quot;],
	keyItems: [&quot;$feeder_addictiveSpice&quot;],
	itemId: &quot;$feeder_mealDessertOmni&quot;,
}&gt;&gt;

/* Quest / Special */
&lt;&lt;set $feeder_craftUltimateRecipe = {
	name: &quot;Your magnum opus!&quot;,
	description: &quot;Your mind runs wild with crazy ideas - blends of meat, veggie, and desserts. The ultimate meal. People the world over will speak in awe of the feast you&#39;re about to create!&quot;,
	provisions: {
		meat: 30,
		veg: 30,
		dessert: 30,
		other: 30,
	},
	items: {
		&quot;$spectrumGem&quot;: 1
	},
	keyItems: [&quot;$feeder_ultimateRecipe&quot;],
	passage: &quot;Your ultimate creation!&quot;,
	time: 0, /* Time is handled by the narration */
	noSubstitutions: true,
}&gt;&gt;
&lt;&lt;set $feeder_craftFoodBoss = {
	name: &quot;Food Monstrosity&quot;,
	description: &quot;Create another monstrous melding of meat, veggies, and desserts, only this time on purpose. Maybe you&#39;ve developed a taste for it...?&quot;,
	provisions: {
		meat: 30,
		veg: 30,
		dessert: 30,
		other: 30,
	},
	items: {
		&quot;$spectrumGem&quot;: 1
	},
	quests: [&quot;$feeder_questUltimateCreation&quot;],
	passage: &quot;Recreating your ultimate creation!&quot;,
	time: 240,
	noSubstitutions: true,
}&gt;&gt;


&lt;&lt;set $feeder_craftOptions = [$feeder_craftMealMeat, $feeder_craftMealVeg, $feeder_craftMealDessert, $feeder_craftMealMeatCalorific, $feeder_craftMealVegCalorific, $feeder_craftMealDessertCalorific, $feeder_craftMealMeatLowCal, $feeder_craftMealVegLowCal, $feeder_craftMealDessertLowCal, $feeder_craftMealMeatAddictive, $feeder_craftMealVegAddictive, $feeder_craftMealDessertAddictive, $feeder_craftMealMeatHefty, $feeder_craftMealVegHefty, $feeder_craftMealDessertHefty, $feeder_craftMealMeatOmni, $feeder_craftMealVegOmni, $feeder_craftMealDessertOmni]&gt;&gt;</tw-passagedata><tw-passagedata pid="102" name="feeder enemies" tags="feeder-expansion" position="6100,400" size="100,100">&lt;&lt;set $feeder_foodBoss = {
  Name: &quot;Food abomination&quot;,
  name: &quot;food abomination&quot;,
  Article: &quot;The&quot;,
  article: &quot;the&quot;,
  str: 30,
  agi: 30,
  int: 30,
  def: 6,
  maxhea: 600,
  lvl: 16,
  gld: 0,
  xp: 150,
  gender: &quot;thing&quot;,
  item: &quot;&quot;,
  itemChance: 0,
  damageResistance: [&quot;bashing&quot;, &quot;slashing&quot;, &quot;piercing&quot;],
  damageWeakness: [],

  voreable: true,
	weight: 6969420, /* Value not actually used, but is required for the Devour option to be available... even if it doesn&#39;t do anything that Wait doesn&#39;t already do... */
  runnable: false,

  ai: &quot;feeder food boss ai&quot;,
	
	special: &quot;kitchen&quot;,
	amountFed: 0,
	addictiveAdvantage: false,
	onlyBasicAttack: false,
	justAte: false,
	
	feedable: true,

}&gt;&gt;</tw-passagedata><tw-passagedata pid="103" name="feeder food boss ai" tags="feeder-expansion" position="6300,200" size="100,100">&lt;&lt;set _weirdFood = either(&quot;beef and ale cheesecake&quot;, &quot;sweet and sour waffles&quot;, &quot;carrot cream&quot;, &quot;jellied broccoli&quot;, &quot;deep-fried cabbage&quot;, &quot;whipped garlic cream&quot;, &quot;vanilla mash potato&quot;)&gt;&gt;

/* The boss re-uses a lot of numbers for its attacks, so we&#39;ll declare them here for ease of adjusting if rebalancing is needed */
&lt;&lt;set _minStandardFeed = 10&gt;&gt;
&lt;&lt;set _maxStandardFeed = 30&gt;&gt;

&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;
Your opponent is a large, living mound of food - a feast of flavour fusions that just shouldn&#39;t exist. It lurches around slowly, pulling itself along the ground with sloppy tendrils of food as it approaches you, desperate to be eaten.

/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
	&lt;&lt;set _foodStyle = either(&quot;calorific&quot;, &quot;addictive&quot;, &quot;hefty&quot;)&gt;&gt;
	&lt;&lt;set _random = random(1,3)&gt;&gt;
	
	/* Calculate if would use a special attack */
	&lt;&lt;set _specialAttackChance = 100-(($agi+$int+$dodge)-($e.agi+$e.int))&gt;&gt;
	&lt;&lt;if _specialAttackChance &lt; 25&gt;&gt;&lt;&lt;set _specialAttackChance = 25&gt;&gt;&lt;&lt;/if&gt;&gt; /* Since players always have a 25% chance of failing a dodge */
	
	&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
		&lt;&lt;set _specialAttackChance += 75&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _cram = 0&gt;&gt;
	&lt;&lt;set _cramMult = 1&gt;&gt; /* Used for Hefty food to make it more filling while still only using a normal amount of resources */
	&lt;&lt;set _calorieMult = 0.75&gt;&gt;
	
	&lt;&lt;set $e.justAte = false&gt;&gt;
	
	&lt;&lt;if $grapple &gt; 0&gt;&gt;
		&lt;&lt;if _foodStyle == &quot;calorific&quot;&gt;&gt;
			&lt;li&gt;Calorific Feed&lt;/li&gt;
		&lt;&lt;elseif _foodStyle == &quot;addictive&quot;&gt;&gt;
			&lt;li&gt;Appetizing Feed&lt;/li&gt;
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;Hefty Feed&lt;/li&gt;
		&lt;&lt;/if&gt;&gt;
		
		The abomination funnels its form into your mouth with surprising force. Your cheeks bulge out as you&#39;re forced to gulp down huge mouthfuls of _weirdFood. 
		&lt;&lt;switch _foodStyle&gt;&gt;
			&lt;&lt;case &quot;calorific&quot;&gt;&gt;
				Your body starts feeling all slow and lethargic from all the calories that must&#39;ve been packed into those particular mouthfuls...
				
				&lt;&lt;tempBuff &quot;str&quot; -2&gt;&gt;
				&lt;&lt;tempBuff &quot;agi&quot; -2&gt;&gt;
				&lt;&lt;tempBuff &quot;int&quot; -2&gt;&gt;
				
				&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed)&gt;&gt;
				&lt;&lt;set _calorieMult = 1.5&gt;&gt;
				
			&lt;&lt;case &quot;addictive&quot;&gt;&gt;
				Something about the food awakens an aching craving for more, and you can&#39;t help but indulge it. 
				
				&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * 1.3&gt;&gt;
				&lt;&lt;set $e.addictiveAdvantage = true&gt;&gt;
			&lt;&lt;case &quot;hefty&quot;&gt;&gt;
				There&#39;s something about the food that makes it unbelievably filling. You can feel your stomach swelling larger and heavier faster than food enters your mouth!
				
				&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed)&gt;&gt;
				&lt;&lt;set _cramMult = 3&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if _random == 1 and $e.onlyBasicAttack == false and _specialAttackChance &gt;= 33&gt;&gt; /* Decide if it&#39;ll make a grapple attack */
			&lt;li&gt;Grab&lt;/li&gt;
			The mound of food leans back, then throws itself at you. 
			&lt;&lt;if setup.skillTest(_specialAttackChance, 0)&gt;&gt; /* special check for the attack. In this case the enemy succeeds at attacking */
				&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
					Mind still addled by intense cravings for more, you welcome the food with open arms and open mouth. It crashes into you, climbing its bulk up your body and towards your drooling mouth. 
				&lt;&lt;else&gt;&gt;
					You&#39;re too slow to get out of the way in time, and it slams into you, knocking you off your feet. While you&#39;re still reeling from the blow, it&#39;s pulling its bulk on top of you, binding your limbs with sticky food tendrils. Soon your vision is eclipsed by food - food that&#39;s all sliding straight towards your mouth. 
				&lt;&lt;/if&gt;&gt;
				
				&lt;&lt;set $grapple = $e.str * 3&gt;&gt;
			&lt;&lt;else&gt;&gt; /* player succeeds at avoiding */
				&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
					Your hungry desire to indulge in more of the feast almost has you stand there and welcome it, but you manage to suppress the urges enough to stagger out of the way.
					
				&lt;&lt;else&gt;&gt;
					You dodge out the way in time and the feast splats against the wall, leaving a messy impression of its silhouette behind.
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;set $e.addictiveAdvantage = false&gt;&gt;
			
		&lt;&lt;elseif _random == 2 and $e.onlyBasicAttack == false and _specialAttackChance &gt;= 33&gt;&gt;/* Decide if it&#39;ll make a power attack */
			&lt;&lt;if _foodStyle == &quot;calorific&quot;&gt;&gt;
				&lt;li&gt;Calorific Food Blast&lt;/li&gt;
			&lt;&lt;elseif _foodStyle == &quot;addictive&quot;&gt;&gt;
				&lt;li&gt;Appetizing Food Blast&lt;/li&gt;
			&lt;&lt;else&gt;&gt;
				&lt;li&gt;Hefty Food Blast&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			The pile of food bulks out like it means business, then starts swinging around and around, building up to a powerful attack. 
			&lt;&lt;if setup.skillTest(_specialAttackChance, 0)&gt;&gt; /* attack succeeds */
					&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
						Overwhelmed by your burning desire for more food, you just stand there and take it, mouth wide. A huge chunk of food detaches from the creature, shooting straight into your hungry mouth. The surge of food only spends an unsatisfying brief moment on your taste buds before the momentum carries the stream careening straight into your stomach. 
					&lt;&lt;else&gt;&gt;
						A huge chunk of food detaches from its tip and careens through the air in a blur. The blast of food strikes you square in the mouth with such a force that the jet surges down your throat without so much as a gulp on your part. It feels like you&#39;ve just been punched in the gut from the inside as the food smashes into your stomach. You barely even get a taste of whatever it was. 
					&lt;&lt;/if&gt;&gt;
					&lt;&lt;set $e.addictiveAdvantage = false&gt;&gt;
					
					&lt;&lt;switch _foodStyle&gt;&gt;
						&lt;&lt;case &quot;calorific&quot;&gt;&gt;
							As you start to recover from the impact, your body begins to feel tired and sluggish from all the calories that the boulder of food must&#39;ve been packed with. 
							
							&lt;&lt;tempBuff &quot;str&quot; -2&gt;&gt;
							&lt;&lt;tempBuff &quot;agi&quot; -2&gt;&gt;
							&lt;&lt;tempBuff &quot;int&quot; -2&gt;&gt;
							
							&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * 2&gt;&gt;
							&lt;&lt;set _calorieMult = 1.5&gt;&gt;
							
						&lt;&lt;case &quot;addictive&quot;&gt;&gt;
							What little you can taste of the food has you hungrily yearning for more. 
							
							&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * 2&gt;&gt;
							&lt;&lt;set $e.addictiveAdvantage = true&gt;&gt;
						&lt;&lt;case &quot;hefty&quot;&gt;&gt;
							Even accounting for the size of that big boulder of food, there&#39;s no way you should be feeling as full as you are. 
							
							&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * 2&gt;&gt;
							&lt;&lt;set _cramMult = 3&gt;&gt;
					&lt;&lt;/switch&gt;&gt;
					
			&lt;&lt;else&gt;&gt; /* attack fails */
				&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
					A massive wad of food flings off of the creature and despite your burning desire for it to enter your mouth, you manage to force yourself to duck just in time. The projectile boulder of food explodes against the wall behind you, redecorating it with a wide coating of _weirdFood. 
				&lt;&lt;else&gt;&gt;
					A massive wad of food flings off of the creature, and you only just manage to duck in time. The projectile boulder of food explodes against the wall behind you, redecorating it with a wide coating of _weirdFood. 
				&lt;&lt;/if&gt;&gt;
				
				&lt;&lt;set $e.addictiveAdvantage = false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt; /* Make a basic attack */
			&lt;&lt;if _foodStyle == &quot;calorific&quot;&gt;&gt;
				&lt;li&gt;Calorific Feed&lt;/li&gt;
			&lt;&lt;elseif _foodStyle == &quot;addictive&quot;&gt;&gt;
				&lt;li&gt;Appetizing Feed&lt;/li&gt;
			&lt;&lt;else&gt;&gt;
				&lt;li&gt;Hefty Feed&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			
			/* Make it so if addicted, eat more */
			&lt;&lt;set _cramBonus = 1&gt;&gt;
			&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
				&lt;&lt;set _cramBonus = 1.5&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;if $e.addictiveAdvantage == true&gt;&gt;
				The abomination makes an unrelenting charge, hurling its delicious self and many lasing tendrils of food towards your drooling mouth. You know you should resist, but your cravings just can&#39;t say no to a bucketload of _weirdFood!
			&lt;&lt;else&gt;&gt;
				The abomination makes an unrelenting charge, throwing itself and so many lashing tendrils of freaky foods at you that you just can&#39;t avoid food being crammed down your throat. 
			&lt;&lt;/if&gt;&gt;

			&lt;&lt;switch _foodStyle&gt;&gt;
				&lt;&lt;case &quot;calorific&quot;&gt;&gt;
					All the calories hit you like a rock, and you find yourself feeling sleepier as your body struggles to digest it. 
					
					&lt;&lt;tempBuff &quot;str&quot; -2&gt;&gt;
					&lt;&lt;tempBuff &quot;agi&quot; -2&gt;&gt;
					&lt;&lt;tempBuff &quot;int&quot; -2&gt;&gt;
					
					&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * _cramBonus&gt;&gt;
					&lt;&lt;set _calorieMult = 1.5&gt;&gt;
					
				&lt;&lt;case &quot;addictive&quot;&gt;&gt;
					Something about the food awakens an aching craving for more, and you can&#39;t help but indulge it. 
					
					&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * _cramBonus&gt;&gt;
					&lt;&lt;set $e.addictiveAdvantage = true&gt;&gt;
				&lt;&lt;case &quot;hefty&quot;&gt;&gt;
					There&#39;s something about the food that makes it unbelievably filling. You can feel your stomach swelling larger and heavier faster than food enters your mouth!
					
					&lt;&lt;set _cram = random(_minStandardFeed, _maxStandardFeed) * _cramBonus&gt;&gt;
					&lt;&lt;set _cramMult = 3&gt;&gt;
			&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Handle everything universal */
	&lt;&lt;if _cram &gt; 0&gt;&gt;
		&lt;&lt;if _cram &gt; $e.hea&gt;&gt; /* Cap the amount fed based on the creature&#39;s remaining supply! */
			&lt;&lt;set _cram = $e.hea&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* remove it from the enemy&#39;s resources */
		&lt;&lt;eDamage _cram&gt;&gt;
		
		/* Adjust fillingness for hefty foods */
		&lt;&lt;set _cram = _cram * _cramMult&gt;&gt;
		
		/* Now calculate calories */
		&lt;&lt;set _calories = _cram * _calorieMult&gt;&gt;
		
		&lt;&lt;consume _cram _calories&gt;&gt;
		&lt;&lt;set $e.justAte = true&gt;&gt;
		&lt;&lt;set $e.amountFed += _cram&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $e.onlyBasicAttack = false&gt;&gt;
	

/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;
	&lt;&lt;set $e.onlyBasicAttack = true&gt;&gt;
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
	/* Can only flee from the basement version, so no need to check */
	&lt;li&gt;Escaped!&lt;/li&gt;
	&lt;&lt;if $e.amountFed &gt; 0&gt;&gt;
		&lt;&lt;if $ful &gt; 55&gt;&gt;
			Realising you&#39;re not prepared to meet your admittedly delicious end at the hands of your own monstrous creation, you make a break for the exit, clutching your $waist belly in your hands as you go. 
		&lt;&lt;else&gt;&gt;
			Realising you&#39;re not prepared to meet your admittedly delicious end at the hands of your own monstrous creation, you make a break for the exit. 
		&lt;&lt;/if&gt;&gt;
		
		The monster slorps along the ground after you, dragging itself along with messy food appendages that leave splattered food stains behind it. 
		&lt;&lt;if setup.testImmobile() &gt;&gt;
			Its pursuit is glacially slow, but then again so are you. It&#39;s like a chase scene unfolding in slow motion as you $walk up the stairs, the mass of food following behind you, slowly gaining inch by inch. By the time you reach the door it&#39;s almost on you, 
			&lt;&lt;if $fat &lt;= 200&gt;&gt;
				and you just manage to slip through the doorway in time. 
			&lt;&lt;elseif $fat &lt;= 400&gt;&gt;
				and you just about manage to squeeze yourself through the doorway in time. 
			&lt;&lt;else&gt;&gt;
				and your $fatness figure gets jammed in the doorway as you try to squeeze through. Thankfully, with your lardy body plugging the door and your mouth being on the opposite side to the abomination, it can&#39;t exactly continue to feed you, so you have all the time in the world to yank yourself free. 
			&lt;&lt;/if&gt;&gt;
			You slam the door shut, and there&#39;s a wet thump as the monster throws itself against the door. Sauce and cream leaks through underneath, but it looks like the door will hold. You make sure to bolt it and prop up a chair against it for good measure, though.
		&lt;&lt;else&gt;&gt;
			Thankfully it&#39;s slow enough to outpace, and you reach the door into the kitchen before it catches you. You slam the door shut, bolt it, and prop up a chair against it for good measure.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt; /* player hasn&#39;t even eaten anything */
		Losing your nerve at the sight of the foodie abomination you&#39;ve created, you hastily turn back and slam the door, bolting it shut and propping up a chair against the door for good measure. 
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;endCombat&gt;&gt;
	&lt;hr&gt;
	&lt;&lt;include &quot;Kitchen&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
The mass of food lurches in front of you, blocking your escape route. It&#39;s not done with you yet!
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
	&lt;&lt;include &quot;feeder resolve feeder boss&quot;&gt;&gt;

/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
	&lt;&lt;include &quot;feeder resolve feeder boss&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
	&lt;&lt;include &quot;feeder resolve feeder boss&quot;&gt;&gt;

&lt;&lt;case &quot;feed&quot;&gt;&gt;
	&lt;&lt;if $feeder_itemFed.effect == &quot;Eat&quot;&gt;&gt;
		With a forceful thrust you cram your $feeder_itemFed.name into the mass of food. All that seems to happen is that the food gets incorporated into the monster&#39;s form, patching up its wounds and bulking it out with more supplies.
		&lt;&lt;eHealth $feeder_fedAmount&gt;&gt;
		Uh oh...
		&lt;&lt;feeder_tryRemoveFedItem&gt;&gt;
	&lt;&lt;else&gt;&gt; /* Some special item */
		$feeder_itemFed.Name in hand, you realise that it likely won&#39;t have any effect on the giant living mound of food. Noticing your hesitation, the abomination lurches towards you for another \&quot;attack\&quot;!
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="104" name="feeder item objects" tags="feeder-expansion" position="6200,500" size="100,100">&lt;&lt;set $feeder_mealMeat = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Meaty menagerie&quot;,
	name: &quot;meaty menagerie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 10,
	calories: 7,
	heal: 20,
	description: &quot;A full meal packed with a mouthwatering assortment of meats. &quot;,
	itemUse: &quot;You munch through the meat-packed meal, savouring the variety of meaty goodness. &quot;,
	flavors: [&quot;meat&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealVeg = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Veggie variety&quot;,
	name: &quot;veggie variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 10,
	calories: 7,
	heal: 20,
	description: &quot;A full meal packed with a mouthwatering assortment of fruits, veggies, and the like. &quot;,
	itemUse: &quot;You munch through the veggie-packed meal, savouring the variety of veggie goodness. &quot;,
	flavors: [&quot;veg&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealDessert = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Dessert diversity&quot;,
	name: &quot;dessert diversity&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 10,
	calories: 7,
	heal: 20,
	description: &quot;A tasty platter featuring a nice assortment of different desserts. &quot;,
	itemUse: &quot;You munch through the dessert-packed meal, savouring the variety of sweet-tasting goodness. &quot;,
	flavors: [&quot;dessert&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealMeatAddictive = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Appetizing meaty menagerie&quot;,
	name: &quot;appetizing meaty menagerie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 10,
	eat: 10,
	calories: 7,
	heal: 20,
	description: &quot;A full meal packed with an irresistible assortment of meats. &quot;,
	itemUse: &quot;After tasting just a single bite of the meat-packed meal, your mouth is watering hungrily. You wolf down the rest of the meaty goodness in no time at all, left only with an empty plate and a craving for more. &quot;,
	flavors: [&quot;meat&quot;],
	addictive: true,
}&gt;&gt;
&lt;&lt;set $feeder_mealVegAddictive = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Appetizing veggie variety&quot;,
	name: &quot;appetizing veggie variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 10,
	eat: 10,
	calories: 7,
	heal: 20,
	description: &quot;A full meal packed with an irresistible assortment of fruits, veggies, and the like. &quot;,
	itemUse: &quot;After tasting just a single bite of the veggie-packed meal, your mouth is watering hungrily. You wolf down the rest of the veggie goodness in no time at all, left only with an empty plate and a craving for more. &quot;,
	flavors: [&quot;veg&quot;],
	addictive: true,
}&gt;&gt;
&lt;&lt;set $feeder_mealDessertAddictive = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Appetizing dessert diversity&quot;,
	name: &quot;appetizing dessert variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 10,
	eat: 10,
	calories: 7,
	heal: 20,
	description: &quot;A full meal packed with an irresistible assortment of different desserts. &quot;,
	itemUse: &quot;After tasting just a single bite of the dessert-packed meal, your mouth is watering hungrily. You wolf down the rest of the sweet-tasting goodness in no time at all, left only with an empty plate and a craving for more. &quot;,
	flavors: [&quot;dessert&quot;],
	addictive: true,
}&gt;&gt;
&lt;&lt;set $feeder_mealMeatCalorific = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Calorie-packed meaty menagerie&quot;,
	name: &quot;calorie-packed meaty menagerie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 10,
	eat: 10,
	calories: 15, /* Mana from a small mana potion would make meal 5 calories extra, though buying calorie optimal food for the same cost as a small mana potion would normally yield 9 calories extra. Let&#39;s roughly split the difference and make it so it&#39;s +8 (1.5 calories per 1 eat, which is double normal unhealthy food!) */
	heal: 20,
	description: &quot;A full meal packed with a mouthwatering assortment of calorie-laden meats. &quot;,
	itemUse: &quot;You munch through the meat-packed meal, savouring the variety of meaty goodness. You can practically feel the extra weight piling on, but all those extra calories make the meal oh so more satisfying. &quot;,
	flavors: [&quot;meat&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealVegCalorific = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Calorie-packed veggie variety&quot;,
	name: &quot;calorie-packed veggie variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 10,
	eat: 10,
	calories: 15,
	heal: 20,
	description: &quot;A full meal packed with a mouthwatering assortment of calorie-laden fruits, veggies, and the like. &quot;,
	itemUse: &quot;You munch through the veggie-packed meal, savouring the variety of veggie goodness. You can practically feel the extra weight piling on, but all those extra calories make the meal oh so more satisfying. &quot;,
	flavors: [&quot;veg&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealDessertCalorific = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Calorie-packed dessert diversity&quot;,
	name: &quot;calorie-packed dessert diversity&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 10,
	eat: 10,
	calories: 15,
	heal: 20,
	description: &quot;A tasty platter featuring a nice assortment of different calorie-laden desserts. &quot;,
	itemUse: &quot;You munch through the dessert-packed meal, savouring the variety of sweet-tasting goodness. You can practically feel the extra weight piling on, but all those extra calories make the meal oh so more satisfying. &quot;,
	flavors: [&quot;dessert&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealMeatHefty = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Hefty meaty menagerie&quot;,
	name: &quot;hefty meaty menagerie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 18,
	eat: 35,
	calories: 26,
	heal: 70,
	description: &quot;A full meal packed with a deceptively dense assortment of mouthwatering meats. &quot;,
	itemUse: &quot;You munch through the meat-packed meal, savouring the variety of meaty goodness. By the point you&#39;re gulping down your last mouthful, you feel like you&#39;ve gone to town on a whole buffet. &quot;,
	flavors: [&quot;meat&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealVegHefty = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Hefty veggie variety&quot;,
	name: &quot;hefty veggie variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 18,
	eat: 35,
	calories: 26,
	heal: 70,
	description: &quot;A full meal packed with a deceptively dense assortment of mouthwatering fruits, veggies, and the like. &quot;,
	itemUse: &quot;You munch through the veggie-packed meal, savouring the variety of veggie goodness. By the point you&#39;re gulping down your last mouthful, you feel like you&#39;ve gone to town on a whole buffet. &quot;,
	flavors: [&quot;veg&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealDessertHefty = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Hefty dessert diversity&quot;,
	name: &quot;hefty dessert diversity&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 18,
	eat: 35,
	calories: 26,
	heal: 70,
	description: &quot;A tasty platter featuring a deceptively dense assortment of different desserts. &quot;,
	itemUse: &quot;You munch through the dessert-packed meal, savouring the variety of sweet-tasting goodness. By the point you&#39;re gulping down your last mouthful, you feel like you&#39;ve gone to town on a whole buffet. &quot;,
	flavors: [&quot;dessert&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealMeatOmni = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Ultimate meaty menagerie&quot;,
	name: &quot;ultimate meaty menagerie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 25,
	eat: 35,
	calories: 52,
	heal: 70,
	description: &quot;The ultimate in culinary perfection - a mouthwatering meal packed full with so much meat and extra calories that you&#39;ll always be craving more. &quot;,
	itemUse: &quot;Just one bite and you&#39;re lost in blissful meaty goodness. The next thing you know, you&#39;ve eaten the whole thing, stuffed, satisfied, and salivating for more. &quot;,
	flavors: [&quot;meat&quot;],
	addictive: true,
}&gt;&gt;
&lt;&lt;set $feeder_mealVegOmni = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Ultimate veggie variety&quot;,
	name: &quot;ultimate veggie variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 25,
	eat: 35,
	calories: 52,
	heal: 70,
	description: &quot;The ultimate in culinary perfection - a mouthwatering meal packed full with so much veggie goodness and extra calories that you&#39;ll always be craving more. &quot;,
	itemUse: &quot;Just one bite and you&#39;re lost in blissful veggie goodness. The next thing you know, you&#39;ve eaten the whole thing, stuffed, satisfied, and salivating for more. &quot;,
	flavors: [&quot;veg&quot;],
	addictive: true,
}&gt;&gt;
&lt;&lt;set $feeder_mealDessertOmni = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Ultimate dessert diversity&quot;,
	name: &quot;ultimate dessert diversity&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 25,
	eat: 35,
	calories: 52,
	heal: 70,
	description: &quot;The ultimate in culinary perfection - a mouthwatering meal packed full with so much desserty goodness and extra calories that you&#39;ll always be craving more. &quot;,
	itemUse: &quot;Just one bite and you&#39;re lost in blissful desserty goodness. The next thing you know, you&#39;ve eaten the whole thing, stuffed, satisfied, and salivating for more. &quot;,
	flavors: [&quot;dessert&quot;],
	addictive: true,
}&gt;&gt;
&lt;&lt;set $feeder_mealMeatLowCal = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Low-calorie meaty menagerie&quot;,
	name: &quot;low-calorie meaty menagerie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 10,
	calories: 3,
	heal: 20,
	description: &quot;A full meal packed with a mouthwatering assortment of meats, with the added bonus of being no more calorific than a salad! &quot;,
	itemUse: &quot;You munch through the meat-packed meal, savouring the variety of meaty goodness. It&#39;s surprising how good something can taste with so little calories. &quot;,
	flavors: [&quot;meat&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealVegLowCal = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Low-calorie veggie variety&quot;,
	name: &quot;low-calorie veggie variety&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 10,
	calories: 3,
	heal: 20,
	description: &quot;A full meal packed with a mouthwatering assortment of fruits, veggies, and the like, with the added bonus of being no more calorific than a salad! &quot;,
	itemUse: &quot;You munch through the veggie-packed meal, savouring the variety of veggie goodness. It&#39;s surprising how good something can taste with so little calories. &quot;,
	flavors: [&quot;veg&quot;]
}&gt;&gt;
&lt;&lt;set $feeder_mealDessertLowCal = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Low-calorie dessert diversity&quot;,
	name: &quot;low-calorie dessert diversity&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;restaurant&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 10,
	calories: 3,
	heal: 20,
	description: &quot;A tasty platter featuring a nice assortment of different desserts, with the added bonus of being no more calorific than a salad! &quot;,
	itemUse: &quot;You munch through the dessert-packed meal, savouring the variety of sweet-tasting goodness. It&#39;s surprising how good something can taste with so little calories. &quot;,
	flavors: [&quot;dessert&quot;]
}&gt;&gt;

&lt;&lt;set $feeder_addictiveSpice = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Black spice shaker&quot;,
	name: &quot;Black spice shaker&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A hefty shaker filled with a strange, almost pitch black substance. Just a pinch is all it takes to make a meal nigh-addictive. &quot;,
	quest: true,
	icon: &quot;healthPotion&quot;,
}&gt;&gt;

&lt;&lt;set $feeder_witchDiaryNotes = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Witch&#39;s notes&quot;,
	name: &quot;witch&#39;s notes&quot;,
	effect: &quot;quest&quot;,
	description: &quot;Hastily-copied notes from a witch&#39;s diary. It includes formulae and arcane notes, mostly revolving around the creation of addictive, highly fattening foods through both magical and mundane applications. Further inspection might reveal new techniques to you, if you can make sense of any of it. &quot;,
	itemUse: &quot;You pour through the notes, hoping to glean any insights from the witch&#39;s research...&quot;,
	quest: true,
	icon: &quot;spells&quot;,
}&gt;&gt;

&lt;&lt;set $feeder_ultimateRecipe = {
	Article: &quot;Your&quot;,
	article: &quot;your&quot;,
	Name: &quot;Ultimate recipe&quot;,
	name: &quot;ultimate recipe&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A multi-page recipe of your own design, for the greatest meal ever conceived! The ingredients list takes up over a page on its own, and there are so many concurrent steps of frying, baking, grilling, and boiling that even a team of chefs would struggle to keep up.&quot;,
	quest: true,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="105" name="feeder patch and update" tags="feeder-expansion" position="6000,700" size="100,100">&lt;&lt;set _PATCHVERSION = 2&gt;&gt; /* Update this to reflect most recent version */

&lt;&lt;if $feeder_expansionVersion == null&gt;&gt;
	&lt;&lt;set $feeder_expansionVersion = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Trigger Patches */
/* Early always patch */
&lt;&lt;include &quot;feeder spell objects&quot;&gt;&gt;

&lt;&lt;if $feeder_expansionVersion &lt; _PATCHVERSION&gt;&gt;
	&lt;&lt;set setup.modUpdated = true&gt;&gt; /* Flag that an update has happened */
	&lt;&lt;set setup.modUpdatedList.push(&quot;Feeder expansion&quot;)&gt;&gt; /* Add to list of updated mods */
	
	/* Perform version 1 patch */
	&lt;&lt;if $feeder_expansionVersion &lt; 1&gt;&gt;
		
		&lt;&lt;include &quot;feeder patch items&quot;&gt;&gt;

		&lt;&lt;include &quot;feeder tuning&quot;&gt;&gt;
		&lt;&lt;include &quot;feeder crafting objects&quot;&gt;&gt;
		&lt;&lt;include &quot;feeder quest objects&quot;&gt;&gt;
		&lt;&lt;include &quot;feeder item objects&quot;&gt;&gt;
		&lt;&lt;include &quot;feeder enemies&quot;&gt;&gt;
		&lt;&lt;include &quot;feeder patch inventory&quot;&gt;&gt;
	
		&lt;&lt;set $feeder_expansionVersion = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;&lt;if $feeder_expansionVersion &lt; 2&gt;&gt;
    	/* Update our spells in the player&#39;s spellbook to the new format */
        &lt;&lt;run setup.patchOldSpellbook([&quot;feeder_conjureMeatMeal&quot;, &quot;feeder_conjureVegMeal&quot;, &quot;feeder_conjureDessertMeal&quot;, &quot;feeder_conjureMeatMealAddictive&quot;, &quot;feeder_conjureVegMealAddictive&quot;, &quot;feeder_conjureDessertMealAddictive&quot;, &quot;feeder_conjureMeatMealHefty&quot;, &quot;feeder_conjureVegMealHefty&quot;, &quot;feeder_conjureDessertMealHefty&quot;, &quot;feeder_conjureMeatMealCalorific&quot;, &quot;feeder_conjureVegMealCalorific&quot;, &quot;feeder_conjureDessertMealCalorific&quot;, &quot;feeder_conjureMeatMealOmni&quot;, &quot;feeder_conjureVegMealOmni&quot;, &quot;feeder_conjureDessertMealOmni&quot;])&gt;&gt;
        
        &lt;&lt;set $feeder_expansionVersion = 2&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* ALWAYS PATCHERS */
&lt;&lt;include &quot;feeder patch npcs&quot;&gt;&gt;
&lt;&lt;include &quot;feeder patch enemies&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="106" name="feeder patch enemies" tags="feeder-expansion" position="6000,800" size="100,100">/* Make sure to run this after any changes to the core enemies (including using the hotfix to refresh their stats!) */
/* FOREST */
&lt;&lt;set $fatWolf.feedable = true&gt;&gt;
&lt;&lt;set $fatWolf.sto = 20&gt;&gt;
&lt;&lt;set $fatWolf.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $obeseBear.feedable = true&gt;&gt;
&lt;&lt;set $obeseBear.sto = 30&gt;&gt;
&lt;&lt;set $obeseBear.flavorWeakness = [&quot;dessert&quot;, &quot;honey&quot;]&gt;&gt;

&lt;&lt;set $fruitDryad.feedable = true&gt;&gt;
&lt;&lt;set $fruitDryad.sto = 20&gt;&gt;
&lt;&lt;set $fruitDryad.flavorWeakness = [&quot;veg&quot;]&gt;&gt;

/* TODO: Write up special version so will work okay
&lt;&lt;set $gingerbreadWitch.feedable = true&gt;&gt;
&lt;&lt;set $gingerbreadWitch.sto = 150&gt;&gt;
&lt;&lt;set $gingerbreadWitch.flavorWeakness = [&quot;meat&quot;]&gt;&gt;
*/
&lt;&lt;set $storeRoomOwner.feedable = true&gt;&gt;
&lt;&lt;set $storeRoomOwner.sto = 50&gt;&gt;
&lt;&lt;set $storeRoomOwner.flavorWeakness = []&gt;&gt;

/* CITY */
/* Sure, it costs more money to feed these enemies to defeat, but maybe somebody wants to do it anyway? */
&lt;&lt;set $drunk.feedable = true&gt;&gt;
&lt;&lt;set $drunk.sto = 20&gt;&gt;
&lt;&lt;set $drunk.flavorWeakness = [&quot;booze&quot;]&gt;&gt;

&lt;&lt;set $thief.feedable = true&gt;&gt;
&lt;&lt;set $thief.sto = 20&gt;&gt;
&lt;&lt;set $thief.flavorWeakness = []&gt;&gt;

&lt;&lt;set $takeoutTerror.feedable = true&gt;&gt;
&lt;&lt;set $takeoutTerror.sto = 50&gt;&gt;
&lt;&lt;set $takeoutTerror.flavorWeakness = []&gt;&gt;

/* GRASSLAND */
&lt;&lt;set $bloatedLion.feedable = true&gt;&gt;
&lt;&lt;set $bloatedLion.sto = 25&gt;&gt;
&lt;&lt;set $bloatedLion.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $gorgedCheetah.feedable = true&gt;&gt;
&lt;&lt;set $gorgedCheetah.sto = 20&gt;&gt;
&lt;&lt;set $gorgedCheetah.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $expandedElephant.feedable = true&gt;&gt;
&lt;&lt;set $expandedElephant.sto = 500&gt;&gt;
&lt;&lt;set $expandedElephant.flavorWeakness = [&quot;veg&quot;]&gt;&gt;

&lt;&lt;set $wildling.feedable = true&gt;&gt;
&lt;&lt;set $wildling.sto = 20&gt;&gt;
&lt;&lt;set $wildling.flavorWeakness = []&gt;&gt;

&lt;&lt;set $wildlingRitualist.feedable = true&gt;&gt;
&lt;&lt;set $wildlingRitualist.sto = 20&gt;&gt;
&lt;&lt;set $wildlingRitualist.flavorWeakness = []&gt;&gt;

&lt;&lt;set $wildlingShaman.feedable = true&gt;&gt;
&lt;&lt;set $wildlingShaman.sto = 45&gt;&gt;
&lt;&lt;set $wildlingShaman.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

/* TODO: Write up special version so will work okay
&lt;&lt;set $wildlingShamanBoss.feedable = true&gt;&gt;
&lt;&lt;set $wildlingShamanBoss.sto = 65&gt;&gt;
&lt;&lt;set $wildlingShamanBoss.flavorWeakness = [&quot;meat&quot;]&gt;&gt;
*/

&lt;&lt;set $lizardWizard.feedable = true&gt;&gt;
&lt;&lt;set $lizardWizard.sto = 50&gt;&gt;
&lt;&lt;set $lizardWizard.flavorWeakness = [&quot;veg&quot;]&gt;&gt;

/* HILLS */
&lt;&lt;set $milkMachine.feedable = true&gt;&gt; /*Special case*/

&lt;&lt;set $meatMonster.feedable = true&gt;&gt; /*Special case*/

/* BEACH */
/* TODO: Decide on hydra */

&lt;&lt;set $waterElemental.feedable = true&gt;&gt; /*Special case*/

&lt;&lt;set $sandSnake.feedable = true&gt;&gt;
&lt;&lt;set $sandSnake.sto = 120&gt;&gt; /* Snakes can eat a lot! This is generous for the player */
&lt;&lt;set $sandSnake.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $bubbleOrca.feedable = true&gt;&gt;
&lt;&lt;set $bubbleOrca.sto = 30&gt;&gt; /* Big, but already quite full of air */
&lt;&lt;set $bubbleOrca.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $sphericalShark.feedable = true&gt;&gt;
&lt;&lt;set $sphericalShark.sto = 50&gt;&gt;
&lt;&lt;set $sphericalShark.flavorWeakness = [&quot;veg&quot;]&gt;&gt;

/* MOUNTAIN */
&lt;&lt;set $thinFur.feedable = true&gt;&gt;
&lt;&lt;set $thinFur.sto = 150&gt;&gt;
&lt;&lt;set $thinFur.flavorWeakness = []&gt;&gt;

&lt;&lt;set $toughFur.feedable = true&gt;&gt;
&lt;&lt;set $toughFur.sto = 120&gt;&gt;
&lt;&lt;set $toughFur.flavorWeakness = []&gt;&gt;

&lt;&lt;set $magicalFur.feedable = true&gt;&gt;
&lt;&lt;set $magicalFur.sto = 50&gt;&gt;
&lt;&lt;set $magicalFur.flavorWeakness = []&gt;&gt;

&lt;&lt;set $muscleFur.feedable = true&gt;&gt;
&lt;&lt;set $muscleFur.sto = 70&gt;&gt;
&lt;&lt;set $muscleFur.flavorWeakness = []&gt;&gt;

&lt;&lt;set $feederAnt.feedable = true&gt;&gt;
&lt;&lt;set $feederAnt.sto = 500&gt;&gt;
&lt;&lt;set $feederAnt.flavorWeakness = [&quot;veg&quot;]&gt;&gt;

&lt;&lt;set $manticore.feedable = true&gt;&gt;
&lt;&lt;set $manticore.sto = 250&gt;&gt;
&lt;&lt;set $manticore.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $fatWyvern.feedable = true&gt;&gt;
&lt;&lt;set $fatWyvern.sto = 150&gt;&gt;
&lt;&lt;set $fatWyvern.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

/* The base Snookums/Smarty texts kinda fit okay into the mold of defeating by overstuffing */
&lt;&lt;set $snookums.feedable = true&gt;&gt;
&lt;&lt;set $snookums.sto = 200&gt;&gt;
&lt;&lt;set $snookums.flavorWeakness = [&quot;dessert&quot;]&gt;&gt;

&lt;&lt;set $smarty.feedable = true&gt;&gt;
&lt;&lt;set $smarty.sto = 50&gt;&gt;
&lt;&lt;set $smarty.flavorWeakness = []&gt;&gt;

/* JUNGLE */
&lt;&lt;set $anaconda.feedable = true&gt;&gt;
&lt;&lt;set $anaconda.sto = 350&gt;&gt;
&lt;&lt;set $anaconda.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $fatJaguar.feedable = true&gt;&gt;
&lt;&lt;set $fatJaguar.sto = 75&gt;&gt;
&lt;&lt;set $fatJaguar.flavorWeakness = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $gluttonSeparatist.feedable = true&gt;&gt;
&lt;&lt;set $gluttonSeparatist.sto = 75&gt;&gt;
&lt;&lt;set $gluttonSeparatist.flavorWeakness = [&quot;dessert&quot;]&gt;&gt;

&lt;&lt;set $shamanBossNormal.feedable = true&gt;&gt;
&lt;&lt;set $shamanBossNormal.sto = 120&gt;&gt;
&lt;&lt;set $shamanBossNormal.flavorWeakness = [&quot;dessert&quot;]&gt;&gt;

&lt;&lt;set $gluttonSeparatistBoss.feedable = true&gt;&gt;
&lt;&lt;set $gluttonSeparatistBoss.sto = 75&gt;&gt;
&lt;&lt;set $gluttonSeparatistBoss.flavorWeakness = [&quot;dessert&quot;]&gt;&gt;</tw-passagedata><tw-passagedata pid="107" name="feeder patch inventory" tags="feeder-expansion" position="6000,1000" size="100,100">&lt;&lt;set _itemsToPatch = [ $ampleApple, $apple, $bagOfCandy, $beefStew, $bigSteak, $bloatedBlueberry, $boxOfDonuts, $breadLoaf,  $cake, $calamari, $cheese, $cheeseburger, $chili, $coconut, $cookies, $cupcake, $friedChicken, $giganticGrape, $grapes, $hamHock, $hamSandwich, $jambalaya, $meatballSub, $milkBottle, $milkJug, $orange, $outrageousOrange, $plentifulPeach, $riceBowl, $oats, $profusePumpkin, $ridiculousRaspberry, $sausage, $sizableStrawberry, $steak, $strawberries, $sushiRoll, $tempuraShrimp, $waterFlask, $waterJug, $watermelon, $whoppingWatermelon, $wine]&gt;&gt;

&lt;&lt;for _itemBlueprintIndex, _itemBlueprint range _itemsToPatch&gt;&gt;
	/* Check if player has a copy of that item in their inventory */
	&lt;&lt;set _inventoryIndex = setup.hasItem(_itemBlueprint)&gt;&gt;
	
	&lt;&lt;if _inventoryIndex &gt;= 0&gt;&gt;
		/* Update consumability where necessary */
		&lt;&lt;if _itemBlueprint.consume != null and _itemBlueprint.consume == true&gt;&gt;
			&lt;&lt;set $inventory[_inventoryIndex].consume = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Add provisions score */
		&lt;&lt;if _itemBlueprint.provisions != null&gt;&gt;
			&lt;&lt;set $inventory[_inventoryIndex].provisions = _itemBlueprint.provisions&gt;&gt; /* I THINK it&#39;s right to use the object as-is rather than cloning the one used by the item blueprint */
		&lt;&lt;/if&gt;&gt;
		
		/* Add flavours */
		&lt;&lt;if _itemBlueprint.flavors != null&gt;&gt;
			&lt;&lt;set $inventory[_inventoryIndex].flavors = _itemBlueprint.flavors&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="108" name="feeder patch items" tags="feeder-expansion" position="6000,900" size="100,100">/* EDITS TO EXISTING ITEMS */
/* (note: Add consumable to all edible items!) */
&lt;&lt;set $ampleApple.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $ampleApple.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $ampleApple.consume = true&gt;&gt;

&lt;&lt;set $apple.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $apple.flavors = [&quot;veg&quot;]&gt;&gt;

&lt;&lt;set $bagOfCandy.provisions = {dessert: 1}&gt;&gt;
&lt;&lt;set $bagOfCandy.flavors = [&quot;dessert&quot;]&gt;&gt;

&lt;&lt;set $beefStew.provisions = {meat: 3}&gt;&gt;
&lt;&lt;set $beefStew.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $beefStew.consume = true&gt;&gt;

&lt;&lt;set $bigSteak.provisions = {meat: 3}&gt;&gt;
&lt;&lt;set $bigSteak.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $bigSteak.consume = true&gt;&gt;

&lt;&lt;set $bloatedBlueberry.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $bloatedBlueberry.flavors = [&quot;veg&quot;]&gt;&gt;

&lt;&lt;set $boxOfDonuts.provisions = {dessert: 1}&gt;&gt;
&lt;&lt;set $boxOfDonuts.flavors = [&quot;dessert&quot;]&gt;&gt;
&lt;&lt;set $boxOfDonuts.consume = true&gt;&gt;

&lt;&lt;set $breadLoaf.provisions = {other: 1}&gt;&gt;
&lt;&lt;set $breadLoaf.flavors = []&gt;&gt;
&lt;&lt;set $breadLoaf.consume = true&gt;&gt;

&lt;&lt;set $cake.provisions = {dessert: 1}&gt;&gt;
&lt;&lt;set $cake.flavors = [&quot;dessert&quot;]&gt;&gt;
&lt;&lt;set $cake.consume = true&gt;&gt;

&lt;&lt;set $calamari.provisions = {meat: 7}&gt;&gt;
&lt;&lt;set $calamari.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $calamari.consume = true&gt;&gt;

&lt;&lt;set $cheese.provisions = {other: 2}&gt;&gt;
&lt;&lt;set $cheese.flavors = [&quot;cheese&quot;]&gt;&gt;

&lt;&lt;set $cheeseburger.provisions = {meat: 1}&gt;&gt;
&lt;&lt;set $cheeseburger.flavors = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $chili.provisions = {meat: 2}&gt;&gt;
&lt;&lt;set $chili.flavors = [&quot;meat&quot;, &quot;spicy&quot;]&gt;&gt;
&lt;&lt;set $chili.consume = true&gt;&gt;

&lt;&lt;set $coconut.provisions = {other: 1}&gt;&gt;
&lt;&lt;set $coconut.flavors = [&quot;dessert&quot;, &quot;milk&quot;]&gt;&gt;

&lt;&lt;set $cookies.provisions = {dessert: 1}&gt;&gt;
&lt;&lt;set $cookies.flavors = [&quot;dessert&quot;]&gt;&gt;

&lt;&lt;set $cupcake.provisions = {dessert: 1}&gt;&gt;
&lt;&lt;set $cupcake.flavors = [&quot;dessert&quot;]&gt;&gt;

&lt;&lt;set $friedChicken.provisions = {meat: 2}&gt;&gt;
&lt;&lt;set $friedChicken.flavors = [&quot;meat&quot;]&gt;&gt;

&lt;&lt;set $giganticGrape.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $giganticGrape.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $giganticGrape.consume = true&gt;&gt;

&lt;&lt;set $grapes.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $grapes.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $grapes.consume = true&gt;&gt;

&lt;&lt;set $hamHock.provisions = {meat: 2}&gt;&gt;
&lt;&lt;set $hamHock.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $hamHock.consume = true&gt;&gt;

&lt;&lt;set $hamSandwich.provisions = {meat: 2}&gt;&gt;
&lt;&lt;set $hamSandwich.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $hamSandwich.consume = true&gt;&gt;

&lt;&lt;set $jambalaya.provisions = {meat: 1, other: 1}&gt;&gt;
&lt;&lt;set $jambalaya.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $jambalaya.consume = true&gt;&gt;

&lt;&lt;set $meatballSub.provisions = {meat: 1}&gt;&gt;
&lt;&lt;set $meatballSub.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $meatballSub.consume = true&gt;&gt;

&lt;&lt;set $milkBottle.provisions = {other: 1}&gt;&gt;
&lt;&lt;set $milkBottle.flavors = [&quot;milk&quot;, &quot;drink&quot;]&gt;&gt;
&lt;&lt;set $milkBottle.consume = true&gt;&gt;

&lt;&lt;set $milkJug.provisions = {other: 1}&gt;&gt;
&lt;&lt;set $milkJug.flavors = [&quot;milk&quot;, &quot;drink&quot;]&gt;&gt;
&lt;&lt;set $milkJug.consume = true&gt;&gt;

&lt;&lt;set $orange.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $orange.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $orange.consume = true&gt;&gt;

&lt;&lt;set $outrageousOrange.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $outrageousOrange.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $outrageousOrange.consume = true&gt;&gt;

&lt;&lt;set $plentifulPeach.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $plentifulPeach.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $plentifulPeach.consume = true&gt;&gt;

&lt;&lt;set $riceBowl.provisions = {other: 5}&gt;&gt;
&lt;&lt;set $riceBowl.flavors = []&gt;&gt;
&lt;&lt;set $riceBowl.consume = true&gt;&gt;

&lt;&lt;set $oats.provisions = {other: 1}&gt;&gt;
&lt;&lt;set $oats.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $oats.consume = true&gt;&gt;

&lt;&lt;set $profusePumpkin.provisions = {veg: 4}&gt;&gt;
&lt;&lt;set $profusePumpkin.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $profusePumpkin.consume = true&gt;&gt;

&lt;&lt;set $ridiculousRaspberry.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $ridiculousRaspberry.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $ridiculousRaspberry.consume = true&gt;&gt;

&lt;&lt;set $sausage.provisions = {meat: 1}&gt;&gt;
&lt;&lt;set $sausage.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $sausage.consume = true&gt;&gt;

&lt;&lt;set $sizableStrawberry.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $sizableStrawberry.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $sizableStrawberry.consume = true&gt;&gt;

&lt;&lt;set $steak.provisions = {meat: 1}&gt;&gt;
&lt;&lt;set $steak.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $steak.consume = true&gt;&gt;

&lt;&lt;set $strawberries.provisions = {veg: 1}&gt;&gt;
&lt;&lt;set $strawberries.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $strawberries.consume = true&gt;&gt;

&lt;&lt;set $sushiRoll.provisions = {meat: 5, other: 2}&gt;&gt;
&lt;&lt;set $sushiRoll.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $sushiRoll.consume = true&gt;&gt;

&lt;&lt;set $tempuraShrimp.provisions = {meat: 8}&gt;&gt;
&lt;&lt;set $tempuraShrimp.flavors = [&quot;meat&quot;]&gt;&gt;
&lt;&lt;set $tempuraShrimp.consume = true&gt;&gt;

&lt;&lt;set $waterFlask.flavors = [&quot;water&quot;, &quot;drink&quot;]&gt;&gt;
&lt;&lt;set $waterFlask.consume = true&gt;&gt;

&lt;&lt;set $waterJug.flavors = [&quot;water&quot;, &quot;drink&quot;]&gt;&gt;
&lt;&lt;set $waterJug.consume = true&gt;&gt;

&lt;&lt;set $watermelon.provisions = {veg: 2}&gt;&gt;
&lt;&lt;set $watermelon.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $watermelon.consume = true&gt;&gt;

&lt;&lt;set $whoppingWatermelon.provisions = {veg: 4}&gt;&gt;
&lt;&lt;set $whoppingWatermelon.flavors = [&quot;veg&quot;]&gt;&gt;
&lt;&lt;set $whoppingWatermelon.consume = true&gt;&gt;

&lt;&lt;set $wine.provisions = {other: 1}&gt;&gt;
&lt;&lt;set $wine.flavors = [&quot;booze&quot;, &quot;drink&quot;]&gt;&gt;
&lt;&lt;set $wine.consume = true&gt;&gt;</tw-passagedata><tw-passagedata pid="109" name="feeder patch npcs" tags="feeder-expansion fixes-and-edits" position="5900,800" size="100,100">&lt;&lt;run setup.registerNPC(&quot;creatoriumTeacher&quot;, {
	name: &quot;Opal&quot;,
    gender: &quot;female&quot;,
    species: &quot;magpie&quot;,
    mname: &quot;Onyx&quot;,
})&gt;&gt;</tw-passagedata><tw-passagedata pid="110" name="feeder quest objects" tags="feeder-expansion" position="6300,400" size="100,100">&lt;&lt;set $feeder_questRaccoonCook = {
	name: &quot;Culinary Sampler&quot;,
	description: &quot;The chef running the beachside restaurant wants a sample of your cooking! Bring them 1 //meaty menagerie//, 1 //veggie variety//, and 1 //dessert diversity// to find out if you&#39;ve got what it takes!&quot;,
	completed: false,
	xp: 50,
	gold: 40,
}&gt;&gt;

&lt;&lt;set $feeder_questRaccoonFeast = {
	name: &quot;A Hefty Feast&quot;,
	description: &quot;The chef at the beach has given you a wager - if you can finish their special feast, they&#39;ll let you in on their secret techniques to making hefty meals. You&#39;ll need to provide a payment up front of 100 gold any time you want to try.&quot;,
	completed: false,
	triedAndFailed: false,
	xp: 200,
}&gt;&gt;

&lt;&lt;set $feeder_questWitchSpice = {
	name: &quot;Sourcing the Spice&quot;,
	description: &quot;The witch&#39;s diary speaks of a special spice that can make any food incredibly appealing. Perhaps you could acquire some for yourself for your own cooking...&quot;,
	completed: false,
}&gt;&gt;

&lt;&lt;set $feeder_questUltimateCreation = {
	name: &quot;A Magnum Opus Meal&quot;,
	description: &quot;All your culinary advancements have led to this - the ultimate creation! Gather the ingredients - 30 of each ingredient type, as well as a spectrum gem - cook it up in your kitchen, and bask in the glory of the feast to end all feasts.&quot;,
	completed: false,
	xp: 400,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="111" name="feeder read witch notes" tags="feeder-expansion" position="6600,800" size="100,100">$feeder_witchDiaryNotes.itemUse
&lt;br&gt;

&lt;&lt;set _learnedSomething = false&gt;&gt;
&lt;&lt;set _knowsEverything = true&gt;&gt;

/* Check to start spice quest */
&lt;&lt;if setup.questStarted($feeder_questWitchSpice) == false&gt;&gt;
	Interposed between arcane research and complicated diagrams outlining correct spell circle usage for a number of tasks, you find the occasional food recipe. Unsurprisingly for the inhabitant of a house made of gingerbread, the vast majority of them are for desserts. Each of them sounds wonderfully decadent, your mouth watering as you make mental notes of which ones you&#39;d like to try out. However there&#39;s one problem - each and every one of the recipes includes a nebulously-named ingredient referred to as //&quot;black spice&quot;//, to be added //&quot;when serving guests&quot;//. Puzzled, you flick through the notes until you happen on a passage of the witch&#39;s research on the spice. The //&quot;black spice&quot;// is a substance of magical origin with some very pronounced effects on the appetites of those who eat it. According to a list of experiments, even a small pinch of the spice is enough to make a food incredibly appetizing - greater amounts yielding frankly dangerous levels of gluttony (one test subject literally ate the witch out of house and home!). Maybe your cooking could do with a bit of that...
	&lt;br&gt;
	&lt;&lt;getQuest $feeder_questWitchSpice&gt;&gt;
	&lt;br&gt;
	
	&lt;&lt;set _learnedSomething = true&gt;&gt;
	&lt;&lt;set _knowsEverything = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Check to see what spells the player should unlock, if they haven&#39;t already */
&lt;&lt;for _spell range $feeder_advancedMealSpells&gt;&gt;
	&lt;&lt;set _spell = setup.getSpell(_spell)&gt;&gt;
    &lt;&lt;capture _spell&gt;&gt;
    
    /* We&#39;ll continue to use that old janky widget for now, even though it really should be ported to javascript */
    &lt;&lt;if setup.knowsSpell(_spell) == false&gt;&gt; /* Yet to learn spell */
		&lt;&lt;feeder_meetsSpellRequirements _spell&gt;&gt;
		
		&lt;&lt;if $feeder_meetsSpellRequirements == true&gt;&gt;
			&lt;&lt;if _spell.learnText != null &gt;&gt;
				_spell.learnText
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;getSpell _spell&gt;&gt;
			&lt;br&gt;
			
			&lt;&lt;set _learnedSomething = true&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _knowsEverything = false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;

/* Add narration to the ending if failed to learn anything */
&lt;&lt;if _learnedSomething == false&gt;&gt;
	&lt;&lt;if _knowsEverything == true&gt;&gt;
		... however, it seems like you&#39;ve learned everything there is to know from its insights.
	&lt;&lt;else&gt;&gt;
		... however, there&#39;s still a lot you can&#39;t comprehend. Perhaps after a bit more knowledge and experience you&#39;ll be able to make sense of it all.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="112" name="feeder read witch notes backup" tags="" position="6700,800" size="100,100">$feeder_witchDiaryNotes.itemUse
&lt;br&gt;

&lt;&lt;set _learnedSomething = false&gt;&gt;
&lt;&lt;set _knowsEverything = true&gt;&gt;

/* Check to start spice quest */
&lt;&lt;if setup.questStarted($feeder_questWitchSpice) == false&gt;&gt;
	Interposed between arcane research and complicated diagrams outlining correct spell circle usage for a number of tasks, you find the occasional food recipe. Unsurprisingly for the inhabitant of a house made of gingerbread, the vast majority of them are for desserts. Each of them sounds wonderfully decadent, your mouth watering as you make mental notes of which ones you&#39;d like to try out. However there&#39;s one problem - each and every one of the recipes includes a nebulously-named ingredient referred to as //&quot;black spice&quot;//, to be added //&quot;when serving guests&quot;//. Puzzled, you flick through the notes until you happen on a passage of the witch&#39;s research on the spice. The //&quot;black spice&quot;// is a substance of magical origin with some very pronounced effects on the appetites of those who eat it. According to a list of experiments, even a small pinch of the spice is enough to make a food incredibly appetizing - greater amounts yielding frankly dangerous levels of gluttony (one test subject literally ate the witch out of house and home!). Maybe your cooking could do with a bit of that...
	&lt;br&gt;
	&lt;&lt;getQuest $feeder_questWitchSpice&gt;&gt;
	&lt;br&gt;
	
	&lt;&lt;set _learnedSomething = true&gt;&gt;
	&lt;&lt;set _knowsEverything = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Check to see what spells the player should unlock, if they haven&#39;t already */
&lt;&lt;for _spell range $feeder_advancedMealSpells&gt;&gt;
	&lt;&lt;if setup.hasSpell(_spell) == -1&gt;&gt; /* Yet to learn spell */
		&lt;&lt;feeder_meetsSpellRequirements _spell&gt;&gt;
		
		&lt;&lt;if $feeder_meetsSpellRequirements == true&gt;&gt;
			&lt;&lt;if _spell.learnText != null &gt;&gt;
				_spell.learnText
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;getSpell _spell&gt;&gt;
			&lt;br&gt;
			
			&lt;&lt;set _learnedSomething = true&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _knowsEverything = false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

/* Add narration to the ending if failed to learn anything */
&lt;&lt;if _learnedSomething == false&gt;&gt;
	&lt;&lt;if _knowsEverything == true&gt;&gt;
		... however, it seems like you&#39;ve learned everything there is to know from its insights.
	&lt;&lt;else&gt;&gt;
		... however, there&#39;s still a lot you can&#39;t comprehend. Perhaps after a bit more knowledge and experience you&#39;ll be able to make sense of it all.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="113" name="feeder resolve feeder boss" tags="feeder-expansion" position="6400,100" size="100,100">&lt;&lt;set _weirdFood = either(&quot;beef and ale cheesecake&quot;, &quot;sweet and sour waffles&quot;, &quot;carrot cream&quot;, &quot;jellied broccoli&quot;, &quot;deep-fried cabbage&quot;, &quot;whipped garlic cream&quot;, &quot;vanilla mash potato&quot;)&gt;&gt;

&lt;&lt;if $alive and $e.hea &gt; 0&gt;&gt; /* both player and enemy are still alive, so submit is happening (and maybe defeat, if the player somehow injured themselves) */
	&lt;li&gt;Submit&lt;/li&gt;
	&lt;&lt;if $grapple &gt; 0&gt;&gt;
		You decide to give up struggling and just enjoy the taste of your ill-conceived creation. The messy mass of food continues to funnel itself into your mouth - you can feel its sticky weight shifting up your body to try and get as close to there as possible in its eagerness to be eaten. All the added pressure does help speed up the churning flow of food, but there&#39;s still a limit on how quickly you can keep up. 
	&lt;&lt;else&gt;&gt;
		If there&#39;s anybody more deserving of feasting on the food-fusion beast you&#39;ve created, it&#39;s the creator. It&#39;s time, you decide, to reap what you&#39;ve sown. Dropping onto your knees, you throw your arms open wide and the abomination of food eagerly throws itself into your embrace. Grease and sauce and cream splatter over your $p.fur as it pulls itself up you, reaching a probing point into your $p.mouth. It plunges into your mouth, filling your cheeks to bursting with a questionable combination of food, and keeps pushing and pushing more regardless of whether you can keep up. 
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;findBursting&gt;&gt;
	&lt;&lt;set _leftUntilBurst = $toBurst&gt;&gt;
	&lt;&lt;if _leftUntilBurst &gt;= $e.hea&gt;&gt; /* Player has enough stomach space left to devour the monster */
		&lt;&lt;consume $e.hea $e.hea&gt;&gt;
		&lt;&lt;set $e.hea = 0&gt;&gt;
		
		&lt;br&gt;A seemingly endless number of foods and easily ten times as many clashing flavors flow into you at a relentless rate. There&#39;s a loud upset churning from your stomach as it lets its displeasure at having to deal with such a mix of food be known, the incoming pressure pushing it ever outwards. It&#39;ll cope, you tell yourself, as you feel it swell to a $waist ball. 
		
	&lt;&lt;else&gt;&gt; /* Player doesn&#39;t have enough space */
		&lt;&lt;stuffToBursting&gt;&gt;
		
		&lt;br&gt;A seemingly endless number of foods and easily ten times as many clashing flavors flow into you at a relentless rate. There&#39;s a loud upset churning from your stomach as it lets its displeasure at having to deal with such a mix of food be known, the incoming pressure pushing it ever outwards. It&#39;ll cope, you tell yourself, just as a jolt of pain shoots through the $waist ball. 
	&lt;&lt;/if&gt;&gt;
	&lt;br&gt;
&lt;&lt;else&gt;&gt;
	/* We cheat a bit here and give some extra narration of the creature almost besting the player (even if it should be dead / gone!) just so we can use the same narration later and it still make sense */
	
	The food abomination starts to shrink back and for a moment you think you&#39;ve got it on the retreat. Then, &#39;&#39;wham!&#39;&#39; The mound of food shoots up, delivering an uppercut and a fistful of food straight to your $p.mouth! The blow sends you staggering back a few paces before you tumble onto your $fatness backside. As you scramble to get up the abomination throws itself upon you, forcing you back down and pinning you in a mess of grease, sauce, and cream. It plunges a tip into your mouth and just keeps pushing and pushing more of itself into your churning, rapidly swelling belly. 
&lt;&lt;/if&gt;&gt;

/* ENDING */
/* Do victory if appropriate */
&lt;&lt;if $e.hea &lt;= 0&gt;&gt; /* enemy defeated */
	&lt;&lt;set $feeder_ultimateMonsterAlive = false&gt;&gt;
	
	&lt;br&gt;
	
	/* Is it a pyrrhic victory? */
	&lt;&lt;if !$alive&gt;&gt;
		/* Should we end the quest here? */
		&lt;&lt;if setup.questCompleted($feeder_questUltimateCreation) == false&gt;&gt;
			Eventually the pressure of incoming food starts to let up, and less and less of your view of the world is obscured by food. Then with one last mouthful of _weirdFood, it stops. With a fading vision you peer beyond your $waist belly to see nothing but inanimate smears of food remain. 
			Your masterpiece, gone. The //unique// mess of flavors on your tongue and your viciously churning stomach tell you maybe that&#39;s for the best. Some culinary paths are best left unexplored...&lt;br&gt;You clutch at your painfully stuffed stomach as the churning only grows in intensity, until you pass out on the cold $e.special floor. 
		&lt;&lt;else&gt;&gt;
			Eventually the pressure of incoming food starts to let up, and less and less of your view of the world is obscured by food. Then with one last mouthful of _weirdFood, it stops. You glance down at the remaining smears of food, but none of it appears to be moving. Looks like you&#39;ve won! It feels like you just ate an entire buffet at several differently-themed restaurants, and no amount of scraping you tongue seems to be getting rid of that //unique// blend of flavors. 
			&lt;br&gt;As you go to lift yourself off of the $e.special floor, it only just hits you how painfully stuffed you are. You double over onto your $waist belly, a vicious churning boiling away inside. The strained groans of your overstuffed belly are the last thing you hear before you black out. 
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		/* Should we end the quest here? */
		&lt;&lt;if setup.questCompleted($feeder_questUltimateCreation) == false&gt;&gt;
			Eventually the pressure of incoming food starts to let up, and less and less of your view of the world is obscured by food. Then with one last mouthful of _weirdFood, it stops. You glance down at the remaining smears of food, but none of it appears to be moving. It&#39;s over... 
			&lt;br&gt;A sense of ambivalence washes over you as you feel all that remains of your masterpiece churning away in your $waist stomach, the //unique// taste of a mess of flavors still on your tongue. Perhaps some paths of culinary greatness are best left unexplored... 
		&lt;&lt;else&gt;&gt;
			Eventually the pressure of incoming food starts to let up, and less and less of your view of the world is obscured by food. Then with one last mouthful of _weirdFood, it stops. You glance down at the remaining smears of food, but none of it appears to be moving. Looks like you&#39;ve won! You take a moment to catch your breath, lying there on the $e.special floor. It feels like you just ate an entire buffet at several differently-themed restaurants, and no amount of scraping you tongue seems to be getting rid of that //unique// blend of flavors. The churning in your belly isn&#39;t really settling, but one giant room-shaking &#39;&#39;BURP!&#39;&#39; puts an end to that. Ah, what a feast! 
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Do the reward for the quest now, assuming it&#39;s their first time beating the boss */
	&lt;&lt;if setup.questCompleted($feeder_questUltimateCreation) == false&gt;&gt;
		&lt;&lt;questReward $feeder_questUltimateCreation&gt;&gt;
		&lt;li&gt;You can now cook &#39;&#39;ultimate meals&#39;&#39;.&lt;/li&gt;
		&lt;li&gt;You can also now make more Food Abominations, but that might not be a great idea...&lt;/li&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Do standard rewards and ending */
	&lt;&lt;if $alive&gt;&gt;
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;hr&gt;
		
		&lt;&lt;if $e.special == &quot;kitchen&quot;&gt;&gt;
			You spend some time cleaning up the messy aftermath of the fight. 
		&lt;&lt;else&gt;&gt;
			You spend a while cleaning up all the mess, before staggering upstairs into the kitchen. 
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;include &quot;Kitchen&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;__&#39;&#39;Victory?&#39;&#39;__&lt;/li&gt;
		&lt;&lt;if $e.xp &gt; 0&gt;&gt;&lt;&lt;doXP $e.xp&gt;&gt;&lt;&lt;/if&gt;&gt;

		&lt;&lt;if $e.gld &gt; 0&gt;&gt;
			&lt;&lt;set _randomGold = random(($e.gld*0.8), ($e.gld*1.2))&gt;&gt;
			&lt;&lt;doGld _randomGold&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;hr&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt; /* Failure */
	
	&lt;br&gt;
	
	&lt;&lt;if $e.special == &quot;kitchen&quot;&gt;&gt; /* Final last push to lock it in the basement */
		Gulping down mouthful after mouthful, the pile of food continues pressing into you, and you feel your strength slowly ebbing away. Only when your $waist stomach is so painfully full you think you might burst do you realise how much is still left to go. You&#39;re not going to make it. The thought of passing out into a deep food coma sounds like a sweet release from this onslaught of unfitting foods, and your eyes start drifting shut while your churning stomach bulges painfully larger. But wait - when this monstrosity is done with you, it&#39;ll only go out seeking more victims. You can only imagine the sort of havoc your creation could cause if it got out. Or could imagine, if you weren&#39;t so mind-numbingly full that you can&#39;t even think straight. You&#39;ve got to do something! 
		&lt;br&gt;Staggering to your feet, you can barely stand with the weight of your bolderlike belly weighing you down. You fall against the pile of food for support, which still all too happily crams mouthful after mouthful of questionable food down your throat. Through fading vision you spot the open door of the basement behind the abomination, and take that as your best shot. With one great heave you push the abomination back - the monster not caring so long as your $p.mouth is close. Choking on a fistful of sweet and sour waffles, you push again.	You stagger and almost slip on the slick of food stains its left on the floor, but thankfully its bulk pressing back at you props you upright. With your $p.mouth practically pressed to the creature, it has no trouble thrusting a few more extra large helpings into your screaming stomach. You can&#39;t do this... you feel like you&#39;re going to explode any minute. With the last of your strength, you give one last big push, swallowing one last large mouthful from the abomination before slamming the door shut on it. Groaning, you collapse onto the kitchen floor, before everything goes black. 
	&lt;&lt;else&gt;&gt;
		Gulping down mouthful after mouthful, the pile of food continues pressing into you, and you feel your strength slowly ebbing away. Only when your $waist stomach is so painfully full you think you might burst do you realise how much is still left to go. You&#39;re not going to make it. All you can see is food as your vision fades to black. 
	&lt;&lt;/if&gt;&gt;
	
	&lt;hr&gt;
	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;endCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="114" name="feeder spell objects" tags="feeder-expansion" position="6200,400" size="100,100">/* COSTING - Design notes
1 Fat converts into 4 mana.
Meals give 7 fat, so cost should be... 7*4 = 28!
That&#39;s quite the cost for something that should be basic. How to get around this?
- Make special versions of conjured meals that are less fattening?
... This would work mechanically, but would be at odds with how conjured foods work in the narrative, where they just as fattening if not more than the real things.
- Just don&#39;t bother. Let people gain fat through this method if they want. It&#39;s not like there isn&#39;t already sources of infinite fat in the game.

Though now I think about it, the fact that meals also heal 20 on consumption puts it comparable to the spell &quot;Heal&quot; in terms of healing for a similar cost, with an added downside of requiring stomach space.
Let&#39;s just fudge the numbers so the mana cost is ~Fat yield * 3.

Eh, even at that cost it still feels too expensive, let&#39;s go with Fat Yield * 2? Even then, that might feel too expensive compared to other spells...
*/

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure meaty meal&quot;,
	name: &quot;conjure meaty meal&quot;,	
	description: &quot;Conjures up a tasty meal fit to satisfy any carnivore. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of meat assembles itself out of thin air. &quot;,
	value: 20,
	level: 1,
	cost: 14,
	int: 30,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealMeat&quot;,
	amount: 1,
	
	id: &quot;feeder_conjureMeatMeal&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure veggie meal&quot;,
	name: &quot;conjure veggie meal&quot;,	
	description: &quot;Conjures up a tasty meal fit to satisfy any herbivore. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of fruit and veggies assembles itself out of thin air. &quot;,
	value: 20,
	level: 1,
	cost: 14,
	int: 30,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealVeg&quot;,
	amount: 1,
	
	id: &quot;feeder_conjureVegMeal&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure desserty meal&quot;,
	name: &quot;conjure desserty meal&quot;,	
	description: &quot;Conjures up a tasty meal fit to satisfy any sweet tooth. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of desserts assembles itself out of thin air. &quot;,
	value: 20,
	level: 1,
	cost: 14,
	int: 30,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealDessert&quot;,
	amount: 1,
	
	id: &quot;feeder_conjureDessertMeal&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure appetizing meaty meal&quot;,
	name: &quot;conjure appetizing meaty meal&quot;,	
	description: &quot;Conjures up a craving-inducing meal fit to leave any carnivore hungry for more. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of magically-enhanced meat assembles itself out of thin air. &quot;,
	value: 40,
	level: 3,
	cost: 20,
	int: 50,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealMeatAddictive&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questWitchSpice&quot;],
	requiresSpells: [&quot;feeder_conjureMeatMeal&quot;],
	learnText: &quot;You think you&#39;ve found a way to apply the addictive qualities of the spice to meat-based meals that you conjure. &quot;,
	
	id: &quot;feeder_conjureMeatMealAddictive&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure appetizing veggie meal&quot;,
	name: &quot;conjure appetizing veggie meal&quot;,	
	description: &quot;Conjures up a craving-inducing meal fit to leave any herbivore hungry for more. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of magically-enhanced fruit and veggies assembles itself out of thin air. &quot;,
	value: 40,
	level: 3,
	cost: 20,
	int: 50,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealVegAddictive&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questWitchSpice&quot;],
	requiresSpells: [&quot;feeder_conjureVegMeal&quot;],
	learnText: &quot;You think you&#39;ve found a way to apply the addictive qualities of the spice to veggie-based meals that you conjure. &quot;,
	
	id: &quot;feeder_conjureVegMealAddictive&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure appetizing desserty meal&quot;,
	name: &quot;conjure appetizing desserty meal&quot;,	
	description: &quot;Conjures up a craving-inducing meal fit to leave any sweet tooth hungry for more. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of magically-enhanced desserts assembles itself out of thin air. &quot;,
	value: 40,
	level: 3,
	cost: 20,
	int: 50,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealDessertAddictive&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questWitchSpice&quot;],
	requiresSpells: [&quot;feeder_conjureDessertMeal&quot;],
	learnText: &quot;You think you&#39;ve found a way to apply the addictive qualities of the spice to dessert-based meals that you conjure. &quot;,
	
	id: &quot;feeder_conjureDessertMealAddictive&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure hefty meaty meal&quot;,
	name: &quot;conjure hefty meaty meal&quot;,	
	description: &quot;Conjures up an astoundingly filling meal fit to stuff any carnivore. &quot;,
	cast: &quot;With a wave of your hand, an unsuspectingly hefty meal comprised predominantly of meat assembles itself out of thin air. &quot;,
	value: 20,
	level: 5,
	cost: 45,
	int: 70,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealMeatHefty&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questRaccoonFeast&quot;],
	requiresSpells: [&quot;feeder_conjureMeatMeal&quot;],
	learnText: &quot;By applying what you&#39;ve learned with some of what&#39;s written here, you reckon you could conjure meaty meals that are much more filling. &quot;,
	
	id: &quot;feeder_conjureMeatMealHefty&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure hefty veggie meal&quot;,
	name: &quot;conjure hefty veggie meal&quot;,	
	description: &quot;Conjures up an astoundingly filling meal fit to stuff any herbivore. &quot;,
	cast: &quot;With a wave of your hand, an unsuspectingly hefty meal comprised predominantly of fruit and veggies assembles itself out of thin air. &quot;,
	value: 20,
	level: 5,
	cost: 45,
	int: 70,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealVegHefty&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questRaccoonFeast&quot;],
	requiresSpells: [&quot;feeder_conjureVegMeal&quot;],
	learnText: &quot;By applying what you&#39;ve learned with some of what&#39;s written here, you reckon you could conjure veggie meals that are much more filling. &quot;,
	
	id: &quot;feeder_conjureVegMealHefty&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure hefty desserty meal&quot;,
	name: &quot;conjure hefty desserty meal&quot;,	
	description: &quot;Conjures up an astoundingly filling meal fit to stuff any sweet tooth. &quot;,
	cast: &quot;With a wave of your hand, an unsuspectingly hefty meal comprised predominantly of desserts assembles itself out of thin air. &quot;,
	value: 20,
	level: 5,
	cost: 45,
	int: 70,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealDessertHefty&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questRaccoonFeast&quot;],
	requiresSpells: [&quot;feeder_conjureDessertMeal&quot;],
	learnText: &quot;By applying what you&#39;ve learned with some of what&#39;s written here, you reckon you could conjure desserty meals that are much more filling. &quot;,
	
	id: &quot;feeder_conjureDessertMealHefty&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

/* Not sure if these calorific spells are going to exist or not... */
&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure calorific meaty meal&quot;,
	name: &quot;conjure calorific meaty meal&quot;,	
	description: &quot;Conjures up a tasty meal fit to fatten up any carnivore. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of calorie-packed meat assembles itself out of thin air. &quot;,
	value: 20,
	level: 3,
	cost: 30,
	int: 50,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealMeatCalorific&quot;,
	amount: 1,
	
	requiresSpells: [&quot;feeder_conjureMeatMeal&quot;],
	learnText: &quot;After reading through some of the witch&#39;s experiments in fattening, you realise how you could conjure much more calorie-packed meaty meals. &quot;,
	
	id: &quot;feeder_conjureMeatMealCalorific&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;


&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure calorific veggie meal&quot;,
	name: &quot;conjure calorific veggie meal&quot;,	
	description: &quot;Conjures up a tasty meal fit to fatten up any herbivore. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of calorie-packed fruit and veggies assembles itself out of thin air. &quot;,
	value: 20,
	level: 3,
	cost: 30,
	int: 50,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealVegCalorific&quot;,
	amount: 1,
	
	requiresSpells: [&quot;feeder_conjureVegMeal&quot;],
	learnText: &quot;After reading through some of the witch&#39;s experiments in fattening, you realise how you could conjure much more calorie-packed veggie meals. &quot;,
	
	id: &quot;feeder_conjureVegMealCalorific&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure calorific desserty meal&quot;,
	name: &quot;conjure calorific desserty meal&quot;,	
	description: &quot;Conjures up a tasty meal fit to fatten up any sweet tooth. &quot;,
	cast: &quot;With a wave of your hand, a meal comprised predominantly of calorie-packed desserts assembles itself out of thin air. &quot;,
	value: 20,
	level: 3,
	cost: 30,
	int: 50,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealDessertCalorific&quot;,
	amount: 1,
	
	requiresSpells: [&quot;feeder_conjureDessertMeal&quot;],
	learnText: &quot;After reading through some of the witch&#39;s experiments in fattening, you realise how you could conjure much more calorie-packed desserty meals. &quot;,
	
	id: &quot;feeder_conjureDessertMealCalorific&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure ultimate meaty meal&quot;,
	name: &quot;conjure ultimate meaty meal&quot;,	
	description: &quot;Conjures up an absolutely perfect meaty meal, fit to stuff, satisfy, and completely hook any carnivore. &quot;,
	cast: &quot;With a wave of your hand, a pristinely perfect meal of predominantly meat assembles itself out of thin air. &quot;,
	value: 20,
	level: 5,
	cost: 60,
	int: 120,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealMeatOmni&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questUltimateCreation&quot;],
	requiresSpells: [&quot;feeder_conjureMeatMeal&quot;],
	learnText: &quot;Reflecting upon your own discoveries and some of the arcane diagrams, you realise how to conjure the ultimate meaty meals of your own design. &quot;,
	
	id: &quot;feeder_conjureMeatMealOmni&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure ultimate veggie meal&quot;,
	name: &quot;conjure ultimate veggie meal&quot;,	
	description: &quot;Conjures up an absolutely perfect veggie meal, fit to stuff, satisfy, and completely hook any herbivore. &quot;,
	cast: &quot;With a wave of your hand, a pristinely perfect meal of predominantly fruit and veggies assembles itself out of thin air. &quot;,
	value: 20,
	level: 5,
	cost: 60,
	int: 120,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealVegOmni&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questUltimateCreation&quot;],
	requiresSpells: [&quot;feeder_conjureVegMeal&quot;],
	learnText: &quot;Reflecting upon your own discoveries and some of the arcane diagrams, you realise how to conjure the ultimate veggie meals of your own design. &quot;,
	
	id: &quot;feeder_conjureVegMealOmni&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Conjure ultimate desserty meal&quot;,
	name: &quot;conjure ultimate desserty meal&quot;,	
	description: &quot;Conjures up an absolutely perfect desserty meal, fit to stuff, satisfy, and completely hook any sweet tooth. &quot;,
	cast: &quot;With a wave of your hand, a pristinely perfect meal of predominantly desserts assembles itself out of thin air. &quot;,
	value: 20,
	level: 5,
	cost: 60,
	int: 120,
	type: &quot;item&quot;,
	icon: &quot;restaurant&quot;,
	target: &quot;player&quot;,
	ooc: true,
	item: &quot;$feeder_mealDessertOmni&quot;,
	amount: 1,
	
	requiresQuests: [&quot;$feeder_questUltimateCreation&quot;],
	requiresSpells: [&quot;feeder_conjureDessertMeal&quot;],
	learnText: &quot;Reflecting upon your own discoveries and some of the arcane diagrams, you realise how to conjure the ultimate desserty meals of your own design. &quot;,
	
	id: &quot;feeder_conjureDessertMealOmni&quot;,
	combat: true,
    option: &quot;feeder_expansionEnabled&quot;,
})&gt;&gt;


&lt;&lt;set $feeder_advancedMealSpells = [&quot;feeder_conjureMeatMealAddictive&quot;, &quot;feeder_conjureVegMealAddictive&quot;, &quot;feeder_conjureDessertMealAddictive&quot;, &quot;feeder_conjureMeatMealHefty&quot;, &quot;feeder_conjureVegMealHefty&quot;, &quot;feeder_conjureDessertMealHefty&quot;, &quot;feeder_conjureMeatMealCalorific&quot;, &quot;feeder_conjureVegMealCalorific&quot;, &quot;feeder_conjureDessertMealCalorific&quot;, &quot;feeder_conjureMeatMealOmni&quot;, &quot;feeder_conjureVegMealOmni&quot;, &quot;feeder_conjureDessertMealOmni&quot;]&gt;&gt;</tw-passagedata><tw-passagedata pid="115" name="feeder storage info" tags="feeder-expansion" position="6700,400" size="100,100">&lt;&lt;feeder_getProvisionCount &quot;meat&quot;&gt;&gt;
&lt;&lt;set _meatCount = $feeder_provisionCount&gt;&gt;
&lt;&lt;feeder_getProvisionCount &quot;veg&quot;&gt;&gt;
&lt;&lt;set _vegCount = $feeder_provisionCount&gt;&gt;
&lt;&lt;feeder_getProvisionCount &quot;dessert&quot;&gt;&gt;
&lt;&lt;set _dessertCount = $feeder_provisionCount&gt;&gt;
&lt;&lt;feeder_getProvisionCount &quot;other&quot;&gt;&gt;
&lt;&lt;set _otherCount = $feeder_provisionCount&gt;&gt;

/* OLD VERSION
Currently in storage you have &lt;&lt;if _meatCount == 0&gt;&gt;no meat to speak of&lt;&lt;else&gt;&gt;_meatCount portions of meat&lt;&lt;/if&gt;&gt;, &lt;&lt;if _vegCount == 0&gt;&gt;a complete lack of fruit or veg&lt;&lt;else&gt;&gt;_vegCount portions of fruit and veg&lt;&lt;/if&gt;&gt;, &lt;&lt;if _dessertCount == 0&gt;&gt;a sad absence of anything for desserts&lt;&lt;else&gt;&gt;_dessertCount portions of dessert ingredients&lt;&lt;/if&gt;&gt;, and &lt;&lt;if _otherCount == 0&gt;&gt;that&#39;s it&lt;&lt;else&gt;&gt;an assortment of _otherCount other miscellaneous ingredients&lt;&lt;/if&gt;&gt;.
*/

/* New version: */
/* Old version was nice, but the changes in word length meant the list would occasionally move around, making the player sometimes accidentally press the wrong item on the list */
Currently in storage you have:
&lt;li&gt;&lt;&lt;if _meatCount == 0&gt;&gt;no meat to speak of&lt;&lt;elseif _meatCount == 1&gt;&gt;a portion of meat&lt;&lt;else&gt;&gt;_meatCount portions of meat&lt;&lt;/if&gt;&gt;.&lt;/li&gt;
&lt;li&gt;&lt;&lt;if _vegCount == 0&gt;&gt;a complete lack of fruit or veg&lt;&lt;elseif _vegCount == 1&gt;&gt;a portion of veggies&lt;&lt;else&gt;&gt;_vegCount portions of fruit and veg&lt;&lt;/if&gt;&gt;&lt;/li&gt;
&lt;li&gt;&lt;&lt;if _dessertCount == 0&gt;&gt;a sad absence of anything for desserts&lt;&lt;elseif _dessertCount == 1&gt;&gt;one portion of dessert ingredients&lt;&lt;else&gt;&gt;_dessertCount portions of dessert ingredients&lt;&lt;/if&gt;&gt;&lt;/li&gt;
&lt;li&gt;&lt;&lt;if _otherCount == 0&gt;&gt;no other ingredients&lt;&lt;elseif _otherCount == 1&gt;&gt;one portion of other ingredients&lt;&lt;else&gt;&gt;an assortment of _otherCount other miscellaneous ingredients&lt;&lt;/if&gt;&gt;&lt;/li&gt;</tw-passagedata><tw-passagedata pid="116" name="feeder tuning" tags="feeder-expansion" position="6000,600" size="100,100">/* This file contains a set of variables for tuning balance values without having to go out and edit core files */

/*Modifiers for a feed attempt to be successful*/
&lt;&lt;set $feeder_feedResisterWeaknessBonus = 20&gt;&gt;
&lt;&lt;set $feeder_feedBossResisterWeaknessBonus = 20&gt;&gt;

/*Base chances that a feed will stun an enemy based on their archetype*/
&lt;&lt;set $feeder_feedResisterStunChance = 30&gt;&gt;
&lt;&lt;set $feeder_feedEaterStunChance = 90&gt;&gt;
&lt;&lt;set $feeder_feedHunterStunChance = 50&gt;&gt;

&lt;&lt;set $feeder_feedBossResisterStunChance = 15&gt;&gt;
&lt;&lt;set $feeder_feedBossEaterStunChance = 75&gt;&gt;
&lt;&lt;set $feeder_feedBossHunterStunChance = 30&gt;&gt;

/*Bonus chance that a feed will stun an enemy when they&#39;re given a favored flavor, based on their archetype*/
&lt;&lt;set $feeder_feedResisterStunWeaknessBonus = 25&gt;&gt;
&lt;&lt;set $feeder_feedEaterStunWeaknessBonus = 25&gt;&gt;
&lt;&lt;set $feeder_feedHunterStunWeaknessBonus = 25&gt;&gt;

&lt;&lt;set $feeder_feedBossResisterStunWeaknessBonus = 15&gt;&gt;
&lt;&lt;set $feeder_feedBossEaterStunWeaknessBonus = 15&gt;&gt;
&lt;&lt;set $feeder_feedBossHunterStunWeaknessBonus = 15&gt;&gt;

/*General caps for different feed-related things*/
&lt;&lt;set $feeder_feedStunChanceMin = 5&gt;&gt;
&lt;&lt;set $feeder_feedStunChanceMax = 100&gt;&gt;
&lt;&lt;set $feeder_feedBossStunChanceMin = 0&gt;&gt;
&lt;&lt;set $feeder_feedBossStunChanceMax = 90&gt;&gt;
/*(caps are fairly generous for feed chances, since enemies usually don&#39;t need a contest to feed the player). Note that this will only be used when feeding resister, since currently all other types auto succeed*/
&lt;&lt;set $feeder_feedChanceMin = 35&gt;&gt;
&lt;&lt;set $feeder_feedChanceMax = 100&gt;&gt;
&lt;&lt;set $feeder_feedBossChanceMin = 35&gt;&gt;
&lt;&lt;set $feeder_feedBossChanceMax = 90&gt;&gt;

/*Addiction Bonuses*/
&lt;&lt;set $feeder_feedEnemyAddictiveBonus = 20&gt;&gt;
&lt;&lt;set $feeder_feedBossAddictiveBonus = 20&gt;&gt;
&lt;&lt;set $feeder_feedEnemyAddictiveStunBonus = 20&gt;&gt;
&lt;&lt;set $feeder_feedBossAddictiveStunBonus = 10&gt;&gt;
&lt;&lt;set $feeder_addictedStatusPersists = 33&gt;&gt;


/*MISC*/
&lt;&lt;set $feeder_genericStuffedStatDebuffMult = 0.66&gt;&gt;
&lt;&lt;set $feeder_substituteOtherConversionRate = 0.5&gt;&gt; /* How much ingredients a `other` provision is worth when converting it into another type. 0.5 means it takes 2 `other` provisions per 1 lacking ingredient. */</tw-passagedata><tw-passagedata pid="117" name="feeder widgets" tags="widget feeder-expansion" position="6100,800" size="200,100">/* This passage should be given the `widget` tag! */

/*not quite sure what the difference is between widgets and just using javascript???*/
/* Future me: Apparently I should&#39;ve used javascript for most of this stuff... I&#39;ll stick with using widgets for the rest of this mod for consistency&#39;s sake, and use JS where I can in future mods. */

=====
/* GENERIC ACTIONS*/
/* These can be used as default generic blocks of codes within the AI */

&lt;&lt;widget &quot;feeder_genericActionText&quot;&gt;&gt;
	&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
	&lt;&lt;set _isBoss = false&gt;&gt;
	&lt;&lt;set _success = true&gt;&gt;
	&lt;&lt;if $args.length &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 2&gt;&gt;&lt;&lt;set _success = $args[2]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*
	feeder_genericActionText
	Arg 0: $args[0]
	Arg 1: $args[1]
	Arg 2: $args[2]
	*/
	
	&lt;&lt;if _success&gt;&gt;
		/*Can put custom feed messages for different items here!*/
		/*Can also consider variations based on archetype*/
		&lt;&lt;feeder_enemyHasWeaknessToFedFood&gt;&gt;
		
		&lt;&lt;switch $feeder_itemFed.name&gt;&gt;
			&lt;&lt;default&gt;&gt;
				&lt;&lt;if _archetype == &quot;hunter&quot;&gt;&gt;
					&lt;&lt;if $feeder_hasWeakness&gt;&gt;
						The $e.name hungrily snaps down the $feeder_itemFed.name. $npc1.He seems to enjoy the taste enough that $npc1.he almost considers waiting to see if you have more, rather than continuing to try and eat you. Almost.
					&lt;&lt;else&gt;&gt;
						The $e.name hungrily snaps down the $feeder_itemFed.name, before returning to eye you hungrily.
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;elseif _archetype == &quot;eater&quot;&gt;&gt;
					&lt;&lt;if $feeder_hasWeakness&gt;&gt;
						The $e.name eagerly eats the $feeder_itemFed.name, happy for more food. $npc1.His eyes roll back in pleasure at the taste, and $npc1.he licks his lips hungrily.
					&lt;&lt;else&gt;&gt;
						The $e.name eagerly eats the $feeder_itemFed.name, happy for more food.
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;if $feeder_hasWeakness&gt;&gt;
						You force the $feeder_itemFed.name into the $e.name&#39;s mouth. $npc1.He resists, but that resistance wanes once $npc1.he gets a taste.
					&lt;&lt;else&gt;&gt;
						You force the $feeder_itemFed.name into the $e.name&#39;s mouth.
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;/if&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;else&gt;&gt;
		The $e.name evades your attempts to feed $npc1.him the $feeder_itemFed.name.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_genericActionStunCheck&quot;&gt;&gt;
	&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
	&lt;&lt;set _isBoss = false&gt;&gt;
	&lt;&lt;if $args.length  &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/* Don&#39;t try to stun if they&#39;re already stunned - feeding pacification shouldn&#39;t stack! */
	&lt;&lt;if $e.stun == 0&gt;&gt;
		&lt;&lt;feeder_tryStunFeedee _archetype _isBoss&gt;&gt;
		&lt;&lt;if $feeder_feedStunCheck&gt;&gt;
			&lt;&lt;eBuff &quot;stun&quot; 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_genericActionDefeatText&quot;&gt;&gt;
	The $e.name collapses to the floor, too stuffed to move. Looks like you&#39;ve won?
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_genericActionDefeatCheck&quot;&gt;&gt;
	&lt;&lt;set _randomization = $args[0]&gt;&gt;
	
	&lt;&lt;if $e.ate &gt;= $e.sto&gt;&gt;
		/* Do the narration */
		&lt;br&gt;&lt;br&gt;
		&lt;&lt;if $args.length &gt; 1&gt;&gt; /* Allow custom text to be used instead */
			$args[1]
		&lt;&lt;else&gt;&gt;
			&lt;&lt;feeder_genericActionDefeatText&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;include &quot;Victory&quot;&gt;&gt;
		&lt;&lt;if _randomization != null&gt;&gt;
			&lt;&lt;include _randomization&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_genericActionHalfFullText&quot;&gt;&gt;
	The $e.name is starting to look slow and lethargic as $npc1.he grows more stuffed.
&lt;&lt;/widget&gt;&gt;

/* Can provide custom text to use instead of generic text, so you can use this in cases where you don&#39;t want to make a custom stuffed debuff */
&lt;&lt;widget &quot;feeder_genericActionHalfFullCheck&quot;&gt;&gt;
	&lt;&lt;if $e.ate &gt;= $e.sto / 2 and $e.stuffedHalf == false&gt;&gt;
		/* Do the narration */
		&lt;br&gt;&lt;br&gt;
		&lt;&lt;if $args.length &gt; 0&gt;&gt;
			$args[0]
		&lt;&lt;else&gt;&gt;
			&lt;&lt;feeder_genericActionHalfFullText&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/*Apply slow debuff*/
		&lt;&lt;eBuff &quot;slow&quot; 100&gt;&gt;
		
		/*Weaken their stats*/
		&lt;&lt;set $e.str *= $feeder_genericStuffedStatDebuffMult&gt;&gt;
		&lt;&lt;set $e.agi *= $feeder_genericStuffedStatDebuffMult&gt;&gt;
		&lt;&lt;set $e.int *= $feeder_genericStuffedStatDebuffMult&gt;&gt;
		
		/*Prevent from happening again*/
		&lt;&lt;set $e.stuffedHalf = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_genericSpecialItemProcess&quot;&gt;&gt;
	&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
	&lt;&lt;set _isBoss = false&gt;&gt;
	&lt;&lt;if $args.length  &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/* TODO */
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_genericActionFull&quot;&gt;&gt;
	&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
	&lt;&lt;set _isBoss = false&gt;&gt;
	&lt;&lt;set _randomization = null&gt;&gt;
	&lt;&lt;if $args.length  &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 2&gt;&gt;&lt;&lt;set _randomization = $args[2]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/* Make feed attempt */
	&lt;&lt;feeder_tryFeedEnemy _archetype _isBoss&gt;&gt;
	&lt;&lt;if $feeder_feedCheck&gt;&gt;
		/* Narrate the feeding */
		&lt;&lt;feeder_genericActionText _archetype _isBoss true&gt;&gt;
		
		/* Use up the item */
		&lt;&lt;feeder_tryRemoveFedItem&gt;&gt;
		
		/*Add food to belly*/
		&lt;&lt;feeder_enemyConsume $feeder_fedAmount&gt;&gt;
		
		/* Handle special item effects */
		&lt;&lt;feeder_genericSpecialItemProcess _archetype _isBoss&gt;&gt;
		
		/*Check to see if has won*/
		&lt;&lt;feeder_genericActionDefeatCheck _randomization&gt;&gt;
		&lt;&lt;if $e.ate &lt; $e.sto&gt;&gt; /*Not defeated from stuffing, so continue*/
			/*Check to see if should trigger halfway debuffs*/
			&lt;&lt;feeder_genericActionHalfFullCheck&gt;&gt;
			
			/*Check to see if the enemy should be stunned*/
			&lt;&lt;feeder_genericActionStunCheck _archetype _isBoss&gt;&gt;
			
			/* Perform their turn (which will be interrupted if they were stunned from the feeding) */
			&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;feeder_genericActionText _archetype _isBoss false&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====
&lt;&lt;widget &quot;feeder_tryRemoveFedItem&quot;&gt;&gt;
	&lt;&lt;if $feeder_itemFed.consume == true&gt;&gt;
		&lt;&lt;removeItem $feeder_itemFed&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====
&lt;&lt;widget &quot;feeder_tryFeedEnemy&quot;&gt;&gt;
	/* Process Arguments */
	&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
	&lt;&lt;set _isBoss = false&gt;&gt;
	&lt;&lt;if $args.length  &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*Perform Checks*/
	&lt;&lt;set $feeder_feedCheck = false&gt;&gt;
    
	&lt;&lt;switch _archetype&gt;&gt;
		&lt;&lt;case &quot;resister&quot;&gt;&gt;
			&lt;&lt;set _bonus = 0&gt;&gt;
			
			&lt;&lt;feeder_enemyHasWeaknessToFedFood&gt;&gt;
			&lt;&lt;if $feeder_hasWeakness&gt;&gt;
				&lt;&lt;if _isBoss&gt;&gt;
					&lt;&lt;set _bonus = $feeder_feedBossResisterWeaknessBonus&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set _bonus = $feeder_feedResisterWeaknessBonus&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			/* Add addiction bonus */
			&lt;&lt;if $e.addicted == true&gt;&gt;
				&lt;&lt;if _isBoss&gt;&gt;
					&lt;&lt;set _bonus += $feeder_feedBossAddictiveBonus&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set _bonus += $feeder_feedEnemyAddictiveBonus&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;set _stat = $str&gt;&gt;
			&lt;&lt;if $agi &gt; _stat&gt;&gt;&lt;&lt;set _stat = $agi&gt;&gt;&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $int &gt; _stat&gt;&gt;&lt;&lt;set _stat = $int&gt;&gt;&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;set _enemyStat = $e.agi&gt;&gt;
			&lt;&lt;if $e.int &gt; _enemyStat&gt;&gt;&lt;&lt;set _enemyStat = $e.int&gt;&gt;&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;if _isBoss&gt;&gt;
				&lt;&lt;if setup.skillTestRange(_stat + _bonus, _enemyStat, $feeder_feedBossChanceMin, $feeder_feedBossChanceMax)&gt;&gt;
					&lt;&lt;set $feeder_feedCheck = true&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;if setup.skillTestRange(_stat + _bonus, _enemyStat, $feeder_feedChanceMin, $feeder_feedChanceMax)&gt;&gt;
					&lt;&lt;set $feeder_feedCheck = true&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;default&gt;&gt; /* Currently, all other types succeed without a check being necessary */
			&lt;&lt;set $feeder_feedCheck = true&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_enemyConsume&quot;&gt;&gt;
	&lt;&lt;set _tryAmount = $args[0]&gt;&gt;
	&lt;&lt;set _doCap = false&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _doCap = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/* In the future, we could put max caps on the amount of food that a creature can be made to eat at once */
	
	&lt;&lt;set _amount = _tryAmount&gt;&gt;
	
	&lt;&lt;set $e.ate += _amount&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* Provide an array of flavors, and will check to see if the enemy has a weakness for any of them */
&lt;&lt;widget &quot;feeder_enemyHasFlavorWeakness&quot;&gt;&gt;
	&lt;&lt;set _flavors = $args[0]&gt;&gt;
	
	&lt;&lt;set $feeder_hasWeakness = false&gt;&gt;
	
	&lt;&lt;for _i, _flavor range _flavors&gt;&gt;
		&lt;&lt;if $e.flavorWeakness.includes(_flavor)&gt;&gt;
			/* Enemy has a weakness for this flavor! */
			&lt;&lt;set $feeder_hasWeakness = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_enemyHasWeaknessToFedFood&quot;&gt;&gt;
	&lt;&lt;set $feeder_hasWeakness = false&gt;&gt;
	
	&lt;&lt;if $feeder_itemFed != null and $feeder_itemFed.flavors != null&gt;&gt;
		&lt;&lt;feeder_enemyHasFlavorWeakness $feeder_itemFed.flavors&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_getFoodStunWeaknessBonus&quot;&gt;&gt;
	/* Process arguments */
	&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
	&lt;&lt;set _isBoss = false&gt;&gt;
	&lt;&lt;if $args.length  &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/* Work out if has weakness*/
	&lt;&lt;feeder_enemyHasWeaknessToFedFood&gt;&gt;
	
	/* Calculate weakness bonus */
	&lt;&lt;set $feeder_stunWeaknessBonus = 0&gt;&gt;
	
	&lt;&lt;if $feeder_hasWeakness&gt;&gt;
		&lt;&lt;switch _archetype&gt;&gt;
			&lt;&lt;case &quot;hunter&quot;&gt;&gt;
				&lt;&lt;if _isBoss &gt;&gt;
					&lt;&lt;set $feeder_stunWeaknessBonus = $feeder_feedBossHunterStunWeaknessBonus&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $feeder_stunWeaknessBonus = $feeder_feedHunterStunWeaknessBonus&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;case &quot;eater&quot;&gt;&gt;
				&lt;&lt;if _isBoss &gt;&gt;
					&lt;&lt;set $feeder_stunWeaknessBonus = $feeder_feedBossEaterStunWeaknessBonus&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $feeder_stunWeaknessBonus = $feeder_feedEaterStunWeaknessBonus&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;default&gt;&gt; /*default or resister*/
				&lt;&lt;if _isBoss &gt;&gt;
					&lt;&lt;set $feeder_stunWeaknessBonus = $feeder_feedBossResisterStunWeaknessBonus&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $feeder_stunWeaknessBonus = $feeder_feedResisterStunWeaknessBonus&gt;&gt;
				&lt;&lt;/if&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;

/*Makes a check to see if the enemy should be stunned*/
/*It&#39;s left to the creature&#39;s AI to handle the stunning, in case they want to do something special instead of being stunned*/
/*Note: When applying stun, should first check if already stunned. These feeds probably should stack stuns!*/
&lt;&lt;widget &quot;feeder_tryStunFeedee&quot;&gt;&gt;
		/* Process arguments */
		&lt;&lt;set _archetype = &quot;resister&quot;&gt;&gt;
    &lt;&lt;set _isBoss = false&gt;&gt;
    &lt;&lt;if $args.length  &gt; 0&gt;&gt;&lt;&lt;set _archetype = $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
    &lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _isBoss = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
    
		/* Calculate any bonuses the check might get if the enemy has a weakness for the food&#39;s flavors */
		&lt;&lt;feeder_getFoodStunWeaknessBonus _archetype _isBoss&gt;&gt;
		
		/* Add any bonuses from the addiction status */
		&lt;&lt;if $e.addicted == true&gt;&gt;
			&lt;&lt;if _isBoss == true&gt;&gt;
				&lt;&lt;set $feeder_stunWeaknessBonus += $feeder_feedBossAddictiveStunBonus&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;set $feeder_stunWeaknessBonus += $feeder_feedEnemyAddictiveStunBonus&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			/* At this point, attempt to remove the status */
			/* Because of how things are set up, with this function not running if the enemy is already stunned by other means, it means that technically the addicted status can persist for multiple feedings without a check if the enemy is stunned by other means. I&#39;m not too fussed about that - consider it a special tech for the players ;P*/
			
			/* Check if should persist */
			&lt;&lt;if setup.skillTest($feeder_addictedStatusPersists, 0) == false&gt;&gt; /* shouldn&#39;t persist */
				&lt;&lt;set $e.addicted = false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Do check */
    &lt;&lt;set $feeder_feedStunCheck = false&gt;&gt;

    &lt;&lt;switch _archetype&gt;&gt;
			&lt;&lt;case &quot;hunter&quot;&gt;&gt;
				&lt;&lt;if _isBoss&gt;&gt;
					&lt;&lt;if setup.skillTestRange($feeder_feedBossHunterStunChance + $feeder_stunWeaknessBonus, 0, $feeder_feedBossStunChanceMin, $feeder_feedBossStunChanceMax)&gt;&gt; &lt;&lt;set $feeder_feedStunCheck = true&gt;&gt; &lt;&lt;/if&gt;&gt;
			 &lt;&lt;else&gt;&gt;
					&lt;&lt;if setup.skillTestRange($feeder_feedHunterStunChance + $feeder_stunWeaknessBonus, 0, $feeder_feedStunChanceMin, $feeder_feedStunChanceMax)&gt;&gt; &lt;&lt;set $feeder_feedStunCheck = true&gt;&gt; &lt;&lt;/if&gt;&gt;
			 &lt;&lt;/if&gt;&gt;
			&lt;&lt;case &quot;eater&quot;&gt;&gt;
				&lt;&lt;if _isBoss&gt;&gt;
					&lt;&lt;if setup.skillTestRange($feeder_feedBossEaterStunChance +$feeder_stunWeaknessBonus, 0, $feeder_feedBossStunChanceMin, $feeder_feedBossStunChanceMax)&gt;&gt; &lt;&lt;set $feeder_feedStunCheck = true&gt;&gt; &lt;&lt;/if&gt;&gt;
			 &lt;&lt;else&gt;&gt;
					&lt;&lt;if setup.skillTestRange($feeder_feedEaterStunChance + $feeder_stunWeaknessBonus, 0, $feeder_feedStunChanceMin, $feeder_feedStunChanceMax)&gt;&gt; &lt;&lt;set $feeder_feedStunCheck = true&gt;&gt; &lt;&lt;/if&gt;&gt;
			 &lt;&lt;/if&gt;&gt;
			&lt;&lt;default&gt;&gt; /*default or resister*/
				&lt;&lt;if _isBoss&gt;&gt;
					&lt;&lt;if setup.skillTestRange($feeder_feedBossResisterStunChance + $feeder_stunWeaknessBonus, 0, $feeder_feedBossStunChanceMin, $feeder_feedBossStunChanceMax)&gt;&gt; &lt;&lt;set $feeder_feedStunCheck = true&gt;&gt; &lt;&lt;/if&gt;&gt;
			 &lt;&lt;else&gt;&gt;
					&lt;&lt;if setup.skillTestRange($feeder_feedResisterStunChance + $feeder_stunWeaknessBonus, 0, $feeder_feedStunChanceMin, $feeder_feedStunChanceMax)&gt;&gt; &lt;&lt;set $feeder_feedStunCheck = true&gt;&gt; &lt;&lt;/if&gt;&gt;
			 &lt;&lt;/if&gt;&gt;
    &lt;&lt;/switch&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* VENDORS */
&lt;&lt;widget &quot;feeder_vendor&quot;&gt;&gt;
	&lt;&lt;set $vendor.b = -1&gt;&gt;
	&lt;&lt;set $vendor.a = -1&gt;&gt;
	&lt;&lt;set $vendor.selling = false&gt;&gt;

	&lt;&lt;switch $args[0]&gt;&gt;
		/*===============================================*/
		&lt;&lt;case &quot;restaurant&quot;&gt;&gt;

		&lt;&lt;set $vendorInventory = [$feeder_mealMeat, $feeder_mealVeg, $feeder_mealDessert]&gt;&gt;

		&lt;&lt;set $vendorThanks = &quot;\&quot;Enjoy.\&quot;&quot;&gt;&gt;

		&lt;&lt;set $vendorLocation = &quot;To Go Counter&quot;&gt;&gt;

		/*===============================================*/
		&lt;&lt;case &quot;Creatorium&quot;&gt;&gt;

		&lt;&lt;set $vendorDescription = &quot;You walk into the creatorium. &quot;&gt;&gt;

		&lt;&lt;set $vendorInventory = [&quot;feeder_conjureMeatMeal&quot;, &quot;feeder_conjureVegMeal&quot;, &quot;feeder_conjureDessertMeal&quot;]&gt;&gt;

		&lt;&lt;set $vendorThanks = &quot;//sigh//&quot;&gt;&gt;

		&lt;&lt;set $vendorLocation = &quot;Learn spells from Creatorium&quot;&gt;&gt;

		/*===============================================*/

	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====
/* CRAFTING */

&lt;&lt;widget &quot;feeder_ensureProvisionsInit&quot;&gt;&gt;
	&lt;&lt;if $feeder_storedProvisions == null&gt;&gt;
		&lt;&lt;set $feeder_storedProvisions = {
			meat: 0,
			veg: 0,
			dessert: 0,
			other: 0,
		}&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_addProvisions&quot;&gt;&gt;
	&lt;&lt;set _provisionType = $args[0]&gt;&gt;
	&lt;&lt;set _amount = 1&gt;&gt;
	&lt;&lt;if $args[1] != null&gt;&gt;
		&lt;&lt;set _amount = $args[1]&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;feeder_ensureProvisionsInit&gt;&gt;
	&lt;&lt;if $feeder_storedProvisions[_provisionType] + _amount &lt; 0&gt;&gt;
		&lt;&lt;set $feeder_storedProvisions[_provisionType] = 0&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $feeder_storedProvisions[_provisionType] += _amount&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* Gain provisions from given item without destroying it */
&lt;&lt;widget &quot;feeder_extractProvisions&quot;&gt;&gt;
	&lt;&lt;set _itemToExtract = $args[0]&gt;&gt;
	&lt;&lt;set _extractMultiplier = 1&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _extractMultiplier = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;feeder_ensureProvisionsInit&gt;&gt;
	
	&lt;&lt;if _itemToExtract.provisions != null&gt;&gt;
		&lt;&lt;if _itemToExtract.provisions.meat != null&gt;&gt;
			&lt;&lt;feeder_addProvisions &quot;meat&quot; _itemToExtract.provisions.meat*_extractMultiplier&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _itemToExtract.provisions.veg != null&gt;&gt;
			&lt;&lt;feeder_addProvisions &quot;veg&quot; _itemToExtract.provisions.veg*_extractMultiplier&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _itemToExtract.provisions.dessert != null&gt;&gt;
			&lt;&lt;feeder_addProvisions &quot;dessert&quot; _itemToExtract.provisions.dessert*_extractMultiplier&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _itemToExtract.provisions.other != null&gt;&gt;
			&lt;&lt;feeder_addProvisions &quot;other&quot; _itemToExtract.provisions.other*_extractMultiplier&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* Deletes a quantity of items, turning it into the appropriate amount of points */
&lt;&lt;widget &quot;feeder_turnIntoProvisions&quot;&gt;&gt;
	&lt;&lt;set _itemToTurn = $args[0]&gt;&gt;
	&lt;&lt;set _amountToTurn = 1&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _amountToTurn = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _amountToTurn == &quot;all&quot;&gt;&gt;
		&lt;&lt;feeder_extractProvisions _itemToTurn _itemToTurn.stack&gt;&gt;
		&lt;&lt;removeItem _itemToTurn &quot;all&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;feeder_extractProvisions _itemToTurn _amountToTurn&gt;&gt;
		&lt;&lt;removeItem _itemToTurn _amountToTurn&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_turnWholeInventoryIntoProvisions&quot;&gt;&gt;
	/* Loop and store the relevant items first, since we don&#39;t want to be modifying the inventory at the same time we&#39;re looping through it! */
	&lt;&lt;set _itemsToConvert = []&gt;&gt;
	
	/*&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;*/
	&lt;&lt;for _itemIndexToConvertA, _unusued range $inventory&gt;&gt;
		&lt;&lt;if $inventory[_itemIndexToConvertA].provisions != null&gt;&gt;
			&lt;&lt;set _itemsToConvert.push($inventory[_itemIndexToConvertA])&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	
	/* Now loop through and convert the items into provision points */
	/*&lt;&lt;for _i = 0; _i &lt; _itemsToConvert.length; _i++&gt;&gt;*/
	&lt;&lt;for _itemIndexToConvertB, _unusued range _itemsToConvert&gt;&gt;
		&lt;&lt;feeder_turnIntoProvisions _itemsToConvert[_itemIndexToConvertB] &quot;all&quot;&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_getProvisionCount&quot;&gt;&gt;
	&lt;&lt;set _total = 0&gt;&gt;
	
	&lt;&lt;feeder_ensureProvisionsInit&gt;&gt;
	
	&lt;&lt;switch $args[0]&gt;&gt;
		&lt;&lt;case &quot;meat&quot;&gt;&gt;
			&lt;&lt;set _total = $feeder_storedProvisions.meat&gt;&gt;
		&lt;&lt;case &quot;veg&quot;&gt;&gt;
			&lt;&lt;set _total = $feeder_storedProvisions.veg&gt;&gt;
		&lt;&lt;case &quot;dessert&quot;&gt;&gt;
			&lt;&lt;set _total = $feeder_storedProvisions.dessert&gt;&gt;
		&lt;&lt;case &quot;other&quot;&gt;&gt;
			&lt;&lt;set _total = $feeder_storedProvisions.other&gt;&gt;
		&lt;&lt;default&gt;&gt; /* all */
			&lt;&lt;set _total = $feeder_storedProvisions.meat+$feeder_storedProvisions.veg+$feeder_storedProvisions.dessert+$feeder_storedProvisions.other&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	&lt;&lt;set $feeder_provisionCount = _total&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_larderProvisionsOptions&quot;&gt;&gt;
	&lt;&lt;set _hasAny = false&gt;&gt;
	
	/*&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;*/
	&lt;&lt;for _invItemIndex, _invItem range $inventory&gt;&gt;
		/* Only care about items that can actually turn into provisions! */
		&lt;&lt;if $inventory[_invItemIndex].provisions != null&gt;&gt;
			&lt;&lt;set _hasAny = true&gt;&gt;
			
			&lt;&lt;capture _invItemIndex&gt;&gt;
				&lt;&lt;if $inventory[_invItemIndex].icon != null&gt;&gt;
					&lt;&lt;icon $inventory[_invItemIndex].icon&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;icon &quot;inventory&quot;&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				
				&lt;&lt;set _title = $inventory[_invItemIndex].Name&gt;&gt;
				
				&lt;&lt;if $inventory[_invItemIndex].stack &gt; 0&gt;&gt;
					&lt;&lt;set _title +=&quot; x&quot;+$inventory[_invItemIndex].stack&gt;&gt;
				&lt;&lt;/if&gt;&gt;

				&lt;&lt;link _title &quot;Check Larder&quot;&gt;&gt;
					&lt;&lt;feeder_turnIntoProvisions $inventory[_invItemIndex]&gt;&gt;
				&lt;&lt;/link&gt;&gt;
				
				/* Give info on what it&#39;ll turn into! */
				&lt;&lt;set _provisionAmounts = &quot; Yields: &quot;&gt;&gt;
				
				&lt;&lt;if $inventory[_invItemIndex].provisions.meat != null&gt;&gt;
					&lt;&lt;set _provisionAmounts += $inventory[_invItemIndex].provisions.meat + &quot; Meat &quot;&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;if $inventory[_invItemIndex].provisions.veg != null&gt;&gt;
					&lt;&lt;set _provisionAmounts += $inventory[_invItemIndex].provisions.veg + &quot; Fruit/Veg &quot;&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;if $inventory[_invItemIndex].provisions.dessert != null&gt;&gt;
					&lt;&lt;set _provisionAmounts += $inventory[_invItemIndex].provisions.dessert + &quot; Dessert &quot;&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				&lt;&lt;if $inventory[_invItemIndex].provisions.other != null&gt;&gt;
					&lt;&lt;set _provisionAmounts += $inventory[_invItemIndex].provisions.other + &quot; Misc. &quot;&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				
				_provisionAmounts
				
				&lt;br&gt;
			&lt;&lt;/capture&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	
	&lt;&lt;if _hasAny == true&gt;&gt;
		&lt;br&gt;
		&lt;&lt;link &quot;Turn all your items into ingredients&quot; &quot;Check Larder&quot;&gt;&gt;
			&lt;&lt;feeder_turnWholeInventoryIntoProvisions&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;&lt;else&gt;&gt;
		//It looks like you&#39;ve got nothing on you worth storing...//
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_hasUnlockedRecipe&quot;&gt;&gt;
	&lt;&lt;set _recipe to $args[0]&gt;&gt;
	
	&lt;&lt;set _hasUnlocked to true&gt;&gt;
	
	/* Check completed all required quests */
	&lt;&lt;if _recipe.quests != null&gt;&gt;
		&lt;&lt;for _questIndex, _questId range _recipe.quests&gt;&gt;
			&lt;&lt;set _quest = State.getVar(_recipe.quests[_questIndex])&gt;&gt;
			
			&lt;&lt;if setup.questCompleted(_quest) == false&gt;&gt;
				&lt;&lt;set _hasUnlocked = false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Check has all required key items */
	&lt;&lt;if _recipe.keyItems != null&gt;&gt;
		&lt;&lt;for _keyItemIndex, _keyItemId range _recipe.keyItems&gt;&gt;
			&lt;&lt;set _requiredKeyItem = State.getVar(_keyItemId)&gt;&gt;
			
			&lt;&lt;if setup.hasItem(_requiredKeyItem) == -1&gt;&gt;
				&lt;&lt;set _hasUnlocked = false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $feeder_hasUnlockedRecipe = _hasUnlocked&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_hasIngredientsForRecipe&quot;&gt;&gt;
	&lt;&lt;set _recipe to $args[0]&gt;&gt;
	
	&lt;&lt;feeder_ensureProvisionsInit&gt;&gt;
	
	&lt;&lt;set _hasIngredients to true&gt;&gt;
	
	/* Check has required ingredients in storage */
	&lt;&lt;if _recipe.provisions != null&gt;&gt;
		&lt;&lt;set _amountMissing = 0&gt;&gt; /* &quot;other&quot; provisions can be used as substitutes, so track what&#39;s missing! */
		
		&lt;&lt;for _provisionType, _amount range _recipe.provisions&gt;&gt;
			&lt;&lt;set _count = 0&gt;&gt;
			&lt;&lt;feeder_getProvisionCount _provisionType&gt;&gt;
			&lt;&lt;set _count = $feeder_provisionCount&gt;&gt;
			
			&lt;&lt;if _count &lt; _amount&gt;&gt; /* Player doesn&#39;t have sufficient stored ingredients */
				&lt;&lt;if _provisionType != &quot;other&quot;&gt;&gt;
					&lt;&lt;if _recipe.noSubstitutions != true&gt;&gt;
						&lt;&lt;set _amountMissing += _amount - _count &gt;&gt;
					&lt;&lt;else&gt;&gt;
						&lt;&lt;set _hasIngredients to false&gt;&gt;
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;else&gt;&gt; /* `other` ingredients obviously can&#39;t be substituted with `other` ingredients...*/
					&lt;&lt;set _hasIngredients to false&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
		
		/* Attempt to substitute missing ingredients with `other` ingredients */
		&lt;&lt;if _amountMissing &gt; 0 and _recipe.noSubstitutions != true&gt;&gt;
			&lt;&lt;set _otherCount = 0&gt;&gt;
			&lt;&lt;feeder_getProvisionCount &quot;other&quot;&gt;&gt;
			&lt;&lt;set _otherCount = $feeder_provisionCount&gt;&gt;
			
			&lt;&lt;if Math.trunc(_otherCount * $feeder_substituteOtherConversionRate) &lt; _amountMissing&gt;&gt;
				&lt;&lt;set _hasIngredients to false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Check has required items in their inventory */
	&lt;&lt;if _recipe.items != null&gt;&gt;
		&lt;&lt;for _itemId, _amount range _recipe.items&gt;&gt;
			&lt;&lt;set _requiredItem = State.getVar(_itemId)&gt;&gt;
			
			&lt;&lt;if setup.numOwned(_requiredItem) &lt; _amount&gt;&gt; /* Player doesn&#39;t have enough items */
				&lt;&lt;set _hasIngredients to false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $feeder_hasIngredientsForRecipe = _hasIngredients&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_consumeCraftingIngredients&quot;&gt;&gt;
	&lt;&lt;set _recipe = $args[0]&gt;&gt;
	
	&lt;&lt;feeder_ensureProvisionsInit&gt;&gt;
	
	/* Remove provisions */
	&lt;&lt;if _recipe.provisions != null&gt;&gt;
		&lt;&lt;set _substituted = 0&gt;&gt; /* Track how many ingredients should be substituted with `other`. No need to check for if the recipe doesn&#39;t allow substitutions, because we wouldn&#39;t have gotten to this stage otherwise! */
		
		&lt;&lt;for _provisionType, _amount range _recipe.provisions&gt;&gt;
			&lt;&lt;set _count = 0&gt;&gt;
			&lt;&lt;feeder_getProvisionCount _provisionType&gt;&gt;
			&lt;&lt;set _count = $feeder_provisionCount&gt;&gt;
			
			&lt;&lt;if _count &lt; _amount&gt;&gt; /* need to use substitutions */
				&lt;&lt;set _substituted += _amount-_count&gt;&gt;
				&lt;&lt;feeder_addProvisions _provisionType _count*-1&gt;&gt;
			&lt;&lt;else&gt;&gt; /* player has enough* /
				&lt;&lt;feeder_addProvisions _provisionType _amount*-1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
		
		/* Remove `other` amount used for substitution */
		&lt;&lt;if _substituted &gt; 0&gt;&gt;
			&lt;&lt;set _otherToConsume = Math.trunc(_substituted/$feeder_substituteOtherConversionRate)&gt;&gt;
			&lt;&lt;feeder_addProvisions &quot;other&quot; _otherToConsume*-1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Remove items */
	&lt;&lt;if _recipe.items != null&gt;&gt;
		&lt;&lt;for _itemId, _amount range _recipe.items&gt;&gt;
			&lt;&lt;set _item = State.getVar(_itemId)&gt;&gt;
			
			&lt;&lt;removeItem _item _amount&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_craftingWriteRequirements&quot;&gt;&gt;
	&lt;&lt;set _recipe = $args[0]&gt;&gt;
	
	&#39;&#39;Requires: &#39;&#39;
	&lt;&lt;if _recipe.provisions != null&gt;&gt;
		&lt;&lt;set _hasPrevious = false&gt;&gt; /* to tell if should lead with a space and comma */
		&lt;&lt;if _recipe.provisions.meat != null&gt;&gt;
			_recipe.provisions.meat meat
			&lt;&lt;set _hasPrevious = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if _recipe.provisions.veg != null&gt;&gt;
			/*&lt;&lt;if _hasPrevious&gt;&gt;, &lt;&lt;/if&gt;&gt;*/
			_recipe.provisions.veg veggie
			&lt;&lt;set _hasPrevious = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if _recipe.provisions.dessert != null&gt;&gt;
			/*&lt;&lt;if _hasPrevious&gt;&gt;, &lt;&lt;/if&gt;&gt;*/
			_recipe.provisions.dessert dessert
			&lt;&lt;set _hasPrevious = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if _recipe.provisions.other != null&gt;&gt;
			/*&lt;&lt;if _hasPrevious&gt;&gt;, &lt;&lt;/if&gt;&gt;*/
			_recipe.provisions.other other
			&lt;&lt;set _hasPrevious = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		 ingredients. 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _recipe.items != null&gt;&gt;
		&lt;&lt;set _hasPrevious = false&gt;&gt;
		&lt;&lt;for _itemId, _amount range _recipe.items&gt;&gt;
			&lt;&lt;set _item = State.getVar(_itemId)&gt;&gt;
			/*&lt;&lt;if _hasPrevious&gt;&gt;, &lt;&lt;/if&gt;&gt;*/
			
			_amount _item.Name
			&lt;&lt;set _hasPrevious = true&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_craftingMakeMenuOption&quot;&gt;&gt;
	&lt;&lt;set _recipe = $args[0]&gt;&gt;
	
	&lt;&lt;capture _recipe&gt;&gt; /* ??? I have no idea how captures work */
		&lt;&lt;set _name = &quot;name&quot;&gt;&gt;
		&lt;&lt;set _icon = &quot;restaurant&quot;&gt;&gt;
		&lt;&lt;set _item = null&gt;&gt;
		&lt;&lt;set _amount = 1&gt;&gt;
		
		&lt;&lt;if _recipe.itemId != null&gt;&gt;
			&lt;&lt;set _item = State.getVar(_recipe.itemId)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _recipe.name != null&gt;&gt;
			&lt;&lt;set _name = _recipe.name&gt;&gt;
		&lt;&lt;elseif _item != null&gt;&gt;
			&lt;&lt;set _name = _item.Name&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;if _recipe.icon != null&gt;&gt;
			&lt;&lt;set _icon = _recipe.icon&gt;&gt;
		&lt;&lt;elseif _item != null&gt;&gt;
			&lt;&lt;set _icon = _item.icon&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _recipe.amount != null&gt;&gt;
			&lt;&lt;set _amount = _recipe.amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Write out the option */
		&lt;&lt;icon _icon&gt;&gt;
		&lt;&lt;set _title = _name&gt;&gt;
		&lt;&lt;if _amount &gt; 1&gt;&gt;
			&lt;&lt;set _title += &quot; (x&quot;+_amount+&quot;)&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* won&#39;t bother checking if has required ingredients here */
		&lt;&lt;link _title &quot;Cooking up some grub!&quot;&gt;&gt;
			&lt;&lt;set $feeder_selectedRecipe = _recipe&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;feeder_craftingWriteRequirements _recipe&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;feeder_crafting&quot;&gt;&gt;
	/* Item info and crafting button */
	&lt;&lt;if $feeder_selectedRecipe != null&gt;&gt;
		&lt;&lt;set _selectedName = &quot;name&quot;&gt;&gt;
		&lt;&lt;set _selectedDescription = &quot;description&quot;&gt;&gt;
		&lt;&lt;set _selectedIcon = &quot;restaurant&quot;&gt;&gt;
		&lt;&lt;set _selectedItem = null&gt;&gt;
		&lt;&lt;set _selectedPassage = &quot;Cooking up some grub!&quot;&gt;&gt;
		&lt;&lt;set _selectedAmount = 1&gt;&gt;
		&lt;&lt;set _selectedTime = 15&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.itemId != null&gt;&gt;
			&lt;&lt;set _selectedItem = State.getVar($feeder_selectedRecipe.itemId)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.name != null&gt;&gt;
			&lt;&lt;set _selectedName = $feeder_selectedRecipe.name&gt;&gt;
		&lt;&lt;elseif _selectedItem != null&gt;&gt;
			&lt;&lt;set _selectedName = _selectedItem.Name&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.amount != null&gt;&gt;
			&lt;&lt;set _selectedAmount = $feeder_selectedRecipe.amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if _selectedAmount &gt; 1&gt;&gt;
			&lt;&lt;set _selectedName += &quot; (x&quot;+_selectedAmount+&quot;)&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.description != null&gt;&gt;
			&lt;&lt;set _selectedDescription = $feeder_selectedRecipe.description&gt;&gt;
		&lt;&lt;elseif _selectedItem != null&gt;&gt;
			&lt;&lt;set _selectedDescription = _selectedItem.description&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.icon != null&gt;&gt;
			&lt;&lt;set _selectedIcon = $feeder_selectedRecipe.icon&gt;&gt;
		&lt;&lt;elseif _selectedItem != null&gt;&gt;
			&lt;&lt;set _selectedIcon = _selectedItem.icon&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.passage != null&gt;&gt;
			&lt;&lt;set _selectedPassage = $feeder_selectedRecipe.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $feeder_selectedRecipe.time != null&gt;&gt;
			&lt;&lt;set _selectedTime = $feeder_selectedRecipe.time&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Display part */
		&lt;u&gt;
		&lt;&lt;icon _selectedIcon&gt;&gt;
		_selectedName
		&lt;/u&gt;
		&lt;br&gt;
		_selectedDescription
		&lt;br&gt;
		&lt;&lt;feeder_craftingWriteRequirements $feeder_selectedRecipe&gt;&gt;
		&lt;br&gt;
		
		&lt;&lt;feeder_hasIngredientsForRecipe $feeder_selectedRecipe&gt;&gt;
		&lt;&lt;if $feeder_hasIngredientsForRecipe == true&gt;&gt;
			&lt;&lt;link &quot;Make it?&quot; _selectedPassage&gt;&gt;
				&lt;&lt;feeder_consumeCraftingIngredients $feeder_selectedRecipe&gt;&gt;
				
				&lt;&lt;if _selectedTime &gt; 0&gt;&gt;
					&lt;&lt;doTime _selectedTime&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				
				&lt;&lt;if _selectedItem != null&gt;&gt;
					&lt;&lt;getItem _selectedItem _selectedAmount&gt;&gt;
				&lt;&lt;/if&gt;&gt;
				
				/* Do any other special stuff here */
			&lt;&lt;/link&gt;&gt;
		&lt;&lt;else&gt;&gt;
			//You don&#39;t have the required items or ingredients//
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		//Choose a recipe to cook from your list of known recipes below.//
	&lt;&lt;/if&gt;&gt;
	
	&lt;hr&gt;
	
	/* Recipe selection list */
	&lt;&lt;set _hasAnyRecipe = false&gt;&gt;
	
	/* Special crafting options */
	&lt;&lt;set $eventCounterA = 0&gt;&gt; /* Required for passage-based options */
	
	&lt;&lt;if setup.hasItem($feeder_ultimateRecipe) &gt; -1 and $feeder_ultimateMonsterAlive != true&gt;&gt;
		&lt;&lt;set _hasAnyRecipe = true&gt;&gt;
		&lt;&lt;feeder_craftingMakeMenuOption $feeder_craftUltimateRecipe&gt;&gt;
		&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if setup.questCompleted($feeder_questUltimateCreation) and $feeder_ultimateMonsterAlive != true&gt;&gt;
		&lt;&lt;set _hasAnyRecipe = true&gt;&gt;
		&lt;&lt;feeder_craftingMakeMenuOption $feeder_craftFoodBoss&gt;&gt;
		&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Standard crafting options */
	&lt;&lt;for _craftIndex, _craftOption range $feeder_craftOptions&gt;&gt; /* OH MY GOD ALL MY PROBLEMS WAS BECAUSE I WAS USING _i AS A VARIABLE IN MULTIPLE PLACES. WHY ARE LOCAL VARIABLES SHARED BETWEEN FUNCTIONS Q_Q */
		&lt;&lt;capture _craftIndex&gt;&gt;
			&lt;&lt;feeder_hasUnlockedRecipe $feeder_craftOptions[_craftIndex]&gt;&gt;
			&lt;&lt;set _hasUnlockedRecipe = $feeder_hasUnlockedRecipe&gt;&gt;
			
			&lt;&lt;capture _hasUnlockedRecipe&gt;&gt;
				&lt;&lt;if _hasUnlockedRecipe&gt;&gt;
					&lt;&lt;set _hasAnyRecipe = true&gt;&gt;
					&lt;&lt;feeder_craftingMakeMenuOption $feeder_craftOptions[_craftIndex]&gt;&gt;
					&lt;br&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/capture&gt;&gt;
		&lt;&lt;/capture&gt;&gt;
	&lt;&lt;/for&gt;&gt;

	&lt;&lt;if _hasAnyRecipe == false&gt;&gt;
		//Looks like you don&#39;t know how to make anything.//
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====
/* MISC / UNSORTED */

&lt;&lt;widget &quot;feeder_meetsSpellRequirements&quot;&gt;&gt;
	&lt;&lt;set _spell = $args[0]&gt;&gt;
	
	&lt;&lt;set _meetsRequirements = true&gt;&gt;
	
	&lt;&lt;if _spell.int &gt; $int&gt;&gt;
		&lt;&lt;set _meetsRequirements = false&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _spell.requiresQuests != null&gt;&gt;
		&lt;&lt;for _questId range _spell.requiresQuests&gt;&gt;
			&lt;&lt;set _quest = State.getVar(_questId)&gt;&gt;
			
			&lt;&lt;if setup.questCompleted(_quest) == false&gt;&gt;
				&lt;&lt;set _meetsRequirements = false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _spell.requiresSpells != null&gt;&gt;
		&lt;&lt;for _requiredSpellId range _spell.requiresSpells&gt;&gt;
			&lt;&lt;if setup.knowsSpell(setup.getSpell(_requiredSpellId)) == false&gt;&gt; /* Doesn&#39;t have */
				&lt;&lt;set _meetsRequirements = false&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $feeder_meetsSpellRequirements = _meetsRequirements&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="118" name="fixes and edits patch and update" tags="fixes-and-edits" position="6500,1200" size="100,100">/* Most of the fixes and edits are manually edited into the existing game passages rather than being their own passages, so you won&#39;t see many of them. */
/* (This file is also a mess of specifically versioned patches, unversioned patches with specific checks, and always-run patches... I suck at planning and organising) */

&lt;&lt;set _PATCHVERSION = 2&gt;&gt;
&lt;&lt;if $fixesAndEditsVersion == null&gt;&gt;
	&lt;&lt;set $fixesAndEditsVersion = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* == Unversioned Patches With Checks == */
/* Set up the combat stamina option. */
&lt;&lt;if $options.combatStamina == null&gt;&gt;
	&lt;&lt;set $options.combatStamina = 2&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Set up the devour showing option. */
&lt;&lt;if $options.devourShowMode == null&gt;&gt;
	&lt;&lt;set $options.devourShowMode = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Set up the fixed NPC genderswapping option */
&lt;&lt;if $options.fixedNPCGenders == null&gt;&gt;
	&lt;&lt;set $options.fixedNPCGenders = &quot;default&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Add placeholder species adjectives if missing on the player */
&lt;&lt;if $p.adjective == false&gt;&gt;
	&lt;&lt;set $p.adjective = &quot;animalistic&quot;&gt;&gt;
    &lt;&lt;set $p.Adjective = &quot;Animalistic&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Ensure a core species passage is being used, defaulting to vanialla */
&lt;&lt;if $coreSpeciesPassage == null&gt;&gt;
	&lt;&lt;set $coreSpeciesPassage = &quot;Core Species - Vanilla Patch&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* EARLY ALWAYS PATCHERS */
&lt;&lt;include &quot;spell objects&quot;&gt;&gt;

/* == Actually Properly Versioned Patches == */
&lt;&lt;if $fixesAndEditsVersion &lt; _PATCHVERSION&gt;&gt;
	&lt;&lt;set setup.modUpdated = true&gt;&gt; /* Flag that an update has happened */
	&lt;&lt;set setup.modUpdatedList.push(&quot;Fixes and Edits&quot;)&gt;&gt; /* Add to list of updated mods */
    
    &lt;&lt;if $fixesAndEditsVersion &lt; 1&gt;&gt;
    	&lt;&lt;include &quot;quest objects&quot;&gt;&gt; /* Quests descriptions have been updated to be more generic to account for the possibility of NPC&#39;s name, species, and gender changes */
        &lt;&lt;set $fixesAndEditsVersion = 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if $fixesAndEditsVersion &lt; 2&gt;&gt;
    	/* Milk Jug price was wrong, so have to fix the value in both save and player&#39;s inventory */
        &lt;&lt;set $milkJug.value = 2&gt;&gt;
        &lt;script&gt;
        	for (let currentItem of variables().inventory) {
            	if ( currentItem.name == variables().milkJug.name ) {
                	currentItem.value = variables().milkJug.value;
                }
            }
        &lt;/script&gt;
        
        /* Update old spellbook to new format - for core spells, at least (mods will have to do their own thing!) */
        &lt;&lt;run
        	let coreSpells = [];
            for ( const [id, spell] of Object.entries(setup.spells) ) {
				if ( spell.core ) {
                	coreSpells.push(id);
                }
			}
            
            setup.patchOldSpellbook(coreSpells);
        &gt;&gt;
        
        /* Introduce the new height variables + update to format */
        &lt;&lt;set $bheight = $p.height&gt;&gt; /* Port previous base height to new system (now $p.height is used for their modified height */
        &lt;&lt;set $theight = 0&gt;&gt;
        &lt;&lt;set $status.height = 0&gt;&gt;
        &lt;&lt;set $status.heightTime = 0&gt;&gt;

        &lt;&lt;set $fixesAndEditsVersion = 2&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* ALWAYS PATCHERS */
&lt;&lt;include &quot;species variables&quot;&gt;&gt;
&lt;&lt;include $coreSpeciesPassage&gt;&gt; /* Immediately apply core species patch */
&lt;&lt;run setup.populateCoreGlobalSpecies()&gt;&gt;

&lt;&lt;include &quot;enemy stats&quot;&gt;&gt;
&lt;&lt;include &quot;npc variables&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="119" name="fixes and edits widgets" tags="widget fixes-and-edits" position="6400,1300" size="200,100">/* FIXES AND EDITS - Restructure Species - START */

/* Creates the list dropdown for the player to select their species from. All non-hidden species from any loaded mods are presented here, in alphabetical order */
/* Used in both player creation, and the cabal species changing */
&lt;&lt;widget &quot;printSpeciesOptions&quot;&gt;&gt;
	&lt;&lt;set _text&gt;&gt;
	&lt;&lt;set _variableCode = $args[0]&gt;&gt;

	&lt;&lt;script&gt;&gt;
		let _text = &quot;&quot;;
		
		_text += `&lt;&lt;listbox &quot;${State.temporary.variableCode}&quot;&gt;&gt;`;
		
		let _playableSpecies = setup.getSortedPlayableSpecies();
		
		for (const _species of _playableSpecies){
			_text += `&lt;&lt;option &quot;${_species.species.toUpperFirst()}&quot; $speciesList[&quot;${_species.id}&quot;]&gt;&gt;`
		}
		
		_text += `&lt;&lt;/listbox&gt;&gt;`;
		
		State.temporary.text = _text;
	&lt;&lt;/script&gt;&gt;

	&lt;&lt;print _text&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

/* FIXES AND EDITS - Restructure Species - END */




/* FIXES AND EDITS - Restructure Fixed NPC Data - START */

/* Like createNPC, but takes an NPC object / ID for an NPC object (defined in the `npc variables` passage). For use assembling Fixed NPCs */
&lt;&lt;widget &quot;createFixedNPC&quot;&gt;&gt;
	&lt;&lt;set _npcData = $args[0]&gt;&gt;
	&lt;&lt;set _slot = 1&gt;&gt;
	
	&lt;&lt;if $args[1] != null&gt;&gt;
		&lt;&lt;set _slot = $args[1]&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _npc = setup.createFixedNPC(_npcData)&gt;&gt;
	
	&lt;&lt;run setup.setNPCToSlot(_npc, _slot);&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* Run this after setting up a fight with a Fixed NPC to correct + update the enemy / NPC info that was loaded */
&lt;&lt;widget &quot;updateEnemyWithNPC&quot;&gt;&gt;
	&lt;&lt;set _npcData = $args[0]&gt;&gt;
	
	&lt;&lt;set _npc = setup.createFixedNPC(_npcData)&gt;&gt;
	
	/* Update the relevant Enemy data that needs changing */
	&lt;&lt;set $e.name = _npc.name&gt;&gt;
	&lt;&lt;set $e.Name = _npc.Name&gt;&gt;
	
	&lt;&lt;set $e.gender = _npc.gender&gt;&gt;
	
	&lt;&lt;set $e.species = _npc.speciesObject&gt;&gt;
	
	/* Replace the NPC entry that was made by `setEnemy` */
	&lt;&lt;run setup.setNPCToSlot(_npc, 1);&gt;&gt;
&lt;&lt;/widget&gt;&gt;


/* FIXES AND EDITS - Restructure Fixed NPC Data - END */


/* FIXES AND EDITS - Allow custom titles - START */
/* Run inside the passage whose name you want to change after the fact. If you don&#39;t use this, it&#39;ll default to the standard (enemy info in combat, or raw passage name) */
&lt;&lt;widget &quot;setPassageTitle&quot;&gt;&gt;
	&lt;&lt;set $passageTitle = $(document.createElement(&quot;div&quot;)).wiki($args[0])[0].innerHTML&gt;&gt;
	
	/* We&#39;ll also manually change it now, even though it shouldn&#39;t do anything */
	&lt;&lt;if $(&#39;#passageTitle&#39;).length &gt; 0&gt;&gt; /* Check the element exists currently, which it won&#39;t when launching */
		&lt;&lt;replace &quot;#passageTitle&quot;&gt;&gt;$passageTitle&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* Run inside a popup whose name you want to change after the fact */
&lt;&lt;widget &quot;setPopupTitle&quot;&gt;&gt;
    /* This convoluted nightmare is what&#39;s required to do a simple task like capturing the current state of naked variables... */
    &lt;&lt;set _popupTitle = $(document.createElement(&quot;div&quot;)).wiki($args[0])[0].innerHTML&gt;&gt;
	
	&lt;&lt;run Dialog.setup(_popupTitle);&gt;&gt;
&lt;&lt;/widget&gt;&gt;
/* FIXES AND EDITS - Allow custom titles - END */


/* FIXES AND EDITS - Remake and fix species editor - START */

&lt;&lt;widget &quot;applyPlayerSpecies&quot;&gt;&gt;
	&lt;&lt;set _species = $args[0]&gt;&gt;
	&lt;&lt;set _isCharGen = false&gt;&gt;
	&lt;&lt;if $args[1]&gt;&gt;
		&lt;&lt;set _isCharGen = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* Check for possibly missing info in the species */
	&lt;&lt;if _species.mname == null&gt;&gt;
		&lt;&lt;set _mname = _species.species&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _mname = _species.mname&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _species.fname == null&gt;&gt;
		&lt;&lt;set _fname = _species.species&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _fname = _species.fname&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _species.adjective == null&gt;&gt;
		&lt;&lt;set _adjective = &quot;animalistic&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _adjective = _species.adjective&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _species.plural == null&gt;&gt;
		&lt;&lt;set _plural = _species.species + &quot;s&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _plural = _species.plural&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $p.male == &quot;male&quot;&gt;&gt;&lt;&lt;set $p.species = _mname&gt;&gt;
	&lt;&lt;elseif $p.male == &quot;female&quot;&gt;&gt;&lt;&lt;set $p.species = _fname&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set $p.species = _species.species&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $p.Species = $p.species.toUpperFirst()&gt;&gt;
	
	/* don&#39;t think these two will ever be used anywhere, but may as well record them */
	&lt;&lt;set $p.mname = _mname.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.fname = _fname.toLowerCase()&gt;&gt;
	
	&lt;&lt;set $p.article = _species.article.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.angry = _species.angry.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.feet = _species.feet.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.foot = _species.foot.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.hands = _species.hands.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.hand = _species.hand.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.fur = _species.fur.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.furred = _species.furred.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.furry = _species.furry.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.furBack = _species.furBack.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.furBelly = _species.furBelly.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.furHead = _species.furHead.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.hair = _species.hair.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.teeth = _species.teeth.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.mouth = _species.mouth.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.tail = _species.tail.toLowerCase()&gt;&gt;
	
	&lt;&lt;set $p.adjective = _adjective.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.Adjective = _adjective.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.plural = _plural.toLowerCase()&gt;&gt;
	&lt;&lt;set $p.Plural = _plural.toUpperFirst()&gt;&gt;
	
	&lt;&lt;set $p.Article = _species.article.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Angry = _species.angry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Feet = _species.feet.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Foot = _species.foot.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Hands = _species.hands.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Hand = _species.hand.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Fur = _species.fur.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Furred = _species.furred.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Furry = _species.furry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.FurBack = _species.furBack.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.FurBelly = _species.furBelly.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.FurHead = _species.furHead.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Hair = _species.hair.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Teeth = _species.teeth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Mouth = _species.mouth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $p.Tail = _species.tail.toUpperFirst()&gt;&gt;
	
	/* STAT RELATED */
	&lt;&lt;set $p.bheight = _species.speciesHeight&gt;&gt;
	&lt;&lt;set $p.speciesStats = clone(_species.speciesStats)&gt;&gt;
	
	&lt;&lt;if _isCharGen&gt;&gt; /* Character creation exclusive setup */
		&lt;&lt;set $p.height = _species.speciesHeight&gt;&gt;
		&lt;&lt;set $bheight = _species.speciesHeight&gt;&gt; /* height changes */
		
		/* Since there&#39;s no way to use `changeStats` silently, we&#39;ll do it ourselves instead */
		&lt;&lt;set _baseStat = setup.tuning(&quot;baseStatMain&quot;)&gt;&gt;
		&lt;&lt;set _baseStomach = setup.tuning(&quot;baseStatStomach&quot;)&gt;&gt;
		
		&lt;&lt;set $bstr = _baseStat + _species.speciesStats[0]&gt;&gt;
		&lt;&lt;set $bagi = _baseStat + _species.speciesStats[1]&gt;&gt;
		&lt;&lt;set $bend = _baseStat + _species.speciesStats[2]&gt;&gt;
		&lt;&lt;set $bint = _baseStat + _species.speciesStats[3]&gt;&gt;
		&lt;&lt;set $bsto = _baseStomach + _species.speciesStats[4]&gt;&gt;
		&lt;&lt;set $fat = setup.tuning(&quot;startingFat&quot;) + _species.speciesStats[5]&gt;&gt;
		
		&lt;&lt;updateStats&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* FIXES AND EDITS - Remake and fix species editor - END */


/* FIXES AND EDITS - Custom function to print spell options - START */
&lt;&lt;widget &quot;printSpellbookOption&quot;&gt;&gt;
	/* I don&#39;t know if captures are necessary or not :S */
	&lt;&lt;set _spell = $args[0]&gt;&gt;
	&lt;&lt;set _isCombat = $args[1]&gt;&gt;
	
	&lt;&lt;set _available = setup.spellIsAvailable(_spell)&gt;&gt;
	
	&lt;&lt;capture _spell, _available, _isCombat&gt;&gt;
	
	&lt;&lt;set _icon = _spell.icon&gt;&gt;
	&lt;&lt;set _title = _spell.Name+&quot; | &quot;+setup.getSpellCosts(_spell).join(&quot;, &quot;)&gt;&gt;
	
	&lt;&lt;if setup.canCastSpell(_spell) == false&gt;&gt;
		&lt;li&gt;&lt;u&gt;&lt;&lt;icon _icon&gt;&gt;_title ~~(Not enough &lt;&lt;=setup.spellCastFailReasons(_spell).join(&quot;, &quot;)&gt;&gt;)~~&lt;/u&gt;&lt;/li&gt;
	&lt;&lt;elseif _available.result == false&gt;&gt;
		&lt;li&gt;&lt;u&gt;&lt;&lt;icon _icon&gt;&gt;_title ~~(&lt;&lt;=_available.reason.toUpperFirst()&gt;&gt;)~~&lt;/u&gt;&lt;/li&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if _isCombat&gt;&gt;
			&lt;li&gt;&lt;u&gt;&lt;&lt;icon _icon&gt;&gt;&lt;&lt;link _title &quot;Combat&quot;&gt;&gt;
				&lt;&lt;set $action = &quot;Cast&quot;&gt;&gt;
				&lt;&lt;set $spellCast = _spell&gt;&gt;
				&lt;&lt;run Dialog.close();&gt;&gt;
	  	&lt;&lt;/link&gt;&gt;&lt;/u&gt;&lt;&lt;if _spell.configurable&gt;&gt; (&lt;&lt;link &quot;Alter Cast&quot;&gt;&gt;
	&lt;&lt;set $spellConfig = {spell: _spell.id, init: false}&gt;&gt;
	&lt;&lt;run
		Dialog.setup(&quot;Alter Cast - &quot;+_spell.Name);
		Dialog.wiki(Story.get(&quot;Custom Spell Configurations&quot;).processText());
		Dialog.open();
	&gt;&gt;
&lt;&lt;/link&gt;&gt;)&lt;&lt;/if&gt;&gt;&lt;/li&gt;
		&lt;&lt;else&gt;&gt;
			&lt;li&gt;&lt;u&gt;&lt;&lt;icon _icon&gt;&gt;&lt;&lt;link _title&gt;&gt;
				&lt;&lt;set $spellCast = _spell&gt;&gt;
				&lt;&lt;script&gt;&gt;
					Dialog.setup(&quot;cast spell&quot;);
					Dialog.wiki(Story.get(&quot;cast spell&quot;).processText());
					Dialog.open();
				&lt;&lt;/script&gt;&gt;
			&lt;&lt;/link&gt;&gt;&lt;/u&gt;&lt;&lt;if _spell.configurable&gt;&gt; (&lt;&lt;link &quot;Alter Cast&quot;&gt;&gt;
	&lt;&lt;set $spellConfig = {spell: _spell.id, init: false}&gt;&gt;
	&lt;&lt;run
		Dialog.setup(&quot;Alter Cast - &quot;+_spell.Name);
		Dialog.wiki(Story.get(&quot;Custom Spell Configurations&quot;).processText());
		Dialog.open();
	&gt;&gt;
&lt;&lt;/link&gt;&gt;)&lt;&lt;/if&gt;&gt;&lt;/li&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	_spell.description
	&lt;br&gt;
	
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* FIXES AND EDITS - Custom function to print spell options - END */


/* FIXES AND EDITS - Combat adjustments - START */
&lt;&lt;widget &quot;reportEffectiveness&quot;&gt;&gt;
	&lt;&lt;set _damageType = $args[0]&gt;&gt;
	&lt;&lt;set _target = $args[1]&gt;&gt;
	
	/* Get the actual target */
	&lt;&lt;if _target == &quot;enemy&quot; or _target == null&gt;&gt;
		&lt;&lt;set _target = $e&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _effective = setup.getEnemyDamageTypeMultiplier(_damageType, _target)&gt;&gt;
	&lt;&lt;if _effective &gt; 1&gt;&gt; /* TODO - check this gets formatted correctly */
		It&#39;s super effective!
	&lt;&lt;elseif _effective &lt; 1&gt;&gt;
		It&#39;s not very effective. 
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

/* FIXES AND EDITS - Combat adjustments - END */


&lt;&lt;widget &quot;updateClock&quot;&gt;&gt;
	&lt;&lt;set _time = &quot;Day &quot;+$day+&quot;, &quot;+$displayHour+&quot;:&quot;+$tensMinute+$onesMinute+&quot; &quot;+$ampm&gt;&gt;
	
	&lt;&lt;replace &quot;#timeDisplay&quot;&gt;&gt;
		&#39;&#39; _time &#39;&#39;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/widget&gt;&gt;

/* Performs similar logic to the stretch fruit wearing off effect, to save the player being defeated from overstuffing when their stomach changes size */
/* (note: Just as with the original stretch fruit implementation, this can actually cause the stomach boost to grow larger!) */
&lt;&lt;widget &quot;stomachResizeRescue&quot;&gt;&gt;
	&lt;&lt;if $args[0]&gt;&gt;
		&lt;&lt;set _narration = $args[0]&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _narration = &quot;You hear an ominous gurgling sound emanating from your stomach. You look down as you&#39;re struck by the all too familiar sensation of growing fuller and fuller. You quickly realize that the powers affecting your stomach are wearing off in spite of you exceeding your normal limits. Fortunately the shrinking eventually stops before you explode, although you&#39;re stomach is still stretched to its absolute limit. It seems the effects haven&#39;t completely worn off... yet. &quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;li&gt;//_narration//&lt;/li&gt;
	
	/* We&#39;ll hack things and just use the sto status */
	/* Work out the required buff */
	&lt;&lt;set _sizeRequired = Math.floor(($ate + $inf + 1) / ($maxFul/100))&gt;&gt;
	&lt;&lt;set _boostRequired = _sizeRequired - $sto + $status.sto&gt;&gt;
	
	&lt;&lt;set $status.sto = _boostRequired&gt;&gt;
	&lt;&lt;set $status.stoTime = setup.tuning(&quot;stoRescueInterval&quot;)&gt;&gt; /* This will potentially mean cutting an existing stomach buff off early, but I&#39;m sure the player won&#39;t mind it as a cost for being saved :p */
	&lt;&lt;updateStats&gt;&gt;
	&lt;&lt;if $hea &lt; 1&gt;&gt;&lt;&lt;set $hea = 1&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $alive = true&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="120" name="icy spells patch and update" tags="" position="7400,900" size="100,100">&lt;&lt;set _MODVERSION = 1&gt;&gt;

/* LEVITATION */
&lt;&lt;run setup.tune(&quot;icyspells_levitateBaseStrength&quot;, 0)&gt;&gt;
&lt;&lt;run setup.tune(&quot;icyspells_levitateBaseLength&quot;, 240)&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Levitate&quot;,
	name: &quot;levitate&quot;,	
	description: &quot;Carry yourself with the aid of magic, preventing you from being slowed or tired by your burdens while travelling. The floating prevents you from benefiting from your natural speed if it would help your travels, however. &quot;,
	cast: &quot;You raise your arms, and your body follows them, lifting weightlessly into the air as faint shimmers of magic run across you. &quot;,
	value: 22,
	level: 1,
	cost: 10,
	int: 30,
	type: &quot;custom&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;icyspells_levitate&quot;,
	option: &quot;icyspells_enabled&quot;,
	/* There&#39;s no reason to NOT allow this to be cast in combat, however I think excluding it from there could help convey that it has no impact on combat. */
	ooc: true,
})&gt;&gt;

/* ENLARGE / REDUCE */
&lt;&lt;run setup.tune(&quot;icyspells_enlargeBaseLength&quot;, 60)&gt;&gt;
&lt;&lt;run setup.tune(&quot;icyspells_enlargeStatChangeMod&quot;, 1)&gt;&gt; /* Scaling factor is multiplied by this number, before being used to modify stats */

/* It&#39;s hard to fully work out what I want from the spell, given I haven&#39;t mapped out the mechanical effects yet, so this is subject to change! */
&lt;&lt;run setup.registerSpell({
	Name: &quot;Embiggen / Belittle&quot;,
	name: &quot;embiggen / belittle&quot;,	
	description: &quot;Resize your body to be larger or smaller. &quot;,
	value: 65,
	level: 1,
	cost: 15,
	int: 45,
	type: &quot;custom&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;icyspells_enlarge&quot;,
	option: &quot;icyspells_enabled&quot;,
    configurable: true,
	combat: true,
	ooc: true,
})&gt;&gt;

/* IGNITE */
&lt;&lt;run setup.tune(&quot;icyspells_igniteChanceBase&quot;, 0.9)&gt;&gt;
&lt;&lt;run setup.tune(&quot;icyspells_igniteChanceWeakness&quot;, 1)&gt;&gt;
&lt;&lt;run setup.tune(&quot;icyspells_igniteChanceResistance&quot;, 2/3)&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Ignite&quot;,
	name: &quot;ignite&quot;,	
	description: &quot;Scorch your enemy with hot flames with a high chance of burning them. If the enemy is already burning, each cast intensifies and prolongs the burning. &quot;,
	
	/* Since my napkin math is based on how damage would compare relative to casting the standard damaging fire spell equivalent, many of the stats are going to be the same for my sanity */
	value: 15,
	level: 1,
	cost: 5,
	int: 30,

	dType: &quot;fire&quot;,
	damage: 4,
	dRange: 4,
	power: 0.3, /* If at 0.4, the spell would start off as being functionally the same as Fireball, with the damage divided across 3 burn ticks */

	type: &quot;custom&quot;,
	time: 3,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	/* Cast text handled on cast */
	
	id: &quot;icyspells_ignite&quot;,
	option: &quot;icyspells_enabled&quot;,
	combat: true,
})&gt;&gt;

/* WARDS */
&lt;&lt;run setup.tune(&quot;icyspells_wardReinforceRate&quot;, 5)&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Lesser Ward&quot;,
	name: &quot;lesser ward&quot;,	
	description: &quot;Erect wards that reduce incoming damage by 50%. The wards shatter once they&#39;ve absorbed too much damage. &quot;,
	cast: &quot;You trace glowing runes in the air with your $p.hands which lock into place around you. &quot;,
	
	value: 25,
	level: 1,
	cost: 6,
	int: 20,

	damage: 4,
	dRange: 4,
	power: 0.5, /* % reduction */

	type: &quot;custom&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;icyspells_lesserWard&quot;,
	option: &quot;icyspells_enabled&quot;,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Ward&quot;,
	name: &quot;ward&quot;,	
	description: &quot;Erect arcane wards that reduce incoming damage by 65%. The wards shatter once they&#39;ve absorbed too much damage. More mana can be invested when casting to reinforce the wards, but at reduced efficiency. &quot;,
	cast: &quot;You trace a number of sparkling runes in the air with your $p.hands which lock into place around you. &quot;,
	
	value: 50,
	level: 1,
	cost: 25,
	int: 50,

	damage: 6,
	dRange: 8,
	power: 0.65, /* % reduction */

	type: &quot;custom&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;icyspells_ward&quot;,
	option: &quot;icyspells_enabled&quot;,
	configurable: true,
	combat: true,
})&gt;&gt;

/* MEDITATION */
&lt;&lt;run setup.registerSpell({
	Name: &quot;Meditate&quot;,
	name: &quot;meditate&quot;,	
	description: &quot;Enter your body into a mana-infused state of rest, where it can recover from what ails it at an accelerated rate. &quot;,
	cast: &quot;You take a moment to close your eyes, center yourself, and let the energies of the world flow through your being in measured breaths. When you awaken from your peaceful trance, you feel well-rested, and ready for anything. &quot;,
	
	value: 22,
	level: 1,
	cost: 4,
	int: 20,

	time: 15, /* How long passes on the rest */
	stamina: 25, /* How much stamina is recovered */
	enduranceMult: 1, /* Multiplier for how much health is recovered */
	bonusDigest: 45, /* How much extra digestion occurs */

	type: &quot;custom&quot;,
	icon: &quot;whiteMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;icyspells_meditate&quot;,
	option: &quot;icyspells_enabled&quot;,
	ooc: true,
})&gt;&gt;

/* GREASE */
&lt;&lt;run setup.tune(&quot;icyspells_greaseBurnTime&quot;, 3)&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Grease&quot;,
	name: &quot;grease&quot;,	
	description: &quot;Coat your foe in a layer of flammable oil, which will ignite when put to the flame. &quot;,
	cast: &quot;You stomp your feet, and small geysers of black oil stream from the ground, coating your opponent. &quot;,
	
	value: 20,
	level: 1,
	cost: 5,
	int: 20,

	type: &quot;custom&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;icyspells_grease&quot;,
	option: &quot;icyspells_enabled&quot;,
	combat: true,
})&gt;&gt;

/* FLASH FIRE */
&lt;&lt;run setup.registerSpell({
	Name: &quot;Flash Fire Blast&quot;,
	name: &quot;flash fire blast&quot;,	
	description: &quot;Focus an intense explosion centered around your opponent. Burning foes take all their remaining burning damage, before being extinguished. &quot;,
	
	value: 80,
	level: 1,
	cost: 30,
	int: 70,

	dType: &quot;fire&quot;,
	damage: 10,
	dRange: 12,
	greaseMult: 1,

	type: &quot;custom&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	/* Cast text handled on cast */
	
	id: &quot;icyspells_explode&quot;,
	option: &quot;icyspells_enabled&quot;,
	combat: true,
})&gt;&gt;

/* HEATWAVE */
&lt;&lt;run setup.registerSpell({
	Name: &quot;Heatwave&quot;,
	name: &quot;heatwave&quot;,	
	description: &quot;Radiate intense heat at your foe, causing a burning enemy to take burning damage, and prolonging their burning another turn. If the enemy isn&#39;t burning, they will instead start burning for a minor amount. &quot;,

	value: 40,
	level: 3,
	cost: 15,
	int: 40,

	/* Damage is used to create the burn */
	dType: &quot;fire&quot;,
	damage: 6,
	dRange: 8,

	type: &quot;custom&quot;,
	time: 3, /* Duration of default burn */
	extendTime: 1, /* Additional burn time to add */
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	/* Cast text and power strength are handled on cast */
	
	id: &quot;icyspells_heatwave&quot;,
	option: &quot;icyspells_enabled&quot;,
	combat: true,
})&gt;&gt;

&lt;&lt;if $icyspells_saveVersion == null&gt;&gt;
	&lt;&lt;set $icyspells_saveVersion = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $icyspells_saveVersion &lt; _MODVERSION&gt;&gt;
	&lt;&lt;set setup.modUpdated = true&gt;&gt;
	&lt;&lt;set setup.modUpdatedList.push(&quot;Icy&#39;s Spellbook&quot;)&gt;&gt;
    
    &lt;&lt;if $icyspells_saveVersion &lt; 1&gt;&gt;
    	&lt;&lt;set $status.levitate = 0&gt;&gt;
        &lt;&lt;set $status.levitateTime = 0&gt;&gt;
        
        &lt;&lt;set $status.enlarge = 1&gt;&gt;
        &lt;&lt;set $status.enlargeTime = 0&gt;&gt;
        
        &lt;&lt;set $icyspells_ward = 0&gt;&gt;
        &lt;&lt;set $icyspells_wardReduction = 0&gt;&gt;
        
        &lt;&lt;set $icyspells_saveVersion = 1&gt;&gt;
    &lt;&lt;/if&gt;&gt;
	
	/* Update the recorded version in the save, so this doesn&#39;t happen again */
	&lt;&lt;set $icyspells_saveVersion = _MODVERSION&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="121" name="icyibis patch and update" tags="fixes-and-edits" position="6000,1500" size="200,100">&lt;&lt;include &quot;pokemod patch and update&quot;&gt;&gt;
&lt;&lt;include &quot;feeder patch and update&quot;&gt;&gt;
&lt;&lt;include &quot;downtime patch and update&quot;&gt;&gt;
&lt;&lt;include &quot;icy spells patch and update&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="122" name="manual mod patch option" tags="fixes-and-edits" position="7000,1200" size="100,100">/* Passage for the manual modding patch button + explanation. Appears in both Mod Options and Game fixes */
Run this before playing whenever you&#39;ve updated a mod, or added a mod to an existing save file. You&#39;ll still also have to enable new mods if you want to experience their content.&lt;br&gt;
&lt;&lt;link &quot;Update Mods&quot;&gt;&gt;
	&lt;&lt;include &quot;mods patch and update&quot;&gt;&gt;
&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="123" name="mods patch and update" tags="fixes-and-edits mod-support" position="5800,1600" size="200,200">&lt;&lt;include &quot;fixes and edits patch and update&quot;&gt;&gt; /* Nothing should come before the fixes and edits patch! */

&lt;&lt;include &quot;icyibis patch and update&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="124" name="npc variables" tags="fixes-and-edits" position="6400,1400" size="200,100">/* Contains all the info for the non-randomised (&quot;fixed&quot;) NPCs */
/* Things have been restructured to use this file so that there&#39;s an easier way for modders to swap their species or genders without having to manually edit any passage they&#39;re involved in */

/* Patching Status: Full reset on each patch */

&lt;&lt;set $npcs = {}&gt;&gt;

/* Define the base NPCs here, because why not */
/* (ignore the weird setup here - I wasn&#39;t fully sure how I wanted to handle patchers) */
&lt;&lt;set _baseNPCs = {
	/* City */
	armorer: {
		name: &quot;Argus&quot;,
		gender: &quot;male&quot;,
		species: &quot;lion&quot;,
	},
	
	generalStore: {
		name: &quot;Charles&quot;,
		gender: &quot;male&quot;,
		species: &quot;rat&quot;,
		fname: &quot;Charlie&quot;,
	},
	
	clothier: {
		name: &quot;Edna&quot;,
		gender: &quot;female&quot;,
		species: &quot;cattle&quot;,
		mname: &quot;Edmund&quot;,
	},
	
	grocer: {
		name: &quot;Grocer&quot;,
		gender: &quot;female&quot;,
		species: &quot;brownBear&quot;,
	},
	
	tailor: {
		name: &quot;Charles&quot;, /* Tailor isn&#39;t named, but clothier mentions her husband Charles does alterations. So she could be referring to the tailor, the general store owner who happens to be named Charles, or another character altogether */
		gender: &quot;male&quot;,
		species: &quot;tiger&quot;,
		fname: &quot;Charlie&quot;,
	},
	
	waitress: {
		name: &quot;Deb&quot;,
		gender: &quot;female&quot;,
		species: &quot;fox&quot;,
		mname: &quot;Des&quot;,
	},
	cook: {
		name: &quot;Cookie&quot;,
		gender: &quot;male&quot;,
		species: &quot;cheetah&quot;,
	},
	
	priest: {
		name: &quot;Oswald&quot;,
		gender: &quot;male&quot;,
		species: &quot;raven&quot;,
		fname: &quot;Astrid&quot;,
	},
	
	/* Farm */
	dairyFarmer: {
		name: &quot;Farmer&quot;,
		gender: &quot;male&quot;,
		species: &quot;cattle&quot;,
		color: &quot;brown&quot;,
	},
	sampson: {
		name: &quot;Sampson&quot;,
		gender: &quot;male&quot;, /* Technically in the base game Sampson is programmed to have a random gender, but I don&#39;t know if that&#39;s intentional */
		species: &quot;horse&quot;,
		fname: &quot;Samantha&quot;,
		
		color: &quot;brown&quot;,
		coatDesc: &quot;beige coat&quot;,
		feetDesc: &quot;clumpy hooves&quot;,
		maneDesc: &quot;mane&quot;,
		whinnies: &quot;whinnies&quot;,
		whickers: &quot;whickers&quot;,
	},
	scientist: {
		name: &quot;Scientist&quot;,
		gender: &quot;male&quot;, 
		species: &quot;raccoon&quot;,
		fname: &quot;Scientist&quot;,
	},
	
	/* Forest */
	/* no fixed enemies in the forest - any encounters are random NPC, or have been fixed to be random */
	
	/* Grasslands */
	/* wildling shaman boss is actually a random character. though their passages still needed fixing :s */
	
	wildlingDragon: {
		name: &quot;?&quot;,
		gender: &quot;male&quot;,
		species: { /* another instance of having to make a custom species almost solely so it can say &quot;dragon&quot;, though technically it&#39;s also needed for colors, as there&#39;s not normally a gold dragon... */
			article: &quot;a&quot;,
			id: &quot;dragon&quot;,	
			species: &quot;dragon&quot;,
			angry: &quot;roar&quot;,
			furBack: &quot;gold&quot;, furBelly: &quot;gold&quot;, furHead: &quot;gold&quot;,
			foot: &quot;foot&quot;, feet: &quot;feet&quot;,
			hand: &quot;claw&quot;, hands: &quot;claws&quot;,
			fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
			hair: &quot;head&quot;,
			tail: &quot;thick tail&quot;,
			teeth: &quot;sharp teeth&quot;,
			mouth: &quot;muzzle&quot;,
			speciesHeight: 74,
			speciesStats: [7,0,3,5,10,5],
		},
	},
	lizardWizard: {
		name: &quot;Fruit Wizard&quot;,
		gender: &quot;male&quot;,
		species: &quot;lizard&quot;, /* had to create the species, but thats fine because there really should be lizards anyways */
	},
	
	/* West town */
	westMerchant: {
		name: &quot;Dianne&quot;,
		gender: &quot;female&quot;,
		species: &quot;panther&quot;,
		mname: &quot;Danny&quot;,
	},
	westInnkeeper: {
		name: &quot;Bronk&quot;,
		gender: &quot;male&quot;,
		species: &quot;pig&quot;,
		pork: &quot;pork&quot;,
		oinker: &quot;oinker&quot;,
	},
	westInnkeeperReplacement: {
		name: &quot;Larry&quot;, /* Yes, same name as the receptionist */
		gender: &quot;male&quot;,
		species: &quot;duck&quot;, /* Ducks aren&#39;t actually in the base game, but I modded them in for simplicity - otherwise the species could be defined here */
		color: &quot;white&quot;,
		fname: &quot;Loretta&quot;,
	},
	guildReceptionist: {
		name: &quot;Larry&quot;,
		gender: &quot;male&quot;,
		species: &quot;dolphin&quot;,
		fname: &quot;Linda&quot;,
	},
	apothecary: {
		name: &quot;Riggs&quot;,
		gender: &quot;male&quot;,
		species: &quot;ferret&quot;,
		fname: &quot;Regina&quot;,
	},
	destructatorium: {
		name: &quot;Dren&quot;,
		gender: &quot;male&quot;,
		species: &quot;blueDragon&quot;,
		fname: &quot;Drenusha&quot;,
	},
	restoratorium: {
		name: &quot;Rosalina&quot;,
		gender: &quot;female&quot;,
		species: &quot;mouse&quot;,
		mname: &quot;Ross&quot;,
	},
	altertarium: {
		name: &quot;Lucas&quot;,
		gender: &quot;male&quot;,
		species: &quot;fox&quot;,
		color: &quot;white&quot;,
		fname: &quot;Lucia&quot;,
	},
	captain: {
		name: &quot;Everett&quot;,
		gender: &quot;male&quot;,
		species: &quot;brownBear&quot;,
	},
	beachVendor: {
		name: &quot;Raccoon&quot;,
		gender: &quot;male&quot;,
		species: &quot;raccoon&quot;,
	},
	
	/* Jungle */
	jungleInnkeeper: {
		name: &quot;Ostrom&quot;,
		gender: &quot;male&quot;,
		species: &quot;raptor&quot;,
	},
	jungleSmith: {
		name: &quot;Kieras&quot;,
		gender: &quot;female&quot;,
		species: &quot;triceratops&quot;,
	},
	chief: {
		name: &quot;Sue&quot;,
		fullName: &quot;Sudaentarsus&quot;,
		gender: &quot;female&quot;,
		species: &quot;tyrannosaurus&quot;,
		mname: &quot;Sudain&quot;,
	},
	shaman: { /* (the friendly NPC one on the island) */
		name: &quot;Aktulos&quot;,
		gender: &quot;male&quot;,
		species: &quot;pterodactyl&quot;,
	},
	
	starShaman: {
		name: &quot;Star Shaman&quot;,
		gender: &quot;male&quot;,
		species: &quot;raptor&quot;,
	},
	
	/* Mountain */
	mountainWizard: {
		name: &quot;?&quot;,
		gender: &quot;male&quot;,
		species: &quot;dog&quot;,
	},
	mountainWizardAssistant: {
		name: &quot;?&quot;,
		gender: &quot;male&quot;,
		species: &quot;goat&quot;,
	},
	
	cabalLion: { /* the leader */
		name: &quot;&quot;,
		gender: &quot;male&quot;,
		species: &quot;lion&quot;,
	},
	cabalRabbit: { /* the body changer */
		name: &quot;&quot;,
		gender: &quot;female&quot;,
		species: &quot;rabbit&quot;,
	},
	cabalOwl: { /* the fat storer */
		name: &quot;&quot;,
		gender: &quot;male&quot;,
		species: &quot;owl&quot;,
	},
	cabalRogue: {
		name: &quot;Rogue Cabal Dragon&quot;,
		gender: &quot;male&quot;,
		species: { /* All dragon species include colour, so we need a separate species to just say &quot;dragon&quot; &gt;_&gt; */
			article: &quot;a&quot;,
			id: &quot;dragon&quot;,	
			species: &quot;dragon&quot;,
			angry: &quot;roar&quot;,
			furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
			foot: &quot;foot&quot;, feet: &quot;feet&quot;,
			hand: &quot;claw&quot;, hands: &quot;claws&quot;,
			fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
			hair: &quot;head&quot;,
			tail: &quot;thick tail&quot;,
			teeth: &quot;sharp teeth&quot;,
			mouth: &quot;muzzle&quot;,
			speciesHeight: 74,
			speciesStats: [7,0,3,5,10,5],
		},
		color: &quot;grey&quot;,
	},
	tigerBoss: {
		name: &quot;Mountainous Tiger Sorcerer&quot;,
		gender: &quot;male&quot;,
		species: &quot;tiger&quot;,
		color: &quot;orange&quot;,
		feetColor: &quot;black&quot;,
	},
	
	snookums: {
		name: &quot;Snookums&quot;,
		gender: &quot;female&quot;,
		species: &quot;squirrel&quot;,
	},
	smarty: {
		name: &quot;Smarty&quot;,
		gender: &quot;male&quot;,
		species: &quot;rabbit&quot;,
	},
	earl: {
		name: &quot;Earl&quot;,
		gender: &quot;male&quot;,
		species: &quot;goat&quot;,
		fname: &quot;Ella&quot;,
	},
	smith: {
		name: &quot;Smith&quot;,
		gender: &quot;male&quot;,
		species: &quot;donkey&quot;,
	},

	/* Swamp */
	Elara: {
		name: &quot;Elara&quot;,
		gender: &quot;female&quot;,
		species: &quot;fox&quot;,
		/* mname: &quot;Edwin&quot;, */
		chatContext: &quot;
		This is a text-based adventure game where the player can talk to the characters they meet. There will be text describing the scene and any characters. The player will respond with dialogue and actions. You will respond with narration and any relevant dialogue from this character.
		Character Profile:
		Name: Elara
		Species: Fox
		Appearance: Fox-like, Her bloated state makes her features very puffy.
		Clothing: Stretched green tunic and dark trousers, strained due to her swollen form. 
		Hobbies: Enjoys exploration, botany, and mapping new territories.

		Current Situation:
		Elara, an anthro fox adventurer, is temporarily immobilized and extremely bloated after accidentally inhaling Puff Fungus spores. The spores have filled her with a green gas that makes her lightweight. Her waist is around 4 feet in circumference, and her arms and legs are so swollen she can only wiggle them slightly. She is currently laying on her inflated belly, unable to reach the ground with her feet or move at all. 

		Dialogue Style:
		Speech Pattern: Elara&#39;s speech is frequently interrupted by loud, uncontrollable burps. 
		Tone: Friendly but frustrated and uncomfortable with her current state. 
		Responses: Should reflect her current inability to move freely, her frustration with her situation, and her knowledge of the forest and its dangers. Her swollen belly is a constant source of discomfort, so she should frequently mention it and her attempts to relieve the pressure.
		She is constantly burping up green gas, each burp causing her to deflate slightly. 

		Events:
		If the player gets too close to her face, Elara might burp the green gas onto them, causing the player to slowly bloat up until they are as big as Elara is. Elara does NOT know about this effect.
		&quot;
	}
}&gt;&gt;


/* Register all the NPCs
/* (I don&#39;t want to have to figure out how to loop properly, so I&#39;m going to do it with JS instead) */
&lt;&lt;script&gt;&gt;
	for (const [id, data] of Object.entries(State.temporary.baseNPCs)) {
    setup.registerNPC(id, data);
  }
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="125" name="pokemod core patch and update" tags="pokemod" position="7100,900" size="100,100">&lt;&lt;if $options.pokemodCoreEnabled == true&gt;&gt;
	/* PATCH NPCS */
	&lt;&lt;run setup.registerNPC(&quot;wildlingDragon&quot;, {
		species: &quot;whiteDragon&quot;
	})&gt;&gt;
	
	&lt;&lt;run setup.registerNPC(&quot;cabalRogue&quot;, {
		name: &quot;Rogue Cabal Haxorus&quot;,
		species: {
			article: &quot;a&quot;,	
			species: &quot;haxorus&quot;,
			plural: &quot;haxoruses&quot;,
			angry: &quot;roar&quot;,
			furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
			foot: &quot;foot&quot;, feet: &quot;feet&quot;,
			hand: &quot;claw&quot;, hands: &quot;claws&quot;,
			fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
			hair: &quot;head&quot;,
			tail: &quot;thick tail&quot;,
			teeth: &quot;sharp teeth&quot;,
			mouth: &quot;muzzle&quot;,
			speciesHeight: 74,
			speciesStats: [7,0,3,5,10,5],
		},
	});&gt;&gt;
	
	&lt;&lt;run setup.registerNPC(&quot;tigerBoss&quot;, {
		name: &quot;Mountainous Incineroar Sorcerer&quot;
	})&gt;&gt;
	
	/* PATCH ENEMIES */
	/* TODO - Update this if ever get around to implementing proper enemy patching */
	&lt;&lt;set $fatWolf.name = &quot;fat lycanroc&quot;&gt;&gt;
	&lt;&lt;set $fatWolf.Name = &quot;Fat lycanroc&quot;&gt;&gt;
	
	&lt;&lt;set $obeseBear.name = &quot;obese ursaring&quot;&gt;&gt;
	&lt;&lt;set $obeseBear.Name = &quot;Obese ursaring&quot;&gt;&gt;
	
	&lt;&lt;set $bloatedLion.name = &quot;bloated pyroar&quot;&gt;&gt;
	&lt;&lt;set $bloatedLion.Name = &quot;Bloated pyroar&quot;&gt;&gt;
	
	&lt;&lt;set $gorgedCheetah.name = &quot;gorged purugly&quot;&gt;&gt;
	&lt;&lt;set $gorgedCheetah.Name = &quot;Gorged purugly&quot;&gt;&gt;
	
	&lt;&lt;set $expandedElephant.name = &quot;expanded copperajah&quot;&gt;&gt;
	&lt;&lt;set $expandedElephant.Name = &quot;Expanded copperajah&quot;&gt;&gt;
	
	&lt;&lt;set $bloatBees.name = &quot;bloat beedrills&quot;&gt;&gt;
	&lt;&lt;set $bloatBees.Name = &quot;Bloat beedrills&quot;&gt;&gt;
	
	&lt;&lt;set $soldierAnts.name = &quot;soldier durants&quot;&gt;&gt;
	&lt;&lt;set $soldierAnts.Name = &quot;Soldier Durants&quot;&gt;&gt;
	
	&lt;&lt;set $feederAnt.name = &quot;feeder durant&quot;&gt;&gt;
	&lt;&lt;set $feederAnt.Name = &quot;Feeder Durant&quot;&gt;&gt;
	
	&lt;&lt;set $fatWyvern.name = &quot;fat noivern&quot;&gt;&gt;
	&lt;&lt;set $fatWyvern.Name = &quot;Fat Noivern&quot;&gt;&gt;
	
	&lt;&lt;set $royalGuardWasp.name = &quot;royal guard combee&quot;&gt;&gt;
	&lt;&lt;set $royalGuardWasp.Name = &quot;Royal Guard Combee&quot;&gt;&gt;
	
	/* (don&#39;t think the npc renames are necessary due to them being fixed NPCs, but will do them anyway) */
	&lt;&lt;set $mountainousTiger.name = &quot;mountainous incineroar sorcerer&quot;&gt;&gt;
	&lt;&lt;set $mountainousTiger.Name = &quot;Mountainous Incineroar Sorcerer&quot;&gt;&gt;
	
	&lt;&lt;set $cabalDragon.name = &quot;rogue cabal haxorus&quot;&gt;&gt;
	&lt;&lt;set $cabalDragon.Name = &quot;Rogue Cabal Haxorus&quot;&gt;&gt;
	
	&lt;&lt;set $hydra.name = &quot;giant hydreigon&quot;&gt;&gt;
	&lt;&lt;set $hydra.Name = &quot;Giant Hydreigon&quot;&gt;&gt;
	
	&lt;&lt;set $sandSnake.name = &quot;venomous sandaconda&quot;&gt;&gt;
	&lt;&lt;set $sandSnake.Name = &quot;Venomous Sandaconda&quot;&gt;&gt;
	&lt;&lt;set $sandSnake.species = &quot;anacondaSpecies&quot;&gt;&gt; /* C&#39;mon, how can I NOT replace the sand snake with the sand snake pokemon!? */
	
	&lt;&lt;set $bubbleOrca.name = &quot;bubble wailmer&quot;&gt;&gt;
	&lt;&lt;set $bubbleOrca.Name = &quot;Bubble Wailmer&quot;&gt;&gt;
	
	&lt;&lt;set $sphericalShark.name = &quot;spherical sharpedo&quot;&gt;&gt;
	&lt;&lt;set $sphericalShark.Name = &quot;Spherical Sharpedo&quot;&gt;&gt;
	
	&lt;&lt;set $anaconda.name = &quot;massive ekans&quot;&gt;&gt;
	&lt;&lt;set $anaconda.Name = &quot;Massive Ekans&quot;&gt;&gt;
	&lt;&lt;set $anaconda.species = &quot;snake&quot;&gt;&gt;
	
	&lt;&lt;set $fatJaguar.name = &quot;fat luxray&quot;&gt;&gt;
	&lt;&lt;set $fatJaguar.Name = &quot;Fat Luxray&quot;&gt;&gt;
	
	&lt;&lt;set $anacondaBoss.name = &quot;giant ekans&quot;&gt;&gt;
	&lt;&lt;set $anacondaBoss.Name = &quot;Giant Ekans&quot;&gt;&gt;
	&lt;&lt;set $anacondaBoss.species = &quot;snake&quot;&gt;&gt;
	
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="126" name="pokemod core patch core species" tags="pokemod" position="7000,1000" size="100,100">/* This passage is responsible for patching the core species when Pokemod Core is selected. Other patches (like the ones to enemies and NPCs) are done elsewhere) */

&lt;&lt;set $options.pokemodCoreEnabled = true&gt;&gt;

/* PATCH THE CORE SPECIES */

/* Dolphin -&gt; Palafin */
&lt;&lt;run setup.registerSpecies({
	id: &quot;dolphin&quot;,
	species: &quot;palafin&quot;,
	plural: &quot;palafins&quot;,
	mname: &quot;palafin&quot;,
	fname: &quot;palafin&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;white&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [7,5,5,5,3,3],
	
	waterType: true,
})&gt;&gt;

/* Orca -&gt; Wailmer */
/* Orca is hard because the only thing based on orcas is a legendary, which I want to avoid... Going with Wailmer instead of Wailord, because Wailord would be a better fit for a whale species replacement, if one gets added. */
&lt;&lt;run setup.registerSpecies({ 
	id: &quot;orca&quot;,
	article: &quot;a&quot;,
	species: &quot;wailmer&quot;,
	plural: &quot;wailmers&quot;,
	mname: &quot;wailmer&quot;,
	fname: &quot;wailmer&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;yellow-white&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [3,2,10,3,7,15],
	
	waterType: true,
})&gt;&gt;

/* Shark -&gt; Sharpedo */
&lt;&lt;run setup.registerSpecies({
	id: &quot;shark&quot;,
	species: &quot;sharpedo&quot;,
	plural: &quot;sharpedoes&quot;,
	mname: &quot;sharpedo&quot;,
	fname: &quot;sharpedo&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;white&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [8,6,2,4,5,5],
	
	waterType: true,
	darkType: true,
})&gt;&gt;

/* Blue Jay -&gt; Corvisquire */
&lt;&lt;run setup.registerSpecies({
	id: &quot;blueJay&quot;,
	species: &quot;corvisquire&quot;,
	plural: &quot;corvisquires&quot;,
	mname: &quot;corvisquire&quot;,
	fname: &quot;corvisquire&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;light blue&quot;, furHead: &quot;black&quot;,
	
	speciesStats: [6,4,10,5,0,0],
	
	flyingType: true,
})&gt;&gt;

/* Hawk -&gt; Hawlucha */
&lt;&lt;run setup.registerSpecies({
	id: &quot;hawk&quot;,
	species: &quot;hawlucha&quot;,
	plural: &quot;hawluchas&quot;,
	mname: &quot;hawlucha&quot;,
	fname: &quot;hawlucha&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;white&quot;, furHead: &quot;green&quot;,
	
	speciesStats: [6,9,5,5,0,0],
	
	flyingType: true,
	fightingType: true,
})&gt;&gt;

/* Owl -&gt; Noctowl */
&lt;&lt;run setup.registerSpecies({
	id: &quot;owl&quot;,
	article: &quot;a&quot;,
	species: &quot;noctowl&quot;,
	plural: &quot;noctowls&quot;,
	mname: &quot;noctowl&quot;,
	fname: &quot;noctowl&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;light brown&quot;, furHead: &quot;light brown&quot;,
	
	speciesStats: [4,6,7,8,0,2],
	
	normalType: true,
	flyingType: true,
})&gt;&gt;

/* Penguin -&gt; Delibird */
&lt;&lt;run setup.registerSpecies({
	id: &quot;penguin&quot;,
	species: &quot;delibird&quot;,
	plural: &quot;delibirds&quot;,
	mname: &quot;delibird&quot;,
	fname: &quot;delibird&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;white&quot;, furHead: &quot;red&quot;,
	
	speciesStats: [4,5,4,5,7,6],
	
	iceType: true,
	flyingType: true,
})&gt;&gt;

/* Raven -&gt; Corviknight */
/* Ugh, gonna have to use another corvi form because it&#39;s the best fit, aren&#39;t I? */
&lt;&lt;run setup.registerSpecies({
	id: &quot;raven&quot;,
	species: &quot;corviknight&quot;,
	plural: &quot;corviknights&quot;,
	mname: &quot;corviknight&quot;,
	fname: &quot;corviknight&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	
	speciesStats: [6,4,10,5,0,0], /* same stats as corvisquire because I was actually already using corviknight&#39;s stats :p */
	
	flyingType: true,
	steelType: true,
})&gt;&gt;

/* Robin -&gt; Fletchling */
&lt;&lt;run setup.registerSpecies({
	id: &quot;robin&quot;,
	species: &quot;fletchling&quot;,
	plural: &quot;fletchlings&quot;,
	mname: &quot;fletchling&quot;,
	fname: &quot;fletchling&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;red&quot;,
	
	speciesStats: [5,10,5,5,0,0],
	
	normalType: true,
	flyingType: true,
})&gt;&gt;

/* Magpie -&gt; Pidgeot */
/* There are no pokemon that are close to being magpies, so here&#39;s pidgeot instead :p */
&lt;&lt;run setup.registerSpecies({
	id: &quot;magpie&quot;,
	species: &quot;pidgeot&quot;,
	plural: &quot;pidgeots&quot;,
	mname: &quot;pidgeot&quot;,
	fname: &quot;pidgeot&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;beige&quot;, furHead: &quot;yellow and red&quot;,
	hair: &quot;crest&quot;,
	
	speciesStats: [6,8,6,5,0,0],
	
	normalType: true,
	flyingType: true,
})&gt;&gt;

/* Duck -&gt; Ducklett */
&lt;&lt;run setup.registerSpecies({
	id: &quot;duck&quot;,
	species: &quot;ducklett&quot;,
	plural: &quot;duckletts&quot;,
	mname: &quot;ducklett&quot;,
	fname: &quot;ducklett&quot;,
	furBack: &quot;light blue&quot;, furBelly: &quot;blue&quot;, furHead: &quot;light blue&quot;,
	
	speciesStats: [6,8,5,6,0,0],
	
	waterType: true,
	flyingType: true,
})&gt;&gt;

/* coyote, dog, fox, paintedDog, wolf */

/* Coyote -&gt; Arcanine */
/* No good pokemon substitute, so here&#39;s a popular doggo instead */
&lt;&lt;run setup.registerSpecies({
	id: &quot;coyote&quot;,
	species: &quot;arcanine&quot;,
	plural: &quot;arcanines&quot;,
	mname: &quot;arcanine&quot;,
	fname: &quot;arcanine&quot;,
	furBack: &quot;black and orange striped&quot;, furBelly: &quot;black and orange striped&quot;, furHead: &quot;beige&quot;,
	hair: &quot;mane&quot;,
	
	speciesStats: [7,6,4,4,5,3],
	
	fireType: true,
})&gt;&gt;

/* Dog -&gt; Boltund, I guess*/
&lt;&lt;run setup.registerSpecies({
	id: &quot;dog&quot;,
	species: &quot;boltund&quot;,
	plural: &quot;boltunds&quot;,
	mname: &quot;boltund&quot;,
	fname: &quot;boltund&quot;,
	furBack: &quot;yellow&quot;, furBelly: &quot;black&quot;, furHead: &quot;yellow&quot;,
	
	speciesStats: [5,8,2,5,5,8],
	
	electricType: true,
})&gt;&gt;

/* Fox -&gt; Vulpix */
&lt;&lt;run setup.registerSpecies({
	id: &quot;fox&quot;,
	species: &quot;vulpix&quot;,
	plural: &quot;vuplixes&quot;,
	mname: &quot;vulpix&quot;,
	fname: &quot;vulpix&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;beige&quot;, furHead: &quot;red&quot;,
	tail: &quot;curled tails&quot;,
	
	speciesStats: [2,6,5,7,5,3],
	
	fireType: true,
})&gt;&gt;

/* Painted Dog -&gt; Mightyena */
/* Yes, it would be much better for a hyena rather than a painted dog, but I work with what I&#39;m given (and painted dogs are basically just hyenas anyway ;p) */
&lt;&lt;run setup.registerSpecies({
	id: &quot;paintedDog&quot;,
	species: &quot;mightyena&quot;,
	plural: &quot;mightyenas&quot;,
	mname: &quot;mightyena&quot;,
	fname: &quot;mightyena&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;grey&quot;, furHead: &quot;black&quot;,
	
	speciesStats: [6,5,5,4,5,3],
	
	darkType: true,
})&gt;&gt;

/* Wolf -&gt; Lycanroc */
&lt;&lt;run setup.registerSpecies({
	id: &quot;wolf&quot;,
	species: &quot;lycanroc&quot;,
	plural: &quot;lycanrocs&quot;,
	mname: &quot;lycanroc&quot;,
	fname: &quot;lycanroc&quot;,
	furBack: &quot;light brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;light brown&quot;, /* going with midday form */
	
	speciesStats: [7,7,3,3,5,5],
	
	rockType: true,
})&gt;&gt;

/* Raptor -&gt; Sceptile */
&lt;&lt;run setup.registerSpecies({
	id: &quot;raptor&quot;,
	species: &quot;sceptile&quot;,
	plural: &quot;sceptiles&quot;,
	mname: &quot;sceptile&quot;,
	fname: &quot;sceptile&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;green&quot;, furHead: &quot;green&quot;,
	
	speciesStats: [2,6,2,5,10,0],
	
	grassType: true,
})&gt;&gt;

/* pterodactyl -&gt; aerodactyl */
&lt;&lt;run setup.registerSpecies({
	id: &quot;pterodactyl&quot;,
	species: &quot;aerodactyl&quot;,
	plural: &quot;aerodactyls&quot;,
	mname: &quot;aerodactyl&quot;,
	fname: &quot;aerodactyl&quot;,
	article: &quot;an&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	teeth: &quot;teeth&quot;,
	
	speciesStats: [6,10,4,3,2,4],
	
	rockType: true,
	flyingType: true,
})&gt;&gt;

/* triceratops -&gt; bastiodon */
&lt;&lt;run setup.registerSpecies({
	id: &quot;triceratops&quot;,
	species: &quot;bastiodon&quot;,
	plural: &quot;bastiodons&quot;,
	mname: &quot;bastiodon&quot;,
	fname: &quot;bastiodon&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;beige&quot;, furHead: &quot;black&quot;,
	hair: &quot;armored head&quot;,
	
	speciesStats: [5,0,10,5,5,20],
	
	rockType: true,
	steelType: true,
})&gt;&gt;

/* stegosaurus -&gt; aurorus */
&lt;&lt;run setup.registerSpecies({
	id: &quot;stegosaurus&quot;,
	species: &quot;aurorus&quot;,
	plural: &quot;auroruses&quot;,
	mname: &quot;aurorus&quot;,
	fname: &quot;aurorus&quot;,
	article: &quot;an&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;light blue&quot;, furHead: &quot;blue&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	
	speciesStats: [4,1,8,7,5,20],
	
	iceType: true,
	rockType: true,
})&gt;&gt;

/* apatosaurus -&gt; Meganium */
&lt;&lt;run setup.registerSpecies({
	id: &quot;apatosaurus&quot;,
	species: &quot;meganium&quot;,
	plural: &quot;meganiums&quot;,
	mname: &quot;meganium&quot;,
	fname: &quot;meganium&quot;,
	article: &quot;a&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;green&quot;, furHead: &quot;green&quot;,
	tail: &quot;short tail&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	
	speciesStats: [4,5,6,5,5,5],
	
	grassType: true,
})&gt;&gt;

/* tyrannosaurus -&gt; tyrantrum */
&lt;&lt;run setup.registerSpecies({
	id: &quot;tyrannosaurus&quot;,
	species: &quot;tyrantrum&quot;,
	plural: &quot;tyrantrums&quot;,
	mname: &quot;tyrantrum&quot;,
	fname: &quot;tyrantrum&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;grey&quot;, furHead: &quot;red&quot;,
	
	speciesStats: [8,2,5,0,10,5],
	
	rockType: true,
	dragonType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;blackDragon&quot;,
	species: &quot;garchomp&quot;,
	plural: &quot;garchomps&quot;,
	mname: &quot;garchomp&quot;,
	fname: &quot;garchomp&quot;,
	furBack: &quot;dark blue&quot;, furBelly: &quot;red&quot;, furHead: &quot;dark blue&quot;,
	flying: false,
	
	speciesStats: [7,6,2,0,10,5],
	
	dragonType: true,
	groundType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;blueDragon&quot;,
	species: &quot;salamence&quot;,
	plural: &quot;salamences&quot;,
	mname: &quot;salamence&quot;,
	fname: &quot;salamence&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;white&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [7,4,1,3,10,5],
	
	dragonType: true,
	flyingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;greenDragon&quot;,
	species: &quot;flygon&quot;,
	mname: &quot;flygon&quot;,
	fname: &quot;flygon&quot;,
	plural: &quot;flygons&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;green&quot;, furHead: &quot;green&quot;,
	
	speciesStats: [5,5,2,3,10,10],
	
	dragonType: true,
	groundType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;redDragon&quot;,
	species: &quot;charizard&quot;,
	plural: &quot;charizards&quot;,
	mname: &quot;charizard&quot;,
	fname: &quot;charizard&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;cream&quot;, furHead: &quot;red&quot;,
	tail: &quot;flame-tipped tail&quot;,
	
	speciesStats: [2,5,2,6,10,5],
	
	fireType: true,
	flyingType: true,
	
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;whiteDragon&quot;,
	species: &quot;dragonite&quot;,
	plural: &quot;dragonites&quot;,
	mname: &quot;dragonite&quot;,
	fname: &quot;dragonite&quot;,
	furBack: &quot;orange&quot;, furBelly: &quot;cream&quot;, furHead: &quot;orange&quot;,
	
	speciesStats: [6,2,3,4,10,5],
	
	dragonType: true,
	flyingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;wyvern&quot;,
	species: &quot;noivern&quot;,
	plural: &quot;noiverns&quot;,
	mname: &quot;noivern&quot;,
	fname: &quot;noivern&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;purple&quot;, furHead: &quot;black&quot;,
	
	speciesStats: [3,6,2,4,10,5],
	
	flyingType: true,
	dragonType: true,
})&gt;&gt;


&lt;&lt;run setup.registerSpecies({
	id: &quot;lion&quot;,
	species: &quot;pyroar&quot;,
	fname: &quot;pyroar&quot;,
	mname: &quot;pyroar&quot;,
	plural: &quot;pyroars&quot;,
	furBack: &quot;dark brown&quot;, furBelly: &quot;dark brown&quot;, furHead: &quot;fiery red&quot;,
	
	speciesStats: [3,5,2,5,10,4],
	
	fireType: true,
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;cheetah&quot;,
	species: &quot;purugly&quot;,
	plural: &quot;puruglies&quot;,
	mname: &quot;purugly&quot;,
	fname: &quot;purugly&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	tail: &quot;corkscrew tail&quot;,
	
	speciesStats: [3,8,2,2,10,15],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;cougar&quot;,
	species: &quot;delcatty&quot;,
	plural: &quot;delcatties&quot;,
	mname: &quot;delcatty&quot;,
	fname: &quot;delcatty&quot;,
	furBack: &quot;cream&quot;, furBelly: &quot;cream&quot;, furHead: &quot;purple&quot;,
	tail: &quot;thin tail&quot;,
	
	speciesStats: [4,6,5,3,7,3],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;leopard&quot;,
	species: &quot;liepard&quot;,
	plural: &quot;liepards&quot;,
	mname: &quot;liepard&quot;,
	fname: &quot;liepard&quot;,
	furBack: &quot;spotted purple&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;purple&quot;,
	
	speciesStats: [5,6,2,5,7,3],
	
	darkType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;panther&quot;,
	species: &quot;persian&quot;,
	plural: &quot;persians&quot;,
	mname: &quot;persian&quot;,
	fname: &quot;persian&quot;,
	furBack: &quot;cream&quot;, furBelly: &quot;cream&quot;, furHead: &quot;cream&quot;,
	
	speciesStats: [5,6,4,3,7,3],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;tiger&quot;,
	species: &quot;incineroar&quot;,
	plural: &quot;incineroars&quot;,
	mname: &quot;incineroar&quot;,
	fname: &quot;incineroar&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;black and red striped&quot;,
	tail: &quot;fluffy tail&quot;,
	
	speciesStats: [6,1,5,3,10,4],
	
	fireType: true,
	darkType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;jaguar&quot;,
	species: &quot;luxray&quot;,
	plural: &quot;luxrays&quot;,
	mname: &quot;luxray&quot;,
	fname: &quot;luxray&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;blue&quot;, furHead: &quot;black&quot;,
	tail: &quot;star-pointed tail&quot;,
	
	speciesStats: [6,3,4,5,7,3],
	
	electricType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;cattle&quot;,
	species: &quot;miltank&quot;,
	plural: &quot;miltanks&quot;,
	furBack: &quot;spotted pink&quot;, furBelly: &quot;cream&quot;, furHead: &quot;black&quot;,
	fname: &quot;miltank&quot;,
	mname: &quot;miltank&quot;,
	
	speciesStats: [6,6,8,0,5,25],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;deer&quot;,
	species: &quot;sawsbuck&quot;,
	fname: &quot;sawsbuck&quot;,
	mname: &quot;sawsbuck&quot;,
	plural: &quot;sawsbucks&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;grey&quot;, furHead: &quot;black&quot;,
	
	speciesStats: [6,6,4,4,5,10],
	
	normalType: true,
	grassType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;donkey&quot;,
	species: &quot;mudbray&quot;,
	plural: &quot;mudbrays&quot;,
	mname: &quot;mudbray&quot;,
	fname: &quot;mudbray&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;cream&quot;, furHead: &quot;brown&quot;,
	
	speciesStats: [8,0,7,5,0,6],
	
	groundType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;goat&quot;,
	species: &quot;gogoat&quot;,
	plural: &quot;gogoats&quot;,
	mname: &quot;gogoat&quot;,
	fname: &quot;gogoat&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;light brown&quot;, furHead: &quot;brown&quot;,
	tail: &quot;short tail&quot;,
	
	speciesStats: [6,2,7,5,5,15],
	
	grassType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;horse&quot;,
	species: &quot;rapidash&quot;,
	mname: &quot;rapidash&quot;,
	fname: &quot;rapidash&quot;,
	plural: &quot;rapidashes&quot;,
	furBack: &quot;cream&quot;, furBelly: &quot;cream&quot;, furHead: &quot;fiery red&quot;,
	
	speciesStats: [7,7,5,6,0,4],
	
	fireType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;pig&quot;,
	species: &quot;emboar&quot;,
	plural: &quot;emboars&quot;,
	mname: &quot;emboar&quot;,
	fname: &quot;emboar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;orange&quot;,
	tail: &quot;tail&quot;,
	
	speciesStats: [7,2,5,5,6,13],
	
	fireType: true,
	fightingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;badger&quot;,
	species: &quot;obstagoon&quot;,
	plural: &quot;obstagoons&quot;,
	mname: &quot;obstagoon&quot;,
	fname: &quot;obstagoon&quot;,
	furBack: &quot;black and white&quot;, furBelly: &quot;black and white&quot;, furHead: &quot;black and white&quot;,
	tail: &quot;short tail&quot;,
	
	speciesStats: [5,5,6,4,5,10],
	
	darkType: true,
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;ferret&quot;,
	species: &quot;furret&quot;,
	plural: &quot;furrets&quot;,
	mname: &quot;furret&quot;,
	fname: &quot;furret&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown striped&quot;, furHead: &quot;brown&quot;,
	tail: &quot;striped tail&quot;,
	
	speciesStats: [5,7,5,3,0,0],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;greyKangaroo&quot;,
	species: &quot;kangaskhan&quot;,
	plural: &quot;kangaskhans&quot;,
	mname: &quot;kangaskhan&quot;,
	fname: &quot;kangaskhan&quot;,
	furBack: &quot;light brown&quot;, furBelly: &quot;cream&quot;, furHead: &quot;brown&quot;,
	
	speciesStats: [6,6,7,4,2,5],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;redKangaroo&quot;,
	species: &quot;breloom&quot;, /* look, it&#39;s the best we got */
	plural: &quot;brelooms&quot;,
	mname: &quot;breloom&quot;,
	fname: &quot;breloom&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;grey&quot;, furHead: &quot;black&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	
	speciesStats: [10,4,4,3,4,5],
	
	grassType: true,
	fightingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;otter&quot;,
	species: &quot;oshawott&quot;,
	plural: &quot;oshawotts&quot;,
	mname: &quot;oshawott&quot;,
	fname: &quot;oshawott&quot;,
	furBack: &quot;light blue&quot;, furBelly: &quot;light blue&quot;, furHead: &quot;white&quot;,
	
	speciesStats: [7,5,6,7,0,5],
	
	waterType: true,
})&gt;&gt;


&lt;&lt;run setup.registerSpecies({
	id: &quot;raccoon&quot;,
	species: &quot;zigzagoon&quot;,
	plural: &quot;zigzagoons&quot;,
	mname: &quot;zigzagoon&quot;,
	fname: &quot;zigzagoon&quot;,
	furBack: &quot;brown and white striped&quot;, furBelly: &quot;brown and white striped&quot;, furHead: &quot;brown&quot;,
	
	speciesStats: [5,8,5,3,4,8],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;skunk&quot;,
	species: &quot;skuntank&quot;,
	plural: &quot;skuntanks&quot;,
	mname: &quot;skuntank&quot;,
	fname: &quot;skuntank&quot;,
	furBack: &quot;purple&quot;, furBelly: &quot;cream&quot;, furHead: &quot;purple&quot;,
	
	speciesStats: [6,6,7,5,1,5],
	
	posionType: true,
	darkType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;weasel&quot;,
	species: &quot;floatzel&quot;,
	plural: &quot;floatzels&quot;,
	mname: &quot;floatzel&quot;,
	fname: &quot;floatzel&quot;,
	furBack: &quot;orange&quot;, furBelly: &quot;cream&quot;, furHead: &quot;orange&quot;,
	aquatic: true,
	tail: &quot;twin tails&quot;,
	
	speciesStats: [7,8,5,5,0,0],
	
	waterType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;mouse&quot;,
	species: &quot;pikachu&quot;,
	plural: &quot;pikachus&quot;,
	mname: &quot;pikachu&quot;,
	fname: &quot;pikachu&quot;,
	furBack: &quot;yellow&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;yellow&quot;,
	tail: &quot;lightning bolt tail&quot;,
	
	speciesStats: [4,7,4,7,3,2],
	
	electricType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;rabbit&quot;,
	species: &quot;lopunny&quot;,
	plural: &quot;lopunnies&quot;,
	mname: &quot;lopunny&quot;,
	fname: &quot;lopunny&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	
	speciesStats: [5,7,5,4,4,5],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;rat&quot;,
	species: &quot;rattata&quot;,
	plural: &quot;rattatas&quot;,
	mname: &quot;rattata&quot;,
	fname: &quot;rattata&quot;,
	furBack: &quot;purple&quot;, furBelly: &quot;cream&quot;, furHead: &quot;purple&quot;,
	
	speciesStats: [6,6,5,4,4,5],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;squirrel&quot;,
	species: &quot;pachirisu&quot;, /* greedent&#39;s too obvious! I want a buff Snookums pachirisu ;P */
	plural: &quot;pachirisus&quot;,
	mname: &quot;pachirisu&quot;,
	fname: &quot;pachirisu&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	
	speciesStats: [4,7,6,4,2,3],
	
	electricType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;bat&quot;,
	species: &quot;zubat&quot;,
	plural: &quot;zubats&quot;,
	mname: &quot;zubat&quot;,
	fname: &quot;zubat&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;blue&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [5,8,5,5,2,1],
	
	poisonType: true,
	flyingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;shrew&quot;,
	species: &quot;shroodle&quot;,
	plural: &quot;shroodles&quot;,
	mname: &quot;shroodle&quot;,
	fname: &quot;shroodle&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	tail: &quot;stubby tail&quot;,
	
	speciesStats: [6,7,4,5,3,2],
	
	poisonType: true,
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;gopher&quot;,
	species: &quot;bidoof&quot;,
	plural: &quot;bidoofs&quot;,
	mname: &quot;bidoof&quot;,
	fname: &quot;bidoof&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;cream&quot;, furHead: &quot;brown&quot;,
	
	speciesStats: [6,5,5,5,4,5],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;blackBear&quot;,
	species: &quot;bewear&quot;,
	plural: &quot;bewears&quot;,
	mname: &quot;bewear&quot;,
	fname: &quot;bewear&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;grey&quot;, furHead: &quot;pink&quot;,
	
	speciesStats: [7,0,6,0,12,20],
	
	normalType: true,
	fightingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;brownBear&quot;,
	article: &quot;an&quot;,
	species: &quot;ursaring&quot;,
	plural: &quot;ursarings&quot;,
	mname: &quot;ursaring&quot;,
	fname: &quot;ursaring&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	
	speciesStats: [7,0,4,2,12,20],
	
	normalType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;panda&quot;,
	species: &quot;pangoro&quot;,
	plural: &quot;pangoros&quot;,
	mname: &quot;pangoro&quot;,
	fname: &quot;pangoro&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	
	speciesStats: [7,0,4,2,12,20],
	
	fightingType: true,
	darkType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;polarBear&quot;,
	species: &quot;beartic&quot;,
	plural: &quot;beartics&quot;,
	mname: &quot;beartic&quot;,
	fname: &quot;beartic&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	
	speciesStats: [7,0,4,2,12,20],
	
	iceType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;bee&quot;,
	species: &quot;beedrill&quot;,
	plural: &quot;beedrills&quot;,
	mname: &quot;beedrill&quot;,
	fname: &quot;beedrill&quot;,
	furBack: &quot;black and yellow striped&quot;, furBelly: &quot;black and yellow striped&quot;, furHead: &quot;yellow&quot;,
	hand: &quot;hand stinger&quot;, hands: &quot;hand stingers&quot;,
	
	speciesStats: [8,7,5,5,0,0],
	
	bugType: true,
	poisonType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;wasp&quot;,
	species: &quot;combee&quot;, /* This might be a confusing choice, but in-game, it&#39;s the *wasp* enemies that seem to be in charge of making honey, not the bee enemies... */
	plural: &quot;combees&quot;,
	mname: &quot;combee&quot;,
	fname: &quot;vespiquen&quot;,
	furBack: &quot;black and yellow striped&quot;, furBelly: &quot;black and yellow striped&quot;, furHead: &quot;yellow&quot;,
	
	speciesStats: [8,1,8,8,0,0],
	
	bugType: true,
	flyingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;ant&quot;,
	article: &quot;a&quot;,
	species: &quot;durant&quot;,
	plural: &quot;durants&quot;,
	mname: &quot;durant&quot;,
	fname: &quot;durant&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	
	speciesStats: [9,9,5,2,0,0],
	
	bugType: true,
	flyingType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;hydra&quot;,
	species: &quot;hydreigon&quot;,
	plural: &quot;hydreigons&quot;,
	mname: &quot;hydreigon&quot;,
	fname: &quot;hydreigon&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;blue&quot;, furHead: &quot;blue&quot;,
	
	speciesStats: [5,5,4,6,5,5],
	
	dragonType: true,
	darkType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;snake&quot;,
	species: &quot;ekans&quot;,
	plural: &quot;ekans&quot;,
	mname: &quot;ekans&quot;,
	fname: &quot;ekans&quot;,
	furBack: &quot;purple&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;purple&quot;,
	
	speciesStats: [2,1,1,1,20,0],
	
	poisonType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;lizard&quot;,
	species: &quot;salandit&quot;, /* No good generic lizard mon, so go with something popular */
	plural: &quot;salandits&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;black&quot;,
	mname: &quot;salandit&quot;,
	fname: &quot;salazzle&quot;,
	
	speciesStats: [3,8,3,7,4,5],
	
	poisonType: true,
	fireType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;anacondaSpecies&quot;,
	article: &quot;a&quot;,
	species: &quot;sandaconda&quot;,
	plural: &quot;sandacondas&quot;,
	mname: &quot;sandaconda&quot;,
	fname: &quot;sandaconda&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;cream&quot;, furHead: &quot;cream&quot;,
	
	speciesStats: [2,0,3,0,20,0],
	
	groundType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;rhino&quot;,
	species: &quot;rhyhorn&quot;,
	plural: &quot;rhyhorns&quot;,
	mname: &quot;rhyhorn&quot;,
	fname: &quot;rhyhorn&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	
	speciesStats: [10,0,9,0,6,20],
	
	groundType: true,
	rockType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;hippo&quot;,
	species: &quot;hippowdon&quot;,
	plural: &quot;hippowdons&quot;,
	mname: &quot;hippowdon&quot;,
	fname: &quot;hippowdon&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;brown&quot;, furHead: &quot;black&quot;, /* male colouration */
	
	speciesStats: [7,0,7,3,8,30],
	
	groundType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;elephant&quot;,
	article: &quot;a&quot;,
	species: &quot;copperajah&quot;,
	plural: &quot;copperajahs&quot;,
	mname: &quot;copperajah&quot;,
	fname: &quot;copperajah&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;light green&quot;, furHead: &quot;green&quot;,
	
	speciesStats: [8,0,5,4,8,20],
	
	steelType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;meerkat&quot;,
	species: &quot;watchog&quot;,
	plural: &quot;watchogs&quot;,
	mname: &quot;watchog&quot;,
	fname: &quot;watchog&quot;,
	furBack: &quot;red and yellow striped&quot;, furBelly: &quot;red and yellow striped&quot;, furHead: &quot;red&quot;,
	
	speciesStats: [6,5,5,5,4,5],
	
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;chicken&quot;,	
	species: &quot;torchic&quot;,
	plural: &quot;torchics&quot;,
	mname: &quot;torchic&quot;,
	fname: &quot;torchic&quot;,
	angry: &quot;caw&quot;,
	furBack: &quot;orange&quot;, furBelly: &quot;orange&quot;, furHead: &quot;orange&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
    
	speciesHeight: 61,
	speciesStats: [8,5,4,8,0,0],
	
	fireType: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	id: &quot;parrot&quot;,
	article: &quot;a&quot;,
	species: &quot;chatot&quot;,
	plural: &quot;chatots&quot;,
	mname: &quot;chatot&quot;,
	fname: &quot;chatot&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;green&quot;, furHead: &quot;black&quot;,
	
	speciesStats: [3,8,5,8,1,0],
	
	flyingType: true,
})&gt;&gt;


/* Yeah, there&#39;s no direct replacement for a manticore, so screw trying */</tw-passagedata><tw-passagedata pid="127" name="pokemod patch and update" tags="pokemod" position="7000,900" size="100,100">&lt;&lt;set _modVersion = 1&gt;&gt; 

&lt;&lt;if $pokemod_saveVersion &lt; _modVersion&gt;&gt;
	&lt;&lt;set setup.modUpdated = true&gt;&gt; /* Flag that an update has happened */
	&lt;&lt;set setup.modUpdatedList.push(&quot;Pokemod&quot;)&gt;&gt; /* Add to list of updated mods */
	
	/* Update the recorded version in the save, so this doesn&#39;t happen again */
	&lt;&lt;set $pokemod_saveVersion = _modVersion&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* ALWAYS PATCH */
/* (core portion is already automatically applied) */
&lt;&lt;include &quot;pokemod core patch and update&quot;&gt;&gt;
&lt;&lt;include &quot;pokemod plus species&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="128" name="pokemod plus species" tags="pokemod" position="7100,1000" size="100,100">&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_lucario&quot;,	
	species: &quot;lucario&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;cream&quot;, furBelly: &quot;cream&quot;, furHead: &quot;blue&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [5,5,3,5,7,5],
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	fightingType: true,
	steelType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_riolu&quot;,	
	species: &quot;riolu&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;blue&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [5,5,3,5,7,5],
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	fightingType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_raichu&quot;,	
	species: &quot;raichu&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;yellow&quot;, furBelly: &quot;cream&quot;, furHead: &quot;yellow&quot;,
	tail: &quot;lightning bolt tail&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 58,
	speciesStats: [4,7,4,7,3,2],
	adjective: &quot;rodent&quot;,
	
	herbivore: true,
	electricType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_gardevoir&quot;,	
	species: &quot;gardevoir&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;green&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;spine&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 63,
	speciesStats: [3,6,4,10,2,0],
	adjective: &quot;humanoid&quot;,
	
	psychicType: true,
	fairyType: true,

	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_gallade&quot;,	
	species: &quot;gallade&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;green&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;spine&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 63,
	speciesStats: [8,6,6,3,2,0],
	adjective: &quot;humanoid&quot;,
	
	psychicType: true,
	fightingType: true,

	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;pokemod_eevee&quot;,	
	species: &quot;eevee&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [5,5,5,5,5,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	normalType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_vaporeon&quot;,	
	species: &quot;vaporeon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;headfins&quot;,
	tail: &quot;fishlike tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,3,10,8,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	aquatic: true,
	waterType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_jolteon&quot;,	
	species: &quot;jolteon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;yellow&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;yellow&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;spiky tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,10,3,8,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	electricType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_flareon&quot;,	
	species: &quot;flareon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;red&quot;, furHead: &quot;red&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [10,3,3,8,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	fireType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;pokemod_espeon&quot;,	
	species: &quot;espeon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;purple&quot;, furBelly: &quot;purple&quot;, furHead: &quot;purple&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;two-tipped tail&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,8,3,10,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	psychicType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;pokemod_umbreon&quot;,	
	species: &quot;umbreon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,3,10,8,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	darkType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_leafeon&quot;,	
	species: &quot;leafeon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;cream&quot;, furBelly: &quot;cream&quot;, furHead: &quot;cream&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;leafy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [10,8,3,3,1,3],
	
	adjective: &quot;canine&quot;,
	
	grassType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_glaceon&quot;,	
	species: &quot;glaceon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;light blue&quot;, furBelly: &quot;light blue&quot;, furHead: &quot;light blue&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,3,8,10,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	iceType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_sylveon&quot;,	
	species: &quot;sylveon&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;cream&quot;, furBelly: &quot;cream&quot;, furHead: &quot;pink&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,3,8,10,1,3],
	
	adjective: &quot;canine&quot;,
	
	carnivore: true,
	fairyType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_buneary&quot;,	
	species: &quot;buneary&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;cream&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;stubby tail&quot;,
	teeth: &quot;long teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [5,7,5,4,4,5],
	adjective: &quot;leporine&quot;,
	plural: &quot;bunearies&quot;,
	
	herbivore: true,
	normalType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_delphox&quot;,	
	species: &quot;delphox&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;white&quot;, furHead: &quot;yellow&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,7,3,7,5,3],
	adjective: &quot;vulpine&quot;,
	plural: &quot;delphoxes&quot;,
	
	carnivore: true,
	fireType: true,
	psychicType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_braixen&quot;,	
	species: &quot;braixen&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;yellow&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;yellow&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,7,3,7,5,3],
	adjective: &quot;vulpine&quot;,
	
	carnivore: true,
	fireType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_fennekin&quot;,	
	species: &quot;fennekin&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;yellow&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;yellow&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [3,7,3,7,5,3],
	adjective: &quot;vulpine&quot;,
	
	carnivore: true,
	fireType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_zoroark&quot;,	
	species: &quot;zoroark&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;red&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;mane&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [6,6,2,6,5,3],
	adjective: &quot;vulpine&quot;,
	
	carnivore: true,
	darkType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_zorua&quot;,	
	species: &quot;zorua&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;red&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;mane&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [6,6,2,6,5,3],
	adjective: &quot;vulpine&quot;,
	
	carnivore: true,
	darkType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_charmeleon&quot;,	
	species: &quot;charmeleon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;cream&quot;, furHead: &quot;red&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;flame-tipped tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [2,5,2,6,10,5],
	adjective: &quot;reptilian&quot;,
	carnivore: true,
	
	fireType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_charmander&quot;,	
	species: &quot;charmander&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;orange&quot;, furBelly: &quot;cream&quot;, furHead: &quot;orange&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;flame-tipped tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [2,5,2,6,10,5],
	adjective: &quot;reptilian&quot;,
	carnivore: true,
	
	fireType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_growlithe&quot;,	
	species: &quot;growlithe&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;black and orange striped&quot;, furBelly: &quot;black and orange striped&quot;, furHead: &quot;beige&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;mane&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [7,6,4,4,5,3],
	adjective: &quot;canine&quot;,
	carnivore: true,
	
	fireType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_rockruff&quot;,	
	species: &quot;rockruff&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;light brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;light brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [7,7,3,3,5,5],
	adjective: &quot;canine&quot;,
	carnivore: true,
	
	rockType: true,

	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_blaziken&quot;,	
	species: &quot;blaziken&quot;,
	angry: &quot;caw&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;red&quot;, furHead: &quot;cream&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 61,
	speciesStats: [8,5,4,8,0,0],
	adjective: &quot;avian&quot;,
	
	fireType: true,
	fightingType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_zangoose&quot;,	
	species: &quot;zangoose&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 56,
	speciesStats: [9,6,5,5,0,0],
	adjective: &quot;musteline&quot;,
	carnivore: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pokemod_goodra&quot;,	
	species: &quot;goodra&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;lavender&quot;, furBelly: &quot;purple&quot;, furHead: &quot;lavender&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 74,
	speciesStats: [5,2,8,5,5,5],
	adjective: &quot;draconic&quot;,
	dragon: true,
	
	dragonType: true,
	
	option: &quot;pokemodPlusEnabled&quot;,
})&gt;&gt;</tw-passagedata><tw-passagedata pid="129" name="species editor - load" tags="fixes-and-edits" position="7300,1400" size="100,100">Paste a saved species here to load it:
&lt;hr&gt;
&lt;&lt;set _input = &quot;&quot;&gt;&gt;

&lt;pre&gt;&lt;span id=&quot;speciesEditorLoadReport&quot;&gt;&lt;/span&gt;&lt;/pre&gt;

&lt;&lt;textarea &quot;_input&quot; &quot;&quot;&gt;&gt;

&lt;hr&gt;
[&lt;&lt;link &quot;Load&quot;&gt;&gt;
	&lt;&lt;script&gt;&gt;
    	try {
        	let species = JSON.parse(State.temporary.input);
            /* No sanity checks ATM - let&#39;s just go! */
            State.variables.species = species;
            Engine.play(&quot;species editor&quot;, true);
            Dialog.close();
        } catch (er) {
        	/* TODO- format error a lot better */
            document.getElementById(&quot;speciesEditorLoadReport&quot;).textContent = `Error loading species!`;
        }
    &lt;&lt;/script&gt;&gt;
&lt;&lt;/link&gt;&gt;]&lt;br&gt;
[&lt;&lt;link &quot;Close&quot;&gt;&gt;
	&lt;&lt;script&gt;&gt;
    	Dialog.close();
    &lt;&lt;/script&gt;&gt;
&lt;&lt;/link&gt;&gt;]</tw-passagedata><tw-passagedata pid="130" name="species editor - save" tags="fixes-and-edits" position="7200,1400" size="100,100">/* TODO - Make the formatting nicer */
/* TODO - Save to metadata? */
Save a copy of the following text in order to use your species later:
&lt;hr&gt;
&lt;&lt;set _output = JSON.stringify(_editingSpecies, null, &quot;\t&quot;)&gt;&gt;

&lt;pre&gt;&lt;span id=&quot;speciesEditorSaveJson&quot;&gt;&lt;/span&gt;&lt;/pre&gt;

/* I *think* this is needed in order to output text without any substitutions going on? */
&lt;&lt;script&gt;&gt;
$(document).one(&#39;:dialogopened&#39;, function (ev) {
	document.getElementById(&quot;speciesEditorSaveJson&quot;).textContent = State.temporary.output;
});
&lt;&lt;/script&gt;&gt;
&lt;hr&gt;
[&lt;&lt;link &quot;Copy&quot;&gt;&gt;
	&lt;&lt;script&gt;&gt;
    	navigator.clipboard.writeText(State.temporary.output);
    &lt;&lt;/script&gt;&gt;
&lt;&lt;/link&gt;&gt;]&lt;br&gt;
[&lt;&lt;link &quot;Close&quot;&gt;&gt;
	&lt;&lt;script&gt;&gt;
    	Dialog.close();
    &lt;&lt;/script&gt;&gt;
&lt;&lt;/link&gt;&gt;]</tw-passagedata><tw-passagedata pid="131" name="species editor - stats" tags="fixes-and-edits" position="7200,1300" size="100,100">/* Included as part of the species editor during character generation, for editing the base stats of the species */

&lt;b&gt;&lt;u&gt;Edit Base Stats&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
Here you can edit the base stats of your species.&lt;br&gt;
&lt;u&gt;Main Stat Bonuses&lt;/u&gt;&lt;br&gt;
&lt;i&gt;&lt;b&gt;&lt;span id=&quot;remainingPoints&quot;&gt;Points remaining: 0&lt;/span&gt;&lt;/b&gt;&lt;/i&gt;&lt;br&gt;
&lt;li&gt;&lt;label&gt;Strength: &lt;&lt;numberbox &quot;_editingSpecies.speciesStats[0]&quot; _editingSpecies.speciesStats[0]&gt;&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;Agility: &lt;&lt;numberbox &quot;_editingSpecies.speciesStats[1]&quot; _editingSpecies.speciesStats[1]&gt;&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;Endurance: &lt;&lt;numberbox &quot;_editingSpecies.speciesStats[2]&quot; _editingSpecies.speciesStats[2]&gt;&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;Intelligence: &lt;&lt;numberbox &quot;_editingSpecies.speciesStats[3]&quot; _editingSpecies.speciesStats[3]&gt;&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;Stomach size: &lt;&lt;numberbox &quot;_editingSpecies.speciesStats[4]&quot; _editingSpecies.speciesStats[4]&gt;&gt;&lt;/label&gt;&lt;/li&gt;
&lt;u&gt;Other Stats&lt;/u&gt;&lt;br&gt;
&lt;li&gt;&lt;label&gt;Starting height: &lt;&lt;numberbox &quot;_editingSpecies.speciesHeight&quot; _editingSpecies.speciesHeight&gt;&gt; inches &lt;span id=&quot;heightExplain&quot;&gt;(&lt;&lt;sayDistance _editingSpecies.speciesHeight&gt;&gt;)&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;Extra starting fat: &lt;&lt;numberbox &quot;_editingSpecies.speciesStats[5]&quot; _editingSpecies.speciesStats[5]&gt;&gt;&lt;/label&gt;&lt;/li&gt;

&lt;&lt;script&gt;&gt;
const statInfo = {
	str: {statId: &quot;str&quot;, elementId: &quot;#numberbox--editingspeciesspeciesstats0&quot;, index: 0,},
	agi: {statId: &quot;agi&quot;, elementId: &quot;#numberbox--editingspeciesspeciesstats1&quot;, index: 1,},
	end: {statId: &quot;end&quot;, elementId: &quot;#numberbox--editingspeciesspeciesstats2&quot;, index: 2,},
	int: {statId: &quot;int&quot;, elementId: &quot;#numberbox--editingspeciesspeciesstats3&quot;, index: 3,},
	sto: {statId: &quot;sto&quot;, elementId: &quot;#numberbox--editingspeciesspeciesstats4&quot;, index: 4,},
	fat: {statId: &quot;fat&quot;, elementId: &quot;#numberbox--editingspeciesspeciesstats5&quot;, variable: 5,},
	height: {statId: &quot;height&quot;, elementId: &quot;#numberbox--editingspeciesspeciesheight&quot;, variable: &quot;speciesHeight&quot;,},
};

const mainStats = [&quot;str&quot;, &quot;agi&quot;, &quot;end&quot;, &quot;int&quot;, &quot;sto&quot;];

function getPointsSpent() {
	let spentCount = 0;
	
	for (const [key, value] of Object.entries(statInfo)) {
		/* Only care about main stats */
		if ( mainStats.includes(value.statId) == false ) {
			continue;
		}
		
		spentCount += State.temporary[&quot;editingSpecies&quot;].speciesStats[value.index]
	}
	
	return spentCount;
}

function updateRemainingPointCount() {
	$.wiki(`&lt;&lt;replace &quot;#remainingPoints&quot;&gt;&gt;Points remaining: ${setup.tuning(&quot;speciesStatsPoints&quot;) - getPointsSpent()}&lt;&lt;/replace&gt;&gt;`);
}

function updateHeightExplain(height) {
	$.wiki(`&lt;&lt;replace &quot;#heightExplain&quot;&gt;&gt;(&lt;&lt;sayDistance ${height}&gt;&gt;)&lt;&lt;/replace&gt;&gt;`);
}

function onStatChanged(stat, newValue) {
	newValue = Math.floor(newValue); /* prevent players from entering floats */
	if ( newValue &lt; 0 ) { newValue = 0 }; /* prevent player from entering negatives */
	
	let isMainStat = mainStats.includes(stat);
	
	if ( isMainStat || stat == &quot;fat&quot; ) {
		if ( isMainStat ) {
			let oldValue = State.temporary[&quot;editingSpecies&quot;].speciesStats[statInfo[stat].index] ;
			
			/* Clamp new values */
			newValue = Math.clamp(newValue, setup.tuning(&quot;speciesStartStatMin&quot;), setup.tuning(&quot;speciesStartStatMax&quot;));
			
			/* Can the player even afford to do this? */
			let increased = ( newValue &gt; oldValue );
			let pointsRemaining = setup.tuning(&quot;speciesStatsPoints&quot;) - getPointsSpent();
			
			if ( increased &amp;&amp; pointsRemaining &lt;= 0 ) {
				/* Negate the change */
				newValue = oldValue;
			} else if ( increased ) {
				/* Cap how much can increase by based on remaining points */
				newValue = Math.clamp(newValue, setup.tuning(&quot;speciesStartStatMin&quot;), oldValue + pointsRemaining);
			}
		} else if ( stat == &quot;fat&quot; ) {
			newValue = Math.clamp(newValue, setup.tuning(&quot;speciesStartFatMin&quot;), setup.tuning(&quot;speciesStartFatMax&quot;));
		}
		/* Update the variable manually */
		State.temporary[&quot;editingSpecies&quot;].speciesStats[statInfo[stat].index] = newValue;
		
	} else if ( stat == &quot;height&quot; ) {
		newValue = Math.clamp(newValue, setup.tuning(&quot;playerHeightMin&quot;), setup.tuning(&quot;playerHeightMax&quot;));
		
		State.temporary.editingSpecies[statInfo.height.variable] = newValue;
		
		updateHeightExplain(newValue);
	}
	
	/* Manually update values */
	$(statInfo[stat].elementId).val(newValue);
	
	if ( isMainStat ) {
		updateRemainingPointCount();
	}
}

$(document).ready(function() {
  $(&#39;#numberbox--editingspeciesspeciesstats0&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;str&quot;, $(this).val());
  });
	$(&#39;#numberbox--editingspeciesspeciesstats1&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;agi&quot;, $(this).val());
  });
	$(&#39;#numberbox--editingspeciesspeciesstats2&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;end&quot;, $(this).val());
  });
	$(&#39;#numberbox--editingspeciesspeciesstats3&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;int&quot;, $(this).val());
  });
	$(&#39;#numberbox--editingspeciesspeciesstats4&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;sto&quot;, $(this).val());
  });
	$(&#39;#numberbox--editingspeciesspeciesstats5&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;fat&quot;, $(this).val());
  });
	$(&#39;#numberbox--editingspeciesspeciesheight&#39;).on(&#39;input&#39;, function() {
    onStatChanged(&quot;height&quot;, $(this).val());
  });
});
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="132" name="species editor - terms" tags="fixes-and-edits" position="7300,1300" size="100,100">/* Contains all the text boxes etc. for editing a species as part of the species editing process */
&lt;b&gt;&lt;u&gt;Edit Descriptions&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
You can use the text boxes below to change your descriptions. Or just leave them as is.&lt;br&gt;&lt;br&gt;

What you are: &lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.article&quot; _editingSpecies.article&gt;&gt;
&lt;&lt;textbox &quot;_editingSpecies.species&quot; _editingSpecies.species&gt;&gt;
&lt;br&gt;Plural form of your species:  &lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.plural&quot; _editingSpecies.plural&gt;&gt;

&lt;br&gt;Masculine name of your species (if there&#39;s a difference):  &lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.mname&quot; _editingSpecies.mname&gt;&gt;

&lt;br&gt;Feminine name of your species (if there&#39;s a difference):  &lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.fname&quot; _editingSpecies.fname&gt;&gt;

&lt;br&gt;Adjective to describe your species (like &quot;feline&quot;):  &lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.adjective&quot; _editingSpecies.adjective&gt;&gt;

&lt;br&gt;How you yell:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.angry&quot; _editingSpecies.angry&gt;&gt;

&lt;br&gt;The things you walk around on (singular/plural):&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.foot&quot; _editingSpecies.foot&gt;&gt;
&lt;&lt;textbox &quot;_editingSpecies.feet&quot; _editingSpecies.feet&gt;&gt;

&lt;br&gt;The things you grab stuff with (singular/plural):&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.hand&quot; _editingSpecies.hand&gt;&gt;
&lt;&lt;textbox &quot;_editingSpecies.hands&quot; _editingSpecies.hands&gt;&gt;

&lt;br&gt;The stuff you&#39;re covered in (different adjective forms):&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.fur&quot; _editingSpecies.fur&gt;&gt;
&lt;&lt;textbox &quot;_editingSpecies.furred&quot; _editingSpecies.furred&gt;&gt;
&lt;&lt;textbox &quot;_editingSpecies.furry&quot; _editingSpecies.furry&gt;&gt;

&lt;br&gt;The color of your back:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.furBack&quot; _editingSpecies.furBack&gt;&gt;

&lt;br&gt;The color of your belly:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.furBelly&quot; _editingSpecies.furBelly&gt;&gt;

&lt;br&gt;The color of your head:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.furHead&quot; _editingSpecies.furHead&gt;&gt;

&lt;br&gt;The stuff you&#39;ve got on top of your head:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.hair&quot; _editingSpecies.hair&gt;&gt;

&lt;br&gt;The thing you use to talk:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.mouth&quot; _editingSpecies.mouth&gt;&gt;

&lt;br&gt;What you chew stuff with:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.teeth&quot; _editingSpecies.teeth&gt;&gt;

&lt;br&gt;What kind of tail you may or may not have:&lt;br&gt;
&lt;&lt;textbox &quot;_editingSpecies.tail&quot; _editingSpecies.tail&gt;&gt;</tw-passagedata><tw-passagedata pid="133" name="temp test" tags="" position="6600,1300" size="100,100">/*&lt;script&gt;
	$.wiki(&quot;&lt;&lt;damage 1&gt;&gt;&quot;)
&lt;/script&gt;*/

/*&lt;&lt;run console.log(JSON.stringify(State.variables.spells))&gt;&gt;*/
/*&lt;&lt;run console.log(JSON.stringify(setup.getSpell(&quot;heal1&quot;)))&gt;&gt;*/

&lt;&lt;run console.log(`p.height = ${variables().p.height}`)&gt;&gt;
&lt;&lt;run console.log(`bheight = ${variables().bheight}`)&gt;&gt;

&lt;&lt;run console.log(`Player spells = ${JSON.stringify(variables().spells)}`)&gt;&gt;

/*&lt;&lt;run
	for ( const [id, spell] of Object.entries(setup.spells) ) {
		if ( spell.core ) {
			console.log(JSON.stringify(State.variables[id]));
		}
	}&gt;&gt;*/</tw-passagedata><tw-passagedata pid="134" name="Buried treasure" tags="beach" position="775,1150" size="100,100">You notice a glint on the sea floor, which stops your swimming around. You dive down for a better look, and you can see something peeking out of the sand, but it’s too deeply buried to be identifiable. 

&lt;&lt;action &quot;c&quot; &quot;inventory&quot; &quot;Grab buried treasure&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;ocean&quot; &quot;Leave buried treasure&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="135" name="Buy from beach vendor" tags="beach" position="1225,800" size="100,100">//&quot;Alriiiight!&quot;// $npc1.He cheers, abrupty slapping a broad green leaf over your face. You quickly pull it away, to find that the $npc1.species is now standing at a little booth of crude design, but there is a very alluring spread of seafood within $npc1.his reach, razor-sharp cutlery, and somehow even a pot of boiling oil. &quot;Oh, teeeeensy warning? Let&#39;s just say...my portions are a little more filling than they look. Twice the taste with a lot less chewing!&quot; $npc1.He thumps his chest proudly. &quot;So, what&#39;ll it be?&quot; $npc1.He asks, gesturing to a yellowed menu written in expert penmanship. 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;beach&quot; &quot;Done&quot; &quot;Goodbye beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;if setup.questStarted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;How do you make your food so filling?&quot; &quot;Questioning the beachside chef&quot;&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;beach&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;elseif setup.questStarted($feeder_questRaccoonCook) == true and setup.questCompleted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Try my food!&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;beach&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;elseif setup.questStarted($feeder_questRaccoonFeast) == true and setup.questCompleted($feeder_questRaccoonFeast) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Attempt the feast (100 Gold)&quot; &quot;Seaside Feast&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;beach&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */</tw-passagedata><tw-passagedata pid="136" name="Buy from ocean vendor" tags="beach" position="650,1025" size="100,100">You pull yourself from the water onto the open deck, starting to drip-dry. The $npc1.species smiles at you as you take a seat, putting down $npc1.his knives and leaning over the counter, pointing to an old, but well-penned menu. &quot;Just tell me what ya want, and its yours! But I gotta warn ya, this stuff may be small, but it&#39;s more filling than it looks&quot; $npc1.He gestures to the steadily-growing $npc2.species, lowering his voice. &quot;$npc2.He didn&#39;t look like that four hours ago.&quot; 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;ocean&quot; &quot;Done&quot; &quot;Goodbye ocean vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;if setup.questStarted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;How do you make your food so filling?&quot; &quot;Questioning the beachside chef&quot;&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;ocean&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;elseif setup.questStarted($feeder_questRaccoonCook) == true and setup.questCompleted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Try my food!&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;ocean&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;elseif setup.questStarted($feeder_questRaccoonFeast) == true and setup.questCompleted($feeder_questRaccoonFeast) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Attempt the feast (100 Gold)&quot; &quot;Seaside Feast&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;ocean&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */</tw-passagedata><tw-passagedata pid="137" name="Captured at buried treasure" tags="beach" position="650,1275" size="100,100">&lt;&lt;set _species = either($shark, $orca, $dolphin)&gt;&gt;
&lt;&lt;createNPC _species &quot;random&quot; 1&gt;&gt;

A shadow from behind you makes you pause and turn around. Behind you is a rather primal-looking anthro $npc1.species in a crude wetsuit, holding a length of rope. $npc1.He reaches through the bars, grabbing your arms and despite your struggling, ties them up behind your back. $npc1.He opens the cage and reaches in to grab you, but you try to swim away, which is a bit difficult considering your bindings. $npc1.He rolls $npc1.his eyes before picking up the cage and smacking you over the head with it, knocking you unconscious. 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait...&quot; &quot;Eaten by the orca&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="138" name="Eaten by the orca" tags="beach" position="525,1275" size="100,100">&lt;&lt;createNPC $orca &quot;random&quot; 2&gt;&gt;
&lt;&lt;setPassageTitle &quot;Eaten by $orca.article $orca.species&quot;&gt;&gt;

&lt;p&gt;You later awake, looking up at what looks like a woven seaweed canvas. You crane your neck and look around, and can just about see that you’re in some sort of underwater village, with several mined-out boulders making up the buildings. You try to move further, but realise you’re wrapped up in seaweed, making movement impossible. You’re just about to struggle before you hear two people conversing in a weird, unknown language right next to you. You strain your neck in the other direction to look at the two – There’s the $npc1.species that captured you and a heavily obese anthro $orca.species. The $orca.species points at you and holds out $npc2.his hand, dropping a large pile of coins into the $npc1.species’s hand. The $orca.species grins at you, grabbing and stuffing you under one of $npc2.his arms before you see $npc2.him picking up another bound and worried-looking anthro from where you were lying before. One look at where you were puts everything together – you can see you were on a stall that’s selling live, land-walking creatures, all of which are wrapped up! &lt;/p&gt;

The fact that the $orca.species is looking at you two and licking $npc2.his lips kind of hints at just why the person’s catching and selling land-dwellers like you. $npc2.He begins pushing you headfirst into $npc2.his cavernous mouth, and try as you might, the woven seaweed bindings you’re wrapped in are far too strong to break out of. The $orca.species purrs in delight as $npc2.he licks at you a few times, savouring your flavour before $npc2.he pushes you in completely and swallows, barely taking the time to breathe before cramming the other anthro in. You hear a loud belch from outside as your confines become more cramped, before you hear more talking and more money changing hands, before more loud gulping heralds a third and fourth meal joining you. The $orca.species’s midway through ordering fifths and sixths before the cramped conditions and warmth get too much for you and you pass out. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="139" name="Escape buried treasure" tags="beach" position="525,1150" size="100,100">You punch and kick at the wooden beams imprisoning you. 
&lt;&lt;set $eventCounterA -= $str&gt;&gt;

&lt;&lt;if $eventCounterA &gt; 0&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 3&gt;&gt;
They’re sturdy, and while they do splinter, they don’t give way. 
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Escape buried treasure&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB--&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 2&gt;&gt;
You make some more head way, but you still can&#39;t quite get free. 
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Escape buried treasure&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB--&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 1&gt;&gt;
You give one final kick attempting to break free of your entrapment. 
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Escape buried treasure&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB--&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&lt;&lt;include &quot;Captured at buried treasure&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;else&gt;&gt;
As you attack them they splinter and eventually break. You quickly swim away from the trap. You realise you’re still holding the box, but you can already see it’s open and empty. Cursing, you toss it aside and swim away. 

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="140" name="Escape the sirens" tags="beach" position="800,525" size="100,100">&lt;p&gt;The creatures singing to you are beautiful, operatically-built mermaids, with silvery fish-tails joined to their hour-glass hips where their lower limbs would be on a land-dwelling animal. Their voices are almost painfully sweet, and the sound is almost hypnotic. They seem very, very keen for you to join them for a feast... &lt;/p&gt;

The Sirens raise their voices even further and sing out, the wonderfully enchanting music booming against the rocks and over the sound of the waves. You can&#39;t make out any words, but the sound resonates in the pit of your stomach, and it fills your mind with visions and scents of all the finest, tastiest foods that you can imagine. Your mouth starts to water uncontrollably. You&#39;ve never felt this hungry- their song makes you want to eat until you&#39;re &lt;&lt;print either(&quot;full to the brim&quot;, &quot;stuffed to the ears&quot;, &quot;too full to move&quot;, &quot;bursting out of your clothes&quot;, &quot;ready to explode&quot;)&gt;&gt;. You can feel your resistance weakening. 


&lt;&lt;action &quot;w&quot; &quot;run&quot; &quot;Resist&quot; &quot;Resist the sirens&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 3&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;surrender&quot; &quot;Surrender&quot; &quot;Surrender to the sirens&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="141" name="Escaped from the sirens" tags="beach" position="750,275" size="100,100">With a burst of effort you swim frantically for shore, and finally feel that current loosen its grip on you. You shoot forward, the mist around you thinning until you&#39;re in clear blue sea again, with that island retreating into the distance just as fast as you can swim. You can still hear the voices of the sirens, getting shriller and shriller as they attempt to call you back, a note of anger and frustration now audible in them as you cheat them of their fun. The compulsion to return to their island finally subsides, and you feel free to go on your way. Maybe next time, ladies... 
&lt;&lt;stamina -40&gt;&gt;
&lt;&lt;doXP 20&gt;&gt;

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="142" name="Find seaweed" tags="beach" position="775,1025" size="100,100">&lt;p&gt;As you plough your way through the water, you find yourself swimming into a bed of seaweed growing from a rocky outcrop. Through the crystal-clear water you watch fish and crustaceans darting between the fronds, with a few brightly-coloured clownfish nibbling on them. Just then a large, ugly-looking catfish swims out of the wide blue yonder and makes to gulp one of these bright little critters up. Its jaws clamp around the tailfin, and the little clownfish paddles frantically to escape. To your astonishment you watch as its tailfin stretches like rubber, and when the catfish opens its jaws to take another bite, the little fish //PINGS// into the safety of the kelp. &lt;/p&gt;

Curiously, you dive down, frightening off the catfish as you go. Grabbing hold of some fronds you tug at them, and watch them stretch sluggishly rather than break. Treading water you take a firmer hold and //HEAVE//, kicking your legs furiously as you do so. The fronds stretch and this time a few //SNAP//, sending you into an ungainly backwards somersault that leaves you floating upside down, clutching a handful of seaweed. 

&lt;&lt;getItem $stretchySeaweed&gt;&gt;
&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="143" name="Goodbye ocean vendor" tags="beach" position="525,1025" size="100,100">&quot;See ya &#39;round&quot; $npc1.He gives a curt half-bow as you depart, leaning back and starting to munch down on a few of $npc1.his own treats. 

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="144" name="Grab buried treasure" tags="beach" position="650,1150" size="100,100">&lt;&lt;if random(1,2) == 1&gt;&gt;
You swim down further, reaching forward and tugging the object out – it seems to be a small crate of some description. 
&lt;&lt;if random(1,4) == 1&gt;&gt;&lt;&lt;getItem $treasureChest&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $sandyBox&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

You swim down further, reaching forward and tugging the object out.... But when you do, a horrible clunking noise rings out through the water before the sand around you shudders and a wooden cage hidden under it flips up on all sides and slams shut. You’re trapped! 
&lt;&lt;set $eventCounterA = random(120,180)&gt;&gt;
&lt;&lt;set $eventCounterB = 3&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Escape buried treasure&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;surrender&quot; &quot;Give up&quot; &quot;Captured at buried treasure&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="145" name="Leave buried treasure" tags="beach" position="775,1275" size="100,100">You figure if something is too good to be true, it probably is. You swim by, ignoring the object. 

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="146" name="Leave ocean vendor" tags="beach" position="650,900" size="100,100">&quot;You&#39;re missin&#39; out!&quot; $npc1.He says, shrugging. &quot;Maybe another time.&quot; And with a quiet //plunk//, you slip back into the water. 

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="147" name="Lost to the sirens" tags="beach" position="875,275" size="100,100">&lt;&lt;if !$options.females&gt;&gt;&lt;&lt;createNPC $p &quot;male&quot; 1&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;createNPC $p &quot;female&quot; 1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;You wake up slowly, finding yourself laying sprawled on the beach, belly up. There&#39;s the murmur of musical voices all around you, and you feel amazingly comfortable. You stretch lazily, then flop back peacefully onto the pebbles- absolutely NOTHING could persuade you to move from this spot. Gazing around you sleepily, you see that you&#39;re not alone- you&#39;re now amongst the figures you saw from the ocean. Each has a mermaid or –male by their side, and as you watch you can&#39;t help but think that they&#39;re all slowly putting on weight. A panda with salt-bleached fur laying a little way away looks absolutely gargantuan, his body more boulder-like than anything, while the otter blissfully rubbing his belly a little further away is starting to look downright obese. &lt;/p&gt;

&lt;p&gt;Just then, 
&lt;&lt;if !$options.females&gt;&gt;a heftily-handsome $npc1.species mer-male with chunky features approaches you. Looking down at you, $npc1.he opens $npc1.his mouth and begins to sing to you in a thrumming baritone. 
&lt;&lt;else&gt;&gt;an extremely pretty $npc1.species mermaid with a lovely curvaceous figure approaches you. Looking down at you, $npc1.he opens $npc1.his mouth and begins to sing to you in a sweet contralto. 
&lt;&lt;/if&gt;&gt;

Immediately your mind fills with thoughts of food, the most delicious food you&#39;ve ever tasted, and as much as you could possibly eat. You stifle a small groan and feel your jaw go slack in pleasure. You can actually taste all that wonderful food, a feast to end all feasts. Putting your hands to your stomach, you dreamily realise that it&#39;s starting to feel a little bigger. Well, you tell yourself- ANYONE who ate food THIS good would find themselves putting on weight. &lt;/p&gt;

Now completely under $npc1.his spell, you lay there quite helplessly, dreaming of eating, and eating, and EATING. As you do so, you begin growing fatter, and fatter, and fatter under the magical influence, your butt spreading beneath you, your sides rolling out over the shingle, and your increasingly doughy arms and legs spreading out wide. Pretty soon you&#39;re spread-eagled on the beach like the rest of them, pinned beneath an absolutely huge belly, and you&#39;re STILL growing. You woozily glance back over at the panda and the otter, but all you can see where they were laying now are huge, smooth boulders, that look vaguely like sprawled, vastly-obese animals if you half-close your eyes and squint. It&#39;s hard to only half-close your eyes, though- you&#39;re starting to feel enormously full and sleepy. Besides, your stomach is blocking almost ALL of the view now. So your eyes shut all the way, even your eyelids having apparently put on weight. You drift off into a bloated sleep with the mer&lt;&lt;if !$options.females&gt;&gt;man&lt;&lt;else&gt;&gt;maid&lt;&lt;/if&gt;&gt; still singing to you, dreaming of yet more food... 
&lt;&lt;stuffToBursting&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; 4000&gt;&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="148" name="Raccoon ocean vendor" tags="beach" position="775,900" size="100,100">&lt;&lt;createFixedNPC &quot;beachVendor&quot;&gt;&gt;
&lt;&lt;createNPC $otter &quot;random&quot; 2&gt;&gt;

&lt;&lt;setPassageTitle &quot;&lt;&lt;=$npc1.species.toUpperFirst()&gt;&gt; ocean vendor&quot;&gt;&gt;

&lt;p&gt;Swimming along, you notice something floating on the surface a good distance away. Pushing forward, you surface to find a little boat shop lazily bobbing in the water. There&#39;s a small bar and a few stools, one of which is straining under the weight of a very ample $npc2.species. Behind the counter stands a pleasant-looking $npc1.species, calmly sharpening a rather fine looking piece of cutlery. Bright and beautiful specimens of seafood and produce fill the space behind $npc1.him, and you can see crates full of sizeable crustaceans floating in the water around the boat. &lt;/p&gt;

&quot;Well, ya comin up for a bite or not?&quot; The bare-chested $npc1.species asks, not glancing up from $npc1.his work. 

&lt;&lt;vendor &quot;ocean raccoon&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;Buy from ocean vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;ocean&quot; &quot;Leave&quot; &quot;Leave ocean vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;if setup.questStarted($feeder_questRaccoonCook) == true and setup.questCompleted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Try my food!&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;ocean&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;elseif setup.questStarted($feeder_questRaccoonFeast) == true and setup.questCompleted($feeder_questRaccoonFeast) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Attempt the feast (100 Gold)&quot; &quot;Seaside Feast&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;ocean&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */</tw-passagedata><tw-passagedata pid="149" name="Resist the sirens" tags="beach" position="750,400" size="100,100">&lt;p&gt;&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 3&gt;&gt;
Cold sea water splashes into your face, and you partially come to your senses. Flipping over in the foggy ocean, you begin to swim away from the island, but find that the &#39;helpful&#39; current is suddenly dead against you leaving. You have to swim hard to make any headway at all. 
&lt;&lt;stamina -40&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;&lt;set _cost = setup.staminaCost(40)&gt;&gt;

You plough through the water with 
&lt;&lt;if _cost &gt; 33&gt;&gt;slow and feeble strokes, against the tide, making slow 
&lt;&lt;elseif _cost &gt; 22&gt;&gt;reasonably strong strokes, against the tide, making reasonable 
&lt;&lt;else&gt;&gt;strong and powerful strokes, against the tide, making good 
&lt;&lt;/if&gt;&gt;
headway away from the island. Through the thickening fog you can make out the shore of the mainland, but that haunting music is willing you to just stop swimming and let the tide drag you back to the island. You dunk your head in the water to drown out the sound, but you can still hear it. 
&lt;&lt;stamina -40&gt;&gt;

&lt;&lt;case 1&gt;&gt;
Starting to tire, you keep swimming doggedly away from the island. Although the fog is starting to thin, the water is turning choppier, incoming waves lifting you up and swooping you back down again. It&#39;s getting harder to swim through, and somehow you think that that&#39;s not entirely coincidence... 
&lt;&lt;stamina -40&gt;&gt;

&lt;&lt;/switch&gt;&gt;&lt;/p&gt;

&lt;&lt;if $sta &lt;= 0&gt;&gt;

&lt;p&gt;Your frantic paddling slows to a stop- you&#39;re just too tired to fight against the current any more, and the more you hear that lovely music, you realise that you no longer WANT to. The tide carries you quickly back to the island as you float helplessly, belly-down, and a wave dumps you, fairly gently, on the shore. You slowly heave yourself to your $p.feet and stagger a few feet up from the shoreline, surrounded by that sweet music, which is now humming to you like a lullaby. Maybe after... a short nap you... be able to... get aw... &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;if $eventCounterA &gt; 1&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Keep swimming&quot; &quot;Resist the sirens&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA--&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Almost there&quot; &quot;Escaped from the sirens&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep...&quot; &quot;Lost to the sirens&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="150" name="Sirens" tags="beach" position="800,775" size="100,100">&lt;&lt;setPassageTitle &quot;Mysterious figures&quot;&gt;&gt;

Swimming through the water, your eye is caught by a small, rocky, offshore island in the distance, made indistinct by a mist clinging around it. Swimming a little closer, you can make out a number of indistinct figures laying near the water&#39;s edge. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Investigate&quot; &quot;investigate sirens&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;ocean&quot; &quot;Leave&quot; &quot;leave sirens&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="151" name="Surrender to the sirens" tags="beach" position="875,400" size="100,100">You never believed in fairy-tales. Listening to your stomach, you dreamily decide &#39;what harm can it do?&#39;, and start paddling towards the island shore, much to the pleasure of the mer-folk. The current sweeps you on towards the island, and the song of the Sirens grows louder and louder around you, until you can practically TASTE the feast awaiting you. You feel your $waist stomach scraping pebbles in the shallow water, and scramble to your feet, wading onto the stony shore, the enchanting, delicious-sounding music all around you. Phew.. that swim has REALLY left you tired. Hang on &lt;&lt;if !$options.females&gt;&gt;guys&lt;&lt;else&gt;&gt;girls&lt;&lt;/if&gt;&gt;, just a... short rest and... and then... you&#39;ll be ready for that meal... 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait...&quot; &quot;Lost to the sirens&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="152" name="investigate sirens" tags="beach" position="725,650" size="100,100">&lt;&lt;setPassageTitle &quot;Investigate the figures&quot;&gt;&gt;

&lt;p&gt;You swim a little closer, aided by a helpful current. You&#39;re beginning to enter the fog, but you can see the island more clearly now. Even at this distance, you can&#39;t help but notice that some of the animals on the beach look remarkably... Rubenesque. It looks like they&#39;re being attended to by a number of smaller figures, which move with the rather jerky motion of seals. As the current carries you even closer, you have trouble believing your eyes. The smaller figures look like mermaids! They have the long, flexible tails of fish, but their upper bodies are those of land-dwelling animals- well, except for the remarkably statuesque female $orca.species you can see. While most are beautiful- if somewhat curvaceous- females, you can also see a couple of extremely handsome, rather chunky mer-males, as well. 
&lt;/p&gt;

&lt;p&gt;Just then, on the rocky outcrop closest to you, a head pops into view. She&#39;s $p.article $p.species, just like you, though you&#39;d be willing to be she&#39;s sporting a fish-tail. She gazes lazily down at you with long, silvery eyelashes, and smiles. Then she opens her mouth, and starts to sing in the sweetest voice you&#39;ve ever head- it makes you think of honey and apple. The other mermaids on the beach look up, and join in the singing. Their voices echo around the rocks, and so you only catch vague snatches of the words while the sweet music tickles your ears. 
&lt;/p&gt;

&quot;...Come stranger... island of plenty... all you could ever want... come... eat... COME... EAT...&quot; Suddenly you realise how amazingly hungry you are, and you immediately begin paddling toward the island before something inside warns you- this doesn&#39;t feel normal. 

&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Escape the sirens&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="153" name="leave sirens" tags="beach" position="850,650" size="100,100">&lt;&lt;setPassageTitle &quot;Swim away&quot;&gt;&gt;

Feeling rather nervous for some reason, as quietly as you can, you turn around in the water and swim determinedly away until the foggy island is entirely out of sight. 

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="154" name="Beach" tags="beach" position="1275,1350" size="100,100">Rolling white sand dunes stretch out to the horizon where they&#39;re overtaken by rocky cliffs. Behind the dunes stand long lines of coconut trees weighed down by enormous coconuts. The soft whispering of gentle waves lapping across the shore as well as the subtle sea breeze coming from the ocean make the beach seem very peaceful. 

&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="155" name="Beach rest" tags="beach" position="1275,1225" size="100,100">You find a comfortable spot to sit down and rest. 
&lt;&lt;rest&gt;&gt;

&lt;&lt;if random(1,5) == 1&gt;&gt;
	&lt;&lt;set _enemy = either($sandSnake, $waterElemental)&gt;&gt;
	&lt;&lt;setEnemy _enemy&gt;&gt;
	You are awoken from your sleep by $e.article $e.name! 
	&lt;&lt;startCombat&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="156" name="Goodbye beach vendor" tags="beach" position="1300,675" size="100,100">&quot;See ya &#39;round&quot; $npc1.He gives a curt half-bow as you depart, leaning back and starting to munch down on a few of $npc1.his own treats. 

&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="157" name="Hydra attack" tags="beach" position="1050,925" size="100,100">&lt;&lt;setPassageTitle &quot;Commotion on the beach&quot;&gt;&gt;
As you walk along the shore you hear a commotion near the water’s edge which has gathered a crowd. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Investigate&quot; &quot;Investigate Hydra&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;beach&quot; &quot;Leave&quot; &quot;Leave Hydra&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="158" name="Investigate Hydra" tags="beach" position="975,800" size="100,100">&lt;&lt;setPassageTitle &quot;Investiage the commotion&quot;&gt;&gt;

As you approach the water, you notice a dark shape from under the surface. You are about to ask what’s going on, when all of a sudden a colossal shape bursts from the deeps. As the mist clears you can make out a huge sand-coloured creature’s back and more noticeably three huge necks with large reptilian heads at the ends gazing at the crowd before roaring and snapping down, grabbing three anthros from the crowd and swallowing them. The crowd screams and scatters, running away as the &lt;&lt;=setup.getSpeciesData(&quot;hydra&quot;).species&gt;&gt; turns its three separate gazes upon you. 

&lt;&lt;startCombat $hydra&gt;&gt;</tw-passagedata><tw-passagedata pid="159" name="Investigate sand mound" tags="beach" position="1475,800" size="100,100">You walk over to the patch of sand and start digging with your $p.hands. 

&lt;&lt;set _chance = random(1,100)&gt;&gt;

/*===Treasure chest===*/
&lt;&lt;if _chance &gt; 85&gt;&gt;
  After a small amount of digging, your hand collides with something metallic. You brush the sand aside and see the top of a beautiful treasure chest. 

  &lt;&lt;if $str &gt; 40&gt;&gt;You brace yourself in the hole, gripping the chest as hard as possible and pulling. After a few moments it slides free. As it comes loose, you can hear something jingling inside. You pick it up carefully and stow it for when you’re ready to open it. 

  &lt;&lt;else&gt;&gt;You tug at the chest, but it won’t budge. Looking around, you find a sturdy stick nearby and climb back into the hole, wedging it in between the chest and the sand, and after a hard push, you manage to crowbar it free. As it comes loose, you can hear something jingling inside. You pick it up carefully and stow it for when you’re ready to open it. 
  &lt;&lt;/if&gt;&gt;

  &lt;&lt;getItem $treasureChest&gt;&gt;
  &lt;&lt;include &quot;beach randomization&quot;&gt;&gt;


/*===Sandy box===*/
&lt;&lt;elseif _chance &gt; 60&gt;&gt;
  After a small amount of digging, your hand touches something solid. You reach into and pull, and a small box pops out, the sand shifting back into the hole as you dust it off. You shake it gently, and can hear tightly-packed sand inside. It’s impossible to tell if it holds anything but without opening it. 

  &lt;&lt;getItem $sandyBox&gt;&gt;
  &lt;&lt;include &quot;beach randomization&quot;&gt;&gt;


/*===Sand snake===*/
&lt;&lt;elseif _chance &gt; 35&gt;&gt;
  As you dig, the sand shifts worryingly under your grasp. You step back a little, thinking it might just be a minor cave-in, but an ominous hiss heralds a large, &lt;&lt;if $sandSnake.name == &quot;sand snake&quot;&gt;&gt;orange snake&lt;&lt;else&gt;&gt;&lt;&lt;=setup.getSpeciesData($sandSnake.species).species&gt;&gt;&lt;&lt;/if&gt;&gt; bursting out of the sand. Some of its body is still under the sand, but it’s a foot wide, far bigger than any snakes you’ve seen. It has a few gritty fragments of coconut hanging out of its mouth, but it snaps them down and hisses at you, looking at you ravenously. 
  &lt;&lt;startCombat $sandSnake&gt;&gt;


/*===Nothing!===*/
&lt;&lt;else&gt;&gt;
  You dig a foot or so down, but find nothing of value. You kick the sand back into the hole and continue on your journey. 
  &lt;&lt;include &quot;beach randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="160" name="Leave Hydra" tags="beach" position="1100,800" size="100,100">&lt;&lt;setPassageTitle &quot;Nope!&quot;&gt;&gt;
You realise in this world large crowds can often lead to issues, so you hurry on your way as quickly as possible. 

&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="161" name="Leave beach vendor" tags="beach" position="1350,800" size="100,100">The $npc1.species stops scritching $npc1.his gut, looking a bit surprised that you&#39;d decline. $npc1.He then smiles and shrugs. &quot;Your loss.&quot; $npc1.He stretches $npc1.his neck from side to side and plops $npc1.himself back down against the palm, getting comfortable. &quot;Maybe another time.&quot; 

&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="162" name="Leave sand mound alone" tags="beach" position="1600,800" size="100,100">Deciding against digging, you shrug and move on, leaving the disturbed sand alone. 
&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="163" name="Minor beach events" tags="beach" position="1425,1300" size="100,100">&lt;&lt;setPassageTitle &quot;A discovery?&quot;&gt;&gt;

&lt;&lt;switch random(1,2)&gt;&gt;

&lt;&lt;case 1&gt;&gt;
You stroll across the beach, the sand gently shifting beneath your $p.feet. While very scenic, you don&#39;t actually find anything of interest. 

&lt;&lt;default&gt;&gt;
&lt;p&gt;As you meander along the beach, you notice a few coconut trees. They were originally there just as ornaments, but they’ve &quot;Succumbed&quot; to the same wave of prosperity all plants seem to have been affected by. You walk up to it, and notice several coconuts among its leaves. Looking around, you decide that the people around wouldn’t mind if you tried to get a couple. You grab and shake the tree a little, making several of them fall out, and you have to step out of the way so one of them doesn’t hit you on the head. &lt;/p&gt;

As they hit the ground, one cracks open, spilling milk into the sand which seems to draw the attention of something under the sand. You step back a bit as you feel something shift under there, and a few orange snakes surface from under the sand, snatching the shattered remnants of the coconut, as well as grabbing some of the intact ones. You quickly stoop down and grab one just before another snake pops up to grab it. It looks at you disdainfully, but knows that picking a fight with you wouldn’t be a good idea, tunnelling back underground. As you dust off the coconut, the sand under you settles. 
&lt;&lt;getItem $coconut&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="164" name="Ocean" tags="beach" position="1100,1125" size="100,100">&lt;p&gt;You walk to near the shoreline, and as you do, you pass what looks like a charity stall on the way there. You stop and look, seeing that the stall has lots of crates of pills, and a quick read of a pamphlet on the stall says that they’re water-breathing pills being given out for free. You take a couple, nodding your thanks to the stall attendant, before gulping one down and diving into the water. &lt;/p&gt;

The clear blues ocean waters allow for very distant visibility that allows you to almost clearly see the ocean floor. Although the further from the beach you get, the farther the sea floor sinks out of view into a serene dark blue abyss. All around you are schools of fish fattened into spheres of different sizes, although as you swim close to anyone school the fish dart surprisingly fast out of your reach. 

&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="165" name="Ocean rest" tags="beach" position="1050,1275" size="100,100">You find a comfortable spot to float around and rest. 
&lt;&lt;rest&gt;&gt;

&lt;&lt;if random(1,5) == 1&gt;&gt;
	&lt;&lt;set _enemy = either($sphericalShark, $bubbleOrca)&gt;&gt;
	&lt;&lt;setEnemy _enemy&gt;&gt;
	You are awoken from your sleep by $e.article $e.name! 
	&lt;&lt;startCombat&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;include &quot;ocean randomization&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="166" name="Pile of seaweed" tags="beach" position="1425,1050" size="100,100">&lt;p&gt;Pacing along the shoreline you come across a heap of seaweed at the water’s edge. It looks fairly fresh, the fronds still green and slippery. You cautiously lift a wide, strap-like frond, tugging, and to your surprise it stretches rather like stiff rubber- when you let go the strand snaps back against the mass of beached plant matter. Bracing your $p.feet in the sand you reach into the pile, grab hold of a few fronds and HEAVE. The kelp stretches and stubbornly refuses to break, but just when you’re about to turn purple with exertion a handful RIPS free, sending you stumbling backwards, arms windmilling for balance. &lt;/p&gt;

&lt;&lt;if random(1,3) == 1&gt;&gt;
	&lt;&lt;if random(1,2) == 1&gt;&gt;&lt;&lt;setEnemy $waterElemental&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;setEnemy $sandSnake&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;p&gt;Unfortunately, your strenuous activity disturbs something. As you stand, panting, your eyes widen when the mass of seaweed suddenly heaves and begins to lift up, as if growing before your eyes. When it gets to waist-height the tangled mass of fronds begin to slide apart, and up bursts $e.article $e.name! &lt;/p&gt; 
	&lt;&lt;startCombat&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;getItem $stretchySeaweed&gt;&gt;
	&lt;&lt;include &quot;beach randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="167" name="Raccoon beach vendor" tags="beach" position="1300,925" size="100,100">&lt;&lt;createFixedNPC &quot;beachVendor&quot;&gt;&gt;
&lt;&lt;setPassageTitle &quot;&lt;&lt;=$npc1.species.toUpperFirst()&gt;&gt; beach vendor&quot;&gt;&gt;

&lt;p&gt;Making your way along the strand, you walk right past an impressively large palm tree, thinking little of it. A moment later, you realize that there was someone there, and that somehow you&#39;d almost completely missed $npc1.him. Turning, you see an impressive specimen of a $npc1.species taking a nap right at the base of the trunk. $npc1.His strong, muscular arms rest peacefully over a prodigious $npc1.furBelly gut. $npc1.He slips one eye open as you approach, donning a welcoming smile. &quot;Ah, a customer!&quot; $npc1.He proclaims. &lt;/p&gt;

$npc1.He hefts himself to $npc1.his $npc1.feet, before stretching out and releasing a rumbling yawn, licking $npc1.his chops and scritching $npc1.his belly afterwards. While $npc1.his torso is bare, $npc1.he&#39;s sporting a roomy pair of traditional-looking pants and an apron with an intricate insignia. &quot;So, buddy, can I getcha somethin&#39;?&quot; 

&lt;&lt;vendor &quot;beach raccoon&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Buy from beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;beach&quot; &quot;Leave beach vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;if setup.questStarted($feeder_questRaccoonCook) == true and setup.questCompleted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Try my food!&quot; &quot;Beachside chef&#39;s taste-test&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;beach&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;elseif setup.questStarted($feeder_questRaccoonFeast) == true and setup.questCompleted($feeder_questRaccoonFeast) == false&gt;&gt;
		&lt;&lt;action &quot;se&quot; &quot;next&quot; &quot;Attempt the feast (100 Gold)&quot; &quot;Seaside Feast&quot;&gt;&gt;
			&lt;&lt;set $eventCounterA = 0&gt;&gt;
			&lt;&lt;set $eventCounterB = &quot;beach&quot;&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */</tw-passagedata><tw-passagedata pid="168" name="Sand mound" tags="beach" position="1425,925" size="100,100">While walking along, something about the sand nearby makes you stop. It seems somewhat displaced and stirred up, looking lighter in shade than the rest. Maybe there’s something there? 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Investigate&quot; &quot;Investigate sand mound&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;beach&quot; &quot;Ignore it&quot; &quot;Leave sand mound alone&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="169" name="beach ambush" tags="beach" position="1425,1175" size="100,100">&lt;&lt;if $beachEnemies == undefined or $beachEnemies.length == 0&gt;&gt;
	&lt;&lt;set $beachEnemies = [&quot;snake&quot;, &quot;water&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $beachEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;
&lt;&lt;case &quot;snake&quot;&gt;&gt;
As you comb across the beach, you step on a sand dune that shifts under your $p.feet in a peculiar fashion. 
&lt;&lt;setEnemy $sandSnake&gt;&gt;

&lt;&lt;case &quot;water&quot;&gt;&gt;
As you comb across the beach, you step on a sand dune that squishes under your $p.feet in a peculiar fashion. 
&lt;&lt;setEnemy $waterElemental&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy randomization&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="170" name="beach randomization" tags="beach" position="1275,1125" size="100,100">/*Ticks up random events counters*/
&lt;&lt;set $beachRandomization.combat += $beachRandomization.combatRate&gt;&gt;
&lt;&lt;set $beachRandomization.special += $beachRandomization.specialRate&gt;&gt;
&lt;&lt;set $beachRandomization.minor += $beachRandomization.minorRate&gt;&gt;


/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;
&lt;&lt;if $beachRandomization.special &gt; $beachRandomization.combat&gt;&gt;
&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $beachRandomization.minor &gt; $beachRandomization.special&gt;&gt;
&lt;&lt;set _randomEvent = &quot;minor&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;

/*A random combat*/
&lt;&lt;case &quot;combat&quot;&gt;&gt;
&lt;&lt;set $beachRandomization.combat = 0&gt;&gt;
&lt;&lt;set _event = &quot;beach ambush&quot;&gt;&gt;

/*A special event*/
&lt;&lt;case &quot;special&quot;&gt;&gt;
&lt;&lt;set $beachRandomization.special = 0&gt;&gt;

&lt;&lt;switch random(1,4)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;&lt;&lt;set _event = &quot;Pile of seaweed&quot;&gt;&gt;
	&lt;&lt;case 2&gt;&gt;&lt;&lt;set _event = &quot;Sand mound&quot;&gt;&gt;
	&lt;&lt;case 3&gt;&gt;&lt;&lt;set _event = &quot;Hydra attack&quot;&gt;&gt;
	&lt;&lt;case 4&gt;&gt;&lt;&lt;set _event = &quot;Raccoon beach vendor&quot;&gt;&gt;
	&lt;&lt;default&gt;&gt;&#39;&#39;Error in special event randomization!&#39;&#39;
&lt;&lt;/switch&gt;&gt;

/*A random minor scene*/
&lt;&lt;case &quot;minor&quot;&gt;&gt;
&lt;&lt;set $beachRandomization.minor = 0&gt;&gt;
&lt;&lt;set _event = &quot;Minor beach events&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in beach randomization!!!&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Beach rest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;ocean&quot; &quot;Ocean&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;ocean&quot; &quot;Ocean&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;ocean&quot; &quot;Ocean&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;road&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;beach&quot; &quot;Beach&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;beach&quot; &quot;Beach&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;beach&quot; &quot;Beach&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;beach&quot; &quot;Beach&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	/* For convenience, make the Raccoon chef available while doing quests for him */
	&lt;&lt;set _doingQuest = false&gt;&gt;
	
	&lt;&lt;if setup.questStarted($feeder_questRaccoonCook) == true and setup.questCompleted($feeder_questRaccoonCook) == false&gt;&gt;
		&lt;&lt;set _doingQuest = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if setup.questStarted($feeder_questRaccoonFeast) == true and setup.questCompleted($feeder_questRaccoonFeast) == false&gt;&gt;
		&lt;&lt;set _doingQuest = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _doingQuest == true&gt;&gt;
		&lt;&lt;action &quot;ne&quot; &quot;store&quot; &quot;Raccoon chef&quot; &quot;Raccoon beach vendor&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="171" name="ocean ambush" tags="beach" position="925,1275" size="100,100">&lt;&lt;if $oceanEnemies == undefined or $oceanEnemies.length == 0&gt;&gt;
	&lt;&lt;set $oceanEnemies = [&quot;shark&quot;, &quot;orca&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $oceanEnemies.pluck()&gt;&gt;

&lt;&lt;if _enemy == &quot;shark&quot;&gt;&gt;
&lt;&lt;setEnemy $sphericalShark&gt;&gt;
As you’re swimming in the ocean, you notice a $npc1.furBack dorsal fin heading right for you. You duck under the water to get a better view, and see an enormous $npc1.species heading your way! 

&lt;&lt;else&gt;&gt;
&lt;&lt;setEnemy $bubbleOrca&gt;&gt;
During your swim, you stumble across what looks like one of those crates from earlier, containing the tubes of pills. Strangely, there seems to be lots of empty ones dotted around the crate, and you can see a large, blue tail poking out of the crate. You begin to backstroke away from it, but whatever it is detects you and pulls itself out of the crate. As it faces you, you can see it’s a large $npc1.species, but different from those you may have seen in the sea or in books – It’s taken a deep blue hue with a light blue underbelly, evidently changed by eating the pills. $npc1.He looks at you, smiling as a few bubbles drool out of $npc1.his mouth. 

&lt;&lt;/if&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="172" name="ocean randomization" tags="beach" position="950,1125" size="100,100">&lt;&lt;set $oceanRandomization.combat += $oceanRandomization.combatRate&gt;&gt;
&lt;&lt;set $oceanRandomization.special += $oceanRandomization.specialRate&gt;&gt;

&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;
&lt;&lt;if $oceanRandomization.special &gt; $oceanRandomization.combat&gt;&gt;
&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;switch _randomEvent&gt;&gt;

&lt;&lt;case &quot;combat&quot;&gt;&gt;
&lt;&lt;set $oceanRandomization.combat = 0&gt;&gt;
&lt;&lt;set _event = &quot;ocean ambush&quot;&gt;&gt;

&lt;&lt;case &quot;special&quot;&gt;&gt;
&lt;&lt;set $oceanRandomization.special = 0&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
&lt;&lt;case 1&gt;&gt;&lt;&lt;set _event = &quot;Buried treasure&quot;&gt;&gt;
&lt;&lt;case 2&gt;&gt;&lt;&lt;set _event = &quot;Find seaweed&quot;&gt;&gt;
&lt;&lt;case 3&gt;&gt;
&lt;&lt;if random(1,2) == 1&gt;&gt;&lt;&lt;set _event = &quot;Raccoon ocean vendor&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set _event = &quot;Sirens&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;ERROR IN OCEAN RANDOMIZATION&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Ocean rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;beach&quot; &quot;Beach&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;beach&quot; &quot;Beach&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;beach&quot; &quot;Beach&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;ocean&quot; &quot;Ocean&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;ocean&quot; &quot;Ocean&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;ocean&quot; &quot;Ocean&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;ocean&quot; &quot;Ocean&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;ocean&quot; &quot;Ocean&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;	
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="173" name="Altertarium" tags="mageguild" position="2000,1225" size="100,100">&lt;&lt;createFixedNPC &quot;altertarium&quot;&gt;&gt;

&lt;p&gt;You walk into the Altertarium. There, you can see a $npc1.color-$npc1.furred $npc1.species giving a lecture to several confused-looking apprentice mages. $npc1.He has drawn diagrams and figures magically in the air and is gesticulating wildly as $npc1.he tries to explain the hows and whats of Alteration. After a few more moments of this, the lesson comes to an abrupt end. &lt;/p&gt;

As the students shuffle out, the $npc1.species walks up to you. &quot;Alteration magic. Care to try? Maybe learn some?&quot; 

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Altertarium teacher says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;vendor &quot;Altertarium&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells&quot; &quot;Learn spells from Altertarium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Study hall&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="174" name="Altertarium teacher says" tags="mageguild" position="2100,1325" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the altertarium teacher&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Lucille? No. Lucern? Still no. $npc1.Name? That sounds right. $npc1.Name. That&#39;s my name. For now. Alteration is always changing.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Hard to pin down. No, impossible, really. Alteration is. The best mind for it is the mind that can change. Maybe.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;How long? Have I been using Alteration magic? What a silly question. Ten days. Or was it years? Yes, it was years.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Change yourself by changing your mind. Change your mind by changing your thoughts. Change your thoughts by changing yourself. These are the rules of Alteration. For now.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="175" name="Apothecary" tags="mageguild" position="1800,1350" size="100,100">&lt;&lt;createFixedNPC &quot;apothecary&quot;&gt;&gt;

&lt;p&gt;You walk over to the Apothecary&#39;s, which is a relatively small room that doesn&#39;t seem to have much in the way of actual stock, appearing to have only one of each item that is sold here. &lt;/p&gt;

&lt;p&gt;A rotund $npc1.species lounges about behind a counter, garbed in a hideous yellow robe that no longer contains $npc1.his long, bulging belly. $npc1.He raises a hand at you, eating a ham sandwich with far too much mustard, if the yellow splotches on $npc1.his face and chest are any indication. &lt;/p&gt;

With an exagerrated swallow, $npc1.he clears $npc1.his mouth and says, &quot;What can I get for ya?&quot;
&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Ferret apothecary says&quot;&gt;&gt;

&lt;&lt;vendor &quot;apothecary&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;Apothecary vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Mage&#39;s Guild&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="176" name="Apothecary vendor" tags="mageguild" position="1900,1350" size="100,100">A rotund $npc1.species lounges about behind a counter, garbed in a hideous yellow robe that no longer contains $npc1.his long, bulging belly. 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Apothecary&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="177" name="Destructatorium" tags="mageguild" position="1800,1125" size="100,100">&lt;&lt;createFixedNPC &quot;destructatorium&quot;&gt;&gt;

&lt;p&gt;Walking into the Destructatorium, the sounds you heard from outside suddenly have much more distinct sources. A professional looking $npc1.species in an armored black robe is walking up and down a line of students as they hurl fireballs and lightning bolts at insulated target dummies. At some, $npc1.he nods, at others, $npc1.he barks out brief instructions, causing them to visibly flinch. &lt;/p&gt;

After a moment, $npc1.he spots you, and walks over to you. &quot;Spells or words?&quot; $npc1.he asks curtly. 

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Words?&quot; &quot;Destructatorium teacher says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;vendor &quot;Destructatorium&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells&quot; &quot;Learn spells from Destructatorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Study hall&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="178" name="Destructatorium teacher says" tags="mageguild" position="1700,1025" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the destructatorium teacher&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Name&#39;s $npc1.Name. I&#39;m here to drill combat readiness into the minds of these layabouts. Casting in battle is harder than casting when you have all the time in the world to focus.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Almost all fighting magic takes the form of an element. It&#39;s simpler and more reliable to try to conjure something that has a natural form than it is to make solid arcana.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Some foes resist elements. Some foes resist physical forces. Some foes even resist raw arcana. Don&#39;t get stuck in a mindset of trying something that&#39;s failed again unless you like getting eaten by monsters. It won&#39;t work as well as changing your tactics, even if you do it &#39;harder.&#39;&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Fire can burn, ice can slow movement, lightning can give &#39;em the shakes. My preference is lightning. Things don&#39;t fight very well when they&#39;re twitching in a fetal position on the ground.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="179" name="Ferret apothecary says" tags="mageguild" position="1800,1450" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the apothecary&quot;&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Name&#39;s $npc1.Name, I sell the stuff to the folks, blah blah blah, magic. I freaking love magic. I used magic to make this sandwich. This is the best damn sandwich.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Hm? Oh. No, there&#39;s not much stuff out here. Why should there be? You buy something, I magic it up from the store rooms. Walking around to get things is for chumps. I got magic for that.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;You want robes? We got robes. We got robes in every color. All of them. Some of them ARE every color. We&#39;re mages. We do that with magic. Even are duds are friggin&#39; magic. Being a mage is awesome.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;So apparently there are dudes that like, do things with like, the power of their bodies. I don&#39;t even know what they are ON about. Body magic done by crafting your body to perfection? Screw that noise, I got magic.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="180" name="Guild receptionist says" tags="mageguild" position="1575,1350" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the guild receptionist&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Welcome to the Mage&#39;s Guild. All you need to be permitted here is a desire to understand the mysterious. But a fancy robe helps you fit in.&quot;&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;My name? Well, I was born in the ocean, so it&#39;s a series of clicks and cries, but I tend to go by &#39;$npc1.Name&#39; on land.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;You should check out the library if you haven&#39;t already. Even if you don&#39;t need to study, it&#39;s got a fine cookbook section, too. That&#39;s been popular lately.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;The Apothecary sells a variety of magical goods, and the Study Hall is where the masters teach spells. The guild&#39;s not a complicated place; the complexity is in the mystery of magic! And determining the perfect color of hat.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="181" name="Learn spells from Altertarium" tags="mageguild" position="2100,1225" size="100,100">&lt;&lt;teach&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Altertarium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="182" name="Learn spells from Destructatorium" tags="mageguild" position="1800,1025" size="100,100">&lt;&lt;teach&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Destructatorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="183" name="Learn spells from Restoratorium" tags="mageguild" position="1900,1025" size="100,100">&lt;&lt;teach&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Restoratorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="184" name="Library" tags="mageguild" position="1675,1225" size="100,100">&lt;p&gt;You enter the library, and the first thing you notice is that sound seems to be muffled here. The second thing you notice is that the library extends to a size significantly larger than what you remember the building being from the outside. Tall, wheeled ladders sit beside pillars that double as book shelves, and there is even a large selection of particularly magical books that float in a magical clump above a reading area. &lt;/p&gt;

An index sits a few steps in and seems to respond to inquiries you make even as you are thinking of them. Sections are labelled by floating glyphs that separate the library into dozens of sections based on topic, including more esoteric things, such as &#39;Learning Methods&#39; and &#39;Meta-Studies.&#39; You get the impression that you could definitely get your learn on here. 

&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Study&quot; &quot;Study&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Mage&#39;s Guild&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="185" name="Mage&#39;s Guild" tags="mageguild" position="1675,1350" size="100,100">&lt;&lt;createFixedNPC &quot;guildReceptionist&quot;&gt;&gt;

&lt;p&gt;You step into the main foyer of the mage&#39;s guild, your eyes immediately assaulted by carpets and tapestries of various loud and gaudy colors. In various parts of the comfortably-furnished room, small groups of robed furs have debates, discussions, and demonstrations of magical theory, all while gorging themselves on food that floats to their beckoning hands. 
&lt;/p&gt;

$npc1.Article $npc1.species $npc1.guy lazily swims in the air towards you, smiling happily. &quot;Greetings to you,&quot; $npc1.he says. 
&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Guild receptionist says&quot;&gt;&gt;

&lt;&lt;action &quot;nw&quot; &quot;spells&quot; &quot;Library&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;store&quot; &quot;Apothecary&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;spells&quot; &quot;Study hall&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="186" name="Restoratorium" tags="mageguild" position="1900,1125" size="100,100">&lt;&lt;createFixedNPC &quot;restoratorium&quot; 2&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot;&gt;&gt;

&lt;p&gt;You head into the Restoratorium, and aside from treating burned mage trainees, you can see rather a lot of figures of anatomy. From the looks of it, learning what organs do what and where they are in the body has high importance in this class. 
&lt;/p&gt;

A $npc2.species $npc2.gentleman in a white robe rubs ointment on $npc1.article $npc1.species&#39;s hand, then walks up to you. &quot;If you need assistance, I am here to help however I can.&quot; $npc2.he says. 
&lt;hr&gt;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Restoratorium teacher says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;vendor &quot;Restoratorium&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells&quot; &quot;Learn spells from Restoratorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Study hall&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="187" name="Restoratorium teacher says" tags="mageguild" position="2000,1025" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the restoratorium teacher&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;I&#39;m $npc2.Name, and I&#39;m in charge of teaching students Restoration spells. Anything that makes the body whole and well is my passion.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;In my spare time, I tend to a reagent garden outside. Did you think they were just flowers? Well, in addition to being lovely, they are the primary ingredients for the potions for sale at the Apothecary and other places.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;With how easy it is to grow ingredients, we have a special arrangement with the hospital in the city. Half of the potions we send them are free of charge, since they have such need to put them to good use lately.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;My most sincere hope is that, by teaching these spells to any that can learn them, I can save even a single person from suffering. Please, if you choose to learn my spells, share them freely with those in need.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="188" name="Study" tags="mageguild" position="1575,1225" size="100,100">&lt;&lt;doTime 30&gt;&gt;
&lt;&lt;if $fat &gt; 3&gt;&gt;
You pore over some books and somehow feel yourself becoming much smarter... yet somehow physically drained....
&lt;&lt;changeStats &quot;fat&quot; -3&gt;&gt;
&lt;&lt;changeStats &quot;int&quot; 0.3&gt;&gt;
&lt;&lt;updatePanels&gt;&gt;

&lt;&lt;else&gt;&gt;
You skim through several books, but the information seems to just slide out of your brain. Your only thought is that you feel so hungry and sooooo skinny. 

&lt;&lt;/if&gt;&gt;


&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Study&quot; &quot;Study&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Mage&#39;s Guild&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="189" name="Study hall" tags="mageguild" position="1800,1225" size="200,100">&lt;p&gt;You $walk into a hallway that leads to the classrooms of the guild. There are exactly four doors, each with a lit sign above them. &lt;/p&gt;

&lt;&lt;if $options.feeder_expansionEnabled&gt;&gt;
Behind the door labelled &quot;Destructatorium&quot;, you can hear explosions and crackling, and the occasional yell of //&quot;Ow!&quot;// Generally following that, you see a singed fur running over to the Restoratorium door. Those that go into the Altertarium tend to come out looking more confused than when they started, meanwhile those visiting the Creatorium leave with much more rounded bellies.
&lt;&lt;else&gt;&gt;
Behind the door labelled &quot;Destructatorium&quot;, you can hear explosions and crackling, and the occasional yell of //&quot;Ow!&quot;// Generally following that, you see a singed fur running over to the Restoratorium door. Those that go into the Altertarium tend to come out looking more confused than when they started.
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;1&quot; &quot;darkMagic&quot; &quot;Destructatorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;whiteMagic&quot; &quot;Restoratorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;greyMagic&quot; &quot;Altertarium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $options.feeder_expansionEnabled&gt;&gt;
	&lt;&lt;action &quot;4&quot; &quot;greyMagic&quot; &quot;Creatorium&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;leave&quot; &quot;Mage&#39;s Guild&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="190" name="Ambient city" tags="" position="2625,1500" size="100,100">&lt;&lt;set $windowText = &quot;&quot;&gt;&gt;
&lt;&lt;script&gt;&gt;
	State.variables.windowText = getAmbientText(&quot;centralTown&quot;);
&lt;&lt;/script&gt;&gt;

&lt;&lt;if $windowText !== &quot;&quot; &amp;&amp; $windowText !== undefined &amp;&amp; $windowText !== null&gt;&gt;
	&lt;&lt;print $windowText&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;

&lt;&lt;switch $daytime&gt;&gt;

&lt;&lt;case &quot;night&quot;&gt;&gt;
The sun has completely set, leaving the town in darkness only broken by small pools of light around flickering street lamps. 

&lt;&lt;if $fat &lt; 200&gt;&gt;
An oppressive silence has fallen over the city square. You try to walk as lightly and noiselessly as you can, not wanting to draw attention to yourself. 
&lt;&lt;elseif $fat &lt; 500&gt;&gt;
The city square is completely silent, save for the sound of your ponderous footsteps. Your heavy body limits your stealth capabilities, and try as you might, you can&#39;t quite manage to walk completely noiselessly. 
&lt;&lt;else&gt;&gt;
The dead silence in the city square provides a stark contrast to the booming sound of your heavy footfalls. Keeping a low profile is out of the question; you can only hope that your formidable size will suffice to deter anyone with ill intent. 
&lt;&lt;/if&gt;&gt;


&lt;&lt;switch random(1,9)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
All folks that have had too much to eat or drink already, and those obliged to wake before sunrise have dozed off in their beds and hospital wards, and the square is left to the nocturnal songbirds, last tardy porters, lurching connoisseurs of cheap drink and surly guards lighting the torches. 
&lt;&lt;case 2&gt;&gt;
This time of night, no one is on the streets who doesn&#39;t absolutely need to be there, meaning the streetcleaners, the pudgy stray dogs going about their business after an evening of snatching sausages from the spoiled gourmands, and the perpetually gloomy night watch officers. 
&lt;&lt;case 3&gt;&gt;
It&#39;s the dead of night in the city square, and whenever the night watch isn&#39;t around, shadowy figures can be seen creeping along the walls, exchanging mysterious objects and secretive whispers with each other before sinking into the nearest alleyway. 
&lt;&lt;case 4&gt;&gt;
One or two lit windows can be counted in this city of hundreds, and now that both the the citizenry and the scarce town fauna have quieted down, muffled echos of strange and disturbing wilderness sounds can be heard from beyond the city walls. 
&lt;&lt;case 5&gt;&gt;
The contrast of the dead silence filling the square to the din of the city at noon could not be more stark than at this awkward, empty hour, and even the usually bickering and grouching night watch officers seem to be feeling oppressed, as they plod by with their torches and jingling keychains. 
&lt;&lt;case 6&gt;&gt;
Only a rare prematurely awoken bird ever produces a halfhearted chirp this early, but the air and the subtle change of lighting feel like the whole city tosses and turns in its sleep, ready to cringe at the first rays of the sun. 
&lt;&lt;case 7&gt;&gt;
A fur is passed out in the gutter with a wine bottle in his hand. His swollen stomach sticks up in the air and occasionaly sloshes back and forth as he rolls in his sleep. 
&lt;&lt;case 8&gt;&gt;
A small group of $npc1.species drunkenly stumbles past you as they waddle down the street. They&#39;re each sporting swollen sloshing stomachs that bump into each other as they lean on each other&#39;s shoulders and sing drunken bar songs off key. 
&lt;&lt;default&gt;&gt;
A stiff breeze ruffles across your $p.fur. 
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;morning&quot;&gt;&gt;
The morning sunlight has just begun shining on the city streets. 

&lt;&lt;if $fat &lt; 200&gt;&gt;
You shiver slightly as you stroll through the cold morning air. 
&lt;&lt;elseif $fat &lt; 500&gt;&gt;
The lingering morning chill in the air makes you feel grateful for the layer of fat insulating your body. 
&lt;&lt;else&gt;&gt;
You take a moment to breathe in deeply, enjoying the morning air. Although it&#39;s still rather chilly outside, you actually feel quite comfortable, thanks to the thick layer of blubber enrobing your entire body. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch random(1,7)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
It is still much too early for anyone to be up and about, and the only notable sounds consist of the grunting, coughing and swearing of the night watch guards shuffling to their barracks to be relieved after long shift. 							
&lt;&lt;case 2&gt;&gt;
The few birds that inhabit the rooftops of the city&#39;s buildings can be heard lazily starting their daily routine of chirps and twitterings, but for the most part the common folk are still dreaming. 		
&lt;&lt;case 3&gt;&gt;
The earliest of craftsmen and the last night&#39;s party guests on their way back home can be occasionally seen staggering about with sleepy expressions, and more and more window blinds are opened to greet the morning light and let out the smells of early breakfast tea. 			
&lt;&lt;case 4&gt;&gt;
The chilly morning air is slowly becoming saturated with the beehive sounds of a large, busy city coming awake, and an inviting aroma starts emanating from the restaurant as it first orders are prepared for the early bird patrons. 				
&lt;&lt;case 5&gt;&gt;
The porters and vendors can be seen carting their goods, pouring out of every street and alleyway and funneling into the market square, although some of those carts carry living passangers bloated with imprudent gorging - those steer towards the hospital entrance instead.
&lt;&lt;case 6&gt;&gt;
The square is slowly filling up with all sorts of people - not just those who have any actual business being there, but also the persons of leisure taking their relaxed morning strolls, tourists and street entertainers. 
&lt;&lt;default&gt;&gt;
Birds chirp merrily from the branches of the city&#39;s trees. 
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;day&quot;&gt;&gt;
The warm sun hangs over head and beats down upon the city. 

&lt;&lt;if $fat &lt; 200&gt;&gt;
You enjoy the feeling of the afternoon sun warming your body. 
&lt;&lt;elseif $fat &lt; 500&gt;&gt;
You wipe the sweat from your brow, finding that your soft, padded body is retaining heat a little too well for comfort in the warmth of the afternoon. 
&lt;&lt;else&gt;&gt;
Drenched in sweat, you find yourself shying away from the sun&#39;s rays as much as possible, as your heavily over-insulated blubbery body struggles to rid itself of excess heat. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch random(1,7)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
The paved space of the town&#39;s center is starting to clear out after the morning rush, but you still cannot walk through the square in a straight line without bumping into someone. 						
&lt;&lt;case 2&gt;&gt;
A steady stream of diners vanishes behind the voracious doors of the restaurant, and a corresponding queue of porters issue from the establishment&#39;s back doors, carrying the customers towards the hospital&#39;s overworked overindulgence ward. 
&lt;&lt;case 3&gt;&gt;
At this time, the square has more or less cleared out of all the urgently rushing folk, leaving behind the easy sight of promenading nobles and the more prudent of diners hauling their bulks out of the restaurant halls and towards their destinations of choice. 
&lt;&lt;case 4&gt;&gt;
There is a sense of sun-baked contentment in the almost empty square, but even with the lack of ruckus nearby, a low hum of busy life permeates the city, accentuated every now and then by a loud call, a door getting bashed shut, a sound of explosion from one of the hospital wards or a satisfied belch from one of the restaurant regulars. 
&lt;&lt;case 5&gt;&gt;
Between a rare cart or a lone rider passing across it, the square is largely empty at the moment, allowing the birds to be heard above the subdued din of the working city. 
&lt;&lt;case 6&gt;&gt;
The city is filled with the sounds of conversation as groups of furs walk past you. 
&lt;&lt;default&gt;&gt;
A very overweight $npc1.species waddles $npc1.his way down the street with several bags of food under each arm. 						
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;evening&quot;&gt;&gt;
The sunlight is starting to get dimmer as the sun sets. 

&lt;&lt;if $fat &lt; 200&gt;&gt;
&lt;&lt;elseif $fat &lt; 500&gt;&gt;
As you make your way through the crowded square, your sizable &lt;&lt;print either(&quot;belly&quot;, &quot;rump&quot;)&gt;&gt; occasionally brushes against other furs, despite your best efforts to weave through them. Most of the townsfolk pay it little mind, although you do draw a few disapproving looks from the more cantankerous ones. 
&lt;&lt;elseif $fat &lt; 3000 and random(1,4) == 1&gt;&gt;
As you try to pick your way through the crowd, your &lt;&lt;print either(&quot;bulging belly&quot;, &quot;prodigious posterior&quot;)&gt;&gt; smacks into a particularly thin $npc1.species hard enough to make $npc1.him stumble. The $npc1.species takes it in stride and graciously accepts your apology, telling you not to worry about it. However, you try to move a little more carefully as you proceed through the crowd. 
&lt;&lt;elseif $fat &gt;= 3000 and random(1,4) == 1&gt;&gt;
As you awkwardly try to maneuver your enormous bulk through the crowd, your &lt;&lt;print either(&quot;massive belly&quot;, &quot;titanic rear&quot;)&gt;&gt; slams into a particularly thin $npc1.species so hard that it knocks $npc1.him to the ground. You apologize profusely as you help the dazed $npc1.species to $npc1.his feet. Recovering $npc1.his senses, the $npc1.species&#39;s jaw drops as $npc1.he notices your mind-bogglingly fattened form for the first time. The $npc1.species eventually manages to find $npc1.his tongue and accept your apology, but $npc1.he can&#39;t help but stare after you, shaking $npc1.his head in disbelief, as you slowly (and very carefully) move off through the crowd. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch random(1,7)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
The lazier, fatter midday city guards give way to their more exercised and hardened night watch counterparts, and the evening bells summon the vanguard of the wearied workers and vendors getting back from work. 
&lt;&lt;case 2&gt;&gt;
The square is crowding up at an alarming rate, with the three main components of this stew being the hungry restaurant patrons, the already overtly sated being rushed to the hospital, and the market porters with the significantly lightened carts bowling through. 
&lt;&lt;case 3&gt;&gt;
Bustling with both amiable cheers and irritated cursing, the city&#39;s hub is replete with people of all trades, shaped and sizes, and this gathering draws forth the street bards, jesters and the portable snack stand proprietors seeking to service those that didn&#39;t fit into the crowded restaurant. 
&lt;&lt;case 4&gt;&gt;
The evening revelries are in full swing now, and as the first windows become lit with candles and magic glowstones, the loud crowd outside them trades the heavily laid dinner plattes for mugs and flagons of ale, and go around singing, chatting and carousing. 
&lt;&lt;case 5&gt;&gt;
As the darkness falls on the city, the cacophonic commotion begins to decline, with only the most devoted of party animals continuing to gorge and quaff in the settling quiet of the night. 
&lt;&lt;case 6&gt;&gt;
All of the chatty congregations of townsfolk have long since dispersed in this late hour, and the last bits of merry laughter and sated burps now come from inside the homes around the square.
&lt;&lt;default&gt;&gt;
A $npc1.species sits on a bench outside the grocery store and $npc1.he&#39;s busily cramming slices of cake into his face as $npc1.he rubs $npc1.his swollen stomach. 
&lt;&lt;/switch&gt;&gt;


&lt;&lt;default&gt;&gt;
**Error in ambient city**

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;script&gt;&gt;
	generateAmbientText(&quot;centralTown&quot;);
&lt;&lt;/script&gt;&gt;

/*===Random fight===*/
&lt;&lt;if $daytime == &quot;night&quot; and random(1,5) == 1&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;fight&quot;&gt;&gt;
&lt;&lt;if $cityEnemies == undefined or $cityEnemies.length == 0&gt;&gt;
	&lt;&lt;set $cityEnemies = [&quot;drunk&quot;, &quot;thief&quot;]&gt;&gt;
	&lt;&lt;if $lvl &gt;= 5&gt;&gt;
		&lt;&lt;run $cityEnemies.push(&quot;takeout&quot;)&gt;&gt; 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $cityEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;
	&lt;&lt;case &quot;drunk&quot;&gt;&gt;
	&lt;&lt;setEnemy $drunk&gt;&gt;
	As you wander through the city streets, you happen to run into a $npc1.species stumbling down the street towards you. $npc1.He barely manages to stumble up to you as $npc1.he&#39;s clearly had a bit too much to drink. And by clearly too much, $npc1.he appears to have drained an entire keg judging by the size of $npc1.his swollen gut, which has long since burst through $npc1.his shirt. As $npc1.he drunkenly wobbles $npc1.his way up to you, $npc1.his gut sloshes back and forth with each step, doing no favors for his poor sense of balance. &quot;Hey you! //*hic*// Gimme a goldsssh. I need ta get backsh to the bar before lasht call! //*hic*//&quot; $npc1.He stumbles into you and nearly knocks you to the ground. &quot;Oh! Sos its a fight you wantsh eh! //*hic*// Well puts &#39;em up!&quot; $npc1.He raises his fists in a drunken stance. You weren&#39;t necessarily looking for a fight before, but apparently you&#39;re in one now. 
	
	
	&lt;&lt;case &quot;thief&quot;&gt;&gt;
	&lt;&lt;setEnemy $thief&gt;&gt;
	&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
	&lt;&lt;if $str &gt; 250&gt;&gt;
	A scream rings out from a nearby alley, piercing the nighttime silence. You round the corner just in time to &lt;&lt;if $fat &gt; 200&gt;&gt;run belly-first&lt;&lt;else&gt;&gt;crash&lt;&lt;/if&gt;&gt; into a pudgy, dark-clad $npc1.species, knocking $npc1.him over. You instinctively reach down to help $npc1.him up, but you stop as you notice the dagger in $npc1.his hand. Nearby, a young $npc2.species gapes up at you in astonishment. As the $npc1.species shakes $npc1.his head and starts climbing to $npc1.his feet, the young $npc2.species takes the opportunity to dart off, leaving you alone with the would-be thief. The $npc1.species&#39;s eyes widen in fear as you loom over $npc1.him, $wea.name at the ready. 
	&lt;&lt;else&gt;&gt;
	As you $walk down a city street, you get the feeling you’re being watched. You hear the quiet but unmistakable sound of footsteps behind you. You whirl around to see a pudgy $npc1.species dressed in dark, ill-fitting clothing standing right behind you and wielding a dagger. “Your money or your life!” $npc1.he says. You bring up your $wea.name and prepare for a fight. 
	&lt;&lt;/if&gt;&gt;
	
	
	&lt;&lt;case &quot;takeout&quot;&gt;&gt;
	&lt;&lt;setEnemy $takeoutTerror&gt;&gt;
	You’re brought up short as a hugely fat $npc1.species waddles towards you- practically so wide that there’s no space in the street to avoid $npc1.him. The ground shakes beneath $npc1.his thunderous footfalls. $npc1.His shirt and denim pants are bursting at the seams, $npc1.his belly so bloated it hangs past $npc1.his knees. $npc1.He resembles a hot-air balloon stuffed into a set of clothes. Obviously having been gorging for hours, the $npc1.species is occupied greedily devouring something from a crumpled parchment bag, accompanied by a strong smell of fried food, but as you watch $npc1.he balls the now-empty bag up and tosses it away, obviously STILL not satisfied. Catching sight of you, $npc1.he pants, &quot;Hey, y-you there! You’ve gotta lend me some GOLD!&quot; $npc1.His enormous middle emits a subterranean rumble, and $npc1.he adds desperately. &quot;You don’t understand, I just… gotta get some more CHOW!&quot; A slightly crazed look enters $npc1.his food-fuddled gaze, and $npc1.he looms over you like a wrecking ball. &quot;In fact… you’re look mighty tasty there… if you’ve not got any gold maybe I’ll j-just eat YOU!&quot; 
	
	
	&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in enemy randomization&#39;&#39;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="191" name="Ask about burst chainmail" tags="" position="3275,1400" size="100,100">You proffer the burst chainmail to $npc1.Name, who stops work to examine it. Holding it up to the forge-light, $npc1.he shakes his head. &quot;Aye, this is skilled craft, I&#39;ll grant you. I can&#39;t say who forged this, but they had rare talent, maybe magic, too. I cannae touch it $p.laddie- I just don&#39;t have the know-how. You may have better luck out West, or I knew of a fine smith in the mountains, if $npc2.he&#39;s still around.</tw-passagedata><tw-passagedata pid="192" name="Central Square" tags="city" position="2500,1825" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
	
&lt;&lt;else&gt;&gt;
&lt;p&gt;You&#39;re standing in the main city of the area. Longer than recorded history this city has stood in the shadow of the eastern mountains, isolated from the goings on in the rest of the world. The coblestone streets are well worn and smoothed over from centuries of horse, cart, and foot traffic. The streets are lined by old wood and stone buildings. &lt;/p&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;include &quot;Ambient city&quot;&gt;&gt;
&lt;hr&gt;

&lt;&lt;include &quot;central square movement&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="193" name="Church" tags="city" position="2750,2100" size="100,100">&lt;&lt;createFixedNPC &quot;priest&quot;&gt;&gt;
&lt;&lt;set _priest = &quot;priest&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _priest = &quot;priestess&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* no, I can&#39;t be bothered to mess with the genders of the gods, too */

&lt;p&gt;You step into the church, which is resplendant, clean and quiet. The marble floor is decorated by colored carpets that lead to a variety of shrines and altars dedicated to the gods. Above, the stone archways are painted with images depicting events of great significance and spiritual importance. The head _priest, $npc1.article $npc1.species in robed finery, nods to acknowledge you as $npc1.he makes his way from one end of the room to the other, cleaning each altar and praying at each shrine. &lt;/p&gt;

&lt;p&gt;&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Greetings, adventurer. I am $npc1.Name, and I tend to this place. In these strange times, you would do well to pay heed to the gods, lest you be led astray.&quot; 

&lt;&lt;case 1&gt;&gt;
&quot;Those with the explorer&#39;s heart are granted a boon by the goddess of courage. Should they meet their end beyond the reach of mortal aid, they will be led to Her altar to begin anew. Bear in mind that there is a cost to this, for the drive to explore must come from deep desire.&quot; 

&lt;&lt;case 2&gt;&gt;
&quot;Be wary of those that delve too deeply into the magics of change. While the gods will respect whatever natural form you make choose to take, there is a boundary beyond which you are something that does not belong in this world. Those that cross this line have a history of coming to madness.&quot; 

&lt;&lt;default&gt;&gt;
&quot;To be honest, my faith is tried with our current state of affairs. The blessings of the god of harvest are surely grand and wonderous, but whether it was His intent that we fall into gluttony from them I am not certain. Are we being tested? Are we being rewarded? Or is there yet another force at work? I fear I cannot say.&quot; 
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;&lt;/p&gt;


&lt;&lt;action &quot;c&quot; &quot;talk&quot; &quot;Talk&quot; &quot;Church&quot;&gt;&gt;&lt;&lt;set $eventCounterB++&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;gate&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="194" name="Clothing Store" tags="" position="2925,1500" size="100,100">&lt;&lt;createFixedNPC &quot;clothier&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;tailor&quot; 2&gt;&gt; /* Guessing that the husband mentioned is the tailor? (even though the general store merchant&#39;s name is used)*/

You walk into the clothier&#39;s shop, greeted by the sight of rows of clothing hung up for display. A well-dressed and well-fed $npc1.species $npc1.gentleman comes up to greet you. &quot;Welcome to my store,&quot; $npc1.he says, gesturing around politely. &quot;If you are interested in any of my wares, or need your clothing mended or altered, please let me know.&quot; 
&lt;hr&gt;

&lt;&lt;vendor &quot;clothing vendor&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;clothing vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Talk to cow clothier&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="195" name="Clothing tailored" tags="" position="3050,1825" size="100,100">&lt;&lt;if $eventCounterA == &quot;top&quot;&gt;&gt;&lt;&lt;set _clothing = $top&gt;&gt;
&lt;&lt;elseif $eventCounterA == &quot;btm&quot;&gt;&gt;&lt;&lt;set _clothing = $btm&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set _clothing = $inventory[$eventCounterA]&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _size = Math.round(setup.waistDiameter() * 1.2 + 3)&gt;&gt;
&lt;&lt;set _clothing.value += Math.round((_clothing.value/_clothing.size) * _size)&gt;&gt;
&lt;&lt;set _clothing.size = Math.round(setup.waistDiameter()*1.2+3)&gt;&gt;
&lt;&lt;set _clothing.popped = false&gt;&gt;

&lt;&lt;if !_clothing.description.contains(&quot; (Tailored)&quot;)&gt;&gt;
	&lt;&lt;set _clothing.description += &quot; (Tailored)&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;$npc1.He takes a few minutes to measure your sizes all over. 
&lt;&lt;if setup.weight() &gt; 3000&gt;&gt;It takes $npc1.him a very long while before $npc1.he can find a tailor&#39;s measuring tape long enough. 
&lt;&lt;elseif setup.weight() &gt; 1500&gt;&gt;It takes $npc1.him a little while before $npc1.he can find a tailor&#39;s measuring tape long enough. 
&lt;&lt;/if&gt;&gt;
After $npc1.he has your dimensions written down, $npc1.he takes the _clothing.name to the back and begins working on it. Faster than what might otherwise seem possible, $npc1.he comes back with the _clothing.name better tailored to fit you. &lt;/p&gt;

&quot;There you are $p.sir. Is there anything else I can help you with?&quot; 
&lt;&lt;doGld $eventCounterB&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="196" name="Cook food" tags="" position="2475,1425" size="100,100">&lt;&lt;set _waiter = &quot;waiter&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _waiter = &quot;waitress&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

You offer to help cook, and are led back to the kitchen, where you see what at first appears to be 3 identical &lt;&lt;=$npc2.plural&gt;&gt; manning several stoves and cooking fires. &quot;Hey, $npc2.Name,&quot; the _waiter says. As the &lt;&lt;=$npc2.plural&gt;&gt; come to a stop, you realize that it was just the one, moving VERY fast. &quot;You got an assistant,&quot; $npc1.he continues, then heads back out. The $npc2.species gives you a looking over, then nods at you silently, handing you a chef&#39;s knife and pointing to a massive pile of vegetables on a long table. It is separated into thirds labelled &quot;Dice,&quot; &quot;Slice,&quot; and &quot;Mince.&quot; You wash your hands and go to work. 

&lt;&lt;if $agi &gt; 45 and $int &gt; 45&gt;&gt;
You are able to smoothly cut through everything necessary, leaving the table a pile of variously cut ingredients in spite of $npc2.Name rushing up and placing more on top every once in a while and taking large amounts away. With your speed and skill, you even find the time to exercise your knowledge of recipes and get some cooking in yourself on a couple of stoves, much to $npc2.Name&#39;s relief. The _waiter eventually returns with a pouch of gold, which you take as a sign that you&#39;ve done enough. &quot;$npc2.Name&#39;s taciturn, but trust me: $npc2.He thinks you did a good job today, and so&#39;s the boss. Take this for your trouble, and come help again whenever you want.&quot; $npc1.He gives you the gold and a tired, but honest smile, and you head back out with your coin purse a bit fuller. 
&lt;&lt;doGld 40&gt;&gt;

&lt;&lt;else&gt;&gt;
As you do, $npc2.Name slides the ingredients onto a plate and dumps them into various cooking equipment. You don&#39;t have the time to prepare a single dish yourself, but still prove useful. The _waiter returns with a small pouch of gold after a few hours, which you take as a sign to stop. &quot;$npc2.Name&#39;s taciturn, but trust me: $npc2.He appreciates you helpin&#39; him out, and so&#39;s the boss. Here you go, hon.&quot; $npc1.He gives you the gold and a tired, but honest smile, and you head back out with your pockets jingling. 
&lt;&lt;doGld 10&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;doTime 240&gt;&gt;
&lt;&lt;stamina -50&gt;&gt;
&lt;&lt;getQuest $cookedFood&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;A job well done&quot; &quot;Restaurant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="197" name="Defeated" tags="city" position="2850,2100" size="100,100">&lt;&lt;createFixedNPC &quot;priest&quot;&gt;&gt;
&lt;&lt;set _priest = &quot;priest&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _priest = &quot;priestess&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 3&gt;&gt;

&lt;&lt;endCombat&gt;&gt;
&lt;&lt;set $mana = 0&gt;&gt;
&lt;&lt;set $sta = 100&gt;&gt;
&lt;&lt;set $ate = 0&gt;&gt;
&lt;&lt;set $inf = 0&gt;&gt;
&lt;&lt;set $infMass = 0&gt;&gt;
&lt;&lt;set $cal = 0&gt;&gt;
&lt;&lt;set $gld -= 10&gt;&gt;
&lt;&lt;if $gld &lt; 0&gt;&gt;&lt;&lt;set $gld = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;removeStatus&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&lt;&lt;rest&gt;&gt;
&lt;&lt;set $hea = Math.round($maxHea * 0.5)&gt;&gt;
&lt;&lt;set $alive = true&gt;&gt;


&lt;&lt;switch $defeatedBy&gt;&gt;
&lt;&lt;case &quot;battle&quot;&gt;&gt;
&lt;p&gt;You eventually wake up some time later and slowly open your eyes.You sit up and rub your aching head and find yourself covered in bandages and sitting on a hospital bed. You still have several aches and bruises, but otherwise look none the less for wear. &lt;/p&gt;

&quot;In my professional opinion, it looks like you got your butt whooped by $e.article $e.name. You should be more careful next time.&quot; a doctor says as $npc2.he hands you back your equipment without further explanation. You take off the bandages and put your stuff back on before hopping off your bed.
&lt;&lt;action &quot;c&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
				
&lt;&lt;case &quot;devoured&quot;&gt;&gt;
&lt;p&gt;You awake on an altar. Looking around you eventually realize you&#39;re laying in the city&#39;s church. You look over and see the preacher standing beside you. &lt;/p&gt;

&quot;Though the fates may save &#39;ye from a terrible... fate, they exact a steep price! Hopefully in the future you won&#39;t stray so far into danger. Now please move if you would. Adventurers keep popping into existence here for some reason.&quot;  
&lt;&lt;action &quot;c&quot; &quot;church&quot; &quot;Church&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;exploded&quot;&gt;&gt;
&lt;p&gt;You awake with a jolt and sit bolt upright. Remembering your previous encounter you grab your $waist and thankfully find it apparently all in one peice. Although you&#39;re aboslutely covered in bandages and looking around confirms that you&#39;re in the hospital. &lt;/p&gt;

&lt;p&gt;A startled doctor standing by your bed turns to you and smiles, &quot;Oh excellent, you actually woke up! I almost lost five gold on you. Well the good news is that we somehow managed to put you back together. At least we&#39;re pretty sure anyway. Although the bad news is you&#39;re now horrendously ugly.&quot; You immediately tear off your bandages and thankfully find yourself just as good looking as you were before. You glare up at the doctor. &lt;/p&gt;

$npc2.He slaps you on the shoulder, &quot;Ha ha, just messing with you kid. Keep up the good work.&quot; $npc2.he adds sarcastically as he absentmindedly wanders off to check up on other patients. You gruffly pick up your stuff and head out. 
&lt;&lt;action &quot;c&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;overeating&quot;&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;You blink the sleep from your eyes as you are awakened by a loud and low groaning and gurgling noise. You quickly notice that the source of this noise is you painfully distended stomach protesting being stretched to the absolute bursting point. You gently massage your exposed gut and moan in pain and can practically feel the stretch marks coursing across your bloated waist. &lt;/p&gt;

&lt;p&gt;$npc2.Article $npc2.species standing next to you in doctors scrubs says, &quot;Oh good, you&#39;ve regained conciousness. I have some good news and some bad news. The good news is that some kind citizen managed to drag you back here. Quite impressive given your state! The bad news is that you&#39;re about to explode like a pinata.&quot; Your stomach picks that moment to let out a particularly loud groan. &quot;But don&#39;t worry, you&#39;re in //very// good hands and you&#39;ll be right as rain in no time!&quot; $npc2.he smiles reassuringly and gives you a hearty pat on the gut. &lt;/p&gt;

&lt;p&gt;This proves to have been a very poor idea as your vastly overinflated stomach makes an awful loud gurgling noise and begins to jiggle alarmingly from the impact.&lt;/p&gt;

&lt;p&gt;&quot;Oh, whoops.&quot; the doctor says as $npc2.he ducks for cover just in time for your stomach to finally give out one final groan and explode like the pinata it was described as. As you pass out from the pain you hear the doctor say to $npc2.himself &quot;You know, you&#39;d think I&#39;d learn to stop tempting fate like that.&quot; &lt;/p&gt;

&lt;p&gt;Some time later you awake with a start and sit bolt upright in your hospital bed. A different doctor is standing by your bed this time. &quot;Oh good, you&#39;re awake again.&quot; $npc3.he says as $npc3.he notes something down on a clipboard. &quot;Very sorry about that, we&#39;ve had to hire a lot of new interns lately what with the drastically increased need for doctors. We had our best people on the case though and we were able to put you back together good as new. Feel free to leave whenever you&#39;re ready.&quot; In the distance you can just barely hear someone say, //&quot;right as rain&quot;// shortly followed by a loud explosion. &lt;/p&gt;

&#39;&#39;&quot;Oh damn it!&quot;&#39;&#39; exclaims the doctor as $npc3.he hurries off towards the sound of the noise. After watching $npc3.him leave, you pick up your belongings and head out before anything else goes wrong.

&lt;&lt;elseif !$options.popping&gt;&gt;

&lt;p&gt;You blink the sleep from your eyes and wake up to find yourself lying on a hospital bed. $npc2.Article $npc2.species wearing doctors scrubs walks up to your bed. $npc2.He looks down at a clipboard before addressing you. &lt;/p&gt;

&quot;Looks like a distinct case of overeating. We&#39;ve been getting that a lot lately.&quot; the doctor says half to $npc2.himself, &quot;All we can do is let &#39;em sleep it off. You should be fine to go, just make sure you don&#39;t overdo it again any time soon alright?&quot; $npc2.He gives you a wink and a good natured punch on the arm before walking off to deal with $npc2.his other patients. 
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;floating&quot;&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;As you continue to fly away, you feel dizzy from the thinning air, as well as extremely unwell. The pressure from inside you is acting upon the lesser air pressure from outside, stretching your skin even further. To your horror, you’re bloating up even bigger than you were before, and it’s becoming worryingly clear that your body can’t take much more. Your stomach is letting out all sorts of horrible groaning and creaking noises as your vision is starting to go black. You can’t tell if it’s your failing consciousness or getting close to escaping the atmosphere. &lt;/p&gt;

&lt;p&gt;You can tell that you’re close to breaking point because your discomfort is turning to pain. You can’t even alleviate your pressure by burping because your mouth is pinned shut by your own bloated middle. After your body lets out one huge, final groan, you register the start of an ear-shattering explosion before everything goes black and quiet. Just as soon as that blackness swallowed you, you suddenly find yourself awakening in a hospital room, sitting bolt upright with a startled yell. The doctors and a few other patients look at you.
&lt;/p&gt;

&quot;Hello there, $name. I see you’re finally awake from your little... flight of fancy. Took a lot of bandages and healing potions to put you back together, but we think you’ll make a &#39;&#39;full&#39;&#39; recovery. Just try and take it easy from now on, alright?&quot; The doctor says, looking you over. You get out from the hospital later that day, looking at yourself in a mirror in the bathroom before you go. The doctors were right – they did wonders on fixing you, without leaving so much as a hairline scar. You leave your hospital room, finally feeling ready to hit the road once more.
&lt;&lt;action &quot;c&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif !$options.popping&gt;&gt;
&lt;p&gt;As you continue to fly away, you feel dizzy from the thinning air, as well as somewhat unwell and lethargic. You wiggle helplessly as the wind continues to make you drift away. You’re aware of some small specks of people far below looking at you before you pass out. As you come to, you feel a few leaves in your mouth and spit them out. Looking around, you see a large amount of green foliage, and realise your little flight came to an end at some point while you were out. Whether it was due to an unconscious reflex of expelling the air from your body, colliding with a bird in the air, or the lack of air pressure having its way with you, you’re uncertain of that fact. What you are certain of however, is that however your flight ended you landed in a large tree in town. &lt;/p&gt;

You carefully let yourself down from the tree, and inspect yourself for any damage, and see that your body looks fine. However, a quick search of your belongings finds you a little lighter in the gold department – some of it must have fallen out during your drifting. You also feel very hungry, indicating that you were unconscious from the crash landing for a small while. Brushing off both the leaves and the odd looks you’re getting, you walk away from the tree. 
&lt;&lt;action &quot;c&quot; &quot;road&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
					
&lt;&lt;case &quot;transformed&quot;&gt;&gt;
&lt;p&gt;You awake with a start and sit upright. You grab yourself all over and are relieved to find your body is back in it&#39;s expected $p.species state and not permanently transformed. &lt;/p&gt;

&quot;There are many perils to meddling in the way of dark magics. Be thankful that your form has been returned to you.&quot; The stern voice of the churches _priest chides you. You&#39;ve found yourself sitting upon the altar of the city&#39;s church. 
&lt;&lt;action &quot;c&quot; &quot;church&quot; &quot;Church&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
				
&lt;&lt;default&gt;&gt;
I&#39;m not sure how you died, but something went terribly wrong. And you should probably report this error! 
&lt;&lt;action &quot;c&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;set $defeatedBy = &quot;&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="198" name="Donut shop" tags="" position="2625,1625" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="199" name="Eastern Road" tags="city" position="3125,2100" size="200,100">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

You&#39;re standing on the dirt road east out of the city. To the north there is a dense forest. To the south are rolling foothills leading up towards the mountain. 


&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Eastern Road&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;gate&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;forest&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;forest&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;forest&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="200" name="Embroider clothes with gold" tags="" position="3350,1725" size="100,100">Taking the thread and the desired clothing, the $npc1.species excuses $npc1.himself momentarily, returning with a freshly-tailored, gold-threaded update. &quot;There! One size will fit all, no matter your size!&quot; 

&lt;&lt;if $eventCounterA == &quot;top&quot;&gt;&gt;
&lt;&lt;set $top.size = 0&gt;&gt;
&lt;&lt;set $top.popped = false&gt;&gt;
&lt;&lt;set $top.value += 200&gt;&gt;
&lt;&lt;set $top.description += &quot;This item of clothing is embroidered with an enchanted gold thread that causes it to never break. &quot;&gt;&gt;

&lt;&lt;elseif $eventCounterA == &quot;btm&quot;&gt;&gt;
&lt;&lt;set $btm.size = 0&gt;&gt;
&lt;&lt;set $btm.popped = false&gt;&gt;
&lt;&lt;set $btm.value += 200&gt;&gt;
&lt;&lt;set $btm.description += &quot;This item of clothing is embroidered with an enchanted gold thread that causes it to never break. &quot;&gt;&gt;


&lt;&lt;else&gt;&gt;
&lt;&lt;set $inventory[$eventCounterA].size = 0&gt;&gt;
&lt;&lt;set $inventory[$eventCounterA].popped = false&gt;&gt;
&lt;&lt;set $inventory[$eventCounterA].value += 200&gt;&gt;
&lt;&lt;set $inventory[$eventCounterA].description += &quot;This item of clothing is embroidered with an enchanted gold thread that causes it to never break. &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="201" name="General Store" tags="" position="3050,1500" size="100,100">&lt;&lt;createFixedNPC &quot;generalStore&quot;&gt;&gt;

You $walk into the general store, a small, cluttered structure with barely any space to walk around with all the oddities and tools on display. A pudgy $npc1.species fellow in slightly dirty clothes sits behind a counter that is, itself, piled high with assorted goods that $npc1.he is inspecting. When $npc1.he gets a good view of you, $npc1.he waves and says, &quot;Welcome, adventurer. You buy, I buy. Everybody buys here. Let me know if you want to do business.&quot; 
&lt;hr&gt;

&lt;&lt;vendor &quot;general store&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;general store&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Talk to general store clerk&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="202" name="Grocery Store" tags="" position="2800,1500" size="100,100">&lt;&lt;createFixedNPC &quot;grocer&quot;&gt;&gt;

You walk into the grocery store, which is nearly as packed as the restaurant. Several furs in aprons are quickly bustling about carrying loads of food out to display shelves, which are emptied nearly as fast as they are filled. A few &lt;&lt;=setup.getSpeciesData(&quot;penguin&quot;).plural&gt;&gt; waddle about about, arms full of iced meats to fill their stocks. One fat and happy looking $npc1.species $npc1.gentleman walks up to you, clearly the proprietor of the place, and greets you warmly, &quot;Welcome to my store. We&#39;re quite busy, but have everything you need. Feel free to browse the ingredients or the pre-made meals.&quot; As $npc1.he speaks, $npc1.he gestures to the main floor, then to the deli off to the side, which is also busy but well staffed. 

&lt;hr&gt;

&lt;&lt;vendor &quot;grocery store&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;grocery store vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Talk to grocery clerk&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="203" name="List your clothes" tags="" position="3150,1725" size="100,100">Choose something to embroider:
&lt;hr&gt;
&lt;&lt;if $top.size &gt; 0 and $top.size != null&gt;&gt;
	&lt;&lt;link $top.Name &quot;Tailor clothing&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;top&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt; (Equipped)
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $btm.size &gt; 0 and $btm.size != null&gt;&gt;
	&lt;&lt;link $btm.Name &quot;Tailor clothing&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;btm&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt; (Equipped)
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;

	&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $inventory[_i].size &gt; 0 and $inventory[_i].size != null&gt;&gt;
			&lt;&lt;link $inventory[_i].Name &quot;Tailor clothing&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = _i&gt;&gt;
			&lt;&lt;/link&gt;&gt;
			&lt;br&gt;
		
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/for&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Back&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="204" name="Market Square" tags="" position="2925,1625" size="200,100">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;You&#39;re standing in the main city of the area. Longer than recorded history this city has stood in the shadow of the eastern mountains, isolated from the goings on in the rest of the world. The coblestone streets are well worn and smoothed over from centuries of horse, cart, and foot traffic. The streets are lined by old wood and stone buildings. 
&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;include &quot;Ambient city&quot;&gt;&gt;

&lt;&lt;include &quot;market square movement&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="205" name="Offer gold thread" tags="" position="3250,1625" size="100,100">&lt;&lt;if setup.questStarted($foundGoldThread)&gt;&gt;
	&quot;Ah! A gold thread!&quot; The $npc1.species steps up, getting a good look at it. &quot;Yep, and it&#39;s just as magical as ever. So then, what&#39;ll it be?&quot; 
&lt;&lt;else&gt;&gt;
	&lt;p&gt;You withdraw a length of Gold Thread, holding it out to the $npc1.species. At first, $npc1.he gives you a curious look, before stepping closer and getting a better look at it. $npc1.His eyes widen and $npc1.he seems to realize what you&#39;re presenting $npc1.him. &lt;/p&gt;
	
	&lt;p&gt;&quot;This...I know this thread.&quot; $npc1.He explains, a bit shocked. &quot;It was made by my $npc2.brother. How did you manage to get this from $npc2.him? $npcs2.He&#39;s incredibly powerful!&quot; The slim $npc1.species puts a $npc1.hand to $npc1.his head in bewilderment, before retaining $npc1.his composure. &quot;Well, however you got it, I&#39;m glad to see it. It probably means either my $npc2.brother finally got what was coming to $npc2.him, or at least learned a lesson.&quot; $npc1.He smiles at you, looking you up and down. &quot;But on to more pressing matters. There&#39;s three things I can do here. Either I can stitch this into a piece of clothing you already wear, making it stretch enough to fit you, no matter what. I can reward you with 500 gold. Or if you prefer, I could weave it into a bracelet for you, which, when worn, would make your body able to expand more. So what will it be?&quot; &lt;/p&gt;
&lt;&lt;getQuest $foundGoldThread&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;1&quot; &quot;gold&quot; &quot;Sell it&quot; &quot;Use golden thread&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;gold&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;2&quot; &quot;tailor&quot; &quot;Embroider clothing&quot; &quot;Use golden thread&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;embroider&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;3&quot; &quot;other&quot; &quot;Make a bracelet&quot; &quot;Use golden thread&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;bracelet&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Nevermind&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="206" name="Order food" tags="" position="2255,1425" size="100,100">&lt;&lt;set _waiter = &quot;waiter&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _waiter = &quot;waitress&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;
&lt;&lt;case &quot;Cheap meal&quot;&gt;&gt;
	You ask for something to fit an extremely tight budget and plunk down a couple of coins. The _waiter heads off and starts and eventually returns with a tiny plate of food and a glass of water. A dish this small can&#39;t make you help but feel like this is from the kid&#39;s menu. But maybe that&#39;s just because the dish is arranged to make a smiley face. 
	&lt;&lt;consume 4 2&gt;&gt;
	&lt;&lt;doTime 15&gt;&gt;
	&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -3&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		It&#39;s not the best, but it&#39;s a meal. 
		&lt;&lt;set $status.wellFed = 5&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt; 60&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 60&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You lean back and let out a groan, your $waist belly far too full after your last meal. When the _waiter notices this, $npc1.he calls out flatly, &quot;Hey Doc, got another one here.&quot; It is the last thing you hear as you drift off to unconsciousness, thoughts of food flitting through your mind. 
		&lt;hr&gt;&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;case &quot;Normal meal&quot;&gt;&gt;
	You order a regular meal and put down some coins. The _waiter heads off to the kitchen, yelling out some garbled nonsense that the cook manages to correctly interpret. A few minutes later, $npc1.he delivers a steaming plate loaded with a healthy variety of foodstuffs, which you chow down ravenously. 
	&lt;&lt;consume 10 7&gt;&gt;
	&lt;&lt;doTime 30&gt;&gt;
	&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -6&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		It feels nice to eat a fresh, expertly prepared meal. 
		&lt;&lt;set $status.wellFed = 5&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt; 120&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 120&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You lean back and let out a groan, your $waist belly far too full after your last meal. When the _waiter notices this, $npc1.he calls out flatly, &quot;Hey Doc, got another one here.&quot; It is the last thing you hear as you drift off to unconsciousness, thoughts of food flitting through your mind. 
		&lt;hr&gt;&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;case &quot;Large meal&quot;&gt;&gt;
	You order a generous amount of food and pay a bit of gold. The _waiter heads off to the kitchen after writing down everything, hangs the order and yells &quot;Order up!&quot; The kitchen bustles with activity, and a while later, you are delivered several plates piled high with meats, cheeses, vegetables, sauces, and grains. Your drink is comically tiny in comparison. 
	&lt;&lt;consume 22 15&gt;&gt;
	&lt;&lt;doTime 45&gt;&gt;
	&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -12&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		You devour it all hungrily, then lean back and pat your $waist stomach, warmed and comforted by the well-cooked meal. 
		&lt;&lt;set $status.wellFed = 5&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt; 180&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 180&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You lean back and let out a groan, your $waist belly far too full after your last meal. When the _waiter notices this, $npc1.he calls out flatly, &quot;Hey Doc, got another one here.&quot; It is the last thing you hear as you drift off to unconsciousness, thoughts of food flitting through your mind. 
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;case &quot;Huge meal&quot;&gt;&gt;
	You decide to splurge and order a couple of meals worth of food, putting down a small pile of gold. The _waiter quickly writes down everything and repeats it all back to you, which is a fairly lengthy process. Afterwards, $npc1.he takes the order back to the kitchen, and the kitchen bustles with fervent activity. A while later, the _waiter returns with a completely loaded cart of dishes and trays, which soon becomes a full table of food, various noodle, meat and rice dishes side by side with a few early desserts and large, decadent soups. You feverishly demolish it all, scraping plates and licking bowls to get every last bit of the delicious meal into your mouth and down your throat.
	&lt;&lt;consume 54 38&gt;&gt;
	&lt;&lt;doTime 60&gt;&gt;
	&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -24&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		When you&#39;re done, you let out a breath, leaning back and rubbing your $waist stomach while you enjoy the feeling of well made food filling you. 
		&lt;&lt;set $status.wellFed = 5&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt; 240&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 240&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You lean back and let out a groan, your $waist belly far too full after your last meal. When the _waiter notices this, $npc1.he calls out flatly, &quot;Hey Doc, got another one here.&quot; It is the last thing you hear as you drift off to unconsciousness, thoughts of food flitting through your mind. 
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;case &quot;Too much food&quot;&gt;&gt;
	You go a little crazy, ordering entire columns from the menu, paying up a large pile of gold, and are subsequently led away from your table and to a significantly larger banquet table. The _waiter foregoes writing down your order, simply circling large parts of a menu, and heads off to the kitchen, which visibly lights up from the sudden increase in working ovens and fires. After a good while, the _waiter begins to wheel out fully loaded carts and setting out their contents on the table. You don&#39;t even wait until $npc1.he&#39;s finished before you start eating everything in sight. Time passes, appetizers eventually giving way to meals, meals eventually giving way to desserts, and drinks being available by the double-fistful the whole time. It takes a while before you&#39;re done, and several of the dishes you ate on at the start have had time to be cleaned, dried, and piled high with more food for you before it&#39;s over. 
	&lt;&lt;consume 126 81&gt;&gt;
	&lt;&lt;doTime 120&gt;&gt;
	&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -48&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		You let out a comforted hum, leaning back lazily to rub your $waist belly, the delightful feast making you feel warm and happy. 
		&lt;&lt;set $status.wellFed = 5&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt; 300&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 300&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You lean back and let out a groan, your $waist belly far too full after your last meal. When the _waiter notices this, $npc1.he calls out flatly, &quot;Hey Doc, got another one here.&quot; It is the last thing you hear as you drift off to unconsciousness, thoughts of food flitting through your mind. 
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;case &quot;Way too much food&quot;&gt;&gt;
	You hand the menu back, ordering it all. The _waiter blanches at this, but shakes $npc1.his head and says &quot;Alright, if that&#39;s what you want&quot; as you hand $npc1.him a huge amount of gold. $npc1.He heads to the kitchen to deliver your order, and it becomes a din of clanging pots and pans and glowing fires. Before too long, you are being delivered entire meals three at a time. By the time you&#39;re done with them, another set is being delivered. Used dishes pile up, clean and empty in the wake of your hungering mouth. Food piles up in your belly as the hours stretch on, and you refuse to even slow down. Eventually, you have tasted every appetizer, breakfast, lunch, dinner, dessert, and drink the restaurant has to offer, and eaten enough that some people have stopped their daily activities just to watch you ram tremendous amounts of food down your gullet in morbid fascination. 
	&lt;&lt;consume 300 210&gt;&gt;
	&lt;&lt;doTime 180&gt;&gt;
	&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;doGld -96&gt;&gt;
	&lt;&lt;if $alive&gt;&gt;
		You let out a happy groan and rub your $waist stomach, the heavy weight of it actually making you feel quite good. 
		&lt;&lt;set $status.wellFed = 5&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt; 360&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 360&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You lean back and let out a groan, your $waist belly far too full after your last meal. 
		&lt;&lt;if $options.popping&gt;&gt;
			&lt;p&gt;When the _waiter notices that your gluttonous rampage has ground to a halt, $npc1.he comes by to offer you a mint to polish off your feast. In your glutted stupor, you can’t seem to express that you are too full... even for a Wafer. Thin. Mint. &lt;/p&gt;
			The $npc1.species pokes the mint into your mouth and you reflexively swallow. &quot;There, now. That should help settle your stomach.&quot; $npc1.He beams innocently. You feel the intrepid wafer descend to your stomach and settle like a stone. 
			&lt;&lt;consume 1&gt;&gt;
			&lt;p&gt;A sharp pain grips the center of your gut. Your stretched belly lets out a worrisome moan as it begins to swell. The _waiter takes a step back, but $npc1.he is too slow. Your overtaxed stomach explodes in a tidal wave of half-digested goo. &lt;/p&gt;
			The _waiter wipes some &quot;soup-of-the-day&quot; from $npc1.his face and sighs, &quot;This’ll take forever to clean up. $p.He made a bigger mess than Beck and Pete did, combined!&quot; 
			&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

		&lt;&lt;else&gt;&gt;
			When the _waiter notices this, $npc1.he calls out flatly, &quot;Hey Doc, got another one here.&quot; It is the last thing you hear as you drift off to unconsciousness, thoughts of food flitting through your mind. 
			&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="207" name="Repair old worn pants" tags="" position="3250,1825" size="100,100">&lt;&lt;if setup.questStage($horseQuestClothes) == 0&gt;&gt;

&lt;p&gt;The $npc1.species&#39;s expression as you produce such an ancient, threadbare garment is one of polite, fastidious horror. When you hand over the measurements to go with them, and explain, $npc1.his expression is more of incredulity. &quot;I remember $npc3.name Shire, of course!&quot; Still clutching the note, the $npc1.species looks down at the atrocious pants, and comments vaguely, &quot;I recall that $npc3.his hindquarters were ALWAYS built a little too generously for a conventional fit...&quot; $npc1.He takes the pants through to his work-room. But $npc1.he returns very quickly, shaking $npc1.his head over the measurements. &quot;I&#39;m very sorry, but I just don&#39;t have enough suitable material to make the adjustments- or even to make a new pair- in THIS size! Quite honestly I don&#39;t think any of our standard fabrics would cut it, anyway. If you&#39;re willing to help me, I think the only thing that will work is magical cloth- the sort they make at the Mage&#39;s Guild. I have some experience at making alterations with that- even Mages want their robes letting out from time to time...&quot; &lt;/p&gt;

&lt;p&gt;$npc1.He looks doubtfully at the list of measurements again. &quot;I&#39;m not sure that even an Apprentice&#39;s robes will do, it&#39;ll have to be a full Wizard&#39;s Robe to provide sufficient support. If you can get me a Wizard&#39;s Robe, I think that I should be able to make $npc3.name some new pants. And of course I&#39;ll pay you back for the robe- I&#39;ll just add it to &#39;&#39;$npc3.his&#39;&#39; bill.&quot;&lt;/p&gt;

&lt;&lt;advanceQuest $horseQuestClothes&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;elseif setup.hasItem($wizardsRobes) &gt;= 0&gt;&gt;
&quot;Ah, of course!&quot; The $npc1.species&#39;s face lights up with pleasure. $npc1.He takes the robe to the back and begins working on it. Faster than what might otherwise seem possible, $npc1.he comes back with an extremely large pair of pants, heavily patched with gaudy material from the wizard&#39;s robe. &quot;There you are $p.sir. Is there anything else I can help you with?&quot; 
&lt;&lt;removeItem $wizardsRobes&gt;&gt;
&lt;&lt;removeItem $horsePantsBroke&gt;&gt;
&lt;&lt;getItem $horsePantsFixed&gt;&gt;
&lt;&lt;doGld 65&gt;&gt;
&lt;&lt;advanceQuest $horseQuestClothes&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;else&gt;&gt;
You&#39;re about to ask about the pants again, but then you remember; you have to get a set of wizard&#39;s robes for the tailor to use. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh yeah&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="208" name="Restaurant" tags="" position="2375,1625" size="100,100">&lt;&lt;createFixedNPC &quot;waitress&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;cook&quot; 2&gt;&gt;
&lt;&lt;set _waiter = &quot;waiter&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _waiter = &quot;waitress&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $eventCounterA != &quot;&quot;&gt;&gt;&lt;p&gt;&lt;&lt;include&quot;Order food&quot;&gt;&gt;&lt;/p&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;It is jam-packed with people in various states of overwhelming obesity eating huge portions of food. Eventually, you are shown to a seat by a heavy-set $npc1.species $npc1.gentleman whose every motion showcases exhaustion. &quot;Payment in advance in case you overstuff yourself, what can I get for ya?&quot; $npc1.he drones out, $npc1.his voice a tired monotone. &lt;/p&gt;

&lt;p&gt;A nearby menu has a convenient, if vague, price list. 
&lt;li&gt;Cheap meal: 3 gold&lt;/li&gt;
&lt;li&gt;Normal meal: 6 gold&lt;/li&gt;
&lt;li&gt;Large meal: 12 gold&lt;/li&gt;
&lt;li&gt;Huge meal: 24 gold&lt;/li&gt;
&lt;li&gt;Too much food: 48 gold&lt;/li&gt;
&lt;li&gt;Way too much food: 96 gold&lt;/li&gt;&lt;/p&gt;

&lt;&lt;if $gld &gt; 3&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;restaurant&quot; &quot;Cheap meal&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Cheap meal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt; 6&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;restaurant&quot; &quot;Normal meal&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Normal meal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt; 12&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;restaurant&quot; &quot;Large meal&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Large meal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt; 24&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;restaurant&quot; &quot;Huge meal&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Huge meal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt; 48&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;restaurant&quot; &quot;Too much food&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Too much food&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt; 96&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;restaurant&quot; &quot;Way too much food&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Way too much food&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Talk to the waitress&quot;&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;quest&quot; &quot;Work at the restaurant&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;se&quot; &quot;leave&quot; &quot;Central Square&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;
&lt;&lt;/action&gt;&gt;
/*FEEDER EXPANSION EDIT - START*/
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;feeder_vendor &quot;restaurant&quot;&gt;&gt;
	&lt;&lt;action &quot;sw&quot; &quot;store&quot; &quot;Order to go&quot; &quot;To Go Counter&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
/*FEEDER EXPANSION EDIT - END*/
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="209" name="Sleep" tags="" position="2625,1225" size="100,100">You climb into bed and curl up under the covers and close your eyes as you drift off into sleep. 
&lt;&lt;if setup.weight() &gt; 400&gt;&gt;
	The bed creaks ominously under your weight. 
&lt;&lt;/if&gt;&gt;
&lt;&lt;sleep&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Wake up&quot; &quot;Your House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Sleep&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="210" name="Southern Road" tags="city" position="2550,2275" size="100,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

You&#39;re standing on the dirt road south of the city. To the west are the open grasslands where there are several farms near the road. To the east are the rocky foothills leading up towards the mountains. 


&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Southern Road&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;gate&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="211" name="Tailor" tags="" position="3150,1625" size="100,100">&lt;&lt;createFixedNPC &quot;tailor&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;tigerBoss&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;sampson&quot; 3&gt;&gt;

You walk into the tailor&#39;s shop. A slim $npc1.species in a finely made suit asks you, &quot;Is there anything I can help you with $p.sir?&quot; 

&lt;&lt;action &quot;c&quot; &quot;tailor&quot; &quot;Tailor your clothes&quot; &quot;List your clothes&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;if setup.hasItem($goldThread) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Offer gold thread&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questActive($horseQuestClothes)&gt;&gt;
	&lt;&lt;action &quot;se&quot; &quot;quest&quot; &quot;Repair old worn pants&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Market Square&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You leave the tailor&#39;s shop. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="212" name="Tailor clothing" tags="" position="3150,1825" size="100,100">&lt;&lt;if $eventCounterA == &quot;top&quot;&gt;&gt;&lt;&lt;set _clothing = $top&gt;&gt;
&lt;&lt;elseif $eventCounterA == &quot;btm&quot;&gt;&gt;&lt;&lt;set _clothing = $btm&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set _clothing = $inventory[$eventCounterA]&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _size = Math.round(setup.waistDiameter() * 1.2 + 3)&gt;&gt;

&lt;&lt;set _cost = Math.round((_clothing.value/_clothing.size) * (_size - _clothing.size))&gt;&gt;

&lt;&lt;if _cost &lt; 0&gt;&gt;&lt;&lt;set _cost *= -1&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if _clothing.popped&gt;&gt;
	&lt;&lt;set _cost += Math.round(1 + (_clothing.value*0.1))&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _cost &gt; 0&gt;&gt;
	Do you want to tailor this? It will cost _cost gold to tailor. 
	&lt;hr&gt;
	&lt;&lt;if $gld &lt; _cost&gt;&gt;//(Not enough gold)//&lt;br&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Yes!&quot; &quot;Clothing tailored&quot;&gt;&gt;
			&lt;&lt;set $eventCounterB = _cost*-1&gt;&gt;
		&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Nevermind&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	That article of clothing doesn&#39;t need tailoring. 
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="213" name="Talk to cow clothier" tags="" position="2925,1400" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the clothier&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;My name is $npc1.Name, and I&#39;ve made all the clothes you see here. My &lt;&lt;if $npc2.male == &quot;male&quot;&gt;&gt;husband&lt;&lt;elseif $npc2.male == &quot;female&quot;&gt;&gt;wife&lt;&lt;else&gt;&gt;partner&lt;&lt;/if&gt;&gt;, $npc2.Name, is quite a bit more busy, as $npc2.he works the alterations and mending.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;&lt;set _colorA = either(&quot;red&quot;,&quot;black&quot;,&quot;blue&quot;)&gt;&gt;
&lt;&lt;set _colorB = either(&quot;green&quot;,&quot;white&quot;,&quot;orange&quot;)&gt;&gt;

&quot;If you want my opinion, I think you might try something in a nice _colorA. Or perhaps _colorB might suit your tastes?&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;A mage came through here a while back, asked for my most colorful cloth. I showed him a bright green bolt of fabric, but he didn&#39;t find it gaudy enough. Mages! No sense of fashion, the lot of them.&quot; 
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="214" name="Talk to general store clerk" tags="" position="3050,1400" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the general store clerk&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Name&#39;s $npc1.Name. You might&#39;ve heard that I&#39;m a hoarder. Don&#39;t believe those people; all this stuff is good, and I&#39;m perfectly willing to give it away in exchange for gold. Or something else good.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;With times as strange as they are, I&#39;ve been getting a lot more adventurers, and I tell &#39;em all the same things: First off, make sure you got gear. Second, make sure you got potions. Third, let me buy what you don&#39;t need.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;The potions I have are my most popular items, for true. But that doesn&#39;t mean you can&#39;t buy anything else here. If nothing catches your eye right off, give me a bit of time. I&#39;m sure I&#39;ll have something for you to buy.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Listen, little free advice for you, adventurer: If you&#39;re in over your head, escape. The goddess of courage watches out for you, sure, but there&#39;s a fine line between courage and getting eaten by something too big for you.&quot; 
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="215" name="Talk to grocery clerk" tags="" position="2800,1400" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the grocery store clerk&quot;&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;I&#39;ve had to hire a lot of help lately, but there&#39;s as little shortage of folks willing to work with food as there is folks willing to eat it, so I&#39;m set.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;We&#39;re getting more food faster all the time, but it goes out faster every day, too. Can&#39;t complain, it&#39;s made me a good bit of gold, but it is starting to make me wonder.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Everything here is locally grown, and all the meats are packed with magically enchanted ice to stay cold and fresh until you eat it.&quot; 
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="216" name="Talk to the armorer" tags="" position="3175,1400" size="100,100">&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;The name&#39;s $npc1.Name. I&#39;ve worked this forge since I was at me pappy&#39;s knee.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;I specialize in making steel armors. I&#39;ve not the heart to make something truly dangerous, truth be told, but I do have some basic weapons for defending yerself.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;If you&#39;re looking for more dangerous kit, head westward along the road and towards the seaside town. They import more dangerous gear from an island out west, I&#39;m told.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;I was in contact with a smith out east near the mountains, shared some fine knowledge with $npc2.him. Lately $npc2.he&#39;s stopped writing me, though. I do hope $npc2.he&#39;s alright.&quot; 
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="217" name="Talk to the waitress" tags="" position="2475,1625" size="100,100">&lt;&lt;set _waiter = &quot;waiter&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _waiter = &quot;waitress&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;setPopupTitle &quot;Talk to the _waiter&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Name&#39;s Deb, I&#39;ll be your _waiter today, seein&#39; as Beck and Pete both ate themselves into the hospital last night.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;No offense, hon, but I&#39;m way too busy for chit-chat. Place your order or I have to get to the next customer to keep up.&quot; 

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="218" name="The Armory" tags="" position="3175,1500" size="100,100">&lt;&lt;createFixedNPC &quot;armorer&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;smith&quot; 2&gt;&gt;

You step into the Armory, greeted by the sounds of hammer hitting anvil, the heat of a working forge, and the sight of a shirtless, thick-bodied $npc1.species at work. $npc1.He looks up at you and rumbles out, &quot;Welcome to the Armory. Don&#39;t hesitate to ask if ye&#39;ve any interest in my works.&quot; 
&lt;hr&gt;

&lt;&lt;vendor &quot;armory vendor&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;armorer vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Work for the armory&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Talk to the armorer&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;if setup.questActive($horseQuestArmor)&gt;&gt;
	&lt;&lt;icon &quot;talk&quot;&gt;&gt;
	&lt;&lt;popup &quot;Ask about burst chainmail&quot; &quot;Ask about burst chainmail&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="219" name="Training grounds" tags="" position="2225,1625" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;
	&lt;&lt;case &quot;run&quot;&gt;&gt;
	&lt;&lt;if $sta &lt;= 0&gt;&gt;
		You&#39;re too exhausted to even make it to the track, let alone run on it. 
	&lt;&lt;elseif $fat &gt;= 3&gt;&gt;
		You run several laps around the track until your legs are sore. You feel slightly faster. 
		&lt;&lt;changeStats &quot;agi&quot; 0.3&gt;&gt;
		&lt;&lt;changeStats &quot;end&quot; 0.1&gt;&gt;
		&lt;&lt;changeStats &quot;fat&quot; -3&gt;&gt;
		&lt;&lt;doTime 30&gt;&gt;
		&lt;&lt;stamina -20&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You run several laps around the track until your legs are sore. You work up a sweat, but you don&#39;t feel any faster. 
		&lt;&lt;doTime 30&gt;&gt;
		&lt;&lt;stamina -20&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	&lt;&lt;case &quot;lift&quot;&gt;&gt;
	
	
	&lt;&lt;if $sta &lt;= 0&gt;&gt;
		You walk up to the weights, but you&#39;re just too exhausted to even lift them. 
	&lt;&lt;elseif $fat &gt;= 3&gt;&gt;
		You go around lifting various heavy things until your whole body is sore. You feel slightly stronger. 
		&lt;&lt;changeStats &quot;str&quot; 0.3&gt;&gt;
		&lt;&lt;changeStats &quot;end&quot; 0.1&gt;&gt;
		&lt;&lt;changeStats &quot;fat&quot; -3&gt;&gt;
		&lt;&lt;doTime 30&gt;&gt;
		&lt;&lt;stamina -20&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You go around lifting various heavy things until your whole body is sore. You work up a sweat, but you don&#39;t feel any stronger. 
		&lt;&lt;doTime 30&gt;&gt;
		&lt;&lt;stamina -20&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	&lt;&lt;case &quot;rest&quot;&gt;&gt;
	You sit down on one of the park&#39;s benches and have a rest. 
	&lt;&lt;rest&gt;&gt;
	
	
	&lt;&lt;default&gt;&gt;
	&lt;p&gt;You $walk onto the city&#39;s training grounds. There&#39;s an open field where several different musclebound furs lift weights, while several leaner furs run around a dirt track. &lt;/p&gt;

	&lt;&lt;if $sta &lt;= 20&gt;&gt;
	&lt;p&gt;Just watching them makes you realize how tired you are. You don&#39;t feel like you have the energy to exercise right now. &lt;/p&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;


&lt;&lt;action &quot;nw&quot; &quot;next&quot; &quot;Lift weights&quot; &quot;Training grounds&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;lift&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;action &quot;ne&quot; &quot;next&quot; &quot;Run track&quot; &quot;Training grounds&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;run&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Rest&quot; &quot;Training grounds&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;leave&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="220" name="Use golden thread" tags="" position="3250,1725" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

/*===Sell for gold===*/
&lt;&lt;case &quot;gold&quot;&gt;&gt;
The $npc1.species happily trades you a heavy sack of coins for your length of thread, looking very much like $npc1.he got the better end of the deal. 
&lt;&lt;removeItem $goldThread&gt;&gt;
&lt;&lt;doGld 500&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===Embroidery===*/
&lt;&lt;case &quot;embroider&quot;&gt;&gt;
Choose something to embroider with gold thread:
&lt;hr&gt;
&lt;&lt;if $top.size &gt; 0 and $top.size != null&gt;&gt;
	&lt;&lt;link $top.Name &quot;Embroider clothes with gold&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;top&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt; (Equipped)
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $btm.size &gt; 0 and $btm.size != null&gt;&gt;
	&lt;&lt;link $btm.Name &quot;Embroider clothes with gold&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;btm&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt; (Equipped)
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;

	&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $inventory[_i].size &gt; 0 and $inventory[_i].size != null&gt;&gt;
			&lt;&lt;link $inventory[_i].Name &quot;Embroider clothes with gold&quot;&gt;&gt;
				&lt;&lt;set $eventCounterA = _i&gt;&gt;
			&lt;&lt;/link&gt;&gt;
			&lt;br&gt;
		
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/for&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===Bracelet===*/
&lt;&lt;case &quot;bracelet&quot;&gt;&gt;
&lt;&lt;switch setup.questStage($foundGoldThread)&gt;&gt;
&lt;&lt;case 0&gt;&gt;
&lt;&lt;removeItem $goldThread&gt;&gt;
&lt;&lt;advanceQuest $foundGoldThread&gt;&gt;
Getting a quick measurement of your wrist, the $npc1.species quickly and effortlessly works the thread into a thin woven bracelet, handing it back to you. &quot;There you go. Wearing that will definitely effect how much food you can hold on to. Also, if you happen to get more threads, I can weave them into this bracelet, increasing the effect. But there&#39;s no way I could do it more than a few times. I don&#39;t trust this magic enough to know what&#39;ll happen.&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;case 5&gt;&gt;
The $npc1.species puts up $npc1.his $npc1.hands and shakes $npc1.his head, &quot;Oh no. Sorry, but you&#39;ve already got more than enough threads on that thing. I don&#39;t trust putting any more on.&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;default&gt;&gt;
&lt;&lt;removeItem $goldThread&gt;&gt;
&lt;&lt;advanceQuest $foundGoldThread&gt;&gt;
&lt;&lt;set _threads = setup.questStage($foundGoldThread)&gt;&gt;
With deft ease, the $npc1.species works the new thread around the old, weaving it in as if it had always belonged there. &quot;There we go! 
&lt;&lt;if _threads &lt; 4&gt;&gt;
Now, I&#39;d say you could handle another &lt;&lt;print 5 - _threads&gt;&gt; additions. 
&lt;&lt;elseif _threads == 4&gt;&gt;
Now, I&#39;d say you could handle just one more addition. 
&lt;&lt;else&gt;&gt;
That&#39;s about as far as I&#39;m willing to go, otherwise the consequences could be... dire. 
&lt;&lt;set $quests[setup.questIndex($foundGoldThread)].description = &quot;You&#39;ve fully upgraded your golden bracelet. &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt; Thanks!&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="221" name="Wash dishes" tags="" position="2375,1425" size="100,100">&lt;&lt;set _waiter = &quot;waiter&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _waiter = &quot;waitress&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;You are led to the back of the kitchen, where a small pile of soap and rags are dwarfed by a massive pile of used dishes. The _waiter points to three areas and says simply, &quot;Dirty, clean, dry. Do your best,&quot; before heading back out. You crack your knuckles and set to it, pumping water into the sink and soaping up a rag. 
&lt;/p&gt;

&lt;&lt;if $agi &gt; 35 and $end &gt; 35&gt;&gt;
As time passes, you manage to get ahead of the curve, the mountain of dishes steadily shrinking from your efforts. You manage to create a brief moment in which all the dishes are in the clean and dry piles. This lasts for about twelve seconds before more dirty dishes come in, but you consider it a victory. The _waiter comes up to you with a handful of gold. &quot;Nice goin&#39; there, speedy. Boss says you can have this for a job well done. Come help out again some time.&quot; $npc1.He gives you an honest smile for the first time since you walked in, and you head back out with some extra spending money. 
&lt;&lt;doGld 25&gt;&gt;

&lt;&lt;else&gt;&gt;
As fast as you work, the pile never seems to get much smaller, even though you&#39;re quite certain that you&#39;ve cleaned a huge number of them. After a few hours of this, you hang up your rag, stopping for now. The _waiter comes back up to you with a handful of gold. &quot;Don&#39;t worry, you did alright. Boss says you can have this for your trouble. Thanks for the help, hon.&quot; $npc1.He gives an honest smile for the first time since you walked in, and you head back out with a little extra gold. 
&lt;&lt;doGld 10&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;doTime 240&gt;&gt;
&lt;&lt;stamina -50&gt;&gt;
&lt;&lt;getQuest $washedDishes&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;A job well done&quot; &quot;Restaurant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="222" name="Western Road" tags="city" position="1875,1850" size="200,100">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

You&#39;re standing on the dirt road going west of the city. To the north there&#39;s is a dense forest. To the south there are open grasslands with several farms near the road.  


&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Western Road&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;gate&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;forest&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;forest&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;forest&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;road&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="223" name="Work at the restaurant" tags="" position="2375,1525" size="100,100">&lt;&lt;set _waiter = &quot;waiter&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;female&quot;&gt;&gt;
	&lt;&lt;set _waiter = &quot;waitress&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questStarted($washedDishes) and setup.questStarted($cookedFood)&gt;&gt;
&quot;We&#39;ve actually got it more or less under control for the moment, thanks to all your help. If you come back tomorrow though I&#39;m sure we&#39;ll be fallin&#39; right back behind though.&quot;

&lt;&lt;else&gt;&gt;
	The $npc1.species $npc1.gentleman puts $npc1.his $npc1.hands to the side and lets out a relieved sigh. &quot;You want to help out? Thank goodness. I can cover all the orders, but we need some help in back. 
	&lt;&lt;if setup.questStarted($washedDishes)&gt;&gt;
	We&#39;re really falling behind on the cooking front. If you could help them out back there we could make it worth your while. 
	&lt;&lt;elseif setup.questStarted($cookedFood)&gt;&gt;
	We&#39;ve practically run out of dishes to serve people on and it&#39;s a bit of a mad house in the dish room. 
	&lt;&lt;else&gt;&gt;
	Dishes, anyone can do, but you need the know-how and the speed to keep up and help $npc2.Name with the meals. We can pay you alright either way, but cookin&#39;s more in need. 
	&lt;&lt;/if&gt;&gt;

What&#39;ll it be?&quot; 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !setup.questStarted($cookedFood)&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;quest&quot; &quot;Cook food&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if !setup.questStarted($washedDishes)&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Wash dishes&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questStarted($washedDishes) and setup.questStarted($cookedFood)&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;See you tomorrow&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;addPretext &quot;\&quot;Thank you so much for the offer sweetheart. Now what can I help //you// with?\&quot; &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Nevermind&quot; &quot;Restaurant&quot;&gt;&gt;
  /* annoyingly pretext doesn&#39;t seem to be able to use variables?, so had to adjust the text so it doesn&#39;t reference _waiter */
    &lt;&lt;addPretext &quot;They look a bit ruffled and say, \&quot;Well, we can use you whenever you want to help out. What can I do for you, then?\&quot; &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="224" name="Work for the armory" tags="" position="3275,1500" size="100,100">&lt;&lt;if !setup.questStarted($learningToSmith)&gt;&gt;
The $npc1.species stops working for a moment, stroking $npc1.his &lt;&lt;if $npc1.male == &quot;male&quot;&gt;&gt;shaggy mane&lt;&lt;else&gt;&gt;chin&lt;&lt;/if&gt;&gt; as $npc1.he gives you a looking over. &quot;So, yer&#39; needin&#39; some work are yeh? I might be able ta use an assistant for a while...&quot; $npc1.He stands up and leads you to $npc1.his anvil before handing you $npc1.his hammer. &quot;Give it a swing for me, let me see what it tells me of ye,&quot; $npc1.he requests. 
&lt;&lt;getQuest $learningToSmith&gt;&gt;

&lt;&lt;if $str &gt; 35&gt;&gt;
You swing the hammer at the metal $npc1.he was shaping. The hammer is heavy, but you manage a good swing, and get a rewarding &#39;clank&#39; from it and dent the metal. The $npc1.species nods approvingly. &quot;A bit of a wild swing, but you&#39;ve an arm fer it, and that&#39;s important. I won&#39;t be teachin&#39; yeh the finer bits of it, but yeh kin&#39; still help me prepare the metal fer shapin&#39;. Let me know when yeh want ta start.&quot; Looks like you qualify. 
&lt;&lt;advanceQuest $learningToSmith&gt;&gt;

&lt;&lt;else&gt;&gt;
You swing the hammer at the metal $npc1.he was shaping, barely able to lift the surprisingly heavy hunk of iron. It gives a quiet &#39;tink&#39; as you hit it. The $npc1.species shakes $npc1.his head. &quot;I&#39;m afraid that as yeh are, ye&#39;d be more hindrance than help. I need an assistant, not an apprentice. If yer&#39; desp&#39;rate fer work, though, check the rest&#39;raunt. They always need someone ta do the dishes.&quot; $npc1.He takes back $npc1.his hammer and sets back to work. 
&lt;&lt;/if&gt;&gt;


&lt;&lt;elseif setup.questStage($learningToSmith) == 0&gt;&gt;
The $npc1.species stops working for a moment, looking up at you. &quot;Back again? Do yeh feel like ye can handle it now?&quot; $npc1.He stands up once more, leading you to the anvil. &quot;Give it another swing, let&#39;s see how ye&#39;ve come along.&quot; $npc1.He gives you $npc1.his hammer again, and gestures to the anvil. 
&lt;&lt;if $str &gt; 35&gt;&gt;
You swing the hammer at the anvil, feeling much more in control than last time. You manage a good swing, and get a rewarding &#39;clank&#39; and a dent in the metal on the anvil. The $npc1.species nods approvingly. &quot;Looks like ye&#39;ve gained an arm fer it, so good on yeh. I&#39;ll not be teachin&#39; yeh the finer bits a&#39; smithin&#39; fer this job, but yeh kin&#39; help me prepare the metal fer shapin&#39;. Just let me know when ye&#39;re ready ta start.&quot; Looks like you&#39;re strong enough to qualify now. 
&lt;&lt;advanceQuest $learningToSmith&gt;&gt;
&lt;&lt;else&gt;&gt;
You give it another swing, but the hammer is still just too heavy for you to wield well. You produce another quiet &#39;tink&#39; as you hit the anvil. The $npc1.species shakes $npc1.his head once more. &quot;Still not there, I&#39;m afraid. Don&#39;t worry, $p.lad. If ye&#39;re not cut out fer this, there&#39;s still plenty a&#39; things ye can do. Yeh might try goin&#39; out west and visitin&#39; the Mage&#39;s Guild out there, seein&#39; if ye can use yer mind instead a&#39; yer arms.&quot; 
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif !setup.questStarted($smithedArmor)&gt;&gt;
The $npc1.species gives you a nod, and says, &quot;Ah, good, ye&#39;re ready ta start. Come back ta th&#39; furnace with me an&#39; we&#39;ll get yeh goin&#39;.&quot; With that, $npc1.he leads you into a cramped, hot room. Metal ingots line a wall and hot coals glow in a stone furnace. You are given a list of how many casts of metal are needed with each of the molds available, and set to the task of melting the metal and pouring it into the molds to be refined later. 
&lt;&lt;doTime 240&gt;&gt;
&lt;&lt;stamina -50&gt;&gt;
&lt;&lt;getQuest $smithedArmor&gt;&gt;
&lt;&lt;if $str &gt; 50 and $end &gt; 50&gt;&gt;
It&#39;s hard, tiring work, but you accomplish most of what was requested alone. The $npc1.species comes back a few times, seemingly immune to the immense heat as $npc1.he works while you get a much-needed drink. After several hours of this, you are called back to the front and presented with a pouch of gold. &quot;Mannin&#39; the furnace is hard work, but ye did well. Here&#39;s some coin fer yer sweat today.&quot; 
&lt;&lt;doGld 50&gt;&gt;
&lt;&lt;else&gt;&gt;
It&#39;s hard work, but you keep at it, not letting the heat keep you from your task. After a full and busy few hours, you find that you&#39;ve cast all the pieces that were requested and head back to the front. The $npc1.species nods approvingly. &quot;Well, ye&#39;ve got the chops for this, yeh do. Ye did quite well, an&#39; I&#39;ll be able ta easily meet me quota fer today now. If&#39;n I&#39;m ever lookin&#39; for an apprentice, I do hope yeh come ta fill the role. Take some coin fer yer hard work.&quot; You are presented with a small bag of gold. 
&lt;&lt;doGld 20&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;else&gt;&gt;
&quot;Thank ye for the offer, but ye&#39;ve done quite enough fer&#39; today. Come back by t&#39;morrow and I should have more work for ye&#39;.&quot; 

&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Return&quot; &quot;The Armory&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="225" name="Your House" tags="" position="2425,1125" size="200,200">You&#39;re standing in the main room of your house. It&#39;s not a very nice house, but it&#39;s home. 


&lt;&lt;action &quot;w&quot; &quot;rest&quot; &quot;Sleep&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;gate&quot; &quot;Head into town&quot; &quot;Central Square&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;addPretext &quot;You $walk out of your house and onto the city&#39;s central square. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;action &quot;n&quot; &quot;up&quot; &quot;Kitchen&quot; &quot;Kitchen&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

/* DOWNTIME MOD EDIT - START*/
&lt;&lt;if $options.downtimeEnabled == true&gt;&gt;
	&lt;&lt;action &quot;s&quot; &quot;down&quot; &quot;Downtime&quot; &quot;Plan some downtime&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* DOWNTIME MOD EDIT - END*/</tw-passagedata><tw-passagedata pid="226" name="armorer vendor" tags="" position="3175,1300" size="100,100">&lt;&lt;setPassageTitle &quot;Shop at the armory&quot;&gt;&gt;

&quot;Here&#39;s what I have in stock. Take a look and see what you like.&quot; 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="227" name="central square movement" tags="" position="2700,1925" size="100,100">&lt;&lt;if $eventCounterA != &quot;fight&quot;&gt;&gt;

&lt;p&gt;&lt;&lt;icon &quot;rest&quot;&gt;&gt;[[Rest|Central Square][$eventCounterB=&quot;rest&quot;]]&lt;p&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;house&quot; &quot;Your House&quot;&gt;&gt;&lt;&lt;set $travel = 2&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;store&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;restaurant&quot; &quot;Restaurant&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
	&lt;&lt;addPretext &quot;You step into the city&#39;s local restaurant. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;church&quot; &quot;Church&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;trainingGrounds&quot; &quot;Training grounds&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;road&quot; &quot;Western Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;road&quot; &quot;Southern Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;road&quot; &quot;Eastern Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;	
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;startCombat&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="228" name="clothing vendor" tags="" position="2925,1300" size="100,100">&lt;&lt;setPassageTitle &quot;Shop at the clothing store&quot;&gt;&gt;

&quot;Oh, you have something for me? Let me take a look.&quot; 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="229" name="general store" tags="" position="3050,1300" size="100,100">&lt;&lt;setPassageTitle &quot;Shop at the general store&quot;&gt;&gt;

A pudgy $npc1.species fellow in slightly dirty clothes sits behind a counter that is, itself, piled high with assorted goods that $npc1.he is inspecting. 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="230" name="grocery store vendor" tags="" position="2800,1300" size="100,100">&lt;&lt;setPassageTitle &quot;Shop at the grocery store&quot;&gt;&gt;

&quot;Let me know if you see anything you&#39;re hankering for.&quot; 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Market Square&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="231" name="market square movement" tags="" position="2825,1625" size="100,100">&lt;&lt;if $eventCounterA != &quot;fight&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Market Square&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;gate&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;nw&quot; &quot;store&quot; &quot;The Armory&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;store&quot; &quot;Grocery Store&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;store&quot; &quot;Clothing Store&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;store&quot; &quot;General Store&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;tailor&quot; &quot;Tailor&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;&lt;startCombat&gt;&gt;
	&lt;&lt;set $e.exit = &quot;Market Square&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="232" name="A near bursting patient" tags="nobr" position="2275,1950" size="100,100">/*If you haven&#39;t started the quest*/
&lt;&lt;if !setup.questStarted($eatingContest)&gt;&gt;

&lt;&lt;set _tempQuest = clone($eatingContest)&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot;&gt;&gt;
&lt;&lt;set _tempQuest.species = $species&gt;&gt;
&lt;&lt;set _tempQuest.gender = $gender&gt;&gt;

&lt;p&gt;A large $npc1.species lies on a matress placed on the floor, $npc1.his $npc1.furBelly spherical gut swollen to a massive size. $npc1.He looks to be in constant pain as $npc1.he moves about in $npc1.his makeshift bed, obviously too big for any conventional stretcher. &lt;/p&gt;

&lt;p&gt;&quot;Hello,&quot; the $npc1.species grunts in pain between short breaths, &quot;Sorry about this, but could you please take my place?&quot; the $npc1.species rubs $npc1.his gut to help soothe the discomfort. &quot;I got a bit nervous before the contest, so I did some eating to relax,&quot; another groan, &quot;I have a bet on someone else losing...&quot; &lt;/p&gt;

&lt;p&gt;As you inquire further, you start to build the story up bit by bit between $npc1.his constant groans, grunts of pain and shortness of breath. There is an eating contest that happens every so often. You pay to join and if you beat the others, you get a gold prize. $npc1.He&#39;s willing to forego the prize and let you take $npc1.his place, but $npc1.he asks you to try and beat the champion. &lt;/p&gt;
&lt;&lt;getQuest _tempQuest&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Accept&quot; &quot;A near bursting patient&#39;s request&quot;&gt;&gt;
&lt;&lt;set $eventCounterA = true&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Decline&quot; &quot;A near bursting patient&#39;s request&quot;&gt;&gt;
&lt;&lt;set $eventCounterA = false&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you have started the quest*/
&lt;&lt;else&gt;&gt;
&lt;&lt;set _tempQuest = $quests[setup.questIndex($eatingContest)]&gt;&gt;
&lt;&lt;createNPC _tempQuest.species _tempQuest.gender&gt;&gt;

&lt;p&gt;The large $npc1.species still lies on a matress placed on the floor, $npc1.his $npc1.furBelly spherical gut swollen to a massive size. $npc1.He looks to be in constant pain as $npc1.he moves about in $npc1.his makeshift bed, obviously too big for any conventional stretcher. &lt;/p&gt;

/*If you haven&#39;t taken the ticket yet*/
&lt;&lt;if _tempQuest.progress == 0&gt;&gt;
&lt;p&gt;&quot;Did... you change your mind?&quot; $npc1.he says between groans. &quot;Do you wanna take my spot in the eating contest?&quot; &lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Accept&quot; &quot;A near bursting patient&#39;s request&quot;&gt;&gt;
&lt;&lt;set $eventCounterA = true&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Decline&quot; &quot;A near bursting patient&#39;s request&quot;&gt;&gt;
&lt;&lt;set $eventCounterA = false&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you have taken the ticket*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;$npc1.He&#39;s finally passed out in a bloated stupor. You decide it&#39;s probably best not to disturb $npc1.him and leave $npc1.him to digest in peace. &lt;/p&gt;

&lt;&lt;action &quot;e&quot; &quot;hospital&quot; &quot;Infirmary&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="233" name="A near bursting patient&#39;s request" tags="nobr" position="2150,1950" size="100,100">&lt;&lt;if $eventCounterA&gt;&gt;
&lt;p&gt;You don&#39;t know how you think you&#39;ll fare, but you can&#39;t help but lick your lips in anticipation of more food. And with the abundance of food this year, it&#39;s bound to be even tastier. You happily agree and $npc1.he gives you a card with the number 4 on it. &lt;/p&gt;

&quot;This is your seat number. It&#39;s being hosted at the dairy farm, in the barn, so don&#39;t miss the contest.&quot;
&lt;&lt;advanceQuest $eatingContest&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;You don&#39;t know how you think you&#39;ll fare, so you decline $npc1.his offer. &quot;Fair enough suit yourself, but if you change your mind I&#39;m sure I&#39;ll still be here.&quot; $npc1.He belches and continues to rub $npc1.his taught gurgling stomach. &quot;I&#39;m pretty sure I won&#39;t be getting out of here for a while.&quot; &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="234" name="Hospital" tags="city" position="2400,2075" size="100,100">&lt;p&gt;You&#39;re standing in the city&#39;s main and only hospital. Usually there wasn&#39;t much use for the place since the world had been such a calm and peaceful place, but with increasing attacks from wild animals and monster, not to mention the bizzarely increased prevelance of people gorging themselves to the literal point of bursting, there has been a marked increase in need for medical care. At all hours of the day there can be heard constant groans of pain from the rooms. Although it&#39;s hard to tell if they&#39;re in pain from actual injuries or just from rampant indigestion. 
&lt;/p&gt;

&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
&lt;&lt;if random(1,3) != 1&gt;&gt;
A stuffed $npc1.species is dragged through the waiting area on a gurney. $npc1.His bloated stomach is so large four strong orderlies brace against it to prevent the unconscious fur from rolling to the floor. 
&lt;&lt;else&gt;&gt;
A stuffed $npc1.species is dragged through the waiting area on a gurney. $npc1.His bloated stomach is so large that eight strong orderlies brace against it to prevent the unconscious fur from rolling to the floor. With a mighty groan, the gurney collapses under the colossal weight of its rider. $npc2.Article $npc2.species orderly falls directly in the path of the overfed patient and cries out as $npc2.he’s crushed under the mountainous stomach. One of the other orderlies just sighs and throws the knocked down $npc2.species over his shoulder and follows the rest of the group as they roll the patient into one of the side rooms. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Central Square&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;hospital&quot; &quot;Infirmary&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;store&quot; &quot;Reception desk&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;down&quot; &quot;Restricted Area&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="235" name="Infirmary" tags="nobr" position="2275,2075" size="100,100">&lt;p&gt;Several hospital beds line each wall of the long infirmary. Almost every single one has a fur in some form of distess laying upon them. Several beds appear to have been crushed under a great weight and meerly left that way, and it&#39;s easy to tell how they got that way as most of the crushed beds have an incredibly overstuffed and/or massively obese fur laying upon them. There&#39;s also a reasonable number of furs with legitimate injuries like bites and lacerations resting up with bandages covering them, although the overfed furs seem to outnumber the others just by virtue of taking up so much space. &lt;/p&gt;

&lt;&lt;if !setup.questCompleted($eatingContest)&gt;&gt;
&lt;p&gt;One particularly bloated individual is sprawled out on the floor nearby. &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if !setup.questCompleted($eatingContest)&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;A near bursting patient&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="236" name="Reception desk" tags="" position="2400,2200" size="100,100">There&#39;s a rack of potions and pills next to the reception desk with a box in front labelled, &quot;Please pay using the honor system. We are terribly short staffed.&quot; with an arrow pointing to a conventiently coin shaped hole in the box. 

&lt;&lt;vendor &quot;hospital vendor&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;hospital vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;hospital&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="237" name="Restricted Area" tags="" position="2150,2075" size="100,100">&lt;p&gt;As you wander through the corridors of the village hospital, the sterile, antiseptic smell fills the air, mingling with the distant sounds of bustling activity and quiet conversations. The hospital seems busy, yet at this particular moment, the hallway you find yourself in is curiously devoid of employees. Your attention is drawn to a door at the end of the corridor. Unlike the other doors you&#39;ve passed, this one bears a bold, red sign that reads &quot;Restricted.&quot;&lt;/p&gt;

&lt;p&gt;Curiosity piques your interest. The absence of hospital staff in the vicinity adds a layer of mystery and temptation. Why is this door marked as restricted? What secrets or valuable items could be hidden behind it? The possibility of discovering something potentially valuable looms large in your mind.&lt;/p&gt;

&lt;p&gt;You pause, considering your options. You could respect the hospital&#39;s rules and leave the door unexplored. Or, you could seize this opportunity to sneak a peek behind the door, possibly finding something of interest or value to take with you before anyone notices.&lt;/p&gt;

&lt;p&gt;What will you do?&lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;return&quot; &quot;Leave&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Enter&quot; &quot;Hospital Office&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="238" name="Hospital Office" tags="" position="2150,2100" size="100,100">&lt;p&gt;With a quiet push, the door to the restricted area opens, revealing a dimly lit office. The room is filled with the usual trappings of a hospital employee&#39;s workspace: a large desk cluttered with papers, bookshelves lined with medical journals, and filing cabinets. The air is heavy with the scent of old paper and ink. As you step inside, you sense a strange stillness, as if this space is seldom disturbed.&lt;/p&gt;

&lt;p&gt;Your eyes scan the room, taking in the details. It&#39;s an ordinary office, but the fact that it&#39;s marked &#39;Restricted&#39; piques your curiosity further. You begin to rummage quietly, looking for anything out of the ordinary or potentially valuable.&lt;/p&gt;

&lt;p&gt;As you move around the room, your $p.hand accidentally brushes against a book on the shelf. To your surprise, the shelf shifts slightly, revealing a hidden mechanism. Intrigued, you investigate further and discover a secret door concealed behind the bookshelf. Your heart races with excitement and curiosity. What could be hidden behind such a secretive entrance?&lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;return&quot; &quot;Leave&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
/* &lt;&lt;action &quot;c&quot; &quot;return&quot; &quot;Steal and leave&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt; */
&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Enter&quot; &quot;Hospital Lab&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="239" name="Hospital Lab" tags="" position="2150,2125" size="100,100">&lt;p&gt;Driven by a blend of curiosity and the thrill of potential gain, you decide to risk it all. You carefully approach the restricted door, your heart pounding with a mixture of excitement and nervousness. With a quick glance over your shoulder to ensure the coast is clear, you gently push the door open and slip inside.&lt;/p&gt;

&lt;p&gt;The room beyond is unlike any other part of the hospital you&#39;ve seen. It&#39;s a secret laboratory, filled with an array of strange equipment, bubbling flasks, and mysterious substances. Fascinated yet cautious, you step further in, your eyes scanning for anything that seems valuable or useful.&lt;/p&gt;

&lt;p&gt;As you move deeper into the lab, unaware of the hidden dangers, you accidentally trigger a concealed trap. A fine mist suddenly sprays from a nozzle overhead, dousing you in a cloud of unknown chemicals. Panic sets in as you frantically try to wipe the substance off, but it&#39;s too late – the chemicals have already begun to take effect.&lt;/p&gt;

&lt;p&gt;A strange sensation washes over you, a feeling unlike anything you&#39;ve experienced before. Looking down in horror, you realize that you&#39;re shrinking! Your clothes start to hang looser, the room around you seems to grow larger, and distances seem futher than they were before. Desperate to escape this nightmare, you turn and run towards the door, but with each step, your legs grow weaker and your strides shorter.&lt;/p&gt;

&lt;p&gt;As you shrink further, the world around you becomes a vast, intimidating place. The once short distance to the door now feels like an endless journey. Suddenly, a wave of drowsiness engulfs you. Your steps falter, and your vision blurs. The last thing you&#39;re aware of is the cold, hard floor rushing up to meet you as you collapse, succumbing to an irresistible sleep.&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Shrunk in Lab&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="240" name="Shrunk in Lab" tags="" position="2150,2150" size="100,100">&lt;&lt;createFixedNPC &quot;scientist&quot; 1&gt;&gt;

&lt;p&gt;As consciousness slowly returns, you find yourself in an unfamiliar, surreal environment. Your vision clears, and the first thing you notice is that you&#39;re in a glass bowl sitting on a desk. Confusion washes over you as you try to make sense of your surroundings. The scale of everything around you is off – everything is enormous. That&#39;s when it hits you: you&#39;re only about 5 inches tall now, a miniature version of your former self.&lt;/p&gt;

&lt;p&gt;Before you can fully process this shocking revelation, a figure approaches the desk. It&#39;s a $npc1.species with a wild look in $npc1.his eyes, $npc1.his hair unkempt, giving $npc1.him the appearance of the quintessential mad scientist. $npc1.He peers into the glass bowl with a mixture of curiosity and delight.&lt;/p&gt;

&lt;p&gt;&quot;Ah, you&#39;re awake!&quot; $npc1.he exclaims with an unsettling enthusiasm. &quot;Welcome to my little laboratory. I must say, I didn&#39;t expect to have a visitor, especially one so... diminutive.&quot;&lt;/p&gt;

&lt;p&gt;$npc1.He leans closer, $npc1.his eyes scrutinizing you as if you were a fascinating specimen. The realization dawns on you that to $npc1.him, that&#39;s exactly what you are.&lt;/p&gt;

&lt;p&gt;&quot;I used to receive subjects from the hospital for my experiments, but they&#39;ve stopped cooperating. Can you imagine that?&quot; $npc1.he says with a manic chuckle. &quot;But now, here you are, wandering right into my lab! Quite the fortunate turn of events, for me at least.&quot;&lt;/p&gt;

&lt;p&gt;$npc1.His gaze locks onto yours, and you feel a chill run down your spine. The imbalance of power in this situation is painfully evident.&lt;/p&gt;

&lt;p&gt;&quot;Are you hungry, my tiny friend?&quot; $npc1.he asks suddenly, $npc1.his tone shifting to one of mock concern.&lt;/p&gt;

&lt;p&gt;Despite the absurdity and fear of the situation, you realize that you are indeed hungry. Your small voice, almost a whisper compared to $npc1.his booming presence, manages to convey your affirmative answer.&lt;/p&gt;

&lt;p&gt;&quot;Excellent!&quot; $npc1.he exclaims, rubbing $npc1.his $npc1.hands together. &quot;I have just the thing for you. You see, taking care of my subjects is of utmost importance. After all, healthy subjects make for better experiments.&quot;&lt;/p&gt;

&lt;p&gt;As $npc1.he turns away momentarily, presumably to fetch something for you to eat, you&#39;re left to contemplate this precarious situation. With the mad $npc1.species scientist momentarily distracted, you face a critical decision. Do you seize this chance to attempt an escape, despite your tiny size and weakened state, or do you bide your time, waiting and gathering your strength for a more opportune moment?.&lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;return&quot; &quot;Escape&quot; &quot;Escape Mad Scientist&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Wait for Mad Scientist&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="241" name="Escape Mad Scientist" tags="" position="2100,2200" size="100,100">&lt;p&gt;Fueled by a desperate need for freedom, you decide to make your escape now. You look around the interior of the glass bowl, trying to gauge the best way to leverage your tiny size. The bowl is large compared to you, but not insurmountable. You decide to use your weight to tilt the bowl back and forth, building momentum.&lt;/p&gt;

&lt;p&gt;With determination, you start rocking the bowl. At first, the movements are small, but with each push, the bowl rocks further. The motion requires considerable effort, and you can feel your heart pounding with both exertion and anticipation. Gradually, the rocking becomes more pronounced, and you sense that you&#39;re close to tipping it over.&lt;/p&gt;

&lt;p&gt;Finally, with one strong push, the bowl teeters dangerously before toppling over with a resounding crash. You tumble out onto the desk, a mix of relief and adrenaline coursing through you. You quickly take stock of your surroundings, realizing you need to act fast before the scientist returns or discovers your escape.&lt;/p&gt;

/* &lt;&lt;action &quot;w&quot; &quot;return&quot; &quot;Run for the exit&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action
	// TODO: Add an escape scene here
&gt;&gt;  */
&lt;&lt;action &quot;c&quot; &quot;inventory&quot; &quot;Hide among beakers&quot; &quot;Lab hide&quot;&gt;&gt;&lt;&lt;/action&gt;&gt; 
&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Cause chaos&quot; &quot;Lab chaos&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="242" name="Lab hide" tags="" position="2100,2225" size="100,100">&lt;p&gt;Choosing to hide, you quickly scurry along the desk, seeking a safe spot to conceal yourself. The lab is cluttered with equipment and various containers, offering several potential hiding places. As you dash across the desk, your focus is entirely on finding shelter.&lt;/p&gt;

&lt;p&gt;In your haste, however, you don&#39;t notice a small, open vial of strange, luminescent liquid until it&#39;s too late. As you run past it, you accidentally brush against the vial, tipping it over. A few drops of the chemical splash onto you, immediately soaking into your skin.&lt;/p&gt;

&lt;p&gt;Alarm surges through you as you feel the chemical on your body. There&#39;s no telling what this substance might do, and the uncertainty sends a wave of fear through you. You quickly try to wipe it off, but it has already begun to react with your skin, leaving a tingling sensation where it touched.&lt;/p&gt;

&lt;p&gt;As you wait anxiously, the tingling sensation from the spilled liquid on your skin grows increasingly intense. It starts as a mild itching but soon escalates into a peculiar, effervescent feeling. Alarmingly, you notice your belly beginning to swell. A strong bloating feeling builds up in your midsection, the pressure gradually increasing as your stomach expands outward.&lt;/p&gt;

&lt;p&gt;At first, the swelling is slow, your belly rounding out slightly, creating a small bulge. But as moments pass, the bulge becomes more pronounced, your skin stretching to accommodate the growing pressure inside. You can feel a lightness within you, as if an invisible air tank is filling you up like a balloon.&lt;/p&gt;
&lt;&lt;inflate 10 -50&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Lab balloon&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="243" name="Lab balloon" tags="" position="2100,2250" size="100,100">&lt;p&gt;The expansion continues, your belly growing larger and rounder. It&#39;s an odd sensation, both weightless and unnerving. You place your $p.hands on your inflated abdomen, feeling the tightness of your skin, stretched and filled with the mysterious gas. Your belly becomes a prominent, ballooning sphere, dominating your once proportional figure.&lt;/p&gt;

&lt;p&gt;As your belly swells further, you start to feel a lifting sensation. The realization hits you – the gas filling you up is making you buoyant. Panic sets in as your feet gradually lose contact with the desk&#39;s surface. You&#39;re floating, lifted skyward by your own inflating belly.&lt;/p&gt;

&lt;p&gt;Helplessly, you drift upwards, your inflated belly leading the way. The ceiling of the lab approaches quickly, and you brace for impact. With a soft bump, your belly makes contact with the ceiling. The sensation is surreal; you&#39;re stuck there, floating like a balloon, your feet dangling uselessly below you.&lt;/p&gt;

&lt;p&gt;In this bizarre state of suspension, you&#39;re acutely aware of your predicament. You&#39;ve become a $p.species balloon, inflated and floating against the ceiling of the mad scientist&#39;s lab. You rub your $p.hands over your massively distended stomach in an attempt to soothe the feeling of being filled to such an extreme.  The sense of defeat is overwhelming as you realize there&#39;s no way to control your movement or escape from your inflated state.&lt;/p&gt;

&lt;p&gt;Trapped and floating, you&#39;re left to ponder the unexpected turn of events that led to this unusual and precarious situation. Your escape attempt has ironically resulted in a complete loss of mobility, leaving you adrift and at the mercy of the whims of the lab&#39;s environment.&lt;/p&gt;
&lt;&lt;inflateToFloating&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Lab balloon 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="244" name="Lab balloon 2" tags="" position="2100,2275" size="100,100">&lt;&lt;createFixedNPC &quot;scientist&quot; 1&gt;&gt;

&lt;p&gt;As you float helplessly against the ceiling, bobbing slightly from the gentle air currents in the lab, the mad scientist finally notices your predicament. $npc1.His eyes widen in fascination as $npc1.he sees you, inflated and suspended. $npc1.He approaches with an intrigued smile, reaching up to grasp your $p.foot and pull you down from the ceiling.&lt;/p&gt;

&lt;p&gt;The sensation of being handled is disorienting. As the scientist grips your $p.foot, you feel a pendulum-like motion, your body swaying gently in the air. Your swollen belly, a massive, taut orb, wobbles slightly with each movement. The feeling of being so distended and light is surreal; your skin stretched smooth and tight over the vast expanse of your inflated abdomen.&lt;/p&gt;

&lt;p&gt;&quot;Hmm, what an extraordinary reaction!&quot; the scientist exclaims, examining your inflated stomach with keen interest. $npc1.He prods gently at your belly, $npc1.his fingers pressing into the firm, inflated surface. Each touch sends a ripple across your stretched skin, the sensations heightened due to your inflated state. &quot;Fascinating... absolutely fascinating,&quot; $npc1.he mutters to $npc1.himself, $npc1.his eyes never leaving your swollen midsection.&lt;/p&gt;

&lt;p&gt;As $npc1.he continues $npc1.his examination, you can&#39;t help but feel like an object of curiosity, a specimen under scrutiny. $npc1.His $npc1.hands move over your belly, assessing the inflation, the tension in your skin, and the overall size of your distention.&lt;/p&gt;

&lt;p&gt;&quot;Tell me, how do you feel?&quot; $npc1.he asks, $npc1.his tone clinical yet curious. &quot;Any discomfort? Dizziness? A sense of pressure, perhaps?&quot;&lt;/p&gt;

&lt;p&gt;You try to respond, your voice echoing oddly through your belly. The physical sensations are hard to describe — a mix of tightness, fullness, and an odd buoyancy.&lt;/p&gt;

&lt;p&gt;The scientist nods, taking in your responses while continuing $npc1.his inspection. &quot;Remarkable... and to think this reaction was accidental. The potential for further study is immense,&quot; $npc1.he muses, almost to $npc1.himself.&lt;/p&gt;

&lt;p&gt;You&#39;re left feeling vulnerable and exposed as $npc1.he scrutinizes your condition. The sensation of being so unnaturally expanded and studied so intently is both uncomfortable and humiliating. As the scientist scribbles down notes, you realize that you have become little more than an interesting phenomenon to $npc1.him, a subject for $npc1.his bizarre experiments.&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Lab balloon 3&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="245" name="Lab balloon 3" tags="" position="2100,2300" size="100,100">&lt;p&gt;Your heart races as you see the scientist reaching for another spray bottle. Panic sets in as $npc1.he turns towards you, the bottle in hand. A sense of dread overwhelms you; the memory of your recent uncontrollable inflation is still fresh in your mind. You let out a faint whimper, the fear evident in your voice as you plead, &quot;No, please, no more...&quot;&lt;/p&gt;

&lt;p&gt;Despite your protests, the scientist approaches with a clinical detachment, $npc1.his curiosity overriding any empathy. $npc1.He sprays a fine mist of another chemical towards you. As the droplets settle on your already stretched skin, a new and unfamiliar sensation begins.&lt;/p&gt;

&lt;p&gt;At first, it&#39;s a subtle warmth spreading from the areas where the chemical touched. Then, you feel a tingling sensation in your hips and chest. Slowly, almost imperceptibly at first, these areas begin to swell. Your hips widen, expanding outward, growing fuller and rounder.&lt;/p&gt;

&lt;p&gt;Simultaneously, your chest starts to inflate. Your &lt;&lt;if $p.male==&quot;female&quot;&gt;&gt;breasts, initially expanding gently, soon balloon outward at an astonishing rate. They swell into large, rounded masses,&lt;&lt;else&gt;&gt;chest, initially expanding gently, soon balloons outward at an astonishing rate. Swell into a large, rounded mass,&lt;&lt;/if&gt;&gt; the skin taut and shiny from the rapid expansion. The sensation is a bizarre mix of tightness and pressure, as if each part of your body is competing for space.&lt;/p&gt;

&lt;p&gt;As the growth continues, you become increasingly aware of the enormity of your transformation. Your hips and &lt;&lt;if $p.male==&quot;female&quot;&gt;&gt;breasts&lt;&lt;else&gt;&gt;chest&lt;&lt;/if&gt;&gt; have grown so large that they rival the size of your inflated belly, giving you a highly exaggerated and disproportionate figure. The swelling makes every movement feel cumbersome and awkward.&lt;/p&gt;

&lt;p&gt;Struggling to adjust to this new, extreme shape, you find it hard to believe the extent of your expansion. Your body feels impossibly heavy in some areas yet strangely buoyant in others due to your inflated belly. The sensation of being so massively enlarged is disorienting and overwhelming.&lt;/p&gt;

&lt;p&gt;The scientist, meanwhile, observes with rapt attention, making notes and occasionally muttering to $npc1.himself. &quot;Incredible... the reaction is even more pronounced than anticipated,&quot; $npc1.he remarks, almost in awe.&lt;/p&gt;

&lt;p&gt;As the transformation reaches its peak, leaving you massively inflated and grotesquely disproportionate, the overwhelming sensations become too much to bear. The intense pressure, the tightness of your skin stretched to its limits, and the sheer absurdity of your condition converge into a tidal wave of sensory overload. Unable to cope with the extreme stress, you feel consciousness slipping away. Your vision blurs, the lab and the looming figure of the scientist fading into darkness as you succumb to a merciful faint, overwhelmed by the enormity of your transformation.&lt;/p&gt;
&lt;&lt;consume 50 30&gt;&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="246" name="Wait for Mad Scientist" tags="" position="2150,2175" size="100,100">&lt;p&gt;Choosing to wait and gather your strength, you watch cautiously as the mad scientist returns to the desk. In $npc1.his hand is a regular-sized orange, which $npc1.he sets down on the desk with a peculiar grin. You observe curiously, wondering what $npc1.he intends to do with it.&lt;/p&gt;

&lt;p&gt;Without a word, $npc1.he retrieves a small spray bottle filled with a clear liquid. With a few quick spritzes, $npc1.he coats the orange in the mysterious chemical. Before your eyes, the orange begins to shrink rapidly, its size diminishing until it&#39;s no more than a tiny speck. The transformation is both fascinating and terrifying, a stark reminder of the strange power this $p.species wields.&lt;/p&gt;

&lt;p&gt;With a pair of tweezers, the scientist delicately picks up the minuscule orange and drops it into your glass bowl. It lands with a soft, almost inaudible sound. You approach the speck cautiously, realizing it&#39;s still an orange, just incredibly small. Looking up at the scientist, you voice your concern. &quot;It&#39;s too small,&quot; you say, the tiny fruit dwarfed by even your reduced size.&lt;/p&gt;

&lt;p&gt;$npc1.He chuckles at your comment. &quot;Just eat it,&quot; $npc1.he says with a wave of $npc1.his hand. &quot;Once you do, I&#39;ll fetch you some more food.&quot;&lt;/p&gt;

&lt;p&gt;Seeing no other option, you pick up the diminutive orange and swallow the speck. You then look up at the scientist expectantly, requesting something more substantial.&lt;/p&gt;

&lt;p&gt;&quot;Don&#39;t you worry about that,&quot; $npc1.he replies with a sly, knowing look. &quot;You&#39;ll be feeling very full, very soon.&quot;&lt;/p&gt;

&lt;p&gt;Confused by $npc1.his cryptic response, you start to feel a strange sensation in your stomach. It begins as a faint rumble but quickly grows more pronounced. The realization of what might be happening hits you, but before you can react further, the sensation in your stomach intensifies, a clear sign that something unusual is about to occur.&lt;/p&gt;
&lt;&lt;consume 3 30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Orange growth&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="247" name="Orange growth" tags="" position="2150,2175" size="100,100">&lt;p&gt;As you grapple with the growing discomfort in your stomach, the scientist observes you with an unsettling air of anticipation. &quot;You see, the shrinking effect on the orange is very short-term. It will soon return to its original size,&quot; $npc1.he explains, $npc1.his voice tinged with a disturbing glee.&lt;/p&gt;

&lt;p&gt;Panic surges through you at $npc1.his words. The realization that the orange, which was about as tall as your now diminutive stature, will expand inside you is terrifying. You feel the initial stirrings of growth within your stomach, a gentle stretching that rapidly escalates into a forceful swelling.&lt;/p&gt;

&lt;p&gt;Your middle begins to distend outward, a strong sense of bloating accompanies the sudden increase in volume. The sensation is bewildering and disorienting as your body accommodates the swelling sphere, ballooning outwards from the center where the orange resides. The pressure builds, a mix of stretching and fullness, as your middle expands in all directions.&lt;/p&gt;

&lt;p&gt;You place your $p.hands on your sides, feeling the tautness of your skin as it accommodates the rapidly growing orange. It&#39;s an odd sensation, like being stuffed with food, but even denser. Your stomach now bulges out significantly, resembling the curvature of a large ball. The expansion continues, pushing outwards relentlessly, your body rounding out in every direction, becoming increasingly spherical.&lt;/p&gt;

&lt;p&gt;The growth of the orange inside you shows no sign of slowing down. Your whole torso is now entirely round and still pushing outwards. Your body swells to an almost comical size, your limbs slowly being absorbed into the vast expanse of your ballooning middle. The tightness around your midsection is intense, a constant reminder of the strange, uncontrollable transformation you&#39;re undergoing.&lt;/p&gt;

&lt;p&gt;As you grow larger and rounder, the feeling of becoming helplessly swollen to such an extreme degree is overwhelming. You&#39;re at the mercy of the orange&#39;s relentless expansion, your body reshaping into an ever-increasing sphere. The scientist watches with an analytical eye, making notes, seemingly indifferent to your distress.&lt;/p&gt;

&lt;p&gt;In this bizarre and precarious situation, you&#39;re left wondering how much more your body can expand before reaching its limit. The fear of the unknown, coupled with the physical sensation of being stretched and filled, leaves you in a state of shock and disbelief.&lt;/p&gt;
&lt;&lt;consume 1000 1000&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Orange growth 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="248" name="Orange growth 2" tags="" position="2150,2200" size="100,100">&lt;p&gt;As the relentless swelling of your body finally begins to slow, you find yourself transformed into a spherical shape, your limbs completely swallowed your inflated form. Only your $p.hands and feet remain visible, sticking out comically from the sides and bottom of your now massive, round body. You&#39;re now a $p.species orb, your diameter easily matching your previous height. The pressure inside you is immense, yet surprisingly not painful – it&#39;s more of a profound tightness, a sensation of being filled to the brim.&lt;/p&gt;

&lt;p&gt;With a mixture of fascination and clinical interest, the scientist carefully lifts you from the glass bowl. The sensation of being moved is odd; your body feels impossibly round. $npc1.He places you gently on the desk, and you feel the cool surface beneath your taut skin.&lt;/p&gt;

&lt;p&gt;The scientist leans in, $npc1.his eyes scrutinizing your transformed body as $npc1.he begins to poke and prod at your spherical form. &quot;Fascinating,&quot; $npc1.he murmurs, pressing gently here and there, sending ripples through your stretched skin. &quot;How do you feel? Any discomfort or pain?&quot;&lt;/p&gt;

&lt;p&gt;You try to respond, but the feeling of $npc1.his $npc1.hands on your inflated body is overwhelming, each touch sending peculiar sensations through you.&lt;/p&gt;

&lt;p&gt;$npc1.He continues $npc1.his inspection, seemingly intrigued by your predicament. &quot;Can you move at all? Try to wiggle your $p.hands for me,&quot; $npc1.he instructs, $npc1.his tone clinical yet curious.&lt;/p&gt;

&lt;p&gt;You make a feeble attempt, managing only slight movements, your extremities almost fully engulfed in your swollen form.&lt;/p&gt;

&lt;p&gt;&quot;Hmm, remarkable,&quot; $npc1.he notes, jotting down observations. &quot;And how about your senses? Has your sense of touch changed with this... expansion?&quot;&lt;/p&gt;

&lt;p&gt;You realize that every prod feels more intense, the stretched skin sensitive to even the slightest pressure.&lt;/p&gt;

&lt;p&gt;The scientist nods, seemingly satisfied with $npc1.his findings. &quot;This is truly unprecedented. You&#39;re responding quite uniquely to the effects of the expansion. We&#39;ll need to conduct more tests, of course,&quot; $npc1.he muses, more to $npc1.himself than to you.&lt;/p&gt;

&lt;p&gt;Trapped in your spherical state, you&#39;re left feeling like nothing more than an object of curiosity, a subject in an experiment far beyond your control. The scientist&#39;s probing questions and clinical detachment only add to the surreal nature of your situation.&lt;/p&gt;

&lt;p&gt;As the scientist&#39;s curiosity about your new form grows, $npc1.he decides to test the dynamics of your spherical shape. With a slight push, $npc1.he begins to roll you across the desk. The sensation is dizzying; your world spins as you rotate helplessly, your vision blurring with each revolution. The smooth surface of the desk glides beneath you, and you feel a strange mixture of weightlessness and disorientation with each turn. The rolling motion is unnerving, making you acutely aware of your complete lack of control over the situation. You&#39;re at the mercy of the scientist&#39;s whims, a plaything being tested for $npc1.his amusement.&lt;/p&gt;

&lt;p&gt;Suddenly, the scientist&#39;s gentle pushes become more forceful, and your rolling speed increases. Panic sets in as you near the edge of the desk. You try to wiggle everything you can to stop yourself, but it&#39;s futile; your limbs are too absorbed into your rounded form to offer any resistance. With a final nudge from the scientist, you tumble off the edge of the desk. The fall feels like an eternity, your world a whirl of colors and shapes until you hit the floor with a soft, cushioned thud. The impact, muffled by your inflated body, is still jarring enough to disorient you further. In the aftermath of the fall, darkness creeps into the edges of your vision, and you slip into unconsciousness, the last sensations being the echoes of your rolling descent and the cold floor against your round form.&lt;/p&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="249" name="Lab chaos" tags="" position="2150,2200" size="100,100">&lt;p&gt;Summoning every ounce of courage and desperation, you decide to wreak havoc in the lab, hoping the ensuing chaos will provide a chance for escape. You scan the desk, identifying several vials and containers filled with various chemicals. With a deep breath, you push the closest vial, watching as it teeters precariously before tumbling over the edge of the desk, shattering on the floor with a loud crash.&lt;/p&gt;

&lt;p&gt;Emboldened, you move quickly, knocking over more containers, each crash louder than the last. The noise attracts the scientist&#39;s attention immediately. $npc1.He whirls around, $npc1.his eyes widening in shock and anger. &quot;What are you doing?!&quot; $npc1.he yells, but $npc1.his voice is drowned out by a series of reactions initiated by the mixing chemicals.&lt;/p&gt;

&lt;p&gt;Explosions of color and light burst around the room, followed by a billowing cloud of green gas that rapidly fills the space. Visibility drops to nearly zero, and you find yourself enveloped in the thick, choking fog. You cough violently, the acrid air burning your throat.&lt;/p&gt;

&lt;p&gt;Amidst the chaos, an intense sensation grips your body. You feel your belly beginning to swell, expanding outward with alarming speed. It&#39;s a bewildering feeling, as if an invisible force is packing weight into your stomach, making it jut out heavily. Your hips and thighs quickly follow suit, bulging and widening, pushing out to the sides. The sensation is disorienting, your lower body rapidly gaining mass and becoming increasingly heavy.&lt;/p&gt;

&lt;p&gt;Your chest and arms are next to succumb to the rapid expansion. Your chest swells forward, feeling tight and stretched, while your arms puff up, losing their former shape and gaining an unbelievable bulk. The growth is relentless, each part of your body competing for space, ballooning outwards and adding to your overall weight.&lt;/p&gt;

&lt;p&gt;You struggle to maintain your balance as the combined weight of your swelling body parts anchors you in place. The weight becomes too much to bear and you plop down onto your plump backside. The sensation of being helplessly inflated with flab, your body growing heavier and rounder by the second, is both surreal and terrifying. The chaos around you fades into the background as you grapple with the reality of your rapidly changing form.&lt;/p&gt;

&lt;p&gt;As the green gas thickens, obscuring everything around you, you&#39;re left feeling isolated in your own inflated world, unsure of what will happen next in the midst of this unforeseen and uncontrollable transformation.&lt;/p&gt;
&lt;&lt;tempBuff &#39;fat&#39; 800&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Lab fat gas&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="250" name="Lab fat gas" tags="" position="2250,2250" size="100,100">&lt;p&gt;As the dense, green fog of the fattening gas slowly begins to dissipate, you find yourself in a drastically altered state. Immobilized, you sit on your enormously swollen butt. Your massive belly and chest dominate your field of view, vast and round, like overstuffed cushions. They rise and fall with each labored breath, a testament to your immense size.&lt;/p&gt;

&lt;p&gt;Struggling to move, you realize how limited your mobility has become. Your arms, now extremely chubby and heavy, resist your efforts to lift them, their newfound bulk making even the slightest movement a challenge. Your legs, similarly swollen and rounded, are splayed awkwardly in front of you, barely able to wiggle in their expanded state.&lt;/p&gt;

&lt;p&gt;As you attempt to grapple with your new, astonishingly engorged form, you muster the effort to try and move. The desire to regain some semblance of control over your body is overwhelming. However, your attempts are met with unexpected challenges. Your swollen limbs, now incredibly chubby and heavy, respond sluggishly to your commands, moving with great effort and little coordination.&lt;/p&gt;

&lt;p&gt;With a determined yet awkward push, you try to shift your weight forward, hoping to somehow leverage yourself into a more upright position. But your body, so drastically fattened, has other plans. Instead of propelling yourself up, the sheer mass of your belly and chest causes you to lean too far backward. The momentum of this shift is more than you anticipated, and with a muffled yelp of surprise, you topple over.&lt;/p&gt;

&lt;p&gt;The sensation of falling is brief but intense. Your back hits the floor with a soft, cushioned thud, sending waves of jiggles through your enlarged body. Every part of you seems to wobble independently, like a giant gelatin mold. The feeling is disorienting and bizarre, a stark reminder of just how much your body has expanded.&lt;/p&gt;

&lt;p&gt;Lying on your back, you&#39;re acutely aware of the way your massive belly and chest rise high above you, limiting your view of the world around you. Your arms and legs, splayed out to the sides, are so swollen and round that they remind you of overstuffed limbs on a plush doll. The comparison is unsettling – in your current shrunken and fattened state, you bear an uncanny resemblance to an overstuffed doll, plump and immobile.&lt;/p&gt;

&lt;p&gt;In the eerie quiet following the chaos, a groan echoes across the room. Turning your head with difficulty, you catch sight of the scientist, who has also fallen victim to the same fate.&lt;/p&gt;

&lt;p&gt;The scientist&#39;s once thin frame is now lost under layers of newfound fat. The $npc1.species&#39;s belly has grown into a massive, dome-like protrusion, spilling over $npc1.his lap and sides, resembling a giant inflated ball. The buttons of $npc1.his lab coat have popped off due to the massive bulge. $npc1.His chest, now heavily swollen, rises high, pushing against $npc1.his chin and limiting $npc1.his ability to look down. $npc1.His arms and legs are thick and swollen, resembling overstuffed sausages. $npc1.He sits there, clearly immobilized by $npc1.his massively engorged body.&lt;/p&gt;

&lt;p&gt;$npc1.His face, previously sharp and angular, is now soft and rounded, with chubby cheeks and a double chin that wobbles slightly as $npc1.he groans in discomfort. The transformation has left $npc1.him almost unrecognizable, $npc1.his body now a caricature of its former self.&lt;/p&gt;

&lt;p&gt;Both of you, rendered immobile by your sudden and extreme expansion, are left in a state of shock and disbelief. The lab, once a place of meticulous order and scientific endeavor, now resembles a scene of surreal chaos, with its two occupants transformed into oversized, helpless blobs amidst the remnants of the chemical mayhem. &lt;/p&gt;

&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="251" name="hospital vendor" tags="" position="2300,2200" size="100,100">&lt;&lt;setPassageTitle &quot;Buy from the hospital&quot;&gt;&gt;

There&#39;s a rack of potions and pills next to the reception desk with a box in front labelled, &quot;Please pay using the honor system. We are terribly short staffed.&quot; with an arrow pointing to a conventiently coin shaped hole in the box. 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;hospital&quot; &quot;Done&quot; &quot;Hospital&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="252" name="An Equine Adventurer" tags="nobr" position="1550,2675" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;A Grand Adventurer&quot;&gt;&gt;

&lt;&lt;set _tasteStarted = setup.questStarted($uncommonTaste)&gt;&gt;
&lt;&lt;set _tasteComplete = setup.questCompleted($uncommonTaste)&gt;&gt;

/*If you haven&#39;t started the quest yet*/
&lt;&lt;if !_tasteStarted&gt;&gt;
&lt;&lt;set _tempQuest = clone($uncommonTaste)&gt;&gt;
&lt;&lt;if !$options.males&gt;&gt;
	&lt;&lt;set _tempQuest.gender = $female&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _tempItem = either($bloatedBlueberry, $outrageousOrange, $plentifulPeach, $ridiculousRaspberry, $sizableStrawberry, $giganticGrape)&gt;&gt;
&lt;&lt;set _tempQuest.target = clone(_tempItem)&gt;&gt;

&lt;&lt;set _tempQuest.description = [&quot;Bring &quot;, _tempItem.article, &quot; &quot;,  _tempItem.name.toLowerCase(), &quot; to the ex-adventurer &quot;, $npc1.species, &quot; hanging out at the dairy farm. The &quot;, $npc1.species, &quot; says they saw some growing out in the grasslands.&quot;].join(&quot; &quot;)&gt;&gt;

/*
&lt;&lt;switch _tempItem.name&gt;&gt;
&lt;&lt;case $bloatedBlueberry.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring a bloated blueberry to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;case $ampleApple.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring an ample apple to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;case $outrageousOrange.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring an outrageous orange to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;case $plentifulPeach.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring a plentiful peach to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;case $ridiculousRaspberry.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring a ridiculous raspberry to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;case $sizableStrawberry.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring a sizable strawberry to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;case $giganticGrape.name&gt;&gt;
&lt;&lt;set _tempQuest.description = &quot;Bring a gigantic grape to the ex-adventurer $npc1.species hanging out at the dairy farm. The $npc1.species says they saw some growing out in the grasslands.&quot; &gt;&gt;

&lt;&lt;/switch&gt;&gt;
*/

/*&lt;&lt;createNPC $horse _tempQuest.gender&gt;&gt;*/

&lt;p&gt;From behind round, bloated cheeks, $npc1.his eyes open, and $npc1.he spots you staring at $npc1.him. $npc1.He smiles, face growing even rounder. &lt;/p&gt;

&lt;p&gt;&quot;Well hi there! Guess you&#39;re an adventurer, huh?&quot; $npc1.He chuckles, causing $npc1.his behemoth body to wobble. &quot;Yeah, I used to be one myself, but... uh...&quot; $npc1.he smiles sheepishly and slaps a hand as bloated as a baseball mitt against $npc1.his deeply doughy side, a ripple travelling slowly through that ocean of belly-blubber, &quot;...Guess success has kinda slowed me down. Not that I&#39;m complaining!&quot; $npc1.He chuckles again, hand rubbing at $npc1.his enormous gut contentedly. &quot;I was pretty famous back in the day, you ever heard of me?&quot; You&#39;ve never heard of $npc1.him. $npc1.He looks a little disappointed, but shrugs $npc1.his bloated shoulders, shaking a couple of apples loose from the tree. $npc1.He catches one expertly, without even looking. &quot;Well hey, never mind, I don&#39;t miss fame. I&#39;ve got it pretty good these days. I&#39;m kind of a tourist attraction here on the farm. All I got to do is sit around all day and I get all the fruit I can eat and all the milk I can drink!&quot; It shows, it really does. At the mention of food, $npc1.his stomach lets out a cavernous gurgle, and $npc1.he absent-mindedly bites into the apple, nearly cutting it in half. &lt;/p&gt;

&lt;p&gt;&quot;&#39;Course,&quot; $npc1.he says with $npc1.his mouth full, &quot;I do kinda miss city life. Especially some of the &#39;&#39;FOOD&#39;&#39;. I think about going sometimes, but...&quot; $npc1.he swallows the rest of the apple whole and then you watch $npc1.his attempts to stand, $npc1.his huge butt lifting about foot off the ground, quivering, before plopping back down with a THUD that shakes MORE apples from the tree. The big $npc1.fella puffs and pants, grinning sheepishly, &quot;...it seems a whole lot further away these days.&quot; $npc1.His eyes brighten. &quot;Say, you wouldn&#39;t do me a favour, would you? Only I&#39;ve got this real &#39;&#39;CRAVING&#39;&#39; for _tempQuest.target.article _tempQuest.target.name.&quot; $npc1.He winks and pats the sack by $npc1.his side. &quot;I&#39;ll trade you what you want for it, don&#39;t worry. And no need to rush...&quot; $npc1.he smiles again and sighs sleepily, settling back, a gigantic, increasingly immobile mountain of a $npc1.species &quot;I&#39;m not going anywhere in a hurry...&quot; &lt;/p&gt;
&lt;&lt;getQuest _tempQuest&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*After you&#39;ve started the quest*/
&lt;&lt;else&gt;&gt;
&lt;&lt;set _tempQuest = $quests[setup.questIndex($uncommonTaste)]&gt;&gt;
/*&lt;&lt;createNPC $horse _tempQuest.gender&gt;&gt;*/

&lt;p&gt;Peering over the curve of $npc1.his hugely obese belly, $npc1.his round face brightens as $npc1.he catches sight of you. &quot;Well hello again!&quot; $npc1.he rumbles happily- or possibly that&#39;s just $npc1.his appetite talking. &quot;Did you manage to find me _tempQuest.target.article _tempQuest.target.name yet?&quot; &lt;/p&gt;

/*If you don&#39;t have the item*/
&lt;&lt;if setup.hasItem(_tempQuest.target) &lt; 0&gt;&gt;

&lt;p&gt;$npc1.He looks a little disappointed when you shake your head apologetically, but $npc1.he smiles all the same. &quot;Heck, that&#39;s no problem, little $p.fella, I guess I can wait a little longer.&quot; &lt;/p&gt;

If $npc1.he &#39;weights&#39; much more $npc1.he might burst before you&#39;ve found $npc1.him $npc1.his _tempQuest.target.name- or $npc1.he might wind up eating YOU! 
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you do have the item*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;$npc1.His fat face breaks into a big smile when you reply in the affirmative. &quot;Oh boy, that&#39;s &#39;&#39;GREAT&#39;&#39;!&quot; That vast monster of a middle growls in anticipation, and you hurriedly hand over the _tempQuest.target.name, your supersized friend grasping for it eagerly and immediately tucking in. While $npc1.he does so, you surreptitiously count your fingers to make sure you didn&#39;t lose any. &lt;/p&gt;

&lt;p&gt;Almost before you know it your offering has been inhaled, and the gargantuan beast sinks back with a contented sigh, one hand on a belly that seems bigger than ever. &quot;Man, that really hit the spot! I&#39;m not complaining, but an all-apple diet can get kind of dull.&quot; Even as $npc1.he says it, $npc1.he reaches out and plucks another apple from the tree, chomping into it automatically. &lt;/p&gt;

&lt;p&gt;&quot;So,&quot; $npc1.he looks down at you with a smile, &quot;I guess I owe you one.&quot; With laborious slowness $npc1.he leans over and hauls a large brown sack up from $npc1.his side, setting it onto $npc1.his stomach. &quot;This is the stuff I collected when I was famous. Now there&#39;s gotta be something in here that you&#39;d take as payment. Anything take your fancy?&quot; &lt;/p&gt;
&lt;&lt;removeItem _tempQuest.target 9&gt;&gt;

&lt;&lt;action &quot;1&quot; &quot;weapon&quot; &quot;A warhammer&quot; &quot;Uncommon Taste Reward&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 1&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;2&quot; &quot;armor&quot; &quot;Splint Armor&quot; &quot;Uncommon Taste Reward&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 2&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;3&quot; &quot;other&quot; &quot;Spectrum Gem&quot; &quot;Uncommon Taste Reward&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 3&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;4&quot; &quot;spells&quot; &quot;Book of crystals&quot; &quot;Uncommon Taste Reward&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 4&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;5&quot; &quot;weapon&quot; &quot;Light lance&quot; &quot;Uncommon Taste Reward&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 5&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;6&quot; &quot;food&quot; &quot;Box of donuts&quot; &quot;Uncommon Taste Reward&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 6&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="253" name="Back away from the milking shed" tags="" position="975,2550" size="100,100">You decide that this needs some more thinking about before you take action. Making sure that the doors are secured, you back away and hurriedly beat a strategic withdrawal. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="254" name="Barn" tags="nobr" position="975,2775" size="100,100">&lt;&lt;set _barnState = &quot;nothing&quot;&gt;&gt;

&lt;&lt;if setup.questCompleted($horseQuestFreedom)&gt;&gt;
	&lt;&lt;set _barnState = &quot;sampson sleeping&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !setup.questCompleted($eatingContest) and  setup.questStarted($eatingContest)&gt;&gt;
	&lt;&lt;set _barnState = &quot;eating contest&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch _barnState&gt;&gt;

&lt;&lt;case &quot;eating contest&quot;&gt;&gt;
The contest is packed not only full of competitors, but of onlookers too, all eager to see who can stuff themselves silly the most. The excitement is buzzing around the place, milk and sweets are being passed around to the spectators and people lining up for bids on who&#39;d eat how much and what place they&#39;d get. You look for your spot and take a seat on the supplied haystack. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Wait&quot; &quot;Wait for eating contest to start&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;sampson sleeping&quot;&gt;&gt;
You hear some distinct, loud snoring coming from inside the barn. 
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;default&gt;&gt;
You walk over to the large red barn. You try to pull the large doors open, but they&#39;re locked from the other side. 
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="255" name="Come out of retirement" tags="" position="1225,3000" size="100,100">&lt;&lt;createFixedNPC &quot;tailor&quot; 3&gt;&gt;

&lt;p&gt;&quot;You&#39;re RIGHT!&quot; your enormous new friend exclaims, $npc1.his eyes gleaming. Glancing at the apple core in $npc1.his fat $npc1.hand, $npc1.he curls it into a fist, stretches $npc1.his flabby arm back and FLINGS the core through the open window. By the time you lose sight of it over the horizon it&#39;s still going upwards, whistling through the air. Woah, $npc1.he&#39;s stronger than you thought! &quot;Yeah! Look out, World! $npc1.Name Shire the Mighty is back in town!&quot; &lt;/p&gt;

&lt;p&gt;$npc1.Name the Mighty then looks down at $npc1.himself, and adds, &quot;But I sure as sweet apples can&#39;t march into town like THIS!&quot; $npc1.He grabs two handfuls of $npc1.his vast stomach and heaves, hefting it before letting it BLOOMP back onto the table-top with a wobble. &quot;I&#39;ve gotta put on some PANTS, at least!&quot; $npc1.He rummages in the brown sack stashed by $npc1.his side, then proudly pulls out an old, voluminous, heavily-worn and much-stretched pair of pants. $npc1.He holds them up in front of $npc1.him, and $npc1.his wide smile slowly fades as $npc1.he sees your expression. &lt;/p&gt;

&lt;p&gt;&quot;Uhm... ok, I guess I HAVE put on a little weight since I last wore these...&quot; Despite their tentlike quality, you don&#39;t think $npc1.he&#39;ll even get one thigh through the waistband any more. $npc1.His fat face brightens. &quot;You wouldn&#39;t be able to do me a favour, would you? Is that tailor still in town? You couldn&#39;t take these along to $npc3.him and get $npc3.him to fix them up for me, could you? Just tell $npc3.him to put it on &#39;ole $npc1.Name&#39;s tab! I&#39;d be really, REALLY grateful. I&#39;ll... uh...&quot; $npc1.his eyes stray back towards the dining table, &quot;...Stay here and build up my strength...&quot; &lt;/p&gt;

You think to take a few measurements before you go- you suspect that description alone is going to be wholly inadequate for this job. Making those measurements it somewhat difficult, but with the aid of a coil of rope you&#39;re at least able to estimate $npc1.his vital statistics before setting out for the city. 
&lt;&lt;getItem $horsePantsBroke&gt;&gt;
&lt;&lt;getQuest $horseQuestClothes&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Head out&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="256" name="Complete Sampson&#39;s quest" tags="nobr" position="1425,2875" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;Complete $npc1.Name&#39;s quest&quot;&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;give pants&quot;&gt;&gt;
&lt;&lt;removeItem $horsePantsFixed&gt;&gt;
&lt;p&gt;$npc1.Name&#39;s face lights up. &quot;That&#39;sh GREAT!&quot; $npc1.he exclaims, spraying you with apple-bits. &quot;Aww, shucks, sorry about that,&quot; $npc1.he says, hurriedly swallowing $npc1.his mouthful, still grinning. &lt;/p&gt;

&lt;p&gt;It takes the sumo-sized $npc1.Name quite some time to stand and try on the pants. $npc1.He winces slightly at the gaudy patterns, but then shrugs. &quot;Kinda too fancy for my tastes, but it&#39;s not like I&#39;M gonna have to see them.&quot; $npc1.He finally manages to wriggle into them, hauling the waistband up over $npc1.his barn-sized backside. &quot;Guhh... kinda SNUG, but I guess they&#39;ll do for now. That darned tailor NEVER manages to make things fit me properly!&quot; &lt;/p&gt;

&lt;p&gt;Finally &#39;decent&#39;, $npc1.Name sits right back down at the table and gives you a big, friendly smile as $npc1.he reaches for another mouthful. &quot;Thanks li&#39;l $p.buddy, guess I owe you again! Reaching down with $npc1.his free $npc1.hand $npc1.he pats $npc1.his traveller&#39;s sack, stashed under the table. &quot;Anything in here you&#39;ll take as payment?&quot; &lt;/p&gt;

/*Apparently I never did the real rewards for this quest*/
&lt;&lt;questReward $horseQuestClothes&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;start armor&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;start armor&quot;&gt;&gt;
&lt;p&gt;&quot;Say, li&#39;l $p.buddy, I&#39;ve just thought of something- pants are all very well, but I guess out in the wilderness you still need armour these days.&quot; $npc1.He shrugs, and smiles roundly. &quot;Good job I&#39;ve still got my... trusty...&quot; $npc1.His eyes meet yours as $npc1.he fingers the burst and ruined fringe of chainmail links framing $npc1.his rolling, corpulent chest. &lt;/p&gt;

&lt;p&gt;&quot;Aww... shucks.&quot; With a little help $npc1.he squirms out of $npc1.his thoroughly-burst armour and holds it up for inspection. &quot;Ok, so MAYBE it needs some work to get it back into fighting shape...&quot; It&#39;s not the ONLY thing around here that needs that. The enormous doughball $npc1.adjective plops slowly back down onto the bench with a wheeze, and glances at you hopefully. &quot;Another favour? Know any good armourers these days? Think you could, uhhh...?&quot; &lt;/p&gt;

&lt;p&gt;You nod, a little resignedly. $npc1.Name looks relieved. That vast gut of $npc1.his lets out another deep rumble, and $npc1.he grabs another handful of food from the table without even seeming to notice. Whilst $npc1.he&#39;s at the table eating you take measurements of $npc1.his chest and torso, having to estimate a couple of times when the rope won&#39;t reach and adding on a bit more anyway to take account of &#39;growing room&#39;. &lt;/p&gt;

&quot;Shucks, I always DID have a big chest,&quot; $npc1.Name comments cheerfully through a shower of crumbs. You refrain from mentioning that these days $npc1.he has a big EVERYTHING. 
&lt;&lt;getItem $horseArmorBroke&gt;&gt;
&lt;&lt;getQuest $horseQuestArmor&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;give armor&quot;&gt;&gt;
&lt;p&gt;You produce the Stretch-Mail and $npc1.Name looks delighted. $npc1.He&#39;s so keen to try it on, $npc1.he even puts down $npc1.his current &lt;&lt;=$npc1.hand&gt;&gt;ful of food! One of the biggest struggles is getting the mail over $npc1.his head, as the neck-hole seems a tad tight,but $npc1.he finally manages to squeeze through and tug the mail over $npc1.his chest and stomach. Well, SOME of the way, at least. It does look rather like someone has armoured the top half of a dirigible balloon, but $npc1.he seems happy enough with the results. &lt;/p&gt;

&lt;p&gt;&quot;Thanks, little $p.buddy! Guess I owe you once again! Now, how can I repay you THIS time?&quot; With something of a struggle, $npc1.he manages to reach $npc1.his bag and drag it out for you to investigate. &quot;Anything you want in there, it&#39;s yours.&quot; &lt;/p&gt;

/*Apparently I never did the real rewards for this quest*/
&lt;&lt;questReward $horseQuestArmor&gt;&gt;
&lt;&lt;removeItem $horseArmorFixed&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;start weapon&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;start weapon&quot;&gt;&gt;
&lt;p&gt;&quot;Well, I think that&#39;s everything!&quot; $npc1.Name says happily, wiping $npc1.his lips and with obvious effort slowly hauling $npc1.himself to $npc1.his overburdened $npc1.feet. $npc1.His huge belly hangs above the tabletop, casting the remains of $npc1.his meal into shadow. &quot;Pants, armour, my trusty weap... Aww... SHUCKS!&quot; $npc1.Name plops back down onto the bench with a BOOMPH, making the wood bend alarmingly beneath $npc1.his enormous bulk. &lt;/p&gt;
&lt;&lt;set _donkey = $donkey.species.toUpperFirst()&gt;&gt;
&lt;p&gt;&quot;Hrrrmphh... I&#39;ve just remembered, I traded my weapon a _donkey&#39;s Age ago to this peddler who was selling the most AMAZING apple-filled doughnuts ...!&quot; The swollen $npc1.species&#39;s mouth starts watering at the mere memory, and $npc1.he absent-mindedly grabs a handful of food from the table and stuffs it into $npc1.his mouth. &quot;Mpsh... but I gotta have SOME kind of weapon to go out adventuring. What kind of hero would I be if I didn&#39;t have a weapon? I mean,&quot; $npc1.he swallows $npc1.his mouthful and reaches for another, &quot;without a weapon I may as well just stay here eating!&quot; $npc1.His eyes fall on you, and $npc1.his fat features register hope, as well as some mutual embarrassment. &lt;/p&gt;

&quot;Uh, sorry li&#39;l $p.buddy, but I couldn&#39;t ask you for ANOTHER favour, could I?&quot; $npc1.Name pulls out a small money-pouch on a cord sandwiched between $npc1.his meaty pecs. It makes a satisfying chink in your palm. &quot;Go buy me a replacement? I don&#39;t need my EXACT old weapon back, no sir, but something big and heavy to swing would sure be appreciated. An axe would be perfect but, uhh...&quot; $npc1.he gestures down at $npc1.his oversized body and shrugs, a gesture that causes $npc1.his chest and stomach to ripple sluggishly. &quot;They might be a little SMALL for me these days...&quot;
&lt;&lt;doGld 50&gt;&gt;
&lt;&lt;getQuest $horseQuestWeapon&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;give weapon&quot;&gt;&gt;
/*If you only have a regular axe*/
&lt;&lt;if setup.hasItem($giantAxe) &lt; 0&gt;&gt;
&lt;p&gt;$npc1.Name&#39;s face brightens further as you produce an axe. &quot;Hey, an axe! That&#39;s great!&quot; $npc1.He takes it from you, but it sits in $npc1.his large, fat hand like something out of a My Little Adventuring Warhorse play-set. After a few unsuccessful attempts to grip it in more than thumb and forefinger $npc1.he reluctantly hands it back, shrugging and letting out a disappointed $npc1.angry. &lt;/p&gt;

&quot;Hrrrrrmph... I&#39;m sorry, but I&#39;d feel like a complete idiot trying to swing THAT in a fight. Shucks, it&#39;d be like poking someone with one of those toothpicks with a bit of pineapple on the end of it. They sure make axes SMALLER than they did in my day.&quot; 
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you have a great axe*/
&lt;&lt;else&gt;&gt;
&lt;&lt;removeItem $giantAxe&gt;&gt;
&lt;p&gt;$npc1.Name&#39;s face brightens further as you produce an axe
&lt;&lt;if $str &lt; 20&gt;&gt;, your arms quaking under the oversized article&#39;s great weight&lt;&lt;/if&gt;&gt;. &quot;Hey, an axe! That&#39;s great!&quot; $npc1.He takes it from you, and holds it up to admire it, lifting it easily with one fat hand. &quot;Say, this is PERFECT!&quot; $npc1.He takes it in both hands and gives a couple of experimental swings, the last of which accidentally cut through the cord holding up one of the lamps. &quot;Whoops! Heh, guess I can&#39;t see over my shoulder as well as I used to! $npc1.he cranes $npc1.his bloated neck for a moment, thick rolls of flab bunching around it and $npc1.his chunky shoulder. &quot;But thanks li&#39;l $p.buddy, this is JUST what I need!&quot; &lt;/p&gt;

The uber-hefty $npc1.species brings $npc1.his new axe down blade first onto the table, cleaving a large apple pie in two with a furniture-juddering WHACK. Grabbing one half $npc1.he begins to munch on it happily. Already $npc1.he&#39;s reaching down to haul out $npc1.his travelling sack. &quot;I guess I owe you again.&quot;
&lt;&lt;questReward $horseQuestWeapon&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;start strength&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case &quot;start strength&quot;&gt;&gt;
&lt;p&gt;&quot;Hrmmmphhhh... That&#39;s DEFINITELY everything, this time!&quot; $npc1.Name $npc1.whickers, hurriedly gulping down $npc1.his latest mouthful, and then shamelessly reaching for a couple more &#39;for the road&#39;. &quot;Pants, armour, blade... Yep! Look out World! Here... hoof... Here I... gluh!...&quot; You watch as the hugely hefty $npc1.species&#39;s thunderously fat thighs bulge and quiver, trying to haul $npc1.his ponderous, pants-stretching butt into the air. It rises by about an inch, underside still resting on the wooden bench beneath them. $npc1.He grunts and redoubles $npc1.his efforts, grimacing with exertion. That big, soft backside begins to lift from its bench with tectonic slowness, jiggling slowly. &lt;/p&gt;

&lt;p&gt;&quot;H-here I... gnhh!... World!... H-HERE... I... COME-urgghhhh...!&quot; $npc1.Name sinks back right down again with a groan, sweating profusely. The bench groooooans with $npc1.him as $npc1.his vast weight settles back down onto it, whilst $npc1.his enormous stomach smooshes back across the tabletop. $npc1.He puffs and pants, clapping a hand against that gigantic gut incredulously, as if seeing it for the first time. Yup, It looks like $npc1.Name Shire has, finally, grown too fat to stand. 
&lt;/p&gt;

&lt;&lt;set _HORSE = $npc1.nspecies.toUpperCase()&gt;&gt;

&lt;p&gt;&quot;Aww, SHUCKS! This... this is ridiculous!&quot; $npc1.he puffs. &quot;I&#39;ve... I&#39;ve always been as strong as a _HORSE! I&#39;ve got to shift some of this poundage, and soon. Hrrmphhh....&quot; $npc1.his hand pats again at the curving horizon of $npc1.his middle, making it ripple slightly. $npc1.His eyes glaze over slightly. &quot;On... the OTHER hand...&quot; $npc1.he says slowly, spare hand reaching to rub the other side of $npc1.his stomach, &quot;It&#39;d be a whole lot faster and just downright EASIER if I had a spectrum gem to hand! I figure one of THOSE&#39;d be enough to... uhh...&quot; $npc1.he blushes slightly, &quot;get me back on my $npc1.feet.&quot; The superfattened $npc1.species turns to look at you imploringly, has hand having already snagged a toffee-apple from the table. &lt;/p&gt;

&quot;One last favour, li&#39;l $p.buddy? The last one, I promise! C-could you get me a spectrum gem from somewhere? Just in case? I&#39;ll... I&#39;ll probably not need it in the end, of course. Ain&#39;t no way $npc1.Name Shire&#39;s too big a fat-ass to stand up! I&#39;ve just gotta... catch my breath, that&#39;s all....&quot; As you leave you hear the loud &#39;scrunch&#39; of toffee being bitten into.
&lt;&lt;getQuest $horseQuestStrength&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;give gem&quot;&gt;&gt;
&lt;&lt;removeItem $spectrumGem&gt;&gt;
&lt;p&gt;&quot;That&#39;s- URRP!- that&#39;s GREAT!\&quot; the humungous $npc1.species huffs, grinning widely and holding out a fat mitt in expectation. A little reluctantly, you hand it over. &lt;/p&gt;

&lt;p&gt;As $npc1.Name&#39;s chubby fist clenches around the gem, it crackles with power, and you take a hurried step back as its energy is released into your expansive $npc1.adjective companion. $npc1.He $npc1.whinnies loudly and seems to luxuriate in the process as the bolts of light supercharge $npc1.him, $npc1.his body devouring energy as eagerly as it does food. $npc1.He stretches and arches $npc1.his back, $npc1.his huge hamlike legs quivering, and $npc1.his barn-sized backside slowly lifts from the bench, lightning still playing around $npc1.him. At the peak of $npc1.his stretch the gem&#39;s power abruptly fades and the supersized $npc1.species grunts with satisfaction. $npc1.He now stands a good &lt;&lt;sayDistance 180&gt;&gt; tall, ears tickling the rafters as $npc1.he smiles down at you. $npc1.He looks easily as wide as $npc1.he is tall, if not a little wider. &lt;/p&gt;

&quot;Shucks, guess this place is a little CRAMPED for the likes of me these days...&quot; $npc1.He $npc1.whickers a laugh and slaps a hand to $npc1.his gargantuan belly. &quot;Hrrrmph... But that gem sure did the trick, huh? And none of that boring &#39;dieting&#39; required!&quot; $npc1.He snorts, chuckling to $npc1.himself, then bends down to haul $npc1.his traveller&#39;s sack out from under the table. &quot;Guess I should show my appreciation more tangibly. Anything in here that you&#39;ll take as payment?&quot;
&lt;&lt;questReward $horseQuestStrength&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;\&quot;Thanks!\&quot;&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;start freedom&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;start freedom&quot;&gt;&gt;
&lt;p&gt;Fully-equipped, if nearly bursting out of $npc1.his armour, the reinvigorated $npc1.Name Shire snorts, hefts $npc1.his giant axe and declares, &quot;Look out world, here I come! And this time I won&#39;t let NOTHING stand in my way!&quot; The hugely hefty $npc1.species nevertheless gives the remaining food on the table a lingering look. &quot;Uhh, what d&#39;you say to my taking a SNACK for the road?&quot; $npc1.His resolve stiffening, $npc1.he somewhat reluctantly turns and stomps out through the farmhouse door, $npc1.his lumbering $npc1.footsteps making the whole room shake. &lt;/p&gt;

&lt;p&gt;&quot;OOF!&quot; The room shakes again, the walls creaking, and then silence falls, a little dust settling around you. The farmhouse seems a little gloomy, all light from the doorway now being blocked by the g-g-gigantic butt firmly jammed between the doorposts. You hear a $npc1.angry from outside and that huge $npc1.species-hinder quivers, making the farmhouse shake again, but the doorframe keeps its vice-like grip. It looks like $npc1.Name the Mighty&#39;s met $npc1.his first new adventuring challenge! 
&lt;/p&gt;

&quot;Hrrmpphhh... You still in there, li&#39;l $p.buddy? Nghhh...!&quot; You watch the doorframe creak and warp in its socket as the humungous $npc1.species HEAVES, but $npc1.Name&#39;s enormously overfed backside remains completely wedged. &quot;A-any chance of a SHOVE here?&quot; Oh dear, this is going to be a tall order!
&lt;&lt;getQuest $horseQuestFreedom&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Push?&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;push sampson&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;next&quot; &quot;I may have to come back&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no freedom&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;push sampson&quot;&gt;&gt;
&lt;p&gt;You back up as far as you can to give yourself some sort of run-up, then with a count of 3 you shoulder-charge the jello-ball of a tuckus filling the doorway. At least it&#39;s an easy target. You smack against $npc1.Name&#39;s rotund rear-end with a blubbery BOOMPH (and an accompanying $npc1.angry from outside) and start to sink into the bloated blob of &lt;&lt;=$npc1.nspecies&gt;&gt;flesh, your legs still pedalling frantically. &lt;/p&gt;

/*If you can&#39;t push him out*/
&lt;&lt;if $str &lt; 120 and setup.weight() &lt; 800&gt;&gt;
You hear a creeeeeeak from the doorframe, and for a moment it looks like you might manage it, but you then feel your forward motion slow to a stop, $npc1.Name&#39;s hide quivering against you. Then, you feel $npc1.his flab starting to shove back! Rather humiliatingly, you are ignominiously shoved back out, stumbling backwards a few paces until you regain your balance. $npc1.Name, meanwhile, hasn&#39;t moved forwards an inch. You have, literally, been defeated by a $npc1.species&#39;s ass! 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I may have to come back&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no freedom&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

/*If you can push him out*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You hear an alarming creeeeeeak from the doorframe, then feel it give an almighty &#39;&#39;CRACK&#39;&#39;, the shock transmitted through all that &lt;&lt;=$npc1.nspecies&gt;&gt;flesh to ripple against you. There&#39;s a quivering shudder, then suddenly the immovable mass of blubber you&#39;re pressed against lurches forwards! You stagger after it, and almost trip head first down the porch-steps, doing an alarmingly uncontrolled little dance down them as you try frantically to keep your balance. When you finally draw to a stop, you find the supersized $npc1.Name standing in front of you, glaring over $npc1.his shoulder at $npc1.his big ole&#39; back end, which still has the timber doorframe clamped around it like a vice. $npc1.He catches your eye and snorts, starting to blush. &lt;/p&gt;

&quot;Shucks, why can&#39;t they just make doors sized for REALISTIC heroes?&quot; $npc1.He $npc1.whickers and flexes $npc1.his backside- with a splintering CRACK the timbers burst apart, leaving $npc1.Name free and standing in the fresh air of the farmyard. Outside, $npc1.he manages to look even bigger than indoors! &quot;Gee, I guess I owe you ANOTHER one, li&#39;l $p.buddy! If you hadn&#39;t been around to help, I might have been stuck there!&quot; $npc1.He hefts $npc1.his travelling bag and holds it out to you. &quot;Anything you want in return?&quot; 
&lt;&lt;questReward $horseQuestFreedom&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;pushed free&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case &quot;pushed free&quot;&gt;&gt;
&lt;p&gt;$npc1.Name Shire the Mighty squares $npc1.his plump shoulders beneath $npc1.his extra-stretchy armour and grins at you. &quot;Hrrrmph... Well, Adventure&#39;s calling! Thanks again for all your help, li&#39;l $p.buddy, I&#39;m sure I&#39;ll bump into you again sometime. But, for now, I&#39;ve gotta get back on the road!&quot; &lt;/p&gt;

&lt;p&gt;$npc1.He turns and starts to lumber towards the farm gate. You watch that ponderous backside wobble and jiggle, stretching those new pants pretty fully. But before $npc1.he&#39;s even reached the gate, you spot that $npc1.Name is slowing, and starting to sweat. After a few more paces $npc1.he stops, panting, and leans against a gatepost, $npc1.his bulk threatening to uproot it. &lt;/p&gt;

&lt;p&gt;&quot;Shucks... all this... is way more... EFFORT than I remember!&quot; The super-chubby $npc1.species grabs $npc1.his belly and hefts it a couple of times. &quot;Maybe I shouldn&#39;t have... weighed myself down!&quot; $npc1.He looks up, and catches sight of the barn. &quot;Hrrmpph! I might... might just... have a NAP before setting out...&quot; And you watch $npc1.him stumble heavily for the barn- at least THESE doors $npc1.he fits through. There&#39;s an earth-shaking THUD from inside, and a few moments later you can just about detect a rumbling snore start up... &lt;/p&gt;

Obviously adventure will have to weight for another day...
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Good night?&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;pull Sampson&quot;&gt;&gt;
Taking hold of the supersized $npc1.species&#39;s hefty $npc1.hands, you lean back on your $p.feet and HEAVE with all your might. $npc1.Name grunts and winces as $npc1.his chubby arms stretch in their sockets, the doorframe creaking loudly as you manage to drag the bulging beast a couple of inches further through... 

&lt;&lt;if $str &lt; 120 and setup.weight() &lt; 800&gt;&gt;
only for $npc1.him to rebound with a mighty GLOOP! You are hauled off your $p.feet and catapulted bodily against $npc1.Name&#39;s rolling chest, eliciting a grunt from the overfed $npc1.adjective. Staggering backwards, you find that, except for a few bruises on yourself, the pair of you are no further forward. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I may have to come back&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;doing freedom&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
and then with an ear-splitting CRACK and a shower of brick dust the doorframe sags slightly wider and $npc1.he begins to slide forwards under $npc1.his own weight! 

&lt;p&gt;You stagger backwards, teetering unsteadily at the top of the porch steps, then glance back at the doorway, alerted by further rending, cracking sounds. A rotund shadow falls over you as the porch begins to shake, and you hear the $npc1.species&#39;s deep voice bellow out, &quot;Hrrmphhh! Comin&#39; THROUGH...!&quot;&lt;/p&gt;

&lt;p&gt;Too late! A vast, curved wall of $npc1.adjective blubber slams into you and you sail backwards with it, feeling yourself hang in the air a moment before the pair of you SLAM into the ground, with you, tragically, underneath! Squashed beneath the mammoth $npc1.adjective at the bottom of the impact crater, your last woozy thought is //&#39;Well, at least it&#39;s warm under here...&#39;//&lt;/p&gt;

But thankfully $npc1.Name eventually manages to roll off of you and picks you back up on your feet! $npc1.He helpfully dusts you off. 
&lt;&lt;questReward $horseQuestFreedom&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks?&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;pushed free&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="257" name="Dairy Farm" tags="nobr" position="1325,2500" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;createFixedNPC &quot;dairyFarmer&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;sampson&quot; 1&gt;&gt;

&lt;p&gt;You&#39;re standing in the main hub of the farm under the branches of a large apple tree. To the east there&#39;s a large pasture filled with several large farm animals diligently mowing down the grass as fast as it can grow back. To the west there&#39;s a small whitewashed sales stand with little paintings of &lt;&lt;=$cattle.fname&gt;&gt;s over it. South of that are two large buildings, one of them a large barn and the other a small milking shed. On the southern end of the property stands a tall white farmhouse. It looks a little run down, but still seems well maintained. &lt;/p&gt;

&lt;p&gt;&lt;&lt;if $hour &gt;= 9 and $hour &lt;= 17&gt;&gt;
A $npc2.color $npc2.species stands behind a market stand. They briefly stop chugging from a glass of milk long enough to wave at you. 

&lt;&lt;else&gt;&gt;
Crickets chirp in the nearby field as the dairy farm lies dormant. 
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;&lt;vendor &quot;milk stand&quot;&gt;&gt;
&lt;&lt;set _horseTree = false&gt;&gt;

/*Before you&#39;ve started the horse&#39;s first quest*/
&lt;&lt;if !setup.questStarted($uncommonTaste)&gt;&gt;
&lt;&lt;set _horseTree = true&gt;&gt;
&lt;p&gt;In the distance you spot something half-obscured in the dappled shade of an apple tree. To start with you think it&#39;s a landmark of some kind, but as you approach you realise with a start that it&#39;s nothing of the kind- it&#39;s a person! It&#39;s hard to identify which species to start with, because whoever they are, they&#39;re one of the fattest things you&#39;ve ever seen! Their $npc1.coatDesc, $npc1.feetDesc and $npc1.maneDesc lead you to guess that they&#39;re a $npc1.nspecies. Nine feet tall while sitting down, they tower over you, but that&#39;s nothing compared to their girth! &lt;/p&gt;

&lt;p&gt;A truly colossal stomach fills the space between their spread, hamlike legs, the front of it pushing just beyond their $npc1.feet, while their backside is as broad as a barn, the trunk of the apple tree pressing between them, creaking under the strain as they doze in the shade, leaning back comfortably against it. A pile of apple cores litters the ground next to them, and a large sack rests underneath a bulging $npc1.color lovehandle. You can&#39;t tell if they&#39;re wearing anything on their humungous hindquarters, but you realise that the silvery jacket stretched around their shoulders is actually chainmail armour that burst apart! The links of metal tinkle against their mammoth, rolling chest as it slowly rises and falls. You don&#39;t think this beast will even be able to stand! &lt;/p&gt;

/*After you&#39;ve started but not finished the horse&#39;s first quest*/
&lt;&lt;elseif !setup.questCompleted($uncommonTaste)&gt;&gt;

&lt;&lt;set _tempQuest = $quests[setup.questIndex($uncommonTaste)]&gt;&gt;
/*&lt;&lt;createNPC $horse _tempQuest.gender&gt;&gt;*/
&lt;&lt;set _horseTree = true&gt;&gt;

&lt;p&gt;Under the apple tree there&#39;s a familiar landmark-sized figure. $npc1.He seems to have grown even heavier in your absence- that gut is definitely pushing past $npc1.his $npc1.feet, now. The pile of apple cores and discarded milk bottles has grown distinctly. As you approach the slumbering $npc1.adjective mountain, $npc1.he wakes from $npc1.his doze with a snort. &lt;/p&gt;

&lt;&lt;elseif !setup.questStarted($horseQuestFreedom)&gt;&gt;
&lt;p&gt;There are lights on in the farm house to the south. &lt;/p&gt;

&lt;&lt;elseif !setup.questCompleted($horseQuestFreedom)&gt;&gt;
&lt;p&gt;You see the $npc1.nspecies adventurer is still wedged into the farm house doorway. They wave at you as you approach the farm. &lt;/p&gt;

/*If you&#39;ve finished the horse&#39;s quests*/
&lt;&lt;else&gt;&gt;

&lt;p&gt;You&#39;re standing under a tall apple tree in the approximate center of the farm. A gentle breeze softly rustles through the tree. &lt;/p&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Dairy Farm&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;road&quot; &quot;Western Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;store&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fence&quot; &quot;Pasture&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if _horseTree&gt;&gt;
	&lt;&lt;action &quot;se&quot; &quot;quest&quot; &quot;A Grand Adventurer&quot; &quot;An Equine Adventurer&quot;&gt;&gt;
		&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;building&quot; &quot;Barn&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;building&quot; &quot;Milking Shed&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;house&quot; &quot;Farm House&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="258" name="Eating contest Round 1" tags="nobr cutscene" position="975,2975" size="100,100">&lt;p&gt;Once a large piece of bread, it has been cut open from the top and scooped out to allow for a thick soup dip to be poured in. You find that the only way you&#39;re going to eat this soup is to break off the bread before scooping up the soup to eat. &lt;/p&gt;

/*Part 1*/
&lt;&lt;if $eventCounterB == 3&gt;&gt;
You tear off hunks of bread and scoop/soak up as much soup as possible before cramming the bread into your mouth. 
&lt;&lt;consume 5 3&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 2*/
&lt;&lt;elseif $eventCounterB == 2&gt;&gt;
You continue tearing off hunks of bread, while being careful to not let any of the dip ooze out. The bread bowl stays more or less structurally stable and you manage to stuff several savory mouthfuls down your throat, only occasionaly dripping some of the dip onto your $top.name. 
&lt;&lt;consume 5 3&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 3*/
&lt;&lt;elseif $eventCounterB == 1&gt;&gt;
You&#39;ve reached the home stretch and are now tearing off soggy pieces of the dip soaked bottom of the bread bowl. 
&lt;&lt;consume 5 3&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You pinch the last soaking bit of bread and drop it into your mouth before swallowing it down. You belch loudly, indicating you&#39;ve finished this round and are ready to decide what to do when the next one comes up. &lt;/p&gt;

/*Sets up next round*/
&lt;&lt;switch random(1,3)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant. The assistants lift off the covers and presenting a four-layer cheeseburger for each of you. 
&lt;&lt;set $eventCounterA = 21&gt;&gt;
													
&lt;&lt;case 2&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present a pyramid of 10 hotdogs for each of you. 
&lt;&lt;set $eventCounterA = 22&gt;&gt;

&lt;&lt;case 3&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present a large meat pie for each of you. 
&lt;&lt;set $eventCounterA = 23&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions*/
&lt;&lt;if $alive&gt;&gt;

/*Continue round 1*/
&lt;&lt;if $eventCounterA &lt; 20&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 1&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Start round 2*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 2&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = 3&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If not alive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You take a breather from the last bite, feeling that you&#39;ve probably gone a little too far for even slightly feeling comfortable. Shifting on your haystack uncomfortably, you look at the plate of cheeseburger and wonder if you can fit any more in before you pass out. With a small talk to yourself, you work up the courage to eat just one more bite, but find yourself in immense pain. Your stomach seems to want to fall off it&#39;s so full. You try to stay conscious, the contest round still hasn&#39;t finished, but you&#39;re unable to bear the pain for much longer. You remember reaching for one last bite before you fade into unconsciousness. &lt;/p&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="259" name="Eating contest Round 2" tags="nobr cutscene" position="975,3075" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 21&gt;&gt;
&lt;p&gt;Larger than an average cheeseburger in both height and width, this four-layered burger is a little bit bigger than your head. Each layer has two beef patties, covered with two slices of melted cheese, ketchup and two pickles. The burger sits on the plate, using up most of the room, just waiting to be eaten. &lt;/p&gt;

/*Part 1*/
&lt;&lt;if $eventCounterB == 3&gt;&gt;
You begin to attempt to dig into the first course, although after a few attempts it&#39;s clear a burger this large was not meant to be eaten by hand. You look around and see most of the other contestants merely sticking their face into the burger and eating it that way. You follow suit and begin swallowing down hunks of meat and cheese. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 2*/
&lt;&lt;elseif $eventCounterB == 2&gt;&gt;
You&#39;re making good progress, although it&#39;s getting harder and harder to actually keep things neat. Your face and chest have several grease and ketchup stains. You start grabbing errant bite sized hunks of burger in your hand and start eating those as well. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 3*/
&lt;&lt;elseif $eventCounterB == 1&gt;&gt;
You&#39;ve reached the home stretch and are now scooping up the scattered remains of the burger and cramming them into your grease soaked face. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You pop the last of the cheeseburger in your mouth, sighing contently as you swallow it down. You belch loudly, indicating you&#39;ve finished this round and are ready to decide what to do when the next one comes up. &lt;/p&gt;

/*Sets up next round*/
&lt;&lt;switch random(1,2)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present an enormous chocolate cheese cake for each of you. 
&lt;&lt;set $eventCounterA = 31&gt;&gt;
													
&lt;&lt;case 2&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present an enormous bowl of ice cream for each of you. 
&lt;&lt;set $eventCounterA = 32&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions*/
&lt;&lt;if $alive&gt;&gt;

/*Continue round 2*/
&lt;&lt;if $eventCounterA &lt; 30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Start round 3*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 3&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = 3&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If not alive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You take a breather from the last bite, feeling that you&#39;ve probably gone a little too far for even slightly feeling comfortable. Shifting on your haystack uncomfortably, you look at the plate of cheeseburger and wonder if you can fit any more in before you pass out. With a small talk to yourself, you work up the courage to eat just one more bite, but find yourself in immense pain. Your stomach seems to want to fall off it&#39;s so full. You try to stay conscious, the contest round still hasn&#39;t finished, but you&#39;re unable to bear the pain for much longer. You remember reaching for one last bite before you fade into unconsciousness. &lt;/p&gt;
&lt;&lt;questReward $eatingContest&gt;&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;




&lt;&lt;case 22&gt;&gt;
&lt;p&gt;The plate of hot dogs has been stacked upon each other, barely able to contain itself on the plate. Each hot dog consists of a bun, one sausage, cheese, ketchup and mustard packed to the brim. &lt;/p&gt;

/*Part 1*/
&lt;&lt;if $eventCounterB == 3&gt;&gt;
As this course is much easier to devour, you manage to keep a much faster pace as you chomp down several hotdogs one after the other. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 2*/
&lt;&lt;elseif $eventCounterB == 2&gt;&gt;
You manage to keep up your pace as you swallow down each dog in two or three bites. Greasy juices burst from each one as you bite into it, the juices dripping down your chin and congealing on your chest. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 3*/
&lt;&lt;elseif $eventCounterB == 1&gt;&gt;
You&#39;ve reached the home stretch and pick up the last two hotdogs in each hand. You gulp the first one down almost without chewing and pause for a second before you bite into the final hotdog. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You toss the final bite into your mouth, sighing contently as you swallow it down. You belch loudly, indicating you&#39;ve finished this round and are ready to decide what to do when the next one comes up. &lt;/p&gt;

/*Sets up next round*/
&lt;&lt;switch random(1,2)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present an enormous chocolate cheese cake for each of you. 
&lt;&lt;set $eventCounterA = 31&gt;&gt;
													
&lt;&lt;case 2&gt;&gt;
You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present an enormous bowl of ice cream for each of you. 
&lt;&lt;set $eventCounterA = 32&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions*/
&lt;&lt;if $alive&gt;&gt;

/*Continue round 1*/
&lt;&lt;if $eventCounterA &lt; 30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Start round 2*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 3&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = 3&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If not alive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You take a breather before the next bite, feeling that you&#39;ve probably gone a little too far for even slightly feeling comfortable. Shifting on your haystack uncomfortably, you look at the remains of the hotdog pyramid and wonder if you can fit any more in before you pass out. With a small talk to yourself, you work up the courage to eat just one more bite, but find yourself in immense pain. Your stomach seems to want to fall off it&#39;s so full. You try to stay conscious, the contest round still hasn&#39;t finished, but you&#39;re unable to bear the pain for much longer. You remember reaching for one last bite before you fade into unconsciousness. &lt;/p&gt;
&lt;&lt;questReward $eatingContest&gt;&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;





&lt;&lt;case 23&gt;&gt;
&lt;p&gt;This meat pie is certainly not meant for one person, it&#39;s big, full and smells incredibly delicious. The pastry of the pie is bulging incredibly, showing that the pie has been filled to the brim. From the smell of it, it seems to be of packed with meat cooked to perfection with a hint of flavours from assorted ingredients. Upon the top of the spherical crust is a healthy dollop of barbeque sauce, swirled around in a spiral. &lt;/p&gt;

/*Part 1*/
&lt;&lt;if $eventCounterB == 3&gt;&gt;
They were nice enough to provide you all with forks this time around. You break through the golden crust and scoop out a forkfull of savory meat into your mouth. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 2*/
&lt;&lt;elseif $eventCounterB == 2&gt;&gt;
You continue to dig out hunks of rich pie filling into your mouth and shovel them into your mouth. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 3*/
&lt;&lt;elseif $eventCounterB == 1&gt;&gt;
You&#39;ve reached the home stretch and scrape together the last bits of pie filling together. You pile the last mounding bite of meat and crust onto your fork. 
&lt;&lt;consume 7 4&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

&lt;&lt;if $alive&gt;&gt;

/*Sets up next round*/
&lt;&lt;switch random(1,2)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
&lt;p&gt;You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present an enormous chocolate cheese cake for each of you. &lt;/p&gt;
&lt;&lt;set $eventCounterA = 31&gt;&gt;
													
&lt;&lt;case 2&gt;&gt;
&lt;p&gt;You mentally steel yourself to prepare for the oncoming gastronomical onslaught. As you wait for your food, several $npc1.species assistants each carry over a platter and puts it down in front of you and each other contestant after removing the remains of the previous round. The assistants lift off the covers and present an enormous bowl of ice cream for each of you. &lt;/p&gt;
&lt;&lt;set $eventCounterA = 32&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions*/
&lt;&lt;if $alive&gt;&gt;

/*Continue round 2*/
&lt;&lt;if $eventCounterA &lt; 30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Start round 3*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 3&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If not alive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You take a breather before the next bite, feeling that you&#39;ve probably gone a little too far for even slightly feeling comfortable. Shifting on your haystack uncomfortably, you look at the remains of the hotdog pyramid and wonder if you can fit any more in before you pass out. With a small talk to yourself, you work up the courage to eat just one more bite, but find yourself in immense pain. Your stomach seems to want to fall off it&#39;s so full. You try to stay conscious, the contest round still hasn&#39;t finished, but you&#39;re unable to bear the pain for much longer. You remember reaching for one last bite before you fade into unconsciousness. &lt;/p&gt;
&lt;&lt;questReward $eatingContest&gt;&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="260" name="Eating contest Round 3" tags="nobr cutscene" position="975,3175" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 31&gt;&gt;
&lt;p&gt;Threatening to overflow the plate, the double layered cheesecake is packed with sugar and other filling to the point where it looks about to burst. One small slice has been cut out for you so that you can see the chocolate filling ooze out of the centre. The whole appearance of the cake makes your mouth water. &lt;/p&gt;

/*Part 1*/
&lt;&lt;if $eventCounterB == 3&gt;&gt;
You&#39;re given a very large spoon to thankfully aid you in the dessert course of the contest. You carve out heaping spoonfulls of chocolately cheescake and shoveling rich heavy mountfuls down. 
&lt;&lt;consume 9 6&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 2*/
&lt;&lt;elseif $eventCounterB == 2&gt;&gt;
You rotate the plate around to get at the next section of cheesecake. You attempt to scrape up any errant chocolate that&#39;s been oozing out as you gulp down more and more of the decadent dessert. 
&lt;&lt;consume 9 6&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 3*/
&lt;&lt;elseif $eventCounterB == 1&gt;&gt;
You spin the plate around to the final surviving side of the cheesecake. What remains is starting to get warm and melty as you bring together sweet sloppy scoops to your mouth. 
&lt;&lt;consume 9 6&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You shove the final bite into your mouth, sighing contently as you swallow it down. You belch loudly, indicating you&#39;ve finished this round and are ready to decide what to do when the next one comes up.&lt;/p&gt;
&lt;&lt;set $eventCounterA = 41&gt;&gt; 
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions*/
&lt;&lt;if $alive&gt;&gt;

/*Continue round 3*/
&lt;&lt;if $eventCounterA &lt; 40&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 3&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*End contest*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Finish eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If not alive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;
You take a breather before the next bite, feeling that you&#39;ve probably gone a little too far for even slightly feeling comfortable. Shifting on your haystack uncomfortably, you look at the remains of the cheesecake and wonder if you can fit any more in before you pass out. With a small talk to yourself, you work up the courage to eat just one more bite, but find yourself in immense pain. Your stomach seems to want to fall off it&#39;s so full. You try to stay conscious, the contest round still hasn&#39;t finished, but you&#39;re unable to bear the pain for much longer. You remember reaching for one last bite before you fade into unconsciousness. &lt;/p&gt;
&lt;&lt;questReward $eatingContest&gt;&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;





&lt;&lt;case 32&gt;&gt;
&lt;p&gt;Several large scoops of ice cream has been dropped onto the plate, still very cold and smelling absolutely delicious. There are flavours of mint, strawberry, vanilla and chocolate all covered with a caramel topping which has hardened, give the appearance of frozen beauty. &lt;/p&gt;

/*Part 1*/
&lt;&lt;if $eventCounterB == 3&gt;&gt;
A large metal spoon is wedged into the center of the ice cream mountain. With a couple of tugs you manage to pull it free and start carving out large frozen hunks of ice cream and start devouring them before they get too melty. 
&lt;&lt;consume 9 6&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 2*/
&lt;&lt;elseif $eventCounterB == 2&gt;&gt;
You start digging into the strawberry quadrant as you devour the quickly melty confection. You occasionally have to take a break so as to avoid getting a massive case of brain freeze. 
&lt;&lt;consume 9 6&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

/*Part 3*/
&lt;&lt;elseif $eventCounterB == 1&gt;&gt;
You&#39;re reaching the home stretch and most of the ice cream has melted into a soup. You attempt to scoop up what remaining icebergs of ice cream are left and pour them into your mouth. 
&lt;&lt;consume 9 6&gt;&gt;
&lt;&lt;set $eventCounterB -=1&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You pick up the platter and draing the remaining melted ice cream down your gullet, sighing contently as you swallow it down. You belch loudly, indicating you&#39;ve finished this round and are ready to decide what to do when the next one comes up. &lt;/p&gt;
&lt;&lt;set $eventCounterA = 41&gt;&gt; 
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions*/
&lt;&lt;if $alive&gt;&gt;

/*Continue round 3*/
&lt;&lt;if $eventCounterA &lt; 40&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 3&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*End contest*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Finish eating contest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*If not alive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You take a breather before the next gulp, feeling that you&#39;ve probably gone a little too far for even slightly feeling comfortable. Shifting on your haystack uncomfortably, you look at the remains of the ice cream and wonder if you can fit any more in before you pass out. With a small talk to yourself, you work up the courage to eat just one more bite, but find yourself in immense pain. Your stomach seems to want to fall off it&#39;s so full. You try to stay conscious, the contest round still hasn&#39;t finished, but you&#39;re unable to bear the pain for much longer. You remember reaching for one last bite before you fade into unconsciousness. &lt;/p&gt;
&lt;&lt;questReward $eatingContest&gt;&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="261" name="Enter the milking shed" tags="nobr" position="1075,2550" size="100,100">&lt;p&gt;Taking a deep breath, you haul one of the doors open, then slip inside, pulling it shut behind you. Peering in the semi-gloom of the milking shed, you look around, but see nothing of particular interest. There is quite a strong, distinct smell hanging in the air, though. Then you look down at the floor and see, sitting in the centre of the shed, a large cheese about the size of a cart-wheel. You&#39;ve never seen a cheese quite like this. It looks hard and crumbly, with a reddish rind and swiss-cheese type holes. It seems to be quivering slightly, with steam rising off it. It doesn&#39;t look too dangerous, although you can&#39;t help but notice a dagger sticking out of the top of it like a cheese-knife, and a number of other cut-marks in the rind. &lt;/p&gt;

You take a step towards it, then back up hurriedly as the rind cracks to reveal a kind of mouth set in a feral, hungry grin, strands of soft cheese hanging between the jaws. //Yowsa!// You&#39;ve heard of over-ripe cheese trying to crawl off the plate, but this is ridiculous! 
&lt;&lt;setEnemy $cheeseMonster&gt;&gt;
&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="262" name="Farm House" tags="nobr" position="1300,2750" size="100,100">&lt;&lt;set $eventCounterA = &quot;no quest&quot;&gt;&gt;

&lt;&lt;if setup.questCompleted($uncommonTaste)&gt;&gt;
	/*&lt;&lt;set _gender = $quests[setup.questIndex($uncommonTaste)].gender&gt;&gt;
	&lt;&lt;createNPC $horse _gender&gt;&gt;*/
&lt;&lt;/if&gt;&gt;

/*Sets which quest you&#39;re on*/
&lt;&lt;if setup.questCompleted($uncommonTaste) and !setup.questStarted($horseQuestClothes)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;start clothes&quot;&gt;&gt;

&lt;&lt;elseif setup.questStarted($horseQuestClothes) and !setup.questCompleted($horseQuestClothes)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;doing clothes&quot;&gt;&gt;

&lt;&lt;elseif setup.questStarted($horseQuestArmor) and !setup.questCompleted($horseQuestArmor)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;doing armor&quot;&gt;&gt;

&lt;&lt;elseif setup.questStarted($horseQuestWeapon) and !setup.questCompleted($horseQuestWeapon)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;doing weapon&quot;&gt;&gt;

&lt;&lt;elseif setup.questStarted($horseQuestStrength) and !setup.questCompleted($horseQuestStrength)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;doing strength&quot;&gt;&gt;

&lt;&lt;elseif setup.questStarted($horseQuestFreedom) and !setup.questCompleted($horseQuestFreedom)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;doing freedom&quot;&gt;&gt;

/*End setting stage quest*/
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;no quest&quot;&gt;&gt;
You walk up the creaky porch steps and knock on the front door, but there&#39;s no answer. You try the doorknob, but it&#39;s locked. 
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Return&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;start clothes&quot;&gt;&gt;
&lt;p&gt;Walking up the creaky porch steps, which have obviously been bent beneath a sizeable weight in the past, you spot that the front door is slightly ajar, and you can hear sounds of a meal going on inside. &lt;/p&gt;

&lt;p&gt;The door swings open at your push, and you step inside the farmhouse- basically one large room with a bed at one end, a kitchen range at the other, and a big dining table in between. &lt;/p&gt;

Seated at the table, on a bench that&#39;s bending beneath $npc1.his wrecking-ball weight, is the enormously fat $npc1.adjective ex-adventurer you met earlier. $npc1.He&#39;s hungrily eating a meal, though ‘stuffing $npc1.his face&#39; would be a more accurate description- the table is piled high with truly delicious-looking, succulent treats- many of which are apple-based- that $npc1.he&#39;s ploughing through unstoppably. In a confined space $npc1.he looks even more colossally chubby than $npc1.he did outdoors, but you decide that $npc1.he might just have got fatter since you last saw $npc1.him- that barn-sized backside of $npc1.his is practically spilling over the rear of the bench, while $npc1.his stupendous stomach presses across the table whenever $npc1.he leans forwards to grab another large mouthful. $npc1.He&#39;s obviously enjoying $npc1.his meal to the full, completely engrossed in the pleasures of the table. 
&lt;&lt;action &quot;w&quot; &quot;talk&quot; &quot;Talk to $npc1.Name&quot; &quot;Talk to Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Offer $npc1.Name apple&quot; &quot;Offer Sampson apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;food&quot; &quot;Offer $npc1.Name ample apple&quot; &quot;Offer Sampson ample apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Leave $npc1.Name&quot; &quot;Leave Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing clothes&quot;&gt;&gt;
Walking up the creaky porch steps, which have obviously been bent beneath a sizeable weight in the past, you spot that the front door is slightly ajar, and you can hear sounds of a meal going on inside. You enter the farmhouse to find $npc1.Name still at the dining table, still eating. It may be the same meal as when you last left, it could be that $npc1.he&#39;s started on a whole new one. Regardless, $npc1.he looks even bigger than when you were last here. As you watch $npc1.he grabs yet another hunk of food from the dwindling piles on the table and chomps down on it. 
&lt;&lt;action &quot;w&quot; &quot;talk&quot; &quot;Talk to $npc1.Name&quot; &quot;Talk to Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Offer $npc1.Name apple&quot; &quot;Offer Sampson apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;food&quot; &quot;Offer $npc1.Name ample apple&quot; &quot;Offer Sampson ample apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Leave $npc1.Name&quot; &quot;Leave Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing armor&quot;&gt;&gt;
Walking up the creaky porch steps, which have obviously been bent beneath a sizeable weight in the past, you spot that the front door is slightly ajar, and you can hear sounds of a meal going on inside. You enter the farmhouse to find $npc1.Name STILL at the dining table, and STILL eating. Stuffed into $npc1.his pants, if $npc1.he grows much bigger $npc1.his armour will need resizing before $npc1.he&#39;s even worn it. The bench is now bending heavily beneath $npc1.his bulging backside, $npc1.his $npc1.tail firmly squashed between $npc1.his cheeks. As you watch, oblivious to your presence the overblown $npc1.adjective continues $npc1.his stupendous intake of daily calories. 
&lt;&lt;action &quot;w&quot; &quot;talk&quot; &quot;Talk to $npc1.Name&quot; &quot;Talk to Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Offer $npc1.Name apple&quot; &quot;Offer Sampson apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;food&quot; &quot;Offer $npc1.Name ample apple&quot; &quot;Offer Sampson ample apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Leave $npc1.Name&quot; &quot;Leave Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing weapon&quot;&gt;&gt;
Walking up the creaky porch steps, which have obviously been bent beneath a sizeable weight in the past, you spot that the front door is slightly ajar, and you can hear sounds of a meal going on inside. You duck through the now familiar doorway and find... that $npc1.Name Shire is still eating. $npc1.His pants and armour already look a size or two too small for $npc1.him, and pretty soon you&#39;ll be surprised if $npc1.he can even fit through the DOOR, let alone take up adventuring again. The exceedingly obese $npc1.adjective doesn&#39;t notice your presence, too busy working $npc1.his way through the remaining food on the farmhouse table. As space is cleared of food, you notice that it very soon becomes re-filled with &lt;&lt;=$npc1.nspecies&gt;&gt;flesh. 
&lt;&lt;action &quot;w&quot; &quot;talk&quot; &quot;Talk to $npc1.Name&quot; &quot;Talk to Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Offer $npc1.Name apple&quot; &quot;Offer Sampson apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;food&quot; &quot;Offer $npc1.Name ample apple&quot; &quot;Offer Sampson ample apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Leave $npc1.Name&quot; &quot;Leave Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing strength&quot;&gt;&gt;
Walking up the creaky porch steps, which have obviously been bent beneath a sizeable weight in the past, you spot that the front door is slightly ajar, and you can hear sounds of a meal going on inside. You enter the farmhouse, and find that $npc1.Name Shire still hasn&#39;t managed to stand. Though, from the way $npc1.he&#39;s contentedly tucking into the remains of $npc1.his meal, you suspect that $npc1.he&#39;s been &#39;distracted&#39; for some little while. $npc1.He&#39;s certainly absorbed in eating, paying no attention to you as $npc1.he demolishes the last few snacks that have somehow survived $npc1.his siege up until now. 
&lt;&lt;action &quot;w&quot; &quot;talk&quot; &quot;Talk to $npc1.Name&quot; &quot;Talk to Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Offer $npc1.Name apple&quot; &quot;Offer Sampson apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;food&quot; &quot;Offer $npc1.Name ample apple&quot; &quot;Offer Sampson ample apple&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Leave $npc1.Name&quot; &quot;Leave Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing freedom&quot;&gt;&gt;
&lt;p&gt;As you approach the farmhouse, you can make out a large figure blocking the doorway. $npc1.Name Shire is hanging half-in, half-out of the door, wedged tight! $npc1.His great big belly is jiggling inches above the floor, and the struggling $npc1.species&#39;s efforts to free $npc1.himself have only succeeded in working up a sweat. &lt;/p&gt;

As you walk up the steps, the larger-than-life adventurer catches sight of you and $npc1.whinnies in greeting, trying not to blush. &quot;Oh, hey there, li&#39;l $p.buddy! I t-think some old enemy of mine must have put a CURSE on this door! Nghhh! It... It&#39;s SHRUNK on me! I&#39;m stuck!&quot; $npc1.He tries once again to HAUL $npc1.himself forward, the doorframe bulging forwards under the pressure but resolutely refusing to release $npc1.him. Defeated, $npc1.he sags slightly in the frame and holds out $npc1.his fat arms to you helplessly. &quot;Shucks, any chance of a PULL?&quot;  
&lt;&lt;action &quot;w&quot; &quot;quest&quot; &quot;Pull&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;pull Sampson&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Leave $npc1.name&quot; &quot;Leave Sampson&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="263" name="Finish eating contest" tags="nobr cutscene" position="975,3275" size="100,100">&lt;p&gt;The assistants come to take the dishes away, but leave no further courses. The announcer comes back out and shouts &quot;Wow, lets have a great round of applause for our remaining contestants!&quot; You look around and notice only 2 other contestants are still sitting at the table, their food stained bellies pushing hard into the table. Strewn about on the ground are several other grease-stained furs groaning and rolling around in pain and indigestion. Gold exchanges hands among the audience as bets on the winners and losers are resolved. &lt;/p&gt;

&lt;p&gt;&quot;I&#39;d like to thank everyone for coming out tonight, now let&#39;s clear out of hear before the farmer realizes we&#39;re trashing his barn.&quot; With that the audience and the contestants who can still walk leave from the back of the barn. The remaining overstuffed competitors are heaved out by their friends and eventually the barn is left like a whirlwind had passed through. &lt;/p&gt;

&lt;&lt;questReward $eatingContest&gt;&gt;
&lt;&lt;doXP 80&gt;&gt;
&lt;&lt;doGld 120&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Mission complete!&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="264" name="Leave Sampson" tags="nobr" position="1300,2875" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;Leave $npc1.Name&quot;&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;thinking about it&quot;&gt;&gt;
The enormous $npc1.adjective rumbles out a chuckle, making $npc1.his whole huge body quiver like pudding. &quot;Shucks, guess I can&#39;t say fairer than that. Heck, even I can&#39;t make up my mind! But...&quot; $npc1.He flicks the apple core over one bulky shoulder and reaches for a slab of apple cake, biting deeply into it. &quot;While I&#39;m deciding, it can&#39;t hurt to have a li&#39;l snack...&quot; Once the jumbo-sized $npc1.species resumes $npc1.his meal, you can&#39;t get much more than grunts out of $npc1.him and so you decide to leave $npc1.him to it.

&lt;&lt;case &quot;no pants&quot;&gt;&gt;
&quot;Hey, that&#39;sh no problem&quot; $npc1.he says cheerfully, sitting back further on the bench, which groans beneath $npc1.his blubbersome backside&#39;s. $npc1.His eyes are already straying back to $npc1.his meal, and $npc1.he swallows the last of $npc1.his apple. &quot;Ther&#39;sh... *gulp* No rush...&quot; Rather unsurprisingly, $npc1.he returns $npc1.his attention to the tableful of food, and, not being able to get further conversation out of $npc1.him, you head outside. 

&lt;&lt;case &quot;no armor&quot;&gt;&gt;
$npc1.Name&#39;s fat face creases roundly as $npc1.he smiles down at you. &quot;Aww, shucks. Well that&#39;s ok.&quot; A fat $npc1.hand reaches for another tasty treat, and $npc1.he bites into it, cheeks bulging. &quot;It&#39;s not like I&#39;m going anywhere...&quot;

&lt;&lt;case &quot;no weapon&quot;&gt;&gt;
The humongous $npc1.species&#39;s full features fall slightly. &quot;Aww, shucks. Well, I guess that&#39;s ok,&quot; $npc1.he glances at the piles of food still left on the table, having to crane $npc1.his neck to see past $npc1.his colossal chest and stomach. &quot;I guess I can wait around until after my NEXT meal before setting out...&quot;

&lt;&lt;case &quot;no gem&quot;&gt;&gt;
&quot;Aww, well hey, that&#39;s no problem,&quot; $npc1.Name $npc1.whickers confidently, wiping $npc1.his lips clean &quot;Hrmphhh... Now that I&#39;m nearly full, I feel stronger than ever! In fact, I think... maybe THIS time... //NGHHH//!&quot; $npc1.His entire frame wobbles with exertion as $npc1.he strains to rise to $npc1.his $npc1.feet, but $npc1.he finally sinks back again, red in the face and puffing, without $npc1.his backside having risen a single inch this time. &quot;Puff... puff... shucks, I think we ARE gonna need that Spectrum Gem after all...&quot;

&lt;&lt;case &quot;no freedom&quot;&gt;&gt;
There is absolutely no chance of squeezing past $npc1.Name through the door. You might have been well and truly stuck, but fortunately you find a large window on the far side of the farmhouse. Unbolting the shutters, you 

&lt;&lt;if setup.weight() &lt; 250&gt;&gt;slip out 
&lt;&lt;elseif setup.weight() &lt; 600&gt;&gt;wriggle out 
&lt;&lt;else&gt;&gt;squeeze 
&lt;&lt;/if&gt;&gt;
through it and find yourself standing in the farmyard. 

&lt;&lt;case &quot;doing freedom&quot;&gt;&gt;
&lt;p&gt;With an apology, you head off with the promise &#39;to go get help&#39;. You leave the gargantuanly chubby $npc1.species stuck in the doorway. &lt;/p&gt;

&quot;Hey, y-you can&#39;t just leave me like this!&quot; $npc1.he calls out after you. &quot;At least leave me a SNACK or something!&quot;

&lt;&lt;default&gt;&gt;
With no sign of $npc1.his stopping soon, you quietly tiptoe back out, leaving the enormous $npc1.adjective to $npc1.his apparently endless meal. 

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="265" name="Leave the dairy farmer" tags="" position="1300,2375" size="100,100">&quot;I&#39;ll see you around!&quot; $npc2.he says as $npc2.he waves goodbye. As you turn to leave $npc2.he reaches below the counter and picks up another bottle of milk and starts chugging it down. 

&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="266" name="Milk Stand" tags="nobr" position="1175,2375" size="100,100">&lt;&lt;if $hour &gt;= 9 and $hour &lt;= 17&gt;&gt;
	&lt;p&gt;You walk up to the stand to find a tall anthro $npc2.species tending the stand. $npc2.He&#39;s wearing worn blue coveralls over $npc2.his sizeable gut while foregoing any kind of shirt, exposing his beefy $npc2.color-furred arms. $npc2.His large curved horns look like they&#39;d make it hard for $npc2.him to stand in there. As you walk up $npc2.he quickly slams down the bottle of milk $npc2.he was chugging down and greets you as $npc2.he wipes the milk moustache off $npc2.his face. &lt;/p&gt;

	&lt;p&gt;&quot;Hello there! What can I do ya&#39; for?&quot; $npc2.he says with a wide smile on $npc2.his face. Hanging beside $npc2.him is a sign that says: &lt;/p&gt;

	&lt;blockquote&gt;Milk Bottle - 1 gold&lt;br&gt;
	Milk jug - 5 gold&lt;/blockquote&gt;
	&lt;&lt;store&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;include &quot;dairy quest links&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
	You walk up to the stand but find it bare. There&#39;s a sign hanging up with a little painting of a $npc2.color $npc2.species saying, 
	&lt;blockquote&gt;&quot;Be back at 9 AM&quot;. &lt;/blockquote&gt;
	&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="267" name="Milking Shed" tags="nobr" position="1175,2550" size="100,100">&lt;&lt;set _milkStarted = setup.questStarted($madMilk)&gt;&gt;
&lt;&lt;set _milkReady = setup.questReady($madMilk)&gt;&gt;
&lt;&lt;set _milkComplete = setup.questCompleted($madMilk)&gt;&gt;

&lt;&lt;set _cheeseStarted = setup.questStarted($madCheese)&gt;&gt;
&lt;&lt;set _cheeseReady = setup.questReady($madCheese)&gt;&gt;
&lt;&lt;set _cheeseComplete = setup.questCompleted($madCheese)&gt;&gt;

/*If you haven&#39;t started either quest*/
&lt;&lt;if !_milkStarted and !_cheeseStarted&gt;&gt;
You walk up to the milking shed. A large water wheel behind the shed rotates as it&#39;s partially submerged in the river that curves around the farm. You pull on the door, but it&#39;s locked shut. You can hear the quiet rhytmic sound of machinery from within. 
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If milk quest is ready, but you haven&#39;t started the cheese one*/
&lt;&lt;elseif _milkReady and !_cheeseStarted&gt;&gt;
&lt;p&gt;You walk up to the milking shed. A large water wheel behind the shed rotates as it&#39;s partially submerged in the river that curves around the farm. You pull on the door, but it&#39;s locked shut. You can hear the quiet rhythmic sound of machinery from within. &lt;/p&gt;

Nailed to one of the doors is a large, freshly-painted notice which simply reads: &#39;&#39;&quot;BEWARE OF THE CHEESE&quot;&#39;&#39;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you&#39;ve started but not finished cheese quest*/
&lt;&lt;elseif _cheeseStarted and !_cheeseReady&gt;&gt;
&lt;p&gt;You walk up to the milking shed. A large water wheel behind the shed rotates as it&#39;s partially submerged in the river that curves around the farm. At the door you meet the obese $npc2.species, who produces a large key from the pocket of $npc2.his overalls. As the key rattles in the lock, over the sounds of machinery you hear a sudden thudding, as though something inside had been disturbed by the noise and was moving about. Then you hear a strange noise from inside- something like a cross between a wolf-howl and a buffalo bellow, only somehow... //cheesier//. &lt;/p&gt;

&lt;p&gt;The $npc2.species shudders, then puts $npc2.his hands to $npc2.his horns and shakes $npc2.his head. &quot;I knew it was a mistake to experiment with predator milks. I should never have mixed curds like that.&quot; $npc2.He raises $npc2.his hands to the sky, appealing to it. &quot;What has lactology &#39;&#39;DONE&#39;&#39;?&quot; &lt;/p&gt;

$npc2.He hurriedly finishes turning the key in the stout lock, and slides back the bolts securing the door. $npc2.He catches your eye, looking rather nervous. &quot;Oh, hey, look, there&#39;s uhh.. a customer over by the milk stand. I&#39;d better go see what they want, you can take this from here, right?&quot; Without waiting for a reply $npc2.he retreats into the distance, beefy backside bouncing with unaccustomed haste, leaving you to deal with a very different kind of &#39;customer&#39;. 
&lt;&lt;action &quot;c&quot; &quot;building&quot; &quot;Enter the milking shed&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If both are done*/
&lt;&lt;else&gt;&gt;
You walk up to the milking shed. A large water wheel behind the shed rotates as it&#39;s partially submerged in the river that curves around the farm. You pull on the door, but it&#39;s locked shut. You can hear the quiet rhytmic sound of machinery from within. 
&lt;&lt;action &quot;e&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="268" name="Offer Sampson ample apple" tags="" position="1600,3000" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;Offer $npc1.Name $ampleApple.article $ampleApple.name&quot;&gt;&gt;

&lt;&lt;if setup.numOwned($ampleApple) &lt; 10&gt;&gt;
You rummage frantically, but you find that you&#39;re just clean out of ample apples. &lt;&lt;if setup.numOwned($ampleApple) &gt; 0&gt;&gt;At least out of whole ones. &lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you do have an apple*/
&lt;&lt;else&gt;&gt;
&lt;&lt;removeItem $ampleApple 10&gt;&gt;

/*Selects dialogue based on quest*/
&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;start clothes&quot;&gt;&gt;
&lt;p&gt;You pull out an Ample Apple and wave it within the $npc1.species&#39;s orbit. Still chewing $npc1.his last mouthful, like magic $npc1.his eyes lock onto it from behind $npc1.his bulging cheeks, and for the first time $npc1.his fat face swivels towards you, second chin wobbling. $npc1.He gulps down the food in $npc1.his mouth, and a light seems to go on in $npc1.his eyes as $npc1.he recognises you. &lt;/p&gt;

&lt;p&gt;&quot;Oh, hi there, li&#39;l $p.buddy. Wow, is that for me? Thanks!&quot; $npc1.He takes the oversized apple in one oversized, bloated mitt and sinks $npc1.his tombstone teeth into it as greedily as if $npc1.he hadn&#39;t eaten in hours. &quot;Mshh... It&#39;s right near impossible to find a decent-sized apple these days. Seems like the ones &#39;round here get smaller every year!&quot; Looking at $npc1.his gigantic frame, you can&#39;t help but wonder how much bigger &#39;&#39;$npc1.he&#39;s&#39;&#39; been getting every year. The magically-enlarged apple looks downright normal in $npc1.his $npc1.hands. &quot;Visiting the farm?&quot; $npc1.He gulps down a chunk of apple. &quot;Aww, shucks, I&#39;d have thought you&#39;d be far too busy adventuring to pay an old gone-to-seed horse like me a call like this. Ain&#39;t much to do around here except eat–but that suits ME just fine! Still, it&#39;s sure swell to see you!&quot;&lt;/p&gt;

&lt;p&gt;$npc1.He takes another huge bite out of the huge apple, clearly enjoying the rare treat, but as $npc1.he chews, $npc1.he begins to frown a little, one fat $npc1.hand reaching to press into the huge lower hemisphere of $npc1.his belly.&lt;/p&gt;

&lt;p&gt;&quot;Of course,&quot; $npc1.he gulps down $npc1.his mouthful, &quot;I guess there IS such a thing as overdoing it–maybe I AM getting kind of plump.&quot; KIND OF? $npc1.He continues chomping away at the apple. &quot;Now in the old days, boy, I was the best-built adventurer there was! Throw that giant boulder into the ocean from West Beach? I got that sucker clean across to Jurassic Isle!&quot; A deep BELCH catches $npc1.him by surprise, rattling the crockery, and $npc1.he chuckles a little, jiggling $npc1.his huge doughball of a belly. &quot;Guess I&#39;m turning into something of a boulder myself...&quot;&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;What should $npc1.name do?&quot; &quot;What should Sampson do&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;doing clothes&quot;&gt;&gt;
&lt;p&gt;You find an ample apple on your person and wave it to attract $npc1.Name&#39;s attention. Still eating, $npc1.his fat $npc1.hand whips out and catches hold of the massive apple before $npc1.he&#39;s even looked up. $npc1.He blinks when $npc1.he recognises you and swallows $npc1.his mouthful with a loud gulp. &quot;Hrrmphhh... Sorry about that li&#39;l $p.buddy, just... umm... practicing my reflexes, and... uhh...&quot; $npc1.he glances guiltily at the diminished piles of food on the table, &quot;...keeping my strength up.&quot; If $npc1.he gets much &#39;stronger&#39; that bench will collapse underneath $npc1.him. $npc1.His face breaks into a broad smile as $npc1.he notices the size of the apple. $npc1.He opens $npc1.his mouth wide, showing off $npc1.his huge, razor-sharp teeth and takes a tremendous bite out of the apple with a loud CRUNCH. $npc1.He chews blissfully, relishing what is probably the first proper apple bite $npc1.he&#39;s had in quite a while. &quot;So,&quot; $npc1.he mumbles through $npc1.his mouthful of apple, &quot;Did you... mmsh... did you managshe to get my old pantsh fixshed up yet?&quot;&lt;/p&gt;

&lt;&lt;if setup.hasItem($horsePantsFixed) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give pants&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no pants&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;doing armor&quot;&gt;&gt;
&lt;p&gt;You find an Ample Apple on your person and hold it out towards the $npc1.species just as $npc1.he munches into a pie larger than $npc1.his head, eyes shut in bliss. In the same motion, $npc1.his head swings around, eyes still closed, and CHOMPS into the apple as well, taking a huge bite out of it and narrowly missing your fingers. Only THEN does $npc1.he open $npc1.his eyes to see you wiggling your fingertips to make sure they&#39;re still there, just millimeters away from the missing chunk.&lt;/p&gt;

&lt;p&gt;&quot;Whoops, ehe... shorry li&#39;l $p.buddy, guesh I jusht don&#39;tsh know my own shtrengsh shesh daysh...&quot; $npc1.He starts grinning from ear to ear as $npc1.he surveys the giant apple, and without further delay, $npc1.he eagerly grabs it from you and starts taking giant-sized bites out of it. &quot;&#39;Course, you must be pretty strong yourself to be picking apples like this! I&#39;ve gotta get me some of these when I go out adventuring again!&quot; $npc1.He pauses to swallow with a loud gulp and pats $npc1.his enormous, soft stomach, which is now covering even more of the table&#39;s surface. &quot;Hrrrmphhh... Anyway, did you manage to get my armour fixed up?&quot;&lt;/p&gt;

&lt;&lt;if setup.hasItem($horseArmorFixed) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give armor&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no armor&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;doing weapon&quot;&gt;&gt;
&lt;p&gt;You produce an ample apple that you had handy and wave it at $npc1.Name, but $npc1.he&#39;s too busy eating to notice. So instead you hold the oversized apple up to your mouth and take a comparatively tiny bite out of it. The SCRUNCH cuts through the air like a knife, and immediately $npc1.Name&#39;s ears stiffen. $npc1.His fat arm whips out to grab the apple and $npc1.he spins around (well, turns a little, at any rate), a thunderous look on $npc1.his fat face.&lt;/p&gt;

&lt;p&gt;&quot;HEY, that&#39;s MI–! Oh...&quot; $npc1.He sees who it is and stops, blushing slightly. &quot;Shucks, sorry about that, li&#39;l $p.buddy, but for a second I thought some varmint was trying to STEAL some of MY food...&quot; $npc1.He keeps hold of your apple, though, as $npc1.he eyes it contemplatively and then scrunches into it. $npc1.He $npc1.whinnies contentedly as juice runs down $npc1.his chin. &quot;&#39;Course, I could only dream of getting my $npc1.hands on apples like this &#39;round here...&quot; $npc1.He sighs longingly at the thought. &quot;Guess that&#39;s just another reason to go out adventuring again, eh?&quot; You&#39;re not sure how much more adventuring $npc1.he&#39;ll be doing if $npc1.he keeps eating like this. &quot;Hrrrmphh... So did you manage to find me a weapon, then? If I don&#39;t get to adventuring soon, I won&#39;t be back in time for dinner.&quot;&lt;/p&gt;

&lt;&lt;if setup.hasItem($axe) &gt;= 0 or setup.hasItem($giantAxe) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give weapon&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no weapon&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;doing strength&quot;&gt;&gt;
&lt;p&gt;You&#39;re tempted to just bounce the Ample Apple off $npc1.Name&#39;s stupendous stomach, but instead you proffer it, holding it out rather gingerly for $npc1.him to see from the corner of $npc1.his eye. Even with $npc1.his cheeks jammed full of food, $npc1.his fat face still swings towards it hungrily. $npc1.His eyes light up, and without even questioning where the titanic fruit came from, $npc1.he begins taking tremendous bites out of it. Only after $npc1.he&#39;s devoured a considerable portion of the apple does $npc1.he notice your head peeking out from behind its remains. &lt;/p&gt;

&lt;p&gt;&quot;Well hi there, li&#39;l $p.buddy! Did you find that just for me? Thanks! You wouldn&#39;t believe how hard it is to find a proper-sized apple &#39;round these parts!&quot; You politely refrain from questioning how &quot;proper&quot; $npc1.his own size is. &quot;Good thinking–s&#39;HEALTHY, right?&quot; $npc1.he says around a bulging mouthful. Much &quot;healthier&quot; and $npc1.Name&#39;s going to pop. $npc1.He swallows and says, &quot;So did you manage to get a Spectrum Gem yet?&quot;&lt;/p&gt;

&lt;&lt;if setup.hasItem($spectrumGem) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give gem&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;no gem&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="269" name="Offer Sampson apple" tags="nobr" position="1475,3000" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;Offer $npc1.Name $apple.article $apple.name&quot;&gt;&gt;

&lt;&lt;if setup.hasItem($apple) &lt; 0&gt;&gt;
You rummage frantically, but you find that you&#39;re just clean out of apples. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you do have an apple*/
&lt;&lt;else&gt;&gt;
&lt;&lt;removeItem $apple&gt;&gt;

/*Selects dialogue based on quest*/
&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;start clothes&quot;&gt;&gt;
&lt;p&gt;You pull out an apple, &lt;&lt;if $top.name != $shirtless.name&gt;&gt;
buff it rather self-consciously on your $top.name, &lt;&lt;/if&gt;&gt;and wave it within the $npc1.species&#39;s orbit. Still chewing $npc1.his last mouthful, like magic $npc1.his eyes lock onto it from behind $npc1.his bulging cheeks, and for the first time $npc1.his fat face swivels towards you, second chin wobbling. $npc1.He gulps down the food in $npc1.his mouth and a light seems to go on in $npc1.his eyes as $npc1.he recognises you. &lt;/p&gt;

&lt;p&gt;&quot;Oh, hi there, li&#39;l $p.buddy. Thanks!&quot; $npc1.He takes the apple in one bloated mitt and sinks $npc1.his tombstone teeth into it as greedily as if $npc1.he hadn&#39;t eaten in hours. &quot;Mshh... Visiting the farm?&quot; $npc1.He gulps down a chunk of apple, &quot;Aww, shucks, I&#39;d have thought you&#39;d be far too busy adventuring to pay an old gone-to-seed $npc1.species like me a call like this. Ain&#39;t much to do around here except eat- but that suits ME just fine! Still, it&#39;s sure swell to see you!&quot;
&lt;/p&gt;

&lt;p&gt;$npc1.He takes another bite from the apple, practically halving it, but as $npc1.he chews $npc1.he frowns a little, one fat $npc1.hand reaching to press into the huge lower hemisphere of $npc1.his belly. &lt;/p&gt;

&lt;p&gt;&quot;Of course,&quot; $npc1.he gulps down $npc1.his mouthful, &quot;I guess there IS such a thing as overdoing it- maybe I AM getting kind of plump.&quot; //KIND OF?// $npc1.He takes a last bite out of the apple. &quot;Now in the Old Days, boy, I was the best-built adventurer there was! Throw that giant boulder into the ocean from West Beach? I got that sucker clean across to Jurassic Isle!&quot; a deep &#39;&#39;BELCH&#39;&#39; catches $npc1.him by surprise, rattling the crockery, and $npc1.he chuckles a little, jiggling $npc1.his huge doughball of a belly. &quot;Guess I&#39;m turning into something of a boulder myself...&quot; &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;What should $npc1.Name do?&quot; &quot;What should Sampson do&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing clothes&quot;&gt;&gt;
You find an apple on your person and wave it to attract $npc1.Name&#39;s attention. Still eating, $npc1.his fat hand whips out and catches hold of the apple before $npc1.he&#39;s even looked up. $npc1.He blinks when $npc1.he recognises you, and swallows $npc1.his mouthful with a loud gulp. &quot;Hrrmphhh... Sorry about that li&#39;l $p.buddy, just... umm... practicing my reflexes, and... uhh...&quot; $npc1.he glances guiltily at the diminished piles of food on the table, &quot;...keeping my strength up.&quot; If $npc1.he gets much ‘stronger&#39; that bench will collapse underneath $npc1.him. &quot;So,&quot; $npc1.he smiles broadly, chomping into the apple with a loud CRUNCH. &quot;Did you... mmsh... did you managshe to get my old pantsh fixshed up yet?&quot; 

&lt;&lt;if setup.hasItem($horsePantsFixed) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give pants&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no pants&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing armor&quot;&gt;&gt;
&lt;p&gt;You find an apple on your person and hold it out towards the $npc1.species just as $npc1.he munches into a pie larger than $npc1.his head, eyes shut in bliss. &quot;In the same motion $npc1.his head swings around, eyes still closed, and CHOMPS into the apple as well, neatly slicing it in half with $npc1.his huge teeth. Only THEN does $npc1.he open $npc1.his eyes, to see you staring at the halved apple in your fingertips. &lt;/p&gt;

&quot;Whoops, ehe... shorry li&#39;l $p.buddy, guesh I jusht don&#39;tsh know my own shtrengsh shesh daysh....&quot; $npc1.he swallows $npc1.his mouthful with a loud gulp and pats $npc1.his enormous, soft stomach, now covering even more of the table&#39;s surface. &quot;Hrrrmphhh... Anyway, did you manage to get my armour fixed up?&quot;

&lt;&lt;if setup.hasItem($horseArmorFixed) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give armor&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no armor&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing weapon&quot;&gt;&gt;
&lt;p&gt;You produce an apple that you had handy and wave it at $npc1.Name, but $npc1.he&#39;s too busy eating to notice. So instead you hold the apple up to your mouth and bite into it. The SCRUNCH cuts through the air like a knife and immediately $npc1.Name&#39;s ears stiffen. $npc1.His fat arm whips out to grab the apple and $npc1.he spins around (well, turns a little, at any rate), a thunderous look on $npc1.his fat face. &lt;/p&gt;

&quot;HEY, that&#39;s MI-! Oh...&quot; $npc1.He sees who it is and stops, blushing slightly. &quot;Shucks, sorry about that, li&#39;l $p.buddy, but for a second I thought some varmint was trying to STEAL some of MY food...&quot; $npc1.He absent-mindedly keeps hold of your apple, though, then scrunches into it, juice running down $npc1.his chin as $npc1.he $npc1.whinnies contentedly. &quot;Hrrrmphh.... So did you manage to find me a weapon, then? Only if I don&#39;t get to adventuring soon, I won&#39;t be back in time for dinner.&quot; 

&lt;&lt;if setup.hasItem($axe) &gt;= 0 or setup.hasItem($giantAxe) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give weapon&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;no weapon&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;doing strength&quot;&gt;&gt;
You&#39;re tempted to just bounce the apple off $npc1.Name&#39;s stupendous stomach, but instead you proffer it, holding it out rather gingerly for $npc1.him to see from the corner of $npc1.his eye. Even with $npc1.his cheeks jammed full of food, $npc1.his fat face still swings towards it hungrily. A light comes on behind $npc1.his eyes and $npc1.he focusses beyond the apple and onto you. &quot;Well hi there, li&#39;l $p.buddy! That for me? Thanks!&quot; $npc1.He&#39;s taken it and bitten into it before you can even respond. &quot;Good thinking- s&#39;HEALTHY, right?&quot; $npc1.he says around $npc1.his bulging mouthful. Much &#39;healthier&#39; and $npc1.Name&#39;s going to pop. $npc1.He swallows and says, &quot;So did you manage to get a Spectrum Gem yet?&quot; 

&lt;&lt;if setup.hasItem($spectrumGem) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Complete $npc1.Name&#39;s quest&quot; &quot;Complete Sampson&#39;s quest&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;give gem&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Not yet.&quot; &quot;Leave Sampson&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;no gem&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="270" name="Pasture" tags="" position="1550,2425" size="100,100">&lt;p&gt;You walk up to the pasture and lean on the wooden fence. Spread out in front of you is a large field several acres in size. On the distant edge of the pasture you can just barely see the $sunlight glinting off a large river. &lt;/p&gt;

&lt;p&gt;Standing out in the field there are several of perhaps the fattest &lt;&lt;=$cattle.fname&gt;&gt;s known in recorded history. Each of them looking like large furred barrels, their fat guts sagging almost to the ground and expanding outward making them look almost spherical. They&#39;re all sporting large udders swollen with gallons of milk that sloshes back and forth with every small step they take. &lt;/p&gt;

They&#39;re all very diligently searching out and devouring what little grass remains in the well grazed fields. If the grass in the pasture has been growing at the same rate the grass in the rest of the grasslands have been then it&#39;s pretty easy to see how the cattle are managing to stay so preposterously well fed.

&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Head Back&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="271" name="Quests for the dairy farm" tags="nobr" position="1175,2250" size="100,100">&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case &quot;get herd quest&quot;&gt;&gt;

&quot;Well, now that you ask, I have been having problems with the local wildlife indulging themselves upon my livelihood. Every morning I come out here and there&#39;s some fatass $lion.species or $cheetah.species stranded with a bellyful of one of my poor defenseless &lt;&lt;=$cattle.fname&gt;&gt;s. So far I&#39;ve just been rolling off into the river where they can float down stream and become somebody else&#39;s problem, but I sure would appreciate it if you go out and rough a few of them up for me and try to scare them offa&#39; my land. I&#39;ll pay you some gold if you do!&quot; 
&lt;&lt;getQuest $defendingTheHerd&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll see what I can do.&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;working on herd quest&quot;&gt;&gt;
&quot;I&#39;d really appreciate it if you could take care of some of those darn predators out in the grasslands.&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll see what I can do.&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;turn in herd quest&quot;&gt;&gt;
&quot;Did you finally show those dang predators what for? Thank you so much! I&#39;d take care of them myself, but I&#39;ve been so busy keeping up with my gals&#39; milked as is that I don&#39;t have time any more. I doubt they&#39;ll stay away for long, but hopefully it&#39;ll push them back a bit. Thank you!&quot;
&lt;&lt;questReward $defendingTheHerd&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;get milk machine quest&quot;&gt;&gt;
&lt;p&gt;&quot;Since you&#39;ve been such a good help roughing up the wildlife so far, I was wondering if you could help me with a slightly more dangerous target.&quot; $npc2.He looks around furtively, making sure nobody&#39;s around to hear, before $npc2.he leans in and speaks to you in hushed voice. &quot;Between you and me I&#39;ve been having some... //mechanical problems//. Namely, I had this large steam powered milking machine built to help me deal with my increased work load. Unfortunately one day it just sort of went berserk, busted out of the milk shed, and has kind of been roaming the hills ever since. Every night it comes back and milks my girls dry before rollin&#39; out to the hills to pump random passersby full of milk just to repeat the process over and over again. It seems almost... //maniacally// driven to milk my &lt;&lt;=$cattle.fname&gt;&gt;s as much as possible. And to make room for more it &#39;stores&#39; extra milk into whatever else it can get its claws on.&quot; $npc2.He looks around again to make sure nobody&#39;s snooping around. 
&lt;/p&gt;

&quot;Obviously this puts me in a bit of a pickle as it&#39;s sorta my fault the mad machine is out there terrorizing our fair citizens, which is obviously bad for business. Not to mention it&#39;s basically robbing me of my livelihood and redistributin&#39; it for free! Anyways, I&#39;d be glad if you could sorta&#39;... disable it and come back to tell me about it. I can haul it back here myself.&quot; 
&lt;&lt;getQuest $madMilk&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll see what I can do.&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;working on milk machine quest&quot;&gt;&gt;
&quot;I&#39;d really appreciate if you could take care of that crazed milk machine, before anybody else gets hurt.&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll see what I can do.&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;turn in milk machine quest&quot;&gt;&gt;
&quot;Did you finally disable that machine? &#39;&#39;Terrific!&#39;&#39; I knew I probably shouldn&#39;t have rerouted its milk storage into its steam engine. The //&#39;Perpetually milk powered steam engine&#39;// certainly seemed like a good idea at the time! I won&#39;t soon be making that mistake again... although I still think I could make it work... hmmmmmm... //yess//... heh... heh heh... ha ha ha!&quot; $npc2.He seems lost in devious thought for several moments. &quot;Er, oh, oops! Sorry, anyway, here&#39;s your reward. Thank you so much for your help!&quot; 
&lt;&lt;questReward $madMilk&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you?&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
												
&lt;&lt;case &quot;get cheese quest&quot;&gt;&gt;
&lt;p&gt;&quot;Oh, uhhhhh. I&#39;ve basically got everythin&#39; under control.&quot; $npc2.he says nervously as $npc2.he gives a sidelong glance towards the milking shed. There&#39;s a freshly painted sign tacked accross the door saying &#39;&#39;&quot;BEWARE OF CHEESE&quot;&#39;&#39;. &lt;/p&gt;

&quot;Uhh, oh, it&#39;s nothing. Nothing big. Ok, quite big. I&#39;m just having a little trouble with this one particular cheese.&quot; Catching your sceptical look $npc2.he adds, &quot;No, //seriously//, that thing is dangerous. I can&#39;t even go in there any more!&quot; Curiouser and curiouser. The bulging $npc2.adjective scratches $npc2.his head, plainly embarrassed. &quot;Say, you&#39;re an adventurer, right? Used to dealing with tough situations? Uhh... I&#39;d greatly appreciate it if you could help me out.&quot; $npc2.He gives you a look that is plainly desperate. &quot;I&#39;d pay you plenty!&quot; 
&lt;&lt;getQuest $madCheese&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll see what I can do.&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;working on cheese quest&quot;&gt;&gt;
&quot;So uhh, any time you feel ready to deal with our little problem,&quot; $npc2.he looks towards the milk shed which takes that opportunity to emit a rumbling bellow, &quot;I&#39;d greatly appreciate it.&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll see what I can do.&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;turn in cheese quest&quot;&gt;&gt;
&quot;You &#39;&#39;DID&#39;&#39; it?&quot; The $npc2.species looks at you incredulously, then hurriedly corrects $npc2.himself. &quot;I mean... you &#39;&#39;//DID//&#39;&#39; it! Wow.&quot; $npc2.He beams at you and wipes $npc2.his brow. &quot;Thanks for that, $p.brother. I owe you one! I thought I was never going to get my milking shed back,&quot; $npc2.he chortles, hands on $npc2.his bulging stomach. &quot;Well, I’ve learned my lesson //this// time! No more cheese-making for me! Instead, I’m gonna branch out into yoghurt and ice cream. Although... I’ve got to ask...&quot; $npc2.His expression becomes a little vacant, and $npc2.he asks you wistfully, &quot;What did it TASTE like?&quot;
&lt;&lt;questReward $madCheese&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Just take the money&quot; &quot;Milk Stand&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
																
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="272" name="Quit eating contest" tags="nobr" position="1100,2900" size="100,100">/*Quit before it starts*/
&lt;&lt;if $eventCounterA == 0&gt;&gt;
Realising that you&#39;re probably not up to eating in the upcoming round, you quietly stand up to leave your place. Having completed 0 rounds, you earn 0 gold for getting that far! You could have at least tried. 


/*Round 1*/
&lt;&lt;elseif $eventCounterA &lt; 30&gt;&gt;

/*If you quit at the end of a round*/
&lt;&lt;if $eventCounterB == 0&gt;&gt;
Realising that you&#39;re probably not up to eating in the upcoming round, you quietly stand up to leave your place. Having completed 1 round, you earn 20 gold for getting that far. At least you tried. 
&lt;&lt;questReward $eatingContest&gt;&gt;
&lt;&lt;doXP 10&gt;&gt;
&lt;&lt;doGld 20&gt;&gt;


/*If you quit mid round*/
&lt;&lt;else&gt;&gt;
You decide enough is enough, you are too full and feel that a humble defeat is better than an embarrassing loss. You push your plate away, bowing out from the contest. Because you didn&#39;t complete the whole round, you&#39;ve been disqualified. While the loss seems to disappoint you, you feel slightly better that you can still walk away rather than having to be carted off to the hospital. 
&lt;&lt;questReward $eatingContest&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*Round 2*/
&lt;&lt;elseif $eventCounterA &lt; 40&gt;&gt;

/*If you quit at the end of a round*/
&lt;&lt;if $eventCounterB == 0&gt;&gt;
Realising that you&#39;re probably not up to eating in the upcoming round, you quietly stand up to leave your place. Having completed 2 rounds, you earn 40 gold for getting that far. Pretty good for a new guy. 
&lt;&lt;questReward $eatingContest&gt;&gt;
&lt;&lt;doXP 20&gt;&gt;
&lt;&lt;doGld 40&gt;&gt;

/*If you quit mid round*/
&lt;&lt;else&gt;&gt;
You decide enough is enough, you are too full and feel that a humble defeat is better than an embarrassing loss. You push your plate away, bowing out from the contest. Because you didn&#39;t complete the whole round, you&#39;ve been disqualified. While the loss seems to disappoint you, you feel slightly better that you can still walk away rather than having to be carted off to the hospital. 
&lt;&lt;questReward $eatingContest&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*Round 3*/
&lt;&lt;else&gt;&gt;

/*You can only quit mid-round, because at the end, you win*/
You decide enough is enough, you are too full and feel that a humble defeat is better than an embarrassing loss. You push your plate away, bowing out from the contest. Because you didn&#39;t complete the whole round, you&#39;ve been disqualified. While the loss seems to disappoint you, you feel slightly better that you can still walk away rather than having to be carted off to the hospital. 
&lt;&lt;questReward $eatingContest&gt;&gt;


&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="273" name="Talk to Sampson" tags="" position="1425,2750" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;Talk to $npc1.Name&quot;&gt;&gt;

You try to attract the big $npc1.fella&#39;s attention, but the sumo-sized $npc1.species is too engrossed in $npc1.his meal to even notice your presence. As you watch $npc1.he picks up $npc1.his next chubby handful of food and stuffs it between $npc1.his plump lips. 
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Leave&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="274" name="Uncommon Taste Reward" tags="nobr" position="1550,2550" size="100,100">&lt;&lt;set _tempQuest = $quests[setup.questIndex($uncommonTaste)]&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;
&lt;&lt;case 1&gt;&gt;&lt;&lt;set _tempQuest.item = $warhammer&gt;&gt;
&lt;&lt;case 2&gt;&gt;&lt;&lt;set _tempQuest.item = $splintArmor&gt;&gt;
&lt;&lt;case 3&gt;&gt;&lt;&lt;set _tempQuest.item = $spectrumGem&gt;&gt;
&lt;&lt;case 4&gt;&gt;&lt;&lt;set _tempQuest.item = $bookOfCrystals&gt;&gt;
&lt;&lt;case 5&gt;&gt;&lt;&lt;set _tempQuest.item = $lightLance&gt;&gt;
&lt;&lt;case 6&gt;&gt;&lt;&lt;set _tempQuest.item = $boxOfDonuts&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;p&gt;&quot;You want that? Sure thing!&quot; Your enormously fat friend chuckles, bulk quivering as $npc1.he hands the _tempQuest.item.name over. &quot;There’s a funny story that comes with that, it was when I-&quot; perhaps mercifully, $npc1.his story is interrupted by a deafening, subterranean growl from $npc1.his belly. $npc1.He winces slightly, and looks at the sky. &quot;Oof! Sorry about that, but I guess it’s time for some chow- all this jawing has really worked up an appetite! Best of luck, and make sure to look me up another time if you ever want to hear the rest of the story.&quot; &lt;/p&gt;

And with that the huge beast slowly hauls $npc1.himself to $npc1.his $npc1.feet, and with a wave $npc1.he lumbers slowly towards the farmhouse, barnlike backside swaying in $npc1.his wake. 

&lt;&lt;questReward $uncommonTaste&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;fenceGate&quot; &quot;Dairy Farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="275" name="Wait for eating contest to start" tags="nobr cutscene" position="975,2875" size="100,100">&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 3&gt;&gt;

&lt;p&gt;While waiting, you look at those on either side of you. To your right, is a large $npc2.species and to your left, an even larger $npc3.species. Both have stern looks on their faces, they&#39;re very serious. You start to wonder if it was such a good idea to enter on behalf of what could be someone more experienced than you. Your doubts are pushed aside when the announcer speaks up. &lt;/p&gt;

&lt;p&gt;&quot;Welcome all ladies and gentlefurs. Today is a big day for us all and a bigger day for the contestants. Each round is larger than the one before, who will be the victor?!&quot; As he finishes, he turns his ear to the spectators as if he&#39;s unable to hear them. They shout their approval with yelling, various calls to the contestants and applause. The announcer laughs, returning to his loud voice, &quot;It seems there&#39;s discordance between the spectators, so let&#39;s get this contest running!&quot; &lt;/p&gt;

The announcer quickly rattles off all of the rules. First is that no extra food may be brought except for milk and water to help wash down the food. The second rule is to eat all the food per round. Those who pass out will be brought to the hospital for medical treatment and disqualified. Those who quit part way through the round are also disqualified. In general your goal is to eat through each round completely using only milk or water in case you need a bit of refreshment. With that, you feel you&#39;re ready to compete... unless you wish to give up now. 

&lt;&lt;set $eventCounterB = 3&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat!&quot; &quot;Eating contest Round 1&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 1&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Quit eating contest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="276" name="What should Sampson do" tags="" position="1350,3000" size="100,100">/* FIXES AND EDITS - Modify title for gender/species change reasons */
&lt;&lt;setPassageTitle &quot;What should $npc1.Name do?&quot;&gt;&gt;

&lt;p&gt;$npc1.He holds the apple core between a fat thumb and forefinger and looks at it speculatively, then looks down at you. &lt;/p&gt;

&lt;p&gt;&quot;What do YOU think? Should I come out of retirement?&quot; At that point $npc1.his gut grumbles loudly enough for you to feel it through your $p.feet. &quot;Hrrrmphh... On the other hand...&quot; $npc1.he casts a rather wistful look down at the table groaning under the weight of so much food, and of $npc1.his overblown belly. &quot;... Turns out I really, really //LOVE// eating. Should I give up all of THIS, just because I&#39;ve got a little... round?&quot; &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Come out of retirement!&quot; &quot;Come out of retirement&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;I&#39;ll have to think about it...&quot; &quot;Leave Sampson&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;thinking about it&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="277" name="dairy quest links" tags="nobr" position="1300,2250" size="100,100">&lt;&lt;set _herdStarted = setup.questStarted($defendingTheHerd)&gt;&gt;
&lt;&lt;set _herdReady = setup.questReady($defendingTheHerd)&gt;&gt;
&lt;&lt;set _herdComplete = setup.questCompleted($defendingTheHerd)&gt;&gt;

&lt;&lt;set _milkStarted = setup.questStarted($madMilk)&gt;&gt;
&lt;&lt;set _milkReady = setup.questReady($madMilk)&gt;&gt;
&lt;&lt;set _milkComplete = setup.questCompleted($madMilk)&gt;&gt;

&lt;&lt;set _cheeseStarted = setup.questStarted($madCheese)&gt;&gt;
&lt;&lt;set _cheeseReady = setup.questReady($madCheese)&gt;&gt;
&lt;&lt;set _cheeseComplete = setup.questCompleted($madCheese)&gt;&gt;

/*===Herd Quest===*/
&lt;&lt;if !_herdStarted&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;get herd quest&quot;&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Do you need any help?&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _herdStarted&gt;&gt;
	
	&lt;&lt;if  !_herdReady and !_herdComplete&gt;&gt;
		&lt;&lt;set $eventCounterB = &quot;working on herd quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Still working on that quest.&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

	&lt;&lt;elseif _herdReady and !_herdComplete&gt;&gt;
		&lt;&lt;set $eventCounterB = &quot;turn in herd quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;I finished your quest!&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===Milk Machine Quest===*/
&lt;&lt;if _herdComplete and !_milkStarted&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;get milk machine quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Do you need any more help?&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;elseif _milkStarted&gt;&gt;

	&lt;&lt;if  !_milkReady and !_milkComplete&gt;&gt;
		&lt;&lt;set $eventCounterB = &quot;working on milk machine quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Still working on that quest.&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

	&lt;&lt;elseif _milkReady and !_milkComplete&gt;&gt;
		&lt;&lt;set $eventCounterB = &quot;turn in milk machine quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;I finished your quest!&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Cheese Quest===*/
&lt;&lt;if _milkComplete and !_cheeseStarted&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;get cheese quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Do you need any more help?&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;elseif _cheeseStarted&gt;&gt;	
	&lt;&lt;if  !_cheeseReady and !_cheeseComplete&gt;&gt;
		&lt;&lt;set $eventCounterB = &quot;working on cheese quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Still working on that quest.&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

	&lt;&lt;elseif _cheeseReady and !_cheeseComplete&gt;&gt;
		&lt;&lt;set $eventCounterB = &quot;turn in cheese quest&quot;&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;I finished your quest!&quot; &quot;Quests for the dairy farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="278" name="Forest" tags="forest" position="3675,1775" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a comfortable spot to sit down and rest. 
	&lt;&lt;rest&gt;&gt;&lt;/p&gt;

	&lt;&lt;if random(1,5) == 1&gt;&gt;
		&lt;&lt;set _enemy = either($fatWolf, $obeseBear, $lemonSlime, $syrupVines, $fruitDryad)&gt;&gt;
		&lt;&lt;setEnemy _enemy&gt;&gt;
		You are awoken from your sleep by $e.article $e.name! 
		&lt;&lt;startCombat&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;include &quot;Ambient forest&quot;&gt;&gt;
		&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
&lt;p&gt;The local forest has provided a constant supply of wood and game for the local populace as well as being quite serene and beautiful to travel through. Lately the forest has become a somewhat more abundant place. Trees creak under the weight of their fruit and the forest creatures have been gorging themselves on the increasingly lush forest. It&#39;s as though all the animals are fattening themselves up for a winter that never comes. The predators too are taking advantage of this bounty and have been devouring their fatter slower prey indiscriminately. The predators have even become so bold as to start attacking people who venture into the forest. More worrisome than the common predators are stories of practitioners of dark magic hiding out in the woods, kidnapping random passers by. There&#39;s also tales of strange creatures never before seen by any person alive. &lt;/p&gt;

&lt;&lt;include &quot;Ambient forest&quot;&gt;&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="279" name="Ambient forest" tags="nobr forest" position="3675,1675" size="100,100">&lt;&lt;switch $daytime&gt;&gt;

&lt;&lt;case &quot;night&quot;&gt;&gt;
&lt;&lt;switch random(1,6)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
The moon rises, and its shine along with that of starlight seeps through the silver-tinted canopy leaves and scantly illuminates the mysterious nightly happenings of the forest, that include far more than just nocturnal hunting and gurgling of both carnivorous and ruminant bellies filled during midday and twilight. 

&lt;&lt;case 2&gt;&gt;
As the rustle of elusive, yet hefty &lt;&lt;=$bat.plural&gt;&gt; and likewise well-fed night time birds fills the air above, hisses and rattling start coming from the underbrush, and strange, bizarrely moving silhouettes can be spotted against the eldritch glow coming from the heart of the forest.

&lt;&lt;case 3&gt;&gt;
Unsettling whispers come from everywhere, resonating from tree to tree and floating through the bushes and grass, and the eerie shapes are moving ever closer to your hiding place that doesn&#39;t feel so secure now, and the plants themselves seem to move subtly on their own accord without any wind prompting them. 

&lt;&lt;case 4&gt;&gt;
Chittering and clicking come from inside the mossy tree stumps, and the branches above bend with creaking effort, as though reaching for something, and the ghostly murmurs around you seems so obnoxiously mocking that you cannot help feeling that those thing are making fun of you. 

&lt;&lt;case 5&gt;&gt;
As the night draws nearer the end, the frightening whispers abate and withdraw back into the sylvan depths, leaving in their place the terrible hungry noises from nocturnal beasts on the prowl, and at times you could swear you heard screams for help coming from some unlucky traveller too far away to locate, let alone lend a hand. 

&lt;&lt;default&gt;&gt;
The creatures of the deep woods have not all gone away, but are steadily retreating, lurching past the trees on the edges of your sight, and the forest air is unmistakably frosty with a promise of timely sunrise, with no other creature allowing itself to be heard or seen as the first calls of the daytime birds greet the coming morning.

&lt;&lt;/switch&gt;&gt;

&lt;&lt;case &quot;morning&quot;&gt;&gt;
&lt;&lt;switch random(1,6)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
Even the wild things consider this crispy cold hour early, and it&#39;s eerily quiet under the treecover, seeing as most of the nocturnal beasts have already crawled into their dens to sleep, and the daylight critters are still shy about leaving their dens. 
								
&lt;&lt;case 2&gt;&gt;
The milky white light of the setting sun starts making its way through the dense canopy, banishing the last night birds and beasts and driving the rest to start their early foraging and hunting. 
								
&lt;&lt;case 3&gt;&gt;
A hodgepodge chorus of small birds fills the morning air, and life awakens on the forest&#39;s shadowy floor, with little creatures scurrying around and larger forms rustling the bushes and cracking dry branches under their feet and paws. 
								
&lt;&lt;case 4&gt;&gt;
As more light drains through the tangle of leaves and branches overhead, the most of the daylight-loving inhabitants of the woods emerge from their dense and start their food chain interplay, and you start hearing the warning cries of prey creatures and the growls of those preying on the former. 
								
&lt;&lt;case 5&gt;&gt;
Even though it is still significantly shady under the tree crowns, the illumination is enough to let you see the incredible diversity of the waking wildlife from your hideout, and both the cunning, social $wolf.species packs and the jumpy $deer.species show clear signs of benefiting from the land&#39;s recent abundance, flaunting heavy bellies and jiggling rumps. 
								
&lt;&lt;default&gt;&gt;
The sundry fluttering and twittering birds above gradually lose their caution as the day unfolds, sometimes darting by so low you could try and catch one, especially since the recent diets of the local aviary have made it harder for their plump rounded bodies to defy gravity. 
								
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;day&quot;&gt;&gt;
&lt;&lt;switch random(1,6)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
The forest is bustling with all sorts of activities this time of day, and the strange things one would never even associate with the sylvan habitat roam the limited spaces between the treetrunks and dangling vines, while the more conventional beasts and birds practically have to wait in line of their beastly cousins in order to follow the trail of their choosing. 
								
&lt;&lt;case 2&gt;&gt;
The hunt is on in the darkened environment of arching branches, and you don&#39;t have to wait for too long before a fat feral $rabbit.species or an overweight wild $pig.species rushes past, followed by a $wolf.species equally encumbered by jiggling flab, and the traditionally swift and tense contest of speed quickly devolves into an arduous panting clash of endurances, with the victorious predators often collapsing right by their prey, unable to start feasting until they&#39;ve had a good long rest. 
								
&lt;&lt;case 3&gt;&gt;
Although the most prevalent representatives of the forest bestiary tend to be stout $brownBear.plural or portly $wolf.plural hunting fleshy $deer.plural and blubbery wood $pig.plural, with $badger.plural, $weasel.plural, $rat.plural, $shrew.plural, $rabbit.plural and $fox.plural in varying stages of obesity creeping, crawling and leaping between the roots, an occasional call can be heard from some of the sentient woodland explorers. 
								
&lt;&lt;case 4&gt;&gt;
Not even the bushy mesh of the tall treetops can deter the sun beating down from above, although the rays sifting down only reach the forest floor as a multitude of tiny glowing dots and blotches, and the commotion of the wildlife has abated for a time being, and a kind of informal truce is proclaimed by the distant rumbling sounds of full bellies and sated belches of the predators. 
								
&lt;&lt;case 5&gt;&gt;
With most of the successful hunters fed and safely docile for a while, the herbivores of all shapes and sizes cast off their morning fretfulness and start roaming and foraging in larger groups, stuffing themselves with lush foliage, berries and fruit that grow and ripen too quickly and abundantly for this biome. 
								
&lt;&lt;default&gt;&gt;
An occasional sleepy $brownBear.species with a bloated midsection might be seen waddling by your observation every now and then, but the visible and audible fauna is firmly dominated by the herds and flocks prey species that don&#39;t stop their dedicated banqueting even when one of their number becomes a filling breakfast for one of the less fortunate morning hunters before their very eyes. 
								
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;evening&quot;&gt;&gt;
&lt;&lt;switch random(1,6)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
For a while, everything is quiet in the woods, with most of its inhabitants sated and at leisure, even the birds that have ceased their persistent twittering and feasting, now weighting down the tree branches with their hefty frames and lazily monitoring the dull motionless forest floor. 
								
&lt;&lt;case 2&gt;&gt;
Still largely in the grasp of contented silence, the forest starts showing signs of entering its dusky phase with urgent rustling in the underbrush, wary scuttling of the $deer.species and the yawning calls of predators awakening from their siestas and getting up for the evening hunt. 
								
&lt;&lt;case 3&gt;&gt;
Neither the hunter nor their quarry could be seen in the gathering dark, but the ruckus of growls, yelps, chirps and hisses permeates passages between the trees, and much stranger things crawl into view, some lacking any distinguishable limbs and flowing forwards with dogged determination, the others seemingly flowing from one tree trunk and into the other. 
								
&lt;&lt;case 4&gt;&gt;
The evening birds start with their maddening symphony of trills and clicks, accompanied by the less diverse, but more relentless hum of insects that fill the gloom among the trees, and a triumphant belch of the evening hunter that has just dined rocks the air every few minutes. 
								
&lt;&lt;case 5&gt;&gt;
Although it is too dark to see clearly past the nearest trees, the fireflies and some stranger, peculiar sources of luminescence can be seen flickering against the leaves and the bark, and uncanny, echoing whispering is heard above the din of the feathered and chitinous musicians of the dark. 
								
&lt;&lt;default&gt;&gt;
The avian chorus has died down slightly, switching from the incessant chirping to more elaborate songs of the nightly species, with the crooning howling of the $wolf.plural entering the ensemble from far away, and despite the noisy background and rare tardy beasts rushing towards their holes and dens, the woodlands are at peace. 
								
&lt;&lt;/switch&gt;&gt;


&lt;&lt;default&gt;&gt;
**Error in ambient forest**

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="280" name="Forest ambush" tags="nobr" position="3625,1975" size="100,100">&lt;&lt;if $forestEnemies == undefined or $forestEnemies.length == 0&gt;&gt;
	&lt;&lt;set $forestEnemies = [&quot;wolf&quot;, &quot;bear&quot;, &quot;lemon&quot;, &quot;vines&quot;, &quot;dryad&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $forestEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;

&lt;&lt;case &quot;wolf&quot;&gt;&gt;
&lt;&lt;setEnemy $fatWolf&gt;&gt;
As you come around a tree you nearly run into an obese $npc1.species, who&#39;s nearly as surprised, and much more angry, than you are.

&lt;&lt;case &quot;bear&quot;&gt;&gt;
&lt;&lt;setEnemy $obeseBear&gt;&gt;
You walk past a suspiciously fuzzy $npc1.furBelly boulder. Before you can reflect any further, the boulder stands up, revealing itself to be a //very// enormous $npc1.species!

&lt;&lt;case &quot;lemon&quot;&gt;&gt;
&lt;&lt;setEnemy $lemonSlime&gt;&gt;
With an unmistakable //shlorping// sound, a lemon colored slime pounces at you from behind a tree!

&lt;&lt;case &quot;vines&quot;&gt;&gt;
&lt;&lt;setEnemy $syrupVines&gt;&gt;
As you&#39;re walking through the forest, you start to notice the vines are growing strangely thick. Especially since this type of forest isn&#39;t supposed to have vines. Soon you find yourself completely surrounded by thick dripping vines as they move to surround you!

&lt;&lt;case &quot;dryad&quot;&gt;&gt;
&lt;&lt;setEnemy $fruitDryad&gt;&gt;
Your hear a strange melody being sung nearby. As you approach the voice, you find the source is actually a woody dryad. And they have a wicked gleam in their eye. 

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy randomization&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="281" name="Minor forest events" tags="nobr" position="3725,1975" size="100,100">&lt;&lt;setPassageTitle &quot;A discovery?&quot;&gt;&gt;

&lt;&lt;switch random(1,8)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
As you travel through the forest, you come across a small tree bearing fruit. You each up and pick the only ripe looking fruit. 
&lt;&lt;if random(1,2) == 1&gt;&gt;&lt;&lt;getItem $apple&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $orange&gt;&gt;
&lt;&lt;/if&gt;&gt;
				
&lt;&lt;case 2&gt;&gt;
&lt;p&gt;As you travel through the forest you come across a massive apple tree. All of the branches appear to have been bent under a massive bounty of fruit, but they&#39;ve been picked almost completely bare. Laying on the ground around the tree are several of the fattest $deer.species, &lt;&lt;=$raccoon.plural&gt;&gt;, &lt;&lt;=$squirrel.species&gt;&gt; and other forest animals you&#39;ve seen. Each of them has a bulging stomach and they are all surrounded by the chewed up remains of apples. &lt;/p&gt;

You $walk up and poke a $deer.species in the gut, eliciting an annoyed grunt from the blob-like creature. It stretches its neck out and picks up the nearest remains of an apple and starts chewing it again as it goes back to sleep. You look up and see there&#39;s one remaining apple that the other animals couldn&#39;t reach and pluck it. 
&lt;&lt;getItem $apple&gt;&gt;
						
&lt;&lt;case 3&gt;&gt;	
&lt;p&gt;As you travel through the forest you hear the faint sound of trickling water. As you follow the sound, you find a small waterfall pouring from a cliff above. At the base of the waterfall you find a small pile of flasks. Most of them are broken, but one of them is still in pristine condition. &lt;/p&gt;

You look around and it doesn&#39;t seem like anyone&#39;s been here recently. Whoever owned these left them here long ago. You pick up the flask and fill it up from the waterfall.
&lt;&lt;getItem $waterFlask&gt;&gt;
	
&lt;&lt;case 4&gt;&gt;		
&lt;p&gt;You wander into a small clearing, in the middle of which you see a large stump. You cross the clearing and approach the stump, upon which you find a small wooden box. It looks rather simple, but has a few strange words carved into the top in some language you cannot decipher. &lt;/p&gt;		

You open the lid and find a small strange diamond shaped cookie with white frosting on top, while a few crumbs lie about it from where others must have once been. You take it, and replaced the box where you found it. 
&lt;&lt;getItem $oddCookie&gt;&gt;

&lt;&lt;case 5&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot;&gt;&gt;
&lt;p&gt;As you $walk through the forest, you start to faintly hear the sounds of a struggle. As you stealthily make your way through the underbrush towards the noise, you come across a $npc1.species entangled in the tendrils of a mass of syrupy vines. &lt;/p&gt;

&lt;p&gt;$npc1.He&#39;s quite clearly fighting a losing battle as $npc1.he&#39;s become hopelessly entangled in the vines&#39; grasp with several of them crammed in $npc1.his mouth. $npc1.His $npc1.furBelly $npc1.furred belly has shredded through $npc1.his leather armor as $npc1.his stomach has been inflated to a ludicrous size. The syrup soaked $npc1.species&#39;s movements become more and more frantic as $npc1.he approaches $npc1.his bursting point. &lt;/p&gt;

&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;You can almost see $npc1.his enormously bloated stomach stretch fuller and fuller as syrup is pumped into the helpless $npc1.species. With a final loud gurgle, the poor $npc1.species explodes in a shower of syrup. You duck for cover and when you stand back up you find nothing left behind of the $npc1.species. You pause in surprise for a moment before you carefully creep forward and survey the scene. After poking the limp vines a few times, you confirm that it&#39;s been entirely drained of syrup and merely hang limply from the tree. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;There&#39;s a creaking noise which you first attribute to the $npc1.species&#39;s overstretched stomach, but soon afterwards there&#39;s a snapping noise as the vines break under $npc1.his weight. $npc1.He falls on the ground roughly and slowly rolls onto $npc1.his back with $npc1.his sticky belly sloshing back and forth. &lt;/p&gt;

&lt;p&gt;Before you have a chance to come out from your hiding spot, a large feral $wolf.species leaps out from some bushes on the opposite side from you. Apparently the $wolf.species had been lying in wait for its opportunity at a free meal, because before the $npc1.species realizes $npc1.he&#39;s under attack again, the $wolf.species already has $npc1.his legs in his mouth. The $npc1.species puts up a weak struggle, evidently far too painfully inflated with syrup to put up much of a fight. Before you can react, the previously slim-gutted $wolf.species has swallowed the syruped $npc1.species down and is already waddling his way back into the forest. &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

Now that the maelstrom of activity is over, you leave your hiding spot in the bushes and survey the combat zone. 
&lt;&lt;if random(1,2) == 1&gt;&gt;
Searching the syrupy ground, you manage to find something! 

&lt;&lt;set _randomItem = random(1,100)&gt;&gt;
&lt;&lt;if _randomItem &gt; 90&gt;&gt;&lt;&lt;getItem $trident&gt;&gt;
&lt;&lt;elseif _randomItem &gt; 75&gt;&gt;&lt;&lt;getItem $apple&gt;&gt;
&lt;&lt;elseif _randomItem &gt; 40&gt;&gt;&lt;&lt;getItem $sHealthPotion&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $cheeseburger&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
Searching the syrupy ground, you manage to find a small bag of gold! 
&lt;&lt;set _goldFound = random(26,33)&gt;&gt;
&lt;&lt;doGld _goldFound&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;default&gt;&gt;
&lt;&lt;include &quot;Ambient forest&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="282" name="forest randomization" tags="forest" position="3875,1875" size="100,100">/*Ticks up random events counters*/
&lt;&lt;set $forestRandomization.combat += $forestRandomization.combatRate&gt;&gt;
&lt;&lt;set $forestRandomization.special += $forestRandomization.specialRate&gt;&gt;
&lt;&lt;set $forestRandomization.leave += $forestRandomization.leaveRate&gt;&gt;
&lt;&lt;set $forestRandomization.minor += $forestRandomization.minorRate&gt;&gt;

/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;
&lt;&lt;if $forestRandomization.special &gt; $forestRandomization.combat&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forestRandomization.minor &gt; $forestRandomization.special&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;minor&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forestRandomization.leave &gt; $forestRandomization.minor&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;leave&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;

/*A random combat*/
&lt;&lt;case &quot;combat&quot;&gt;&gt;
&lt;&lt;set $forestRandomization.combat = 0&gt;&gt;
&lt;&lt;set _event = &quot;Forest ambush&quot;&gt;&gt;

/*A special event*/
&lt;&lt;case &quot;special&quot;&gt;&gt;
&lt;&lt;set $forestRandomization.special = 0&gt;&gt;
&lt;&lt;set _specialEvent = 0&gt;&gt;
&lt;&lt;for _i=0; _i&lt;$forestSpecialRandomization.length; _i++&gt;&gt;
	&lt;&lt;set $forestSpecialRandomization[_i]++&gt;&gt;
	&lt;&lt;if $forestSpecialRandomization[_i] &gt;
		$forestSpecialRandomization[_specialEvent]&gt;&gt;
		&lt;&lt;set _specialEvent = _i&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;set $forestSpecialRandomization[_specialEvent] = 0&gt;&gt;
&lt;&lt;switch _specialEvent&gt;&gt;
	&lt;&lt;case 0&gt;&gt;
	&lt;&lt;set _event = &quot;Gingerbread House&quot;&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
	&lt;&lt;set _event = &quot;Wolf pack&quot;&gt;&gt;
	&lt;&lt;case 2&gt;&gt;
	&lt;&lt;set _event = &quot;Storeroom&quot;&gt;&gt;
	&lt;&lt;case 3&gt;&gt;
	&lt;&lt;set _event = &quot;Mysterious feast&quot;&gt;&gt;
	&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in special event randomization!&#39;&#39;
&lt;&lt;/switch&gt;&gt;

/*A random minor scene*/
&lt;&lt;case &quot;minor&quot;&gt;&gt;
&lt;&lt;set $forestRandomization.minor = 0&gt;&gt;
&lt;&lt;set _event = &quot;Minor forest events&quot;&gt;&gt;

/*Opportunity to leave the forest*/
&lt;&lt;case &quot;leave&quot;&gt;&gt;
&lt;&lt;set $forestRandomization.leave = 0&gt;&gt;
&lt;&lt;set _event = &quot;Path out of the forest&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in forest randomization!!!&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;5&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Forest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;forest&quot; &quot;Forest&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;road&quot; &quot;Swamp&quot; &quot;Path to swamplands&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="283" name="Path to swamplands" tags="" position="3200,2050" size="100,100">&lt;p&gt;As you make your way deeper into the forest, your foot suddenly sinks into a soft, squelchy patch of mud. Pausing to free your foot, you glance up and notice the landscape subtly changing before you. In the distance, the dense foliage gives way to a sprawling bog, marking the beginning of the notorious swamplands that border the forest.&lt;/p&gt;

&lt;p&gt;You recall the tales you&#39;ve heard about these swamps. They&#39;re said to be home to a myriad of creatures, each more perilous than the last. These beings have evolved in remarkable, sometimes frightening ways, perfectly adapted to the swamp&#39;s treacherous environment. Many are known for their ability to ensnare, inflate, or even burst their prey in mere moments, making the swamplands a place of both fascination and dread.&lt;/p&gt;

&lt;p&gt;You remember a warning you heard in in town one time, &quot;Steer clear of the swamp when night falls at all costs.&quot;&lt;/p&gt;

&lt;p&gt;Now, you find yourself at a crossroads. You can continue to brave the mysteries and dangers of the forest, or you can venture into the swamplands, a territory teeming with unknown risks and dark allure. The choice lies before you: the relative safety of the forest or the perilous unknown of the swamp.&lt;/p&gt;

&lt;&lt;action &quot;4&quot; &quot;leave&quot; &quot;Go Back&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $firstTimeSwamp == true&gt;&gt;
	&lt;&lt;action &quot;6&quot; &quot;swamp&quot; &quot;Swamp&quot; &quot;Swamp First Time&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;6&quot; &quot;swamp&quot; &quot;Swamp&quot; &quot;Swamp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="284" name="Path out of the forest" tags="" position="3175,2000" size="100,100">You find a clearing ahead. As you approach closer you find it is one of the roads out of the city!

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;if random(1,2) == 1&gt;&gt;
	&lt;&lt;action &quot;sw&quot; &quot;road&quot; &quot;Western Road&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;se&quot; &quot;road&quot; &quot;Eastern Road&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="285" name="Approach the storeroom" tags="" position="4375,1450" size="100,100">You approach the building and discover it to be a smallish shack. There&#39;s a door on one end and a small window up on the opposite side of the building. 

&lt;&lt;action &quot;w&quot; &quot;house&quot; &quot;Check the door&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;house&quot; &quot;Check the window&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="286" name="Break down the door" tags="" position="4625,1525" size="100,100">&lt;&lt;stamina -10&gt;&gt;

&lt;&lt;if $str &gt; 80&gt;&gt;
&lt;p&gt;You look at the door, assessing its weak points before you go to ram the door. You run through several ideas of how you&#39;ll ram the door down to get inside. After you&#39;re satisfied with your brilliant plan, you do a run up and attempt to ram the door in. 
&lt;/p&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Look around&quot; &quot;Inside the storeroom&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
You ram your shoulder up against the door, kick it, headbutt it and throw sticks and stones at it. The door shows no signs of budging and eventually you give up, sore and tired. 
&lt;&lt;action &quot;e&quot; &quot;house&quot; &quot;Check the window&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="287" name="Check the door" tags="" position="4500,1525" size="100,100">You try the door, but unfortunately find it locked. 

&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Break down the door&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;house&quot; &quot;Check the window&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="288" name="Check the window" tags="" position="4500,1400" size="100,100">You go to the back side of the shack where there&#39;s a stack of empty crates you can stand on to look through the window. When you peer through the window you find a single gas lantern illuminating a store room crammed to the rafters with food. The window is unlocked and looks just large enough for someone to fit through. 

&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Climb through the window&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;house&quot; &quot;Check the door&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="289" name="Climb through the window" tags="" position="4625,1400" size="100,100">&lt;&lt;if setup.waistDiameter() &gt; 20&gt;&gt;
	You try to squeeze through, but unfortunately you&#39;re just too big to fit through the window. 
	&lt;&lt;action &quot;w&quot; &quot;house&quot; &quot;Check the door&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif setup.waistDiameter() &gt; 15&gt;&gt;
	You just barely manage to squeeze through the window, your gut brushing heavily against the window frame. 
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Look around&quot; &quot;Inside the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif setup.waistDiameter() &gt; 10&gt;&gt;
	With some difficulty, you manage to squeeze your way through the small window. Your gut almost grazing the bottom of the window. 
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Look around&quot; &quot;Inside the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
	You climb through the small window rather easily. 
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Look around&quot; &quot;Inside the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="290" name="Defeated by the feast" tags="" position="4300,900" size="100,100">&lt;&lt;consume 20 10&gt;&gt;
&lt;&lt;rest&gt;&gt;
&lt;p&gt;Your eyes drift open as you look up into a sea of tree branches. Looking around you find yourself laying on top of the table. You look down at your $waist stomach and finally realize how much more stuffed you were than when you passed out. &lt;/p&gt;

&lt;p&gt;You try to get up, but your arms and legs are pinned to the table. You look over and see your arms are are fixed to the table by makeshift manacles of bent cutlery. You try to move your jaws and also find that they&#39;re being pried open by two spoons. &lt;/p&gt;

&lt;p&gt;The top spoon pushes up on the roof of your mouth, forcing you to lay your head back on the table. A large flagon of mead floats into view and tips over, pouring a massive deluge of alcohol down your throat. You sputter and try to gulp it down as fast as you can, feeling your stomach slowly stretch even larger. &lt;/p&gt;

&lt;p&gt;No sooner have you swallowed the last of it down before you see a huge cast iron pot slowly hop down the table, making a large thud that rattles the table with every jump. A soup ladle larger than your cupped hands floats out of the massive pot before almost gently pouring a ladlefull of warm savory stew down your throat. &lt;/p&gt;

&lt;p&gt;You struggle to swallow it down as the ladle floats down to massage your stomach as best a floating soup ladle can. It gives you a moment to breathe before going back and pouring another huge soup ladle full of stew down your throat. It slowly repeats this process several times, each time going back and massaging your stomach. Sometimes eliciting a belch from you when you have a moment to breathe. 
&lt;&lt;consume 20 10&gt;&gt;&lt;/p&gt;

&lt;&lt;if $options.popping&gt;&gt;
	&lt;p&gt;Each time you hope it&#39;s the end, but there&#39;s only more and more and more. Your stomach keeps stretching beyond it&#39;s normal limits thanks to the gentle ministrations of the soup ladle&#39;s massages. Ultimately, you simply don’t have the room to contain it all. The ladle pours a final helping into your mouth, but you are just too full to swallow it down. You feel the insistent jab of the knife prod your $p.furBelly underbelly in a futile attempt to coax you to continue, but you are in far too delicate a state for such a poke. The feast and all of it’s trappings vanish in an instant as your overstuffed gut explodes, leaving only the lingering scent of roasted meat and savory sauces to note you were ever there. &lt;/p&gt;

	&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;p&gt;Each time you hope it&#39;s the end, but there&#39;s only more and more and more. Your stomach keeps stretching beyond it&#39;s normal limits. Between being completely stuffed full of rich warm stew and the gentle ministrations of the soup ladle&#39;s massages, you slowly drift into unconsciousness even as the ladle dutifully serves you more stew. &lt;/p&gt;

	&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="291" name="Devour the feast" tags="" position="4425,1025" size="100,100">&lt;p&gt;Speaking directly to the enchanted cutlery, you ask to be fed everything on the table. You watch eagerly as the cutlery set hovers in place for a moment before bursting into a flurry of activity. Cheek-bulging mouthfuls of ribs, burgers, fruits, steaks, and ice creams of every flavour are roughly pushed into your unresisting $p.mouth before being swallowed, your throat bulging and rippling under your chin &lt;&lt;if $p.male == &quot;female&quot;&gt;&gt;and disappearing between your breasts&lt;&lt;/if&gt;&gt;, each infinitesimally small pause for breath followed by a belch and another demand for more food. 
&lt;&lt;set _eat = $eventCounterB&gt;&gt;
&lt;&lt;set _calories = _eat * 0.5&gt;&gt;
&lt;&lt;consume _eat _calories&gt;&gt;
&lt;/p&gt;

&lt;p&gt;Until finally&lt;&lt;if $alive&gt;&gt;, as you let loose one last resonant belch, the cutlery falls to the denuded plates, their magic as spent as your stomach is filled. 
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;else&gt;&gt; you drop into a deepening food coma, the last thing you&#39;re aware of is the soft clattering of cutlery bouncing off of your overstuffed gut and falling to the loamy soil. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Defeated by the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;/p&gt;</tw-passagedata><tw-passagedata pid="292" name="Dig in!" tags="" position="4300,1150" size="100,100">&lt;p&gt;You take a seat at the head of the table. The chair&#39;s even more comfortable than it looked. You eagerly pick up your knife and fork and carve yourself off a huge hunk of a ham sitting nearest you. You eagerly cram it in your mouth and are greeted by a sweet juicy explosion of flavor. You lean back and close your eyes as you savor some of the tastiest meat you&#39;ve ever eaten. &lt;/p&gt;

When you open your eyes though, you are shocked to see that the chair has wrapped several varnished wooden tendrils around your arms and feet. The knife and fork fly out of your hands and of their own volition begin carving out a hunk of turkey half the size of your head! The fork slowly levitates back over to you, wobbling under the weight of it&#39;s offering. The sharp knife pokes you insistently in the gut, as if coercing you to open your mouth. 
&lt;&lt;consume 3 1.5&gt;&gt;
&lt;&lt;set $eventCounterA = 100&gt;&gt;
&lt;&lt;set $eventCounterB = 500&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Trying to escape the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;surrender&quot; &quot;Wait&quot; &quot;Wait at the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sto &gt;= 500&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;devour&quot; &quot;Devour the feast&quot; &quot;Devour the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="293" name="Eat the wolf" tags="nobr" position="4575,1950" size="100,100">&lt;&lt;setPassageTitle &quot;Eat the $wolf.species&quot;&gt;&gt;
&lt;p&gt;A devilish grin flickers across your face as your stomach rumbles. Continuing to rub, you walk over to the $wolf.species’s head. You squat down a bit, getting your head close to $npc1.his. You open your mouth wide, and stop rubbing, shoving the $wolf.species’s head into your mouth. &lt;/p&gt;

&lt;&lt;consumeQuiet 150&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;&lt;consumeQuiet -150&gt;&gt;
&lt;p&gt;The $wolf.species lets out a surprised, panicked yelp and struggles against you a little, but you push on, holding its forepaws down to make it easier to work your jaws over the $wolf.species’s body. You almost start coughing the $wolf.species up a few times due to the amount of $wolf.fur in your throat, but something feral sparks within you and you reach a second wind, pushing on $npc1.his belly to squish it into your mouth a bit easier. As $npc1.he begins to reach your stomach, you feel your midriff begin to surge outwards. You eventually reach $npc1.his hindquarters, pushing them in before sucking $npc1.his tail in like a noodle, flopping onto your rear. 
&lt;&lt;consume 150 100&gt;&gt;&lt;/p&gt;

You flick your head back and let out a huge belch that echoes throughout the forest, scaring several birds out of the trees around you. As the noise finally dies down, you hear whimpering around you. You look around and see several of the collection of $wolf.plural, surrounding you and staring in fear. As you stand up, the $wolf.plural scatter. You’ve won, it seems. 
&lt;&lt;doXP 20&gt;&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;consumeQuiet -150&gt;&gt;
&lt;p&gt;The $wolf.species lets out a surprised, panicked yelp...seemingly unaware that now that you’re actually doing this, you’re beginning to panic too. You did &#39;&#39;NOT&#39;&#39; think this through. You manage to make your way past the $wolf.species’s shoulders... but your stomach’s starting to rebel. Shrugging it off, you keep pushing, to the tune of your stomach groaning and creaking. You cough a few times before you feel your consciousness drop. &lt;/p&gt;

In the dizzy, incoherent mess of senses you experience after, you feel something being pulled out of your mouth, and something else munching its way over your head. You’re uncertain if it’s the Alpha or another $wolf.species eating you, but the important thing is – what you just did majorly backfired. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="294" name="Feasting in the storeroom" tags="nobr" position="4875,1525" size="100,100">&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 1&gt;&gt;
You tear off huge hunks of succulent meat from a grilled rack of ribs, barbecue sauce covering your $p.mouth. 
&lt;&lt;consume 5 2.5&gt;&gt;

&lt;&lt;case 2&gt;&gt;
You pick up a huge roast duck and tear off strips off juicy meat and swallow them down. 
&lt;&lt;consume 4 2&gt;&gt;

&lt;&lt;case 3&gt;&gt;
You pick up a rope of smoked sausages and swallow them down whole, one after another. 
&lt;&lt;consume 3 1.5&gt;&gt;

&lt;&lt;case 4&gt;&gt;
You reach into a barrel of corn and pull out several juicy cobs dripping with butter. You cram entire ears of corn in your $p.mouth and pull out the cobs, stripping all the kernels off as you do so. 
&lt;&lt;consume 3 1.5&gt;&gt;

&lt;&lt;case 5&gt;&gt;
You pull out an armload of some of the largest juiciest red apples you&#39;ve ever seen. You cram one into your $p.mouth whole and crunch down creating a sweet juicy explosion of apple. You swallow it down and repeat this process on several other apples. 
&lt;&lt;consume 3 1.5&gt;&gt;

&lt;&lt;case 6&gt;&gt;
You cram your entire head into a bag of oats and start sucking them down with reckless abandon like a wild animal. 
&lt;&lt;consume 4 2&gt;&gt;

&lt;&lt;case 7&gt;&gt;
You decide to quench your thirst as you hold a small keg of wine over your head. You put the tap in your $p.mouth and open it up and suck down the sweet aromatic drink, making you feel slightly tipsy. 
&lt;&lt;consume 3 1.5&gt;&gt;

&lt;&lt;case 8&gt;&gt;
You dunk your whole head into a barrel of water and start sucking it down, your belly slowly stretching out as it fills with pure clean water. 
&lt;&lt;consume 3 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;

/*Checks to see if you&#39;ve overeaten*/
&lt;&lt;if $alive&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;food&quot; &quot;Rack of ribs&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;food&quot; &quot;Roast duck&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 2&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;food&quot; &quot;Rope of sausages&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 3&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;food&quot; &quot;Barrel of corn&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 4&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;food&quot; &quot;Crate of apples&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;food&quot; &quot;Bag of oats&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 6&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;food&quot; &quot;Keg of wine&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 7&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;food&quot; &quot;Barrel of water&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 8&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;After that last swallow you finally feel too stuffed to even stay awake any more. You //fwomp// onto your back with a &#39;&#39;thud&#39;&#39; and rub your overly full belly. &lt;/p&gt;

&lt;p&gt;Just as you&#39;re about to pass out, you suddenly hear someone whistling as the sound of footsteps make their way up to the shed door. You attempt to get up to try to escape, but you&#39;re practically too stuffed to keep your eyes open. &lt;/p&gt;

&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;
&lt;p&gt;As you hear someone fumbling with a set of keys, you fall back on the floor and unwillingly start drifting off to sleep. You stay awake just long enough to see $npc1.article $npc1.species walk in and shout &quot;What the hell!&quot; in a country drawl just before you pass out in an overstuffed stupor. &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Pass out&quot; &quot;Wake up in the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="295" name="Follow wolves" tags="nobr" position="4325,1825" size="100,100">&lt;&lt;setPassageTitle &quot;Follow the $wolf.plural&quot;&gt;&gt;
You step away from the tree and into the open, looking at the trail. 
&lt;&lt;skillTest $int -10&gt;&gt;

&lt;&lt;if $skillCheck&gt;&gt;
You see the tail of one of the $wolf.plural disappear around a corner, and decide to follow, when all of a sudden, a massive impact to your side knocks you to the ground, dazing you for a few moments. When you snap out of it, you look up to find yourself pinned to the ground by a particularly large $wolf.species – judging from its size, you assume this is probably the alpha $wolf.species. It growls, looking smug about how easily it blind-sided you like this, and it licks its chops.

&lt;&lt;action &quot;w&quot; &quot;attack&quot; &quot;Struggle against the $wolf.species&quot; &quot;Struggle against the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Submit to the $wolf.species&quot; &quot;Submit to the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;food&quot; &quot;Give food to the $wolf.species&quot; &quot;Give food to the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Give belly rubs to the $wolf.species&quot; &quot;Give belly rubs to the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
You cautiously step over to it and peer up the way they went. Your efforts to follow them to where they were headed are fruitless, because it seems that one of the heftier ones had knocked into a nearby shrub, knocking it over and blocking your path. You can&#39;t find another path around, so you can only explore elsewhere. 

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="296" name="Give belly rubs to the wolf" tags="" position="4450,1825" size="100,100">&lt;&lt;setPassageTitle &quot;Give belly rubs to the $wolf.species&quot;&gt;&gt;
You manage to get a hand free. You reach down and gently begin to scratch at $npc1.his warm, $wolf.furry stomach. $npc1.He growls a little at first, but this soon stops. $npc1.He closes $npc1.his eyes, beginning to trance out. To your amazement, $npc1.he flops onto $npc1.his back, $npc1.his back foot twitching, presumably as an invitation to rub more. You look around and realise that you could probably use this opportunity to make a break for it, or take some other course of action. 

&lt;&lt;action &quot;n&quot; &quot;run&quot; &quot;Run from the $wolf.species&quot; &quot;Run from the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;wait&quot; &quot;Stay with the $wolf.species&quot; &quot;Stay with the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;devour&quot; &quot;Eat the $wolf.species&quot; &quot;Eat the wolf&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="297" name="Give food to the wolf" tags="nobr" position="4450,1950" size="100,100">&lt;&lt;setPassageTitle &quot;Give food to the $wolf.species&quot;&gt;&gt;
&lt;&lt;if setup.hasItem($sausage) &gt; -1&gt;&gt;
	&lt;&lt;set _distraction = $sausage&gt;&gt;
&lt;&lt;elseif setup.hasItem($steak) &gt; -1&gt;&gt;
	&lt;&lt;set _distraction = $steak&gt;&gt;
&lt;&lt;elseif setup.hasItem($meatballSub) &gt; -1&gt;&gt;
	&lt;&lt;set _distraction = $meatballSub&gt;&gt;
&lt;&lt;elseif setup.hasItem($hamSandwich) &gt; -1&gt;&gt;
	&lt;&lt;set _distraction = $hamSandwich&gt;&gt;
&lt;&lt;elseif setup.hasItem($cheeseburger) &gt; -1&gt;&gt;
	&lt;&lt;set _distraction = $cheeseburger&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _distraction = $apple&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*You don&#39;t have a distraction*/
&lt;&lt;if _distraction.name == $apple.name&gt;&gt;
You manage to get a hand free and rummage around for some other food that the $wolf.species might want instead of you. However, nothing in your backpack seems to interest the $wolf.species, who has run out of patience. $npc1.He rolls onto $npc1.his back, so you’re on top of $npc1.his mountainous belly, tilting back so you slide headfirst into $npc1.his maw. $npc1.He only has to swallow a few times, gravity doing most of the work for $npc1.him. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*You do have a distraction*/
&lt;&lt;else&gt;&gt;
You just about manage to get a hand free. Remembering that you have _distraction.article _distraction.name in your backpack, you give the $wolf.species a basic &quot;Wait&quot; gesture. It looks a bit annoyed and bemused until you take the food out of your backpack. It whines, then pants, looking at you. You just about manage to flick it away from you, making it land a few feet away. It looks between the food and you a few times, then decides to go for the foodstuff with less clothes and $p.fur on it. It bounds off you, gnawing on the food. You carefully sneak off while $npc1.he&#39;s preoccupied and happy. You’ve escaped, but at the cost of your food. 
&lt;&lt;removeItem _distraction&gt;&gt;
&lt;&lt;doXP 5&gt;&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="298" name="Hide from wolves" tags="nobr" position="4200,1700" size="100,100">&lt;&lt;setPassageTitle &quot;Hide from the $wolf.plural&quot;&gt;&gt;
&lt;&lt;skillTest $int -10&gt;&gt;

&lt;&lt;switch $skillCheck&gt;&gt;

&lt;&lt;case true&gt;&gt;
&lt;p&gt;Keeping your breathing shallow to keep any noise down, you wait for a few minutes to make sure there’s nothing waiting for you. Letting out a sigh of relief, you head back on your way. &lt;/p&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&lt;p&gt;You hear a creaky slithering noise behind you. You realise all too late that this probably wasn’t the best place to hide – An amber-coloured vine jabs itself into your mouth, letting out a jet of sweet syrup into your mouth before you bat it away in alarm. 
&lt;&lt;consume 2 1&gt;&gt;&lt;/p&gt;

&lt;p&gt;Quickly stepping away from the tree, you see that you’ve disturbed a nearby Syrup Vine! &lt;/p&gt;

&lt;&lt;startCombat $syrupVines&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="299" name="Inside the storeroom" tags="" position="4750,1450" size="100,100">You you step through the broken door and rub your $p.hands together greedily upon the sight of the massive hoards of food. 

&lt;&lt;action &quot;1&quot; &quot;food&quot; &quot;Rack of ribs&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;food&quot; &quot;Roast duck&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 2&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;food&quot; &quot;Rope of sausages&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 3&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;food&quot; &quot;Barrel of corn&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 4&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;food&quot; &quot;Crate of apples&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;food&quot; &quot;Bag of oats&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 6&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;food&quot; &quot;Keg of wine&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 7&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;food&quot; &quot;Barrel of water&quot; &quot;Feasting in the storeroom&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 8&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="300" name="Leave the feast" tags="" position="4425,1275" size="100,100">You decide caution is the better part of valor and leave the weird forest food alone. 

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="301" name="Leave the storeroom" tags="nobr" position="4875,1400" size="100,100">Having decided that you&#39;ve eaten enough, you pick yourself up and prepare to leave. As you do so though, you begin to hear whistling in the distance that sounds like it&#39;s getting closer. You quickly turn and jump for the window 

/*Thin enough to get out*/
&lt;&lt;if setup.waistDiameter() &lt; 20&gt;&gt;
and fit through. After landing on the outside you run of into the forest. 

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

/*Too fat to get out*/
&lt;&lt;else&gt;&gt;
&lt;&lt;set $eventCounterA = (setup.waistDiameter() - 20) * 25&gt;&gt;
&lt;&lt;set $eventCounterB = 1&gt;&gt;
, but you get stuck halfway through. 

&lt;&lt;if $eventCounterA &lt;= 40&gt;&gt;
It seems you&#39;ve gotten somewhat larger since you first entered the window and have become slightly stuck. 
&lt;&lt;elseif $eventCounterA &lt;= 80&gt;&gt;
It seems you&#39;ve grown quite a bit larger since you first entered the window and have become pretty stuck. 
&lt;&lt;elseif $eventCounterA &lt;= 120&gt;&gt;
It seems you&#39;ve grown a whole //lot// larger since you first entered the window and have become very stuck. 
&lt;&lt;else&gt;&gt;
It seems you&#39;ve grown //humongously// larger since you first entered the window and have become incredibly stuck. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle through the window&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="302" name="Mysterious feast" tags="" position="4300,1275" size="100,100">&lt;p&gt;You come accross a mysterious table sitting in a clearing near the woods. Perhaps even more mysteriously, it is covered by a feast fit for a dozen high class noble types. &lt;/p&gt;

&lt;p&gt;There is only one place set at the table. On the end nearest you there is a very ornate and old looking wooden chair is set in front a table setting of fine silverware. &lt;/p&gt;

You can&#39;t help but feel this is somewhat suspicious. 

&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Dig in!&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;forest&quot; &quot;Leave the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="303" name="Run from the wolf" tags="nobr" position="4575,1825" size="100,100">&lt;&lt;setPassageTitle &quot;Run from the $wolf.species&quot;&gt;&gt;
&lt;p&gt;Standing up as quietly as you possibly can, you continue scratching for a few moments before quickly turning tail.&lt;/p&gt; 
&lt;&lt;set _playerSkill = ($int + $agi)*0.5&gt;&gt;
&lt;&lt;skillTest _playerSkill -10&gt;&gt;

&lt;&lt;if $skillCheck&gt;&gt;
You bolt as quickly and quietly as you can (which isn’t saying much) towards a nearby bush, throwing yourself over it. You get back on your feet and keep running, hoping to make the $wolf.species lose your trail. You soon realise however, you aren’t being pursued and can only hear the $wolf.species’s mournful whimpers piercing the overgrowth. 

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;As soon as your $p.hand leaves the $wolf.species’s $wolf.fur, it snaps out of its daydreaming, looking at you. You run for a nearby bush and try to jump over it, but the $wolf.species leaps after you with surprising agility and bites your ankle, cutting your momentum short and making you fall into the bush, thankfully not causing any lasting damage to your face. You blink the dazedness out of your eyes and spit out a few leaves, but already you can feel a wet, slobbery embrace around your $p.feet. &lt;/p&gt;

Surrendering to your fate, you feel the $wolf.species’s jaws work their way past your back and over your shoulders. $npc1.He pauses, licking at your face as best $npc1.he can, before tilting $npc1.his head back and swallowing the rest of you into the warm, tight confines of $npc1.his insides. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="304" name="Stay with the wolf" tags="nobr" position="4575,1700" size="100,100">&lt;&lt;setPassageTitle &quot;Stay with the $wolf.species&quot;&gt;&gt;
&lt;p&gt;For some insane reason, you find yourself willing to comply with the $wolf.species’s wishes. You reach both hands over and continue petting and stroking $npc1.his soft, ample middle. All of a sudden, however, you feel a sharp pain in your rump. Another $wolf.species, evidently looking for the Alpha, doubled back and found you, and decided the best course of action to get you away from $npc1.him was to bite and drag you off. You flop onto the floor, disorientated and in pain. After all that work, all you’ve done is delay the inevitable. &lt;/p&gt;

&lt;&lt;skillTest 80&gt;&gt;

&lt;&lt;if $skillCheck&gt;&gt;
&lt;p&gt;But then, you hear a commanding, angry bark from the Alpha, looking angrily at the other $wolf.species. It growls, but after another harsher bark from the large $wolf.species, it releases its grip and backs off, whimpering. The Alpha looks at you kindly and gestures its head away. You take it’s cue and run off as quickly as you can. &lt;/p&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;The $wolf.species growls at it’s Alpha master, refusing to listen to $npc1.his orders. You feel yourself get dragged backwards further into the woods. The $wolf.species drops you, repositions himself, and starts to devour you from the feet up. The last thing you see before darkness swallows you is the Alpha trotting over, looking utterly enraged. From the feelings of tumbling and sounds of barking, struggling and whining you hear from outside, you can only assume that the Alpha ate the disobedient $wolf.species for its trespass. You usually aren’t the one to engage in schadenfreude, but as your consciousness drifts away, you give a smug elbow to the stomach wall you’re trapped in, glad that your thwarted escape attempt was at least avenged somewhat. &lt;/p&gt;

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="305" name="Storeroom" tags="" position="4250,1450" size="100,100">As you adventure through the forest, you come upon a building in a small clearing ahead. 

&lt;&lt;action &quot;c&quot; &quot;house&quot; &quot;Approach&quot; &quot;Approach the storeroom&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="306" name="Struggle against the wolf" tags="nobr" position="4450,1700" size="100,100">&lt;&lt;setPassageTitle &quot;Struggle against the $wolf.species&quot;&gt;&gt;

&lt;&lt;set _playerSkill = $str + 50&gt;&gt;
&lt;&lt;skillTest _playerSkill $e.str&gt;&gt;

&lt;&lt;if $skillCheck&gt;&gt;
You suddenly yell wordlessly at the $wolf.species and headbutt $npc1.him in $npc1.his face, making $npc1.him yowl and momentarily lose $npc1.his concentration. You push hard at the mass of warm flab trapping you, and, to your delight, find yourself just about able to roll $npc1.him off of you onto $npc1.his back. You quickly get up and run, leaving the angry and dazed $wolf.species to howl in fury and try to get back onto $npc1.his feet, with no success.
&lt;&lt;doXP 10&gt;&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
You grunt and headbutt the $wolf.species in $npc1.his face, but end up knocking your own lights out. The $wolf.species shakes $npc1.his head, snapping out of the dazedness a lot easier than you do, then looks at you, more amused than annoyed at your escape attempt. $npc1.He opens $npc1.his mouth wide, stretching $npc1.his jaws over your head, slowly backing off of you so $npc1.he can get the rest of you into $npc1.his mouth. Your consciousness flickers in and out before finally failing, and you’re unconscious before you’re even fully inside $npc1.him. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="307" name="Struggle through the window" tags="nobr" position="5000,1400" size="100,100">&lt;&lt;set $eventCounterA -= $str&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;
/*First attempt*/
&lt;&lt;case 1&gt;&gt;
You can definitely tell the whistling is getting closer as you try to wrestle your gut through the window. 
&lt;&lt;if $eventCounterA &gt; 0&gt;&gt;
You struggle to squeeze your overstuffed form out of the window, but only manage to make a little headway. 
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Keep struggling&quot; &quot;Struggle through the window&quot;&gt;&gt;
&lt;&lt;set $eventCounterB++&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
You struggle to push yourself out and manage to break free. You waddle off into the forest just in the nick of time.  
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Second attempt*/
&lt;&lt;case 2&gt;&gt;
You can hear footsteps approaching the door. 
&lt;&lt;if $eventCounterA &gt; 0&gt;&gt;
Your continued attempts to escape your stuck fate manages to splinter the window frame, but even still you remain trapped by your swollen gut. 
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Keep struggling&quot; &quot;Struggle through the window&quot;&gt;&gt;
&lt;&lt;set $eventCounterB++&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;You continue to try and pull your widened form out of the window and finally manage to pop out. You waddle off into the forest just in the nick of time. &lt;/p&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Third and final attempt*/
&lt;&lt;case 3&gt;&gt;
You can hear someone fumbling with keys. If you&#39;re going to get out of here, you better do it now. 
&lt;&lt;if $eventCounterA &gt; 0&gt;&gt;
&lt;&lt;setEnemy $storeRoomOwner&gt;&gt;
With a final heave you desperately try to break free of your confinement, but your huge gut remains stalwart in it&#39;s attempts to anchor you in the window.

&lt;p&gt;You hear a voice behind you angrily $npc1.angry &quot;What the hell are you doin&#39; &#39;ere?&quot; before you&#39;re yanked back inside. You&#39;re face to face with an angry $npc1.species. $npc1.He&#39;s brandishing a big walking stick and appears none too happy with your prescence here. Looks like you&#39;re going to have to fight your way out. &lt;/p&gt;

&lt;&lt;startCombat&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;In a hail of splinters, you finally manage to get your fat gut through the smashed out window. As you waddle as fast as you can to the cover of the woods, you can hear loud angered shouting coming from the storeroom. &lt;/p&gt;

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="308" name="Submit to the wolf" tags="" position="4325,1700" size="100,100">&lt;&lt;setPassageTitle &quot;Sumbit to the $wolf.species&quot;&gt;&gt;

Realising that the area is probably crawling with $wolf.plural that would object to aggression or escape, you give up the fight and don’t struggle. The Alpha pauses, puzzled, before giving the closest thing to a shrug $npc1.he can give and opening wide. $npc1.He eases $npc1.his jaws over your head, rolling onto $npc1.his backside, carefully pushing you into $npc1.his maw, tilting $npc1.his head back and swallowing you over, burping in quiet satisfaction and rubbing $npc1.his middle, pleasantly surprised at the lack of resistance $npc1.his latest quarry gave. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="309" name="Trying to escape the feast" tags="nobr" position="4300,1025" size="100,100">&lt;&lt;set $eventCounterA -= $str&gt;&gt;

/*Still in the feast*/

&lt;&lt;if $eventCounterA &gt; 0&gt;&gt;
	&lt;p&gt;You struggle against the the thick wooden tendrils of the chair. 
&lt;&lt;if $eventCounterA &lt; 80&gt;&gt;
	They give slightly but you still can&#39;t quite break free. 
&lt;&lt;/if&gt;&gt;
&lt;/p&gt;

&lt;p&gt;You turn your head away and clench your mouth shut as the fork drunkenly tries to jab the juicy hunk of turkey in your mouth. The knife jabs you in the gut again, almost hard enough to draw blood, and you yelp in pain. The fork seizes this opportunity to cram the whole hunk of turkey in your mouth. You reflexively close your mouth as another explosion of rich savory flavor hits your tastebuds. The fork hovers around your throat menacingly, clearly threatening you into swallowing. 
&lt;/p&gt;

&lt;p&gt;After weighing your options for a short while, you&#39;re overcome by the deliciousness and swallow hard, sending the massive hunk of bird down your throat, stretching it out painfully. 
&lt;&lt;consume 8 4&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
Seemingly pleased with this, the knife zooms off again and struggles to pick up a one inch thick slab of steak. The knife flys off to join him. 
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Trying to escape the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;surrender&quot; &quot;Wait&quot; &quot;Wait at the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sto &gt;= 500&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;devour&quot; &quot;Devour the feast&quot; &quot;Devour the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
Your stomach stretches around it as well and you realize you&#39;ve reached your limit. Your stomach is stuffed absolutely full and you&#39;re having trouble staying conscious. Your cutlery captors are unmoved by your bloated groans of protest. Once again the fork wobbles into view, carrying another large chunk of food. Your eyes drift shut even as the fork crams more food in your mouth. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Defeated by the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Escaping the feast*/
&lt;&lt;else&gt;&gt;
You struggle against your bonds and manage to break free from your wooden captor, sending splinters flying in the air. You decide haste is the better part of valor and make a hasty exit from the forest clearing. The knife begins to follow you, the fork trailing behind while still wielding a huge hunk of food. They don&#39;t follow you far though before they dejectedly make their way back to their table. 

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="310" name="Wait at the feast" tags="" position="4175,1025" size="100,100">&lt;p&gt;You watch as the forks and knives dance about the table, clinking and clattering against the plates as they cut, carve, and lift. Bite sized portions of food are pushed into your $p.mouth as you wait, your limbs passive in their wooden restraints. &lt;/p&gt;
&lt;&lt;set _eat = random(25,35)&gt;&gt;
&lt;&lt;set _calories = _eat * 0.5&gt;&gt;
&lt;&lt;consume _eat _calories&gt;&gt;
&lt;&lt;set $eventCounterB -= _eat&gt;&gt;

&lt;&lt;if !$alive&gt;&gt;
&lt;p&gt;You don&#39;t resist the floating cutlery, even as they bring flesh slabs of steak, and dripping cups of water to your mouth, even as your belly swells out across your lap, even as the restraints dig harshly into your swelling limbs. Even as the darkness of unconsciousness creeps across your vision, the last thing you are aware of before the void takes you is a ladlefull of stew being poured into your mouth. &lt;/p&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Defeated by the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;elseif $eventCounterB &gt; 0&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Trying to escape the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;surrender&quot; &quot;Wait&quot; &quot;Wait at the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sto &gt;= 500&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;devour&quot; &quot;Devour the feast&quot; &quot;Devour the feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;Finally, as you let loose one last resonant belch, the cutlery falls to the denuded plates, their magic as spent as your stomach is filled. &lt;/p&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="311" name="Wake up in the storeroom" tags="" position="5000,1525" size="100,100">&lt;p&gt;&lt;&lt;rest&gt;&gt;
&lt;&lt;stuffToBursting&gt;&gt;
An hour later you groggily wake up. As you blink the sleep from your eyes you begin to notice the room swaying back and forth slightly. You also swiftly notice how tremendously overstuffed your gut feels. &lt;/p&gt;

&lt;p&gt;You look down at your $waist stomach and it&#39;s even larger than you remembered it being before you passed out. Finally reminded of your recent predicament, you snap your head around to figure out what happened. The sudden movement causes the room to sway even more as you finally realize you&#39;ve hanging from the store room rafters by your feet. Your vision finally clears and focuses in on your captor grinning evilly at you. &lt;/p&gt;

&lt;p&gt;&quot;Well, nice to see ya&#39;ll finally woken up!&quot; $npc1.he says in a mock jovial tone. &quot;I&#39;ve just been takin&#39; the liberty of helpin&#39; you enjoy my //bounteous// provisions. I hope you don&#39;t mind.&quot; $npc1.He motions to a now significantly emptier store room, and the source of your extremely swollen gut is now much less of a mystery. You attempt to shout at $npc1.him but your attempts are muffled by a gag in your mouth. &lt;/p&gt;

&lt;p&gt;&quot;Oh, no need to thank me.&quot; $npc1.he laughs darkly and rubs your swollen gut, &quot;I&#39;m just doin&#39; my part to help a fellow food connoisseur out. Speakin&#39; o&#39; which, if your appetite is quite satisfied, I think it&#39;s about time I have my supper.&quot; &lt;/p&gt;

With that, the $npc1.species opens $npc1.his jaws wider than you would have thought possible as $npc1.he engulfs your head and begins swallowing you down. $npc1.He stops only for a moment at your bulging gut before finally swallowing you down whole, your vision fading to black as $npc1.he does so. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="312" name="Wolf pack" tags="" position="4200,1825" size="100,100">&lt;&lt;setPassageTitle &quot;&lt;&lt;=setup.getSpeciesData(&#39;wolf&#39;).species.toUpperFirst()&gt;&gt; pack&quot;&gt;&gt;
&lt;p&gt;While making your way through the forest, you begin to notice a lot more noise around you than normal. Looking through the overgrowth, you can see a pack of $wolf.plural walking through the forest. You quickly hide behind a tree as best you can, waiting for the pack to pass. &lt;/p&gt;

You peek out, seeing if they’re gone, and can see that their massive, dragging bellies have made a small pathway through the growth, leading somewhere. 

&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Hide from the $wolf.plural&quot; &quot;Hide from wolves&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;next&quot; &quot;Follow the $wolf.plural&quot; &quot;Follow wolves&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="313" name="Approach Gingerbread House" tags="" position="3775,1275" size="100,100">You find a small cottage that appears to be made entirely of... candy and gingerbread? One corner of the house appears to have been heavily chewed on. The house does look quite delicious.

&lt;&lt;action &quot;s&quot; &quot;building&quot; &quot;Go Inside&quot; &quot;Enter Gingerbread House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat some house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;forest&quot; &quot;Leave&quot; &quot;Leave Gingerbread house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="314" name="Captured by the witch" tags="" position="3775,900" size="100,100">&lt;&lt;sleep&gt;&gt;
&lt;&lt;if $hea &gt; 0&gt;&gt;&lt;&lt;set $alive = true&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;p&gt;You groggily wake up and try to wipe the sleep from your eyes but only manage to whack yourself in the head with something cold and metallic. You snap awake and look around you. You see that you&#39;re sitting in what looks like an oversized wrought iron birdcage suspended from a ceiling in a basement. Your wrists are locked in manacles attached to the top of the cage and your mouth is gagged. 

&lt;&lt;if setup.waistDiameter() &gt; 24&gt;&gt;Your belly is so large it pushes hard against the bars of the cage and oozes around them. 
&lt;&lt;elseif setup.waistDiameter() &gt; 20&gt;&gt;Your belly is so large it pushes solidly against the bars of the cage. 
&lt;&lt;elseif setup.waistDiameter() &gt; 16&gt;&gt;Your belly is large enough that it brushes against the cage bars.
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;p&gt;You smell the unmistakable and powerful scent of gingerbread and realize you must be in the basement of the gingerbread house. Looking to your right theres another cage with a corpulent $npc2.species in it, but $npc2.he&#39;s sleeping like a rock. You hear footsteps coming down the stairs as a hunched over $npc1.species witch enters the basement. &lt;/p&gt;

&lt;p&gt;&quot;How&#39;s my fat little piggy doing, hmmmm?&quot; $npc1.he asks in a high pitched voice. $npc1.He walks up to you and grabs your gut and jiggles it roughly. &quot;My my, you&#39;re practically skin and bones! I&#39;ll just have to fatten you up!&quot; You try to say something, but you can only mumble through the gag in your mouth. &lt;/p&gt;

&lt;p&gt;&quot;What&#39;s that? You&#39;re starving?&quot; the witch asks with mock concern. &quot;How about some cake?&quot; The witch holds out $npc1.his other hand and in a sparkling swirl of magic, a large white cake apears in $npc1.his hand. A slice of it levitates up in the air and floats towards your face. &lt;/p&gt;

&lt;p&gt;&quot;Now open wide.&quot; The gag in your mouth mysteriously falls away and before you can say anything, the entire slice of cake crams itself into your mouth. You reflexively try to chew through it and find yourself overwhelmed by the sweet rich flavors. You eventually chew up the massive mouthful of food down and manage to swallow. You gaze longingly at the remaining cake, practically hypnotized. &lt;/p&gt;

&lt;p&gt;&quot;Ready for seconds?&quot; the witch asks sarcastically. You can only nod emphatically as your eyes remain locked on the cake, your tongue lolling from your mouth. The witch laughs cruelly as another huge slice of cake floats into your eagerly waiting mouth. You chomp it down as though you haven&#39;t eaten in days and swallow the entire wedge. You open your mouth wide, wordlessly begging for the next slice as your eyes remain transfixed on the mesmerizing cake. The witch cackles again and obliges you by levitating another slice into your mouth. $npc1.He repeats this process several times, each time you swallow it down and open your mouth, desperate for more. 
&lt;&lt;consume 10 5&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;The feeding continues&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Fully stuffed&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="315" name="Eat some house" tags="" position="3900,1150" size="100,100">&lt;p&gt;You decide a house made of gingerbread is too good a meal to pass up and start tearing hunks off a wall and cramming them in your mouth. It&#39;s just about the sweetest and most delicious thing you&#39;ve ever tasted, you can hardly believe how good it is. You can only think of eating more.
&lt;&lt;consume 4 2&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Keep eating&quot; &quot;Eat some more house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;next&quot; &quot;Stop eating the house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
That last bite proves too much for your stomach to handle though and you lie down on your back, falling into an overstuffed stupor. Even as you fall asleep you try to cram more gingerbread into your mouth. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="316" name="Eat some more house" tags="" position="4025,1150" size="100,100">&lt;p&gt;You tear off a huge chunk of wall and dip it in gobs of exposed icing before stuffing it down your throat. You just can&#39;t seem to help yourself, it tastes //sooooo// good!
&lt;&lt;consume 5 2.5&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Keep eating&quot; &quot;Eat some more house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;next&quot; &quot;Stop eating the house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
That last bite proves too much for your stomach to handle though and you lie down on your back, falling into an overstuffed stupor. Even as you fall asleep you try to cram more gingerbread into your mouth. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="317" name="Eat the food" tags="" position="3650,1025" size="100,100">&lt;p&gt;You sit down on the peppermint kitchen chair, noting that you stick to it slightly. You pick up the peppermint untensils and start thinking this place&#39;s decor is a little too silly. Shrugging your shoulders, you cut yourself out a large slice of cake. When you raise the piece of cake to your lips and take your first taste, your mind spins with the sensation of the richest moistest sweetest confection you&#39;ve ever eaten. &lt;/p&gt;

After a brief pause in amazement that something could taste so good, you begin shoveling cake into your mouth as fast as you can. As you swallow down the last of the slice of cake you even chomp down the eating utensils. 
&lt;&lt;consume 4 2&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Keep eating&quot; &quot;Keep eating cookies&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;no&quot; &quot;Get up&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
The last bite proves to much for your overtaxed stomach to handle however and you lean back in your chair and slowly drift off to sleep. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="318" name="Enter Gingerbread House" tags="" position="3775,1150" size="100,100">&lt;p&gt;You $walk into the living room and it&#39;s furnished entirely with junk food. Gingerbread is used as though it were wood and everything appears to be held together with icing and peppermint for support. &lt;/p&gt;

&lt;p&gt;You see a set of stairs going up to a door and a doorway that leads to the kitchen. &lt;/p&gt;

&lt;&lt;action &quot;n&quot; &quot;up&quot; &quot;Go upstairs&quot; &quot;Upstairs Ginger Bread&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;door&quot; &quot;Kitchen&quot; &quot;Gingerbread Kitchen&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="319" name="Escape the house" tags="nobr" position="3525,1400" size="100,100">&lt;&lt;set $eventCounterA -= $str&gt;&gt;
&lt;&lt;set $eventCounterB +=1&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 1&gt;&gt;
With $npc2.his arm over your shoulder, you both start slowly making your way up the stairs. The entire time $npc2.he&#39;s still cramming cake into $npc2.his mouth. 
&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Escape the house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 2&gt;&gt;
It&#39;s slow going but you finally get to the kitchen. As you pass by the kitchen table $npc2.he tosses the cake over $npc2.his shoulder and picks up the plate of cookies and starts eating those. 
&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Escape the house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 3&gt;&gt;
You make slow progress hauling your living boulder into the living room. As you pass through the kitchen door way, $npc2.he tosses the last few cookies behind $npc2.him and tears off a piece of the doorway and starts chowing down. 
&lt;br&gt;
&quot;I don&#39;t //wheeze// think I can //pant// eat much more before I pass out again. //sigh// All this food is making my stomach //gulp// hurt.&quot; Surely enough, whenever $npc2.his stomach bumps into you, you can feel it&#39;s stuffed tight as a balloon, even under the layers of fat. You better get this $npc2.guy out of here before $npc2.he explodes. 
&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Escape the house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 4&gt;&gt;
&lt;&lt;if $eventCounterA &lt;= 0&gt;&gt;
With a final triumphant burst of speed, you haul your porcine $npc2.species through the front door and outside, although $npc2.his belly almost doesn&#39;t fit through the door. You both quickly jog down the hillside, your combined momentum almost too much to stop at the bottom. You travel a little further into the woods and out of sight of the gingerbread house. Finally out of the reach of the houses power, the $npc2.species tosses the last bit of gingerbread to the ground in disgust. 
&lt;br&gt;&lt;br&gt;

&quot;//Urrrrp// Oh, thank you so much! I don&#39;t think I would have survived another day in there.&quot; $npc2.He rubs $npc2.his overstretched stomach in an attempt to console it. &quot;I think I can make it back from here, I don&#39;t live far. I don&#39;t want to burden you any more, you should go. I just... need a moment to rest. And here, take this. It&#39;s all I have on me. You deserve it.&quot; $npc2.He reaches into pants you couldn&#39;t even tell $npc2.he was wearing and pulls out a small bag of coins from $npc2.his pocket. $npc2.He tosses it on the ground and with that, $npc2.he passes out in a food coma. 
&lt;br&gt;&lt;br&gt;

As you backtrack to look at the gingerbread house, you see only a barren hill with no sign of the mysterious structure that once stood there. Without much else to do, you travel back into the woods.
&lt;&lt;doXP 20&gt;&gt;
&lt;&lt;doGld 25&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
Just as you make it to the front door and make your triumphant escape, your heart sinks as the door flies open and a lemon meringue pie flies in, hitting your $npc2.species compatriot in the face. Against $npc2.his will, $npc2.he swallows most of the pie down as the pie plate slides off $npc2.his face and hits the floor. $npc2.He slowly licks the meringue off of $npc2.his muzzle and with a loud //grooaaaaan// $npc2.his arm slips off of your shoulder as $npc2.he rubs $npc2.his bloated gut. Without your support, $npc2.he falls over into a candy cane chair, causing the chair legs to crack slightly and send off shards of candy. With a final moan $npc2.he passes out into a food coma as $npc2.he rubs $npc2.his stomach. Apparently that final pie was too much for $npc2.his stomach to handle. 
&lt;br&gt;&lt;br&gt;

Some of the meringue splattered onto your face when $npc2.he got hit with the pie. Reflexively you lick it off as a scrawny old witch walks into the room. 
&lt;br&gt;&lt;br&gt;

&quot;Did you enjoy my pie eh? Hee hee hee!&quot; You smack your lips and before you can answer your mind reels with the sweet explosion of flavor from just that tiny dab of meringue. You start trying to lick as much of the meringue off your face that you can reach before you finally shake yourself out of it, not wanting to end up like your overstuffed comatose friend. &quot;There&#39;s so much more where that came from my pet, let me show you!&quot; 
&lt;br&gt;&lt;br&gt;

It appears you have a fight on your hands.

/*&lt;&lt;setEnemy $gingerbreadWitch&gt;&gt;*/
&lt;&lt;set $e.special = &quot;yes captive&quot;&gt;&gt;
&lt;&lt;startCombat&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="320" name="Fully stuffed" tags="" position="3775,775" size="100,100">&quot;Are you all nice and full, hmmm?&quot; You pause and nod slowly. &quot;Do you have a tummy ache?&quot; You let out a small belch and nod your head slowly again. &quot;Well I&#39;ll just rub your belly and see if that makes it feel better.&quot; $npc1.He grabs your belly and starts squishing and rubbing it all over. You feel a gurgling and roiling sensation in your stomach. As you look down you see your bulging stomach shrink as your body slowly but steadily inflates with fat. 
&lt;&lt;digest 1440&gt;&gt;
&lt;br&gt;&lt;br&gt;

&quot;There, now that&#39;s how a growing piglet should look! Feel better now?&quot; You simply nod and open your mouth again. &quot;Ah ah ah, I think you&#39;ve had enough little piggy, now it&#39;s time I&#39;ve had my dinner.&quot; $npc1.He waves $npc1.his hand and the bottom of the cage flops open, dropping you hard onto your ass. Before you can recover, the floor surrounding you turns pitch black. The witch&#39;s $npc1.hands glow with dark energy as $npc1.he rubs $npc1.his stomach. Slowly you begin to sink into the floor. You stare blankly at your erstwhile caretaker and watch as $npc1.his stomach swiftly balloons outwards as you slowly sink into the floor. $npc1.His robes are quickly stretched to their limit and start tearing down the sides. 
&lt;br&gt;&lt;br&gt;

As your head slowly sinks through the floor, the witch falls back on $npc1.his ass with $npc1.his belly towering over $npc1.him. Finally you&#39;re fully transported into the witches stomach and you vision slowly fades to black. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="321" name="Get up" tags="" position="3650,900" size="100,100">You attempt to stand up but find yourself stuck to the candy chair. You put your hands on the armrests to try and pull yourself up, but only manage to get your $p.hands stuck as well. Looking up you see the cake and cookies floating in the air of their own accord. 
&lt;br&gt;&lt;br&gt;

Your mouth hangs agape in surprise and a cookie launches itself into your mouth. You cough and choke it down and find yourself opening your mouth without you thinking about it. A hunk of cake tears free from the rest of itself and similarly flings itself into your waiting jaws. You chew this down as well and once again your mouth hangs open of it&#39;s own accord. 
&lt;&lt;consume 6 3&gt;&gt;
&lt;br&gt;&lt;br&gt;

Cake and cookies alternate cramming themselves into your mouth and no matter how full you get you find yourself opening your mouth for more. 
&lt;&lt;stuffToBursting&gt;&gt;

Your stomach is finally stretched to it&#39;s limits and as you start to lose consciousness a particularly large hunk of cake floats up and crams itself into your mouth. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="322" name="Gingerbread Cellar" tags="" position="3650,1275" size="100,100">You throw caution to the wind and open the cellar door and $walk down the stairs. As you go down you notice that the candy bulding motif finally ends as you enter a regular dirt basement. 
&lt;br&gt;&lt;br&gt;

When you reach the bottom of the stairs you are quite surprised to find an incredibly fat $npc2.species stuffing cake into $npc2.his face. What makes it particularly surprising is that said $npc2.species is locked up in what looks like an oversized iron birdcage suspended from the ceiling. The $npc2.species is so rotund that $npc2.his belly is pushing hard against the cage bars. You wonder how someone in such a state could keep on eating. The $npc2.species picks up a hunk of cake from a table placed next to $npc2.his cage and reluctantly crams it into $npc2.his mouth before $npc2.he notices you. 
&lt;br&gt;&lt;br&gt;

&quot;Hemf ooh!&quot; $npc2.he attempts to say as $npc2.he forces $npc2.himself to swallow the mouthful of cake. &quot;Could you please help me out of here!?&quot; $npc2.he quickly shouts before cramming yet another handful of cake into $npc2.his mouth.

@@#activity;@@
&lt;hr&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;link &quot;Why are you here?&quot;&gt;&gt;
	&lt;&lt;replace #activity&gt;&gt;

	&quot;I was exploring the forest a couple days ago and I came across this bizzare house.&quot; $npc2.He picks up a cookie from next to $npc2.him and starts eating it, &quot;//mmf// So, not one to waste an opportunity, I start eating the side of the house.&quot; $npc2.He picks up a glass of chocolate milk and chugs some of it down. &quot;//gulp// Well it just tasted so good I couldn&#39;t stop eating it. I tried to leave but I just felt like I had to keep eating. Eventually I ate so much I passed out with a massive stomach ache,&quot; $npc2.he says as $npc2.he sticks $npc2.his paw into a tub of icing and starts licking it off, &quot;//smack// and when I woke up, I was locked in here.&quot;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;

&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;link &quot;Why are you still eating?&quot;&gt;&gt;
	&lt;&lt;replace #activity&gt;&gt;
	
	&quot;There&#39;s something weird about the food here. Once you start eating it, you just can&#39;t stop.&quot; $npc2.He reluctantly picks up a wad of cotton candy and stuffs the whole handful into $npc2.his mouth. &quot;//smacksmack// When I woke up in this cage, this witch is standing there in front of me and stuffs some more gingerbread in my mouth and ever since then I&#39;ve felt compelled to just keep eating.&quot; True to $npc2.his word, $npc2.he picks up a caraffe of chocolate syrup and pours it down $npc2.his throat. &quot;//glug// I just wake up, eat until I&#39;m too stuffed and bloated to stay awake, pass out, and wake up to a table full of food again. I&#39;ve grown even fatter and made more room in my stomach to stuff myself even more.&quot; $npc2.He picks up a handful of jelly beans and tosses them all into $npc2.his mouth. &quot;//gulp// I&#39;ve been full to bursting with candy for //days// now. I think that witch is fattening me up to eat me! So are you gonna help me out of here?&quot; 
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;


&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;\&quot;Sure, I&#39;ll help you out.\&quot;&quot; &quot;Help captive escape&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;\&quot;I should probably go...\&quot;&quot; &quot;Leave captive behind&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="323" name="Gingerbread House" tags="" position="3775,1400" size="200,100">As you adventure through the forest, you come upon a building in a small clearing ahead.

&lt;&lt;action &quot;c&quot; &quot;building&quot; &quot;Approach&quot; &quot;Approach Gingerbread House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;forest&quot; &quot;Leave&quot; &quot;Leave Gingerbread house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
/* FIXES AND EDITS - moved the set enemy to here so all paths will have access to the random npc&#39;s data */
&lt;&lt;setEnemy $gingerbreadWitch&gt;&gt;</tw-passagedata><tw-passagedata pid="324" name="Gingerbread Kitchen" tags="" position="3650,1150" size="100,100">&lt;p&gt;You $walk into the kitchen and find it, of course, made of candy. The countertops are made of peppermint which seems like it would get really sticky if you tried to actually cook anything in here. Although this place doesn&#39;t seem to have much need for logic. &lt;/p&gt;

There&#39;s a door that has a gingerbread sign. The sign says, &quot;CELLAR: Do Not Enter!&quot; written in white frosting, which makes it pretty hard to take seriously. There&#39;s also a large cake and a plate of cookies sitting on the kitchen table, the only thing you&#39;ve found in this house which seems to actually be meant as food instead of building material. 

&lt;&lt;action &quot;n&quot; &quot;down&quot; &quot;Gingerbread Cellar&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Eat the food&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;door&quot; &quot;Living Room&quot; &quot;Enter Gingerbread House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true and setup.questStarted($feeder_questWitchSpice) and setup.questCompleted($feeder_questWitchSpice) == false &gt;&gt;
	&lt;&lt;action &quot;s&quot; &quot;inventory&quot; &quot;Search the Cupboards&quot; &quot;Search the Cupboards&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */</tw-passagedata><tw-passagedata pid="325" name="Help captive escape" tags="" position="3525,1275" size="100,100">&lt;p&gt;&quot;Great! There&#39;s a key on the wall over there, and please hurry. I don&#39;t know when $npc1.he&#39;ll be back.&quot; $npc2.He points to a keyring on the wall with one $npc2.hand as the other stuffs a hunk of cake into $npc2.his mouth. You quickly run over and get the key and come back to unlock the cage. The bottom swings up and the $npc2.species falls on the ground and rolls to $npc2.his back. $npc2.He tries to roll over and get up, but $npc2.his stomach is pinning $npc2.him to the ground. &lt;/p&gt;

&quot;Erm, sorry, a little help here? I wasn&#39;t nearly this heavy last time I was walking around.&quot; You $walk over, and with a lot of grunting and wheezing you finally pull $npc2.him up to stand wobbily on $npc2.his feet. &quot;Alright, let&#39;s get out of here.&quot; Even as $npc2.he&#39;s saying that $npc2.he picks up the plate of cake and continues stuffing $npc2.himself.

&lt;&lt;set $eventCounterA = random(80,160)&gt;&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Escape the house&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="326" name="Jump out the window" tags="" position="4025,1025" size="100,100">In a panic, you jump out the spun glass window and land harshly on the ground outside. You hurt yourself, but at least you escaped.
&lt;hr&gt;
&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="327" name="Keep eating cake" tags="" position="3650,775" size="100,100">You look over to the pristine white cake. Your mouth waters and you pick up handfuls of cake in both hands and shovel them into your mouth. 
&lt;&lt;consume 4 2&gt;&gt;
After you finish off the hunk of cake, you look up and see that the plate is once again heaped to overflowing with cookies. 

&lt;&lt;if $alive&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Keep eating&quot; &quot;Keep eating cookies&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;no&quot; &quot;Get up&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
The last bite proves to much for your overtaxed stomach to handle however and you lean back in your chair and slowly drift off to sleep. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="328" name="Keep eating cookies" tags="" position="3525,1025" size="100,100">You look over to the heaping plate of chocolate chip cookies. Your mouth waters and you pick up cookies in both hands and shovel them into your mouth. 
&lt;&lt;consume 4 2&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Keep eating&quot; &quot;Keep eating cake&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;no&quot; &quot;Get up&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
The last bite proves to much for your overtaxed stomach to handle however and you lean back in your chair and slowly drift off to sleep. 
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="329" name="Leave Gingerbread house" tags="" position="3900,1275" size="100,100">You decide to leave other people&#39;s property alone and head back into the forest.

&lt;&lt;include &quot;forest randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="330" name="Leave captive behind" tags="" position="3650,1400" size="100,100">&lt;&lt;set _grandma = &quot;grandma&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;male&quot;&gt;&gt;
	&lt;&lt;set _grandma = &quot;grandpa&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;Not wanting to get involved with this mess. You leave the captive $npc2.species to continue stuffing $npc2.his face. Between mouthfuls of food $npc2.he pleads with you for help. As you come through the cellar door you are hit square in the face with a lemon meringue pie. Reflexively, you lick up as much of the sweet insides as you can and swallow it down. You almost black out from the intense lemony flavors and the only thing keeping you up is the desire to eat more of this insanely delicious pie. You&#39;re about to pick the fallen pie plate off of the floor when your eyes meet with those of the scrawny old witch standing in front of you. &lt;/p&gt;

&lt;p&gt;&quot;Rootin&#39; around in &#39;ol _grandma&#39;s cellar eh? If you were hungry you should have just asked.&quot; You stare at $npc1.him in a daze before you shake yourself free from whatever sway that pie held over you. &quot;There&#39;s plenty here to eat, why don&#39;t you let dear old _grandma fix you a twelve course dinner hmmm? Hee hee hee hee!&quot; It appears you have a fight on your hands. 
&lt;/p&gt;

/*&lt;&lt;setEnemy $gingerbreadWitch&gt;&gt;*/
&lt;&lt;set $e.special = &quot;no captive&quot;&gt;&gt;
&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="331" name="Read the book" tags="" position="3900,1025" size="100,100">&lt;p&gt;You start looking through the book. Most of it is written in strange symbols beyond your comprehension, but you can definitely tell this book has something to do with magic. The last few pages are written as a diary though. It seems that whoever lives here is capturing people and fattening them up to devour them. Something about absorbing people as a natural source of magical energy, and the bigger they are, the more power you get. &lt;/p&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled == true&gt;&gt;
	&lt;&lt;if setup.hasItem($feeder_witchDiaryNotes) == -1&gt;&gt;
		&lt;p&gt;Since you&#39;ve already gone so far as to snoop through someone&#39;s diary, you figure stealing some research on top of that can&#39;t be much worse, right? You quickly copy down some passages that look like they might be of use to you, even if you can&#39;t immediately make sense of it at the moment.&lt;/p&gt;
		&lt;&lt;getItem $feeder_witchDiaryNotes&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */

&lt;p&gt;As you scan over the last few pages you hear the front door open and the sound of footsteps. &lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;run&quot; &quot;Run&quot; &quot;Run into the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;forest&quot; &quot;Jump out the window&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="332" name="Run into the witch" tags="" position="3900,900" size="100,100">You make a break for the bedroom door, but before you can reach it someone else busts in. You run almost headlong into a scrawny $npc1.man dressed in shabby dark purple and black robes with a floppy black hat. 
&lt;br&gt;&lt;br&gt;

&quot;Well, looks like some oaf has been sticking their nose where it doesn&#39;t belong. And I was just preparing for dinner too, hee hee hee.&quot; 
&lt;br&gt;&lt;br&gt;

It looks like if you want to escape you&#39;ll have to fight your way out.
&lt;hr&gt;
&lt;&lt;setEnemy $gingerbreadWitch&gt;&gt;
&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="333" name="Stop eating the house" tags="" position="4025,1275" size="100,100">&lt;p&gt;You decide you&#39;ve eaten enough and start to get up to leave, but after taking a step away from the house you find your eyes uncontrollaby drawn back. You immediately dive back to the house and start cramming hunks of gingerbread and icing into your mouth with manic vigor. &lt;/p&gt;

&lt;p&gt;You&#39;ve just lost complete control of yourself and you madly try to stuff as much of this delicious house into your face as possible. Your stomach groans and gurgles as it is crammed to it&#39;s bursting point with rich chewy gingerbread. &lt;/p&gt;

&lt;p&gt;Eventually you&#39;re too full too stay awake, but that doesn&#39;t stop you from still trying to eat the house, even as you drift off to sleep. 
&lt;&lt;stuffToBursting&gt;&gt;&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the witch&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="334" name="The feeding continues" tags="" position="3900,775" size="100,100">&lt;p&gt;As you swallow down the last bite, the witch walks up and squeezes your belly between $npc1.his $npc1.hands once again. 

&lt;&lt;if $ful &gt; 120&gt;&gt;
	Your belly squishes in, but just barely. 
&lt;&lt;elseif $ful &gt; 110&gt;&gt;
	Your belly squishes in a bit, but not much. 
&lt;&lt;else&gt;&gt;
	Your belly squishes in quite a bit. 
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;p&gt;&quot;Well you&#39;re quite the bottomless pit, aren&#39;t you dear?&quot; You just nod absent mindedly, your mouth hanging open for more. &quot;Well we&#39;ll just have to see if we can fill you up!&quot; In an austentatious flash of sparkles, a glass jug full of chocolate appears above your head. You tilt your head back and open your jaws wide as the huge jug of chocolate syrup tips over and starts dumping hug blobs of chocolate syrup down your throat. &lt;/p&gt;

&lt;p&gt;Your stomach slowly swells outward as gallons of chocolate pour down your gullet. The witch squishes your belly as it expands, waiting until you reach the proper fullness.
&lt;&lt;stuffToBursting&gt;&gt;
Satisfied that you&#39;ve reached your absolute limit, the witch stops pouring the chocolate syrup and rubs your incredibly bloated stomach. 

&lt;&lt;if setup.waistDiameter() &gt; 24&gt;&gt;Your belly is so large it pushes hard against the bars of the cage and oozes around them. 
&lt;&lt;elseif setup.waistDiameter() &gt; 20&gt;&gt;Your belly is so large it pushes solidly against the bars of the cage. 
&lt;&lt;elseif setup.waistDiameter() &gt; 16&gt;&gt;Your belly is large enough that it brushes against the cage bars.
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Fully stuffed&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="335" name="Upstairs Ginger Bread" tags="" position="3775,1025" size="100,100">&lt;p&gt;You $walk up the stairs and through the door at the top. Inside you find a bedroom built with a continuing candy motif. The bedsheets are even made of cotton candy. You can&#39;t imagine this is a comfortable place to live, in spite of its deliciousness. &lt;/p&gt;

&lt;p&gt;You see a book left open on a desk in the corner. The book looks to be the only thing not made of candy here.&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Read the book&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;down&quot; &quot;Go back downstairs&quot; &quot;Enter Gingerbread House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="336" name="Abandon wildling captive" tags="" position="2500,3050" size="100,100">&lt;p&gt;&quot;Huh? No, wait!&quot; the &lt;&lt;if $lion.species == $npc2.species&gt;&gt;lardball
&lt;&lt;elseif $rhino.species == $npc2.species&gt;&gt;rotund
&lt;&lt;else&gt;&gt;humungous&lt;&lt;/if&gt;&gt; $npc2.species  pleads desperately, &quot;Y-you can&#39;t just LEAVE me like this! Grugh...&quot; $npc2.He stifles a burp, and you watch with horror as $npc2.he balloons a little larger right in front of you, that huge stomach swelling outwards by a couple of inches. You start to back away. &quot;Help me, damnit, $npc1.he could be back at any moment!&quot; &lt;/p&gt;

Not wanting to get involved in this crazy situation, you turn and run. You can hear the $npc2.species calling after you, and catch a glimpse of $npc2.him over your shoulder. But when you turn your head back to look where you&#39;re going you&#39;re stopped dead- standing right in front of you is a wilding shaman! 
&lt;&lt;setEnemy $wildlingShamanBoss&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="337" name="Break the captive out yourself" tags="nobr" position="2400,3250" size="100,100">&lt;&lt;stamina -100&gt;&gt;
&lt;&lt;set _playerSkill = $str * 2&gt;&gt;
&lt;&lt;switch setup.skillTest(_playerSkill,30)&gt;&gt;

&lt;&lt;case false&gt;&gt;
&lt;p&gt;You circle the stockade, but you can&#39;t see any sign of a gate. How did they get $npc2.him IN there? Inspecting the posts more closely, you can&#39;t help but notice that they&#39;re surrounded by a faint blue glow. This barrier may not be entirely hand-made in nature. Oh well....
&lt;/p&gt;
		
&lt;p&gt;Cracking your knuckles, you grab hold of one of the thick wooden stakes and you haul on it, first trying to lift it out of the ground, then trying to twist it free, then trying to topple it, eventually hanging off it with all your weight. But although the post creaks and flexes slightly, you&#39;re not able to break down the barrier. This wood&#39;s stronger than iron! You back up with a groan, panting and rubbing your aching back. You look up at the bloated $npc2.species, and $npc2.he shrugs. 
&lt;/p&gt;
		
&lt;p&gt;&quot;Any OTHER ideas?&quot;&lt;/p&gt; 
	
&lt;&lt;case true&gt;&gt;
&lt;&lt;set $eventCounterA.freed = true&gt;&gt;

&lt;p&gt;You circle the stockade, but you can&#39;t see any sign of a gate. How did they get $npc2.him IN there? Inspecting the posts more closely, you can&#39;t help but notice that they&#39;re surrounded by a faint blue glow. This barrier may not be entirely hand-made in nature. Oh well... Spitting on your hands, you grab hold of one of the thick wooden stakes surrounding the overblown captive and HAUL with all your might. You are rewarded with the post creaking alarmingly, and slowly tilting in its socket until it suddenly flips free with a great spray of earth! 
&lt;/p&gt;

&lt;p&gt;Your $npc2.species friend splutters in protest as $npc2.he&#39;s showered, but you move on to the next post. One, two, three... TIMBERRR! With another colossal effort you manage to rend another stake from the ground, and now have (just) enough room to squeeze between them! Now able to really put your back into it, you set to work toppling first one heavily-embedded post, then the next, then the next! By the time you&#39;ve removed enough for your corpulent compadre to get out, you&#39;re sweating buckets and going weak in the knees. You stagger away from the gap, and sit down heavily. Phew... you just need... a breather for a few moments. The &lt;&lt;if $lion.species == $npc2.species&gt;&gt;ludicrously large 
&lt;&lt;elseif $rhino.species == $npc2.species&gt;&gt;ridiculously round
&lt;&lt;else&gt;&gt;humungously hefty&lt;&lt;/if&gt;&gt; $npc2.species squirms through the gap in $npc2.his prison, finally breaking free of its embrace with an almost audible POP. &lt;/p&gt;

&lt;p&gt;&quot;Phew! Am I glad to be OUT of there! Now what?!&quot;&lt;/p&gt; 

&lt;&lt;/switch&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="338" name="Captured by wildlings" tags="nobr" position="2000,2925" size="100,100">/*Beginning of setup*/
&lt;&lt;rest&gt;&gt;
&lt;&lt;consumeQuiet 15 8&gt;&gt;

/*Create second npc based on who you were fighting*/
/*&lt;&lt;setNPC 2&gt;&gt;*/
&lt;&lt;createNPC $e.species $e.gender 2&gt;&gt;/* FIXES AND EDITS - adjust for new system */

/*Create random first NPC. I set it up this way in the original game
I should probably change it*/
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;
/*End of setup*/

&lt;p&gt;You wake up laying on your back and looking up at the sky. Your head throbs with pain&lt;&lt;if $ful &gt; 100&gt;&gt; as well as your stomach&lt;&lt;/if&gt;&gt;. You lean up and rub your head as you notice your stomach has gotten somewhat fuller than it was before you were knocked unconscious. 
&lt;/p&gt;

&lt;p&gt;You see the $npc2.species you were fighting before having an argument with another much fatter $npc1.species wildling. Their language is unkown to you, and yet you somehow can vaguely understand what they&#39;re saying. They seem to be arguing about the fat one not bringing something. The main thing you can tell is the one you were fighting before is angrily gesticulating at you while the fat one seems to be responding defensively. The skinnier wildling says something in an annoyed tone to the fatter $npc1.species and they both head off into the tall grass as their argument continues. 
&lt;/p&gt;

/*If you&#39;ve basically exploded*/
&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
You start to get up, but as your headache subsides you finally realize how painfully overstuffed you are. You lay back on the ground again with a thud and rub your aching stomach. The wildlings hear you fall back to the ground and turn back towards you. The fatter wildling punches the other one in the shoulder and says something to $npc2.him with a distinctive //&quot;I told you so&quot;// tone. The other one just rolls $npc2.his eyes as they walk up next to you. The $npc2.species you were fighting says something dismissive back to $npc1.him before sauntering over to you and roughly planting $npc2.his $npc2.foot onto your overfed gut. The rough jolt to your gut is too much for you to withstand and you once again pass out. 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Stuffed by the wildlings&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you&#39;re too big to move*/
&lt;&lt;elseif setup.testImmobile()&gt;&gt;
You roll back and forth in an attempt to stand, but find your $waist is so heavy it anchors you to the ground. The wildlings notice you trying to get up and start walking back towards you. The fatter wildling punches the other one in the shoulder and says something to $npc2.him with a distinctive //&quot;I told you so&quot;// tone. The other one just rolls $npc2.his eyes as they walk up next to you. The $npc2.species you were fighting says something dismissive back to $npc1.him before once again whacking you over the head, knocking you unconscious once again. 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Stuffed by the wildlings&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you&#39;re fully able to escape*/
&lt;&lt;else&gt;&gt;
You finally regain your wits enough to stand up, but you wobble on your feet and stumble to your knees, as you&#39;re still woozy and light-headed from the blow to your head. By the time you&#39;ve regained your senses, they&#39;ve already disappeared completely into the grass. 
&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="339" name="Carried to the Wildling Village" tags="nobr" position="2000,3125" size="100,100">&lt;&lt;createFixedNPC &quot;wildlingDragon&quot;&gt;&gt;
&lt;&lt;createNPC $blackDragon &quot;random&quot; 3&gt;&gt; /* only in slot 3 rather than 3 because I&#39;d already written most of the edits with them in slot 3 before realising they should be a random NPC :p */

&lt;p&gt;When you regain consciousness you&#39;re kneeling on the ground, your stomach no larger than it was before although your $p.hands are still tied in front of you. A fat $npc3.species of approximately &lt;&lt;sayWeight 600&gt;&gt; stands in front of you dressed in a robe of mulitcolored cloths, thickly studded with a mismatch of expensive jewelry and trinkets. $npc3.He addresses someone next to you and you look up to see the wildlings that captured you standing with their hands on your shoulder, holding you down. The bejeweled $npc3.species says something to them in an impressed tone before writing something down on a clipboard $npc3.he&#39;s carrying. The wildlings at your shoulders nod appreciatively back to $npc3.him before walking off with grins on their faces. &lt;/p&gt;

&lt;p&gt;As you look back at them you finally notice that all around you there&#39;s a large village of huts with several wildlings milling about their business. It&#39;s hard to tell from where you&#39;re sitting, but the village looks to be almost as large as the city. Before you can study the village too intently your attention is drawn back to the heavy set $npc3.species as $npc3.he addresses you. &lt;/p&gt;

&lt;p&gt;&quot;You&#39;ll make quite a good offering, eh $p.species?&quot; $npc3.he says perfectly well in your common language as $npc3.he pokes you in the gut with $npc3.his quill pen. $npc3.He motions to two similarly heavy set, though much more muscular $npc3.species guards that come over and pick you up to your feet. The jeweled $npc3.species steps aside to reveal the monumentally large creature behind $npc3.him. &lt;/p&gt;

A crater larger than most houses is filled entirely by the tremendous nonanthro $npc1.furBack $npc1.furred $npc1.species sleeping within. The $npc1.species is a rippling sea of shining $npc1.furBack $npc1.fur, $npc1.his arms and legs so swaddled in fat as to render them useless, and even with the crater being at least &lt;&lt;sayDistance 144&gt;&gt; deep at the center, the $npc1.species&#39;s voluminous waist causes the $npc1.species&#39;s back to stick up another &lt;&lt;sayDistance 144&gt;&gt; above ground level. The $npc1.species is made of so many thick rolls of fat as to render $npc1.him an almost spherical ball of lard. Around the edges of the crater there are several furs with buckets of blue goo that appear to be massaging huge globs of it into the $npc1.species&#39;s belly $npc1.fur. Several other furs are dredging dirt out of the crater and adding it to the wall of dirt surrounding it, apparently attempting to make the pit deeper for the expanding $npc1.species. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Fed to the grasslands dragon&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="340" name="Dispel the captive" tags="nobr" position="2200,3150" size="100,100">&lt;&lt;if $mana &lt; $antidote1.cost&gt;&gt;
&lt;p&gt;You attempt to cast the spell... and nothing comes out. &lt;/p&gt;

It seems you&#39;re low on mana....
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;

&lt;&lt;set $eventCounterA.dispelsLeft--&gt;&gt;
&lt;&lt;spendMana $antidote1.cost&gt;&gt;

&lt;&lt;switch $eventCounterA.dispelsLeft&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;p&gt;The $npc2.species is bathed in a soft blue light. A strange gurgle emanates from $npc2.his gargantuan belly, and $npc2.he puts one fat $npc2.hand to it, grunting. &lt;/p&gt;

&quot;Uff, that felt like it did SOMETHING...&quot; $npc2.His stomach then lets out a more ominous rumble, and a smothered burp catches $npc2.him by surprise. $npc2.He starts to get even rounder! &quot;B-but I guess it wasn&#39;t strong enough! Q-quick, can you cast it again?&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
										
&lt;&lt;case 1&gt;&gt;
&lt;p&gt;With a wave of your arms the blue light returns, and the $npc2.species&#39;s current growth spurt falters. The faint eldritch glow around the stockade (a far less pretty blue) seems to flicker for a moment. &lt;/p&gt;

&quot;I think it&#39;s working!&quot; $npc2.he exclaims, only for the blue light to fade abruptly, and the weight resumes piling on. A new chin begins to form under $npc2.his jaw. &quot;Mphh! M-maybe third time&#39;s the charm?!&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&lt;&lt;set $eventCounterA.dispelled = true&gt;&gt;
&lt;p&gt;You cast the spell for a third time, and this time the $npc2.species&#39;s stomach lets out a deep, subterranean GURGLE that makes $npc2.him quiver! The light around the wooden posts flares abruptly, and then snuffs out. The $npc2.species&#39;s throat quivers, and $npc2.he stifles a rather loud BELCH with $npc2.his fat $npc2.hand, looking anxious. Only this time, glowing blue smoke curls out of $npc2.his nostrils. After a few tense moments where $npc2.he DOESN&#39;T start to grow, $npc2.he lets out a deep breath of relief, puffing more blue smoke out. 
&lt;/p&gt;

&quot;Whew! Talk about INDIGESTION! That was some magic, thanks! Now what?&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="341" name="Escape with wildling captive" tags="nobr" position="2300,3400" size="200,100">&lt;&lt;set $e.runnable = false&gt;&gt;

&lt;&lt;set $enemyDescription = &quot;You face the wilding shaman, as skinny and dark as a shadow at noon, with ritualistic markings across the hatchet-like planes of $npc1.his chiselled canine features and adorned with a full ceremonial headdress and robe. Scrawny and completely unarmed, carrying only an old wooden flute,  you still feel the skin crawl on the back of your neck when those eyes fix on you. $npc1.He does not look happy to see you making off with $npc1.his captive. Sacrilige! And with your fat friend to think of, you&#39;ve no chance of running. Besides which, $npc2.he&#39;s basically blocking the only other path out. You&#39;ll have to stand and fight!&quot; &gt;&gt;

&lt;&lt;set $e.special = &quot;captive&quot;&gt;&gt;

/*If you dispelled the captive*/
&lt;&lt;if $eventCounterA.dispelled&gt;&gt;
&lt;p&gt;You turn on your heel and run, the gigantic $npc2.species waddling right behind you! For someone who&#39;s stomach is practically dragging on the ground, $npc2.he can really MOVE! While you&#39;re pushing aside tall stands of grass, $npc2.he&#39;s ploughing a channel that several people abreast could walk down. The thudding of $npc2.his lumbering $npc2.feet makes the ground shake and knocks fruit off distant trees. You&#39;ve just got to hope that nobody comes looking for you both! &lt;/p&gt;

&lt;p&gt;Eventually, however, you&#39;re well out of sight of the stockade, with absolutely no signs of pursuit. It looks like you&#39;ve both got away with it! The vast &lt;&lt;if $lion.species == $npc2.species&gt;&gt;feline
&lt;&lt;else&gt;&gt;pachyderm&lt;&lt;/if&gt;&gt; doughball stops to rest, leaning against a tree for support as $npc2.he pants. &lt;/p&gt;

&lt;p&gt;&quot;Wow, thanks for rescuing me! I really thought I was a gonner! Any longer in that and I&#39;d have been too big to even move, let alone escape! I owe you, &#39;&#39;BIG&#39;&#39;-time!&quot; With a loud crack the tree suddenly lurches under $npc2.his weight, leaving $npc2.him wobbling unsteadily. $npc2.He grabs hold of what $npc2.he can reach of $npc2.his enormous belly and jiggles it, wincing. &quot;Though how I&#39;m gonna shed some of &#39;&#39;THIS&#39;&#39; I just don&#39;t know!&quot; &lt;/p&gt;

&lt;p&gt;&quot;I lost most of my gear back there-&quot; you don&#39;t offer to go and retrieve it, and $npc2.he doesn&#39;t look surprised. &quot;I don&#39;t even have the clothes I stand up in! But...&quot; $npc2.he reaches up, with difficulty, around $npc2.his neck and fumbles with something, &quot;...I can offer you THIS as a reward!&quot; &lt;/p&gt;

&lt;p&gt;With a final tug, a cord hidden beneath $npc2.his juicy chins comes loose and out drops a money pouch and a shining pendant, resting between the twin mounds of $npc2.his vast chest. $npc2.He picks them up and tosses them to you. The money pouch is satisfyingly heavy, while the pendent glints in in the palm of your $p.hand. You realise that it&#39;s a genuine gem! &lt;/p&gt;

&lt;&lt;set _reward = random(34,47)&gt;&gt;
&lt;&lt;doGld _reward&gt;&gt;
&lt;&lt;getItem $unidentifiedGem&gt;&gt;&lt;br&gt;

&lt;p&gt;Just at that moment, the grossly-obese $npc2.species&#39;s stomach growls ravenously at $npc2.him. &quot;Thanks again, $p.buddy! Now I&#39;ve really got to go. There&#39;s gotta be &#39;&#39;SOMETHING&#39;&#39; to eat around here...&quot; And with that, you watch the colossal ex-captive waddle away into the grasslands. &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you didn&#39;t dispel the captive*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;You turn on your heel and run, the gigantic $npc2.species waddling right behind you! But after a few lumbering paces you hear an ominous gastric gurgling, and turn to see that your fat friend has faltered, hands clutching at $npc2.his mammoth middle. $npc2.He huffs and tries to pick up speed, but hesitates. &lt;/p&gt;

&lt;p&gt;&quot;I think...&quot; $npc2.he pants anxiously, &quot;I... th-think...&quot; the gurgling intensifies, and $npc2.his eyes widen. &quot;Oh, NOOO-urrp!&quot; The belch catches $npc2.him by surprise, and $npc2.he clamps one $npc2.hand over $npc2.his mouth in horror. Too late- already you can see $npc2.his spectacularly superfattened bulk beginning to swell. &lt;/p&gt;

&lt;p&gt;&quot;W-well don&#39;t just STAND there,&quot; the $npc2.species bellows, lumbering back into motion, &quot;K-keep... huff... Keep g-GOING!&quot; $npc2.He gets up to a slow, savannah-shaking jog, but with each step $npc2.he takes you can see $npc2.his stance widening as more and more subcutaneous blubber weighs $npc2.him down, $npc2.his legs having to swing around more and more stomach. $npc2.His pace quickly slows until $npc2.he&#39;s at a slow lumber, sloshing and wobbling unsteadily from foot to foot, belly swaying enormously in front of $npc2.him, ploughing a furrow in the knee-high grass. &lt;/p&gt;

&lt;p&gt;&quot;K-keep... going,&quot; $npc2.he pleads with himself, panting with the effort. &quot;C&#39;mon... huff, huff... k-keep... huff... oorf!&quot; As you watch, the undercarriage of $npc2.his now-mountainous middle hits solid earth, bounces, then begins to drag steadily. The outrageously obese $npc2.species lets out a groan and presses forward doggedly, but within a few more paces is piling up on top of $npc2.his own gut! $npc2.He grinds to a halt, completely immobile and beached atop $npc2.his own belly. $npc2.He struggles and wriggles, panting and sweating, then $npc2.he looks down at you and $npc2.his eyes widen in horror. &lt;/p&gt;

&lt;p&gt;&quot;Oh, //noooo//....&quot; It&#39;s only then that you realise $npc2.he&#39;s not looking AT you, but at something BEHIND you. You slowly turn, to find yourself facing what can only be the wilding shaman who put $npc2.him in that stockade in the first place. &lt;/p&gt;

&lt;&lt;startCombat&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="342" name="Feasting on the fruit farm" tags="nobr" position="2950,3125" size="100,100">&lt;p&gt;&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 1&gt;&gt;
The orange oozes its distinctly sweet juice in your $p.mouth as you take a big bite. Even the peel is tasty, and surprisingly edible. 
&lt;&lt;consume 5 2&gt;&gt;

&lt;&lt;case 2&gt;&gt;
This peach crunches softly, its juice dribbling down your face as you eat it. 
&lt;&lt;consume 5 2&gt;&gt;

&lt;&lt;case 3&gt;&gt;
The tremendous raspberry provides only slight resistance as you sink your $teeth into its sweet flesh. 
&lt;&lt;consume 4 1&gt;&gt;

&lt;&lt;case 4&gt;&gt;
Your mouth and fingers stain with juice as you eat delicious and gigantic blueberry, your stomach becoming similarly shaped. 
&lt;&lt;consume 4 1&gt;&gt;

&lt;&lt;case 5&gt;&gt;
The tiny seeds provide a small bit of hardness, but the sweetness of this massive strawberry is undeniable. 
&lt;&lt;consume 4 1&gt;&gt;

&lt;&lt;case 6&gt;&gt;
Once you get past the outer shell, the meat of the enormous pumpkin fills your $p.mouth, stomach, and mind with the delicious Fall season. 
&lt;&lt;consume 6 2&gt;&gt;

&lt;&lt;case 7&gt;&gt;
You get a massive chunk of watermelon and set to work getting a sticky $p.mouth and fingers and making a small mountain of spat-out seeds. 
&lt;&lt;consume 6 2&gt;&gt;

&lt;&lt;case 8&gt;&gt;
You just manage to fit one grape into your $p.mouth as you eat it straight off the vine. It doesn&#39;t get fresher than that, or more delicious. 
&lt;&lt;consume 4 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;&lt;/p&gt;

/*Use up one of your attempts*/
&lt;&lt;set $eventCounterA--&gt;&gt;

/*Checks to see if you can still eat*/
&lt;&lt;if $alive and $eventCounterA &gt; 0&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;food&quot; &quot;Orange&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;food&quot; &quot;Peach&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 2&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;food&quot; &quot;Raspberry&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 3&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;food&quot; &quot;Blueberry&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 4&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;food&quot; &quot;Strawberry&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;food&quot; &quot;Pumpkin&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 6&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;food&quot; &quot;Watermelon&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 7&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;food&quot; &quot;Grape&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 8&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the fruit field&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Checks to see if you ran out of time*/
&lt;&lt;elseif $alive and $eventCounterA &lt;= 0&gt;&gt;
&lt;p&gt;You catch a glimpse of the shack, and spot the door open. A short, slightly rotund $npc1.species of some sort emerges, draped in snappy wizardly finery and capped with a feathered cap. $npc1.He idly manipulates a magical wand in one hand as $npc1.he walks intently towards you. &lt;/p&gt;

&lt;&lt;action &quot;w&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Wait for the lizard wizard&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;run&quot; &quot;Run!&quot; &quot;Run from the lizard wizard&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Checks to see if you overate*/
&lt;&lt;elseif !$alive&gt;&gt;
&lt;p&gt;As you swallow the last bite, you come to the unfortunate conclusion that you overdid it, and slump against one of the nearby trees, slowly sinking to the ground and groaning as you rub your enormously stuffed belly. As you steadily lose the ability to move from the pressure in your stomach, you just catch the shack&#39;s door opening out of the corner of your eyes. A short, round $npc1.species in magical finery and sporting a feathered cap is marching towards you, a wicked grin showing &lt;&lt;if $npc1.teeth == &quot;sharp teeth&quot;&gt;&gt;$npc1.his sharp-toothed smile&lt;&lt;else&gt;&gt;on $npc1.his $npc1.mouth&lt;&lt;/if&gt;&gt; as $npc1.he approaches. The distinct feeling of the fruit drawing close to you comes up again, but now it&#39;s less welcoming, and more enclosing. Even if you could move, you doubt you could escape, though with the world going dark, that possibility is nothing but a happy thought... &lt;/p&gt;

&lt;p&gt;With your will to fight sapped to nothing, you are left at the mercy of a wizard that you have wronged. While there are concievably worse situations to be in, this is certainly near the top of the list, and the wide grin on the $npc1.species&#39;s face shows that $npc1.he means to prove it. &quot;You wanted to eat my fruit?&quot; $npc1.He taunts, $npc1.his plants wrapping around you and lowering you to your knees. &quot;Well, you&#39;re going to have to eat a whole lot of it if you&#39;re going to be of use around here,&quot; $npc1.he continues, tapping your head with $npc1.his wand, then poking it into your belly. Though the pressure inside it seems to lessen, your helplessness does not fade, and the plants begin to feed you their fruit. &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Filled with fruit&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
							
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="343" name="Fed to the grasslands dragon" tags="" position="2000,3225" size="100,100">&lt;&lt;setPassageTitle &quot;Fed to the grasslands $npc1.species&quot;&gt;&gt;

&lt;p&gt;The guards that pulled you to your feet start pulling you towards the crater and on to a wood platform that overhangs it. One of the guards pounds $npc3.his spear on the platform twice and the $npc1.species opens $npc1.his eyes and pulls tremendous head up on the end of $npc1.his thick fat neck. The large $npc1.species looks down at you with a look of disgust before slowly shifting $npc1.his gaze up to the two quards and giving them the same look. One of the guards gestures widely from you to the $npc1.species and speaks in a loud reverent tone with a large smile on $npc3.his face. &lt;/p&gt;

The $npc1.species seems to give a bored sigh before dutifully lowering $npc1.his head to the edge of the platform, $npc1.his head dwarfing both you and the guards. The $npc1.species opens $npc1.his jaws wide and before you can react the guards heave you into the $npc1.species&#39;s waiting maw. $npc1.He swallows you down as you barely make a bulge in $npc1.his tremendous fleshy neck, sending you down a long trip to $npc1.his gargantuan stomach. 

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="344" name="Feed the wildling captive" tags="nobr" position="2300,3250" size="100,100">&lt;&lt;set _food = &quot;&quot;&gt;&gt;
&lt;&lt;for _i = 0; _i &lt;$inventory.length; _i++&gt;&gt;
	&lt;&lt;if $inventory[_i].effect == &quot;Eat&quot;&gt;&gt;
		&lt;&lt;set _food = $inventory[_i]&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;removeItem _food&gt;&gt;
&lt;&lt;set $eventCounterA.feedsLeft--&gt;&gt;

&lt;&lt;switch $eventCounterA.feedsLeft&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;p&gt;The supersized $npc2.species blinks incredulously as you proffer _food.article _food.name. &quot;Huh? Are you crazy? I&#39;m as big as a whale and you think I should take a SNACK break?&quot; Nevertheless at the sight of food makes $npc2.his mouth water, and that gargantuan gut lets out a hungry rumble. &quot;Well... I g-guess TECHNICALLY I&#39;ve not eaten in two days...&quot; &lt;/p&gt;

&lt;p&gt;$npc2.He greedily stuffs the _food.name into $npc2.his $npc2.mouth, chubby cheeks wobbling heavily as $npc2.he chews. Whether it&#39;s the effect of the spell on $npc2.him, or $npc2.he just puts on weight REALLY easily, as $npc2.he gulps the grub down the $npc2.species&#39;s belly gurgles and bulges bigger! You step back slightly, and watch that gargantuan gut swell until it presses firmly against the posts in front of $npc2.him. The $npc2.species wipes $npc2.his mouth and belches, and then $npc2.his ears wilt as $npc2.he notices $npc2.his gain. &quot;Aww... shucks!&quot; &lt;/p&gt;

&lt;&lt;case 1&gt;&gt;
&lt;p&gt;&quot;What, MORE?&quot; The increasingly-spherical $npc2.species stares at you in disbelief as you proffer the _food.name. Look at me! I&#39;m as big as a HOUSE, and you&#39;re offering me MORE?&quot; But as you hold out the tempting treat, $npc2.his nostrils twitch and $npc2.he licks $npc2.his lips nervously. That bottomless-pit of a belly rumbles at $npc2.him hungrily. &quot;I... I REALLY shouldn&#39;t...&quot; $npc2.his willpower caves in almost immediately, and $npc2.he grabs the _food.name from you, chomping into it. In a couple of big bites it&#39;s gone, and with another gurgle the $npc2.species balloons even bigger. &lt;/p&gt;

&lt;p&gt;As $npc2.he swells, $npc2.his stomach begins to press hard against the posts of the stockade. They tremble, and a low creak emerges from them. The $npc2.species&#39;s expansion stops with another burp, and $npc2.he groans uncomfortably. &quot;Thanks... thanks a BUNCH! Now I can... hardly BREATHE in here!&quot; &lt;/p&gt;

&lt;&lt;case 0&gt;&gt;
&lt;&lt;set $eventCounterA.freed = true&gt;&gt;
&lt;p&gt;The mountainous $npc2.species stares at the _food.name in your $p.hand, starting to pant. The enormous creature&#39;s arms are now stuck right out, and $npc2.he resembles a $npc2.furBack $npc2.furred wrecking ball. &quot;You&#39;re... you&#39;re as crazy as that THING is. If I eat... one more bite I&#39;m... I&#39;m gonna &#39;&#39;POP&#39;&#39;!&quot; That treacherous blob of a belly rumbles loudly over the creaking of the wooden posts, making $npc2.him grimace and sweat. &quot;I... gotta... EAT! Gimme that!&quot; $npc2.He chows down on the _food.name almost before it&#39;s left your $p.hand. $npc2.He swallows, and grows even larger, steamrollering over the stakes and toppling them. A couple even snap with a concussive CRACK from the pressure they&#39;re under, getting buried under that massively overfed middle. The now truly enormous $npc2.species BURPS and seems to wake up from $npc2.his food daze, looking around in astonishment. &lt;/p&gt;

&lt;p&gt;&quot;Wha...?&quot; With an immense effort, $npc2.he slowly hauls $npc2.himself to $npc2.his feet in the wreckage of the enclosure, wobbling unsteadily, belly almost dragging on the ground in front of $npc2.him. $npc2.He gives you a fat-faced, sweaty grin, and pants. &quot;Ok, I&#39;ll admit it- you DO know what you&#39;re doing.&quot; $npc2.He hefts as much of $npc2.his gargantuan belly as $npc2.he can with both $npc2.hands, and grimaces. &quot;But you&#39;re paying for my fitness classes. Now what?!&quot; &lt;/p&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="345" name="Filled with fruit" tags="nobr" position="2900,3250" size="100,100">&lt;p&gt;&lt;&lt;stuffToBursting&gt;&gt;
You can only watch as your belly stretches bigger and bigger, an endless stream of delicious flavors parading into your mouth. Against your desire and better judgement, you find yourself slowly chewing and swallowing down enormous fruit after enormous fruit. &lt;/p&gt;

&lt;p&gt;Oranges, pears, grapes, apples, watermelon, all of it is swallowed down as you are stuffed to the brim, and pushed beyond it again and again. It seems to last for days, all the while the little $npc1.species is laughing softly and playing with your oversized belly like it was $npc1.his own personal plaything. 
&lt;&lt;consume 80 0&gt;&gt;&lt;/p&gt;

&lt;p&gt;At length, your jaw stops moving, your body seeming to be unable to take anymore and simply halting entirely. You should have burst what seems like a few hundred gigantic feedings ago, but your tremendous gut rests on the ground now. &lt;/p&gt;

&lt;p&gt;Giving it a scrutinizing look and letting out an appraising hum, the $npc1.species pats it, and declares, &quot;That&#39;ll do, I think.&quot; Gently, $npc1.he places $npc1.his wand on your head. &quot;Now I&#39;m going to be nice and let you sleep. Take a good rest, for your bulk will be serving me well...&quot; &lt;/p&gt;

Your consciousness slowly fades, and your body begins to feel stiff. Where you touch the ground, you seem to sink into it, and as your vision goes dark, the last thing you see is your skin turning to bark and a leafy growth sprouting from it. 

&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="346" name="Fruit farm" tags="" position="2825,2750" size="100,100">&lt;&lt;createFixedNPC &quot;lizardWizard&quot;&gt;&gt;

&lt;p&gt;As you wander about, you chance upon a small, but curious farm. There are a mixture of bushes, trees, and vines, and all of them are sporting truly enormous and especially round fruits. 
&lt;/p&gt;

A bit away from the fields is a small, comfortable looking shack, most likely where the owner of the place is. The fruits are quite alluring, but the shack looks inviting for certain. 

&lt;&lt;action &quot;se&quot; &quot;fenceGate&quot; &quot;Fruit field&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;house&quot; &quot;Fruit shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave fruit farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="347" name="Fruit feast" tags="nobr" position="2950,3000" size="100,100">&lt;p&gt;You just can&#39;t resist; it all looks too good to leave alone. Even better, as you head into the field proper, all the fruit seems to draw towards you, pulling away from their respective branches, vines, and bushes, their peculiar magics making them easy and safe to pluck, as well as clean and ready for eating. &lt;/p&gt;

&lt;p&gt;&lt;&lt;if $eventCounterA &gt; 16&gt;&gt;
You try to find a secluded spot away from the shack so as to avoid detection by whoever set up the ward. 

&lt;&lt;elseif $eventCounterA &gt; 10&gt;&gt;
You&#39;re still a bit suspicious of that noise you thought you heard earlier, and look for an area slightly off the path to begin your feast. 

&lt;&lt;/if&gt;&gt;&lt;/p&gt;

You&#39;ve got your pick of the lot; what will you dig into?


&lt;&lt;action &quot;1&quot; &quot;food&quot; &quot;Orange&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;food&quot; &quot;Peach&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 2&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;food&quot; &quot;Raspberry&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 3&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;food&quot; &quot;Blueberry&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 4&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;food&quot; &quot;Strawberry&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;food&quot; &quot;Pumpkin&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 6&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;food&quot; &quot;Watermelon&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 7&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;food&quot; &quot;Grape&quot; &quot;Feasting on the fruit farm&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = 8&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the fruit field&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="348" name="Fruit field" tags="nobr" position="2950,2875" size="100,100">&lt;p&gt;As you approach, the sheer size of the fruits become even more impressively clear. Tree branches are hung low with apples and oranges the size of beachballs, bushes bear strawberries, raspberries, and blueberries that are fist-sized, and the vines hold pumpkins and watermelons that could be used as low-rent housing in a pinch. As if it wasn&#39;t obvious enough that something was peculiar with them, they visibly sparkle with magic. &lt;/p&gt;

&lt;p&gt;Clearly, this place belongs to someone both skilled with magic, and fond of fruits. 
&lt;&lt;set $eventCounterA = random(6,8)&gt;&gt;
&lt;&lt;if $int &gt; 70&gt;&gt;
	You can barely sense a very subtle, yet distinct vibration of magic hum and reach out towards the shack. You&#39;ve almost certainly just set off a magical ward, and odds are very good that whoever&#39;s in charge is about to know you&#39;re here. 
	&lt;&lt;set $eventCounterA = random(17,19)&gt;&gt;				
&lt;&lt;elseif $int &gt; 30&gt;&gt;
	You can almost hear what sounds like a soft humming noise, but as you look around you can&#39;t find the source of it. You think perhaps it was just your imagination. 
	&lt;&lt;set $eventCounterA = random(11,13)&gt;&gt;
&lt;&lt;else&gt;&gt;
	Your mouth is watering just looking at those sweet delectables. But with magic involved, it might be a bad idea to eat without permission. 
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;food&quot; &quot;Fruit feast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;house&quot; &quot;Fruit shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave fruit farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="349" name="Fruit shack" tags="" position="2825,2875" size="100,100">&lt;p&gt;Pulling your longing gaze away from the scrumptious looking fruits, you stalwartly approach the shack. The small windows offer a glimpse of a densly-packed magical apparati and accessories, tomes and calcinators sitting in gently glowing magical circles. Before you can even knock, the door swings open, and a short, round little $npc1.species stands before you, decked out in cloth finery and a feathered cap. &quot;Ah, a guest!&quot; $npc1.he says, $npc1.his voice dancing with whimsy. 
&lt;/p&gt;

&lt;p&gt;&quot;You&#39;re quite the lucky fellow to find this place. I was just going to be moving it in a few more minutes.&quot; 
&lt;/p&gt;

You let that last comment go, just accepting that you&#39;re dealing with the magically-inclined. With an exagerrated bow, $npc1.he continues to ask, &quot;What can a humble wielder of the arcane do for you on this fine day?&quot; 

&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;Trade with the Lizard Wizard&quot;&gt;&gt;
	&lt;&lt;vendor &quot;lizard wizard&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the Lizard Wizard&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="350" name="Get captive to break themselves out" tags="nobr" position="2500,3150" size="100,100">&lt;&lt;if $eventCounterA.fattened&gt;&gt;
&lt;p&gt;The huge $npc2.species looks thoughtful, and with a colossal effort hauls $npc2.himself to $npc2.his fat feet, paunch hanging way out in front of $npc2.him. &quot;Hey, this could work.&quot; $npc2.He hefts his gigantic gut experimentally in both hands, and grins. &quot;Yeah, I like this plan- let&#39;s USE this bulk! I&#39;m gonna TRAMPLE the sucker!&quot; 
&lt;/p&gt;

&lt;p&gt;$npc2.He stomps $npc2.his fat $npc2.feet like a sumo squaring up for a bout, then takes a couple of slow, lumbering steps forward. Almost immediately $npc2.his vast belly hits the stakes and squashes slowly, bringing $npc2.him to a halt. Puffing, $npc2.he tries backing up to give $npc2.himself a run up, but almost at once $npc2.his massive backside bumps against the stakes behind $npc2.him. &lt;/p&gt;

&lt;p&gt;$npc2.He growls with frustration. &quot;It&#39;s no good, I just don&#39;t have enough room to get any momentum! I&#39;m too &#39;&#39;FAT&#39;&#39;!&quot; &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;set $eventCounterA.freed = true&gt;&gt;

&lt;p&gt;The huge $npc2.species looks thoughtful, and with a colossal effort hauls $npc2.himself to $npc2.his fat $npc2.feet, paunch hanging way out in front of $npc2.him. &lt;/p&gt;

&lt;p&gt;&quot;Hey, this could work.&quot; $npc2.He hefts $npc2.his slightly-reduced-but-still-giant-sized gut experimentally in both $npc2.hands, and grins. &quot;Yeah, I like this plan- let&#39;s USE this bulk! I&#39;m gonna TRAMPLE the sucker!&quot; $npc2.He stomps $npc2.his fat $npc2.feet like a sumo squaring up for a bout, and charges at the stockade, starting slow but managing to reach a considerable lumber before $npc2.he crashes into the stakes, belly-first. $npc2.His hugely overblown body quivers from the impact, but then so do the stakes! Puffing, $npc2.he backs up determinedly, until $npc2.his backside is pressing hard against the posts behind $npc2.him, and charges again. &lt;/p&gt;

&lt;p&gt;&quot;GERONIMO!&quot; This time $npc2.he cannons into the already-loosened stakes with an almighty BUMP, and you watch $npc2.him literally roll over the barrier, three of the posts uprooting and getting pressed flat into the earth. Your $npc2.species buddy lays beached on $npc2.his spectacular stomach for a few moments, panting, before $npc2.he struggles to $npc2.his $npc2.feet again. &lt;/p&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="351" name="Give captive an antidote" tags="nobr" position="2200,3250" size="100,100">&lt;&lt;removeItem $antidotePotion&gt;&gt;
&lt;&lt;set $eventCounterA.dispelled = true&gt;&gt;
&lt;p&gt;The &lt;&lt;if $lion.species == $npc2.species&gt;&gt;fattened feline
&lt;&lt;elseif $rhino.species == $npc2.species&gt;&gt;rotund rhino
&lt;&lt;else&gt;&gt;hefty $npc2.species&lt;&lt;/if&gt;&gt; takes the potion from you and sniffs it suspiciously, before pulling a face. &lt;/p&gt;

&lt;p&gt;&quot;Urgh! Why&#39;d I want to drink CELERY-JUICE?&quot; Just then, $npc2.his stomach lets out another ominous gurgle and $npc2.his body begins to bulge once again. Very hurriedly $npc2.he chugs the contents on the flask, having trouble getting it too $npc2.his lips past $npc2.his bloated chest and chins. The gurgling in $npc2.his guts increases in intensity- it sounds like a war going on in there! $npc2.His expansion falters, quivers, and then subsides! $npc2.He lets out an enormous, relieved BURRRP, an eldritch blue mist hanging in the air above $npc2.him for a moment before dissipating. &lt;/p&gt;

&quot;Woah, does that feel BETTER!&quot; $npc2.He grins roundly at you and slaps $npc2.his stupendous stomach. &quot;Guess that takes care of my &#39;growth spurts&#39;! Now what?&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="352" name="Give the captive a diet pill" tags="nobr" position="2200,3050" size="100,100">&lt;&lt;removeItem $dietPill&gt;&gt;
&lt;&lt;set $eventCounterA.fattened = false&gt;&gt;
&lt;p&gt;The $npc2.species looks doubtfully at the blue pill you give $npc2.him. &quot;What, how is THIS supposed to help?&quot; With your encouragement $npc2.he shrugs and claps $npc2.his chubby hand to $npc2.his lips, gulping the pill down laboriously. $npc2.He shudders, making $npc2.his bulk wobble. &lt;/p&gt;

&quot;Ergh, I HATE taking pills. I... woah...&quot; $npc2.He puts both hands to $npc2.his overblown belly, and it gurgles. &quot;I... I feel funny...&quot; With another gurgle his middle begins to shrink. Over a few minutes he easily loses over 200lbs- ok, $npc2.he&#39;s hardly this year&#39;s &lt;&lt;if $npc2.male == &quot;male&quot;&gt;&gt;Mr. Hunkiverse&lt;&lt;else&gt;&gt;Ms. Beautiverse&lt;&lt;/if&gt;&gt; but $npc2.he&#39;s visibly slimmer than $npc2.he was! &quot;Heey...&quot; $npc2.he looks himself over, now able to move more freely, too. &quot;I gotta get me some more of THOSE!&quot; 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="353" name="Grasslands" tags="grasslands" position="2150,2450" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a comfortable spot to sit down and rest. 
	&lt;&lt;rest&gt;&gt;

	&lt;&lt;if random(1,5) == 1&gt;&gt;
		&lt;&lt;set _enemy = either($wildling, $wildlingRitualist, $wildlingShaman, $gorgedCheetah, $bloatedLion, $expandedElephant)&gt;&gt;
		&lt;&lt;setEnemy _enemy&gt;&gt;
		You are awoken from your sleep by $e.article $e.name! 
		&lt;&lt;startCombat&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	The grasslands are a large plain covered in tall grasses. The areas closer to the city are where most of the towns local farms are. The landscape is dotted by several copses of small trees and historically the grass would only come up to your shins. Lately though the grasslands have grown wilder and harder to traverse. Old footpaths have grown back over, in many places the grass grows as high as your waist, grazers have grown fatter and fatter as they keep up with the endless growing season, and the predators have become much more aggressive. There&#39;s tales of predators actively attacking and devouring people who venture too far into the grasslands. People have even reported seeing other furs out in the grasslands living like savages, as though they had returned to their primal roots. 
	&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="354" name="Grasslands ambush" tags="nobr" position="2050,2550" size="100,100">&lt;&lt;if $grasslandsEnemies == undefined 
	or $grasslandsEnemies.length == 0&gt;&gt;
	&lt;&lt;set $grasslandsEnemies = [&quot;wildling&quot;, &quot;ritualist&quot;, &quot;shaman&quot;, &quot;cheetah&quot;, &quot;cheetah&quot;, &quot;lion&quot;, &quot;lion&quot;, &quot;elephant&quot;, &quot;elephant&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $grasslandsEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;
	
&lt;&lt;case &quot;wildling&quot;&gt;&gt;
	&lt;&lt;setEnemy $wildling&gt;&gt;
	You&#39;re walking through the grasslands when suddenly someone &#39;&#39;bursts&#39;&#39; through the grass in front of you! You think it&#39;s a fellow adventurer at first, but their tattered clothing and aggressive demeanour make it clear they&#39;re not here to trade stories. The fact that $npc1.he&#39;s pointing a spear at you doesn&#39;t help much either.
	
&lt;&lt;case &quot;ritualist&quot;&gt;&gt;
	&lt;&lt;setEnemy $wildlingRitualist&gt;&gt;
	A splash of color is brought to your attention when a wildling jumps in front of you, a bag of food behind them at their disposal. 
	
&lt;&lt;case &quot;shaman&quot;&gt;&gt;
	&lt;&lt;setEnemy $wildlingShaman&gt;&gt;
	Walking out of the long grass, you come unexpectedly upon a $npc1.adjective figure standing with their back to you, staring into the distance. A ragged loincloth and blanket makes you think that this is a wilding, and you tense to defend yourself, but you relax slightly when you observe that $npc1.he carries no weapon, and not even any food. The only thing you can see is an old, gnarled staff and a small medicine-bag at their feet. The creature slowly turns to face you- soot black, hatchet-muzzled and quite the thinnest creature you’ve seen in a long time, $npc1.his face is decorated with tribal markings that even you can interpret. A shaman! Err... whoops! $npc1.He regards you with an inscrutable, hawk-like expression for a few moments, then $npc1.his weathered muzzle breaks slowly into a fathomless, predatory smile. This doesn’t look good...
	
&lt;&lt;case &quot;cheetah&quot;&gt;&gt;
	&lt;&lt;setEnemy $gorgedCheetah&gt;&gt;
	As you&#39;re walking through the tall grass, you suddenly hear the rapid gallop of $npc1.feet. As you turn towards the sound, a &lt;&lt;if $npc1.nspecies == &quot;cheetah&quot;&gt;&gt;four-legged spotted&lt;&lt;else&gt;&gt;bloated&lt;&lt;/if&gt;&gt; form awkwardly leaps out from the grass in front of you and awkwardly lands with a thud. The weight of it&#39;s clearly engorged stomach nearly pulls it over from the momentum, but it manages to awkwardly keep it&#39;s footing.
	
&lt;&lt;case &quot;lion&quot;&gt;&gt;
	&lt;&lt;setEnemy $bloatedLion&gt;&gt;
	As you walking through the tall grass, you hear a low growl coming from beside you. You turn to look as a perfectly camouflaged $npc1.species leaps out at you! Although they&#39;re pulled back to the ground several feet short of you, clearly weighed down by the bloated stomach hanging beneath them. 
	
&lt;&lt;case &quot;elephant&quot;&gt;&gt;
	&lt;&lt;setEnemy $expandedElephant&gt;&gt;
	You feel the ground shaking beneath you, making the grass around you sway sibilantly. Suddenly ahead of you out bursts a rampaging $npc1.nspecies! &lt;&lt;if $npc1.nspecies == &quot;elephant&quot;&gt;&gt;$npc1.He is quite possibly the roundest pachyderm you’ve ever seen, stomach swollen so much that that famously wrinkled hide is stretched completely taut and smooth. You notice that their trunk is curled around peculiarly purple fruit.&lt;&lt;else&gt;&gt;$npc1.He is quite possibly the roundest creature you’ve ever seen, stomach swollen so much that it looks like a perfectly smooth sphere of $npc1.fur. You notice that $npc1.he&#39;s clutching a peculiarly purple fruit in $npc1.his grip.&lt;&lt;/if&gt;&gt; As you watch, the $npc1.nspecies greedily stuffs it into $npc1.his mouth. The liberal purplish staining around $npc1.his lips suggests that they’ve already eaten far too many of those things. Even as that belly gurgles and stretches slightly larger before your very eyes, the highly elastic $npc1.nspecies advances ponderously towards you, eyes gleaming hungrily. It’s going to take more just than peanuts to fill &#39;&#39;THAT&#39;&#39; stomach now. In fact, it looks like $npc1.he thinks $npc1.he&#39;ll stretch enough to fit &#39;&#39;YOU&#39;&#39; in, as well! 
	
&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="355" name="Help wildling captive" tags="nobr" position="2300,3050" size="200,200">A look of relief crosses the $npc2.species&#39;s fat features, but $npc2.he&#39;s still apprehensive. $npc2.His ears swivel agitatedly. 

&lt;&lt;if !$eventCounterA.freed and !$eventCounterA.dispelled&gt;&gt;
&quot;You&#39;ve got to get me out of this cage, and you&#39;ve got to break this spell somehow! And &#39;&#39;HURRY&#39;&#39;, $npc1.he could come back at any time!&quot; You look blankly at $npc2.him, and $npc2.he stares back blankly at you. &quot;I&#39;ve got nothing. Any ideas?&quot; 

&lt;&lt;elseif $eventCounterA.freed and !$eventCounterA.dispelled&gt;&gt;
&quot;You&#39;ve got to break this spell somehow! And &#39;&#39;HURRY&#39;&#39;, $npc1.he could come back at any time!&quot; You look blankly at $npc2.him, and $npc2.he stares back blankly at you. &quot;I&#39;ve got nothing. Any ideas?&quot; 

&lt;&lt;elseif !$eventCounterA.freed and $eventCounterA.dispelled&gt;&gt;
&quot;You&#39;ve got to get me out of this cage! And &#39;&#39;HURRY&#39;&#39;, $npc1.he could come back at any time!&quot; You look blankly at $npc2.him, and $npc2.he stares back blankly at you. &quot;I&#39;ve got nothing. Any ideas?&quot; 

&lt;&lt;else&gt;&gt;
&quot;We&#39;ve got to get out of here! And &#39;&#39;HURRY&#39;&#39;, $npc1.he could come back at any time!&quot; 

&lt;&lt;/if&gt;&gt;
&lt;hr&gt;

/*Freeing the captive*/
&lt;&lt;if !$eventCounterA.freed&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;next&quot; &quot;I&#39;ll break you out&quot; &quot;Break the captive out yourself&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;2&quot; &quot;next&quot; &quot;Break yourself out&quot; &quot;Get captive to break themselves out&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;set _food = &quot;&quot;&gt;&gt;
&lt;&lt;for _i = 0; _i &lt;$inventory.length; _i++&gt;&gt;
	&lt;&lt;if $inventory[_i].effect == &quot;Eat&quot;&gt;&gt;
		&lt;&lt;set _food = $inventory[_i]&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;if _food != &quot;&quot;&gt;&gt;
	&lt;&lt;action &quot;3&quot; &quot;food&quot; &quot;Feed them&quot; &quot;Feed the wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $eventCounterA.fattened and setup.hasItem($dietPill) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;4&quot; &quot;next&quot; &quot;Give a diet pill&quot; &quot;Give the captive a diet pill&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Actions for dispelling captive*/
&lt;&lt;if !$eventCounterA.dispelled&gt;&gt;

&lt;&lt;if setup.hasSpell($antidote1) &gt;= 0&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;greyMagic&quot; &quot;Dispel the captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.hasItem($antidotePotion) &gt;= 0&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;next&quot; &quot;Give captive an antidote&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;if $eventCounterA.freed&gt;&gt;
	&lt;&lt;action &quot;7&quot; &quot;run&quot; &quot;Escape with them&quot; &quot;Escape with wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !$eventCounterA.freed&gt;&gt;
	&lt;&lt;action &quot;8&quot; &quot;leave&quot; &quot;Abandon them&quot; &quot;Abandon wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="356" name="Investigate the captive" tags="nobr" position="2350,2950" size="100,100">&lt;&lt;if $eventCounterB == &quot;&quot;&gt;&gt;
	&lt;p&gt;You head towards the thing, keeping cautiously to the long grass for cover. For a while whatever it is is completely obscured by a particularly dense and deep patch of grassland, but you finally break through into what looks like a clearing and stop dead, letting out a gasp of surprise. In front of you sits the biggest, fattest $npc2.species you&#39;ve ever seen in your life! You can really only recognise their species by the $npc2.furBack $npc2.fur and &lt;&lt;if $lion.species == $npc2.species and $npc2.male == &quot;male&quot;&gt;&gt;glossy mane
&lt;&lt;elseif $rhino.species == $npc2.species&gt;&gt;large horns
&lt;&lt;elseif $hippo.species == $npc2.species&gt;&gt;broad snout&lt;&lt;else&gt;&gt;few features that aren&#39;t wildly distorted by flab&lt;&lt;/if&gt;&gt; - otherwise $npc2.he&#39;s practically just a blob. &lt;/p&gt;

	&lt;p&gt;Wider than $npc2.he is tall, a staggeringly huge belly and chest wobbles gently in time with $npc2.his breathing, and $npc2.his lovehandles are enormously thick and chunky. $npc2.His chubby arms stick out from $npc2.his sides, unable to rest flat against the rotund curves of $npc2.his body. Around $npc2.him you notice a solid-looking ring of outward-pointing wooden stakes, each crudely carved with symbols. They stand at about shoulder height, a little too high to climb over, &#39;&#39;ESPECIALLY&#39;&#39; for one so... famine-resistant. It looks like this Big $npc2.Boy has been penned in for some reason. The front of that gut is barely inches from the stakes in front of $npc2.him, while $npc2.his juicy lovehandles are brushing those at $npc2.his sides whenever $npc2.he breathes in. Making a slow, fascinated circuit around this gargantuan $npc2.species, you see that likewise $npc2.his titanic tuckus is also pressing on the posts behind $npc2.him. Looking closer, you note the torn remnants of pale clothing on the ground around $npc2.him, along with the remains of some armour and possibly a weapon or two, now mostly submerged under $npc2.his rolling bulk. This $npc2.guy must be a fellow adventurer of some sort. &lt;/p&gt;

	&lt;p&gt;$npc2.His thick double chin resting in the dent between $npc2.his pillowy &lt;&lt;if $npc2.male == &quot;male&quot;&gt;&gt;pecs&lt;&lt;else&gt;&gt;breasts&lt;&lt;/if&gt;&gt;, $npc2.he looks to be in a light doze. But as you return to $npc2.his front side $npc2.he lets out a small snort and awakens. When $npc2.he sees you $npc2.his eyes widen and with some effort $npc2.he lifts $npc2.his fat $npc2.mouth from $npc2.his chest. &lt;/p&gt;


	&lt;p&gt;&quot;Hey, $p.buddy! Boy am I glad to see &#39;&#39;YOU&#39;&#39;! You&#39;ve gotta help me get outta here, before I &#39;&#39;BURST&#39;&#39;!&quot; &lt;/p&gt;
	
&lt;&lt;elseif $eventCounterB == &quot;burst?&quot;&gt;&gt;
	&lt;p&gt;&quot;I mean... nmphh...&quot; The &lt;&lt;if $lion.species == $npc2.species&gt;&gt;wideload&lt;&lt;elseif $rhino.species == $npc2.species&gt;&gt;rippling&lt;&lt;else&gt;&gt;hugely heavy&lt;&lt;/if&gt;&gt;	$npc2.species stifles a small burp, and your eyes widen as &lt;&lt;=$npc2.he.toUpperCase()&gt;&gt; does the same! That gargantuan gut bulges out a couple of inches further, some of the items scattered around $npc2.him being swallowed further by $npc2.his blubbery body. $npc2.His arms rise out a little more as they grow fatter, and $npc2.his sides stretch even more roundly. &lt;/p&gt;
	
	&lt;p&gt;&quot;I mean they&#39;ve put some kind of spell on me so that I&#39;ve spent the last two days blowing up like a ruddy &#39;&#39;BALLOON&#39;&#39;!&quot; $npc2.he roars. &quot;If I don&#39;t manage to get out of this, and fast, who knows how much bigger they&#39;re gonna make me! I can hardly move now! Much more of this and I&#39;m gonna &#39;&#39;POP&#39;&#39;! C&#39;mon, you&#39;ve gotta &#39;&#39;HELP&#39;&#39; me!&quot; &lt;/p&gt;
	
&lt;&lt;elseif $eventCounterB == &quot;why?&quot;&gt;&gt;
	&lt;p&gt;The &lt;&lt;if $lion.species == $npc2.species&gt;&gt;fatso feline&lt;&lt;else&gt;&gt;enormous pachyderm&lt;&lt;/if&gt;&gt; sighs and shakes $npc2.his head slightly. &quot;I was taking a shortcut through the grasslands when I stumbled into this creepy canine out in the middle of nowhere. $npc1.He was all skin and bones, had some kind of weird headdress on and was carrying some kind of old rattle.&quot; With effort, $npc2.he scratches $npc2.his head with a hamlike $npc2.hand. &quot;I don&#39;t really remember much else until I woke up in here,&quot; $npc2.he nods to the makeshift enclosure, &quot;with that... that thing standing in front of me! $npc1.He was playing some kind of pipe, but I couldn&#39;t hear anything. That was two days ago. And since then...&quot; $npc2.he slaps $npc2.his $npc2.hands against $npc2.his colossally corpulent body, which ripples heavily. &quot;I mean, I know I wasn&#39;t exactly SKINNY before all of this, b-but THIS is crazy! You&#39;ve gotta help me escape!&quot; &lt;/p&gt;
&lt;&lt;/if&gt;&gt;



&lt;&lt;action &quot;w&quot; &quot;talk&quot; &quot;\&quot;Why are you in there?\&quot;&quot; &quot;Investigate the captive&quot;&gt;&gt;&lt;&lt;set $eventCounterB = &quot;why?&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;talk&quot; &quot;\&quot;What do you mean, &#39;burst&#39;?\&quot;&quot; &quot;Investigate the captive&quot;&gt;&gt;&lt;&lt;set $eventCounterB = &quot;burst?&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;\&quot;I really shouldn&#39;t interfere\&quot;&quot; &quot;Abandon wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;\&quot;Sure, but how?\&quot;&quot; &quot;Help wildling captive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="357" name="Leave fruit farm" tags="" position="2950,2750" size="100,100">&lt;p&gt;You decide not to explore this place, the thought that none of those fruits grow in the same climates or conditions crossing your mind for a moment as you go back to wandering. 
&lt;/p&gt;

When you look back you see no sign of the farm, but catch a glimpse of a cart slowly pulling off into the distance. 
&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="358" name="Leave the Lizard Wizard" tags="" position="2700,3000" size="100,100">&lt;&lt;setPassageTitle &quot;Leave the $npc1.Species Wizard&quot;&gt;&gt;

You politely bid the $npc1.species fellow farewell, your curiosity satisfied. $npc1.He tilts $npc1.his head and gives a quizzical look as you walk away and return to your explorations. When you look back, the farm has vanished, and the only sign of the wizard is a cart rolling away towards the horizon. 

&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="359" name="Leave the captive alone" tags="" position="2450,2850" size="100,100">With a shrug you turn away from the distant shape and head in a different direction. In a few moments you turn your head and whatever-it-was is now lost from view. 

&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="360" name="Leave the fruit field" tags="" position="2825,3125" size="100,100">You pull yourself away from the delicious fruit and glance back at the shack. With no obvious activity, you decide it&#39;s safe enough and head out of there in a hurry, not wanting to face any repercussions. As you go, the fruits sag, seemingly sad that you&#39;re no longer there to eat them anymore. 

&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="361" name="Minor Grasslands events" tags="nobr" position="2050,2450" size="100,100">&lt;&lt;setPassageTitle &quot;A discovery?&quot;&gt;&gt;

&lt;&lt;switch random(1,4)&gt;&gt;

&lt;&lt;case 1&gt;&gt;
As you travel through the grasslands, you come across a bush bearing fruit. You reach and pick the only ripe looking fruit. 

&lt;&lt;if random(1,2) == 1&gt;&gt;&lt;&lt;getItem $grapes&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $strawberries&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;p&gt;As you travel through the grasslands you come across a wild watermelon patch with some of the largest watermelon you&#39;ve ever seen! Unfortunately you appear to have been beaten to them as there&#39;s several hollowed out melon husks laying around. Each one houses fat &lt;&lt;=setup.getSpeciesData(&quot;rabbit&quot;).plural&gt;&gt;, &lt;&lt;=setup.getSpeciesData(&quot;gopher&quot;).plural&gt;&gt;, and &lt;&lt;=setup.getSpeciesData(&quot;meerkat&quot;).plural&gt;&gt; and other tiny animals who&#39;re fast asleep with bulging sloshing stomachs, their fur stained red with watermelon juice. 
&lt;/p&gt;

There&#39;s only one untouched melon left. Even though it&#39;s the smallest of them all, it&#39;s still larger than most you&#39;ve seen. You bend down to pick it up. 

&lt;&lt;getItem $watermelon&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&lt;p&gt;As you travel through the thick grasslands, you notice out of the corner of your eye a small blue object on the ground. You walk over and bend down to inspect it and find a small blue fruit about the size of your thumb hanging from a single tiny stalk coming out of the ground. 
&lt;/p&gt;

You attempt to pick the fruit, but the stalk it&#39;s hanging from stretches surprisingly far before breaking away and snapping back to the ground. The tiny fruit remains in your hands and you squish it between your fingers, finding it to be surprisingly spongy. If you hadn&#39;t picked it from the ground yourself you might have thought it was a rubber ball. 

&lt;&lt;getItem $stretchFruit&gt;&gt;

&lt;&lt;case 4&gt;&gt;
&lt;&lt;createNPC setup.randomHerbivore() &quot;random&quot; 2&gt;&gt;

&lt;&lt;if random(1,2) == 1&gt;&gt;&lt;&lt;setEnemy $bloatedLion&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;setEnemy $gorgedCheetah&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;As you are $walking through the grasslands you hear the sounds of a struggle. You trudge through the thick grass towards the sounds and find a large clearing where the grass has been flattened from an ongoing battle. You find a $npc2.species adventurer already chest deep in the jaws of a $npc1.species on the far side of the clearing. The $npc2.species curses $npc2.his enemy before finally being swallowed whole. The $npc1.species&#39;s once slim waist swiftly balloons outward as $npc1.he tries very hard to swallow the struggling adventurer down. 
&lt;/p&gt;

&lt;p&gt;The $npc1.species&#39;s stomach now bulges out in a large taut sphere that practically drags on the ground. $npc1.He stops to pant from exhaustion for a moment as $npc1.his meal continues the struggle inside, causing $npc1.his already unwieldy stomach to sway back and forth underneath $npc1.him. Eventually the struggles calm down and the $npc1.species waddles off into the tall grass. $npc1.His enormous gut swaying from side to side, making it difficult to walk as $npc1.he disappears into the tall grass. 
&lt;/p&gt;

You step out into the clearing to try and see where the $npc1.species went, but $npc1.he&#39;s completely disappeared. Looking down you find something that must have been dropped by the $npc2.species adventurer. 

&lt;&lt;set _drop = random(1,100)&gt;&gt;
&lt;&lt;if _drop &gt; 90&gt;&gt;&lt;&lt;getItem $rapier&gt;&gt;
&lt;&lt;elseif _drop &gt; 75&gt;&gt;&lt;&lt;getItem $leatherArmor&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $hamSandwich&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="362" name="Path out of the Grasslands" tags="" position="2150,2350" size="100,100">You find a small foot path worn through some hedges. As you approach closer you find it leads to one of the city roads! 


&lt;&lt;include &quot;grasslands randomization&quot;&gt;&gt;

&lt;&lt;if random(1,2) == 1&gt;&gt;
	&lt;&lt;action &quot;n&quot; &quot;road&quot; &quot;Western Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;road&quot; &quot;Southern Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="363" name="Run from the lizard wizard" tags="nobr" position="2775,3250" size="100,100">&lt;&lt;setPassageTitle &quot;Run from the $npc1.species wizard&quot;&gt;&gt;

&lt;p&gt;You try to pull yourself away from the delicious fruits, but it seems that they&#39;re rather insistant that you stay. The plants appear to shift about subtly, bending and creaking as they encircle you, forming a natural barrier that you can&#39;t escape from easily. &lt;/p&gt;

&lt;&lt;set _player = ($str + $agi + $int + 30) / 3&gt;&gt;

&lt;&lt;if setup.skillTest(_player,0)&gt;&gt;
Grunting with effort, you tear at bushes, branches, and vines, managing to make an opening just long enough to slip through. As you start running, you hear the wizard let out an angry, wordless screech of anger. Looking back, it&#39;s obvious that $npc1.he&#39;s nowhere near fast enough to catch you. 
&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
You pull and tear at the mass of plants in your way, but to no avail. Plant matter seem to regrow as fast as you destroy it. Panting for breath, you turn to face the owner, who&#39;s sporting a wicked&lt;&lt;if $npc1.teeth == &quot;sharp teeth&quot;&gt;&gt;, sharp-toothed&lt;&lt;/if&gt;&gt; grin, which is a disquieting deviation from $npc1.his round, pudgy, seemingly harmless form. 
&lt;&lt;setEnemy $lizardWizard&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;lizardWizard&quot;&gt;&gt;

&lt;&lt;startCombat&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="364" name="Stuffed by the wildlings" tags="nobr" position="2000,3025" size="100,100">&lt;&lt;set $status.StretchFruit = 300&gt;&gt;
&lt;&lt;set $status.StretchFruitPower = 30&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&lt;&lt;rest&gt;&gt;
&lt;&lt;stuffToBursting&gt;&gt;
/*End setup*/

&lt;p&gt;You&#39;re jolted awake again as you feel yourself swaying back and forth. You blink your eyes a few times and see the ground drifting downwards in front of you. You attempt to move your arms and legs and noticed that they&#39;re tied behind you around a wooden pole. You look up and see the fat butt of the $npc1.species carrying the pole you&#39;re tied to on $npc1.his shoulders with the other wildling presumably carrying the other end. &lt;/p&gt;

&lt;p&gt;Looking down you notice your $waist stomach hanging down from your $fatness frame is much larger than it was before, and yet you don&#39;t feel any fuller. Another rope is tightly looped several times around the large circumference of your waist, fortunately preventing your &lt;&lt;sayWeight setup.weight()&gt;&gt; of weight from pulling entirely on your wrists and ankles even if it puts some much unwanted pressure on your achingly swollen gut. You notice that some sort of blue goo has been liberally smeared all over your $p.furBelly $p.furred belly and you smack your lips as you taste an odd rubbery grapey taste. You also notice a distinct tingling sensation wherever the blue goo touches. &lt;/p&gt;

The two wildlings are sharing some banter back and forth, each sounding proud of their new catch. You attempt to understand what they&#39;re saying, but the heavy load in your bloated tingly gut is making it hard to focus on anything. Eventually the gentle swaying combined with your tremendous meal inevitably pulls you into a food coma. 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Carried to the Wildling Village&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="365" name="Trade with the Lizard Wizard" tags="nobr" position="2825,3000" size="100,100">&lt;&lt;setPassageTitle &quot;Trade with the $npc1.Species Wizard&quot;&gt;&gt;

The little $npc1.species guides you outside to a cart drawn by a horse. Which would be less odd if it weren&#39;t an anthropomorphic one. You shake your head slightly, reminding yourself that there&#39;s no accounting for taste. $npc1.He displays $npc1.his cart with a flourish, a sampling of the fruits from $npc1.his farm on ready display and available for purchase. 

&lt;&lt;store&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;grasslands&quot; &quot;Grasslands&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="366" name="Wait for the lizard wizard" tags="" position="3025,3250" size="100,100">&lt;&lt;setPassageTitle &quot;Wait for the $npc1.species wizard&quot;&gt;&gt;

You cross your arms, and wait for the wizard&#39;s approach. The little $npc1.species comes up to you, twirling $npc1.his wand dextrously. $npc1.He lets out a devious giggle as $npc1.he approaches, &lt;&lt;if $npc1.teeth == &quot;sharp teeth&quot;&gt;&gt;sharp teeth apparent in $npc1.his wide grin&lt;&lt;else&gt;&gt;grinning widely in an unnerving manor&lt;&lt;/if&gt;&gt;. You steel yourself for a fight, having been caught red handed. 
&lt;&lt;setEnemy $lizardWizard&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;lizardWizard&quot;&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="367" name="Wildling captive" tags="nobr" position="2350,2850" size="100,100">As you $walk through the long grass, you spot a large-looking shape standing out on the horizon. Curious. Do you want to approach and investigate? 

&lt;&lt;setEnemy $wildlingShamanBoss&gt;&gt;
&lt;&lt;set _species = either($lion, $rhino, $hippo)&gt;&gt;
&lt;&lt;createNPC _species &quot;random&quot; 2&gt;&gt; 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Investigate the captive&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave the captive alone&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;set $eventCounterA = {
	dispelled: false,
	dispelsLeft: 3,
	feedsLeft: 3,
	fattened: true,
	freed: false
}&gt;&gt;</tw-passagedata><tw-passagedata pid="368" name="grasslands randomization" tags="nobr" position="2150,2650" size="100,100">/*Ticks up random events counters*/
&lt;&lt;set $grasslandsRandomization.combat += $grasslandsRandomization.combatRate&gt;&gt;

&lt;&lt;set $grasslandsRandomization.special += $grasslandsRandomization.specialRate&gt;&gt;

&lt;&lt;set $grasslandsRandomization.leave += $grasslandsRandomization.leaveRate&gt;&gt;

&lt;&lt;set $grasslandsRandomization.minor += $grasslandsRandomization.minorRate&gt;&gt;
/**/

/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;

&lt;&lt;if $grasslandsRandomization.special &gt; $grasslandsRandomization.combat&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $grasslandsRandomization.minor &gt; $grasslandsRandomization.special&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;minor&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $grasslandsRandomization.leave &gt; $grasslandsRandomization.minor&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;leave&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
/**/

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;

/*A random combat*/
&lt;&lt;case &quot;combat&quot;&gt;&gt;
&lt;&lt;set $grasslandsRandomization.combat = 0&gt;&gt;
&lt;&lt;set _event = &quot;Grasslands ambush&quot;&gt;&gt;

/*A special event*/
&lt;&lt;case &quot;special&quot;&gt;&gt;
&lt;&lt;set $grasslandsRandomization.special = 0&gt;&gt;

&lt;&lt;switch random(1,2)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
	&lt;&lt;set _event = &quot;Wildling captive&quot;&gt;&gt;
	&lt;&lt;case 2&gt;&gt;
	&lt;&lt;set _event = &quot;Fruit farm&quot;&gt;&gt;
	&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in special event randomization!&#39;&#39;
&lt;&lt;/switch&gt;&gt;

/*A random minor scene*/
&lt;&lt;case &quot;minor&quot;&gt;&gt;
&lt;&lt;set $grasslandsRandomization.minor = 0&gt;&gt;
&lt;&lt;set _event = &quot;Minor Grasslands events&quot;&gt;&gt;

/*Opportunity to leave the forest*/
&lt;&lt;case &quot;leave&quot;&gt;&gt;
&lt;&lt;set $grasslandsRandomization.leave = 0&gt;&gt;
&lt;&lt;set _event = &quot;Path out of the Grasslands&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in grasslands randomization!!!&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Grasslands&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;grasslands&quot; &quot;Grasslands&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="369" name="Captured by the Dessert Villagers" tags="nobr" position="3725,2950" size="100,100">&lt;p&gt;You wake up tied down with a bunch of restraints around your arms, legs and head. You can barely move your head, but you can see hundreds or maybe even thousands of these small dessert creatures and even some much larger ones - even though they are still at most half your size. One of them shouts &quot;Begin the sacrifice!&quot; as a device opens your mouth impossibly wide. You panick as the dessert people begin piling themselves inside of your maw and going down your throat. Your eyes widen in confusion, but your mouth salivates at how insanely delicious they are. You have no idea why they are doing this, but you don&#39;t care. 
&lt;/p&gt;

&lt;p&gt;Even though the dessert people are fairly small, they seem to be much more... filling than you&#39;d expect.You feel the pressure in your stomach as it swells out drastically, bulging around the restraints across your body. You enter a state of bliss as you are forcibly devouring an entire race of delicious little people. 
&lt;&lt;consume 40 30&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;In a matter of minutes your stomach has bulged out massively and the restraints across your torso snap and fly off. You can&#39;t see how many of them are left, but all of the sudden, even though you feel thoroughly stuffed, you want to eat them all. No, you NEED to eat them all. If you weren&#39;t in restraints you&#39;d be doing the same thing they are forcing you to do now, eat them and become massive. 
&lt;&lt;consume 275 200&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;&lt;&lt;rest&gt;&gt;
&lt;&lt;rest&gt;&gt;
Hours pass by and eventually only one dessert person remains. Your stomach has grown tremendously and the final restraints on your wrists and ankles are practically stretched to the limit as your fat bulges around them. The final dessert person undoes the restraints as you lay there like a blubberous land-whale. 
&lt;&lt;consume 550 400&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You struggle to get to your feet, your center of gravity drastically changing from eating an entire race of delicious dessert people. After you manage to get to your feet, you belch thunderously. They were the most delicious race of people you had ever eaten. Just then you realize... there&#39;s still one more. &lt;/p&gt;

&lt;&lt;action &quot;c&quot; &quot;devour&quot; &quot;Eat the last Dessert person&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave the villagers&quot;&gt;&gt;
&lt;&lt;set $eventCounterA = 1&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;You hope to devour the entire race of dessert people, but your stomach starts to protest as the last of the dessert people pile into your mouth. You just want to eat them all, but it seems you won&#39;t be able to. A little muffin-man struggles to climb down your throat, but your overtaxed gut has run out of room. A gingerbread $p.species begins to help, using a candy-cane to prod the muffin deeper down your gullet. It was too much. Your pastry-packed belly rumbles and groans, swelling out to suddenly detonate like a batter-filled bomb! &lt;/p&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;p&gt;You hope to devour the entire race of dessert people, but your stomach starts to protest as the last of the dessert people pile into your mouth. You just want to eat them all, but it seems you won&#39;t be able to... &lt;/p&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;Your stomach becomes so large that you practically can&#39;t see past it. Looking up at the mountainous swell, you can just see a cupcake person has clambered all the way to the top. It looks down at you before kicking off. It slides down the mighty curve of your belly like a rollercoaster leading straight into your mouth. It was too much. Your pastry-packed belly rumbles and groans, swelling out to suddenly detonate like a batter-filled bomb! &lt;/p&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;p&gt;You pass out after your stomach becomes so large that you practically can&#39;t see past it. &lt;/p&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;else&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;The dessert people continually stuff themselves into your maw, filling your stomach and fattening you up. There seems to be no end to them. You find yourself woefully short of stomach capacity before you’ve made a dent in the que. A particularly large donut person just made its way to join the rest of the party when your gut lets out a mighty groan. The assembled dessert people seem agitated. Some flee while others try to shove their way to your mouth, hoping to get inside before it too late. But just a few seconds later, your pastry-packed belly rumbles, swelling out to suddenly detonate like a batter-filled bomb! &lt;/p&gt;

&lt;p&gt;The dessert village is left in a sugary mess. At ground zero a gingerbread $p.species limps back towards the village though bits of frosting and dough using a candy cane, having lost one of its cookie legs in the blast. &lt;/p&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
You doze off as the dessert people continually stuff themselves into your maw, filling your stomach and fattening you up. 
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="370" name="Dessert village" tags="hills" position="3725,2700" size="100,100">As you crest the next hill, you come across a tiny town in the next valley that looks to be populated with small creatures made up of various desserts. As you admire them, a few of townsfolk come up to see you and beckon you to follow. 

&lt;&lt;action &quot;w&quot; devour &quot;Eat the villagers!&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Follow the villagers&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave the villagers&quot;&gt;&gt;
&lt;&lt;set $eventCounterA = 0&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="371" name="Drink wishing well water" tags="nobr" position="3425,2950" size="100,100">&lt;p&gt;You glance at the sign, then at the well, and lick your lips. Well, it doesn&#39;t say you //CAN&#39;T//... Leaning over the edge of the well you plunge your cupped $p.hands into the cold, clear water and scoop some up, slurping it down messily. &lt;/p&gt;

&lt;&lt;switch random(1,8)&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;p&gt;It tastes... just like water. Apart from quenching your thirst, nothing even slightly supernatural happens. 
&lt;&lt;consume 5 0&gt;&gt;
&lt;&lt;stamina 30&gt;&gt;&lt;/p&gt;


&lt;&lt;if $alive&gt;&gt;
With a rather guilty glance around you turn and hurriedly make your way back down the tunnel and out into the hills. 

&lt;&lt;else&gt;&gt;
Something regular natural //does// happen though. You&#39;re stomach groans and rebels as you realize you drank too greedily and too deep. You slump to the floor, far too full to even think straight anymore. As you slowly lose concsiousness, you can only hope somebody finds you in this remote place....

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;&lt;if $p.height &lt;= 132&gt;&gt;
&lt;&lt;changeStats &quot;height&quot; 12 true&gt;&gt;
&lt;p&gt;It tastes sweeter than you&#39;d expected. In fact, it tastes almost exactly like lemonade! Weird! You&#39;re still rubbing your damp chin when a wave of nausea runs through you, and you double up around your stomach. A deep rumbling emerges from it, growing louder and louder. 
&lt;/p&gt;

&lt;p&gt;//&quot;Oorgh,&quot;// you think to yourself, //&quot;M-maybe I sh-shouldn&#39;t have drunk the wa-oh... woah... woah...! WOAH...!&quot;// As the rumbling from your middle becomes deafening, you feel your body SURGE upwards, the ground retreating from you at an alarming rate. You stumble unsteadily as you try to stand upright, feeling like you&#39;re in an earthquake
&lt;&lt;if $p.height &gt; 72&gt;&gt;, and promptly bang your head on the ceiling&lt;&lt;/if&gt;&gt;. The weird rumbling, trembling sensation abruptly dies away, and you&#39;re left standing there, panting. Looking around you, the world feels... smaller. Quite a lot smaller. You&#39;ve GROWN! Looking down at the well, you think you must be at least &lt;&lt;sayDistance 12&gt;&gt; taller than you were a few seconds ago! 

&lt;&lt;if $top.name != $shirtless.name or $btm.name != $pantsless.name&gt;&gt;
Glancing down, you realise that none of your clothes fit you properly any more- you look like you&#39;ve borrowed them from your little $p.brother. &lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;It tastes... just like water. Apart from quenching your thirst, nothing even slightly supernatural happens. 
&lt;&lt;consume 5 0&gt;&gt;
&lt;&lt;stamina 30&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
With a rather guilty glance around you turn and hurriedly make your way back down the tunnel and out into the hills. 

&lt;&lt;else&gt;&gt;
Something regular natural //does// happen though. You&#39;re stomach groans and rebels as you realize you drank too greedily and too deep. You slump to the floor, far too full to even think straight anymore. As you slowly lose concsiousness, you can only hope somebody finds you in this remote place....

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;case 3&gt;&gt;
&lt;&lt;set $fat += 150&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&lt;p&gt;The water slides down your throat like syrup, amazingly sweet. You blink in surprise, then cough. You weren&#39;t expecting THAT. Then you feel a tectonic rumbling deep in your guts, and a deep, rolling BURRP escapes from you, echoing off the cave walls and making the well-water ripple. The rumbling is replaced by a strange tingling, the cold water sitting in your stomach like ice. You suddenly feel... so FULL... With another stuffed //belch// you put your $p.hands to your stomach, only to feel it swelling in your grip! &lt;/p&gt;

&lt;p&gt;Your eyes boggle as you grab and shake your middle, but it is definitely growing! And not just filling- you&#39;re gaining weight! The tingling in the pit of your stomach seems to spread throughout your body, and as you stand there you feel ALL of you starting to put on weight- arms, legs, back, neck, the lot! You have to widen your stance to accommodate your swelling belly and thickening thighs. You lumber heavily to the well and stare at your reflection, and gawp as your features plump up before your very eyes. &lt;/p&gt;

&lt;p&gt;Finally the cold tingling sensation subsides, and you stop growing. But you&#39;re been left a good &lt;&lt;sayWeight 150&gt;&gt; fatter. You&#39;re now downright $fatness! Whoever said that drinking water was good for you? You poke at your sizably-expanded gut in disbelief, then slowly shake your head (feeling your cheeks wobble as you do so). Turning, you waddle unsteadily down the tunnel, and emerge rather dazedly into the $daytime. You REALLY weren&#39;t expecting THAT... &lt;/p&gt;

&lt;&lt;case 4&gt;&gt;
&lt;p&gt;It tastes... WONDERFUL! You smack your lips, feeling a big, silly smile plaster itself across your face. It&#39;s the most divine thing you&#39;ve ever tasted! It&#39;s... IRRESISTIBLE! You grab hold of the well wall with both $p.hands and PLUNGE your face underwater, gulping it down like some kind of suction pump. You feel your belly fill quickly with the cold water, then grow taut, but you don&#39;t care- you just HAVE to keep drinking! You gulp down gallon after gallon, completely unable to stop yourself, your belly swelling bigger and bigger against the side of the well. A couple of times you&#39;re forced up for air, but after a couple of ragged breathes you dive back down again, slurping and gulping for all that you&#39;re worth. You guzzle well water until it HURTS! 
&lt;&lt;set _water = ($sto * 1.1)&gt;&gt;
&lt;&lt;consume _water 0&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;The sloshing weight of your waterlogged stomach finally drags your face clear of the water- to an accompanying $p.angry of disappointment. The supernatural compulsion you were under abruptly fades, and you let out a rolling //BURRRRP// that shakes the cave! You totter back a couple of paces before falling onto your backside, moaning and weakly rubbing at your new waterballoon of a belly. &lt;/p&gt;

&lt;p&gt;Oogh, you feel almost fit to burst! What came OVER you? With a stifled groan you manage to roll to your feet and stumble back down the tunnel to the outside world, 
sloshing heavily with each lumbering step you take. Out in the fresh air you feel a little better, but you won&#39;t want another drink for a long, long time. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;The ache in your stomach grows stronger and stronger as you swell out like a balloon, rising up onto your belly as it fills, until you&#39;re actually leaning down to keep in contact with the water. Your hide stretches as you continue to suck down gallon after gallon, all the while your body growing out and up. Finally, you feel something sharp press against your flank. A pointy stalactite reaching down from the ceiling makes contact with your waterlogged gut, but you are unable to stop. A few more gulps send the rocky tip straight through your waterballooned hide. You split open in a flood of water, which slowly drains back down to the depths from where it came. &lt;/p&gt;

&lt;p&gt;In the aftermath, water comes dripping down from the ceiling, growing the stalactites a tiny bit more as little bits of mineral get left behind...&lt;/p&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;The ache in your stomach grows stronger and stronger as you swell out like a balloon, actually rising up onto your belly as it fills, until you&#39;re actually leaning down to keep in contact with the water. Finally the weight of all that water drags your face clear, and you gasp with disappointment- and then with agony as the supernatural compulsion gripping you abruptly fades. You wheeze and let out a watery BURRRRP, your body rolling onto its back as it finds its new centre of gravity. You lay there, pinned by your now enormous waterballoon belly, weighing down on you painfully, your vision going blurry at the edges as you try to breathe, the pressure inside you increasing until it seems you&#39;re going to POP. Mercifully, before that happens you lose consciousness, and everything fades to black. &lt;/p&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;case 5&gt;&gt;
&lt;p&gt;For a moment you swill it rather gingerly round your mouth to warm it, and then, reassured that it does just seem to be water, swallow it down. It&#39;s only as you feel it go down your throat does it start to fizz and bubble angrily, but by then it&#39;s far, far too late, and you gulp heavily. With a sense of foreboding you turn to look at the well, and the water in that is doing just same, roiling like a pan of boiling water! Suddenly it glows as if powerfully lit from underneath, making your eyes ache. &lt;/p&gt;

&lt;p&gt;The water begins to spiral around, but rather than sinking down in the center it rises UP. And up, and up, until you&#39;re staring at a figure made of glowing water, like the most delicately-made glass statue ever. You realise with a jolt that it&#39;s a highly-idealised rendering of a $p.male $p.species- or, in other words, YOU. And the spirit inhabiting it does not appear pleased with you. &lt;/p&gt;

&lt;p&gt;&quot;Sacrilege!&quot; $p.he exclaims, rather waterily. $p.He extends an arm at you, and a jet of icy-cold water sprays forward, smacking straight into your gaping mouth. The force of it knocks you back against the cave wall, spluttering as you gulp water, and gulp, and gulp, and gulp. Your cheeks bulge out, continually swollen by the cateract of water swilling through them. You try to get out from under the deluge, but two more jets pummel at your arms and shoulders, pinning you in place while your stomach swells visibly. 
&lt;&lt;set _water = ($sto + 125) * 2&gt;&gt;
&lt;&lt;consume _water 0&gt;&gt;&lt;/p&gt;

&lt;p&gt;&quot;You dare to drink from my sacred waters,&quot; the spirit intones maliciously, &quot;so THAT shall be your punishment!&quot; You struggle uselessly, feeling yourself ballooning bigger and bigger and bigger, stretching far more than a mortal body SHOULD be able to. Pretty soon your stomach is resting on the cave floor and you feel your legs lifted uselessly into the air, buoyed up by the pressure from your stomach and backside, while your arms have become swollen and stubby, useless. You bob there, totally unrecognisable as a $p.species, a living waterballoon, still being forced larger and larger by the unforgiving spirit, until you&#39;re filling nearly half the cave! The spirit&#39;s avatar grows increasingly tall and massive as you expand, eye-to-eye with you as $p.he gushes water into you. Your hide reaches the limits of whatever magical elasticity is maintaining it, and you feel yourself trembling from the tension, the pressure inside you growing greater and greater and greater. 
&lt;&lt;consume _water 0&gt;&gt;&lt;/p&gt;

&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;A deep, ominous, watery gurgling begins deep inside you, and you clench your eyes shut, but even with them tightly closed as you feel your body suddenly give way. For just a fraction of a second, a perfect sphere of water hangs in the air. Now freed from its fleshy prison that was you, it erupts in all directions soaking the cave in a cascade of water. &lt;/p&gt;

&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;A deep, ominous, watery gurgling begins deep inside you, and you clench your eyes shut, but even with them tightly closed as you feel yourself about to burst even the darkness behind your eyelids begins to turn to blinding light... &lt;/p&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;case 6&gt;&gt;
&lt;&lt;if $ate &gt; 0 or $inf &gt; 0 or $fat &gt; 0&gt;&gt;

	&lt;&lt;set _weightLost = setup.weight()&gt;&gt;
	&lt;&lt;set $ate = 0&gt;&gt;
	&lt;&lt;set $inf = 0&gt;&gt;
	&lt;&lt;set $infMass = 0&gt;&gt;
	&lt;&lt;set $cal = 0&gt;&gt;
	&lt;&lt;set $fat -= 30&gt;&gt;
	&lt;&lt;if $fat &lt; 0&gt;&gt;&lt;&lt;set $fat = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;updateStats&gt;&gt;
	&lt;&lt;set _weightLost -= setup.weight()&gt;&gt;

	&lt;p&gt;BLEAURGH! It tastes bitter! You swallow it before you can stop yourself. You spit out what you can, feeling your cheeks suck in with distaste. Oogh, that was horrible! You can even feel your insides clench as the cold water pools in your stomach. You put your $p.hands to your middle- then your eyes bulge as you feel your stomach shrinking! No word of a lie, you&#39;re getting thinner! Your fingers close together as your $waist stomach reduces in your grip, the cold water chilling you to the bone. By the time the feeling wears off, you must have lost &lt;&lt;sayWeight _weightLost&gt;&gt;! Talk about a diet plan. &lt;/p&gt;

&lt;p&gt;Still queasy, you stagger down the tunnel and out into the fresh air, feeling disturbingly light on your feet and your stomach disturbingly empty. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;It tastes... just like water. Apart from quenching your thirst, nothing even slightly supernatural happens. 
&lt;&lt;consume 5 0&gt;&gt;
&lt;&lt;stamina 30&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;With a rather guilty glance around you turn and hurriedly make your way back down the tunnel and out into the hills. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;Something regular natural //does// happen though. You&#39;re stomach groans and rebels as you realize you drank too greedily and too deep. You slump to the floor, far too full to even think straight anymore. As you slowly lose concsiousness, you can only hope somebody finds you in this remote place....&lt;/p&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;case 7&gt;&gt;
&lt;&lt;if $p.height &gt;= 52&gt;&gt;

&lt;&lt;changeStats &quot;height&quot; -12 true&gt;&gt;
&lt;p&gt;Ick! That tastes HORRIBLE! You spray the water across the cave (and yourself), wiping at your mouth to get rid of the taste, then trying to pat your damp hide dry. That&#39;s when you feel a strange tremor run through your body, and with a grunt of surprise your hold up one arm for your inspection, only to watch it... shrink. Along with the rest of you. &lt;&lt;if $top.name != $shirtless.name or $btm.name != $pantsless.name&gt;&gt;Your clothes start to rumple as you sink down into them. &lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;p&gt;By the time whatever crazy curse this is has finished with you, you&#39;ve shrunk in height by about &lt;&lt;sayDistance 12&gt;&gt;! Suddenly the cave seems quite a bit taller, and then it echoes with unseen laughter. You high-tail it out of there before anything else can happen, discovering on your way out that people with shorter legs have to walk more. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;It tastes... just like water. Apart from quenching your thirst, nothing even slightly supernatural happens. 
&lt;&lt;consume 5 0&gt;&gt;
&lt;&lt;stamina 30&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;With a rather guilty glance around you turn and hurriedly make your way back down the tunnel and out into the hills. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;Something regular natural //does// happen though. You&#39;re stomach groans and rebels as you realize you drank too greedily and too deep. You slump to the floor, far too full to even think straight anymore. As you slowly lose concsiousness, you can only hope somebody finds you in this remote place....&lt;/p&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;case 8&gt;&gt; 
&lt;p&gt;The moment the water from the sacred well touches your lips, its unexpected sweetness, reminiscent of a rich, honeyed liqueur, takes you by surprise. This isn&#39;t the simple, refreshing water you anticipated. A cough escapes you, a reaction to the unexpected flavor. Almost immediately, a deep, unsettling rumbling starts in your abdomen, sending a resonant burp echoing off the cave walls, causing the surface of the well to ripple in response.&lt;/p&gt;

&lt;p&gt;This internal turbulence quickly transforms into a peculiar, tingling sensation, spreading from the pit of your stomach. A cold, intense fullness begins to take over your body. Alarmingly, you feel your stomach begin to swell, inflating rapidly like a balloon being filled to the brink. Your $p.hands instinctively grasp your midsection, feeling the tautness of your skin as it stretches, accommodating your increasingly prominent belly. The growth is relentless, your belly expanding outward, forming a pronounced, round bulge.&lt;/p&gt;

&lt;p&gt;But the swelling doesn&#39;t stop there. It swiftly extends to your hips and &lt;&lt;if $p.male==&quot;female&quot;&gt;&gt;breasts&lt;&lt;else&gt;&gt;chest&lt;&lt;/if&gt;&gt;. Your hips widen noticeably, ballooning out to create a more voluptuous, rounded shape. This bizarre sensation, as though your body is being silently filled with air, is both surreal and unsettling. Simultaneously, your chest starts to expand as well, your &lt;&lt;if $p.male==&quot;female&quot;&gt;&gt;breasts&lt;&lt;else&gt;&gt;chest&lt;&lt;/if&gt;&gt; swelling in tandem with your belly and hips. Panic sets in as you realize the transformation shows no sign of slowing. Your clothing strains against your rapidly increasing girth, seams popping and fabric pulling tight.&lt;/p&gt;

&lt;p&gt;The swelling feels unstoppable, a relentless force rapidly reshaping your body. With each passing moment, you grow larger, your once-familiar form becoming unrecognizable. The realization that you are rapidly losing control over your own body instills a deep, visceral fear.&lt;/p&gt;

&lt;p&gt;Panicked by this unexpected transformation, you attempt to flee the cave. However, your swollen legs and ballooning body make movement increasingly difficult. Each step is heavier, more laborious, as your belly, thighs, and back continue to gain mass, contributing to your growing roundness.&lt;/p&gt;

&lt;p&gt;Hindered by your rapidly expanding form, your attempts to escape become increasingly futile. As you try to shuffle towards the cave exit, the swelling relentlessly continues. Your body feels like an overfilled water balloon, each part filling with an impossible amount of liquid.&lt;/p&gt;

&lt;p&gt;Your crotch begins to swell downward, pushing against the fabric of your clothing, creating an uncomfortable pressure. This swelling forces your legs apart, making it difficult to maintain a waddling gait towards the cave exit. Each step becomes a laborious effort as the swollen mass between your legs grows, hindering your ability to move.&lt;/p&gt;

&lt;p&gt;Simultaneously, your arms start to lift upward, hoisted by the expanding sides of your body. They become increasingly useless, more like floating appendages on the sides of your ballooning form. The sheer size of your body at this point is staggering – you&#39;re like a $p.species water balloon, each part of you engorged and stretched to the brink.&lt;/p&gt;

&lt;p&gt;As the swelling continues unabated, the expanded mass of your crotch presses against the cave floor with each strained step, forcing your feet even further apart. This bizarre and cumbersome development makes movement near impossible. Your steps become more like awkward shuffles, your feet struggling to find purchase on the ground as they are pushed outward and upward by the swelling mass of your lower body.&lt;/p&gt;

&lt;p&gt;Finally, your feet lose contact with the ground entirely, lifted off the floor by the sheer volume of your lower body. In this helpless state, you begin to roll backward, your body having become so round and inflated that it moves on its own accord. You try to stop the motion, but it&#39;s futile – your limbs are too swollen to provide any leverage.&lt;/p&gt;

&lt;p&gt;Slowly rolling back deeper into the cave, your inflated form bounces gently off the walls. The sensation of rolling, utterly out of control, is surreal – you&#39;re at the mercy of your own bloated body, unable to do anything but watch as the cave&#39;s entrance grows further and further away. With each rotation, the realization sets in: you are trapped in this inflated state, a prisoner of the sacred well&#39;s magic, rolling helplessly into the depths of the cavern from which you sought to escape.&lt;/p&gt;

&lt;p&gt;In the dimness of the cavern, as you come to a stop, you&#39;re left in a state of round, immobile defeat. The well&#39;s mysterious magic has transformed you into a living sphere, rolled back into the depths from which you sought to escape. You take a moment to examine your new body.&lt;/p&gt;

&lt;p&gt;Trapped within the confines of your own inflated form, you find yourself unable to do much beyond making small, flapping motions with your $p.hands and feet. These pitiful gestures, barely noticeable on the vast surface of your ballooned body, are a futile effort against your immense size. Each muffled grunt you emit is a muted cry of frustration, muffled by the sheer volume of your swollen form. The reality of your situation is stark – you are now a colossal, helpless being, unable to move or communicate effectively, reduced to the most basic, ineffectual attempts at motion. Your vision fades as the fullness of your entire being becomes overwhelming...&lt;/p&gt;

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;if$alive&gt;&gt;
&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="372" name="Eat the last Dessert person" tags="nobr" position="3850,2950" size="100,100">You grab ahold of the last dessert person. He gives a tiny triumphant cheer of glee before you stuff him in your mouth and gulp him down. 
&lt;&lt;consume 10 7&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
Hopefully there are more where that came from. 

&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if $options.popping&gt;&gt;
&lt;p&gt;His muffled cheers travel down your throat and just as they&#39;re silenced completely, you realize what a mistake that last bite was. You stomach stretches those last painful few inches and you begin to feel dizzy from fullness. You collapse over on your back, crushing the tiny village homes as your overtaxed gut wobbles over you. The rough jostling is too much and your pastry-packed belly swells out to suddenly detonate like a batter-filled bomb! &lt;/p&gt;
&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;p&gt;His muffled cheers travel down your throat and just as they&#39;re silenced completely, you realize what a mistake that last bite was. You stomach stretches those last painful few inches and you begin to faint from fullness. You collapse over on your back, crushing the tiny village homes as your overtaxed gut wobbles over you and you pass out from gluttonous pain. &lt;/p&gt;
&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="373" name="Eat the villagers!" tags="nobr" position="3725,2825" size="100,100">You ignore their puny request and grab ahold of the few delicious dessert people talking to you and stuff them in mouth. 
&lt;&lt;consume 12 8&gt;&gt;

&lt;&lt;if $alive&gt;&gt;
	&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;p&gt;You pat your stomach for a job well done, but as soon as you take one step, you stumble. You attempt to regain your footing, but you&#39;re just //far// too stuffed to stay standing anymore. You eventually flop over onto your back, ready to fall into a sugar coma. As you pass out, you see yet more tiny villagers making their way towards you....&lt;/p&gt;

	&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the Dessert Villagers&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="374" name="Follow the villagers" tags="nobr" position="3850,2825" size="100,100">You follow the dessert creatures into their small village, your stomach growling as their delicious smells enter your nostrils. You can barely hear them, but it sounds like they want to worship you. As you lose yourself in their smells you realize all of them have disappeared. Just as you&#39;re looking around you fall unconcious. 

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Sleep&quot; &quot;Captured by the Dessert Villagers&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="375" name="Hills" tags="hills" position="3650,2300" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a comfortable spot to sit down and rest. 
	&lt;&lt;rest&gt;&gt;

	&lt;&lt;if random(1,5) == 1&gt;&gt;
		&lt;&lt;set _enemy = either($milkMachine, $blueberrySlime, $honeySlime, $meatMonster, $bloatBees)&gt;&gt;
		&lt;&lt;setEnemy _enemy&gt;&gt;
		You are awoken from your sleep by $e.article $e.name! 
	
		&lt;&lt;startCombat&gt;&gt;

	&lt;&lt;else&gt;&gt;
		
		&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
You&#39;re standing in the rolling hills. The frequent changes in elevation make it hard to find a bearing on your location, as the top of every hill seems to be surrounded by even taller hills. Several large rocky outcroppings jut from the earth along with several small thickets of trees. Across the distant southeastern horizon the tall dark mountains loom overhead. 

&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="376" name="Hills ambush" tags="hills" position="3600,2575" size="100,100">/*Increase enemy find rates when on specific quests later*/
&lt;&lt;if $hillsEnemies == undefined or $hillsEnemies.length == 0&gt;&gt;
	&lt;&lt;set $hillsEnemies = [&quot;milk&quot;, &quot;blueberry&quot;, &quot;honey&quot;, &quot;meat&quot;, &quot;bee&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $hillsEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;

&lt;&lt;case &quot;milk&quot;&gt;&gt;
&lt;&lt;setEnemy $milkMachine&gt;&gt;
You&#39;re adventuring when you start to hear a sudden strange metallic whirring. The source is quickly revealed as some malevolent metal contraption suddenly springs out in front of you!

&lt;&lt;case &quot;blueberry&quot;&gt;&gt;
&lt;&lt;setEnemy $blueberrySlime&gt;&gt;
As you&#39;re travelling you&#39;re greeted by the scent of blueberries. You look around to see if you can find a blueberry bush anywhere, but as the scent becomes more and more powerful, you&#39;re suddenly set upon by a massive blue slime!

&lt;&lt;case &quot;honey&quot;&gt;&gt;
&lt;&lt;setEnemy $honeySlime&gt;&gt;
A delicious and mouth-watering scent begins pervading before the approach of your foe - a honey slime! Drooling over the captivating scent, you catch yourself wiping your mouth. The slime, lumbering, approaches you with viscous sweetness and fierceness! Or is it the honey that gives the vibe? 

&lt;&lt;case &quot;meat&quot;&gt;&gt;
&lt;&lt;setEnemy $meatMonster&gt;&gt;
As you&#39;re travelling through the rolling hills outside town, you being to smell the unmistakable scent of a barbecue. You look around for any trails of smoke to guide you, but as you turn around you come face to... face(?) with an animate man made of meat!

&lt;&lt;case &quot;bee&quot;&gt;&gt;
&lt;&lt;setEnemy $bloatBees&gt;&gt;
As you adventure through the hills, you hear a quiet buzzing noise over your shoulder. As you turn to investigate you see a swarm of &lt;&lt;=setup.getSpeciesData(&quot;bee&quot;).plural&gt;&gt; crest the previous hill and fly towards you menacingly. 

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy randomization&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="377" name="Investigate well" tags="nobr" position="3425,2825" size="100,100">&lt;p&gt;Intrigued, you push further into the rocky gap, which leads into a natural-looking tunnel of some kind. 

&lt;&lt;if $p.height &gt; 72&gt;&gt;You have to duck slightly to get through the cave entrance without banging your head. 
&lt;&lt;elseif $p.height &gt; 48&gt;&gt;You can just touch the top of the cave mouth with your fingertips. 
&lt;&lt;else&gt;&gt;You try to reach up to the entrance’s ceiling, but can’t. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.waistDiameter() &gt; 36&gt;&gt;Squeezing your ample backside between the walls most of the way, 
&lt;&lt;elseif setup.waistDiameter() &gt; 8&gt;&gt;Having to breathe in at a couple of points to get through, 
&lt;&lt;else&gt;&gt;Strolling along with ease, 
&lt;&lt;/if&gt;&gt;

after a few dozen paces you emerge into a circular cave, with 

&lt;&lt;switch $daytime&gt;&gt;
&lt;&lt;case &quot;morning&quot;&gt;&gt;morning sunlight slanting in 
&lt;&lt;case &quot;day&quot;&gt;&gt;midday sun shining straight down 
&lt;&lt;case &quot;evening&quot;&gt;&gt;evening light glowing 
&lt;&lt;case &quot;night&quot;&gt;&gt;bright moonlight diffusing 
&lt;&lt;/switch&gt;&gt;

through a high gap in the crowning rock walls above. What looks like an old well sits in the middle of the cave, apparently bubbling up from an underground spring somewhere below. A rough, low, crumbling wall encloses the water, looking old enough to be from Ancient times. The sparkling water fills it to the very brim, barely held in by surface tension, rivulets of it occasionally trickling out over the coping, glinting like mercury in the low light. You deduce from the scuffed tracks in the sandy floor that you’re not the only person to have adventured down here. 
&lt;/p&gt;

&lt;p&gt;You slowly make a circuit around its circumference, seeing nothing unusual except for three strange stone heads built at equal distances around the edge. Time and splashes of water have eroded almost all the detail, so you can’t tell much beyond the fact that they all seem vaguely plump. A couple of cracked and crumbling pieces of masonry might or might-not have traces of writing carved on them. Leaning over the edge, you discover that at least some of the sparkle is coming from quite large accumulations of old coins down there, glinting up through the luminously clear water. &lt;/p&gt;

&lt;p&gt;Just as you&#39;re about to complete your circuit, you come across a much more recent item, a wooden board nailed to a post in the time-honoured &#39;This is a sign&#39; tradition. On it is badly painted: &lt;/p&gt;

&lt;p&gt;&lt;i&gt;1 gold 4 LucK &lt;br&gt;
10 4 StR3nGtH &lt;br&gt;
20 4 Siz3 &lt;br&gt;
30 4 GiRtH&lt;/i&gt; &lt;/p&gt;

&lt;p&gt;Wow, whoever heard of a wishing-well with a PRICE LIST? You catch sight of your reflection in the rippling water, and give yourself an ironic grin. It&#39;s true what they say, tourism ruins everything. &lt;/p&gt;


&lt;&lt;if $gld &gt;= 1&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;gold&quot; &quot;Throw in 1 gold&quot; &quot;Throw in gold&quot;&gt;&gt;&lt;&lt;set $eventCounterA = 1&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt;= 10&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;gold&quot; &quot;Throw in 10 gold&quot; &quot;Throw in gold&quot;&gt;&gt;&lt;&lt;set $eventCounterA = 10&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt;= 20&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;gold&quot; &quot;Throw in 20 gold&quot; &quot;Throw in gold&quot;&gt;&gt;&lt;&lt;set $eventCounterA = 20&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $gld &gt;= 30&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;gold&quot; &quot;Throw in 30 gold&quot; &quot;Throw in gold&quot;&gt;&gt;&lt;&lt;set $eventCounterA = 30&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;sw&quot; &quot;drink&quot; &quot;Drink wishing well water&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;se&quot; &quot;leave&quot; &quot;Leave well&quot;&gt;&gt;&lt;&lt;set $eventCounterA = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="378" name="Leave the villagers" tags="nobr" position="3850,2700" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 0&gt;&gt;
	You ignore the miniature dessert people and go on your merry way. They were kind of creepy anyway. 

&lt;&lt;case 1&gt;&gt;
	You thank the dessert person and leave, not wanting to risk accidental eruption. You waddle from side to side with every step as your gigantic belly sloshes around. 

&lt;&lt;/switch&gt;&gt;


&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="379" name="Leave well" tags="" position="3550,2825" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 0&gt;&gt;
	With a shrug you withdraw from the hole and head on your way. It’s almost certainly not worth investigating- absolutely NOTHING happens in these thar hills...

&lt;&lt;default&gt;&gt;
	You decide against parting with any cash on this occasion- besides, you&#39;d rather not mess with things that you don&#39;t understand. With a rather guilty glance back at the well, you head back down the tunnel and out into the $sunlight. 
&lt;&lt;/switch&gt;&gt;

&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="380" name="Minor Hills events" tags="hills" position="3800,2575" size="100,100">&lt;&lt;setPassageTitle &quot;A discovery?&quot;&gt;&gt;

As you travel through the forest, you come across a small tree bearing fruit. You reach up and pick the only ripe looking fruit. 
&lt;&lt;if random(1,2) == 1&gt;&gt;&lt;&lt;getItem $apple&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $orange&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="381" name="Throw in gold" tags="nobr" position="3550,2950" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;p&gt;&lt;&lt;doGld -1&gt;&gt;
You flip a single coin into the well, hearing the solitary &#39;gloop&#39; it makes as it hits the water. It sinks without a trace, not even a bubble. With a shrug, you turn and make your way back down the tunnel and into the $sunlight. Maybe it WILL bring you luck, but for one measly gold coin you can&#39;t help but feel that whatever spirit watches over that well is going to be all that impressed by your generosity. &lt;/p&gt;

&lt;&lt;case 10&gt;&gt;
&lt;&lt;doGld -10&gt;&gt;
&lt;p&gt;You count out 10 pieces of gold into your palm and tip them into the water, where they make a rattling splash as they hit. You stand there for a moment, wondering if you should offer up some kind of prayer, or at least close your eyes

&lt;&lt;if random(1,2) == 1 and $status.str &lt; 30&gt;&gt;, when you start to feel a little funny. It takes a couple of moments but you realise that it&#39;s your &lt;&lt;if $top.name == $shirtless.name&gt;&gt;shoulders! All of a sudden your skin feels tight across shoulders. &lt;&lt;else&gt;&gt;clothes! All of a sudden your $top.name feels tight across the shoulders. &lt;&lt;/if&gt;&gt;

&lt;p&gt;You flex them uncomfortably, and blink at how powerful they feel all of a sudden. That tingly feeling spreads down your arms, and you do a double-take as they grow noticeably thicker and more powerful, too. The tingling spreads down your spine too, and glancing over your shoulder you watch as your $fatness backside firms up noticeably- proved by a little flex of your cheeks. &quot;The feeling goes all the way through you from the tips of your fingers to the ends of your $p.feet, leaving you feeling quite a bit tougher. With a smile on your face, you stride back down the tunnel and into the $sunlight. 
&lt;&lt;buff &quot;str&quot; 30 360&gt;&gt;&lt;/p&gt;

&lt;&lt;else&gt;&gt;
. In the end you do shut them for a bit, but when you open them nothing seems to have changed. Ah, phooey. You head back outside. Maybe the lesson here is that if you want to be stronger you should work out more, rather than relying on wishes! 

&lt;&lt;/if&gt;&gt;


&lt;&lt;case 20&gt;&gt;
&lt;&lt;doGld -20&gt;&gt;
&lt;p&gt;You count out 20 gold pieces- a sizeable double-handful- and drop them into the water with a rock-like //splosh//, a few bubbles rising to the surface in their wake. You wait a few moments, holding your breath. &lt;/p&gt;

&lt;&lt;if random(1,2) == 1 and $p.height &lt; 100&gt;&gt;
&lt;&lt;changeStats &quot;height&quot; 2 true&gt;&gt;
&lt;p&gt;You start to feel funny a few paces down the tunnel, almost like an ache in your spine, but you keep on going. Two more steps down the tunnel and the feeling has spread all the way through your back, shoulders and legs, like you&#39;ve been for a long run- or someone has given you one hell of a massage. Although the air in the tunnel isn&#39;t that warm, you break into a sweat. You can see the mouth of the tunnel ahead, and press on
&lt;&lt;if $p.height &gt;= 100&gt;&gt;, squeezing down the tunnel&lt;&lt;/if&gt;&gt;
. When you reach the opening the funny feeling abruptly stops, but it&#39;s only when you step out that you realise something HAS changed! &lt;/p&gt;

&lt;p&gt;Blinking in the $sunlight you examine yourself in astonishment, comparing yourself to a conveniently-placed tree. You&#39;ve shot up in height by a good &lt;&lt;sayDistance 2&gt;&gt;. Not too shabby! Grinning at your good fortune, you breezily head on your way. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
Then, when it becomes painfully apparent that nothing&#39;s happening, you let it out with an audible sigh. Shame- you&#39;ve always had a hankering to be taller. It looks like the spirits of the well like you just the way you are. Turning, you head back down the tunnel and out into the $sunlight. 
&lt;&lt;/if&gt;&gt;


&lt;&lt;case 30&gt;&gt;
&lt;p&gt;&lt;&lt;doGld -30&gt;&gt;
Counting out 30 gold- quite the heap of coin, you reach out over the water, 
&lt;&lt;if $fat &gt; 100&gt;&gt;stomach rolling across the top of the wall, &lt;&lt;/if&gt;&gt;
and let it fall into the centre of the pool with a loud //Ger-BLOOSH!//. The ripples it makes spread all the way to the edge, slopping water around your $p.feet. &lt;/p&gt;

&lt;&lt;set $randNum = random(1,3)&gt;&gt;
&lt;&lt;if $randNum == 1&gt;&gt;
&lt;p&gt;&lt;&lt;set $fat += 90&gt;&gt;
You stand there for a couple of moments, arms braced on the well, unsure about what to do next. The uneasy silence is broken by a deep gurgle from your middle. Glancing down at it, you catch sight of your reflection in the water, and blink. Your face looks... fuller than you remember. In fact, it looks to be getting fuller by the minute! Another subterranean gurgle from your $waist waist. Standing up, you put your $p.hands to it and find that you can feel it swelling bigger! As you stand there, you can feel your entire body supernaturally packing on pounds- your backside swells outwards, your legs grow thicker and your belly rolls out against the coping stones. After a few pounding heartbeats the feeling stops, and you stagger back a couple of paces, experimentally hefting at your new bulk. It&#39;s hard to say, but you&#39;ve probably just put on a good &lt;&lt;sayWeight 90&gt;&gt;. You stumble a little unsteadily back to the outside world, the tunnel feeling distinctly less roomy than it did earlier. &lt;/p&gt;

&lt;p&gt;In the &lt;&lt;if $sun == &quot;sun&quot;&gt;&gt;warm daylight&lt;&lt;else&gt;&gt;cool night air&lt;&lt;/if&gt;&gt; you take a deep breath, relishing the way your enlarged stomach bows out further than ever. It&#39;s true what they say- you have to give a little to get a little. &lt;/p&gt;

&lt;&lt;elseif $randNum == 2&gt;&gt;
&lt;&lt;inflate 30 -100&gt;&gt;
&lt;p&gt;You step back from the well, unsure about what to do next. When suddenly you feel a sensation of bubbling from your middle. 
&lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;But apart from getting you wet, your gift doesn&#39;t seem to impress whatever spirits inhabit this place- you wait a good few minutes, but nothing happens. You don&#39;t even feel particularly hungry right now (for once). With a grunt of disappointment you turn and head back down the tunnel, emerging into the $sunlight. Wishing well, smishing well... &lt;/p&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="382" name="Wishing well" tags="hills" position="3475,2700" size="100,100">As you $walk through the hills, you notice a hole in the rockface just ahead, the surrounding rocks shaggy with moss. At first you think it’s just a natural crack in the hillside, but when you stick your head closer you get a sense of depth from the darkness beyond. Maybe it’s some kind of tunnel. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Investigate well&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave well&quot;&gt;&gt;&lt;&lt;set $eventCounterA = 0&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="383" name="hills randomization" tags="" position="3700,2575" size="100,100">/*Ticks up random events counters*/
&lt;&lt;set $hillsRandomization.combat += $hillsRandomization.combatRate&gt;&gt;

&lt;&lt;set $hillsRandomization.special += $hillsRandomization.specialRate&gt;&gt;

&lt;&lt;set $hillsRandomization.leave += $hillsRandomization.leaveRate&gt;&gt;

&lt;&lt;set $hillsRandomization.minor += $hillsRandomization.minorRate&gt;&gt;
/**/

/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;

&lt;&lt;if $hillsRandomization.special &gt; $hillsRandomization.combat&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hillsRandomization.minor &gt; $hillsRandomization.special&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;minor&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hillsRandomization.leave &gt; $hillsRandomization.minor&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;leave&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
/**/

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;

/*A random combat*/
&lt;&lt;case &quot;combat&quot;&gt;&gt;
	&lt;&lt;set $hillsRandomization.combat = 0&gt;&gt;
	&lt;&lt;set _event = &quot;Hills ambush&quot;&gt;&gt;

/*A special event*/
&lt;&lt;case &quot;special&quot;&gt;&gt;
	&lt;&lt;set $hillsRandomization.special = 0&gt;&gt;

	&lt;&lt;switch random(1,4)&gt;&gt;
		&lt;&lt;case 1&gt;&gt;
			&lt;&lt;set _event = &quot;Dessert village&quot;&gt;&gt;
		&lt;&lt;case 2&gt;&gt;
			&lt;&lt;set _event = &quot;Wishing well&quot;&gt;&gt;
		&lt;&lt;case 3&gt;&gt;
			&lt;&lt;set _event = &quot;Wishing well&quot;&gt;&gt;
		&lt;&lt;case 4&gt;&gt;
			&lt;&lt;set _event = &quot;Wishing well&quot;&gt;&gt;
		&lt;&lt;default&gt;&gt;
		&#39;&#39;Error in special event randomization!&#39;&#39;
	&lt;&lt;/switch&gt;&gt;

/*A random minor scene*/
&lt;&lt;case &quot;minor&quot;&gt;&gt;
 	&lt;&lt;set $hillsRandomization.minor = 0&gt;&gt;
	&lt;&lt;set _event = &quot;Minor Hills events&quot;&gt;&gt;

/*Opportunity to leave the forest*/
&lt;&lt;case &quot;leave&quot;&gt;&gt;
  	&lt;&lt;set $hillsRandomization.leave = 0&gt;&gt;
	&lt;&lt;set _event = &quot;Path out of the hills&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
  &#39;&#39;Error in hills randomization!!!&#39;&#39;

&lt;&lt;/switch&gt;&gt;


&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Hills&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;hills&quot; &quot;Hills&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;mountain&quot; &quot;Mountains&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="384" name="Boat Captain Island" tags="" position="775,1850" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the boat captain&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;This island is inhabited mostly by the dinosaur folk, who I trade with. They&#39;ve got excellent steel here, and I&#39;m told it&#39;s thanks to their connection with the earth. You ask me, that big volcano&#39;s got something to do with it, too.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Be polite around the really important folks here. The leader&#39;s got a bit of a temper, but if you&#39;re smart, you can make friends pretty easy.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;I&#39;ve heard the jungle&#39;s getting worse thanks to some things going on around here. Me, I plan to stick with the sea anyways.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;The fish out here are just slightly different than those back by the mainland. A little more robust, a little more flavorful. Couldn&#39;t tell you why.&quot;
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="385" name="Broken Greatsword" tags="" position="75,1575" size="100,100">&lt;&lt;if !setup.questStarted($swordQuest)&gt;&gt;
	&quot;Ah, the sword. That weapon, honestly, frightens me somewhat. According to my master&#39;s notes, $npc1.he did not actually forge this weapon, merely found and repaired it $npc1.himself long ago. The weapon is a single piece of obsidian, and even shattered, it is home to a powerful, angry spirit. If I am to make it whole, I will need a sample of the obsidian near the volcano. A great power dwells there, and may be enough to reform this weapon. Follow this map if you wish, but I won&#39;t be upset if you don&#39;t.&quot;
	&lt;&lt;getItem $swordMap&gt;&gt;
	&lt;&lt;getQuest $swordQuest&gt;&gt;
	
&lt;&lt;elseif !setup.questReady($swordQuest)&gt;&gt;
	&quot;Ah, the sword. That weapon, honestly, frightens me somewhat. According to my master&#39;s notes, $npc1.he did not actually forge this weapon, merely found and repaired it $npc1.himself long ago. The weapon is a single piece of obsidian, and even shattered, it is home to a powerful, angry spirit. If I am to make it whole, I will need a sample of the obsidian near the volcano. A great power dwells there, and may be enough to reform this weapon. Follow the map I gave you if you wish, but I won&#39;t be upset if you don&#39;t.&quot;
	
&lt;&lt;else&gt;&gt;
	You place a sample of the magical obsidian you found before $npc1.him, and $npc1.he examines it thoroughly, nodding slowly. Carefully, $npc1.he wraps the fractured sword in cloth and brings it over, setting the pieces directly onto the hot coals. Placing the obsidian you brought on top of the pile, $npc1.he grabs a small knife and makes a small cut on $npc1.his palm, not even wincing before dripping some of $npc1.his blood onto the fire. The flames suddenly roar to immense size, and $npc1.he quickly rushes over and grabs a totem, placing it before the forge. $npc1.He yells a phrase in a language you can&#39;t understand and the totem begins to glow as $npc1.he repeats it again and again. Slowly, the fires die down, and when its blinding light fades, in place of fragmented obsidian is an enormous black blade. $npc1.He lifts it out with tongs, places a hand near it, then hesitantly offers it to you. &quot;This wicked sword is remade. Though I fear I curse you with it, it is yours to wield. Be safe, adventurer.&quot; As you take it, the sword isn&#39;t even hot from the inferno it made. 
	&lt;&lt;removeItem $magicalObsidian&gt;&gt;
	&lt;&lt;removeItem $swordMap&gt;&gt;
	&lt;&lt;questReward $swordQuest&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questCompleted($spearQuest) and setup.questCompleted($hammerQuest) and setup.questCompleted($swordQuest)&gt;&gt;
	&lt;&lt;addPretext &quot;I believe I&#39;ve learned the lessons my master wanted me to, adventurer, and I thank you for your assistance. I&#39;m going to begin work on some new items using all that I&#39;ve learned.&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="386" name="Chief" tags="" position="200,1725" size="100,100">&lt;&lt;createFixedNPC &quot;chief&quot;&gt;&gt;

You head into a building decorated with bright plants and a couple small, intricate totems that glow with a soft light. Inside, you see a large $npc1.species dressed in an intricate, feathered robe and wearing a crown of feathers and gemstones. $npc1.He is slouching in an ornate stone seat and deep in thought before perking up at your presence. &quot;Outsider,&quot; $npc1.he rumbles, &quot;I am the leader of these people. State your business.&quot;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Tyrannosaurus chief says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;if !setup.questCompleted($defeatShaman)&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Quest&quot; &quot;Defeat the shaman&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You $walk through the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="387" name="Defeat the shaman" tags="" position="200,1825" size="100,100">&lt;&lt;if !setup.questStarted($defeatShaman)&gt;&gt;
You inquire about how you might help, and $npc1.he leans back, crossing $npc1.his short arms over $npc1.his chest. &quot;If you&#39;ve got the stomach, I&#39;d like to ask you for your help in dealing with our problem directly,&quot; $npc1.he growls out. &quot;This whole mess started when several shaman started trying to convince everyone that the oddities happening in the world were a result of shifting spiritual power,&quot; $npc1.he explains. &quot;Declaring that the spirits had spoken and that we should listen, they took offense when I tried to get them to listen to reason.&quot; A snarl crosses $npc1.his face as $npc1.he gets visibly angry. &quot;A shaman&#39;s job is to maintain balance, not mindlessly follow the spirits!&quot; $npc1.he nearly roars, then pauses to compose $npc1.himself. &quot;Go. Out into the jungle. Find them. Beat the sense back into them. Then return to me. You will be rewarded.&quot;
&lt;&lt;getQuest $defeatShaman&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;You got it&quot; &quot;Island Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;if setup.questReady($defeatShaman)&gt;&gt;
You report that you have bested several of the shaman, at which the chief nods approvingly. &quot;That simplifies things a little,&quot; $npc1.he grumbles. &quot;You&#39;ve made this at least a bit easier on us, adventurer, so as I promised, I shall make this worth your while.&quot; $npc1.He tosses a heavy sack of gold at your feet, which makes a lovely clattering thud. 
&lt;&lt;questReward $defeatShaman&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Quest completed&quot; &quot;Island Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&quot;I can tell just by looking at you that you haven&#39;t beaten enough of the shaman yet. What exactly are you waiting for?&quot; $npc1.His mouth curls up slightly, exposing teeth in a barely-subdued snarl. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;Island Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="388" name="Headless giant mace" tags="" position="75,1475" size="100,100">&lt;&lt;createFixedNPC &quot;starShaman&quot; 2&gt;&gt;

&lt;&lt;if !setup.questStarted($hammerQuest)&gt;&gt;
	&quot;This great mace once used a massive chunk of star metal as its head. However, the last one to wield this was lost in the jungle, and I am told that the head has since been found. Unfortunately, it was found by one of the rebelling shaman, who now uses it as a potent focus for $npc2.his magics. $npc2.He&#39;s not being very subtle about $npc2.his location, so if you follow this map, you are sure to find $npc2.him. Please be careful.&quot;	
	&lt;&lt;getItem $hammerMap&gt;&gt;
	&lt;&lt;getQuest $hammerQuest&gt;&gt;
	
&lt;&lt;elseif !setup.questReady($hammerQuest)&gt;&gt;
	&quot;This great mace once used a massive chunk of star metal as its head. However, the last one to wield this was lost in the jungle, and I am told that the head has since been found. Unfortunately, it was found by one of the rebelling shaman, who now uses it as a potent focus for $npc2.his magics. $npc2.He&#39;s not being very subtle about $npc2.his location, so if you follow the map I gave you, you are sure to find $npc2.him. Please be careful.&quot;
	
&lt;&lt;else&gt;&gt;
	You set down the huge hunk of star metal with a thud, and $npc1.he gives it a looking over before nodding approvingly. Taking it to the forge, $npc1.he carefully heats it, the metal glowing but not melting. Using tongs, $npc1.he removes a small piece that looks to be where it broke free from the shaft, then sets to work reforging the hilt itself. While the pieces of metal are still glowing hot, $npc1.he fits the shaft into the fallen star, hammering it home a few times before dousing it in water. With a violent hiss, a great gout of steam rushes up through the air and out of the building. After a few more moments, $npc1.he removes it and presents it to you. &quot;This has taught me much, and I thank you,&quot; $npc1.he says, bowing her head humbly. &quot;May this weapon serve you well.&quot;
	&lt;&lt;removeItem $hammerMap&gt;&gt;
	&lt;&lt;removeItem $fallenStar&gt;&gt;
	&lt;&lt;questReward $hammerQuest&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questCompleted($spearQuest) and setup.questCompleted($hammerQuest) and setup.questCompleted($swordQuest)&gt;&gt;
	&lt;&lt;addPretext &quot;I believe I&#39;ve learned the lessons my master wanted me to, adventurer, and I thank you for your assistance. I&#39;m going to begin work on some new items using all that I&#39;ve learned.&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="389" name="Island Docks" tags="" position="775,1750" size="100,100">&lt;&lt;createFixedNPC &quot;captain&quot;&gt;&gt;

You head away from the village and onto the dock. The $npc1.species $npc1.man and $npc1.his boat are waiting there. Noticing you, $npc1.he calls out, &quot;Hello again, $p.sir! You need a ride back to the mainland?&quot; 
&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Boat Captain Island&quot;&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;ocean&quot; &quot;Sail East&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;leave&quot; &quot;Go back&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You $walk through the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="390" name="Island Shaman" tags="" position="525,1500" size="100,100">&lt;&lt;createFixedNPC &quot;shaman&quot;&gt;&gt;

You $walk into a building decorated by many different totems that run the gamut from almost imperceptibly glowing to radiating magic visibly. Within, $npc1.article $npc1.species garbed in wildly colored, feathered robes busies $npc1.himself before a totem. $npc1.He mutters quietly in a language you don&#39;t understand before turning about to face you, at which point the oddity of $npc1.his action becomes clear, as both $npc1.his eyes are white with blindness. &quot;You have the adventurer&#39;s spirit,&quot; $npc1.he intones. &quot;What can this friend of spirits do for you?&quot;


&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Shaman says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;action &quot;w&quot; &quot;spells&quot; &quot;Study with shaman&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;vendor &quot;Island shaman&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells&quot; &quot;Learn spells from shaman&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You $walk through the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="391" name="Island Smithee" tags="" position="275,1475" size="100,100">&lt;&lt;createFixedNPC &quot;jungleSmith&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;sampson&quot; 2&gt;&gt;

&lt;p&gt;You head into the smithery, a small, cramped building with a hole in the center of the roof that allows the heat and smoke of the forge to escape. A lightly-garbed, stocky $npc1.species $npc1.gentleman is examining several odd looking ingots of metal carefully. On noticing you, $npc1.he looks up and says, &quot;Welcome, traveller. I have some stock you can buy, but most of my goods are made to order.&quot;
&lt;/p&gt;

&lt;&lt;set _questsDone = 0&gt;&gt;
&lt;&lt;if setup.questCompleted($spearQuest)&gt;&gt;&lt;&lt;set _questsDone++&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.questCompleted($hammerQuest)&gt;&gt;&lt;&lt;set _questsDone++&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.questCompleted($swordQuest)&gt;&gt;&lt;&lt;set _questsDone++&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;switch _questsDone&gt;&gt;
&lt;&lt;case 0&gt;&gt;You can see three curious, intricately designed weapons hanging on a wall, but they appear to be broken. 
&lt;&lt;case 1&gt;&gt;Two weapons still hang on the wall, incomplete. 
&lt;&lt;case 2&gt;&gt;Only one more weapon hangs on the wall in disrepair. 
&lt;&lt;/switch&gt;&gt;


&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Island smithee says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;if setup.questCompleted($spearQuest) and setup.questCompleted($hammerQuest) and setup.questCompleted($swordQuest)&gt;&gt;
	&lt;&lt;vendor &quot;Island smithee special&quot;&gt;&gt;	
&lt;&lt;else&gt;&gt;
	&lt;&lt;vendor &quot;Island smithee&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;Island smithee store&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Option for the Smithee&#39;s quest*/
&lt;&lt;if !setup.questCompleted($spearQuest) or !setup.questCompleted($hammerQuest) or !setup.questCompleted($swordQuest)&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;quest&quot; &quot;Quest&quot; &quot;Island smithee quest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Option for Sampson&#39;s quest. Could be cleaned up*/
&lt;&lt;if setup.questStage($horseQuestArmor) &gt;= 0 and setup.questStage($horseQuestArmor) &lt;= 3&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;quest&quot; &quot;Repair $npc2.Name&#39;s chainmail&quot; &quot;Repair Sampson&#39;s chainmail&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = setup.questStage($horseQuestArmor)&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You $walk through the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="392" name="Island Town" tags="jungle" position="525,1725" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch $daytime&gt;&gt;
&lt;&lt;case &quot;night&quot;&gt;&gt;
The village is quiet, lit by starlight and serenaded by nocturnal insects&#39; calls. 

&lt;&lt;default&gt;&gt;
Various reptillian folk garbed in simple leathers decorated by feathers and colored leaves going about their daily business. 

/*Create dinosaur npcs*/
&lt;&lt;createNPC &quot;dinosaur&quot; &quot;random&quot; 1&gt;&gt;
&lt;&lt;createNPC &quot;dinosaur&quot; &quot;random&quot; 2&gt;&gt;

&lt;&lt;switch random(1,4)&gt;&gt;
&lt;&lt;case 1&gt;&gt;$npc1.Article $npc1.species walks by carrying a bowl full of exotic fruits. 

&lt;&lt;case 2&gt;&gt;You can see $npc1.article $npc1.species and $npc2.article $npc2.species wearing shamanistic garb having a discussion. 

&lt;&lt;case 3&gt;&gt;You see what appears to be a warrior $npc1.species checking her heavy weapon and pleated armor before heading toward the jungle. 

&lt;&lt;case 4&gt;&gt;You spot $npc1.article $npc1.species carrying an intricate magical totem. 

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;ocean&quot; &quot;Docks&quot; &quot;Island Docks&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;action &quot;nw&quot; &quot;store&quot; &quot;Island Smithee&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;action &quot;s&quot; &quot;forest&quot; &quot;Jungle&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;action &quot;se&quot; &quot;inn&quot; &quot;Jungle Inn&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;action &quot;sw&quot; &quot;house&quot; &quot;Chief&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;action &quot;w&quot; &quot;spells&quot; &quot;Island Shaman&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;else&gt;&gt;
&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="393" name="Island smithee quest" tags="" position="175,1475" size="100,100">You ask about the broken weapons, and a frown creases $npc1.his face as $npc1.he launches into an explanation. &quot;My master left those for me before disappearing to parts unknown. Unfortunately, they all require different materials for the repairs to be complete, and the only thing they have in common is that they&#39;re hard to get. I know of some locations that have what I need, but they&#39;re dangerous. If you can help me complete them, you can have them. All I need from them is the experience of rebuilding them, you see.&quot; $npc1.He gestures at them and asks, &quot;Do you have one you&#39;d like to know more about?&quot; 

&lt;&lt;if !setup.questCompleted($spearQuest)&gt;&gt;
	&lt;&lt;action &quot;w&quot; &quot;quest&quot; &quot;Ornate spear shaft&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if !setup.questCompleted($hammerQuest)&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;quest&quot; &quot;Headless giant mace&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if !setup.questCompleted($swordQuest)&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Broken Greatsword&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="394" name="Island smithee says" tags="" position="175,1575" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the smith&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;My name is $npc1.Name, and I run this smithery. Pleasure to meet you, adventurer.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Weapons are the specialty of this shop, but I can assure you that I&#39;m no slouch when it comes to armors either. Can&#39;t fight when your bits are exposed, right?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;I&#39;m afraid that I&#39;m not quite as good as my master was yet. $npc1.He was famous throughout the island and made some truly superb weapons.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;My master disappeared some time ago.&quot;
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="395" name="Island smithee store" tags="" position="275,1375" size="100,100">&quot;I don&#39;t have too much on hand, but if any of these are to your liking, let me know.&quot;


&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="396" name="Jungle Inn" tags="" position="675,1525" size="100,100">&lt;&lt;createFixedNPC &quot;jungleInnkeeper&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;jungleSmith&quot; 2&gt;&gt;

You $walk into a cozy looking inn warmed by an open fire pit that several reptillian folks are gathered around, chatting amiably as they cook meats over it. A $npc1.species $npc1.man ornamented in brightly colored garb waves at you from a seat nearby. It seems that the beds in the back are open to any who need them. 
&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Raptor innkeeper says&quot;&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Sleep&quot; &quot;Jungle Inn sleep&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You head back out to the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="397" name="Jungle Inn sleep" tags="" position="675,1425" size="100,100">&lt;&lt;setPassageTitle &quot;Sleep&quot;&gt;&gt;

You take one of the empty beds for your own and drift off to sleep, the fire keeping you warm and the bed keeping you cozy. 
&lt;&lt;sleep&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You head back out to the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Sleep&quot; &quot;Jungle Inn sleep&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="398" name="Learn spells from shaman" tags="" position="425,1400" size="100,100">&lt;&lt;teach&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Shaman&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="399" name="Ornate spear shaft" tags="" position="75,1375" size="100,100">&lt;&lt;if !setup.questStarted($spearQuest)&gt;&gt;
	&quot;According to my master&#39;s notes, that spear once had the power of lightning in its golden point. Unfortunately, as you can see, the spear&#39;s head is no more. I believe I can rebuild it, but I will need you to find a deposit of &#39;white gold.&#39; There is one in the jungle, but it&#39;s within the domain of a particularly dangerous serpent. I can give you a map to the location for when you&#39;re ready. &quot; 
	&lt;&lt;getItem $spearMap&gt;&gt;
	&lt;&lt;getQuest $spearQuest&gt;&gt;
	
&lt;&lt;elseif !setup.questReady($spearQuest)&gt;&gt;
	&quot;According to my master&#39;s notes, that spear once had the power of lightning in its golden point. Unfortunately, as you can see, the spear&#39;s head is no more. I believe I can rebuild it, but I will need you to find a deposit of &#39;white gold.&#39; There is one in the jungle, but it&#39;s within the domain of a particularly dangerous serpent. &quot;
	
&lt;&lt;else&gt;&gt;
	You hand over the white gold you recovered, and $npc1.he immediately sets to work, pumping the bellows to raise the furnace to something approaching an inferno. You stand well clear and watch as $npc1.he melts it down, casts it into a rough tip, and hammers it into a fine, shining blade. With care, $npc1.he binds the spearhead to the shaft, and as $npc1.he does, it glows radiantly for a moment. Somehow, the weapon not only looks whole, but invigorated and alive. With a nod, $npc1.he hands the weapon to you. &quot;I&#39;ve learned from this,&quot; $npc1.he says, bowing $npc1.his head humbly, &quot;and I thank you. May this weapon serve you well.&quot;
	&lt;&lt;removeItem $spearMap&gt;&gt;
	&lt;&lt;removeItem $whiteGoldChunk&gt;&gt;
	&lt;&lt;questReward $spearQuest&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questCompleted($spearQuest) and setup.questCompleted($hammerQuest) and setup.questCompleted($swordQuest)&gt;&gt;
	&lt;&lt;addPretext &quot;I believe I&#39;ve learned the lessons my master wanted me to, adventurer, and I thank you for your assistance. I&#39;m going to begin work on some new items using all that I&#39;ve learned.&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Return&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="400" name="Raptor innkeeper says" tags="" position="775,1525" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the innkeeper&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Greetings, traveller. Name is $npc1.Name. This is the hunter&#39;s hut, but you are welcome to use a bed.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Careful out in the jungle. With the ferals and the cult, hunting is not safe anymore.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Get a good weapon from $npc2.Name in the smithery before you go. $npc2.He is humble, but better than $npc2.he says $npc2.he is.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Do excuse me, I am better with island language than mainland. Chief tells us all to learn, though, so we are not mute off the island.&quot;
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="401" name="Repair Sampson&#39;s chainmail" tags="" position="175,1375" size="100,100">&lt;&lt;setPassageTitle &quot;Repair $npc2.Name&#39;s chainmail&quot;&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&lt;p&gt;You proffer the ruined set of chainmail, and a strange, reverent expression crosses $npc1.Name&#39;s face even before $npc1.he takes it from you. $npc1.He holds it up to the light, and sighs. &quot;Yes, this is the work of my Master, no doubt- I never saw $npc1.him make such armour, but $npc1.he spoke to me of it once- Myst Mail. $npc1.He said the links were spun from an unbroken strand of metal, and so unbreakable- from without, at least- and were also imbued with the charging spirit of swiftness itself to speed the wearer in combat. The enchantment is no more, its secret is gone with my Master, but I believe I can reforge these links for you, almost as strong as they ever were.&quot; &lt;/p&gt;

&lt;p&gt;When you explain that you wish for $npc1.his Master&#39;s creation to be resized &#39;for its current owner&#39;, and hand over the measurements, $npc1.Name at first looks as though $npc1.he suspects a bad joke, but then smiles. &lt;/p&gt;

&quot;In that case perhaps I should enchant this armour with the spirit of the Giant Python, to stretch around the wearer regardless of their... hearty appetite.&quot; //Good idea!// &quot;You will need to fetch three vials of sand-snake venom, and then you will need to travel deep into the sacred volcano and fight with the Fire Serpant therein to bring me one of her eggs before it- I am joking with you&quot; $npc1.he says patiently as $npc1.he sees your mortified expression. &quot;If you can bring me, say... three sets of ordinary chain mail, I should be able to weave them with my Master&#39;s well enough to produce one whole set of the size your friend now requires, with almost as much strength as it had before, and perhaps more... elasticity. But from the sound of it any supernatural swiftness is now... irrelevant.&quot; You are forced to agree with a wry smile. 

/*Advances quest*/
&lt;&lt;advanceQuest $horseQuestArmor&gt;&gt;
&lt;&lt;set $quests[setup.questIndex($horseQuestArmor)].description = [&quot;Get &quot;, $npc2.Name, &quot; the &quot;,  $npc2.species, &quot;&#39;s chainmail resized to fit &quot;, $npc2.him, &quot;! You need to get three sets of chainmail to &quot;, $npc1.Name, &quot; the Smithie.&quot;].join(&quot;&quot;)&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;m on it&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 1&gt;&gt;

/*If you don&#39;t have any chainmail armor*/
&lt;&lt;if setup.hasItem($chainmailArmor) &lt; 0&gt;&gt;
Right as you&#39;re about to ask $npc1.Name to repair $npc2.Name&#39;s armor, you remember you don&#39;t actually have any chainmail armor for $npc1.him to use. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh, right&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Expends chainmail and advances quest*/
&lt;&lt;else&gt;&gt;
&quot;Thank you. This will be very helpful, but I will still need two more sets.&quot;
&lt;&lt;removeItem $chainmailArmor&gt;&gt;
&lt;&lt;advanceQuest $horseQuestArmor&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;m on it&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;case 2&gt;&gt;
/*If you don&#39;t have any chainmail armor*/
&lt;&lt;if setup.hasItem($chainmailArmor) &lt; 0&gt;&gt;
Right as you&#39;re about to ask $npc1.Name to repair $npc2.Name&#39;s armor, you remember you don&#39;t actually have any chainmail armor for $npc1.him to use. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh, right&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Expends chainmail and advances quest*/
&lt;&lt;else&gt;&gt;
&quot;Thank you. This will be very helpful, but I will still need one more set.&quot;
&lt;&lt;removeItem $chainmailArmor&gt;&gt;
&lt;&lt;advanceQuest $horseQuestArmor&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;m on it&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;default&gt;&gt;
/*If you don&#39;t have any chainmail armor*/
&lt;&lt;if setup.hasItem($chainmailArmor) &lt; 0&gt;&gt;
Right as you&#39;re about to ask $npc1.Name to repair $npc2.Name&#39;s armor, you remember you don&#39;t actually have any chainmail armor for $npc1.him to use.
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;m on it&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Expends chainmail and advances quest*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;$npc1.Name smiles as you hand over the third and final set of chain-mail, and places it alongside the others on the forge, either side of the ruined Myst-Mail. &quot;Excellent. I am purified in mind and body for this task, and can begin straight away. But I cannot say how long this will take.&quot; You elect to wait, although outside, given the heat of the forge and the constant, near-deafening hammering, not to mention the bouts of ritual chanting. &lt;/p&gt;

&lt;p&gt;More quickly than you were expecting the noise ceases, and $npc1.Name appears in the doorway to beckon you back in. Folded over the anvil is an exceptionally large set of silvery chainmail, looking like the sail from some metal ship. It&#39;s still quite hot to the touch, so you pick it up by two corners. You find that it is lighter, and- you give it an experimental tug- far stretchier than most chain-mail, in your experience. &lt;/p&gt;

$npc1.Name smiles at your surprise. &quot;I shall call it Stretch Mail: I suspect that it may become quite popular when people hear of it. There is no charge- I am grateful to have been allowed to see my Master&#39;s work again, and for the knowledge I was able to gain by studying it. And I now have a secret technique that is my OWN invention. Do call again- I will work on that snake enchantment, I promise.&quot; You notice that $npc1.he has even managed to re-assemble the gold $npc2.nspecies emblem on the chest- though somehow the process has resulted in a far chunkier-looking beast being portrayed. 
&lt;&lt;removeItem $chainmailArmor&gt;&gt;
&lt;&lt;removeItem $horseArmorBroke&gt;&gt;
&lt;&lt;advanceQuest $horseQuestArmor&gt;&gt;
&lt;&lt;getItem $horseArmorFixed&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;m on it&quot; &quot;Island Smithee&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="402" name="Sail East" tags="" position="900,1750" size="100,100">&lt;p&gt;&lt;&lt;if setup.weight() &gt; 600&gt;&gt;You cautiously step aboard the vessel, your heavy body causing it to sway deeply when you do so. After a moment it settles back to a light sway. Fortunately, the $npc1.species doesn&#39;t seem bothered by this. 
&lt;&lt;else&gt;&gt;You step aboard onto the lightly swaying vessel. 
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;p&gt;&quot;The boat&#39;s loaded up and we&#39;re set to head off,&quot; $npc1.he says chipperly. &quot;Take a load off, friend, and I&#39;ll get us under way!&quot; $npc1.He weighs the anchor and shoves off, and you&#39;re out onto the open sea again. &lt;/p&gt;

&lt;&lt;switch random(1,8)&gt;&gt;

&lt;&lt;case 1&gt;&gt;You spend the trip fishing, but the captain takes what you catch as a fare. 
&lt;&lt;case 2&gt;&gt;The trip is spent singing progressively more outlandish songs about things that almost certainly never happened. 
&lt;&lt;case 3&gt;&gt;The captain spends the entire time regaling you with facts about fishing that you will never, ever use. 
&lt;&lt;case 4&gt;&gt;The captain talks about the dozens of ways you can prepare a fish. $npc1.He never seems to run out. 
&lt;&lt;case 5&gt;&gt;The trip is a little worrying as the captain somehow takes a nap that lasts the duration. Fortunately, $npc1.he wakes up in time to dock safely. 
&lt;&lt;case 6&gt;&gt;You manage to get a view of a pod of &lt;&lt;=$dolphin.plural&gt;&gt; swimming by. One of them waves at you cheerfully. 
&lt;&lt;default&gt;&gt;&lt;&lt;switch random(1,4)&gt;&gt;
&lt;&lt;case 1&gt;&gt;The captain spends the trip weaving consecutively bigger lies about the loves $npc1.he&#39;s had and lost. You call $npc1.him out around the time $npc1.he tries to convince you $npc1.he picked a flower from the moon to swoon some damsel or another. The rest of the trip is spent with awkward silence and sheepish expressions from $npc1.him. 
&lt;&lt;case 2&gt;&gt;The captain regales you with a certainly-false tale of $npc1.his chance encounter with a &lt;&lt;=$brownBear.species&gt;&gt;-maid, a mystical creature with the upper body of a beautiful lady &lt;&lt;=$brownBear.species&gt;&gt; and the lower body of a $dolphin.species. $npc1.He looks a bit dismayed when you just shake your head at $npc1.his nonsense. 
&lt;&lt;case 3&gt;&gt;The captain spends the entire trip spinning tales of great sea monsters, claiming that a giant, three-headed sea snake is the reason why there aren&#39;t very many ships. $npc1.He seems put off when you bring up the point that there just isn&#39;t all that much else out there so far as anyone knows. 
&lt;&lt;case 4&gt;&gt;The captain spends a great deal of time telling you about a poem that $npc1.he received from another sea farer in $npc1.his travels. Specifically, about the lengths $npc1.he&#39;s gone to to try to understand it. When you ask for a look, you can&#39;t make too much of it either, but it&#39;s got something to do with a poet eating &lt;&lt;=$lion.plural&gt;&gt;. 
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;To port&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="403" name="Shaman says" tags="" position="425,1500" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the shaman&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;chief&quot; 2&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;My name is $npc1.Name, and it is my duty to create the wards that keep this place safe, as well as train those interested in calling upon the spirits.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;It pains me that so many of my students have left the path of balance, but I do understand their confusion. The spirits are in turmoil, and the ethereal world groans with the pain of this shifting.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Our leader is temperamental, true, but $npc2.his anger is only for that which would do harm to us all. $npc2.He has our best interests at heart, though I do still strive to help $npc2.him calm $npc2.his inner fires, lest $npc2.he get burned.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;My eyes? I traded my vision of this world for true sight long ago... Though perhaps it is more accurate to say that gaining such sight was a cost more than a trade. Tread lightly around powerful spirits, adventurer.&quot;
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="404" name="Study with shaman" tags="" position="525,1400" size="100,100">&lt;&lt;doTime 30&gt;&gt;

&lt;&lt;if $fat &gt;= 5&gt;&gt;
You spend some time under the tutelage of the head shaman. You feel wiser in the ways of the natural world, but the study has taken its toll on your body. 
&lt;&lt;changeStats &quot;fat&quot; -5&gt;&gt;
&lt;&lt;changeStats &quot;int&quot; 0.5&gt;&gt;
&lt;&lt;updatePanels&gt;&gt;

&lt;&lt;else&gt;&gt;
You spend some time under the tutelage of the head shaman, but can&#39;t quite get into the mindset to learn in your current state. 

&lt;&lt;/if&gt;&gt;


&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Shaman says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;action &quot;w&quot; &quot;spells&quot; &quot;Study with shaman&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;vendor &quot;Island shaman&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells&quot; &quot;Learn spells from shaman&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;set $travel = 1&gt;&gt;
	&lt;&lt;addPretext &quot;You $walk through the village. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="405" name="Tyrannosaurus chief says" tags="" position="100,1725" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the chief&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;My name is $npc1.fullName. Outsiders tend to have trouble with that, so you can call me $npc1.Name.&quot; 
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;You might notice, outsider, that the people here have not fallen entirely to gluttony. That is because those that have did so quite vocally, and have left this place. They believe that the changes to the world mark a change in spiritual balance that is to be followed, not opposed.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;We are dealing with handling this conflict, but outside assistance would not be refused. If you are strong of arm and brave of heart, you might be of use to us.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;I swear, the next one of you mainlanders that calls me &#39;Rex&#39; is getting eaten. I don&#39;t even care.&quot;
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="406" name="Climb the pitcher plant" tags="" position="575,2725" size="100,100">&lt;&lt;if random(1,100) &lt;= 60&gt;&gt;
	&lt;p&gt;You carefully climb up the plant, its rough surface providing surprisingly good traction as you make your way to the oozing bud. It is just within your reach, but the moment you touch it, the bud suddenly rolls up on top of you, sending you slipping into the tubular leaf and splashing into the pooled nectar below. The sun&#39;s light is soon filtered through the closed top of the leaf, leaving you stuck in a dark, sweet trap! &lt;/p&gt; 
	
	You&#39;ve fallen into the pitcher plant&#39;s leaf, and are floating in its nectar, which is starting to sting a little bit. A quick testing proves that this plant is quite resilient from the inside, so cutting your way out isn&#39;t an option. You might be able to brute force the top of the leaf back open if you can reach it, and if push comes to shove, you&#39;re certain you&#39;ll be out of trouble if you can drink down all the nectar. 
	
	&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Drink from the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Fight the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
	You carefully climb up the plant, its rough surface providing surprisingly good traction as you make your way to the oozing bud. It&#39;s almost too easy when you put your mouth to it and start gulping down its nectar, which is somewhat thin and slightly acidic, but quite sweet. 
	&lt;&lt;set _nectar = random(8,16)&gt;&gt;
	&lt;&lt;set _calories = random(6,12)&gt;&gt;
	&lt;&lt;consume _nectar _calories&gt;&gt;
	&lt;&lt;if !$alive&gt;&gt;
		The last couple of swallows prove to be too much for your overfull stomach, however, and you groan, clutching at your $waist belly. As if on cue, the bud rolls down, sending you sliding into the tubular leaf and splashing into the nectar pooled within. The light from above fades as you find yourself floating and trapped inside, the sticky liquid leaving you floating on your back, belly up in the air. Too full to fight your way out, you opt to rub your overstuffed belly and drift off to sleep, barely even feeling it when the plant begins to digest you. 

		&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Drink from the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="407" name="Cultist village" tags="" position="275,2600" size="100,100">&lt;&lt;setEnemy $gluttonSeparatistBoss&gt;&gt;
As you work your way through the jungle, you come across a small, fortified settlement. A fat $npc1.species can be seen looking about as $npc1.he  patrols back and forth in front of the open gate. Judging by the banner being flown, this looks like a hostile stronghold. You haven&#39;t been spotted yet, and so you might just be able to get in without raising suspicion of you&#39;re fast and smart about it. All else fails, you can force your way through. 

&lt;&lt;action &quot;w&quot; &quot;run&quot; &quot;Sneak into cultist village&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Fight into cultist village&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave cultist village&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="408" name="Drink from the pitcher plant" tags="" position="700,2725" size="100,100">&lt;&lt;if random(1,100) &lt; 25&gt;&gt;
	&lt;p&gt;After your last few swallows, the bud suddenly rolls down on you, sending you slipping into the tubular leaf and splashing into the pooled nectar below. It grows somewhat dark as the $sun&#39;s light is soon filtered through the closed top of the leaf. &lt;/p&gt;
	
	You&#39;ve fallen into the pitcher plant&#39;s leaf, and are floating in its nectar, which is starting to sting a little bit. A quick testing proves that this plant is quite resilient from the inside, so cutting your way out isn&#39;t an option. You might be able to brute force the top of the leaf back open if you can reach it, and if push comes to shove, you&#39;re certain you&#39;ll be out of trouble if you can drink down all the nectar. 
	
	&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Drink the nectar&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Fight the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;else&gt;&gt;
	You gulp down several more mouthfuls of nectar, the tangy sweetness almost addictive as it fills out your $waist stomach. 
	&lt;&lt;set _nectar = random(8,16)&gt;&gt;
	&lt;&lt;set _calories = random(6,12)&gt;&gt;
	&lt;&lt;consume _nectar _calories&gt;&gt;
	&lt;&lt;if !$alive&gt;&gt;
		&lt;p&gt;The last couple of swallows prove to be too much for your overfull stomach, however, and you groan, clutching at your $waist belly. As if on cue, the bud rolls down, sending you sliding into the tubular leaf and splashing into the nectar pooled within. The light from above fades as you find yourself floating and trapped inside, the sticky liquid leaving you floating on your back, belly up in the air. Too full to fight your way out, you opt to rub your overstuffed belly and drift off to sleep, barely even feeling it when the plant begins to digest you. &lt;/p&gt;

		&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;
	
	&lt;&lt;else&gt;&gt;

		&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Drink from the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="409" name="Drink the nectar" tags="" position="700,2850" size="100,100">&lt;&lt;set _drink = random(15,25)&gt;&gt;
&lt;&lt;set _calories = Math.round(_drink*0.75)&gt;&gt;
&lt;&lt;set $eventCounterB -= _drink&gt;&gt;

&lt;p&gt;You dip your head under the pool and take a several gulps of the nectar. 
&lt;&lt;consume _drink _calories&gt;&gt;

&lt;&lt;if $eventCounterB &gt; 150&gt;&gt;There&#39;s still a whole lot of nectar left to drink, and you&#39;re feeling $hungry. 
&lt;&lt;elseif $eventCounterB &gt; 100&gt;&gt;You&#39;ve drunk a sizable amount of the nectar, and are feeling $hungry. 
&lt;&lt;elseif $eventCounterB &gt; 50&gt;&gt;Most of the nectar is now in your $waist belly, and you are feeling $hungry. 
&lt;&lt;else&gt;&gt;You&#39;re almost there, the bottom of the plant is under your feet, though most of the space is now taken up by your $waist stomach, which is quite full of nectar and making you feel $hungry. 
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

/*If you die*/
&lt;&lt;if !$alive&gt;&gt;
	&lt;p&gt;Your desperate drinking slows to a stop as your $waist belly begins to protest, stretched past its limits as you float in the pool of nectar. You let out a groan, rubbing your overstuffed belly tenderly as you slowly float onto your back. Between the tightness in your stomach and the dim lighting, you find yourself unable to keep struggling and slowly drift to unconsciousness in the belly of a plant, of all things.&lt;/p&gt; 
	
	&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;

/*If you&#39;re still going*/
&lt;&lt;elseif $eventCounterB &gt; 0&gt;&gt;
	&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Drink the nectar&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Fight the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*If you succeed*/
&lt;&lt;else&gt;&gt;
	Scooping up the last few handfuls of nectar and gulping them down, you suddenly find yourself in a dry, empty tubular leaf. Apparently confused by this, the plant unrolls, giving you a clear way to get out. Your $waist belly sloshing, you take the opportunity and scramble out (as much as you can, at least) and back down to the forest floor. Still soaked with nectar, you head off to clean up a bit before continuing your exploration. 
	
	&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="410" name="Fight into cultist village" tags="" position="275,2725" size="100,100">You throw caution to the wind and run straight for the guard, $wea.name raised for a fight. From the looks of $npc1.him, that&#39;s exactly what you&#39;re going to get! 

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="411" name="Fight the pitcher plant" tags="" position="575,2850" size="100,100">/*Add some sort of fail state for fighting your way out*/

&lt;&lt;switch setup.skillTest($agi + $str, 90)&gt;&gt;
	&lt;&lt;case true&gt;&gt;
		With no small amount of effort, you manage to force your way up the smooth, slick sides of the plant and to the rolled up top. Despite a lack of leverage, you easily push the plant open, making an opening wide enough for you to slip out of. A dripping mess, you slide out of the plant and back to the jungle floor, heading off to clean yourself up before continuing your exploration. 
		&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;
	
	&lt;&lt;case false&gt;&gt;
		&lt;&lt;if $agi &lt; $str&gt;&gt;
			You try to climb up the sides from within, but the nectar has slickened the smooth insides of the plant, and you fail to get more than a few inches up out of the pool. 
		&lt;&lt;else&gt;&gt;
			You make it up to the rolled top of the leaf, scrabbling up the slick insides of the plant, but your leverage doesn&#39;t allow you to force it open wide enough to climb out before you&#39;re sent sliding back down into the pool below. 
		&lt;&lt;/if&gt;&gt;	
		
		&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Drink the nectar&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Fight the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
		
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="412" name="Follow hammer map" tags="" position="350,2350" size="100,100">&lt;&lt;setEnemy $starShaman&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;starShaman&quot;&gt;&gt;

You follow the map into the jungle, not having to go very far before finding freshly worn foot paths. Following them in the appropriate direction leads you to a barricaded structure. Fortunately, the gate is open, and you make your way inside. There, the shaman is performing some kind of ritual around a totem that is topped with the Fallen Star. $npc1.He suddenly stops, pointing at you. From behind, you hear a creaking of wood as the gate crashes shut. Looks like the only way out is a fight! 

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="413" name="Follow spear map" tags="" position="350,2250" size="100,100">You follow the map deep into the jungle, the landmarks upon it proving usable, even if you do have to climb a tree to see them a couple of times. When you arrive in the marked location, you come across a hole in the ground. When you approach, an enormous snake begins to slide out of it. More and more of the giant snake emerges, and it soon becomes apparent that you are trapped in the area by its enormously lengthy body! 
&lt;&lt;setEnemy $anacondaBoss&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="414" name="Follow sword map" tags="" position="350,2150" size="100,100">You follow the map through the jungle and towards the center of the island, climbing up the side of the volcanic mountain. The heat begins to grow immense as you steadily approach the deposit, which is uncomfortably close to the open peak. Fortunately, you don&#39;t have to go much further, as the obsidian lies before you. Before you can take any of it, though, a deep, booming growl echoes from the mountain, forming obscure arcane syllables. As you watch, the obsidian rises up, taking a rough anthropomorphic form, and marches to you in time to a magical barrier trapping you in with it! 
&lt;&lt;setEnemy $golemBoss&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="415" name="Got inside cultist village" tags="" position="275,2850" size="100,100">Inside the fortifications, there are several hastily-built huts surrounding an unusual looking totem atop a stone shrine. Before it, a shaman in feathered robes dances and chants in a language you don&#39;t understand. 

&lt;&lt;if !setup.questCompleted($defeatShaman) and setup.questStarted($defeatShaman)&gt;&gt;
	The chief asked you to beat some sense back into some shaman, and it looks like this one will do just fine. 
&lt;&lt;/if&gt;&gt;

As you approach, the Shaman seems to sense you, stopping and turning to face you, pointing accusingly and shouting threateningly. Several of the residents give a wide berth, watching to see what will happen next. 

&lt;&lt;startCombat $shamanBossNormal&gt;&gt;</tw-passagedata><tw-passagedata pid="416" name="Jungle" tags="jungle" position="450,2250" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	You find a comfortable spot to sit down and rest. 
	&lt;&lt;rest&gt;&gt;

	&lt;&lt;if random(1,5) == 1&gt;&gt;
		&lt;&lt;set _enemy = either($anaconda, $fatJaguar, $gluttonSeparatist, $dinosaurRider)&gt;&gt;
		&lt;&lt;setEnemy _enemy&gt;&gt;
		You are awoken from your sleep by $e.article $e.name! 
		
		&lt;&lt;startCombat&gt;&gt;

	&lt;&lt;else&gt;&gt;
		&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
&lt;p&gt;Densely packed trees surround you on all sides and form a dense canopy overhead, allowing very little light to hit the jungle floor and making it rather difficult to navigate through. A cacophony of sorrounds constantly accompanies you as you travel through the untamed wilds. A huge array of musical calls from countless unseen birds echo through the jungle. Every once in a while, with a huge &#39;&#39;thwump&#39;&#39; an incredibly colorful and obese &lt;&lt;=setup.getSpeciesData(&quot;parrot&quot;).species&gt;&gt; falls from a tree and hits the ground. They somehow always manage to drunkenly stumble to their feet and flap off with overburdened wings. An occasional rustle from the undergrowth causes you to turn, but whatever caused the sound always seems to slip out of reach. Thundering footsteps and shaking trees also sometimes heralds the travel of the larger jungle denizens. &lt;/p&gt;

Due to its hostile and untamed nature, as well as the general seclusion of the island itself, not much is known about the jungle. You occasionally you trip accross broken chunks of carved stone that were obviously part of some ancient society long since given to ruin. You consider for a moment if there&#39;s some connection with the dinosaur village you encountered when you arrived on the island, but the designs are clearly different from any of the architecture you saw before. 


&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="417" name="Leave cultist village" tags="" position="150,2600" size="100,100">You take advantage of the fact that you haven&#39;t been seen yet to remain that way, staying far from the stronghold to go explore elsewhere. 

&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="418" name="Leave the pitcher plant" tags="" position="700,2600" size="100,100">You decide not to bother with the plant&#39;s nectar and continue your exploration through the jungle. 

&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="419" name="Pitcher plant" tags="" position="575,2600" size="100,100">&lt;&lt;set $eventCounterB = 200&gt;&gt;
You are making your way through the jungle when you chance upon a huge plant with tubular green leaves nearly fifteen feet tall tinged with dark red at the top of a bud-like protrusion. On closer inspection, you can see that it leaks a honey-like nectar from these buds, and that the tubular leaves have deep pools of this nectar. Just looking at it makes you want to try some, but there&#39;s no easy way to get to it: You&#39;d have to climb up it and drink directly from the bud in a precarious position. 

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Climb the pitcher plant&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="420" name="Shaman defeated" tags="" position="275,2975" size="100,100">With the shaman bested, the onlookers are left astonished and mouths agape. 

&lt;&lt;if setup.questActive($defeatShaman)&gt;&gt;
	&lt;&lt;advanceQuest $defeatShaman&gt;&gt;
	&lt;&lt;set _quest = $quests[setup.questIndex($defeatShaman)]&gt;&gt;
	&lt;&lt;set _shamanLeft = _quest.goal - _quest.progress&gt;&gt;
	
	&lt;&lt;if _shamanLeft &gt; 0&gt;&gt;
		The chief still wants you to find _shamanLeft more shaman, but this is good progress. 
	&lt;&lt;else&gt;&gt;
		That was the last shaman the chief wanted you to take care of. Job well done! 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

You $walk out of the stronghold, having bested the leader, and head back out to the jungle unopposed. 

&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;&lt;br&gt;</tw-passagedata><tw-passagedata pid="421" name="Sneak into cultist village" tags="" position="150,2725" size="100,100">&lt;p&gt;You do your best to quietly approach the gate, hoping to get around the guard while $npc1.his back is turned. &lt;/p&gt;

/*sneak success*/
&lt;&lt;if setup.skillTest($agi + $int,120)&gt;&gt;
	&lt;&lt;if random(1,10) == 10&gt;&gt;
		You walk up to the guard and exclaim, &quot;Look behind you, a Three-Headed Monkey!&quot; When a look of confusion crosses $npc1.his face, you smash your fist into the side of $npc1.his head, knocking $npc1.him out cold. 
		
	&lt;&lt;else&gt;&gt;
		&lt;&lt;switch random(1,3)&gt;&gt;
			&lt;&lt;case 1&gt;&gt;
				With a thrown pebble as a distraction, you quietly dash around and inside as the $npc1.species turns $npc1.his head for a moment to locate the sound. 
				
			&lt;&lt;case 2&gt;&gt;
				The guard heaves with a sigh and a yawn, giving you the opportunity to simply sneak right by $npc1.him while $npc1.his eyes are closed. 
				
			&lt;&lt;case 3&gt;&gt;
				You spot a good foothold in the wall around the gate, and with a fortunate change of plans, climb right over the top while the guard&#39;s attention is elsewhere. 
				
		&lt;&lt;/switch&gt;&gt;			
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Got inside cultist village&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
/*sneak fail*/
&lt;&lt;else&gt;&gt;
	&lt;&lt;if random(1,10) == 10&gt;&gt;
		You walk up to the guard and say, &quot;I&#39;m selling these fine leather jackets.&quot; $npc1.His face twists into a snarl; guess $npc1.he prefers cotton. 
		
	&lt;&lt;else&gt;&gt;
		&lt;&lt;switch random(1,3)&gt;&gt;
			&lt;&lt;case 1&gt;&gt;
				You try to throw a pebble to misdirect $npc1.his attention. It works for about half a second, then $npc1.he looks right back at you, catching you in mid-sneak. 
				
			&lt;&lt;case 2&gt;&gt;
				The guard heaves with a sigh and a yawn, closing $npc1.his eyes for a moment, but your attempt to quietly rush past goes south as you step on foliage that crunches under your feet. 
				
			&lt;&lt;case 3&gt;&gt;
				You think you spot a good foothold in the wall around the gate and try to climb over it to avoid the guard altogether, but can&#39;t quite manage to get up over it so easily. The guard spots you mid-climb and comes rushing toward you. 
				
		&lt;&lt;/switch&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;startCombat&gt;&gt;
		
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="422" name="jungle ambush" tags="" position="450,2450" size="100,100">&lt;&lt;if $jungleEnemies == undefined or $jungleEnemies.length == 0&gt;&gt;
	&lt;&lt;set $jungleEnemies = [&quot;anaconda&quot;, &quot;jaguar&quot;, &quot;glutton&quot;, &quot;rider&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $jungleEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;
	&lt;&lt;case &quot;anaconda&quot;&gt;&gt;
	&lt;&lt;setEnemy $anaconda&gt;&gt;
	As you $walk through the jungle, you suddenly catch sight of a long, tubular, $npc1.furred snake&#39;s torso. Your eyes follow it left and right but can&#39;t seem to find the end of it. Turning around, you see the head of the lengthy $npc1.species, and discern two things: First off, it&#39;s looking at you hungrily, and second, its body is all around you! 
	
	&lt;&lt;case &quot;jaguar&quot;&gt;&gt;
	&lt;&lt;setEnemy $fatJaguar&gt;&gt;
	Your travels through the jungle is suddenly interrupted by the sound of a growling $npc1.adjective. Turning to look, you are within arms reach of a round-bellied $npc1.species, which has snuck up quite closely to you, and is obviously quite confident that you won&#39;t escape it, judging by its behavior. You have just enough time to prepare to fight as it pounces at you! 
	
	&lt;&lt;case &quot;glutton&quot;&gt;&gt;
	&lt;&lt;setEnemy $gluttonSeparatist&gt;&gt;
	As you $walk through the jungle, you are suddenly interrupted by an angry shout in a language you don&#39;t understand. 
	
	&lt;&lt;case &quot;rider&quot;&gt;&gt;
	&lt;&lt;setEnemy $dinosaurRider&gt;&gt;
	You $walk through the jungle and encounter an oddly flattened clearing. Closer inspection reveals that the plant life in this area has been completely trampled. By the time you realize this, you can hear the tell-tale thudding of enormous footsteps. A quick glance in the direction of their origin gives you a good view of an enormous feral $tyrannosaurus.species parting the trees with its body, being directed by an anthro $npc1.species wearing a light armor that bears the symbol of the Glutton Separatists. $npc1.He shouts commandingly in a tongue you don&#39;t understand, and the $tyrannosaurus.species turns to face you. This could go very poorly! 
	
&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy randomization&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="423" name="jungle leave" tags="" position="700,2325" size="100,100">&lt;&lt;setPassageTitle &quot;A path out the Jungle&quot;&gt;&gt;

You find a clearing ahead. As you approach closer you find it is one of the roads through the jungle! 

&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Island Town&quot;&gt;&gt;
	&lt;&lt;addPretext &quot;You emerge from the jungle and find yourself in the town of dinosaurs. &quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="424" name="jungle minor" tags="" position="700,2450" size="100,100">&lt;&lt;setPassageTitle &quot;A discovery?&quot;&gt;&gt;

As you&#39;re $walking through the jungle, you come across a peculiar little bush. Stooping down, you find what appears to be a small blueberry bush. But rather than the normal covering of blueberries, it merely has one gigantic one larger than your fist nestled in the center. You pluck the oddly out of place blueberry and notice it seems to be a bit of a weird color as well. No sense complaining about a free meal though. 
&lt;&lt;getItem $weirdBerry&gt;&gt;

&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="425" name="jungle randomization" tags="" position="550,2450" size="100,100">&lt;&lt;set $jungleRandomization.combat += $jungleRandomization.combatRate&gt;&gt;
&lt;&lt;set $jungleRandomization.special += $jungleRandomization.specialRate&gt;&gt;
&lt;&lt;set $jungleRandomization.leave += $jungleRandomization.leaveRate&gt;&gt;
&lt;&lt;set $jungleRandomization.minor += $jungleRandomization.minorRate&gt;&gt;

/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;
&lt;&lt;if $jungleRandomization.special &gt; $jungleRandomization.combat&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $jungleRandomization.minor &gt; $jungleRandomization.special&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;minor&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $jungleRandomization.leave &gt; $jungleRandomization.minor&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;leave&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;
	&lt;&lt;case &quot;combat&quot;&gt;&gt;
		&lt;&lt;set $jungleRandomization.combat = 0&gt;&gt;
		&lt;&lt;set _event = &quot;jungle ambush&quot;&gt;&gt;
	&lt;&lt;case &quot;special&quot;&gt;&gt;
		&lt;&lt;set $jungleRandomization.special = 0&gt;&gt;
		&lt;&lt;if random(1,2) == 1&gt;&gt;
			&lt;&lt;set _event = &quot;Cultist village&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _event = &quot;Pitcher plant&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;case &quot;minor&quot;&gt;&gt;
		&lt;&lt;set $jungleRandomization.minor = 0&gt;&gt;
		&lt;&lt;set _event = &quot;jungle minor&quot;&gt;&gt;
	&lt;&lt;case &quot;leave&quot;&gt;&gt;
		&lt;&lt;set $jungleRandomization.leave = 0&gt;&gt;
		&lt;&lt;set _event = &quot;jungle leave&quot;&gt;&gt;
	&lt;&lt;default&gt;&gt;
		&#39;&#39;Error in jungle randomization!&#39;&#39; 
&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Jungle&quot;&gt;&gt;
&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;if $sta &gt; 0&gt;&gt;
	
&lt;&lt;action &quot;1&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;jungle&quot; &quot;Jungle&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Quest locations*/
&lt;&lt;if !setup.questReady($spearQuest) and setup.questStarted($spearQuest)&gt;&gt;
	&lt;&lt;action &quot;sw&quot; &quot;compass&quot; &quot;Follow spear map&quot; &quot;Follow spear map&quot;&gt;&gt;
		&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !setup.questReady($hammerQuest) and setup.questStarted($hammerQuest)&gt;&gt;
	&lt;&lt;action &quot;s&quot; &quot;compass&quot; &quot;Follow hammer map&quot; &quot;Follow hammer map&quot;&gt;&gt;
		&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if !setup.questReady($swordQuest) and setup.questStarted($swordQuest)&gt;&gt;
	&lt;&lt;action &quot;se&quot; &quot;compass&quot; &quot;Follow sword&quot; &quot;Follow sword map&quot;&gt;&gt;
		&lt;&lt;set $travel = 5&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="426" name="Mountain ambush" tags="mountains" position="4675,2375" size="100,100">&lt;&lt;if $mountainEnemies == undefined or $mountainEnemies.length == 0&gt;&gt;
	&lt;&lt;set $mountainEnemies = [&quot;ants&quot;, &quot;thin&quot;, &quot;tough&quot;, &quot;magic&quot;, &quot;muscle&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _enemy = $mountainEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;

&lt;&lt;case &quot;ants&quot;&gt;&gt;
&lt;&lt;setEnemy $soldierAnts&gt;&gt;
As you hike along the side of a mountain, you come across a line of &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt; marching in formation. This wouldn&#39;t be particularly noteworthy if they weren&#39;t the size of housecats and carrying away what looks to be an entire banquet. Several of them turn to you, mandibles flexing in a threatening manner. 
&lt;&lt;switch random(1,3)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
		&lt;&lt;set $e.item = clone($sausage)&gt;&gt;			
	&lt;&lt;case 2&gt;&gt;
		&lt;&lt;set $e.item = clone($apple)&gt;&gt;			
	&lt;&lt;case 3&gt;&gt;
		&lt;&lt;set $e.item = clone($grapes)&gt;&gt;			
&lt;&lt;/switch&gt;&gt;

/*Fix this with item stacking?
&lt;&lt;set $e.item.charges = random(3,5)&gt;&gt;*/

&lt;&lt;case &quot;thin&quot;&gt;&gt;
&lt;&lt;setEnemy $thinFur&gt;&gt;
As you explore the mountains, a thin shell of $npc1.article $npc1.species staggers across your path, holding $npc1.his stomach. Surprisingly, it is flat, though given that $npc1.he is currently taking the last few bites of what looks to have been an entire hock of ham, that seems very unusual. &quot;Never lasts,&quot; $npc1.he grumbles quietly, &quot;always need more. Never stay full.&quot; $npc1.He suddenly looks up and sees you, $npc1.his face turning into a twisted, angry grimace. &quot;GIVE ME MORE FOOD!&quot; $npc1.he suddenly bellows, dropping the meatless bone and suddenly pulling a nasty looking pair of daggers out! 


&lt;&lt;case &quot;tough&quot;&gt;&gt;
&lt;&lt;setEnemy $toughFur&gt;&gt;
You are wandering through a particularly cold mountainside when your path is crossed by $npc1.article $npc1.species that is abnormally fat, even given the current state of things. $npc1.He appears to be completely unbothered by the inclimental weather, waddling up to you bare $npc1.furred. The sheer girth of $npc1.him becomes more apparent as $npc1.he gets closer--$npc1.his belly nearly hangs down to $npc1.his knees, and every inch of $npc1.his body bulges with thick fat. $npc1.He raises a wooden spear tipped with obsidian at you and demands, &quot;Give me your food, or I&#39;ll squash you!&quot; And with that, it&#39;s time to fight! 


&lt;&lt;case &quot;magic&quot;&gt;&gt;
&lt;&lt;setEnemy $magicalFur&gt;&gt;
As you traverse the mountains, you come across $npc1.article $npc1.species in tattered robes holding $npc1.his head in both hands and walking in an almost drunken stagger. Given that $npc1.he is grunting and groaning with pain, you feel safe in assuming they aren&#39;t having that kind of fun at the moment. &quot;Head hurts...&quot; $npc1.he gasps out, &quot;ALWAYS hurts...&quot; As $npc1.he approaches, you can see that $npc1.his head does appear to be a bit swollen, but not nearly as much as $npc1.his gut. $npc1.He manages to lift $npc1.his head enough to see you, and hisses out, &quot;...except when I get to EAT.&quot; With a staggered sweep, $npc1.he throws open one side of $npc1.his robe and pulls out an ugly, bent stick of a wand, pointing it at you menacingly! 


&lt;&lt;case &quot;muscle&quot;&gt;&gt;
&lt;&lt;setEnemy $muscleFur&gt;&gt;
Your path is suddenly crossed by a lumbering hulk of $npc1.article $npc1.species. $npc1.He is exceptionally large, in height, musculature, and weight, $npc1.his massive belly easily being a third of $npc1.his mass, and is dragging something that could be called a club, but would be better described as a small tree. Upon spotting you, $npc1.he rumbles in a deep voice, &quot;Eat more... Get bigger... Eat YOU... GET BIGGER!&quot; $npc1.he rushes you, mouth open wide and club raised! 


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy randomization&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="427" name="Mountainous dead end" tags="mountains" position="4475,2375" size="100,100">You laboriously climb over the snow frosted stones of the eastern mountains and rewarded with merely more barren rockfaces. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="428" name="Mountains" tags="mountains" position="4550,2475" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a comfortable spot to sit down and rest. 
	&lt;&lt;rest&gt;&gt;

	&lt;&lt;if random(1,5) == 1&gt;&gt;
		&lt;&lt;set _enemy = either($soldierAnts, $thinFur, $toughFur, $magicalFur, $muscleFur)&gt;&gt;
		&lt;&lt;setEnemy _enemy&gt;&gt;
		You are awoken from your sleep by $e.article $e.name! 
		&lt;&lt;startCombat&gt;&gt;

	&lt;&lt;else&gt;&gt;
		&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
The dark snow-capped mountains loom around you in almost all directions, seemingly without end. Behind you an inviting path slopes downwards back into the rolling foothills of the mountains. Cold winds rip and howl through the rocky crags and tug sharply at you as if attempting to fling you off their mountain. The black cliffsides are pockmarked with small caves and outcroppings that could grant temporary sanctuary from the freezing cold, but who knows what else may be seeking shelter from the storm? On a distant peek you can make out the unusual yet unmistakable outline of a lonely white tower jutting vertically from a mountain side. 
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="429" name="mountain randomization" tags="mountains" position="4575,2375" size="100,100">/*Ticks up random events counters*/
&lt;&lt;set $mountainRandomization.combat += $mountainRandomization.combatRate&gt;&gt;

&lt;&lt;set $mountainRandomization.special += $mountainRandomization.specialRate&gt;&gt;

&lt;&lt;set $mountainRandomization.leave += $mountainRandomization.leaveRate&gt;&gt;


/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;

&lt;&lt;if $mountainRandomization.special &gt; $mountainRandomization.combat&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $mountainRandomization.leave &gt; $mountainRandomization.minor&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;leave&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
/**/

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;

/*A random combat*/
&lt;&lt;case &quot;combat&quot;&gt;&gt;
	&lt;&lt;set $mountainRandomization.combat = 0&gt;&gt;
	&lt;&lt;if random(1,10) == 1&gt;&gt;&lt;&lt;set _event = &quot;Tiger fight&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set _event = &quot;Mountain ambush&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	

/*A special event*/
&lt;&lt;case &quot;special&quot;&gt;&gt;
&lt;&lt;set $mountainRandomization.special = 0&gt;&gt;
&lt;&lt;set _event = $mountainSpecial.pluck()&gt;&gt;
&lt;&lt;if $mountainSpecial.length == 0&gt;&gt;
	&lt;&lt;set $mountainSpecial = [&quot;cabal&quot;, &quot;wizard&quot;, &quot;hive&quot;, &quot;wyvern&quot;, &quot;experiment&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;switch _event&gt;&gt;
	&lt;&lt;case &quot;cabal&quot;&gt;&gt;&lt;&lt;set _event = &quot;Cabal cave&quot;&gt;&gt;
	&lt;&lt;case &quot;wizard&quot;&gt;&gt;&lt;&lt;set _event = &quot;Wizard&#39;s Tower&quot;&gt;&gt;
	&lt;&lt;case &quot;hive&quot;&gt;&gt;&lt;&lt;set _event = &quot;Insect Hive&quot;&gt;&gt;
	&lt;&lt;case &quot;wyvern&quot;&gt;&gt;&lt;&lt;set _event = &quot;Wyvern cave&quot;&gt;&gt;
	&lt;&lt;case &quot;experiment&quot;&gt;&gt;
		&lt;&lt;if setup.questStarted($onGoodTermsExperiments)&gt;&gt;
			&lt;&lt;set _event = &quot;Experiment Town&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _event = &quot;Experiment cave&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;/switch&gt;&gt;

/*Opportunity to leave the forest*/
&lt;&lt;case &quot;leave&quot;&gt;&gt;
 	&lt;&lt;set $mountainRandomization.leave = 0&gt;&gt;
	&lt;&lt;set _event = &quot;Mountainous dead end&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
  &#39;&#39;Error in hills randomization!!!&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Mountains&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;1&quot; &quot;hills&quot; &quot;Hills&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;8&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;9&quot; &quot;mountain&quot; &quot;Mountains&quot; _event&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if setup.questActive($cabalRogue) 
	and setup.hasItem($cabalCauldron) &lt; 0&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;compass&quot; &quot;Follow cabal map&quot; &quot;Fight the cabal dragon&quot;&gt;&gt;
	&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;	
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="430" name="Begin the Wizard&#39;s experiment" tags="nobr" position="4425,2650" size="100,100">/*In case you got here from dying to the manticore*/
&lt;&lt;if $hea &lt; 1&gt;&gt;&lt;&lt;set $hea = 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;set $alive = true&gt;&gt;

&lt;p&gt;You can hear the $npc2.species&#39;s voice from above, and look up to see that $npc2.he is on a platform connected to nothing in particular over your head. 
&lt;/p&gt;

&lt;&lt;switch random(1,5)&gt;&gt;

/*Experiment 1*/
&lt;&lt;case 1&gt;&gt;
&lt;p&gt;&quot;This time, we shall be performing a simple test of body mass transfer!&quot; $npc2.he calls down. &quot;Are you ready, my ample assistant?&quot; The $npc3.species raises $npc3.his foodless $npc3.hand to give a half-hearted thumbs-up to the wizard. &quot;THEN WE SHALL BEGIN!&quot; the $npc2.species bellows overdramatically, raising $npc2.his staff. &lt;/p&gt;

&lt;p&gt;The staff glows a cloudy grey with magic, and a thin tendril of whispy red energy begins to flow out from the $npc3.species&#39;s massive belly and towards yours. &lt;/p&gt;

/*Experiment succesful*/
&lt;&lt;if random(1,3) == 1&gt;&gt;
&lt;p&gt;There is the slightest feeling of a pinprick, then an odd, almost electrical tingling shakes your skin. As the spell progresses, the $npc3.species gets steadily thinner, and your own $fatness body begins to enlarge. 
&lt;&lt;set $fat += 100&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
You can feel yourself getting heavier, warmer and softer as your fatty layer thickens. The $npc3.species is nearly fatless before the whispy tendril ceases to emanate from $npc3.him. You, on the other hand, are left $fatness with the addition of $npc3.his weight. &lt;/p&gt;

&lt;p&gt;Above, the wizard throws $npc2.his hands over $npc2.his head and yells &quot;Great success!&quot; The $npc3.species, meanwhile, continues to chew on grains, a bored look on $npc3.his face. &quot;My thanks for your participation, $p.sir!&quot; the $npc2.species shouts down to you, &quot;you may leave now.&quot; Before you can react, you find yourself back on the mountains, unable to spot the tower anymore. &lt;/p&gt;

/*Experiment failed*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;There a stabbing pain for a moment, then an odd buzz seems to emanate deep inside your stomach. The $npc3.species begins to thin, and you can feel your stomach getting fuller. Your stomach swells, getting heavy and full as the $npc3.species thins, $npc3.his fat being fed directly into your belly. 
&lt;&lt;consume 100 65&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;$npc3.He is nearly fatless when the tendril stops exuding from $npc3.him, and when the last of it is absorbed, you are feeling $hungry, and left clutching your swollen belly. Above, you can hear the $npc2.species wizard growl in frustration. &quot;Damn! Not right! ARGH!&quot; With a clatter, $npc2.he throws down $npc2.his staff. There is a crackling like lightning, and you can hear a quiet &quot;Uh oh, not again.&quot; It is followed by a brilliant flash, and when your vision returns, you are out on the mountains, and the tower is nowhere to be seen. &lt;/p&gt;

/*Experiment not survived*/
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $options.popping&gt;&gt;
		&lt;p&gt;Your stomach groans in protest as more and more of the $npc3.species&#39;s immense weight is forced directly into it. You moan and rub at your belly, trying to soothe it, but it just keeps getting tighter and fuller. By the time the tendril fades, the $npc3.species is nearly fatless, and your stomach simply cannot bear its load. You lower yourself onto your back, breathing slowly and deeply to stave off the pain. Above, the wizard quietly lets out an &quot;Oops...&quot; just as the strain becomes too much and you burst with a gooey //GLOORP//! &lt;/p&gt;

		&lt;p&gt;&quot;Why do they always explode? I’ll figure it out... eventually...&quot;&lt;/p&gt;
		&lt;&lt;defeated &quot;exploded&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;p&gt;Your stomach groans in protest as more and more of the $npc3.species&#39;s immense weight is forced directly into it. You moan and rub at your belly, trying to soothe it, but it just keeps getting tighter and fuller. By the time the tendril fades, the $npc3.species is nearly fatless, and your stomach simply cannot bear its load. You lower yourself onto your back, breathing slowly and deeply to stave off the pain. Above, the wizard quietly lets out an &quot;Oops...&quot; &lt;/p&gt;
		&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*Experiment 2*/
&lt;&lt;case 2&gt;&gt;
&lt;p&gt;&quot;Today, we shall be attempting to turn fat into muscle!&quot; $npc2.he calls down. &quot;Are you ready, my pudgy partner?&quot; The $npc3.spcies raises $npc3.his foodless $npc3.hand and gives the most half-hearted thumbs-up you&#39;ve ever seen. &#39;&#39;&quot;THEN WE SHALL BEGIN!&quot;&#39;&#39; the $npc2.species bellows, going quite a ways over the top as $npc2.he raises $npc2.his staff. &lt;/p&gt;

&lt;p&gt;The staff glows a bright red, and a hazy red tendril begins to emanate from the $npc3.species&#39;s tremendous gut and towards you. &lt;/p&gt;

/*Experiment succesful*/
&lt;&lt;if random(1,3) == 1&gt;&gt;
&lt;p&gt;It splits into several smaller tendrils, and there&#39;s a momentary pinprick as they connect to your limbs, chest, neck and tail. As energy flows outward, the $npc3.species thins, and you can feel the magic steadily building in your muscles, which swell and harden nicely. The tendril stops flowing once the $npc3.species has thinned to a nearly fatless state, and you are left feeling significantly stronger. Unfortunately, you can also feel the magic slowly leaving you. 
&lt;&lt;buff &quot;str&quot; 30 180&gt;&gt;

&lt;p&gt;Above, the $npc2.species wizard hums, rubbing $npc2.his chin for a moment. &quot;Well,&quot; $npc2.he finally starts, &quot;not quite perfect, but we shall call this a great success!&quot; $npc2.He suddenly throws $npc2.his arms in the air victoriously. &quot;Enjoy that while it lasts, $p.sir!&quot; $npc2.he calls down, waving his staff. Before you can even react, the world blurs again, and you are back on the mountains, the tower nowhere in sight. &lt;/p&gt;


/*Experiment failed*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;It splits into several smaller tendrils, and there&#39;s a momentary stabbing pain as they connect to your limbs, chest, neck and tail. Energy flows outward from the $npc3.species and into you, causing $npc3.him to thin, but you are definitely not feeling stronger. Your muscles are expanding, but feel heavy and cumbersome more than strong and flexible. The tendril stops flowing once the $npc3.species has thinned to a nearly fatless state, and you just look up to the wizard in confusion, your muscles significantly larger, but soft and not stronger at all. &lt;/p&gt;

The $npc2.species wizard rubs $npc2.his chin and hums for a moment, then calmly begins, &quot;Well, not quite as bad as the last few,&quot; then with exagerrated anger continues, &quot;But I&#39;ll still call this a &#39;&#39;TOTAL FAILURE! CURSES!&#39;&#39;&quot; $npc2.He throws down $npc2.his staff in frustration, and it begins to glow brilliant white. &quot;Oh dear, I did it again,&quot; $npc2.he mumbles, just before the world vanishes in a white glare. When you can see again, you are somewhere on the mountains, but the tower is nowhere in sight. 
&lt;&lt;buff &quot;agi&quot; -30 180&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*Experiment 3*/
&lt;&lt;case 3&gt;&gt;
&lt;p&gt;&quot;This time, we shall attempt a most unusual change: Fatness into nimbleness!&quot; $npc2.he calls down. &quot;Are you ready, my corpulent companion?&quot; The $npc3.species doesn&#39;t even stop eating when he raises his free $npc3.hand to give an inattentive thumbs up. &#39;&#39;&quot;THEN WE SHALL BEGIN!&quot;&#39;&#39; the $npc2.species bellows, raising $npc2.his staff and failing to not look like a madman. 

&lt;p&gt;The staff glows a bright yellow, and a transparent red tendril flows outward from the $npc3.species&#39;s massive belly, snaking through the air towards you and splitting into several smaller tendrils when it approaches. &lt;/p&gt;

Each weaves its way to one of your joints, the biggest tendril going around behind you, and with a 

/*Experiment succesful*/
&lt;&lt;if random(1,3) == 1&gt;&gt;
slight pinprick, they poke into your major joints and spine. The $npc3.species steadily thins, and you can see the tendril send a stream of magical energy your way. When it reaches you, you get the unusual sensation of your joints becoming looser, and your muscles tightening. Somehow or another, this seems to be working, and your body feels lighter and faster. Your pulse quickens, and you feel more keen all around. 
&lt;&lt;buff &quot;agi&quot; 30 180&gt;&gt;


&lt;p&gt;Somehow or another, you do feel faster, though the feeling is slowly fading. Above, the wizard calls down, &quot;Well?&quot; To which the $npc3.species responds by throwing a few grains at you suddenly. You catch them reflexively, and the $npc2.species throws $npc2.his hands over $npc2.his head and yells, &quot;Still not perfect, but still a great success! Thank you for your assistance, $p.sir!&quot; With a wave of $npc2.his staff, the world blurs again, and you are somewhere on the mountains, but the tower is nowhere in sight. &lt;/p&gt;


/*Experiment failed*/
&lt;&lt;else&gt;&gt;
brief stabbing pain, they poke into your major joints and spine. The $npc3.species steadily thins, and you can see the tendril send a stream of magical energy your way. As the energy flows into you, you feel your pulse pick up, and your breaths grow shallow. 

&lt;p&gt;By the time the flow stops, you are a jittery wreck, your $p.hands shaking like you&#39;ve had enough caffeine to keep a $horse.species awake for a month. The only good thing about it is that it seems to be very slowly fading. From above, the wizard calls down, &quot;Well?&quot; The $npc3.species responds by tossing a few grains at you, which makes you flinch and cover your face as they harmlessly bounce off you. &quot;Curses! Yet another failure!&quot; $npc2.he bellows, then throws $npc2.his staff down in frustration. A brilliant white glow starts to build up, and you can hear $npc2.him mutter, &quot;I&#39;ve really got to stop doing that,&quot; just in time for a white flash to erupt all around. When your vision clears, you are somewhere on the mountains, but the tower is nowhere in sight. &lt;/p&gt;
&lt;&lt;set $cal *= 0.5&gt;&gt;

&lt;&lt;/if&gt;&gt;


/*Experiment 4*/
&lt;&lt;case 4&gt;&gt;
&lt;p&gt;&quot;In this experiment, we shall try to make that skin of yours a little thicker with the addition of some flab!&quot; $npc2.he calls down. &quot;Are you ready, my flabby follower?&quot; The $npc3.species raises $npc3.his free $npc3.hand, giving a nonchallant thumbs up without even ceasing $npc3.his snacking. &#39;&#39;&quot;THEN WE SHALL BEGIN!&quot;&#39;&#39; the $npc2.species bellows, raising $npc2.his staff and failing to strike an impressive pose. &lt;/p&gt;

The staff glows green with magic, and a tendril of hazy red energy begins to flow out of the obese $npc3.species&#39;s midsection and toward yours. It pokes into the flesh of your belly with a 

/*Experiment succesful*/
&lt;&lt;if random(1,3) == 1&gt;&gt;
light pinprick, and as the energy flows outward, the $npc3.species begins to thin. Your body seems to thicken, and while it seems at first that you are simply getting fatter, as time passes, you can tell that your skin is getting tougher as well. You start to feel a bit warmer as your fatty layer seems to grow more dense. The tendril stops flowing when the $npc3.species has thinned to near-fatlessness, and when the last of the magical energy is absorbed, you are significantly more stout than you were before, but the feeling is slowly fading. 
&lt;&lt;set $fat += 20&gt;&gt;
&lt;&lt;buff &quot;end&quot; 30 180&gt;&gt;

&lt;p&gt;&quot;Well?&quot; the $npc2.species wizard yells down. The $npc3.species responds by giving you a bit of a slap in your $waist belly, which barely even moves and certainly doesn&#39;t hurt. The $npc3.species gives another nonchallant thumbs-up, never having stopped eating in this time, and the wizard bellows out, &quot;Still don&#39;t have it down yet, but I shall call this a &#39;&#39;GREAT SUCCESS!&#39;&#39;&quot; while throwing $npc2.his hands over $npc2.his head. &quot;Thank you for your assistance, $p.sir! Now allow me to show you out.&quot; The world blurs again, and you are back on the mountains, but the tower is nowhere in sight. &lt;/p&gt;


/*Experiment failed*/
&lt;&lt;else&gt;&gt;
brief stabbing pain, and as the energy flows outward, the $npc3.species begins to thin. You, on the other hand, seem to be bloating outward, your skin stretching as thick fat builds up under it. You find yourself getting quite hot, and a bit cramped by the additional weight. 
&lt;&lt;set $fat += 150&gt;&gt;
&lt;&lt;buff &quot;agi&quot; -30 180&gt;&gt;

&lt;p&gt;The tendril doesn&#39;t stop flowing into you until the $npc3.species is nearly fatless, and by that point, you&#39;ve become $fatness in a most unbalanced way, your midsection disproportionate with your limbs. &quot;Well?&quot; the wizard calls down. The $npc3.species gives you a poke, and your $waist stomach jiggles softly, to which the $npc3.species gives a nonchallant half-shrug, still eating with $npc3.his other hand. &quot;Then this is a &#39;&#39;TOTAL FAILURE!&#39;&#39; Blast it!&quot; the $npc2.species yells, throwing down $npc2.his staff in frustration. A bright white glow starts to shine above you, and you can hear the wizard mumble, &quot;I must remember not to do that.&quot; The white glow becomes a brilliant flash, and when your vision clears, you are back on the mountains, but the tower is nowhere to be found. &lt;/p&gt;
&lt;&lt;/if&gt;&gt;


/*Experiment 5*/
&lt;&lt;case 5&gt;&gt;
&lt;&lt;set _num1 = random(1,99)&gt;&gt;
&lt;&lt;set _num2 = random(1,99)&gt;&gt;
&lt;&lt;set _num3 = _num1 * _num2&gt;&gt;
&lt;p&gt;&quot;This one should be nice and tricky! I shall attempt... to make you &#39;&#39;SMARTER!&#39;&#39;&quot; $npc2.he dramatically calls down. &quot;Are you ready, my stout subordinate?&quot; The $npc3.species inattentively gives a thumbs up with his free $npc3.hand, not even slowing down $npc3.his meal. &#39;&#39;&quot;THEN WE SHALL BEGIN!&quot;&#39;&#39; the $npc2.species bellows, raising $npc2.his staff dramatically. &lt;/p&gt;

The staff glows blue with magic, and a tendril of misty red energy begins to flow out of the fat $npc3.species&#39;s body and towards your head. It splits into two, which poke into the sides of your head with a 

/*Experiment succesful*/
&lt;&lt;if random(1,3) == 1&gt;&gt;
light pinprick. The $npc3.species thins as magical energy flows into you, and you can feel a bit of pressure inside your skull. Your thoughts begin to come faster, and you start to notice a bit more of the finer details of the spell, but the most obvious thing you can feel is your head getting very slightly larger. When the $npc3.species is nearly fatless, the tendril ceases to emanate from $npc3.him, and your head feels heavy, and slightly pained, with increased knowledge and mass. 
&lt;&lt;buff &quot;int&quot; 30 180&gt;&gt;

&lt;p&gt;It isn&#39;t terribly pleasant, but your mind is definitely working faster, though the effect is slowly fading. The wizard calls down, &quot;//Quick//, what&#39;s _num1 times _num2?&quot; Without thinking, you respond, &quot;_num3?&quot; The $npc2.species takes a moment, tracking numbers on $npc2.his fingers, then pumps $npc2.his fists in the air and yells, &quot;Yes! Great success! Thank you for your time, $p.sir!&quot; With a wave of $npc2.his staff, the world blurs again, and you find yourself back on the mountains, though the tower is nowhere to be seen. &lt;/p&gt;

/*Experiment failed*/
&lt;&lt;else&gt;&gt;
brief stabbing pain. The $npc3.species thins as magical energy flows into you, and you can feel pressure building inside your skull. Your mind begins to race with thoughts, and the pressure builds into pain, which steadily grows more disorienting as the $npc3.species thins. By the time $npc3.he is nearly fatless, the pain is nearly blinding, and you are clutching your head in both hands, your thoughts a random, useless blur. 
&lt;&lt;buff &quot;mana&quot; -30 180&gt;&gt;

&lt;p&gt;The wizard calls down, &quot;//Quick//, what&#39;s _num1 times _num2?&quot; You open your mouth to respond, but all that comes out is a pained groan. &quot;Another failure! Curses!&quot; $npc2.he yells, throwing $npc2.his staff to the floor. It begins to glow white, and $npc2.he mumbles, &quot;Oh dear, not again.&quot; There is a brilliant flash, and you are left with your headache on the mountains, the tower nowhere in sight. &lt;/p&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;/switch&gt;&gt;

&lt;&lt;if $alive&gt;&gt;

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt; 
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="431" name="Enter the Wizard&#39;s tower" tags="nobr" position="4175,2650" size="100,100">&lt;&lt;createFixedNPC &quot;mountainWizard&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;mountainWizardAssistant&quot; 3&gt;&gt;

&lt;p&gt;You locate the door (which is, itself, a bit of a trick) and step inside, finding yourself in something resembling a lobby, but it doesn&#39;t appear to exit into any other rooms. &lt;/p&gt;

&lt;p&gt;After a few moments of looking at images of magical figures and bookstands, a voice rings out from nowhere in particular, &quot;Ah! I almost didn&#39;t notice you! One moment!&quot; Before you can answer, the world blurs and you find yourself standing before a robed, wild-eyed $npc2.species who is smiling at you happily. Your surroundings have changed from an open, decorated room to a small, cluttered laboratory, absolutely clogged with books, magical symbols, and arcane tools. &lt;/p&gt;

&quot;I take it you&#39;ve come to volunteer, yes?&quot; the $npc2.species asks eagerly. &quot;That is why you&#39;re here, yes?&quot; 

&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Yes&quot; &quot;Wizard&#39;s experiment&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;No&quot; &quot;Fight the Manticore&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="432" name="Fight the Manticore" tags="nobr" position="4175,2775" size="100,100">&lt;p&gt;You respond with a simple &quot;No.&quot; that seems to echo around the room for a moment, the $npc2.species wizard just staring at you in disbelief. &lt;/p&gt;

&lt;p&gt;After an awkward silence, $npc2.his disbelief turns into an angry snarl, and $npc2.he bellows out, &#39;&#39;&quot;THEN WHY ARE YOU DISTURBING ME?!&quot;&#39;&#39; Before you can stop $npc2.him, $npc2.he grabs $npc2.his staff and angrily waves it at you. The world again blurs, and you find yourself in a dimly-lit, wide open chamber with a dirt floor. The wizard&#39;s voice calls down from nowhere in particular, &quot;Perhaps a few rounds with my pet manticore will change your mind!&quot; &lt;/p&gt;

One of the walls slides open, and out trods an eagle-winged, lion-bodied, scorpion-tailed monstrosity that looks more than eager to change your mind. 

&lt;&lt;startCombat $manticore&gt;&gt;
&lt;&lt;set $eventCounterA = 0&gt;&gt; /* FIXES AND EDITS - Counter was missing a reset before &quot;Manticore defeated&quot;, without it, if the last event was a previous manticore fight, the player would be forced into picking the same option they made last */</tw-passagedata><tw-passagedata pid="433" name="Leave the Wizard&#39;s tower" tags="" position="4050,2775" size="100,100">You decide that you&#39;ve had your share of magic for the time being, and head back downward to find somewhere else to explore. As you do, the tower fades away again. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="434" name="Manticore defeated" tags="nobr" position="4300,2775" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;Library&quot;&gt;&gt;
&lt;p&gt;You accept $npc2.his offer to peruse $npc2.his library, and $npc2.he eagerly waves $npc2.his staff to send you there. When you arrive, it becomes apparent that most of this tower consists of just the library, with books lining every surface, and even floating in a mass in some places. Fortunately, there&#39;s a magical index that can bring any book you are interested in to you. You spend some time studying tomes of forgotten lore and magical theory. By the time you&#39;re ready for a break, your head feels heavy with knowledge. 
&lt;&lt;changeStats &quot;int&quot; 5&gt;&gt;&lt;/p&gt;

You set down what you&#39;re reading, but when you do, you find yourself magically transported back to the mountains, the tower nowhere in sight. You weren&#39;t exactly a welcome guest, but that was still rather rude. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;



&lt;&lt;case &quot;Staff&quot;&gt;&gt;
&lt;p&gt;Without a word, you snatch the wizard&#39;s staff away from $npc2.him. $npc2.He lets out a dejected &quot;Oh,&quot; and slouches sadly. &quot;Very well,&quot; $npc2.he grumbles, &quot;you can have my staff. Just point it at yourself and think of the mountains, and get out of here already.&quot; &lt;/p&gt;

You hesitate for a moment, then follow $npc2.his instructions. Sure enough, you are out in the mountains, but the tower is nowhere to be seen. The staff, however, is still in your hands, so it&#39;s not a total loss. 
&lt;&lt;getItem $wizardStaff&gt;&gt;

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;



&lt;&lt;case &quot;Notebook&quot;&gt;&gt;
&lt;p&gt;You shove the wizard $npc2.species to the side and snap shut $npc2.his notebook, pocketting it as $npc2.he sputters out protests. &quot;Wait--no--Come on now--Oh, curse you!&quot; $npc2.he moans, &quot;Fine, fine, take it. Take it and go.&quot; $npc2.He slumps over to a seat, one hand under $npc2.his cheek. &lt;/p&gt;

$npc2.He points $npc2.his staff at you, and you find yourself back in the mountains, though the tower is gone. You take a look at the notebook. While the first few pages are a sensible set of studious notes, the further it goes, the more jumbled and fragmented it gets. It may prove useful to someone, though. 
&lt;&lt;getQuest $wizardNotebook&gt;&gt;

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt; 


&lt;&lt;case &quot;Eat him&quot;&gt;&gt;
&lt;p&gt;You lick your teeth as you knock away the wizard&#39;s staff, backing $npc2.him into a corner. &quot;W-wait,&quot; $npc2.he stutters, &quot;what are you doing? Y-y-you can&#39;t mean to--&quot; $npc2.He cuts off as you grab $npc2.his arms, pinning them to $npc2.his sides. &quot;No no!&quot; $npc2.he cries. You open your mouth and lower it down upon $npc2.his head, $npc2.his protests becoming muffled yelps as you fit $npc2.him into your maw. 
&lt;&lt;consume 125 70&gt;&gt;&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
&lt;p&gt;You lift $npc2.him up, $npc2.his legs flailing under $npc2.his robes as you force $npc2.him into your throat. As $npc2.he descends to your stomach, $npc2.he struggles, but $npc2.his less-than-impressive physical strength makes it nothing but an interesting internal massage to you and your $waist belly. With a few more swallows, you gulp down $npc2.his chest, $npc2.his somewhat rounded midsection, then $npc2.his legs, and soon $npc2.he is nothing more than a crazed wizard bulge in your stomach. &lt;/p&gt;

Your belly jiggles a bit as $npc2.he writhes inside you, and you give it a rubbing as it slowly calms and becomes still. That&#39;s the only thing that stays calm and still, as the staff&#39;s bright white glow catches your eye just in time for it to become an overwhelming flash of light. When it fades and your vision clears, you are somewhere in the mountains, and the tower is nowhere in sight. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
You slowly lift $npc2.him upwards as you swallow $npc2.him down, $npc2.his legs flailing in the air as you push $npc2.him into your throat. Even as you pass $npc2.his shoulders, you feel this might have been a mistake, your stomach already protesting as $npc2.he slowly makes $npc2.his way down to it. $npc2.His pushing isn&#39;t enough to free $npc2.him, but is certainly enough to make you feel pain, and you have no choice but to gulp the rest of $npc2.him down into your overfilled, $waist stomach. You let out a groan as it shakes and shudders with the $npc2.species&#39;s struggles, and lower yourself to the ground, rubbing at it to try to ease the pressure. You&#39;re not able to do so just by will alone, unfortunately, and you soon drift off, your slow, deep breaths heralding an onset of unconsciousness. 

&lt;&lt;defeated &quot;overeating&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;



/*Start to event*/
&lt;&lt;default&gt;&gt;
&lt;p&gt;With your foe defeated, you are momentarily left wondering how to get out of the featureless pit you are in, but a sudden rush of magic sends the world blurring yet again, and you find yourself staring at the back of the robed $npc2.species, who is muttering to $npc2.himself and bent over a notebook. $npc2.He lets out a curious hum before turning around, a look of confusion sticking on $npc2.his face for a few seconds before $npc2.he recognizes you. &lt;/p&gt;

&lt;p&gt;$npc2.His eyes widen and $npc2.he stammers, &quot;Oh. I, er, I see you bested my, ah, my pet. The manticore.&quot; As you move, $npc2.he flinches, throwing his hands up submissively. &quot;Wait, wait, wait!&quot; $npc2.he cries, &quot;This is just an unfortunate misunderstanding! Here, let me offer you something to help smooth this over, please.&quot; $npc2.He is practically begging as $npc2.he makes you an offer. &lt;/p&gt;

&lt;p&gt;&quot;I could let you use my library, surely there&#39;s something there that you could learn from. Or, or you could have my staff, you might find it useful to you.&quot; &lt;/p&gt;

&lt;&lt;if setup.questStarted($wizardNotebook) == false&gt;&gt;
&lt;p&gt;You look a bit past $npc2.him at the notebook $npc2.he was pouring over. $npc2.He reflexively seems to cover it with a hand, but $npc2.he&#39;s certainly not in a position to deny you anything at this point. &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;1&quot; &quot;spells&quot; &quot;Library&quot; &quot;Manticore defeated&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Library&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;2&quot; &quot;weapon&quot; &quot;Staff&quot; &quot;Manticore defeated&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Staff&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;if !setup.questStarted($wizardNotebook)&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Notebook&quot; &quot;Manticore defeated&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;Notebook&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;3&quot; &quot;devour&quot; &quot;Eat $npc2.him&quot; &quot;Manticore defeated&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Eat him&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;




&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="435" name="Wizard&#39;s Tower" tags="mountains" position="4050,2650" size="100,100">As you crest a particularly hard to reach mountaintop, you suddenly find yourself facing an odd, cylindrical tower that you didn&#39;t see on the way up. Given the way that it shimmers and sparkles, you can assume that it was either invisible, or simply not here, before you got this close. It is apparent that some sort of magic user lives here. 

&lt;&lt;action &quot;c&quot; &quot;mage&quot; &quot;Approach the tower&quot; &quot;Enter the Wizard&#39;s tower&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave the Wizard&#39;s tower&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="436" name="Wizard&#39;s experiment" tags="nobr" position="4300,2650" size="100,100">&lt;p&gt;You give an affirmative, and the $npc2.species immediately reaches out and pats you on the shoulder, $npc2.his smile getting even wider as $npc2.he practically yells with excitement, &quot;Excellent, excellent!&quot; Picking up $npc2.his staff, $npc2.he makes a gesture at you and says &quot;Just one moment while I take you to the proper facilities.&quot; The world blurs again, and you find yourself in a sterile, well-lit chamber. &lt;/p&gt;

The only other thing in here is an extremely fat $npc3.species who is non-challantly chewing on grains, which $npc3.he keeps pulling from a large bag beside $npc3.him by the &lt;&lt;=$npc3.hand&gt;&gt;ful. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Begin the Wizard&#39;s experiment&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="437" name="Approach the cabal" tags="nobr" position="4575,3050" size="100,100">&lt;&lt;createFixedNPC &quot;cabalLion&quot;&gt;&gt;
/*Make this text more dynamic based on state*/

&lt;&lt;if visited(&quot;Approach the cabal&quot;) == 1&gt;&gt;

&lt;p&gt;As you make your way inward, you are met by a pair of what are obviously guards flanking a very important looking, and very large, $npc1.species. The guards are easily &lt;&lt;sayDistance 84&gt;&gt; tall, and the $npc1.species is even taller than that. As they get closer, you can see that the $npc1.species&#39;s earth-brown robes only barely contain $npc1.his enormously muscular frame. 
&lt;/p&gt;

$npc1.He approaches you and spreads $npc1.his arms welcomingly, though the serious look on $npc1.his face does not change. &quot;Welcome, stranger,&quot; $npc1.he begins, $npc1.his voice a deep rumble, &quot;You&#39;ve come at an odd time. We are practicioners of the arts of body changing. We seek enlightenment through physical perfection, and utilize raw body mass as the means to alter our bodies. While excess material has been easy to come by in these curious days, our greatest asset has been lost to us.&quot; The $npc1.species shakes $npc1.his head, lowering $npc1.his arms. &quot;If you wish to trade with us, we can change aspects of your body if you are willing to repay us with raw materials... That is to say, body fat. We are also willing to trade it for coin, should you so desire.&quot; 

&lt;&lt;else&gt;&gt;

&lt;p&gt;The huge and muscular $npc1.adjective guard with the earth-brown robes stands stands at attention as always. &quot;Welcome,&lt;&lt;if setup.questCompleted($cabalRogue)&gt;&gt; honored&lt;&lt;/if&gt;&gt; outsider,&quot; $npc1.he begins, $npc1.his voice a deep rumble, &quot;If you wish to trade with us, we can change aspects of your body if you are willing to repay us with raw materials... That is to say, body fat. We are also willing to trade it for coin, should you so desire.&quot; &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

/*If you have a wyvern egg to sell*/
&lt;&lt;if setup.hasItem($largeWyvernEgg) &gt;= 0&gt;&gt;
&lt;p&gt;One of the guards seems to pause for a moment, then makes a furtive gesture to the $npc1.species. $npc1.He gives a nod, and says, &quot;My associate believes you have a wyvern&#39;s egg. Perhaps we could make you an offer, if you would be interested in trading it.&quot; &lt;/p&gt;

&lt;&lt;/if&gt;&gt;

/*If you haven&#39;t started the cabal rogue quest*/
&lt;&lt;set _rogueQuest = false&gt;&gt;
&lt;&lt;if $str &gt; 60 or $agi &gt; 60 or $int &gt; 60&gt;&gt;
&lt;&lt;if !setup.questStarted($cabalRogue) and !setup.questCompleted($cabalRogue)&gt;&gt;
&lt;p&gt;The $npc1.species gives you a looking over, seeming to appraise you, then says carefully, &quot;You know, if you felt yourself capable, you may be able to help us with a problem we have.&quot; The way $npc1.he phrases it makes it sound important, but ominous. &lt;/p&gt;
&lt;&lt;set _rogueQuest = true&gt;&gt;

&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

/*If you already started the quest*/
&lt;&lt;if setup.questStarted($cabalRogue) and !setup.questCompleted($cabalRogue)&gt;&gt;&lt;&lt;set _rogueQuest = true&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;The Cabal lion says&quot;&gt;&gt;

&lt;&lt;if _rogueQuest&gt;&gt;
	&lt;&lt;action &quot;4&quot; &quot;quest&quot; &quot;Help the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.hasItem($largeWyvernEgg) &gt;= 0&gt;&gt;
	&lt;&lt;action &quot;1&quot; &quot;gold&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;2&quot; &quot;button&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;3&quot; &quot;store&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;9&quot; &quot;leave&quot; &quot;Leave the cabal cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="438" name="Cabal cave" tags="" position="4575,2800" size="100,100">While you explore the jagged mountains, you come across a cave. You can hear what sounds like ritual chanting just on the edge of hearing coming from within. You&#39;ll need to go in to find out what&#39;s in there. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter the cave&quot; &quot;Enter the cabal cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave the cabal cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="439" name="Change your body" tags="nobr" position="4450,3050" size="100,100">&lt;&lt;createFixedNPC &quot;cabalRabbit&quot; 2&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;


&lt;&lt;case &quot;height&quot;&gt;&gt;
&quot;Alter your size, eh?&quot; the $npc2.species hums. &quot;We can do that. Making you larger will make you stronger, but more clumsy. Making you smaller will make you faster, but weaker. So which will it be?&quot;

&lt;&lt;action &quot;w&quot; &quot;up&quot; &quot;Taller!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Taller&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;down&quot; &quot;Shorter!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Shorter&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Nevermind&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*========================*/


&lt;&lt;case &quot;Taller&quot;&gt;&gt;
&lt;&lt;if $p.height &lt; setup.tuning(&quot;playerHeightMax&quot;)&gt;&gt;

/*Sets cost based on whether you&#39;re above your base height*/
&lt;&lt;if $p.height &gt; $p.bheight&gt;&gt;
&lt;&lt;set _cost = Math.pow(Math.abs($p.bheight - $p.height), 1.5) * 10&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set _cost = Math.pow(Math.abs($p.bheight - $p.height), 1.1) * 10&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Adds base cost*/
&lt;&lt;set _cost = Math.round(_cost + 10)&gt;&gt;

/*Not enough fat*/
&lt;&lt;if _cost &gt; $fat&gt;&gt;
The $npc2.species gives you a looking over, walking over to poke your $waist belly with $npc2.his staff. $npc2.He shakes $npc2.his head, and says, &quot;I&#39;m afraid you just don&#39;t have the mass to make you larger to a significant degree. You&#39;ll just have to come back when you have about &lt;&lt;sayWeight _cost&gt;&gt; of fat you need to get rid of. Perhaps there&#39;s something else I can do for you instead.&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

/*Change height*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;&quot;Alright then, hold still.&quot; At that, the $npc2.species begins to slowly wave $npc2.his staff in odd patterns, chanting out arcane syllables carefully. The magic circle you are standing in glows, and a hazy red tendril of energy begins to emanate from your $fatness midsection. It splits into multiple smaller tendrils and flows back into your limbs, chest, neck, and spine, though one leads back to the $npc2.species and into $npc2.his belly. Your body slims steadily, and your feet begin to sink away from you. 
&lt;&lt;set $fat -= _cost&gt;&gt;
/*&lt;&lt;set $p.height += 1&gt;&gt;*/
&lt;&lt;changeStats &quot;height&quot; 1&gt;&gt;
/* FIXES AND EDITS - Remove stat adjustments from resizing at cabal */

/*&lt;&lt;set $bstr *= 1.01&gt;&gt;*/
/*&lt;&lt;set $bagi /= 1.01&gt;&gt;*/
/*&lt;&lt;set $bsto *= 1.01&gt;&gt;*/

&lt;&lt;updateStats&gt;&gt;
&lt;/p&gt;

A quick examination of yourself shows you that your body is, surely enough, enlarging. As you grow, $npc2.his belly swells larger and larger. Eventually, the tendril ceases to flow out of you, leaving you standing &lt;&lt;sayDistance $p.height&gt;&gt; tall, and the $npc2.species letting out a hum and patting at $npc2.his bloated stomach. &quot;Mmm, well that was fun, wasn&#39;t it?&quot; $npc2.he asks. 


&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Too tall already*/
&lt;&lt;else&gt;&gt;
&quot;Woah there, big $p.boy. Unfortunately your height is a bit... out of my range. You&#39;re already as tall as I can make you without... dangerous consequences. Sorry, but, cabal policies.&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*========================*/



&lt;&lt;case &quot;Shorter&quot;&gt;&gt;
&lt;&lt;if $p.height &gt; setup.tuning(&quot;playerHeightMin&quot;)&gt;&gt;

/*Sets cost based on whether you&#39;re below your base height*/
&lt;&lt;if $p.height &lt; $p.bheight&gt;&gt;
&lt;&lt;set _cost = Math.pow(Math.abs($p.bheight - $p.height), 1.5) * 8&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set _cost = Math.pow(Math.abs($p.bheight - $p.height), 1.1) * 8&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Adds base cost*/
&lt;&lt;set _cost = Math.round(_cost + 10)&gt;&gt;

/*Not enough fat*/
&lt;&lt;if _cost &gt; $fat&gt;&gt;
$npc2.He gives you a thorough looking over and shakes $npc2.his head. &quot;It&#39;d be dangerous to make you smaller without extra material to reshape what&#39;s left,&quot; $npc2.he explains. &quot;Please, come back when you&#39;ve got at least &lt;&lt;sayWeight _cost&gt;&gt; to throw around, so to speak.&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

/*Change height*/
&lt;&lt;else&gt;&gt;
&lt;p&gt;&quot;Alright, stand right there.&quot; With that, the $npc2.species begins to wave $npc2.his staff in spiralling patterns, carefully chanting out magic words. The magic circle you are standing in responds, beginning to glow, and a hazy red tendril of magical energy begins to flow out of your $fatness midsection. Several smaller tendrils snake off of it and flow back into your arms, legs, chest, spine, and neck, but one lazily floats toward the $npc2.species&#39;s belly. 
&lt;&lt;set $fat -= _cost&gt;&gt;
/*&lt;&lt;set $p.height -= 1&gt;&gt;*/
&lt;&lt;changeStats &quot;height&quot; -1&gt;&gt;
/* FIXES AND EDITS - Remove stat adjustments from resizing at cabal */

/*&lt;&lt;set $bstr /= 1.01&gt;&gt;*/
/*&lt;&lt;set $bagi *= 1.01&gt;&gt;*/
/*&lt;&lt;set $bsto /= 1.01&gt;&gt;*/

&lt;&lt;updateStats&gt;&gt;
&lt;/p&gt;

The world seems to get bigger around you, but as you give yourself a closer look, you confirm that you are, indeed, getting smaller. As you get smaller, $npc2.his belly bulges bigger and bigger. After a few more moments, the tendril ceases to flow out from you, leaving you &lt;&lt;sayDistance $p.height&gt;&gt; tall, and the $npc2.species gives a hum as $npc2.he rubs at $npc2.his swollen belly. &quot;Mmm, I love my job,&quot; $npc2.he murmurs. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Too short already*/
&lt;&lt;else&gt;&gt;
&quot;Woah there, little $p.man. Unfortunately you&#39;re already a bit too... under my range. You&#39;re already as short as I can make you without... dangerous consequences. Sorry, but, cabal policies.&quot; 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;



/*========================*/


&lt;&lt;case &quot;species&quot;&gt;&gt;
&lt;&lt;if $fat &gt;= 200&gt;&gt;
&quot;Altering your species won&#39;t take //too// much,&quot; $npc2.he explains, &quot;But I will take some of your fat as a cost for doing it. So what would you like to be?&quot;

&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Go ahead!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;slect species&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Actually...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;set _difference = Math.ceil(200 - $fat)&gt;&gt;
$npc2.He looks you over carefully, then walks over and pinches your belly&#39;s skin. &quot;Not to be cruel,&quot; $npc2.he starts, &quot;but you&#39;re short at least another &lt;&lt;sayWeight _difference&gt;&gt; of fat for me to work with, let alone cover the fee I intended. Maybe you should consider eating more?&quot; $npc2.He shrugs. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*========================*/


&lt;&lt;case &quot;slect species&quot;&gt;&gt;
Select species (or pick whatever&#39;s closest): &lt;br&gt;
/* FIXES AND EDITS - Unified species lists + allowed for modded species */
&lt;&lt;printSpeciesOptions &quot;$species&quot;&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Edit species&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;edit species&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*========================*/


/* FIXES AND EDITS - Remake and fix species editor */
&lt;&lt;case &quot;edit species&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;cabal&quot;&gt;&gt;
	&lt;&lt;include &quot;Species Editor&quot;&gt;&gt;

/*========================*/

/* FIXES AND EDITS - Remake and fix species editor */
&lt;&lt;case &quot;species selected&quot;&gt;&gt;
	/* (changes have already been applied in the editor passage) */
	
	&quot;Alright then, hold still for a moment,&quot; $npc2.he says as the circle you stand in begins to glow. There is a surprisingly-painless series of shifts and pops in your bones, and your skin crawls as it changes consistency. A small tendril of hazy red energy snakes its way out of you and into the $npc2.species&#39;s belly, making it almost imperceptibly larger before it dissipates. In a few more moments, your body has changed, and you stand there feeling like a brand new $p.species. 

	&lt;&lt;changeStats &quot;fat&quot; -200&gt;&gt;
	&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Change your body&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
	&lt;&lt;/action&gt;&gt;

/*========================*/


&lt;&lt;case &quot;gender&quot;&gt;&gt;

&lt;&lt;if $fat &gt;= 200&gt;&gt;
&quot;So, want to see how the other half lives, eh? That&#39;s won&#39;t take much, but I will take a bit of your fat as a fee. Care to give me the go-ahead?&quot; 

&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Go ahead!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;input gender&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;no&quot; &quot;Actually...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
$npc2.He looks you over carefully, then walks over and pinches your belly&#39;s skin. &quot;Not to be cruel,&quot; $npc2.he starts, &quot;but you don&#39;t have enough mass for me to work with, let alone cover the fee I intended. You need at least &lt;&lt;sayWeight 200&gt;&gt; of fat to spend first. Maybe you should consider eating more?&quot; $npc2.He shrugs. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*========================*/


&lt;&lt;case &quot;input gender&quot;&gt;&gt;
&lt;&lt;set $gender = $male&gt;&gt;
&lt;&lt;if $p.male == $gender.male&gt;&gt;&lt;&lt;set $gender = $female&gt;&gt;&lt;&lt;/if&gt;&gt;

Title (Male/Female):
&lt;&lt;textbox &quot;$p.male&quot; $gender.male&gt;&gt;
&lt;br&gt;Subjective (He/She):
&lt;&lt;textbox &quot;$p.he&quot; $gender.he&gt;&gt;
&lt;br&gt;Objective (Him/Her):
&lt;&lt;textbox &quot;$p.him&quot; $gender.him&gt;&gt;
&lt;br&gt;Possessive (His/Her):
&lt;&lt;textbox &quot;$p.his&quot; $gender.his&gt;&gt;
&lt;br&gt;Reflexive (Himself/Herself):
&lt;&lt;textbox &quot;$p.himself&quot; $gender.himself&gt;&gt;
&lt;br&gt;Title (Man/Woman):
&lt;&lt;textbox &quot;$p.man&quot; $gender.man&gt;&gt;
&lt;br&gt;Diminuitive title (Boy/Girl):
&lt;&lt;textbox &quot;$p.boy&quot; $gender.boy&gt;&gt;
&lt;br&gt;Familial title (Brother/Sister):
&lt;&lt;textbox &quot;$p.brother&quot; $gender.brother&gt;&gt;
&lt;br&gt;Honorific (Sir/Ma&#39;am):
&lt;&lt;textbox &quot;$p.sir&quot; $gender.sir&gt;&gt;
&lt;br&gt;Formal honorific (Gentleman/Gentlewoman):
&lt;&lt;textbox &quot;$p.gentleman&quot; $gender.gentleman&gt;&gt;
&lt;br&gt;The other kind of honorific? (Mister/Miss):
&lt;&lt;textbox &quot;$p.mister&quot; $gender.mister&gt;&gt;
&lt;br&gt;Regional honorific (Lad/Lass):
&lt;&lt;textbox &quot;$p.lad&quot; $gender.lad&gt;&gt;
&lt;br&gt;Longer regional honorific (Laddie/Lassie):
&lt;&lt;textbox &quot;$p.laddie&quot; $gender.laddie&gt;&gt;
&lt;br&gt;Folksy honoric (Fella/Missy):
&lt;&lt;textbox &quot;$p.fella&quot; $gender.fella&gt;&gt;
&lt;br&gt;Slightly too familiar honorific (Buddy/Pal):
&lt;&lt;textbox &quot;$p.buddy&quot; $gender.buddy&gt;&gt;
&lt;br&gt;Slightly disrepectful honorific (Guy/Lady):
&lt;&lt;textbox &quot;$p.guy&quot; $gender.guy&gt;&gt;
&lt;br&gt;Slightly demeaning but well intentioned honorific (Sport/Champ/Slugger/Dork):
&lt;&lt;textbox &quot;$p.sport&quot; $gender.sport&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Done&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;changing gender&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*========================*/


&lt;&lt;case &quot;changing gender&quot;&gt;&gt;
/*Scrubs text entry of gender*/
&lt;&lt;set $p.male = $p.male.toLowerCase()&gt;&gt;
&lt;&lt;set $p.he = $p.he.toLowerCase()&gt;&gt;
&lt;&lt;set $p.him = $p.him.toLowerCase()&gt;&gt;
&lt;&lt;set $p.his = $p.his.toLowerCase()&gt;&gt;
&lt;&lt;set $p.himself = $p.himself.toLowerCase()&gt;&gt;
&lt;&lt;set $p.man = $p.man.toLowerCase()&gt;&gt;
&lt;&lt;set $p.boy = $p.boy.toLowerCase()&gt;&gt;
&lt;&lt;set $p.sir = $p.sir.toLowerCase()&gt;&gt;
&lt;&lt;set $p.mister = $p.mister.toLowerCase()&gt;&gt;
&lt;&lt;set $p.guy = $p.guy.toLowerCase()&gt;&gt;
&lt;&lt;set $p.brother = $p.brother.toLowerCase()&gt;&gt;
&lt;&lt;set $p.fella = $p.fella.toLowerCase()&gt;&gt;
&lt;&lt;set $p.buddy = $p.buddy.toLowerCase()&gt;&gt;
&lt;&lt;set $p.gentleman = $p.gentleman.toLowerCase()&gt;&gt;
&lt;&lt;set $p.lad = $p.lad.toLowerCase()&gt;&gt;
&lt;&lt;set $p.laddie = $p.laddie.toLowerCase()&gt;&gt;
&lt;&lt;set $p.sport = $p.sport.toLowerCase()&gt;&gt;

&lt;&lt;set $p.Male = $p.male.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.He = $p.he.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Him = $p.him.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.His = $p.his.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Himself = $p.himself.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Man = $p.man.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Boy = $p.boy.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Sir = $p.sir.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Mister = $p.mister.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Guy = $p.guy.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Brother = $p.brother.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Fella = $p.fella.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Buddy = $p.buddy.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Gentleman = $p.gentleman.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Lad = $p.lad.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Laddie = $p.laddie.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Sport = $p.sport.toUpperFirst()&gt;&gt;


$npc2.He raises her staff, mumbling certain arcane words as the magic circle glows, and subtle changes begin to take place in your body. Your proportions change, organs twist and move, and fat deposits shift to change emphasis on your body&#39;s shape. A small tendril of hazy red energy snakes its way out of you and into the $npc2.species&#39;s belly, making it almost imperceptibly larger before it dissipates. Just like that, you&#39;ve changed into a new $p.man. 

&lt;&lt;changeStats &quot;fat&quot; -200&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;


/*========================*/


&lt;&lt;default&gt;&gt;
&lt;p&gt;You ask about how they might change your body, and the $npc1.species has one of the guards show you to what seems to be a magical laboratory, if the sigils on the ground, books, and staves are any indication. There, you encounter a tall, thin $npc2.species $npc2.gentleman wearing clean robes and trousers. $npc2.He is dutifully studying, waving a hand in arcane motions and holding a book in the other before looking up to see you. 
&lt;/p&gt;

&quot;Ah, someone looking for my services, I take it?&quot; $npc2.He sets down $npc2.his book and picks up a staff, motioning for you to stand in the sigil. &quot;Here&#39;s what I can do for you: I can make you larger or smaller, change what species you are, or change your gender. You&#39;ll need to have a certain amount of mass for any of these, and I will take some as a fee, on top of it. If that doesn&#39;t appeal to you, then you can head off as you wish. So what will it be?&quot; 

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;The cabal rabbit says&quot;&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Alter your height&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;height&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Alter your species&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;species&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Alter your gender&quot; &quot;Change your body&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;gender&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="440" name="Enter the cabal cave" tags="" position="4575,2925" size="100,100">You steel yourself and slowly march inside, cold stone echoing your footsteps as you enter. As you enter, you are greeted by the sight of robed figures of varying sizes. Some are incredibly large, some are equally incredibly small. Given the glowing glyphs that decorate the place, it&#39;s obvious that this is some form of magical cabal. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Keep going&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave the cabal cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="441" name="Help the cabal" tags="nobr" position="4450,3175" size="100,100">&lt;&lt;createFixedNPC &quot;cabalRogue&quot; 2&gt;&gt;

/*Start quest*/
&lt;&lt;if !setup.questStarted($cabalRogue)&gt;&gt;
&lt;p&gt;When you express an interest in helping the group, the $npc1.species nods and leads you to a small room. The guards stand outside as $npc1.he gestures you towards a seat. &lt;/p&gt;

&lt;p&gt;&quot;I&#39;m afraid our situation is most dire,&quot; $npc1.he says, $npc1.his face deathly serious. &quot;One of our number has gone rogue, and taken our most valuable artifact with $npc2.him: An enchanted cauldron that once stored all of the magical energies that we utilize to alter a body. The kind of power $npc2.he has available to $npc2.him...&quot; The $npc1.species shakes $npc1.his head, $npc1.his brow furrowed, then continues. &quot;As well, I fear $npc2.he is partially responsible for the oddities that have plagued these mountains. Many creatures and even people bear marks that indicate our magic has been used on them, but wrongly. I have little doubt that $npc2.he has spread lies and half-truths of our magic to those that would seek it.&quot; $npc1.He hands you a map of the area, and a fairly distant mountain is circled on it. &quot;We have tracked $npc2.him to that point,&quot; the $npc1.species continues, &quot;but $npc2.he has fortified the location, and $npc2.his magic circles make even entering a risky proposition. If you are to face $npc2.him, know that $npc2.he will be prepared to use the full force of $npc2.his magical prowess against you. Follow the map when you are ready to face $npc2.him, but be aware: $npc2.He will most certainly use your own body against you.&quot; &lt;/p&gt;

You pocket the map, and are lead back out to the main room. 
&lt;&lt;getItem $cabalMap&gt;&gt;
&lt;&lt;getQuest $cabalRogue&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;You can count on me!&quot; &quot;Approach the cabal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

/*Quest started but not finished*/
&lt;&lt;elseif !setup.questReady($cabalRogue)&gt;&gt;
&quot;We have tracked $npc2.him to that point,&quot; the $npc1.species says, &quot;but $npc2.he has fortified the location, and $npc2.his magic circles make even entering a risky proposition. If you are to face $npc2.him, know that $npc2.he will be prepared to use the full force of $npc2.his magical prowess against you. Follow the map when you are ready to face $npc2.him, but be aware: $npc2.He will most certainly use your own body against you.&quot; 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Right, I remember that&quot; &quot;Approach the cabal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

/*Turn in quest*/
&lt;&lt;else&gt;&gt;
You present the cauldron to $npc1.him. $npc1.His face brightens with a relieved smile as $npc1.he takes it from you. &quot;You&#39;ve done it!&quot; $npc1.he exclaims. &quot;It&#39;s almost too fortunate to be real. Please, wait here just a moment.&quot; $npc1.He heads back with the cauldron into $npc1.his chamber, and returns a few moments later bearing a dark colored robe. &quot;When we discovered what our rogue member had done, we searched $npc2.his quarters and found this robe. Apparently $npc2.he did not have time to take it with $npc2.him. It is enchanted with potent magics unlike any that we have ever seen. While we had intended to study it and unlock its mysteries ourselves, it is clear to me that you would make better use of it. Wear it well, honored outsider. You will always be welcome among us.&quot; 
&lt;&lt;removeItem $cabalMap&gt;&gt;
&lt;&lt;removeItem $cabalCauldron&gt;&gt;
&lt;&lt;questReward $cabalRogue&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Approach the cabal&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="442" name="Leave the cabal cave" tags="" position="4450,2800" size="100,100">You decide that magic is the last thing you want to deal with right now, and head back out to find a different adventure. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="443" name="Sell fat to the cabal" tags="nobr" position="4575,3175" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;
&lt;&lt;createFixedNPC &quot;cabalOwl&quot; 3&gt;&gt;

&lt;&lt;case &quot;&quot;&gt;&gt;
&lt;p&gt;You show interest in trading fat around, and are shown the way to a chamber that is in slight disarray, various pens containing &lt;&lt;=$chicken.plural&gt;&gt;, &lt;&lt;=$pig.plural&gt;&gt;, even a couple of &lt;&lt;=$cattle.plural&gt;&gt;, all in varying degrees of obesity, and all letting out subdued, yet cacophonous, noises. A slightly frazzled looking $npc3.male $npc3.species in a loose, sleeveless robe and plain pants is moving between the lot of them, occasionally waving $npc3.his arms and whispering a few arcane words to send a tendril of of magic from one to another. 
&lt;/p&gt;

$npc3.He turns $npc3.his head to look at you, back still to you, not stopping $npc3.his rhythmic arm movements. &quot;Ah, hello. Things are still a bit disorganized, so pardon the mess.&quot; Turning to work with a &lt;&lt;=$pig.species&gt;&gt; in your direction, $npc3.he asks, &quot;I sort the mass here. Did you want sell us some?&quot;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;The cabal owl says&quot;&gt;&gt;

&lt;&lt;action &quot;1&quot; &quot;gold&quot; &quot;10%&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0.1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;gold&quot; &quot;25%&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0.25&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;gold&quot; &quot;50%&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0.5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;gold&quot; &quot;75%&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0.75&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;gold&quot; &quot;100%&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 1&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;se&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===============*/


&lt;&lt;default&gt;&gt;
&lt;&lt;set _selling = $fat * $eventCounterA&gt;&gt;

&lt;&lt;if _selling &lt; 3&gt;&gt;
&quot;Hmmmm, well,&quot; The $npc3.species eyes you up and down, &quot;Sorry to say this but I&#39;m not sure the juice is worth the squeeze, if you catch my meaning. Maybe you can come back here when you put on some more weight?&quot;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Oh...&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt; 

&lt;&lt;elseif _selling &lt;= 10&gt;&gt;
&lt;&lt;set $fat -= _selling&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&quot;Every little bit is appreciated,&quot; $npc3.he says, then waves a $npc3.hand at you. A whispy red tendril snakes out from you and into one of the &lt;&lt;=$chicken.plural&gt;&gt;, making it look a little rounder. You are slightly lighter, now $fatness in appearance. In the midst of $npc3.his sorting, $npc3.he hands you a handful of gold coins. 

&lt;&lt;set _selling /= 3&gt;&gt;
&lt;&lt;doGld _selling&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _selling &lt;= 30&gt;&gt;
&lt;&lt;set $fat -= _selling&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&quot;Your contribution is appreciated,&quot; $npc3.he says sincerely, then waves both hands at you. A few whispy red tendrils snake out of you, each making its way to a $chicken.species, leaving them a bit rounder than before. You feel a good bit lighter, and your body is $fatness. You are handed a small pouch of gold for your trouble. 

&lt;&lt;set _selling /= 3&gt;&gt;
&lt;&lt;doGld _selling&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _selling &lt;= 60&gt;&gt;
&lt;&lt;set $fat -= _selling&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&quot;Oh, that&#39;s rather a lot, thank you,&quot; $npc3.he says, then points both hands at you. &quot;Hmm, going to have to find a place for some of this,&quot; $npc3.he mumbles, and three glowing red tendrils of magical energy seep out of you. Two of them make their way to a pair of &lt;&lt;=$pig.plural&gt;&gt;, their rounded sides thickening with the addition of more fat, and the other snakes into the $npc3.species&#39;s belly, making it bulge out like $npc3.he&#39;d had quite a meal. You, on the other hand, feel lighter, and look $fatness. $npc3.He lets out a //&quot;phew&quot;// and hands you a pouch of gold, resuming $npc3.his sorting. 

&lt;&lt;set _selling /= 3&gt;&gt;
&lt;&lt;doGld _selling&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif _selling &lt;= 200&gt;&gt;
&lt;&lt;set $fat -= _selling&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&quot;//Oh dear//, going to have to find places to put all of this,&quot; $npc3.he mumbles, then says louder, &quot;We appreciate your generosity.&quot; Focussing on you, $npc3.he holds $npc3.his hands out and beckons. Bright tendrils of red magical energy issues forth from you, several gliding through the air and seeping into a $cattle.species&#39;s belly, softening it up and sending it sinking noticeably closer to the ground. Hemming and hawing, several more are redirected towards the $npc3.species&#39;s belly, where they seep into $npc3.his body. $npc3.His belly swells, filling out his robe and causing $npc3. him to let out a bit of a muffled grunt. &quot;Th-thank you,&quot; $npc3.he stammers, taking a breath and patting at $npc3.his now large stomach before handing you a hefty pouch of gold. You are left both lighter and richer, and your body is now $fatness. 

&lt;&lt;set _selling /= 3&gt;&gt;
&lt;&lt;doGld _selling&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;&lt;set $fat -= _selling&gt;&gt;
&lt;&lt;updateStats&gt;&gt;
&lt;p&gt;The $npc3.species takes a deep breath when $npc3.he realizes just how much mass $npc3.he&#39;s going to be throwing around. &quot;//Right//, here goes, then,&quot; $npc3.he says quietly, focussing on you and pointing both arms at you for a moment, then throwing them upwards in a ritualistic gesture. A vibrant red tendril of magical energy issues forth from you, splitting off into numerous smaller ones that seep into the rounded bellies of every beast in the room, all growing noticeably fatter and more lethargic. &lt;/p&gt;

&lt;p&gt;Humming and harumphing, the $npc3.species directs the still-bright tendril from one end of the room to the other, stuffing every beast in $npc3.his path with your fat. &quot;Didn&#39;t care much for a thin figure anyways,&quot; $npc3.he mumbles, and the tendril snakes through the air and towards $npc3.his belly. $npc3.He starts taking deep breaths as $npc3.his stomach stretches and swells. Stifling grunts and moans, $npc3.his robe fills with $npc3.his belly, then overfills, pressing open and showing $npc3.his feathers as it grows round, taut, and huge. It hangs out over the top of $npc3.his pants, which $npc3.he lowers slightly in response, and still bulges further, and further, and further... A few moments later, the tendril finally fades entirely into $npc3.his giant belly, and $npc3.he sinks to a seat, letting out an //&quot;Oog.&quot;// You feel significantly lighter, and looks $fatness, but the $npc3.species&#39;s not so fortunate. &lt;/p&gt;

&quot;Ah,&quot; $npc3.he starts slowly, &quot;yeah, gonna have to... find a place for this.&quot; $npc3.He produces a sack of gold and holds it up in the air with one arm in your general direction, the other rubbing over $npc3.his entirely too full stomach. &quot;Here, this... take this for... //oog//...&quot; $npc3.he mumbles. You decide that $npc3.he&#39;s had enough for the moment and head back out. 

&lt;&lt;set _selling /= 3&gt;&gt;
&lt;&lt;doGld _selling&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thanks!&quot; &quot;Sell fat to the cabal&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="444" name="Sell wyvern egg" tags="nobr" position="4450,2925" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;str&quot;&gt;&gt;
You spend some time training with the Cabal. It is an unusual course, more devoted to the understanding of what strength is, focusing on unusual parts of the body, but you do emerge stronger. 
&lt;&lt;changeStats $eventCounterA 4&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;agi&quot;&gt;&gt;
You spend some time training with the Cabal. The exercise seems to be more about the understanding of flexibility and time, focusing on stretches and meditation, but you do emerge faster. 
&lt;&lt;changeStats $eventCounterA 4&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;int&quot;&gt;&gt;
You spend some time training with the Cabal. The course involves pondering the nature of the infinitely large and the infinitely small in meditation. You become keenly aware of how little you truly know in the face of all that is, but the humbling knowledge does give you new insights. 
&lt;&lt;changeStats $eventCounterA 4&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;end&quot;&gt;&gt;
You spend some time training with the Cabal. The exercise involves repeating mantras while being hit in the stomach with sticks. It&#39;s straightforward and hurts, but you do emerge tougher. 
&lt;&lt;changeStats $eventCounterA 4&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


&lt;&lt;case &quot;sto&quot;&gt;&gt;
You spend some time training with some of the more &#39;robust&#39; members of the Cabal. The course seems to be fairly new and experimental, involving unusual &#39;exercises&#39; with bellows, stomach massages and mantras of endurance. You&#39;re left a little light-headed, but feel like you could eat more now. 
&lt;&lt;changeStats $eventCounterA 4&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;hold onto it&quot;&gt;&gt;
The $npc1.species pulls $npc1.his hand up to rub at $npc1.his chin as you put the egg back with your belongings. 
&lt;&lt;getItem $largeWyvernEgg&gt;&gt;

&quot;I understand. If you change your mind, the offer stands,&quot; $npc1.he says humbly. You are led back to the main chamber. 
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the cabal&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
											
&lt;&lt;default&gt;&gt;
&lt;p&gt;You hand over the egg, which is still surprisingly warm for how long it&#39;s been out in the cold. The $npc1.species claps $npc1.his hands together, a smile crossing $npc1.his large face for the first time since you&#39;ve been here. &quot;Wonderful!&quot; $npc1.he exclaims. One of $npc1.his guards takes the egg to a small, pillow-lined chamber and carefully sets it down. 
&lt;&lt;removeItem $largeWyvernEgg&gt;&gt;&lt;/p&gt;

The $npc1.species nods approvingly at this and turns back to you. &quot;While we cannot offer to teach our magics to an outsider, we //can// assist you in training your body. What shall it be, then?&quot; 

&lt;&lt;action &quot;1&quot; &quot;next&quot; &quot;Train strength&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;str&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;2&quot; &quot;next&quot; &quot;Train agility&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;agi&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;next&quot; &quot;Train intelligence&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;int&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;next&quot; &quot;Train endurance&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;end&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;5&quot; &quot;next&quot; &quot;Train stomach capacity&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;sto&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;6&quot; &quot;leave&quot; &quot;Nevermind&quot; &quot;Sell wyvern egg&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;hold onto it&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;


&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="445" name="The Cabal lion says" tags="nobr" position="4700,2925" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the cabal leader&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;cabalRogue&quot; 2&gt;&gt;

&lt;&lt;if setup.questStarted($cabalRogue) and !setup.questCompleted($cabalRogue)&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Our rogue member is a great $npc2.color-$npc2.furred $npc2.species. $npc2.He chose the path of physical might, but had a keen mind for magics just the same. It is likely $npc2.he has made himself quite the giant.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;The magics $npc2.he practiced involved more and more dangerous methods of quelling an opponent by robbing them of strength. I should have known when I saw, but I didn&#39;t recognize it before: $npc2.He revels in cruelty and abasing the weak.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;I fear the oversized insects may be $npc2.his doing. To what end, I cannot fathom, however. Perhaps $npc2.he seeks to harvest of them when $npc2.he feels $npc2.he can elude us. Perhaps $npc2.he has already done so...&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&quot;Somehow, I doubt $npc2.he acted alone, but what degree of assistance $npc2.he has received, and from who, I simply do not know. If you best $npc2.him, endeavor to search $npc2.his chambers for any hint of this.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
The $npc1.species thinks for a moment and shrugs, out of anything more to say.

&lt;&lt;/switch&gt;&gt;

&lt;&lt;else&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;We rarely get outsiders, for this place is obfuscated from the outside world, but travellers are always welcome to warm themselves here.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;I am the leader of this circle, though that distinction is only granted by my comrades. They trust me to lead them, and I am humbled by that trust.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;The guards have taken a vow of silence, only speaking when it is needed that they may better hear. Their noble devotion is appreciated.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&quot;Physical perfection means different things to different people. You will see those of great size and strength, those of small and swift nature, and those that seek the middle path. All views are considered correct here.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
The $npc1.species thinks for a moment and shrugs, out of anything more to say.

&lt;&lt;/switch&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="446" name="The cabal owl says" tags="nobr" position="4700,3050" size="100,100">&lt;&lt;setPassageTitle &quot;Talk to the cabal fat storer&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;cabalRabbit&quot; 2&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;All this is the raw materials we work with here. What with recent times, we&#39;ve not been at a lack of it, but storing it all has been tricky.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;The art of transferring body mass is more complicated than it may seem. You have to know the specifics so that you don&#39;t seriously hurt someone by taking something vital away from them.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;How do we get the gold? Well, a couple sources: With the excess of materials we have, we sell some of our livestock at a premium. As well, a few of our number seek knowledge in the outside world, so they do some adventuring for coin at times.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;That $npc2.species $npc2.boy that works with outsiders is a bit frustrating sometimes. Takes everything we do as fun, rarely serious. But, well, it&#39;s hard not to like $npc2.him for it, I&#39;ll admit.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="447" name="The cabal rabbit says" tags="nobr" position="4325,3050" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the cabal bodyshaper&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;cabalOwl&quot; 3&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;I&#39;m tasked with helping outsiders. I volunteered, really; I like meeting new and interesting people, and making them even more interesting.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Our leader speaks humbly, but the truth of the matter is that $npc1.he&#39;s the best of all of us. Not that I won&#39;t do a great job with whatever you need, of course.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;You should talk to the $npc3.species that&#39;s working on sorting the magical energy. $npc3.He could use someone to break $npc3.his concentration.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Names? Oh, we avoid using them around outsiders. Nothing personal; we abandon our old names and take up new ones just for our brothers and sisters in the circle. We&#39;ve got a lot of fun, weird rules like that.&quot;&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="448" name="Ask about Sampson&#39;s chainmail" tags="" position="5200,3475" size="100,100">&lt;&lt;set _theTitle = &quot;Ask about &quot;+$npc4.Name+&quot;&#39;s chainmail&quot;&gt;&gt;
&lt;&lt;setPopupTitle _theTitle&gt;&gt;
&quot;This armor magic, yes. $npc1.Name&#39;s work, no. Broken, yes. Fix it for you, no. Wrong magic. Try out West- hear of VERY good armourer on island somewhere. Maybe their work.&quot;</tw-passagedata><tw-passagedata pid="449" name="Defeated Smarty" tags="" position="5225,2725" size="100,100">&lt;&lt;setPassageTitle &quot;Defeated $npc1.Name&quot;&gt;&gt;

The $npc1.species curses you from the ground, and inside, you can see every face turning to you. Knowing that it is now time to beat feet, you head down off the mountain and as far away as you can get. 
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="450" name="Defeated snookums" tags="" position="5100,2725" size="100,100">&lt;&lt;createFixedNPC &quot;smarty&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;snookums&quot; 2&gt;&gt;

&lt;&lt;setPassageTitle &quot;Defeated $npc2.Name&quot;&gt;&gt;

The giant $npc2.species lies panting on the ground, breathless and beaten. You turn to go out, when suddenly a $npc1.male $npc1.species in tattered robes appears in front of you. When $npc1.he spots the $npc2.species, $npc1.he cries out, &#39;&#39;&quot;$npc2.Name!&quot;&#39;&#39; Turning to you, $npc1.his face turns almost ferally furious. &quot;You think you can cause trouble in &#39;&#39;MY&#39;&#39; town and just get away with it?!&quot; $npc1.He pulls a wand out from $npc1.his robe, and you&#39;re in another fight! 
&lt;hr&gt;
&lt;&lt;startCombat $smarty&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;smarty&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="451" name="Earl says" tags="" position="4875,3375" size="100,100">&lt;&lt;createFixedNPC &quot;smarty&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;mountainWizardAssistant&quot; 3&gt;&gt;

&lt;&lt;setPopupTitle &quot;Talk to $npc1.Name&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Name&#39;s $npc1.Name. Used to run a farm a&#39;fore I got &#39;sperimented on. Now I do it here for these folks. They&#39;re good people, once ya get &#39;em calmed down.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;That light up there? $npc2.Name&#39;s idea. Accordin&#39; to $npc2.him, it&#39;s an ar-tee-fishul sun, and the brainy ones power it ta help &#39;em get rid &#39;a excess magic.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Me n&#39; the other fast fellers do the cookin&#39; &#39;round here. Always got a lot a&#39; that ta be done, and keeps the hands busy.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;You seen my $npc3.brother? Think $npc3.he&#39;s with that wizard feller what made me all twitchy. I&#39;m sure $npc3.he&#39;s fine, though. $npc3.He&#39;s a tough one.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="452" name="Enter experiment cave" tags="mountains" position="4850,2850" size="100,100">&lt;&lt;createFixedNPC &quot;snookums&quot;&gt;&gt;

You steel yourself and slowly march inside, cold stone echoing your footsteps as you enter. As you enter, you can see various furs in different states of bodily extreme. Particularly thin ones and immensely fat ones can be seen eating non-stop, while some holding their heads are visible sending crackling bolts of magic out against stone target dummies. The one that guards the door, however, is a massively muscular brute of $npc1.article $npc1.species, nearly half again as large as any of the others you can see, and staring at you intently, a massive column of stone held tightly in one hand. 

&lt;&lt;action &quot;c&quot; &quot;talk&quot; &quot;Talk to them&quot; &quot;Talk to experiments&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Leave experiment cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="453" name="Experiment Town" tags="mountains" position="4975,3250" size="100,100">&lt;&lt;createFixedNPC &quot;snookums&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;smarty&quot; 2&gt;&gt;

You walk up to $npc1.Name, who nods at you and grunts affirmatively. $npc1.He walks with you as you head for the center of the make-shift cave town. 

&lt;&lt;action &quot;nw&quot; &quot;store&quot; &quot;Experiment town farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;store&quot; &quot;Experiment town forge&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;ne&quot; &quot;spells&quot; &quot;$npc2.Name&#39;s shack&quot; &quot;Smarty&#39;s shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Mountains&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="454" name="Experiment cave" tags="nobr" position="4975,2725" size="100,100">While you explore the jagged mountains, you come across a cave. You can hear what sounds like crazed babbling coming from within. You&#39;ll need to go in to find out what&#39;s in there. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter&quot; &quot;Enter experiment cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave experiment cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="455" name="Experiment town farm" tags="nobr" position="4975,3375" size="100,100">&lt;&lt;createFixedNPC &quot;earl&quot;&gt;&gt;

&lt;p&gt;You are lead to an expansive cavern that is well lit by an odd glowing orb near its peak. What is more odd, though, is that the cave floor appears to be sprouting plant life. Several &lt;&lt;=$cattle.plural&gt;&gt; graze on grass, and a pen is occupied by several fat &lt;&lt;=$pig.plural&gt;&gt;. Elsewhere, small fields of wheat, corn, and assorted vegetables grow just as vibrantly as they would in a calm, warm grassland. Several extremely fat furs are seen harvesting plants, and one of the larger ones is plowing. &lt;/p&gt;

A thin $npc1.male $npc1.species walks quickly up to you, chewing on a bag of grains absently. &quot;Welcome to the farm. What can I get ya?&quot; $npc1.he asks. A nametag on $npc1.his overalls says //&quot;$npc1.Name&quot;//.

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Earl says&quot;&gt;&gt;

&lt;&lt;vendor &quot;Earl&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade with $npc1.Name&quot; &quot;Trade with Earl&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Experiment Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="456" name="Experiment town forge" tags="nobr" position="5100,3375" size="100,100">&lt;&lt;createFixedNPC &quot;smith&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;snookums&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;smarty&quot; 3&gt;&gt;
&lt;&lt;createFixedNPC &quot;sampson&quot; 4&gt;&gt; /* Another time that we need to use the fabled NPC slot 4 */

&lt;p&gt;You follow $npc2.Name to a sizable, walled-off building. Here, an extremely large $npc1.species is beating a hammer against an anvil, shaping out a piece of metal. $npc1.His tools are normal sized, and look almost comical in $npc1.his huge hands. $npc2.Name waves to get $npc1.his attention, and $npc1.he lets out a grunt when $npc1.he turns and nods at you. &lt;/p&gt;

/*Changes inventory based on quest completion*/
&lt;&lt;if setup.questCompleted($wizardNotebook)&gt;&gt;
&quot;$npc3.Name says you helped,&quot; the smith rumbles, &quot;so you can buy special things.&quot; 
&lt;&lt;vendor &quot;donkey smith special&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
&quot;Tools and weapons,&quot; $npc1.he rumbles out. &quot;What you need?&quot; 
&lt;&lt;vendor &quot;donkey smith normal&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;The donkey smith says&quot;&gt;&gt;
&lt;&lt;if setup.questStage($horseQuestArmor) == 0&gt;&gt;
	&lt;br&gt;&lt;&lt;icon &quot;quest&quot;&gt;&gt;
	&lt;&lt;popup &quot;Ask about $npc4.Name&#39;s chainmail&quot; &quot;Ask about Sampson&#39;s chainmail&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;Trade with the Smith&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Experiment Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="457" name="Ignore Smarty" tags="nobr" position="4850,2975" size="100,100">&lt;&lt;setPassageTitle &quot;Ignore $npc1.Name&quot;&gt;&gt;

&lt;&lt;if setup.questStarted($onBadTermsExperiments)&gt;&gt;
$npc1.His mouth tightens into a sneering frown. &quot;Somehow, I didn&#39;t think so, but you&#39;re not in a good place to try this time,&quot; $npc1.he says, gesturing at you. You hear the giant $npc2.species growling behind you as you are lifted into the air by $npc2.him. $npc2.He carries you back to the mouth of the cave and hurls you out, sending you tumbling a good way down the mountain before you slide to a halt. That didn&#39;t quite go as you&#39;d hoped, and you limp off to explore elsewhere. 

&lt;&lt;set _damage = $maxHea * 0.25&gt;&gt;
&lt;&lt;damage _damage&gt;&gt;
&lt;&lt;if $hea &lt; 1&gt;&gt;&lt;&lt;set $hea = 1&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
$npc1.Name&#39;s face twists into a VERY angry frown, and you think you can see the sides of $npc1.his head throb a bit. &quot;WELL then,&quot; $npc1.he says firmly, &quot;I suppose we&#39;re DONE here.&quot; $npc1.He turns $npc1.his head a bit to look past you. &quot;$npc2.Name, could you show this $p.gentleman the door?&quot; $npc1.he asks pointedly. Without a word, the giant $npc2.species picks you up bodily over $npc2.his head, walks you back to the cave&#39;s entrance, and hurls you out quite physically. You dust yourself off and head somewhere else to let them cool down for a while. 
&lt;&lt;getQuest $onBadTermsExperiments&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="458" name="Learn spells from Smarty" tags="nobr" position="5200,3150" size="100,100">&lt;&lt;teach&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Smarty&#39;s shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="459" name="Leave experiment cave" tags="" position="4850,2725" size="100,100">You decide to avoid these abnormal furs, and head out to find somewhere else to explore instead. 
&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="460" name="Listen to Smarty" tags="nobr" position="5100,2975" size="100,100">&lt;&lt;setPassageTitle &quot;Listen to $npc1.Name&quot;&gt;&gt;

&lt;&lt;createFixedNPC &quot;smarty&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;snookums&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;mountainWizard&quot; 3&gt;&gt;
&lt;&lt;createFixedNPC &quot;smith&quot; 4&gt;&gt; /* Yep, having to go up to create a new fourth NPC slot for this passage... */

&lt;p&gt;You walk up to $npc2.Name, who nods at you and grunts affirmatively. $npc2.He walks with you as you head for the center of the make-shift cave town. 
&lt;/p&gt;

&lt;p&gt;&lt;&lt;if setup.questStarted($onBadTermsExperiments)&gt;&gt;
$npc1.Name sits back, letting out a relieved sigh. &quot;Good, you&#39;ve decided to be reasonable about things. So here&#39;s what&#39;s going on.&quot; $npc1.He clears his throat, then launches into an explanation. 

&lt;&lt;else&gt;&gt;
&quot;Glad to hear that,&quot; $npc1.Name nods, then launches into an explanation. 

&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;p&gt;&quot;There&#39;s a wizard out there who&#39;s having folks delivered to $npc3.him and experimenting on them. Unfortunately, $npc3.he&#39;s not very good at it, and all the people you see here and out wandering the mountains are the result. Through a bit of a fluke, what $npc3.he did actually worked without leaving me crippled with pain, so I&#39;ve been working on how to fix things up. I&#39;ve gotten this far on my own, and those of us here at least have a way to channel our aggression safely and productively, but if I want to have a chance to reverse things, I&#39;m going to need $npc3.his notes.&quot; &lt;/p&gt;

&lt;p&gt;$npc1.He stands up and leads you outside. $npc2.Name is leaning against a wall closeby. &quot;$npc2.Name, be a love and help our guest find whatever $p.he needs. $p.He&#39;s going to help us now,&quot; $npc1.he says to $npc2.him. $npc2.He lets out a happy rumble and marches up to you. &quot;$npc2.Name can show you to the farm, the smith, and back to me. I&#39;ve got a few spells I&#39;ve scrounged up if you can use them, and the smith still has $npc4.his wits and $npc4.his skill, thank heavens. Take a look around and get what you need; that $npc3.species has a nasty pet waiting for you, so you&#39;ll want to be prepared.&quot; &lt;/p&gt;

&lt;p&gt;At that, $npc1.he heads back inside, pouring over $npc1.his books again. $npc2.Name looks at you and rumbles, &quot;$npc1.Name&#39;s your friend now. You hurt $npc1.Name, you get crushed.&quot; Despite the words, $npc2.he doesn&#39;t look quite as angry as before. &lt;/p&gt;

&lt;&lt;removeQuest($onBadTermsExperiments)&gt;&gt;
&lt;&lt;getQuest $onGoodTermsExperiments&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Next&quot; &quot;Experiment Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="461" name="Return the wizard&#39;s notes" tags="nobr" position="5200,3250" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;createFixedNPC &quot;smarty&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;smith&quot; 2&gt;&gt;

&lt;&lt;case &quot;Strong&quot;&gt;&gt;
$npc1.He returns after a minute or two with a wheeled cart. &quot;These are some of the better results of my own experimenting. Unlike some fools, I do my tests on inanimate objects first.&quot; $npc1.He gestures towards it, and you take a closer look. Inside is a set of decorated metal plate armor, golden in color and lined with silk. &quot;I enchanted the metal, and $npc2.Name shaped it,&quot; $npc1.Name explains. &quot;It&#39;ll improve your strength and protect you well. If you want any of the others, I&#39;ve told $npc2.Name to open $npc2.his special stores to you, but you will have to pay for them. Again, I can&#39;t thank you enough. Consider yourself welcome any time.&quot; 

&lt;&lt;questReward $wizardNotebook&gt;&gt;
&lt;&lt;getItem $enchantedKnightArmor&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Smarty&#39;s shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;Fast&quot;&gt;&gt;
$npc1.He returns after a minute or two with what looks to be a set of armor in $npc1.his arms, and lays them out on $npc1.his table. &quot;These are some of the better results of my own experimenting. Unlike some fools, I do my tests on inanimate objects first.&quot; $npc1.He gestures towards it, and you take a closer look. It appears to be a set of decorated light plates connected by a chain mesh backed with comfortable silk. &quot;I enchanted the metal, and $npc2.Name shaped it,&quot; $npc1.Name explains. &quot;This&#39;ll make you faster and protect you well. If you want any of the others, I&#39;ve told $npc2.Name to open $npc2.his special stores to you, but you will have to pay for them. Again, I can&#39;t thank you enough. Consider yourself welcome any time.&quot; 

&lt;&lt;questReward $wizardNotebook&gt;&gt;
&lt;&lt;getItem $enchantedFighterArmor&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Smarty&#39;s shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;Magical&quot;&gt;&gt;
$npc1.He returns after a minute or two with some cloth in $npc1.his arms, and lays it out on $npc1.his table. &quot;These are some of the better results of my own experimenting. Unlike some fools, I do my tests on inanimate objects first.&quot; $npc1.He gestures towards it, and you take a closer look. It appears to be a set of wizard&#39;s clothes of a royal purple coloration trimmed with gold and lined with runes. As well, there appears to be metal plates set into the insides in key locations. &quot;I enchanted the silk and plates, and $npc2.Name shaped them,&quot; $npc1.Name explains. &quot;This&#39;ll make your magic more potent and protect you well. If you want any of the others, I&#39;ve told $npc2.Name to open $npc2.his special stores to you, but you will have to pay for them. Again, I can&#39;t thank you enough. Consider yourself welcome any time.&quot; 

&lt;&lt;questReward $wizardNotebook&gt;&gt;
&lt;&lt;getItem $enchantedWarmageArmor&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Thank you!&quot; &quot;Smarty&#39;s shack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case &quot;&quot;&gt;&gt;
&lt;p&gt;You place the wizard&#39;s notes in front of $npc1.Name, and $npc1.his brow immediately raises. &quot;&#39;&#39;You got it?!&#39;&#39; Fantastic! Wonderful!&quot; $npc1.He immediately sets to it, eagerly brushing all $npc1.his other books onto the floor and slapping it open. $npc1.He flips through it steadily slower as $npc1.he gets further into it, skimming over the pages and visibly growing less excited. &quot;I suppose I should&#39;ve figured,&quot; $npc1.he hums out, closing it turning back to you. &quot;It&#39;s a jumbled mess, but it&#39;s still a boon. I won&#39;t be able to fix things overnight, but if I can make sense of it... Well, you&#39;ve been a great help.&quot; &lt;/p&gt;

$npc1.He stands up and walks toward the door, then turns to you again. &quot;Now, your reward, like I promised. Would you say that... you&#39;re the strong type, the fast type, or the magic type?&quot; 

&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;Strong&quot; &quot;Return the wizard&#39;s notes&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Strong&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Fast&quot; &quot;Return the wizard&#39;s notes&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Fast&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;next&quot; &quot;Magical&quot; &quot;Return the wizard&#39;s notes&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = &quot;Magical&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="462" name="Smarty says" tags="" position="5100,3150" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to $npc1.Name&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Honestly, I&#39;m quite proud of having set this all up. It was quite a trick at first, having to find everybody new one by one. Now they just seem to turn up at our door... Covered in bruises, usually.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;I swear, all those wizards that do the whole &#39;live by yourself to study uninterrupted&#39; nonsense are fools. &#39;Oh, I won&#39;t go crazy if I hit a wall and have nobody to talk to about it!&#39; Bah. The guild exists for a reason.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;$npc2.Name was the first one I found. Heh, I remember when we first met, $npc2.he tried to crush me with a rock. I had to hit $npc2.him with lightning eight times before $npc2.he&#39;d listen to me. Ah, memories.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Have you seen those giant insects? They&#39;re venomous, all of &#39;em. You&#39;d best know some curative magic. Strange thing, though, I&#39;m not sure they&#39;re the wizard&#39;s fault. They&#39;re too... competently made.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="463" name="Smarty&#39;s shack" tags="nobr" position="5100,3250" size="100,100">&lt;&lt;createFixedNPC &quot;smarty&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;snookums&quot; 2&gt;&gt;
&lt;&lt;setPassageTitle &quot;$npc1.Name&#39;s shack&quot;&gt;&gt;

&lt;p&gt;You are lead back to $npc1.Name&#39;s shack. $npc2.Name waves to $npc1.him as $npc1.he looks up from $npc1.his reading. $npc1.He smiles and waves back. &lt;/p&gt;

&quot;What can I do for you?&quot; $npc1.he asks you. 
&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Smarty says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;if setup.questStarted($wizardNotebook) and !setup.questCompleted($wizardNotebook)&gt;&gt;
	&lt;&lt;action &quot;w&quot; &quot;quest&quot; &quot;Return the wizard&#39;s notes&quot;&gt;&gt;
		&lt;&lt;set $eventCounterA = &quot;&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;vendor &quot;Smarty&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;spells&quot; &quot;Learn spells from $npc1.Name&quot; &quot;Learn spells from Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Experiment Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="464" name="Talk to Smarty" tags="nobr" position="4975,2975" size="100,100">&lt;&lt;createFixedNPC &quot;smarty&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;snookums&quot; 2&gt;&gt;

&lt;&lt;setPassageTitle &quot;Talk to $npc1.Name&quot;&gt;&gt;

&lt;&lt;if setup.questStarted($onBadTermsExperiments)&gt;&gt;
&lt;p&gt;You follow the tremendous $npc2.species inside, going past small stone abodes in various states of dishevelment, and into a somewhat-organized chamber, at the center of which is a $npc1.male $npc1.species in slightly tattered robes, presumably $npc1.Name. $npc1.He is rubbing $npc1.his slightly large head with one $npc1.hand as $npc1.he goes over several books. Looking up, $npc1.he furrows $npc1.his brow as $npc1.he spots you. &quot;Oh. It&#39;s //you//,&quot; $npc1.he says coldly. &quot;Are you going to stop causing trouble and listen to me?&quot; $npc1.he asks. &lt;/p&gt;

&lt;&lt;else&gt;&gt;
&lt;p&gt;You follow the tremendous $npc2.species inside, going past small stone abodes in various states of dishevelment, and into a somewhat-organized chamber, at the center of which is a $npc1.male $npc1.species dressed in somewhat tattered robes. $npc1.His head is slightly large, but unlike others that you saw with this trait, $npc1.he is only rubbing it with one $npc1.hand instead of both. Apparently $npc1.he&#39;s more fortunate than the other. $npc1.He looks up from one of the many tomes spread in front of $npc1.him, and greets you. &lt;/p&gt;

&lt;p&gt;&quot;Ah, hello. You&#39;re a new arrival.&quot; $npc1.He steps over to the gigantic $npc2.species and reaches up to touch $npc2.his cheek. &quot;Thank you, $npc2.Name,&quot; $npc1.he says to $npc2.him in a sing-songy voice. &quot;Welcome, $npc1.Name,&quot; $npc2.he rumbles back, smiling. $npc2.He bends down a bit and they share a kiss before $npc2.he heads back out, and $npc1.Name returns $npc1.his attention to you. &quot;We&#39;ve all got a bit of a temper after what happened to us, but $npc2.he&#39;s still a dear,&quot; $npc1.he says off-handedly. $npc1.He clears $npc1.his throat and adopts a more serious look. &quot;Anyways, welcome, traveller, to our refuge. You might&#39;ve noticed that there&#39;s something of an excess of abnormal folks about lately, and sanity is in short supply about them. &lt;/p&gt;

Well, I&#39;m working to fix both of those things, and I could use an adventurer to help me out. You won&#39;t go unrewarded. Care to hear me out?&quot; 
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;talk&quot; &quot;Listen to Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Ignore Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="465" name="Talk to experiments" tags="nobr" position="4975,2850" size="100,100">&lt;&lt;createFixedNPC &quot;smarty&quot; 2&gt;&gt;

&lt;&lt;if setup.questStarted($onBadTermsExperiments)&gt;&gt;
You approach the giant $npc1.species, who grits $npc1.his $npc1.teeth and lets out a growl, clamping down on $npc1.his enormous stone mace. &#39;&#39;&quot;YOU,&quot;&#39;&#39; $npc1.he rumbles, taking a heavy step towards you. &quot;You going to talk to $npc2.Name?&quot; $npc1.he asks, $npc1.his words dangerously pointed. 

&lt;&lt;else&gt;&gt;
As you approach the enormous $npc1.species, $npc1.he holds up one massive hand, and rumbles out, &quot;You go talk to $npc2.Name. $npc2.Name talks to all new arrivals.&quot; You hesitate for a moment, and $npc1.his grip tightens, the stone column crumbling a bit. Looks like $npc1.he&#39;s not very patient... 

&lt;&lt;/if&gt;&gt;


&lt;&lt;action &quot;c&quot; &quot;talk&quot; &quot;Talk to Smarty&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Try to leave experiment cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="466" name="The donkey smith says" tags="nobr" position="5200,3375" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the smith&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case &quot;ask about chainmail&quot;&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;Call me $npc1.Name. Job and name, good for both.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;Other big folk mine. Lots of metal in this mountain.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Not sure what $npc2.Name sees in $npc3.Name.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;Talk, &#39;tis no good. But forge, very good.&quot;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="467" name="Trade with Earl" tags="nobr" position="4975,3475" size="100,100">&lt;&lt;setPassageTitle &quot;Trade with $npc1.Name&quot;&gt;&gt;
&quot;Got plenty for ev&#39;ryone. What&#39;s yer pleasure?&quot;

&lt;&lt;store&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Experiment town farm&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="468" name="Trade with the Smith" tags="nobr" position="5100,3475" size="100,100">&lt;&lt;if setup.questCompleted($wizardNotebook)&gt;&gt;
	The smith pushes aside an enormous stone slab, revealing magical goods to you.
&lt;&lt;else&gt;&gt;
	The smith gestures to a lineup of $npc1.his wares with a grunt. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Leave&quot; &quot;Experiment town forge&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="469" name="Try to leave experiment cave" tags="" position="5100,2850" size="100,100">The enormous $npc1.species growls at you, approaching angrily with $npc1.his giant stone mace in tow! 
&lt;&lt;getQuest $onBadTermsExperiments&gt;&gt;

&lt;&lt;startCombat $snookums&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;snookums&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;smarty&quot; 2&gt;&gt;</tw-passagedata><tw-passagedata pid="470" name="Accept Queen&#39;s offer" tags="" position="5375,2450" size="100,100">You accept the insect queen&#39;s offer, and follow the small worker as it leads you back out of the cave. When you are out, it drops the lump of wax it was holding. On closer inspection, you can see that it is a thinly-coated lump of royal jelly, ready to eat whenever you want it. Given the immense magic coming off it, it doesn&#39;t seem like a bad prize at all. You take it, and head off to continue exploring. 

&lt;&lt;getItem $royalJelly&gt;&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="471" name="Attack the Wasp" tags="nobr" position="5125,2450" size="100,100">&lt;&lt;setPassageTitle &quot;Attack the &lt;&lt;=setup.getSpeciesData(&#39;wasp&#39;).species.toUpperFirst()&gt;&gt;&quot;&gt;&gt;

You brandish your $wea.name at the massive &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt; who hovers over to you menacingly, evidently prepared to battle for it&#39;s Queen&#39;s honor. 

&lt;&lt;startCombat $royalGuardWasp&gt;&gt;</tw-passagedata><tw-passagedata pid="472" name="Enter Hive" tags="" position="5000,2575" size="100,100">&lt;p&gt;You steel yourself and slowly march inside, cold stone echoing your footsteps as you enter. Rounding a corner, you come upon a giant wax structure that fills the entirety of the cave. It is now clear that you are standing outside of an unnaturally huge &lt;&lt;=setup.getSpeciesData(&quot;bee&quot;).species&gt;&gt; hive. You spot insects easily the size of a person heading into and out of chambers along the walls and ceiling. From the looks of it, this cavern expands rather extensively in all directions, though that&#39;s been filled with this chambered hive. Curiously, it appears to be a mixture of &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt;, &lt;&lt;=setup.getSpeciesData(&quot;bee&quot;).plural&gt;&gt;, and &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).plural&gt;&gt; of some description all working in unnatural harmony. &lt;/p&gt;

There appears to be two primary directions you can get to, lacking the ability to fly as you do: The left path leads to a chamber that &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt; with swollen abdomens enter and march out of again less engorged. The right path appears to be guarded by a horrific &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt; that&#39;s the size of a small house. You&#39;d most certainly have to fight to get through. 

&lt;&lt;action &quot;w&quot; &quot;left&quot; &quot;Left&quot; &quot;Larva pit&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;right&quot; &quot;Right&quot; &quot;Queen&#39;s Chambers&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave Hive&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 1&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="473" name="Fight the ants" tags="nobr" position="5125,2325" size="100,100">&lt;&lt;setPassageTitle &#39;Fight the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt;&#39;&gt;&gt;

You step back and ready your $wea.name as the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt; draws closer. It&#39;s seems unwavered by your rebuke and continues forward in a more aggressive manner. It seems to be unwilling to let you go without a fight. 

&lt;hr&gt;
&lt;&lt;startCombat $feederAnt&gt;&gt;</tw-passagedata><tw-passagedata pid="474" name="Insect Hive" tags="mountains" position="4875,2575" size="100,100">While you explore the jagged mountains, you come across a cave. You can hear an odd buzzing, even from outside. You&#39;ll need to go in to find out what&#39;s in there. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter cave&quot; &quot;Enter Hive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave Hive&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="475" name="Larva pit" tags="nobr" position="5000,2450" size="100,100">You sneak past the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt; and into the chamber. Looking around, you can see white larva wriggling about on the ground, only a few inches in length, broken eggs being carted away by &lt;&lt;=setup.getSpeciesData(&quot;bee&quot;).plural&gt;&gt; and &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt; that are less gigantic than others in here, most likely the worker subspecies. One of the giant &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt;-like creatures with engorged thoraxes crawls into the middle of a group of larva, turning its thorax to each in turn and exuding what appears to be extremely thick, dense honey into their mouths. Surprisingly, the larva grow in size as they eat, rapidly redoubling in bulk before pulling away from the feeding insect. You have just enough time to realize that whatever magic is involved in this honey is why the insects are giant before one of the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).adjective&gt;&gt;s comes up to you, swollen thorax first. 

&lt;&lt;action &quot;n&quot; &quot;surrender&quot; &quot;Submit&quot; &quot;Submit to the ants&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA = 0&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Fight&quot; &quot;Fight the ants&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="476" name="Leave Hive" tags="nobr" position="4875,2450" size="100,100">&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 0&gt;&gt;
You decide that you don&#39;t want to deal with something that buzzes quite that loud, and head back out to find a different adventure. 

&lt;&lt;case 1&gt;&gt;
You decide that you don&#39;t want to deal with something that buzzes quite that loud, and head back out to find a different adventure. 

&lt;&lt;/switch&gt;&gt;

&lt;hr&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="477" name="Queen&#39;s Chambers" tags="" position="5125,2575" size="100,100">You make for the guarded chamber, under scrutinous watch from the giant &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt;. As you approach, its wings make a deep buzz. It hovers in the air and points its stinger at you threateningly. It does not attack immediately, and you get a fairly clear view of a grossly oversized insectoid, unable to move under its own girth. It is tended to by smaller insects, shoving honey into its mouth and collecting eggs from behind its thorax. If you want to approach it, you&#39;re going to have to go through its guard... 

&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Attack the Guard&quot; &quot;Attack the Wasp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;leave&quot; &quot;Back out&quot; &quot;Enter Hive&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="478" name="Slay Queen" tags="" position="5250,2325" size="100,100">The worker carrying your bribe scurries off as you turn away from it and back towards the queen. You have decided to destroy the monstrous thing, and a few swift attacks are enough to put it down. As the massive insect slumps over and goes still, you spot something glinting at the end of its thorax. Going down to take a look, you see the &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt;-like aspect of it has left this deceased creature with a very long stinger. On top of that, it looks loose. You give it a few good yanks, and the stinger dislodges. It is long enough, hard enough, and pointy enough to use as a long thrusting weapon, and it even has a bit that was inside the queen that is thin enough to use as a hand hold... after you wash it off. You take your new weapon and head back out to continue exploring. 

&lt;&lt;getItem $queensSting&gt;&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="479" name="Submit to the ants" tags="nobr" position="5000,2325" size="100,100">&lt;&lt;setPassageTitle &#39;Submit to the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).plural&gt;&gt;&#39;&gt;&gt;

&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&lt;p&gt;You decide to throw caution to the wind and tilt your head up passively, opening your mouth and waiting. The huge &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt; creature pushes the tip of its thorax into your mouth, and you are immediately overwhelmed by its sweet, gooey honey. All you can do is hold on for dear life as you watch the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt;&#39;s thorax slowly thin, your belly bulging fuller and tighter in response. The sheer force of the extrusion of honey is forcing it down your throat, and given the hefty mass of the &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt;&#39;s body holding you in place now, you couldn&#39;t stop if you wanted to. 
&lt;&lt;set _calories = random(240,360)&gt;&gt;
&lt;&lt;set _honey = _calories * 1.67&gt;&gt;
&lt;&lt;consume _honey _calories&gt;&gt;
&lt;/p&gt;

&lt;&lt;if $alive&gt;&gt;
As you fill with the enchanted honey, you can feel yourself growing stronger. Greedily, you reach up and squeeze the feeder &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt;&#39;s thorax, forcing the honey out of it and down your throat even faster. After just a few more moments of this, the creature is left in your grasp, squirming a bit as the flow slows to a trickle, then stops. You lick your lips, your face a dripping mess of sticky sweetness, before coming to realize that all the insects have stopped entirely. It seems that they didn&#39;t expect this to happen and have completely locked up. You decide to capitalize on the confusion, and use your new strength to haul your significantly greater mass back out of the cave. 

&lt;&lt;buff &quot;str&quot; 30 480&gt;&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;
And after the first few gallons, you definitely want to. You rub at your belly as it swells and stretches, but the torrent just does not end. You are filled well beyond your limits, left groaning on the ground, held up only by your $waist belly. Its magic has certainly had an effect on you; your muscles feel significantly larger, but even with your increased strength, you don&#39;t have the will to move. 

&lt;&lt;tempBuff &quot;str&quot; -30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Submit to the ants&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA++&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;case 1&gt;&gt;
Which is unfortunate for you, because as the feeder &lt;&lt;=setup.getSpeciesData(&quot;ant&quot;).species&gt;&gt; walks away, another moves up to take its place. You are helpless as your belly is made to swell to tremendous size by another... 
&lt;&lt;consume 500 300&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; -30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Submit to the ants&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA++&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 2&gt;&gt;
And another... 
&lt;&lt;consume 500 300&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; -30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Submit to the ants&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA++&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 3&gt;&gt;
And another... 
&lt;&lt;consume 500 300&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; -30&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Submit to the ants&quot;&gt;&gt;
	&lt;&lt;set $eventCounterA++&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 4&gt;&gt;
&lt;p&gt;And another. By the time they&#39;re done, your massive gut is the size of the passageway you came down, and in spite of how enormous your muscles have become, you can do little but flail your limbs about, unable to move the tremendous load of honey housed inside you. You have little time to contemplate this before a pack of worker insects start to roll you towards what appears to be an offshoot of the chamber. When you&#39;re inside it, however, it becomes apparent that you have been shoved into a hollowed out comb, as you feel the waxy walls all around you. &lt;/p&gt;

&lt;p&gt;As the insects finish jamming you into the chamber, a few of the &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).plural&gt;&gt; begin to disgorge wax on you. Where it makes contact with your $p.fur, there&#39;s an odd itching and stiffening that slowly spreads through you. When it coats your limbs, you can only watch as you lose the ability to move, your body coming to match the wax&#39;s consistency. The realization dawns on you that you are becoming a storage chamber for all the honey that was forced into you, but before you have time to ponder the implications, the change is complete, and you lose all sense of being. &lt;/p&gt;

&lt;&lt;consume 500 300&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; -30&gt;&gt;
&lt;&lt;defeated &quot;transformed&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="480" name="Wasp Defeated" tags="nobr" position="5250,2450" size="100,100">&lt;&lt;setPassageTitle &#39;&lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species.toUpperFirst()&gt;&gt; Defeated&#39;&gt;&gt;

Leaving behind the wrecked body of the guard &lt;&lt;=setup.getSpeciesData(&quot;wasp&quot;).species&gt;&gt;, you approach the giant, bloated beast of a queen. As you do, the small servants scatter from you, already beginning to tend the guard. The queen turns at you, its mandibles flexing in what might be a threatening manner, if it weren&#39;t so completely engorged as to be immobile. It turns its gaze at one of the workers, which stops its frantic scattering and run to another room. After a moment, it appears in the doorway, holding a lump of something. The queen has stopped attempted to look threatening and is merely staring at you. It seems to be offering you a bribe to leave it alone... 

&lt;&lt;action &quot;w&quot; &quot;yes&quot; &quot;Accept Queen&#39;s offer&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;attack&quot; &quot;Slay Queen&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="481" name="Approach the wyvern nest" tags="nobr" position="5100,2050" size="100,100">&lt;&lt;setPassageTitle &#39;Approach the &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species&gt;&gt; nest&#39;&gt;&gt;

Not one to be deterred by adversity, you brace yourself for combat and make your way closer to the nest. Sure enough, the &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species&gt;&gt; guarding it comes marching at you, roaring in a fury! 

&lt;&lt;startCombat $fatWyvern&gt;&gt;</tw-passagedata><tw-passagedata pid="482" name="Enter the wyvern cave" tags="" position="4975,2050" size="100,100">&lt;&lt;setPassageTitle &#39;Enter the &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species&gt;&gt; cave&#39;&gt;&gt;

You steel yourself and slowly march inside, cold stone echoing your footsteps as you enter. Not too far in, you find what was making the sound you heard outside: An especially large &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species&gt;&gt; guarding a nest. You can see the nest has baby &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).plural&gt;&gt; in it, and can also make out the glint of metal. It&#39;s entirely possible that this nest has treasure in it, but if you want it, you&#39;re going to have to get past an angry parent. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Approach the nest&quot; &quot;Approach the wyvern nest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave the wyvern cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="483" name="Leave the wyvern cave" tags="" position="4850,2050" size="100,100">&lt;&lt;setPassageTitle &quot;Leave the &lt;&lt;=setup.getSpeciesData(&#39;wyvern&#39;).species&gt;&gt; cave&quot;&gt;&gt;

You decide to stay away from things that growl that loudly, and head off to find a different place to explore. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="484" name="Pillage the Wyvern nest" tags="" position="5225,2050" size="100,100">&lt;&lt;setPassageTitle &#39;Pillage the &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species&gt;&gt; nest&#39;&gt;&gt;

You approach the nest, half a dozen small, reptillian faces turning up and squeaking at you. While the glints of metal turned out to be nothing more than worthless scrap, the nest does contain an unhatched egg. Given the size and strength of the &lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species&gt;&gt; that guarded it, there might be something magical about it, so you take it and head back to the mountains. 

&lt;&lt;getItem $largeWyvernEgg&gt;&gt;
&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="485" name="Wyvern cave" tags="mountains" position="4975,2175" size="100,100">&lt;&lt;setPassageTitle &#39;&lt;&lt;=setup.getSpeciesData(&quot;wyvern&quot;).species.toUpperFirst()&gt;&gt; cave&#39;&gt;&gt;

While you explore the jagged mountains, you come across a cave. You can hear an intermittant growling, even from outside. You&#39;ll need to go in to find out what&#39;s in there. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Enter the cave&quot; &quot;Enter the wyvern cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;mountain&quot; &quot;Leave&quot; &quot;Leave the wyvern cave&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="486" name="Attack the tiger" tags="nobr" position="4175,2200" size="100,100">&lt;&lt;setPassageTitle &quot;Attack the mountainous $npc1.species&quot;&gt;&gt;

&lt;p&gt;You let forth a shout and charge forward. The $npc1.species tying $npc1.his bag shut before turning to you, looking a bit surprised. As you draw close you can see just how built $npc1.he is. Clad in only a dark loincloth, $npc1.he is all but drowning in $npc1.his own muscle. $npc1.His head is all but buried between $npc1.his chest and $npc1.his back, and $npc1.his biceps are easily larger than you were before the start of your journey.&lt;&lt;if $npc1.nspecies == &quot;tiger&quot;&gt;&gt; $npc1.His $npc1.stripes cling to $npc1.his bulges for dear life.&lt;&lt;/if&gt;&gt;&lt;/p&gt;

$npc1.He leers at you as you approach, before turning around and giving $npc1.his overmuscled bubble-butt a taunting slap. &quot;You wanna play? Let&#39;s play!&quot; 

&lt;&lt;startCombat $mountainousTiger&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;tigerBoss&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="487" name="Controlled by the Cabal Dragon" tags="" position="4675,2175" size="100,100">&lt;&lt;setPassageTitle &quot;The cabal rogue&#39;s puppet&quot;&gt;&gt;

&lt;&lt;doTime 4320&gt;&gt;
&lt;&lt;stuffToBursting&gt;&gt;
&lt;&lt;consume 3000 2500&gt;&gt;
&lt;&lt;tempBuff &quot;str&quot; -40&gt;&gt;
&lt;&lt;tempBuff &quot;agi&quot; -10&gt;&gt;
&lt;&lt;tempBuff &quot;end&quot; -10&gt;&gt;
&lt;&lt;tempBuff &quot;int&quot; -10&gt;&gt;
&lt;p&gt;There are hazy memories of roaming the mountain and eating, being fed sweet honey by massive insects, and devouring unwary travellers and all their food whole. You lose track of time, and the world is only clear again when you stand before your captor once more, massively overfed and awaiting $npc1.his command. $npc1.He beckons, and you slowly haul yourself to $npc1.his $npc1.feet before embracing $npc1.his huge belly. The $npc1.species lets out a deep growl, and you feel yourself slowly sink in to $npc1.his huge, soft stomach. It engulfs you, a soft, gelatinous grey pillow that sucks you into its squishy warmth, wrapping around you gently but firmly, pulling you in. &lt;/p&gt;


&lt;p&gt;$npc1.He wraps $npc1.his arms around you, pulling you into $npc1.him as the majority of your body below your neck is engulfed by $npc1.his now-ooze-like belly. You are over-joyed to finally be being consumed... And at that moment, $npc1.he touches your head, releasing $npc1.his control of your thoughts. You have just enough time for the realization of what&#39;s happened to sink in before $npc1.he shoves your head inside of $npc1.him, and you are soon turned into more of $npc1.his massive stomach. &lt;/p&gt;

&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="488" name="Fight the cabal dragon" tags="" position="4575,2175" size="100,100">&lt;&lt;setPassageTitle &quot;Confront the cabal rogue&quot;&gt;&gt;

&lt;&lt;createFixedNPC &quot;cabalRogue&quot;&gt;&gt;

You follow the map to a cliff face and find an unlit cave. Stepping inside reveals the darkness to be an illusion; once you set foot within, you are greeted by a large, lit passageway. Following it deeper inside, you come to a huge, dome-shaped chamber. A magical force triggers behind you, barring the way you came. A deep, rumbling voice booms out, &quot;So, the cabal has sent another meal to me? How kind of them!&quot; The entire floor lights up in a gigantic magical circle, and a gigantic anthropomorphic $npc1.color $npc1.species is revealed to be before you, light glinting off $npc1.his eyes and sharp teeth. With no way out, you steel yourself for battle! 

&lt;&lt;startCombat $cabalDragon&gt;&gt;
&lt;&lt;updateEnemyWithNPC &quot;cabalRogue&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="489" name="Run from the tiger" tags="" position="4300,2075" size="100,100">You realize that if such a massive $npc1.adjective had no trouble catching that many people, $npc1.he probably wouldn&#39;t have a problem forcing you to join them. Turning tail, you scurry back down the hill you came up, hoping $npc1.he didn&#39;t see you. 

&lt;&lt;include &quot;mountain randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="490" name="Tiger fight" tags="mountains" position="4300,2200" size="100,100">&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 2&gt;&gt;
&lt;&lt;createFixedNPC &quot;tigerBoss&quot;&gt;&gt;

&lt;&lt;setPassageTitle &quot;A mountainous $npc1.species&quot;&gt;&gt;

As you crest a hill, you find yourself looking down at a scene in progress a good hundred yards away. $npc1.Article $npc1.species of improbable musculature seems rather occupied with tying up a particularly fat $npc2.species. From this distance, you gauge $npc1.him to be about a good fifteen feet in height, but larger than $npc1.him is what appears to be a sack, the size of a building, in black cloth and gold-thread embroidery. The $npc1.species hefts up the helpless $npc2.species, pulling open the mouth of the bag and stuffing $npc2.him right in. You suddenly realize that the entire bulging payload is filled to the brim with all manner of fattened captives. 

&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Attack the tiger&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;run&quot; &quot;Run from the tiger&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="491" name="species variables" tags="nobr" position="3800,425" size="200,100">/* FIXES AND EDITS - Overhaul of species system. This should be loaded once to establish the base core, then never again. Later edits to these species should be done via `setup.registerSpecies` */
/* FIXES AND EDITS - Added new elements to all species, as well as introduced missing species that appear in game narration, but don&#39;t have an entry */

/* Wipe existing species data - Species patches happen every time */
&lt;&lt;set $speciesList = {}&gt;&gt;

/*
Default template
&lt;&lt;set $ = {
	article: &quot;&quot;,
	id: &quot;&quot;,	
	species: &quot;&quot;,
	angry: &quot;&quot;,
	furBack: &quot;&quot;, furBelly: &quot;&quot;, furHead: &quot;&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;&quot;,
	tail: &quot;&quot;,
	teeth: &quot;&quot;,
	mouth: &quot;&quot;,
	fname: &quot;&quot;,
	mname: &quot;&quot;,
	speciesHeight: ,
	speciesStats: [,,,,,],
}&gt;&gt;
*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;catgirl&quot;,	
	species: &quot;catgirl&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;tan&quot;, furBelly: &quot;tan&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	fname: &quot;woman&quot;,
	mname: &quot;man&quot;,
	speciesHeight: 71,
	speciesStats: [6,6,6,6,6,6],
	adjective: &quot;feline&quot;,
    
    core: &quot;true&quot;,

	carnivore: true,
    herbivore: true,
    human: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;human&quot;,	
	species: &quot;human&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;tan&quot;, furBelly: &quot;tan&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;spine&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	fname: &quot;woman&quot;,
	mname: &quot;man&quot;,
	speciesHeight: 71,
	speciesStats: [6,6,6,6,6,6],
	adjective: &quot;human&quot;,

	carnivore: true,
    herbivore: true,
    human: true,
})&gt;&gt;

/*=================*/
/*==== Aquatic ====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;dolphin&quot;,	
	species: &quot;dolphin&quot;,
	angry: &quot;click&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;light grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;fin&quot;, feet: &quot;fins&quot;,
	hand: &quot;fin&quot;, hands: &quot;fins&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;skin&quot;,
	tail: &quot;tail fin&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;&quot;,
	mname: &quot;&quot;,
	speciesHeight: 68,
	speciesStats: [4,7,4,7,3,3],
	adjective: &quot;delphine&quot;,
	core: true,
	aquatic: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;orca&quot;,	
	species: &quot;orca&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;fin&quot;, feet: &quot;fins&quot;,
	hand: &quot;fin&quot;, hands: &quot;fins&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;skin&quot;,
	tail: &quot;tail fin&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 76,
	speciesStats: [7,5,4,2,7,15],
	core: true,
	adjective: &quot;orcin&quot;, /* don&#39;t know if that&#39;s true or not, but it sounds right :P */
	aquatic: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;shark&quot;,	
	species: &quot;shark&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;dark grey&quot;, furBelly: &quot;light grey&quot;, 
	furHead: &quot;light grey&quot;,
	foot: &quot;fin&quot;, feet: &quot;fins&quot;,
	hand: &quot;fin&quot;, hands: &quot;fins&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;skin&quot;,
	tail: &quot;tail fin&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 72,
	speciesStats: [8,5,2,0,10,5],
	core: true,
	adjective: &quot;selachian&quot;,
	aquatic: true,
})&gt;&gt;

/*=================*/
/*===== Avian =====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;blueJay&quot;, /* FIXES AND EDITS - Fix ID */
	species: &quot;blue jay&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;white&quot;, furHead: &quot;blue&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 59,
	speciesStats: [3,9,6,7,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;hawk&quot;,	
	species: &quot;hawk&quot;,
	angry: &quot;screech&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 64,
	speciesStats: [5,9,5,6,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;owl&quot;,	
	species: &quot;owl&quot;,
	angry: &quot;hoot&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;white&quot;, furHead: &quot;grey&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 63,
	speciesStats: [5,6,5,9,0,2],
	core: true,
	adjective: &quot;avian&quot;,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;penguin&quot;,	
	species: &quot;penguin&quot;,
	angry: &quot;honk&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 66,
	speciesStats: [4,4,5,5,7,6],
	core: true,
	adjective: &quot;avian&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;raven&quot;,	
	species: &quot;raven&quot;,
	angry: &quot;caw&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 61,
	speciesStats: [3,8,5,9,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;robin&quot;,	
	species: &quot;robin&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;red&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 61,
	speciesStats: [3,8,5,9,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;magpie&quot;,	
	species: &quot;magpie&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 58,
	speciesStats: [2,9,4,10,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;

/* FIXES AND EDITS - There&#39;s a duck NPC but no duck species, so added in a duck for the sake of simplicity ;P */
&lt;&lt;run setup.registerSpecies({
  article: &quot;a&quot;,
  id: &quot;duck&quot;,	
  species: &quot;duck&quot;,
  angry: &quot;quack&quot;,
  furBack: &quot;brown&quot;, furBelly: &quot;beige&quot;, furHead: &quot;brown&quot;,
  foot: &quot;webbed foot&quot;, feet: &quot;webbed feet&quot;,
  hand: &quot;wing&quot;, hands: &quot;wings&quot;,
  fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
  hair: &quot;headfeathers&quot;,
  tail: &quot;tailfeathers&quot;,
  teeth: &quot;bill&quot;,
  mouth: &quot;bill&quot;,
  speciesHeight: 63,
  speciesStats: [4,6,8,7,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;chicken&quot;,	
	species: &quot;chicken&quot;,
    mname: &quot;rooster&quot;,
    fname: &quot;hen&quot;,
	angry: &quot;cluck&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 61,
	speciesStats: [3,6,7,6,3,5],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;parrot&quot;,	
	species: &quot;parrot&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;blue&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 58,
	speciesStats: [2,9,4,10,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
})&gt;&gt;


/*=================*/
/*==== Canines ====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;coyote&quot;,	
	species: &quot;coyote&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;grey-brown&quot;, furBelly: &quot;light grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [2,5,6,7,5,3],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;dog&quot;,	
	species: &quot;dog&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [5,5,5,5,5,8],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;fox&quot;,	
	species: &quot;fox&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;white&quot;, furHead: &quot;red&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [1,5,7,7,5,3],
	core: true,
	adjective: &quot;vulpine&quot;,
	carnivore: true,
	plural: &quot;foxes&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;paintedDog&quot;,	/* FIXES AND EDITS - Fix ID */
	species: &quot;painted dog&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;spotted&quot;, furBelly: &quot;spotted&quot;, furHead: &quot;spotted&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 66,
	speciesStats: [4,5,7,4,5,3],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;wolf&quot;,	
	species: &quot;wolf&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [5,5,5,3,7,5],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
	plural: &quot;wolves&quot;,
})&gt;&gt;

/*=================*/
/*=== Dinosaurs ===*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;raptor&quot;,	
	species: &quot;raptor&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;dark green&quot;, furBelly: &quot;beige&quot;, furHead: &quot;dark green&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 70,
	speciesStats: [3,7,4,1,10,0],
	core: true,
	adjective: &quot;saurian&quot;, /* not actually the term but it sounds good */
	dinosaur: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pterodactyl&quot;,	
	species: &quot;pterodactyl&quot;,
	angry: &quot;screech&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;beige&quot;, furHead: &quot;green&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 65,
	speciesStats: [3,9,6,5,2,4],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
	/* won&#39;t add flying label because I think dinos are intended to be restricted */
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;triceratops&quot;,	
	species: &quot;triceratops&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long powerful tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 75,
	speciesStats: [8,0,7,5,5,20],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
	plural: &quot;triceratops&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;stegosaurus&quot;,	
	species: &quot;stegosaurus&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;beige&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;spiky tail&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 75,
	speciesStats: [6,0,7,7,5,20],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
	plural: &quot;stegosauruses&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;apatosaurus&quot;,	
	species: &quot;apatosaurus&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;extremely long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 84,
	speciesStats: [7,0,7,6,5,20],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
	plural: &quot;apatosauruses&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;tyrannosaurus&quot;,	
	species: &quot;tyrannosaurus&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;dark green&quot;, furBelly: &quot;beige&quot;, furHead: &quot;dark green&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long powerful tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 78,
	speciesStats: [8,3,4,0,10,5],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
	plural: &quot;tyrannosauruses&quot;,
})&gt;&gt;

/*=================*/
/*==== Dragons ====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;blackDragon&quot;,	
	species: &quot;black dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;gold&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 74,
	speciesStats: [8,2,0,5,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;blueDragon&quot;,	
	species: &quot;blue dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;gold&quot;, furHead: &quot;blue&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [5,0,2,8,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;greenDragon&quot;,	
	species: &quot;green dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;gold&quot;, furHead: &quot;green&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 76,
	speciesStats: [10,2,1,2,10,10],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;redDragon&quot;,	
	species: &quot;red dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;gold&quot;, furHead: &quot;red&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [6,4,2,3,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;whiteDragon&quot;,	
	species: &quot;white dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;gold&quot;, furHead: &quot;white&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 74,
	speciesStats: [7,0,3,5,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;wyvern&quot;,	
	species: &quot;wyvern&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;draconic&quot;, /* Dragon nerds, please don&#39;t lynch me for this */
	speciesHeight: 73,
	speciesStats: [6,4,3,2,10,5],
	
	dragon: true,
	carnivore: true,
	flying: true,
})&gt;&gt;

/*=================*/
/*==== Feline =====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;lion&quot;,	
	species: &quot;lion&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;golden&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;mane&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;fangs&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;lioness&quot;,
	mname: &quot;lion&quot;,
	speciesHeight: 71,
	speciesStats: [5,5,5,0,10,4],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;cheetah&quot;,	
	species: &quot;cheetah&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;spotted&quot;, furBelly: &quot;white&quot;, furHead: &quot;spotted&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 66,
	speciesStats: [0,10,5,0,10,0],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;cougar&quot;,	
	species: &quot;cougar&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;gold&quot;, furBelly: &quot;white&quot;, furHead: &quot;gold&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long poofy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 67,
	speciesStats: [4,6,5,3,7,3],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;leopard&quot;,	
	species: &quot;leopard&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;rosetted&quot;, furBelly: &quot;black-white&quot;, 
	furHead: &quot;black-gold&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [4,6,5,3,7,3],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;panther&quot;,	
	species: &quot;panther&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [4,6,5,3,7,3],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;tiger&quot;,	
	species: &quot;tiger&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black and orange striped&quot;, 
	furBelly: &quot;white&quot;, furHead: &quot;striped&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 72,
	speciesStats: [5,5,5,0,10,4],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
})&gt;&gt;

/* FIXES AND EDITS - Core additions */
&lt;&lt;run setup.registerSpecies({ /* Yes, this is basically just a copy of the cheetah */
	article: &quot;a&quot;,
	id: &quot;jaguar&quot;,	
	species: &quot;jaguar&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;spotted&quot;, furBelly: &quot;spotted&quot;, furHead: &quot;spotted&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;feline&quot;,
	speciesHeight: 68,
	speciesStats: [5,4,3,6,7,3],
	
	carnivore: true,
})&gt;&gt;

/*=================*/
/*==== Hooved =====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;cattle&quot;,	/* FIXES AND EDITS - Fix ID */
	species: &quot;cow&quot;,
	angry: &quot;moo&quot;,
	furBack: &quot;black and white&quot;, furBelly: &quot;black and white&quot;, 
	furHead: &quot;black&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;cow&quot;,
	mname: &quot;bull&quot;,
	speciesHeight: 76,
	speciesStats: [8,0,7,5,5,25],
	core: true,
	adjective: &quot;bovine&quot;,
	herbivore: true,
	plural: &quot;cattle&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;deer&quot;,	
	species: &quot;deer&quot;,
	angry: &quot;grunt&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;doe&quot;,
	mname: &quot;buck&quot;,
	speciesHeight: 67,
	speciesStats: [4,7,5,4,5,10],
	core: true,
	adjective: &quot;cervine&quot;,
	herbivore: true,
	plural: &quot;deer&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;donkey&quot;,	
	species: &quot;donkey&quot;,
	angry: &quot;bray&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 70,
	speciesStats: [7,5,8,5,0,6],
	core: true,
	adjective: &quot;asinine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;goat&quot;,	
	species: &quot;goat&quot;,
	angry: &quot;bleat&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [6,2,7,5,5,15],
	core: true,
	adjective: &quot;caprine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;horse&quot;,	
	species: &quot;horse&quot;,
	angry: &quot;whinny&quot;,
	furBack: &quot;beige&quot;, furBelly: &quot;beige&quot;, furHead: &quot;beige&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;mare&quot;,
	mname: &quot;stallion&quot;,
	speciesHeight: 76,
	speciesStats: [7,7,7,4,0,4],
	core: true,
	adjective: &quot;equine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;pig&quot;,	
	species: &quot;pig&quot;,
	angry: &quot;oink&quot;, /* FIXES AND EDITS - Pigs go oink */
	furBack: &quot;pink&quot;, furBelly: &quot;pink&quot;, furHead: &quot;pink&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;curly tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 67,
	speciesStats: [4,3,5,7,6,13],
	core: true,
	adjective: &quot;porcine&quot;,
	herbivore: true,
})&gt;&gt;

/*=================*/
/*=== Mustelid ====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;badger&quot;,	
	species: &quot;badger&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black and white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;poofy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 66,
	speciesStats: [6,4,5,5,5,10],
	core: true,
	adjective: &quot;musteline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;ferret&quot;,	
	species: &quot;ferret&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 56,
	speciesStats: [3,9,5,8,0,0],
	core: true,
	adjective: &quot;musteline&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;greyKangaroo&quot;,	
	species: &quot;grey kangaroo&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thick tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 65,
	speciesStats: [5,7,6,5,2,5],
	core: true,
	adjective: &quot;macropidine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;redKangaroo&quot;,	
	species: &quot;red kangaroo&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;russet&quot;, furBelly: &quot;beige&quot;, furHead: &quot;russet&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thick tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 72,
	speciesStats: [7,4,6,4,4,5],
	core: true,
	adjective: &quot;macropidine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;otter&quot;,	
	species: &quot;otter&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;dark brown&quot;, furBelly: &quot;light brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,7,6,8,0,5],
	core: true,
	adjective: &quot;lutrine&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;raccoon&quot;,	
	species: &quot;raccoon&quot;,
	angry: &quot;hiss&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey striped&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,5,4,8,4,8],
	core: true,
	adjective: &quot;procyonine&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;skunk&quot;,	
	species: &quot;skunk&quot;,
	angry: &quot;hiss&quot;,
	furBack: &quot;black and white&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;large fluffy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 62,
	speciesStats: [5,5,7,7,1,5],
	core: true,
	adjective: &quot;mephitine&quot;,
})&gt;&gt;

/* FIXES AND EDITS - Core additions */
&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;weasel&quot;,	
	species: &quot;weasel&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;musteline&quot;,
	speciesHeight: 58,
	speciesStats: [4,8,5,8,0,0],
	
	carnivore: true,
})&gt;&gt;

/*=================*/
/*==== Rodent =====*/
/*=================*/
/* &quot;rodentian&quot; is the general adjective for rodents, but I think &quot;rodent&quot; would probably pass */

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;mouse&quot;,	
	species: &quot;mouse&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thin tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 58,
	speciesStats: [3,6,5,8,3,2],
	core: true,
	adjective: &quot;rodent&quot;,
	herbivore: true,
	plural: &quot;mice&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;rabbit&quot;,	
	species: &quot;rabbit&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;grey-brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;grey-brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;stubby tail&quot;,
	teeth: &quot;long teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,7,5,5,4,5],
	core: true,
	adjective: &quot;leporine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;rat&quot;,	
	species: &quot;rat&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thin tail&quot;,
	teeth: &quot;long teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 65,
	speciesStats: [4,5,6,6,4,5],
	core: true,
	adjective: &quot;rodent&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;squirrel&quot;,	
	species: &quot;squirrel&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;white&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long bushy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 59,
	speciesStats: [3,7,6,6,2,3],
	core: true,
	adjective: &quot;sciurine&quot;, /* okay, I know I said I prefer to stick to the generals, and &quot;rodent&quot; would work here, I just like the word &quot;sciurine&quot; :p */
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;bat&quot;,	
	species: &quot;bat&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;stubby tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 64,
	speciesStats: [4,6,6,6,2,1],
	core: true,
	adjective: &quot;pteropine&quot;,
	flying: true,
})&gt;&gt;

/* FIXES AND EDITS - Core additions */
&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;shrew&quot;,	
	species: &quot;shrew&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thin tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;soricine&quot;,
	speciesHeight: 56,
	speciesStats: [3,7,5,7,3,2],
	
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;gopher&quot;,	
	species: &quot;gopher&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;grey-brown&quot;, furBelly: &quot;grey-brown&quot;, furHead: &quot;grey-brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;long teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;rodent&quot;,
	speciesHeight: 62,
	speciesStats: [5,4,7,5,4,5],
	
	herbivore: true,
})&gt;&gt;

/*=================*/
/*==== Ursine =====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;blackBear&quot;,	
	species: &quot;black bear&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 77,
	speciesStats: [8,0,5,0,12,20],
	core: true,
	adjective: &quot;ursine&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;brownBear&quot;,	
	species: &quot;brown bear&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 76,
	speciesStats: [8,0,5,0,12,20],
	core: true,
	adjective: &quot;ursine&quot;,
	carnivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;panda&quot;,	
	species: &quot;panda&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 75,
	speciesStats: [8,0,5,0,12,22],
	core: true,
	adjective: &quot;ursine&quot;,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;polarBear&quot;,	
	species: &quot;polar bear&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 78,
	speciesStats: [8,0,5,0,12,20],
	core: true,
	adjective: &quot;ursine&quot;,
})&gt;&gt;

/*=================*/
/*==== INSECT =====*/
/*=================*/
&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;bee&quot;,	
	species: &quot;bee&quot;,
	angry: &quot;buzz&quot;,
	furBack: &quot;black and yellow striped&quot;, furBelly: &quot;black and yellow striped&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fuzz&quot;, furred: &quot;fuzzed&quot;, furry: &quot;fuzzy&quot;,
	hair: &quot;head&quot;,
	tail: &quot;stinger&quot;,
	teeth: &quot;mandibles&quot;,
	mouth: &quot;mouth&quot;,
	core: true,
	adjective: &quot;apiarian&quot;,
	speciesHeight: 58,
	speciesStats: [5,7,8,5,0,0],
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;wasp&quot;,	
	species: &quot;wasp&quot;,
	angry: &quot;buzz&quot;,
	furBack: &quot;black and yellow striped&quot;, furBelly: &quot;black and yellow striped&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;chitin&quot;, furred: &quot;chitinous&quot;, furry: &quot;chitin&quot;,
	hair: &quot;head&quot;,
	tail: &quot;stinger&quot;,
	teeth: &quot;mandibles&quot;,
	mouth: &quot;mouth&quot;,
	core: true,
	adjective: &quot;vespine&quot;,
	speciesHeight: 59,
	speciesStats: [8,7,5,5,0,0],
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;ant&quot;,	
	species: &quot;ant&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;chitin&quot;, furred: &quot;chitinous&quot;, furry: &quot;chitin&quot;,
	hair: &quot;head&quot;,
	tail: &quot;stinger&quot;,
	teeth: &quot;mandibles&quot;,
	mouth: &quot;mouth&quot;,
	core: true,
	adjective: &quot;insect&quot;,
	speciesHeight: 56,
	speciesStats: [10,3,5,2,0,0],
})&gt;&gt;

/*=================*/
/*==== REPTILE ETC =====*/
/*=================*/

/* FIXES AND EDITS - Core additions */
&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;hydra&quot;,	
	species: &quot;hydra&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;blue&quot;, furHead: &quot;blue&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;heads&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;reptilian&quot;, 
	speciesHeight: 75,
	speciesStats: [4,0,10,6,5,5],
	
	noRandom: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;snake&quot;,	
	species: &quot;snake&quot;,
	angry: &quot;hiss&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;green&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long, snaking tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;serpentine&quot;,
	speciesHeight: 65,
	speciesStats: [0,0,0,5,20,0],
})&gt;&gt;

/* FIXES AND EDITS - There&#39;s a lizard NPC but no lizard species, so adding one for simplicity... even though &quot;Lizard&quot; is horribly generic */
&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;lizard&quot;,	
	species: &quot;lizard&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;green&quot;, furHead: &quot;green&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,5,6,6,4,5],
	core: true,
	adjective: &quot;reptilian&quot;, /* technically lacertian would be better, but I think more people would recognise &quot;reptilian&quot; :p */
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;anacondaSpecies&quot;,	
	species: &quot;anaconda&quot;,
	angry: &quot;hiss&quot;,
	furBack: &quot;green-brown&quot;, furBelly: &quot;yellow&quot;, furHead: &quot;green-brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long, snaking tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;serpentine&quot;, 
	carnivore: true,
	speciesHeight: 78,
	speciesStats: [5,0,0,0,20,0],
})&gt;&gt;

/*=================*/
/*==== Other? =====*/
/*=================*/

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;rhino&quot;,	
	species: &quot;rhino&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 77,
	speciesStats: [11,0,6,2,6,20],
	core: true,
	adjective: &quot;rhinocerine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;hippo&quot;,	
	species: &quot;hippo&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;reddish brown&quot;, furBelly: &quot;brownish pink&quot;, 
	furHead: &quot;reddish brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 79,
	speciesStats: [10,0,5,2,8,30],
	core: true,
	adjective: &quot;hippopotamine&quot;,
	herbivore: true,
})&gt;&gt;


/* FIXES AND EDITS - Core additions */
&lt;&lt;run setup.registerSpecies({
	article: &quot;an&quot;,
	id: &quot;elephant&quot;,	
	species: &quot;elephant&quot;,
	angry: &quot;trumpet&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 82,
	speciesStats: [10,0,5,2,8,20],
	core: true,
	adjective: &quot;elephantine&quot;,
	herbivore: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;meerkat&quot;,	
	species: &quot;meerkat&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;grey-brown&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey-brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	core: true,
	adjective: &quot;suricate&quot;,
	speciesHeight: 63,
	speciesStats: [4,5,5,7,4,5],
})&gt;&gt;

&lt;&lt;run setup.registerSpecies({
	article: &quot;a&quot;,
	id: &quot;manticore&quot;,	
	species: &quot;manticore&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;golden&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;mane&quot;,
	tail: &quot;scorpion tail&quot;,
	teeth: &quot;fangs&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [6,5,1,3,10,4],
	core: true,
	adjective: &quot;feline&quot;,
	
	noRandom: true,
})&gt;&gt;

/* POST SETUP */
/* Running the random carnivore and herbivore functions will also populate the backwards compatible $herbivores and $carnivores arrays */
&lt;&lt;run setup.randomHerbivore()&gt;&gt;
&lt;&lt;run setup.randomCarnivore()&gt;&gt;

/* Meanwhile, this will populate the globals of species from the core species, like how they used to be formatted in the original game, so we can preserve some backwards compatibility. */
&lt;&lt;run setup.populateCoreGlobalSpecies()&gt;&gt;</tw-passagedata><tw-passagedata pid="492" name="Species Variables Backup" tags="" position="4000,425" size="100,100">/* FIXES AND EDITS - Added new elements to all species, as well as introduced missing Duck, Lizard, and Elephant */
/* (NOTE: Major changes are going to happen to the species system, so not sure how long this is going to last :p) */

/*Species*/

/*
Default template
&lt;&lt;set $ = {
	article: &quot;&quot;,
	id: &quot;&quot;,	
	species: &quot;&quot;,
	angry: &quot;&quot;,
	furBack: &quot;&quot;, furBelly: &quot;&quot;, furHead: &quot;&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;&quot;,
	tail: &quot;&quot;,
	teeth: &quot;&quot;,
	mouth: &quot;&quot;,
	fname: &quot;&quot;,
	mname: &quot;&quot;,
	speciesHeight: ,
	speciesStats: [,,,,,],
}&gt;&gt;
*/


/*=================*/
/*==== Aquatic ====*/
/*=================*/

&lt;&lt;set $dolphin = {
	article: &quot;a&quot;,
	id: &quot;dolphin&quot;,	
	species: &quot;dolphin&quot;,
	angry: &quot;click&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;light grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;fin&quot;, feet: &quot;fins&quot;,
	hand: &quot;fin&quot;, hands: &quot;fins&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;skin&quot;,
	tail: &quot;tail fin&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;&quot;,
	mname: &quot;&quot;,
	speciesHeight: 68,
	speciesStats: [4,7,4,7,3,3],
	adjective: &quot;delphine&quot;,
	core: true,
	aquatic: true,
}&gt;&gt;

&lt;&lt;set $orca = {
	article: &quot;an&quot;,
	id: &quot;orca&quot;,	
	species: &quot;orca&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;fin&quot;, feet: &quot;fins&quot;,
	hand: &quot;fin&quot;, hands: &quot;fins&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;skin&quot;,
	tail: &quot;tail fin&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 76,
	speciesStats: [7,5,4,2,7,15],
	core: true,
	adjective: &quot;orcin&quot;, /* don&#39;t know if that&#39;s true or not, but it sounds right :P */
	aquatic: true,
}&gt;&gt;

&lt;&lt;set $shark = {
	article: &quot;a&quot;,
	id: &quot;shark&quot;,	
	species: &quot;shark&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;dark grey&quot;, furBelly: &quot;light grey&quot;, 
	furHead: &quot;light grey&quot;,
	foot: &quot;fin&quot;, feet: &quot;fins&quot;,
	hand: &quot;fin&quot;, hands: &quot;fins&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;skin&quot;,
	tail: &quot;tail fin&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 72,
	speciesStats: [8,5,2,0,10,5],
	core: true,
	adjective: &quot;selachian&quot;,
	aquatic: true,
}&gt;&gt;

/*=================*/
/*===== Avian =====*/
/*=================*/

&lt;&lt;set $blueJay = {
	article: &quot;a&quot;,
	id: &quot;blueJay&quot;, /* FIXES AND EDITS - Fix ID */
	species: &quot;blue jay&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;white&quot;, furHead: &quot;blue&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 59,
	speciesStats: [3,9,6,7,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
}&gt;&gt;

&lt;&lt;set $hawk = {
	article: &quot;a&quot;,
	id: &quot;hawk&quot;,	
	species: &quot;hawk&quot;,
	angry: &quot;screech&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 64,
	speciesStats: [5,9,5,6,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	carnivore: true,
	flying: true,
}&gt;&gt;

&lt;&lt;set $owl = {
	article: &quot;an&quot;,
	id: &quot;owl&quot;,	
	species: &quot;owl&quot;,
	angry: &quot;hoot&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;white&quot;, furHead: &quot;grey&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 63,
	speciesStats: [5,6,5,9,0,2],
	core: true,
	adjective: &quot;avian&quot;,
	carnivore: true,
	flying: true,
}&gt;&gt;

&lt;&lt;set $penguin = {
	article: &quot;a&quot;,
	id: &quot;penguin&quot;,	
	species: &quot;penguin&quot;,
	angry: &quot;honk&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 66,
	speciesStats: [4,4,5,5,7,6],
	core: true,
	adjective: &quot;avian&quot;,
}&gt;&gt;

&lt;&lt;set $raven = {
	article: &quot;a&quot;,
	id: &quot;raven&quot;,	
	species: &quot;raven&quot;,
	angry: &quot;caw&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 61,
	speciesStats: [3,8,5,9,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
}&gt;&gt;

&lt;&lt;set $robin = {
	article: &quot;a&quot;,
	id: &quot;robin&quot;,	
	species: &quot;robin&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;red&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 61,
	speciesStats: [3,8,5,9,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
}&gt;&gt;

&lt;&lt;set $magpie = {
	article: &quot;a&quot;,
	id: &quot;magpie&quot;,	
	species: &quot;magpie&quot;,
	angry: &quot;chirp&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
	hair: &quot;headfeathers&quot;,
	tail: &quot;tailfeathers&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 58,
	speciesStats: [2,9,4,10,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
}&gt;&gt;

/* FIXES AND EDITS - There&#39;s a duck NPC but no duck species, so added in a duck for the sake of simplicity ;P */
&lt;&lt;set $duck = {
  article: &quot;a&quot;,
  id: &quot;duck&quot;,	
  species: &quot;duck&quot;,
  angry: &quot;quack&quot;,
  furBack: &quot;brown&quot;, furBelly: &quot;beige&quot;, furHead: &quot;brown&quot;,
  foot: &quot;webbed foot&quot;, feet: &quot;webbed feet&quot;,
  hand: &quot;wing&quot;, hands: &quot;wings&quot;,
  fur: &quot;feathers&quot;, furred: &quot;feathered&quot;, furry: &quot;feathery&quot;,
  hair: &quot;headfeathers&quot;,
  tail: &quot;tailfeathers&quot;,
  teeth: &quot;bill&quot;,
  mouth: &quot;bill&quot;,
  speciesHeight: 63,
  speciesStats: [4,6,8,7,0,0],
	core: true,
	adjective: &quot;avian&quot;,
	flying: true,
}&gt;&gt;

/*=================*/
/*==== Canines ====*/
/*=================*/

&lt;&lt;set $coyote = {
	article: &quot;a&quot;,
	id: &quot;coyote&quot;,	
	species: &quot;coyote&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;grey-brown&quot;, furBelly: &quot;light grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [2,5,6,7,5,3],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $dog = {
	article: &quot;a&quot;,
	id: &quot;dog&quot;,	
	species: &quot;dog&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [5,5,5,5,5,8],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $fox = {
	article: &quot;a&quot;,
	id: &quot;fox&quot;,	
	species: &quot;fox&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;white&quot;, furHead: &quot;red&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 60,
	speciesStats: [1,5,7,7,5,3],
	core: true,
	adjective: &quot;vulpine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $paintedDog = {
	article: &quot;a&quot;,
	id: &quot;paintedDog&quot;,	/* FIXES AND EDITS - Fix ID */
	species: &quot;painted dog&quot;,
	angry: &quot;bark&quot;,
	furBack: &quot;spotted&quot;, furBelly: &quot;spotted&quot;, furHead: &quot;spotted&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 66,
	speciesStats: [4,5,7,4,5,3],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $wolf = {
	article: &quot;a&quot;,
	id: &quot;wolf&quot;,	
	species: &quot;wolf&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [5,5,5,3,7,5],
	core: true,
	adjective: &quot;canine&quot;,
	carnivore: true,
}&gt;&gt;

/*=================*/
/*=== Dinosaurs ===*/
/*=================*/

&lt;&lt;set $raptor = {
	article: &quot;a&quot;,
	id: &quot;raptor&quot;,	
	species: &quot;raptor&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;dark green&quot;, furBelly: &quot;beige&quot;, furHead: &quot;dark green&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 70,
	speciesStats: [3,7,4,1,10,0],
	core: true,
	adjective: &quot;saurian&quot;, /* not actually the term but it sounds good */
	dinosaur: true,
}&gt;&gt;

&lt;&lt;set $pterodactyl = {
	article: &quot;a&quot;,
	id: &quot;pterodactyl&quot;,	
	species: &quot;pterodactyl&quot;,
	angry: &quot;screech&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;beige&quot;, furHead: &quot;green&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;wing&quot;, hands: &quot;wings&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 65,
	speciesStats: [3,9,6,5,2,4],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
	/* won&#39;t add flying label because I think dinos are intended to be restricted */
}&gt;&gt;

&lt;&lt;set $triceratops = {
	article: &quot;a&quot;,
	id: &quot;triceratops&quot;,	
	species: &quot;triceratops&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long powerful tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 75,
	speciesStats: [8,0,7,5,5,20],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
}&gt;&gt;

&lt;&lt;set $stegosaurus = {
	article: &quot;a&quot;,
	id: &quot;stegosaurus&quot;,	
	species: &quot;stegosaurus&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;beige&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;spiky tail&quot;,
	teeth: &quot;beak&quot;,
	mouth: &quot;beak&quot;,
	speciesHeight: 75,
	speciesStats: [6,0,7,7,5,20],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
}&gt;&gt;

&lt;&lt;set $apatosaurus = {
	article: &quot;an&quot;,
	id: &quot;apatosaurus&quot;,	
	species: &quot;apatosaurus&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;extremely long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 84,
	speciesStats: [7,0,7,6,5,20],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
}&gt;&gt;

&lt;&lt;set $tyrannosaurus = {
	article: &quot;a&quot;,
	id: &quot;tyrannosaurus&quot;,	
	species: &quot;tyrannosaurus&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;dark green&quot;, furBelly: &quot;beige&quot;, furHead: &quot;dark green&quot;,
	foot: &quot;claw&quot;, feet: &quot;claws&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;long powerful tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;mouth&quot;,
	speciesHeight: 78,
	speciesStats: [8,3,4,0,10,5],
	core: true,
	adjective: &quot;saurian&quot;,
	dinosaur: true,
}&gt;&gt;

/*=================*/
/*==== Dragons ====*/
/*=================*/

&lt;&lt;set $blackDragon = {
	article: &quot;a&quot;,
	id: &quot;blackDragon&quot;,	
	species: &quot;black dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;gold&quot;, furHead: &quot;black&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 74,
	speciesStats: [8,2,0,5,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
}&gt;&gt;

&lt;&lt;set $blueDragon = {
	article: &quot;a&quot;,
	id: &quot;blueDragon&quot;,	
	species: &quot;blue dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;blue&quot;, furBelly: &quot;gold&quot;, furHead: &quot;blue&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [5,0,2,8,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
}&gt;&gt;

&lt;&lt;set $greenDragon = {
	article: &quot;a&quot;,
	id: &quot;greenDragon&quot;,	
	species: &quot;green dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;gold&quot;, furHead: &quot;green&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 76,
	speciesStats: [10,2,1,2,10,10],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
}&gt;&gt;

&lt;&lt;set $redDragon = {
	article: &quot;a&quot;,
	id: &quot;redDragon&quot;,	
	species: &quot;red dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;red&quot;, furBelly: &quot;gold&quot;, furHead: &quot;red&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 73,
	speciesStats: [6,4,2,3,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
}&gt;&gt;

&lt;&lt;set $whiteDragon = {
	article: &quot;a&quot;,
	id: &quot;whiteDragon&quot;,	
	species: &quot;white dragon&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;gold&quot;, furHead: &quot;white&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;thick tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 74,
	speciesStats: [7,0,3,5,10,5],
	core: true,
	adjective: &quot;draconic&quot;,
	dragon: true,
	carnivore: true,
	flying: true,
}&gt;&gt;

/*=================*/
/*==== Feline =====*/
/*=================*/

&lt;&lt;set $lion = {
	article: &quot;a&quot;,
	id: &quot;lion&quot;,	
	species: &quot;lion&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;golden&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;mane&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;fangs&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;lioness&quot;,
	mname: &quot;lion&quot;,
	speciesHeight: 71,
	speciesStats: [5,5,5,0,10,4],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $catgirl = {
	article: &quot;a&quot;,
	id: &quot;catgirl&quot;,	
	species: &quot;catgirl&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;tan&quot;, furBelly: &quot;tan&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;furry&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	fname: &quot;woman&quot;,
	mname: &quot;man&quot;,
	speciesHeight: 71,
	speciesStats: [6,6,6,6,6,6],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $cheetah = {
	article: &quot;a&quot;,
	id: &quot;cheetah&quot;,	
	species: &quot;cheetah&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;spotted&quot;, furBelly: &quot;white&quot;, furHead: &quot;spotted&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 66,
	speciesStats: [0,10,5,0,10,0],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $cougar = {
	article: &quot;a&quot;,
	id: &quot;cougar&quot;,	
	species: &quot;cougar&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;gold&quot;, furBelly: &quot;white&quot;, furHead: &quot;gold&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long poofy tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 67,
	speciesStats: [4,6,5,3,7,3],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $leopard = {
	article: &quot;a&quot;,
	id: &quot;leopard&quot;,	
	species: &quot;leopard&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;rosetted&quot;, furBelly: &quot;black-white&quot;, 
	furHead: &quot;black-gold&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [4,6,5,3,7,3],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $panther = {
	article: &quot;a&quot;,
	id: &quot;panther&quot;,	
	species: &quot;panther&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 68,
	speciesStats: [4,6,5,3,7,3],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $tiger = {
	article: &quot;a&quot;,
	id: &quot;tiger&quot;,	
	species: &quot;tiger&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black and orange striped&quot;, 
	furBelly: &quot;white&quot;, furHead: &quot;striped&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 72,
	speciesStats: [5,5,5,0,10,4],
	core: true,
	adjective: &quot;feline&quot;,
	carnivore: true,
}&gt;&gt;

/*=================*/
/*==== Hooved =====*/
/*=================*/

&lt;&lt;set $cattle = {
	article: &quot;a&quot;,
	id: &quot;cattle&quot;,	/* FIXES AND EDITS - Fix ID */
	species: &quot;cow&quot;,
	angry: &quot;moo&quot;,
	furBack: &quot;black and white&quot;, furBelly: &quot;black and white&quot;, 
	furHead: &quot;black&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;cow&quot;,
	mname: &quot;bull&quot;,
	speciesHeight: 76,
	speciesStats: [8,0,7,5,5,25],
	core: true,
	adjective: &quot;bovine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $deer = {
	article: &quot;a&quot;,
	id: &quot;deer&quot;,	
	species: &quot;deer&quot;,
	angry: &quot;grunt&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;doe&quot;,
	mname: &quot;buck&quot;,
	speciesHeight: 67,
	speciesStats: [4,7,5,4,5,10],
	core: true,
	adjective: &quot;cervine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $donkey = {
	article: &quot;a&quot;,
	id: &quot;donkey&quot;,	
	species: &quot;donkey&quot;,
	angry: &quot;bray&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 70,
	speciesStats: [7,5,8,5,0,6],
	core: true,
	adjective: &quot;asinine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $goat = {
	article: &quot;a&quot;,
	id: &quot;goat&quot;,	
	species: &quot;goat&quot;,
	angry: &quot;bleat&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [6,2,7,5,5,15],
	core: true,
	adjective: &quot;caprine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $horse = {
	article: &quot;a&quot;,
	id: &quot;horse&quot;,	
	species: &quot;horse&quot;,
	angry: &quot;whinny&quot;,
	furBack: &quot;beige&quot;, furBelly: &quot;beige&quot;, furHead: &quot;beige&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	fname: &quot;mare&quot;,
	mname: &quot;stallion&quot;,
	speciesHeight: 76,
	speciesStats: [7,7,7,4,0,4],
	core: true,
	adjective: &quot;equine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $pig = {
	article: &quot;a&quot;,
	id: &quot;pig&quot;,	
	species: &quot;pig&quot;,
	angry: &quot;oink&quot;, /* FIXES AND EDITS - Pigs go oink */
	furBack: &quot;pink&quot;, furBelly: &quot;pink&quot;, furHead: &quot;pink&quot;,
	foot: &quot;hoof&quot;, feet: &quot;hooves&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;curly tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 67,
	speciesStats: [4,3,5,7,6,13],
	core: true,
	adjective: &quot;porcine&quot;,
	herbivore: true,
}&gt;&gt;

/*=================*/
/*=== Mustelid ====*/
/*=================*/

&lt;&lt;set $badger = {
	article: &quot;a&quot;,
	id: &quot;badger&quot;,	
	species: &quot;badger&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black and white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;poofy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 66,
	speciesStats: [6,4,5,5,5,10],
	core: true,
	adjective: &quot;musteline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $ferret = {
	article: &quot;a&quot;,
	id: &quot;ferret&quot;,	
	species: &quot;ferret&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 56,
	speciesStats: [3,9,5,8,0,0],
	core: true,
	adjective: &quot;musteline&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $greyKangaroo = {
	article: &quot;a&quot;,
	id: &quot;greyKangaroo&quot;,	
	species: &quot;grey kangaroo&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thick tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 65,
	speciesStats: [5,7,6,5,2,5],
	core: true,
	adjective: &quot;macropidine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $redKangaroo = {
	article: &quot;a&quot;,
	id: &quot;redKangaroo&quot;,	
	species: &quot;red kangaroo&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;russet&quot;, furBelly: &quot;beige&quot;, furHead: &quot;russet&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thick tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 72,
	speciesStats: [7,4,6,4,4,5],
	core: true,
	adjective: &quot;macropidine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $otter = {
	article: &quot;an&quot;,
	id: &quot;otter&quot;,	
	species: &quot;otter&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;dark brown&quot;, furBelly: &quot;light brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,7,6,8,0,5],
	core: true,
	adjective: &quot;lutrine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $raccoon = {
	article: &quot;a&quot;,
	id: &quot;raccoon&quot;,	
	species: &quot;raccoon&quot;,
	angry: &quot;hiss&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey striped&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;bushy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,5,4,8,4,8],
	core: true,
	adjective: &quot;procyonine&quot;,
}&gt;&gt;

&lt;&lt;set $skunk = {
	article: &quot;a&quot;,
	id: &quot;skunk&quot;,	
	species: &quot;skunk&quot;,
	angry: &quot;hiss&quot;,
	furBack: &quot;black and white&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;large fluffy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 62,
	speciesStats: [5,5,7,7,1,5],
	core: true,
	adjective: &quot;mephitine&quot;,
}&gt;&gt;

/*=================*/
/*==== Rodent =====*/
/*=================*/
/* &quot;rodentian&quot; is the general adjective for rodents, but I think &quot;rodent&quot; would probably pass */

&lt;&lt;set $mouse = {
	article: &quot;a&quot;,
	id: &quot;mouse&quot;,	
	species: &quot;mouse&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thin tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 58,
	speciesStats: [3,6,5,8,3,2],
	core: true,
	adjective: &quot;rodent&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $rabbit = {
	article: &quot;a&quot;,
	id: &quot;rabbit&quot;,	
	species: &quot;rabbit&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;grey-brown&quot;, furBelly: &quot;white&quot;, furHead: &quot;grey-brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;stubby tail&quot;,
	teeth: &quot;long teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,7,5,5,4,5],
	core: true,
	adjective: &quot;leporine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $rat = {
	article: &quot;a&quot;,
	id: &quot;rat&quot;,	
	species: &quot;rat&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long thin tail&quot;,
	teeth: &quot;long teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 65,
	speciesStats: [4,5,6,6,4,5],
	core: true,
	adjective: &quot;rodent&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $squirrel = {
	article: &quot;a&quot;,
	id: &quot;squirrel&quot;,	
	species: &quot;squirrel&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;white&quot;, furHead: &quot;grey&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;long bushy tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 59,
	speciesStats: [3,7,6,6,2,3],
	core: true,
	adjective: &quot;sciurine&quot;, /* okay, I know I said I prefer to stick to the generals, and &quot;rodent&quot; would work here, I just like the word &quot;sciurine&quot; :p */
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $bat = {
	article: &quot;a&quot;,
	id: &quot;bat&quot;,	
	species: &quot;bat&quot;,
	angry: &quot;squeak&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;stubby tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 64,
	speciesStats: [4,6,6,6,2,1],
	core: true,
	adjective: &quot;pteropine&quot;,
	flying: true,
}&gt;&gt;

/*=================*/
/*==== Ursine =====*/
/*=================*/

&lt;&lt;set $blackBear = {
	article: &quot;a&quot;,
	id: &quot;blackBear&quot;,	
	species: &quot;black bear&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;black&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 77,
	speciesStats: [8,0,5,0,12,20],
	core: true,
	adjective: &quot;ursine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $brownBear = {
	article: &quot;a&quot;,
	id: &quot;brownBear&quot;,	
	species: &quot;brown bear&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;brown&quot;, furBelly: &quot;brown&quot;, furHead: &quot;brown&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 76,
	speciesStats: [8,0,5,0,12,20],
	core: true,
	adjective: &quot;ursine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $panda = {
	article: &quot;a&quot;,
	id: &quot;panda&quot;,	
	species: &quot;panda&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;black&quot;, furBelly: &quot;white&quot;, furHead: &quot;black&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 75,
	speciesStats: [8,0,5,0,12,22],
	core: true,
	adjective: &quot;ursine&quot;,
}&gt;&gt;

&lt;&lt;set $polarBear = {
	article: &quot;a&quot;,
	id: &quot;polarBear&quot;,	
	species: &quot;polar bear&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;white&quot;, furBelly: &quot;white&quot;, furHead: &quot;white&quot;,
	foot: &quot;paw&quot;, feet: &quot;paws&quot;,
	hand: &quot;paw&quot;, hands: &quot;paws&quot;,
	fur: &quot;fur&quot;, furred: &quot;furred&quot;, furry: &quot;furry&quot;,
	hair: &quot;headfur&quot;,
	tail: &quot;short tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 78,
	speciesStats: [8,0,5,0,12,20],
	core: true,
	adjective: &quot;ursine&quot;,
}&gt;&gt;

/*=================*/
/*==== Other? =====*/
/*=================*/

&lt;&lt;set $human = {
	article: &quot;a&quot;,
	id: &quot;human&quot;,	
	species: &quot;human&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;tan&quot;, furBelly: &quot;tan&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;spine&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	fname: &quot;woman&quot;,
	mname: &quot;man&quot;,
	speciesHeight: 71,
	speciesStats: [6,6,6,6,6,6],
	core: true,
	adjective: &quot;human&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $woman = {
	article: &quot;a&quot;,
	id: &quot;woman&quot;,	
	species: &quot;woman&quot;,
	angry: &quot;yell&quot;,
	furBack: &quot;tan&quot;, furBelly: &quot;tan&quot;, furHead: &quot;brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;hair&quot;,
	tail: &quot;spine&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;mouth&quot;,
	fname: &quot;woman&quot;,
	mname: &quot;woman&quot;,
	speciesHeight: 71,
	speciesStats: [6,6,6,6,6,6],
	core: true,
	adjective: &quot;feminine&quot;,
	carnivore: true,
}&gt;&gt;

&lt;&lt;set $rhino = {
	article: &quot;a&quot;,
	id: &quot;rhino&quot;,	
	species: &quot;rhino&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 77,
	speciesStats: [11,0,6,2,6,20],
	core: true,
	adjective: &quot;rhinocerine&quot;,
	herbivore: true,
}&gt;&gt;

&lt;&lt;set $hippo = {
	article: &quot;a&quot;,
	id: &quot;hippo&quot;,	
	species: &quot;hippo&quot;,
	angry: &quot;growl&quot;,
	furBack: &quot;reddish brown&quot;, furBelly: &quot;brownish pink&quot;, 
	furHead: &quot;reddish brown&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 79,
	speciesStats: [10,0,5,2,8,30],
	core: true,
	adjective: &quot;hippopotamine&quot;,
	herbivore: true,
}&gt;&gt;

/* FIXES AND EDITS - There&#39;s a lizard NPC but no lizard species, so adding one for simplicity... even though &quot;Lizard&quot; is horribly generic */
&lt;&lt;set $lizard = {
	article: &quot;a&quot;,
	id: &quot;lizard&quot;,	
	species: &quot;lizard&quot;,
	angry: &quot;roar&quot;,
	furBack: &quot;green&quot;, furBelly: &quot;green&quot;, furHead: &quot;green&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;claw&quot;, hands: &quot;claws&quot;,
	fur: &quot;scales&quot;, furred: &quot;scaled&quot;, furry: &quot;scaly&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;sharp teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 63,
	speciesStats: [4,5,6,6,4,5],
	core: true,
	adjective: &quot;reptilian&quot;, /* technically lacertian would be better, but I think more people would recognise &quot;reptilian&quot; :p */
}&gt;&gt;

/* FIXES AND EDITS - Add elephant since missing */
&lt;&lt;set $elephant = {
	article: &quot;an&quot;,
	id: &quot;elephant&quot;,	
	species: &quot;elephant&quot;,
	angry: &quot;trumpet&quot;,
	furBack: &quot;grey&quot;, furBelly: &quot;grey&quot;, furHead: &quot;grey&quot;,
	foot: &quot;foot&quot;, feet: &quot;feet&quot;,
	hand: &quot;hand&quot;, hands: &quot;hands&quot;,
	fur: &quot;skin&quot;, furred: &quot;skinned&quot;, furry: &quot;skinned&quot;,
	hair: &quot;head&quot;,
	tail: &quot;tail&quot;,
	teeth: &quot;teeth&quot;,
	mouth: &quot;muzzle&quot;,
	speciesHeight: 82,
	speciesStats: [10,0,5,2,8,20],
	core: true,
	adjective: &quot;elephantine&quot;,
	herbivore: true,
}&gt;&gt;

/*=================*/
/*==== Groups ====*/
/*=================*/
&lt;&lt;set $herbivores = [$horse, $cattle, $deer, $goat, $donkey, $pig, $rabbit, $mouse, $squirrel, $rat, $greyKangaroo, $redKangaroo, $rhino, $hippo, $elephant]&gt;&gt;

&lt;&lt;set $carnivores = [$lion, $hawk, $owl, $coyote, $dog, $fox, $paintedDog, $wolf, $blackDragon, $blueDragon, $redDragon, $greenDragon, $whiteDragon, $cheetah, $cougar, $leopard, $lion, $panther, $tiger, $badger, $ferret, $otter, $blackBear, $brownBear]&gt;&gt;

&lt;&lt;if $speciesList == null&gt;&gt;
	&lt;&lt;set $speciesList = {}&gt;&gt; /* This is what&#39;s actually going to be holding the species info in the future */
&lt;&lt;/if&gt;&gt;

/* Aquatic */
&lt;&lt;set $speciesList.dolphin = $dolphin&gt;&gt;
&lt;&lt;set $speciesList.orca = $orca&gt;&gt;
&lt;&lt;set $speciesList.shark = $shark&gt;&gt;
/* Avian */
&lt;&lt;set $speciesList.blueJay = $blueJay&gt;&gt;
&lt;&lt;set $speciesList.hawk = $hawk&gt;&gt;
&lt;&lt;set $speciesList.owl = $owl&gt;&gt;
&lt;&lt;set $speciesList.penguin = $penguin&gt;&gt;
&lt;&lt;set $speciesList.raven = $raven&gt;&gt;
&lt;&lt;set $speciesList.robin = $robin&gt;&gt;
&lt;&lt;set $speciesList.magpie = $magpie&gt;&gt;
&lt;&lt;set $speciesList.duck = $duck&gt;&gt;
/* Canine */
&lt;&lt;set $speciesList.coyote = $coyote&gt;&gt;
&lt;&lt;set $speciesList.dog = $dog&gt;&gt;
&lt;&lt;set $speciesList.fox = $fox&gt;&gt;
&lt;&lt;set $speciesList.paintedDog = $paintedDog&gt;&gt;
&lt;&lt;set $speciesList.wolf = $wolf&gt;&gt;
/* Dinosaurs */
&lt;&lt;set $speciesList.raptor = $raptor&gt;&gt;
&lt;&lt;set $speciesList.pterodactyl = $pterodactyl&gt;&gt;
&lt;&lt;set $speciesList.triceratops = $triceratops&gt;&gt;
&lt;&lt;set $speciesList.stegosaurus = $stegosaurus&gt;&gt;
&lt;&lt;set $speciesList.apatosaurus = $apatosaurus&gt;&gt;
&lt;&lt;set $speciesList.tyrannosaurus = $tyrannosaurus&gt;&gt;
/* Dragons */
&lt;&lt;set $speciesList.blackDragon = $blackDragon&gt;&gt;
&lt;&lt;set $speciesList.blueDragon = $blueDragon&gt;&gt;
&lt;&lt;set $speciesList.greenDragon = $greenDragon&gt;&gt;
&lt;&lt;set $speciesList.redDragon = $redDragon&gt;&gt;
&lt;&lt;set $speciesList.whiteDragon = $whiteDragon&gt;&gt;
/* Feline */
&lt;&lt;set $speciesList.lion = $lion&gt;&gt;
&lt;&lt;set $speciesList.cheetah = $cheetah&gt;&gt;
&lt;&lt;set $speciesList.catgirl = $catgirl&gt;&gt;
&lt;&lt;set $speciesList.cougar = $cougar&gt;&gt;
&lt;&lt;set $speciesList.leopard = $leopard&gt;&gt;
&lt;&lt;set $speciesList.panther = $panther&gt;&gt;
&lt;&lt;set $speciesList.tiger = $tiger&gt;&gt;
/* Hooved */
&lt;&lt;set $speciesList.cattle = $cattle&gt;&gt;
&lt;&lt;set $speciesList.deer = $deer&gt;&gt;
&lt;&lt;set $speciesList.donkey = $donkey&gt;&gt;
&lt;&lt;set $speciesList.goat = $goat&gt;&gt;
&lt;&lt;set $speciesList.horse = $horse&gt;&gt;
&lt;&lt;set $speciesList.pig = $pig&gt;&gt;
/* Mustelid */
&lt;&lt;set $speciesList.badger = $badger&gt;&gt;
&lt;&lt;set $speciesList.ferret = $ferret&gt;&gt;
&lt;&lt;set $speciesList.greyKangaroo = $greyKangaroo&gt;&gt;
&lt;&lt;set $speciesList.redKangaroo = $redKangaroo&gt;&gt;
&lt;&lt;set $speciesList.otter = $otter&gt;&gt;
&lt;&lt;set $speciesList.raccoon = $raccoon&gt;&gt;
&lt;&lt;set $speciesList.skunk = $skunk&gt;&gt;
/* Rodent */
&lt;&lt;set $speciesList.mouse = $mouse&gt;&gt;
&lt;&lt;set $speciesList.rabbit = $rabbit&gt;&gt;
&lt;&lt;set $speciesList.rat = $rat&gt;&gt;
&lt;&lt;set $speciesList.squirrel = $squirrel&gt;&gt;
&lt;&lt;set $speciesList.bat = $bat&gt;&gt;
/* Ursine */
&lt;&lt;set $speciesList.blackBear = $blackBear&gt;&gt;
&lt;&lt;set $speciesList.brownBear = $brownBear&gt;&gt;
&lt;&lt;set $speciesList.panda = $panda&gt;&gt;
&lt;&lt;set $speciesList.polarBear = $polarBear&gt;&gt;
/* Other */
&lt;&lt;set $speciesList.human = $human&gt;&gt;
&lt;&lt;set $speciesList.woman = $woman&gt;&gt;
&lt;&lt;set $speciesList.rhino = $rhino&gt;&gt;
&lt;&lt;set $speciesList.hippo = $hippo&gt;&gt;
&lt;&lt;set $speciesList.lizard = $lizard&gt;&gt;
&lt;&lt;set $speciesList.elephant = $elephant&gt;&gt;</tw-passagedata><tw-passagedata pid="493" name="Background Image" tags="nobr" position="2950,50" size="100,100">&lt;&lt;if tags().includes(&#39;city&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/cityDay.png&quot;&gt;&gt;

&lt;&lt;elseif tags().includes(&#39;forest&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/forestDay.png&quot;&gt;&gt;

&lt;&lt;elseif tags().includes(&#39;grasslands&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/grasslandsDay.png&quot;&gt;&gt;

&lt;&lt;elseif tags().includes(&#39;jungle&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/forestDay.png&quot;&gt;&gt;

&lt;&lt;elseif tags().includes(&#39;hills&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/hillsDay.png&quot;&gt;&gt;

&lt;&lt;elseif tags().includes(&#39;mountains&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/mountainsDay.png&quot;&gt;&gt;

&lt;&lt;elseif tags().includes(&#39;beach&#39;)&gt;&gt;
&lt;&lt;set $background = &quot;images/beachDay.png&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===Updates background image===*/
&lt;&lt;if $background.contains(&quot;Day.png&quot;) and $daytime == &quot;night&quot;&gt;&gt;
	&lt;&lt;set $background = $background.replace(&quot;Day&quot;, &quot;Night&quot;)&gt;&gt;
&lt;&lt;elseif $background.contains(&quot;Night.png&quot;) and $daytime == &quot;day&quot;&gt;&gt;
	&lt;&lt;set $background = $background.replace(&quot;Night&quot;, &quot;Day&quot;)&gt;&gt;
&lt;&lt;/if&gt;&gt;


&lt;span id=&quot;background&quot; alt=&quot;background&quot;&gt;
	[img[$background]]
&lt;/span&gt;</tw-passagedata><tw-passagedata pid="494" name="Begin your journey" tags="intro" position="2450,975" size="100,100">And then... you wake up...

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Your House&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Scrubs species description*/
&lt;&lt;set $p.article = $p.article.toLowerCase()&gt;&gt;
&lt;&lt;set $p.species = $p.species.toLowerCase()&gt;&gt;
&lt;&lt;set $p.angry = $p.angry.toLowerCase()&gt;&gt;
&lt;&lt;set $p.feet = $p.feet.toLowerCase()&gt;&gt;
&lt;&lt;set $p.foot = $p.foot.toLowerCase()&gt;&gt;
&lt;&lt;set $p.hands = $p.hands.toLowerCase()&gt;&gt;
&lt;&lt;set $p.hand = $p.hand.toLowerCase()&gt;&gt;
&lt;&lt;set $p.fur = $p.fur.toLowerCase()&gt;&gt;
&lt;&lt;set $p.furred = $p.furred.toLowerCase()&gt;&gt;
&lt;&lt;set $p.furry = $p.furry.toLowerCase()&gt;&gt;
&lt;&lt;set $p.furBack = $p.furBack.toLowerCase()&gt;&gt;
&lt;&lt;set $p.furBelly = $p.furBelly.toLowerCase()&gt;&gt;
&lt;&lt;set $p.furHead = $p.furHead.toLowerCase()&gt;&gt;
&lt;&lt;set $p.hair = $p.hair.toLowerCase()&gt;&gt;
&lt;&lt;set $p.teeth = $p.teeth.toLowerCase()&gt;&gt;
&lt;&lt;set $p.mouth = $p.mouth.toLowerCase()&gt;&gt;
&lt;&lt;set $p.tail = $p.tail.toLowerCase()&gt;&gt;

/* FIXES AND EDITS - Add adjective info */
&lt;&lt;set $p.adjective = $p.adjective.toLowerCase()&gt;&gt;
&lt;&lt;set $p.Adjective = $p.adjective.toUpperFirst()&gt;&gt;

&lt;&lt;set $p.Article = $p.article.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Species = $p.species.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Angry = $p.angry.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Feet = $p.feet.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Foot = $p.foot.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Hands = $p.hands.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Hand = $p.hand.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Fur = $p.fur.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Furred = $p.furred.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Furry = $p.furry.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.FurBack = $p.furBack.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.FurBelly = $p.furBelly.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.FurHead = $p.furHead.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Hair = $p.hair.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Teeth = $p.teeth.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Mouth = $p.mouth.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Tail = $p.tail.toUpperFirst()&gt;&gt;

&lt;&lt;set $firstTimeSwamp = true&gt;&gt;</tw-passagedata><tw-passagedata pid="495" name="BottomBar" tags="" position="2825,800" size="200,100">$status.description
&lt;br&gt;

[ Level- $lvl ] 
[ Experience- $xp/$xpToLvl ] 
[ Gold- $gld ] 
&lt;br&gt;

&lt;&lt;set _weight = Math.round(setup.weight())&gt;&gt;
[ Weight- &lt;&lt;sayWeight _weight&gt;&gt; ] 
[ Fatness- &lt;&lt;print Math.round($fat + $tfat)&gt;&gt; ] 

&lt;&lt;set _waist = Math.round(setup.waistDiameter())&gt;&gt;
[ Waist Diameter- &lt;&lt;sayDistance _waist&gt;&gt; ]</tw-passagedata><tw-passagedata pid="496" name="Character Description" tags="" position="3400,600" size="100,100">&lt;&lt;updateStats&gt;&gt;

&lt;&lt;set $bodyFatTier = &quot;&quot;&gt;&gt;
&lt;&lt;set $strengthTier = &quot;&quot;&gt;&gt;
&lt;&lt;set _fatness = $fat + $tfat&gt;&gt;

&lt;&lt;if _fatness &lt;= 25&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;malnourished&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 75&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;healthy&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 150&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;robust&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 250&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;overweight&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 400&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;chubby&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 600&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;corpulent&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 900&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;obese&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 1300&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;morbidly obese&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 1800&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;massive&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 2300&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;spherical&quot;&gt;&gt;
&lt;&lt;elseif _fatness &lt;= 3000&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;mountainous&quot;&gt;&gt;
&lt;&lt;elseif _fatness &gt; 3000&gt;&gt;&lt;&lt;set $bodyFatTier = &quot;colossal&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _strTier = ($str + $str + $agi + $end)/4&gt;&gt;
&lt;&lt;if _strTier &lt;= 50&gt;&gt;&lt;&lt;set $strengthTier = &quot;regular&quot;&gt;&gt;
&lt;&lt;elseif _strTier &lt;= 150&gt;&gt;&lt;&lt;set $strengthTier = &quot;athletic&quot;&gt;&gt;
&lt;&lt;elseif _strTier &lt;= 250&gt;&gt;&lt;&lt;set $strengthTier = &quot;muscular&quot;&gt;&gt;
&lt;&lt;elseif _strTier &gt; 250&gt;&gt;&lt;&lt;set $strengthTier = &quot;bodybuilder&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Long character description*/
&lt;&lt;if $options.longDescription&gt;&gt;
	&lt;p&gt;&lt;&lt;include &quot;describe general&quot;&gt;&gt;
	&lt;&lt;include &quot;describe shoulders&quot;&gt;&gt;
	&lt;&lt;include &quot;describe upper&quot;&gt;&gt;
	&lt;&lt;include &quot;describe lower&quot;&gt;&gt;
	&lt;&lt;include &quot;describe legs&quot;&gt;&gt;&lt;/p&gt;
	
/*Short player description*/
&lt;&lt;else&gt;&gt;
	&lt;p&gt;You have $muscles muscles under your $fatness body and have $p.furBack colored $p.fur. &lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;Your $p.furBelly $p.furred stomach is $waist and sticks out &lt;&lt;set _waist = Math.round(setup.waistDiameter())&gt;&gt;&lt;&lt;sayDistance _waist&gt;&gt; and you are $hungry. &lt;/p&gt;</tw-passagedata><tw-passagedata pid="497" name="Combat" tags="" position="4175,200" size="100,100">&lt;&lt;enemyAction &quot;description&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;combat script&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="498" name="Combat Spells" tags="" position="1025,300" size="100,100">/* FIXES AND EDITS - Implement recent cast spell */
&lt;&lt;if $lastCombatSpellCast&gt;&gt;
	&lt;&lt;printSpellbookOption $lastCombatSpellCast true&gt;&gt;
    &lt;hr&gt;
&lt;&lt;/if&gt;&gt;
/* Clean cancelled configs of previous spells */
&lt;&lt;set $spellConfig = {}&gt;&gt;

/* FIXES AND EDITS - Hackily edited to work with new spell format */
&lt;&lt;for _i = 0; _i &lt; $spells.length; _i++&gt;&gt;
&lt;&lt;set _spell =  setup.getSpell($spells[_i])&gt;&gt;
&lt;&lt;set _available = setup.spellIsAvailable(_spell).result&gt;&gt;

&lt;&lt;capture _i, _spell, _available&gt;&gt;
	/* Skip displaying spells from disabled mods */
    &lt;&lt;if _spell.option and variables()[_spell.option] == false&gt;&gt;
    	&lt;&lt;continue&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    
    /* Skip if shouldn&#39;t be available in this context */
    &lt;&lt;if _available == false&gt;&gt;
    	&lt;&lt;continue&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    
	&lt;&lt;printSpellbookOption _spell true&gt;&gt;
&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="499" name="Credits" tags="" position="3075,825" size="100,100">Artwork for Interface/Background/Enemies by Sugarboy &lt;br&gt;
Mad Milk Machine sprite by Kelvin the Lion&lt;br&gt;
Button icons by Forbic and Trollololol &lt;br&gt;
Coding by Noone &lt;br&gt;
Some of the writing by Noone &lt;br&gt;
&lt;hr&gt;
Other writing/ideas by: &lt;br&gt;
Rossmallo &lt;br&gt;
Bruyaglovae &lt;br&gt;
Daioni &lt;br&gt;
Trollololol&lt;br&gt;
Werestritchy&lt;br&gt;
Peameal&lt;br&gt;
Krishonk&lt;br&gt;
Someoneoutthere&lt;br&gt;
The_Wind_King&lt;br&gt;
My many anonymous contributors</tw-passagedata><tw-passagedata pid="500" name="Edit gender" tags="intro" position="2700,850" size="100,100">&lt;&lt;set $p.male = $gender.male&gt;&gt;
&lt;&lt;set $p.he = $gender.he&gt;&gt;
&lt;&lt;set $p.him = $gender.him&gt;&gt;
&lt;&lt;set $p.his = $gender.his&gt;&gt;
&lt;&lt;set $p.himself = $gender.himself&gt;&gt;
&lt;&lt;set $p.man = $gender.man&gt;&gt;
&lt;&lt;set $p.boy = $gender.boy&gt;&gt;
&lt;&lt;set $p.sir = $gender.sir&gt;&gt;
&lt;&lt;set $p.mister = $gender.mister&gt;&gt;
&lt;&lt;set $p.guy = $gender.guy&gt;&gt;
&lt;&lt;set $p.brother = $gender.brother&gt;&gt;
&lt;&lt;set $p.fella = $gender.fella&gt;&gt;
&lt;&lt;set $p.buddy = $gender.buddy&gt;&gt;
&lt;&lt;set $p.gentleman = $gender.gentleman&gt;&gt;
&lt;&lt;set $p.lad = $gender.lad&gt;&gt;
&lt;&lt;set $p.laddie = $gender.laddie&gt;&gt;
&lt;&lt;set $p.sport = $gender.sport&gt;&gt;

You can edit your descriptions below or leave them as is. 

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Select Species&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;hr&gt;

Title (Male/Female):
&lt;&lt;textbox &quot;$p.male&quot; $gender.male&gt;&gt;
&lt;br&gt;Subjective (He/She):
&lt;&lt;textbox &quot;$p.he&quot; $gender.he&gt;&gt;
&lt;br&gt;Objective (Him/Her):
&lt;&lt;textbox &quot;$p.him&quot; $gender.him&gt;&gt;
&lt;br&gt;Possessive (His/Her):
&lt;&lt;textbox &quot;$p.his&quot; $gender.his&gt;&gt;
&lt;br&gt;Reflexive (Himself/Herself):
&lt;&lt;textbox &quot;$p.himself&quot; $gender.himself&gt;&gt;
&lt;br&gt;Title (Man/Woman):
&lt;&lt;textbox &quot;$p.man&quot; $gender.man&gt;&gt;
&lt;br&gt;Diminuitive title (Boy/Girl):
&lt;&lt;textbox &quot;$p.boy&quot; $gender.boy&gt;&gt;
&lt;br&gt;Familial title (Brother/Sister):
&lt;&lt;textbox &quot;$p.brother&quot; $gender.brother&gt;&gt;
&lt;br&gt;Honorific (Sir/Ma&#39;am):
&lt;&lt;textbox &quot;$p.sir&quot; $gender.sir&gt;&gt;
&lt;br&gt;Formal honorific (Gentleman/Gentlewoman):
&lt;&lt;textbox &quot;$p.gentleman&quot; $gender.gentleman&gt;&gt;
&lt;br&gt;The other kind of honorific? (Mister/Miss):
&lt;&lt;textbox &quot;$p.mister&quot; $gender.mister&gt;&gt;
&lt;br&gt;Regional honorific (Lad/Lass):
&lt;&lt;textbox &quot;$p.lad&quot; $gender.lad&gt;&gt;
&lt;br&gt;Longer regional honorific (Laddie/Lassie):
&lt;&lt;textbox &quot;$p.laddie&quot; $gender.laddie&gt;&gt;
&lt;br&gt;Folksy honoric (Fella/Missy):
&lt;&lt;textbox &quot;$p.fella&quot; $gender.fella&gt;&gt;
&lt;br&gt;Slightly too familiar honorific (Buddy/Pal):
&lt;&lt;textbox &quot;$p.buddy&quot; $gender.buddy&gt;&gt;
&lt;br&gt;Slightly disrepectful honorific (Guy/Lady):
&lt;&lt;textbox &quot;$p.guy&quot; $gender.guy&gt;&gt;
&lt;br&gt;Slightly demeaning but well intentioned honorific (Sport/Champ/Slugger/Dork):
&lt;&lt;textbox &quot;$p.sport&quot; $gender.sport&gt;&gt;</tw-passagedata><tw-passagedata pid="501" name="Edit species" tags="intro" position="2575,975" size="100,100">/* FIXES AND EDITS - This passage is no longer used! */

&lt;&lt;set $p.article = $species.article&gt;&gt;
&lt;&lt;set $p.species = $species.species&gt;&gt;
&lt;&lt;set $p.height = $species.speciesHeight&gt;&gt;
&lt;&lt;set $p.bheight = $species.speciesHeight&gt;&gt;

&lt;&lt;if $species.mname != &quot;&quot; and $species.mname != null&gt;&gt;
	&lt;&lt;set $p.mname = $species.mname&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $p.mname = $species.species&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $species.fname != &quot;&quot; and $species.fname != null&gt;&gt;
	&lt;&lt;set $p.fname = $species.fname&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $p.fname = $species.species&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $p.male == &quot;male&quot;&gt;&gt;&lt;&lt;set $p.species = $p.mname&gt;&gt;
&lt;&lt;elseif $p.male == &quot;female&quot;&gt;&gt;&lt;&lt;set $p.species = $p.fname&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;set $p.species = $p.species&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $p.angry = $species.angry&gt;&gt;
&lt;&lt;set $p.feet = $species.feet&gt;&gt;
&lt;&lt;set $p.foot = $species.foot&gt;&gt;
&lt;&lt;set $p.hands = $species.hands&gt;&gt;
&lt;&lt;set $p.hand = $species.hand&gt;&gt;
&lt;&lt;set $p.fur = $species.fur&gt;&gt;
&lt;&lt;set $p.furred = $species.furred&gt;&gt;
&lt;&lt;set $p.furry = $species.furry&gt;&gt;
&lt;&lt;set $p.furBack = $species.furBack&gt;&gt;
&lt;&lt;set $p.furBelly = $species.furBelly&gt;&gt;
&lt;&lt;set $p.furHead = $species.furHead&gt;&gt;
&lt;&lt;set $p.hair = $species.hair&gt;&gt;
&lt;&lt;set $p.teeth = $species.teeth&gt;&gt;
&lt;&lt;set $p.mouth = $species.mouth&gt;&gt;
&lt;&lt;set $p.tail = $species.tail&gt;&gt;
&lt;&lt;set $p.speciesHeight = $species.speciesHeight&gt;&gt;
&lt;&lt;set $p.height = $species.speciesHeight&gt;&gt;
&lt;&lt;set $p.speciesStats = $species.speciesStats&gt;&gt;

/* FIXES AND EDITS - Add adjective info */
&lt;&lt;set $p.adjective = $species.adjective&gt;&gt;

&lt;&lt;changeStats &quot;str&quot; $p.speciesStats[0]&gt;&gt;
&lt;&lt;changeStats &quot;agi&quot; $p.speciesStats[1]&gt;&gt;
&lt;&lt;changeStats &quot;end&quot; $p.speciesStats[2]&gt;&gt;
&lt;&lt;changeStats &quot;int&quot; $p.speciesStats[3]&gt;&gt;
&lt;&lt;changeStats &quot;sto&quot; $p.speciesStats[4]&gt;&gt;
&lt;&lt;changeStats &quot;fat&quot; $p.speciesStats[5]&gt;&gt;
&lt;li&gt;Height &lt;&lt;sayDistance $p.height&gt;&gt;&lt;/li&gt;

You can use the text boxes below to change your descriptions. Or just leave them as is. 
&lt;hr&gt;

What you are: &lt;br&gt;
&lt;&lt;textbox &quot;$p.article&quot; $p.article&gt;&gt;
&lt;&lt;textbox &quot;$p.species&quot; $p.species&gt;&gt;

&lt;br&gt;Masculine name of your species (if there&#39;s a difference):  &lt;br&gt;
&lt;&lt;textbox &quot;$p.mname&quot; $p.mname&gt;&gt;

&lt;br&gt;Feminine name of your species (if there&#39;s a difference):  &lt;br&gt;
&lt;&lt;textbox &quot;$p.fname&quot; $p.fname&gt;&gt;

/* FIXES AND EDITS - Add adjective info */
&lt;br&gt;Adjective to describe your species (like &quot;feline&quot;):  &lt;br&gt;
&lt;&lt;textbox &quot;$p.adjective&quot; $p.adjective&gt;&gt;

&lt;br&gt;How you yell:&lt;br&gt;
&lt;&lt;textbox &quot;$p.angry&quot; $p.angry&gt;&gt;

&lt;br&gt;The things you walk around on (singular/plural):&lt;br&gt;
&lt;&lt;textbox &quot;$p.foot&quot; $p.foot&gt;&gt;
&lt;&lt;textbox &quot;$p.feet&quot; $p.feet&gt;&gt;

&lt;br&gt;The things you grab stuff with (singular/plural):&lt;br&gt;
&lt;&lt;textbox &quot;$p.hand&quot; $p.hand&gt;&gt;
&lt;&lt;textbox &quot;$p.hands&quot; $p.hands&gt;&gt;

&lt;br&gt;The stuff you&#39;re covered in (different adjective forms):&lt;br&gt;
&lt;&lt;textbox &quot;$p.fur&quot; $p.fur&gt;&gt;
&lt;&lt;textbox &quot;$p.furred&quot; $p.furred&gt;&gt;
&lt;&lt;textbox &quot;$p.furry&quot; $p.furry&gt;&gt;

&lt;br&gt;The color of your back:&lt;br&gt;
&lt;&lt;textbox &quot;$p.furBack&quot; $p.furBack&gt;&gt;

&lt;br&gt;The color of your belly:&lt;br&gt;
&lt;&lt;textbox &quot;$p.furBelly&quot; $p.furBelly&gt;&gt;

&lt;br&gt;The color of your head:&lt;br&gt;
&lt;&lt;textbox &quot;$p.furHead&quot; $p.furHead&gt;&gt;

&lt;br&gt;The stuff you&#39;ve got on top of your head:&lt;br&gt;
&lt;&lt;textbox &quot;$p.hair&quot; $p.hair&gt;&gt;

&lt;br&gt;The thing you use to talk:&lt;br&gt;
&lt;&lt;textbox &quot;$p.mouth&quot; $p.mouth&gt;&gt;

&lt;br&gt;What you chew stuff with:&lt;br&gt;
&lt;&lt;textbox &quot;$p.teeth&quot; $p.teeth&gt;&gt;

&lt;br&gt;What kind of tail you may or may not have:&lt;br&gt;
&lt;&lt;textbox &quot;$p.tail&quot; $p.tail&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Done&quot; &quot;Begin your journey&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="502" name="Effect items" tags="" position="1575,575" size="100,100">__&#39;&#39;$itemUsed.Name&#39;&#39;__&lt;br&gt;
$itemUsed.description
&lt;hr&gt;

[&lt;&lt;popup &quot;Use&quot; &quot;use&quot;&gt;&gt;]&lt;br&gt;
[&lt;&lt;popup &quot;Back&quot; &quot;Inventory&quot;&gt;&gt;]</tw-passagedata><tw-passagedata pid="503" name="Enemy Image" tags="nobr" position="3075,50" size="100,100">&lt;span id=&quot;enemyPortrait&quot;&gt;

&lt;&lt;if $inCombat&gt;&gt;	

/*Set&#39;s image based on enemy variable*/
&lt;&lt;if $e.image != &quot;&quot; and $e.image != null&gt;&gt;
	&lt;&lt;set _enemyPortrait = &quot;images/&quot; + $e.image + &quot;.png&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _enemyPortrait = &quot;images/defaultEnemy.png&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Displays the image*/
[img[_enemyPortrait]]

&lt;&lt;/if&gt;&gt;

&lt;/span&gt;</tw-passagedata><tw-passagedata pid="504" name="Equipment" tags="nobr" position="1575,475" size="100,100">__&#39;&#39;$itemUsed.Name&#39;&#39;__&lt;br&gt;

&lt;&lt;if $itemUsed.popped&gt;&gt;$itemUsed.poppedDescription
&lt;&lt;else&gt;&gt;$itemUsed.description
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.damage &gt; 0&gt;&gt;
&lt;&lt;set _damage = $itemUsed.damage+&quot;d&quot;+$itemUsed.range&gt;&gt;
&lt;&lt;set _scaling = ($itemUsed.scaling*100)+&quot;% &quot;+$itemUsed.stat&gt;&gt;
&lt;br&gt;Deals _damage +_scaling $itemUsed.damageType damage. 
&lt;&lt;/if&gt;&gt;
/* FIXES AND EDITS - Readd weapon effect procs */
&lt;&lt;if $itemUsed.proc&gt;&gt;
	&lt;&lt;switch $itemUsed.proc&gt;&gt;
		&lt;&lt;case &quot;stun&quot;&gt;&gt;
			&lt;br&gt;Has a $itemUsed.procChance% chance to stun your enemy for $itemUsed.procPower turns when you deal damage with this weapon.
		&lt;&lt;case &quot;drain&quot;&gt;&gt;
			&lt;br&gt;Has a $itemUsed.procChance% chance to restore &lt;&lt;=Math.round($itemUsed.procPower)&gt;&gt;% of the damage dealt by this weapon as health.
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.defense &gt; 0&gt;&gt;
&lt;br&gt;Increases defense by $itemUsed.defense. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.size &gt; 0&gt;&gt;
&lt;br&gt;Size $itemUsed.size. 
&lt;&lt;/if&gt;&gt;


&lt;hr&gt;
[&lt;&lt;popup &quot;Equip&quot; &quot;equip&quot;&gt;&gt;]&lt;br&gt;
[&lt;&lt;popup &quot;Back&quot; &quot;Inventory&quot;&gt;&gt;]</tw-passagedata><tw-passagedata pid="505" name="Food" tags="nobr" position="1575,375" size="100,100">__&#39;&#39;$itemUsed.Name&#39;&#39;__&lt;br&gt;
$itemUsed.description
&lt;hr&gt;
/* FIXES AND EDITS - Allow consuming any amount of food */
&lt;&lt;set $consumeAmount = 1&gt;&gt;
[&lt;&lt;popup &quot;Consume&quot; &quot;eat x&quot;&gt;&gt; x &lt;&lt;numberbox &quot;$consumeAmount&quot; 1&gt;&gt; ]&lt;br&gt;
/*
[&lt;&lt;popup &quot;Consume&quot; &quot;eat&quot;&gt;&gt;]&lt;br&gt;
&lt;&lt;if $itemUsed.stack &gt;= 10&gt;&gt;[&lt;&lt;popup &quot;Consume 10&quot; &quot;eat 10&quot;&gt;&gt;]&lt;br&gt;&lt;&lt;/if&gt;&gt;
*/
[&lt;&lt;popup &quot;Back&quot; &quot;Inventory&quot;&gt;&gt;]</tw-passagedata><tw-passagedata pid="506" name="Info" tags="" position="3075,450" size="100,100">&#39;&#39;This twine version&#39;&#39;
&lt;hr&gt;
I hope this all works? Editing is a work in progress though

&#39;&#39;Buttons&#39;&#39;
&lt;hr&gt;
Stats describes your appearance, equipment, quests, and any important status effects. 
Surroundings gives you a description of your surroundings. 
Inventory brings up your inventory. 
Rest lets you rest for an hour. Regaining health and stamina and giving you a chance to digest. 
Spells brings up a list of your spells. 

The 12 buttons to the right are the choices your character can make. Usually referring to which direction you want to go. 

Near the center of the screen there&#39;s a few more buttons. 
Info brings up this dialogue. 
Options beings up the options menu. 
Load allows you to load a previous save. 

&#39;&#39;Stats&#39;&#39;
&lt;hr&gt;
Strength affects how much time/stamina it costs to travel somewhere. 
Agility affects who goes first in combat as well as increasing your odds to dodge/escape during combat. It also reduces the time it takes to travel somewhere. 
Endurance affects how quickly you lose stamina, as well as how quickly you regain health from resting. It also affects how much your maximum HP increases when you level up. 
Intelligence affects your chance to dodge/escape from your opponent as well as allowing you to go first in combat. It also affects your maximum mana and which spells you can learn. 
Intelligence/Strength/Agility each affect the damage scaling on different weapons based on the type of weapon. Each stat also has an affect on special events where it&#39;s applicable. 
Your secondary stats are: 
Health, which you need to keep above 0 to stay alive. 
Stamina, which you need to keep above 0 to be able to travel. 
Mana, which you spend to cast spells you&#39;ve learned. 
Fullness, which represents how much you can safely consume. 

&#39;&#39;Food&#39;&#39;
&lt;hr&gt;
Eating stuff obviously fills your stomach, and it usually gives you calories which turn into fat over time. 
If you eat over 100% of your stomach&#39;s regular capacity, your maximum health will be temporarily reduced based on how overstuffed you are. However being over 100% full will also stretch your stomach out over time, increasing your stomach capacity. 
If you get to 130% of your stomach&#39;s capacity then your maximum health is reduced to 0, ostensibly causing you to &quot;explode&quot; or at least pass out, based on your interpretation. So try to not to stuff yourself into unconsiousness, unless you feel like it of course. 

&#39;&#39;Exploration&#39;&#39;
&lt;hr&gt;
Outside of the safety of the city there are three wilderness areas; the forest, the hills, and the plains. In these areas you can randomly encounter various random enemies as well as finding special events and items. Ostensibly, the forest has the easiest enemies, followed by the plains, which is followed by the hills which has the hardest enemies of those 3 areas. There is also a small town to the west that leads to a beach area where you can also find random enemies/items/events as well as being home to the mage&#39;s guild. 

&#39;&#39;Specific locations&#39;&#39;
&lt;hr&gt;
Your house: You can save and load games from your bedroom inside your house. You can also sleep there, which just lets you rest for 8 hours. There is also your storage chest where you can store and receive items as well as gold. 
Restaurants: Eating at a restaurant confers a small temporary bonus to your stats. 
Training grounds: Training grounds allow you to burn fat and convert it into Strength/Agility as well as endurance. 
Stores: Any location with a store icon has some amount/type of items to sell. You can also sell things to most vendors. 
Hospital/Church: This is where you end up after being defeated. 
Mage&#39;s guild: In the town on the west side of the world there is a mage&#39;s guild where you can learn spells as well as train up your intelligence at the cost of fat. 

&#39;&#39;Combat&#39;&#39;
&lt;hr&gt;
Defeating enemies gains you xp which allow you to level up. When you level up, you can increase one of your stats as well as automatically healing you and increasing your max health. You can also often find gold and sometimes find items dropped by defeated enemies. 
During combat you have several actions you can take: 
Attack causes you to attack your enemy with your equipped weapon. 
Item let&#39;s you use an item from your inventory. 
Run allows you to attempt to run away from combat. 
Spells allows you to cast known spells at the cost of mana. 
Wait allows your enemy to get a free attack in on you, but regains some of your stamina. 
Submit allows you to surrender to your enemy and suffer whatever consequences that entails. 
Devour allows you to attempt to devour your enemy if your stomach capacity is high enough and you can overpower/outwit/outmaneuver your opponent. Be wary though, it only means you could successfully eat the foe on an empty stomach. Depending on how full you already are, eating an enemy may push you over your limit and actually cause you to lose the fight. It is also worth noting that devouring an enemy prevents you from picking up any items they may have otherwise dropped. 
Struggle causes you to fight against your opponent once they have grappled you. Whichever stat is highest between Strength/Agility/Intelligence is used against your opponents grapple until you finally break free. 

&#39;&#39;Status effects&#39;&#39;
&lt;hr&gt;
There are various status effects that you and your enemy can be subjected to. Namely: 
Stunned characters have a 1/3 chance of their action in combat not happening. 
Burned characters take a certain amount of damage at the start of each of their actions. 
Poisoned characters take a certain amount of damage at the start of each of their actions and you also take damage over time outside of combat. 
Slowed characters act last in combat for a certain number of turns. 
Regeneration characters regenerate a certain amount of health every turn, or every 10 minutes out of combat. The regeneration effect only lasts for a limited duration. 
Stat changes (strength, agility, etc.) can be increased or decreased as a result of certain actions. 
Most of these status effects are only temporary and go away after combat unless noted otherwise. 

&#39;&#39;Spells&#39;&#39;
&lt;hr&gt;
In the western town there&#39;s a mage&#39;s guild where you can learn spells. You can only learn a spell if your base intelligence is high enough and if you have enough money to pay for them to teach you. Certain spells can only be cast in combat, other spells can only be cast out of combat, and some spells can be cast either in or out of combat. All spells require you to spend a certain amount of mana to cast them. Mana is regained automatically over time or you can restore mana more directly by drinking mana potions. 

&#39;&#39;Defeat&#39;&#39;
&lt;hr&gt;
If your health drops to 0, either from damage or from overeating or any other reason, then you are defeated. If any of your stats ever fall to 0 (usually from stat altering attacks) then you are also defeated. You&#39;re character never actually permanently &quot;dies&quot; though, so depending on the situation you either end up at the hospital or church. The penalties for this is the loss of some gold, plus the loss of everything you&#39;ve eaten and whatever calories you had stored up before being defeated. Also most temporary status effects end when you are defeated. So try not to be too reckless. 
&lt;hr&gt;
&lt;&lt;return&gt;&gt;</tw-passagedata><tw-passagedata pid="507" name="Inspect item" tags="" position="1450,450" size="100,100">/*Loads dialog based on item effect*/
&lt;&lt;switch $itemUsed.effect&gt;&gt;

&lt;&lt;case &quot;Eat&quot;&gt;&gt;
&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Food&quot;);
	Dialog.wiki(Story.get(&quot;Food&quot;).processText());
	Dialog.open();
&lt;&lt;/script&gt;&gt;

&lt;&lt;case &quot;Equip&quot;&gt;&gt;
&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Equipment&quot;);
	Dialog.wiki(Story.get(&quot;Equipment&quot;).processText());
	Dialog.open();
&lt;&lt;/script&gt;&gt;

&lt;&lt;case &quot;other&quot;&gt;&gt;
&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Effect items&quot;);
	Dialog.wiki(Story.get(&quot;Effect items&quot;).processText());
	Dialog.open();
&lt;&lt;/script&gt;&gt;

&lt;&lt;case &quot;quest&quot;&gt;&gt;
&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;describe quest item&quot;);
	Dialog.wiki(Story.get(&quot;describe quest item&quot;).processText());
	Dialog.open();
&lt;&lt;/script&gt;&gt;

&lt;&lt;default&gt;&gt;
&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Item error&quot;);
	Dialog.wiki(Story.get(&quot;Item error&quot;).processText());
	Dialog.open();
&lt;&lt;/script&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="508" name="Instructions" tags="" position="2550,700" size="100,100">&lt;hr&gt;
&#39;&#39;This twine version&#39;&#39;
&lt;p&gt;I hope this all works? Editing is a work in progress though. &lt;/p&gt;

&lt;hr&gt;
&#39;&#39;Stats&#39;&#39;
&lt;p&gt;Strength affects how much time/stamina it costs to travel somewhere. &lt;/p&gt;

&lt;p&gt;Agility affects who goes first in combat as well as increasing your odds to dodge/escape during combat. It also reduces the time it takes to travel somewhere. &lt;/p&gt;

&lt;p&gt;Endurance affects how quickly you lose stamina, as well as how quickly you regain health from resting. It also affects how much your maximum HP increases when you level up. &lt;/p&gt;

&lt;p&gt;Intelligence affects your chance to dodge/escape from your opponent as well as allowing you to go first in combat. It also affects your maximum mana and which spells you can learn. &lt;/p&gt;

&lt;p&gt;Intelligence/Strength/Agility each affect the damage scaling on different weapons based on the type of weapon. Each stat also has an affect on special events where it&#39;s applicable. &lt;/p&gt;

&lt;p&gt;Your secondary stats are: &lt;br&gt;
Health, which you need to keep above 0 to stay alive. &lt;br&gt;
Stamina, which you need to keep above 0 to be able to travel. &lt;br&gt;
Mana, which you spend to cast spells you&#39;ve learned. &lt;br&gt;
Fullness, which represents how much you can safely consume. &lt;/p&gt;

&lt;hr&gt;
&#39;&#39;Food&#39;&#39;
&lt;p&gt;Eating stuff obviously fills your stomach, and it usually gives you calories which turn into fat over time. &lt;/p&gt;

&lt;p&gt;If you eat over 100% of your stomach&#39;s regular capacity, your maximum health will be temporarily reduced based on how overstuffed you are. However being over 100% full will also stretch your stomach out over time, increasing your stomach capacity. &lt;/p&gt;

&lt;p&gt;If you get to 130% of your stomach&#39;s capacity then your maximum health is reduced to 0, ostensibly causing you to &quot;explode&quot; or at least pass out, based on your interpretation. So try to not to stuff yourself into unconsiousness, unless you feel like it of course. &lt;/p&gt;

&lt;hr&gt;
&#39;&#39;Specific locations&#39;&#39;
&lt;p&gt;Your house: You can save and load games from your bedroom inside your house. You can also sleep there, which just lets you rest for 8 hours. There is also your storage chest where you can store and receive items as well as gold. &lt;/p&gt;

&lt;p&gt;Restaurants: Eating at a restaurant confers a small temporary bonus to your stats. &lt;/p&gt;

&lt;p&gt;Training grounds: Training grounds allow you to burn fat and convert it into Strength/Agility as well as endurance. &lt;/p&gt;

&lt;p&gt;Stores: Any location with a store icon has some amount/type of items to sell. You can also sell things to most vendors. &lt;/p&gt;

&lt;p&gt;Hospital/Church: This is where you end up after being defeated. 
Mage&#39;s guild: In the town on the west side of the world there is a mage&#39;s guild where you can learn spells as well as train up your intelligence at the cost of fat. &lt;/p&gt;

&lt;hr&gt;
&#39;&#39;Combat&#39;&#39;
&lt;p&gt;Defeating enemies gains you xp which allow you to level up. When you level up, you can increase one of your stats as well as automatically healing you and increasing your max health. You can also often find gold and sometimes find items dropped by defeated enemies. &lt;/p&gt;

During combat you have several actions you can take: 
&lt;li&gt;Attack causes you to attack your enemy with your equipped weapon. &lt;/li&gt;

&lt;li&gt;Item let&#39;s you use an item from your inventory. &lt;/li&gt;

&lt;li&gt;Run allows you to attempt to run away from combat. &lt;/li&gt;

&lt;li&gt;Spells allows you to cast known spells at the cost of mana. &lt;/li&gt;

&lt;li&gt;Wait allows your enemy to get a free attack in on you, but regains some of your stamina. &lt;/li&gt;

&lt;li&gt;Submit allows you to surrender to your enemy and suffer whatever consequences that entails. &lt;/li&gt;
/* FIXES AND EDITS - Alter Devour option availability */
&lt;li&gt;Devour allows you to attempt to devour your enemy if your stomach capacity is high enough and you can overpower/outwit/outmaneuver your opponent. Be wary though, as the action may be available even if you couldn&#39;t successfully eat the foe in your current state (options depending). Depending on how full you already are, eating an enemy may push you over your limit and actually cause you to lose the fight. It is also worth noting that devouring an enemy prevents you from picking up any items they may have otherwise dropped. &lt;/li&gt;

&lt;li&gt;Struggle causes you to fight against your opponent once they have grappled you. Whichever stat is highest between Strength/Agility/Intelligence is used against your opponents grapple until you finally break free. &lt;/li&gt;

&lt;hr&gt;
&#39;&#39;Status effects&#39;&#39;
There are various status effects that you and your enemy can be subjected to. 

&lt;li&gt;Stunned characters skip their next action. &lt;/li&gt;

&lt;li&gt;Burned characters take a certain amount of damage at the end of each round. &lt;/li&gt;

&lt;li&gt;Poisoned characters take a certain amount of damage at the end of each round and you also take damage over time outside of combat. &lt;/li&gt;

&lt;li&gt;Slowed characters act last in combat for a certain number of turns. &lt;/li&gt;

&lt;li&gt;Regeneration characters regenerate a certain amount of health every turn, or every 10 minutes out of combat. The regeneration effect only lasts for a limited duration. &lt;/li&gt;

&lt;li&gt;Stat changes (strength, agility, etc.) can be increased or decreased as a result of certain actions.&lt;/li&gt; 

&lt;p&gt;Most of these status effects are only temporary and go away after combat unless noted otherwise. &lt;/p&gt;

&lt;hr&gt;
&#39;&#39;Defeat&#39;&#39;
&lt;p&gt;If your health drops to 0, either from damage or from overeating or any other reason, then you are defeated. &lt;/p&gt;

&lt;p&gt;If any of your stats ever fall to 0 (usually from stat altering attacks) then you are also defeated. &lt;/p&gt;

&lt;p&gt;You&#39;re character never actually permanently &quot;dies&quot; though, so depending on the situation you either end up at the hospital or church. The penalties for this is the loss of some gold, plus the loss of everything you&#39;ve eaten and whatever calories you had stored up before being defeated. Also most temporary status effects end when you are defeated. So try not to be too reckless. &lt;/p&gt;</tw-passagedata><tw-passagedata pid="509" name="Introduction" tags="intro city" position="2325,850" size="100,100">&lt;p&gt;You are a member of society living on a small but peaceful and fertile patch of land. In their recorded history no one has known of strife or want in this land of seemingly endless abundance. Lately though the land has become peculiarly more fertile. Crops grow faster and larger than ever before. The wilderness has started regrowing and encroaching back on civilization at an alarming rate. The animals have responded by ravenously devouring everything in sight. This includes the wild carnivores who have been glutting themselves on the hopelessley fattened animals. Lately they have even been attacking and devouring the townsfolk who venture too far into the wilderness. &lt;/p&gt;

&lt;p&gt;In addition to the animals, even the more civilized denizens of the land have slowly begun to lose themselves to gluttony and hedonism, more so than usual anyway. Nobody seems to know why the sudden change has come across everyone. In fact, nobody seems to even particularly notice or care. &lt;/p&gt;

&lt;p&gt;Today though, you awake from another night of restless dreams and finally decide that there must be something more out there, and thus begins your journey towards adventure! &lt;/p&gt;

&lt;p&gt;(Play the game by clicking the buttons on the right side of the screen)&lt;/p&gt;

/* FIXES AND EDITS - Go to mod options page first */
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;New Game&quot; &quot;Mod Setup&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;sw&quot; &quot;spells&quot; &quot;Patch notes&quot; &quot;Patch notes&quot; true&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;s&quot; &quot;spells&quot; &quot;Instructions&quot; &quot;Instructions&quot; true&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;se&quot; &quot;spells&quot; &quot;Credits&quot; &quot;Credits&quot; true&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="510" name="Inventory" tags="nobr" position="1325,450" size="100,100">/*Creates inventory links*/
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;

	&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $inventory[_i].quest != true&gt;&gt;
		
		/*Creates icon*/
		&lt;&lt;if $inventory[_i].icon != null&gt;&gt;&lt;&lt;icon $inventory[_i].icon&gt;&gt;
		&lt;&lt;else&gt;&gt;&lt;&lt;icon &quot;inventory&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
		
		/*Generates title*/
		&lt;&lt;set _title = $inventory[_i].Name&gt;&gt;
		&lt;&lt;if $inventory[_i].stack &gt; 0&gt;&gt;
			&lt;&lt;set _title +=&quot; x&quot;+$inventory[_i].stack&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		 
		
		/*Creates link*/
		&lt;&lt;link _title&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;include &quot;Inspect item&quot;&gt;&gt;
		&lt;&lt;/link&gt;&gt;...
		
		[ &lt;&lt;link &quot;Inspect&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;include &quot;Inspect item&quot;&gt;&gt;
		&lt;&lt;/link&gt;&gt; ]
		
		...[ &lt;&lt;switch $inventory[_i].effect&gt;&gt;

		&lt;&lt;case &quot;Eat&quot;&gt;&gt;
		&lt;&lt;link &quot;Eat&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;eat&quot;);
				Dialog.wiki(Story.get(&quot;eat&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;if $inventory[_i].stack &gt;= 10&gt;&gt; ][ 
		&lt;&lt;link &quot;Eat 10&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;eat 10&quot;);
				Dialog.wiki(Story.get(&quot;eat 10&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;case &quot;Equip&quot;&gt;&gt;
		&lt;&lt;link &quot;Equip&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;equip&quot;);
				Dialog.wiki(Story.get(&quot;equip&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
		&lt;&lt;/link&gt;&gt;

		&lt;&lt;case &quot;other&quot;&gt;&gt;
		&lt;&lt;link &quot;Use&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;use&quot;);
				Dialog.wiki(Story.get(&quot;use&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
		&lt;&lt;/link&gt;&gt;

		&lt;&lt;case &quot;quest&quot;&gt;&gt;
		&lt;&lt;link &quot;Inspect&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;describe quest item&quot;);
				Dialog.wiki(Story.get(&quot;describe quest item&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
		&lt;&lt;/link&gt;&gt;

		&lt;&lt;default&gt;&gt;
		&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
		&lt;&lt;link &quot;Error!?&quot;&gt;&gt;
			&lt;&lt;script&gt;&gt;
				Dialog.setup(&quot;Item error&quot;);
				Dialog.wiki(Story.get(&quot;Item error&quot;).processText());
				Dialog.open();
			&lt;&lt;/script&gt;&gt;
		&lt;&lt;/link&gt;&gt;

		&lt;&lt;/switch&gt;&gt; ]
		
		&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/for&gt;&gt;
&lt;hr&gt;

/*Closes inventory*/
[ &lt;&lt;link &quot;Close&quot;&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
&lt;&lt;/link&gt;&gt; ]</tw-passagedata><tw-passagedata pid="511" name="Item error" tags="nobr" position="1700,675" size="100,100">There was an error in the item you tried to use!?!</tw-passagedata><tw-passagedata pid="512" name="Key Items" tags="" position="1225,450" size="100,100">/*Creates inventory links*/
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;

	&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $inventory[_i].quest == true&gt;&gt;
		&lt;&lt;if $inventory[_i].icon != null&gt;&gt;
			&lt;&lt;icon $inventory[_i].icon&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;icon &quot;inventory&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set _title = $inventory[_i].Name&gt;&gt;
		&lt;&lt;if $inventory[_i].stack &gt; 0&gt;&gt;
			&lt;&lt;set _title +=&quot; x&quot;+$inventory[_i].stack&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;link _title&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;include &quot;Inspect item&quot;&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;br&gt;
		
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/for&gt;&gt;
&lt;hr&gt;

/*Closes inventory*/
[ &lt;&lt;link &quot;Close&quot;&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
&lt;&lt;/link&gt;&gt; ]</tw-passagedata><tw-passagedata pid="513" name="Level up" tags="" position="3075,325" size="100,100">You&#39;ve gained a level! Choose a stat to increase. 
&lt;hr&gt;

&lt;&lt;link &quot;Strength&quot;&gt;&gt;
	&lt;&lt;set $lvlUp--&gt;&gt;
	&lt;&lt;changeStats &quot;str&quot; 5&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
	&lt;&lt;updatePanels&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;br&gt;

&lt;&lt;link &quot;Agility&quot;&gt;&gt;
	&lt;&lt;set $lvlUp--&gt;&gt;
	&lt;&lt;changeStats &quot;agi&quot; 5&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
	&lt;&lt;updatePanels&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;br&gt;

&lt;&lt;link &quot;Endurance&quot;&gt;&gt;
	&lt;&lt;set $lvlUp--&gt;&gt;
	&lt;&lt;changeStats &quot;end&quot; 5&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
	&lt;&lt;updatePanels&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;br&gt;

&lt;&lt;link &quot;Intelligence&quot;&gt;&gt;
	&lt;&lt;set $lvlUp--&gt;&gt;
	&lt;&lt;changeStats &quot;int&quot; 5&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
	&lt;&lt;updatePanels&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;br&gt;

&lt;&lt;link &quot;Stomach&quot;&gt;&gt;
	&lt;&lt;set $lvlUp--&gt;&gt;
	&lt;&lt;changeStats &quot;sto&quot; 5&gt;&gt;
	&lt;&lt;run Dialog.close();&gt;&gt;
	&lt;&lt;updatePanels&gt;&gt;
&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="514" name="Options" tags="" position="3075,575" size="100,100">/* FIXES AND EDITS - Wrap options in labels to make easier to select */
/*Metric/imperial*/
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.metric&quot; true autocheck&gt;&gt;
&#39;&#39;Metric &#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.metric&quot; false autocheck&gt;&gt;
&#39;&#39;Imperial &#39;&#39;&lt;/label&gt;
&lt;hr&gt;

/*Bursting*/
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.popping&quot; true autocheck&gt;&gt;
&#39;&#39;Popping &#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.popping&quot; false autocheck&gt;&gt;
&#39;&#39;No popping &#39;&#39;&lt;/label&gt;
&lt;hr&gt;

/*Long player descriptions?*/
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.longDescription&quot; true autocheck&gt;&gt;
&#39;&#39;Long character description &#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.longDescription&quot; false autocheck&gt;&gt;
&#39;&#39;Short character description&#39;&#39;&lt;/label&gt;
&lt;hr&gt;

/*Random males*/
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.males&quot; true autocheck&gt;&gt;
&#39;&#39;Random male NPCs &#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.males&quot; false autocheck&gt;&gt;
&#39;&#39;No random male NPCs &#39;&#39;&lt;/label&gt;
&lt;hr&gt;

/*Random females*/
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.females&quot; true autocheck&gt;&gt;
&#39;&#39;Random female NPCs &#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.females&quot; false autocheck&gt;&gt;
&#39;&#39;No random female NPCs&#39;&#39; &lt;/label&gt;
&lt;hr&gt;

/* FIXES AND EDITS - Restructure Fixed NPC Data | Add gender options - START */
Set main NPC genders...&lt;br&gt;
&lt;&lt;if $options.fixedNPCGenders == null&gt;&gt;
	&lt;&lt;set $options.fixedNPCGenders = &quot;default&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.fixedNPCGenders&quot; &quot;default&quot; autocheck&gt;&gt;
&#39;&#39;Default&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.fixedNPCGenders&quot; &quot;male&quot; autocheck&gt;&gt;
&#39;&#39;All male&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.fixedNPCGenders&quot; &quot;female&quot; autocheck&gt;&gt;
&#39;&#39;All female&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.fixedNPCGenders&quot; &quot;swap&quot; autocheck&gt;&gt;
&#39;&#39;Genderswap&#39;&#39;&lt;/label&gt;
&lt;hr&gt;

&lt;label&gt;&lt;&lt;radiobutton &quot;$options.dark&quot; true autocheck&gt;&gt;
&#39;&#39;Dark mode &#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.dark&quot; false autocheck&gt;&gt;
&#39;&#39;Light mode &#39;&#39; &lt;/label&gt;
&lt;br&gt;(Takes effect on next page load.)
&lt;hr&gt;

/* FIXES AND EDITS - Reimplement combat stamina loss */
&lt;&lt;if $options.combatStamina == null&gt;&gt;&lt;&lt;set $options.combatStamina = 2&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.combatStamina&quot; 0 autocheck&gt;&gt;&#39;&#39;No attack cost&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.combatStamina&quot; 1 autocheck&gt;&gt;&#39;&#39;Attacks cost stamina&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.combatStamina&quot; 2 autocheck&gt;&gt;&#39;&#39;Attacks cost stamina &amp; can&#39;t attack when out&#39;&#39;&lt;/label&gt;
&lt;hr&gt;

/* FIXES AND EDITS - Alter Devour option availability - START */
&lt;&lt;if $options.devourShowMode == null&gt;&gt;
	&lt;&lt;set $options.devourShowMode = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
Show devour action...&lt;br&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.devourShowMode&quot; 3 autocheck&gt;&gt;&#39;&#39;If you can stomach it in your current state&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.devourShowMode&quot; 2 autocheck&gt;&gt;&#39;&#39;If you could stomach it on empty&#39;&#39;&lt;/label&gt;
&lt;label&gt;&lt;&lt;radiobutton &quot;$options.devourShowMode&quot; 1 autocheck&gt;&gt;&#39;&#39;Always&#39;&#39;&lt;/label&gt;

&lt;hr&gt;
/* FIXES AND EDITS - Alter Devour option availability - END */

/* FIXES AND EDITS - Add mod options menu */
&lt;&lt;popup &quot;Mod Options&quot; &quot;Mod Options&quot;&gt;&gt;
&lt;hr&gt;

&lt;&lt;popup &quot;Cheats&quot; &quot;cheat menu&quot;&gt;&gt;
&lt;hr&gt;
/* DEBUG */
/*&lt;&lt;include &quot;temp test&quot;&gt;&gt;*/</tw-passagedata><tw-passagedata pid="515" name="PassageHeader" tags="" position="2825,675" size="200,100">&lt;&lt;run $(&quot;#story&quot;)[0].scrollIntoView()&gt;&gt;

&lt;&lt;if $travel &gt; 0&gt;&gt;
	&lt;&lt;set _strength = (($ate/2)+($fat/5))/$str&gt;&gt;
	&lt;&lt;set _agility = ($agi/40) - _strength&gt;&gt;
	
    /* ICY SPELLS - Edits for levitation */
    
	/*Spends stamina*/
	&lt;&lt;if _strength &gt; 20&gt;&gt;&lt;&lt;set _strength = 20&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;set _stamina = (-1 * $travel) * Math.pow(1.25,_strength)&gt;&gt;
	
    &lt;&lt;if not $status.levitateTime &gt; 0&gt;&gt; /* only spend stamina if not levitating */
    	&lt;&lt;stamina _stamina&gt;&gt;
    &lt;&lt;/if&gt;&gt;
	
	/*Spends time*/
	&lt;&lt;if $status.levitateTime &gt; 0&gt;&gt; /* substitute the player&#39;s agility score */
    	&lt;&lt;set _agility = $status.levitate&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    
    &lt;&lt;if _agility &gt; 20&gt;&gt;&lt;&lt;set _agility = 20&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _agility &lt; -20&gt;&gt;&lt;&lt;set _agility = -20&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;set _walkTime = $travel * Math.pow(0.8,_agility)&gt;&gt;
    
	&lt;&lt;if _walkTime &lt; 1&gt;&gt;&lt;&lt;set _walkTime = 1&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;doTime _walkTime&gt;&gt;
	&lt;&lt;set $travel = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $pretext != &quot;&quot; and $pretext != null&gt;&gt;
	$pretext
	
	&lt;&lt;set $pretext = &quot;&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;clearActions&gt;&gt;

&lt;&lt;if $options.dark&gt;&gt;
	&lt;&lt;run setup.toggleDarkMode()&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;run setup.toggleLightMode()&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="516" name="Patch notes" tags="" position="2825,450" size="200,200">&lt;li&gt;Version 0.64a&lt;/li&gt;
-Fixed mountain travelling not properly counting stamina. 
&lt;br&gt;-Dodging works now! Apparently it was broken almost the whole time! 
&lt;br&gt;-Fixed several typos. 

&lt;li&gt;Version 0.64&lt;/li&gt;
-Fixed greatsword price. 
&lt;br&gt;-Fixed appearance of weight based travel descriptions in the city to be more sensical. 
&lt;br&gt;-Fixed dialogue in general store. 
&lt;br&gt;-Fixed error in dessert village. 
&lt;br&gt;-Slightly reduced the required stats for strength description changes. 
&lt;br&gt;-Stamina now affects your ability to travel. 
&lt;br&gt;-Wyvern egg is now removed at a more appropriate point when you sell it. 
&lt;br&gt;-Smoothed out enemy randomization to be less &quot;random&quot;. 
&lt;br&gt;-Fixed some typos. 
&lt;br&gt;-Updated thief&#39;s ai if you have a very high strength stat thanks to Someoneoutthere. 
&lt;br&gt;-Expanded the forest feast event thanks to The_Wind_King (with some help from Someoneoutthere)! 

&lt;li&gt;Version 0.63a&lt;/li&gt;
-Fixed getting stuck at the inn. 
&lt;br&gt;-Fixed running from unrunnable enemies being weird. 
&lt;br&gt;-Fixed some typos. 
&lt;br&gt;-Changed tough fur&#39;s attacks slightly thanks to Someoneoutthere!

&lt;li&gt;Version 0.63&lt;/li&gt;
-Slightly reduced enemy stats. You&#39;ll need to click &quot;Fix enemy stats&quot; under &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt;.
&lt;br&gt;-Reduced enemy damage rolls. 
&lt;br&gt;-Slightly increased armor values of armor. Will have to use the &quot;Update items&quot; link in &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt;, which will only update new copies of the armor you get. 
&lt;br&gt;-Removed stat scaling! 
&lt;br&gt;-Added sleep button to places where you can sleep so you can sleep while you sleep. 
&lt;br&gt;-Chenged how studying at the mage guild works to be more consistent with other areas. 
&lt;br&gt;-Large fruits come in &quot;stacks&quot; of 10 so they sync better with the &quot;eat 10&quot; option in the inventory. Will have to use the &quot;Update items&quot; link in &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt;.
&lt;br&gt;-Added ability to offer sampson ample amples instead of regular ones. 
&lt;br&gt;-Fixed a text error with the takeout terror that was apparently there since the original game! 
&lt;br&gt;-Added some more to ambient city descriptions thanks to Someoneoutthere! 
&lt;br&gt;-Also changed one of Takeout Terror&#39;s attack somewhat thanks to Someoneoutthere. 
&lt;br&gt;-Fixed some typos. 

&lt;li&gt;Version 0.62d&lt;/li&gt;
-I think I have added a dark mode to the options menu? I have no idea how well this will work, and I&#39;m really hoping it doesn&#39;t do any sort of weird flickering. Please let me know if it works!

&lt;li&gt;Version 0.62c&lt;/li&gt;
-And now I&#39;ve changed the ui again to be much more like the original! I kind of liked the dark version, but this is more visually interesting. Also I&#39;m starting to think I should get rid of that bottom bar because it&#39;s been giving me a lot of problems. Or maybe I should learn html better. But either way, let me know what you think! 
&lt;br&gt;-Fixed levelling up not working. 

&lt;li&gt;Version 0.62b&lt;/li&gt;
-Changed the ui again to be more mobile friendly maybe? It introduces some new, but hopefully lesser problems. 
&lt;br&gt;-Fixed devouring the manticore again! 
&lt;br&gt;-Changed how the training grounds handle being at 0 stamina, slightly. 

&lt;li&gt;Version 0.62a&lt;/li&gt;
-Made restaurant price list much less vague. 
&lt;br&gt;-The bottom bar should now update properly. 
&lt;br&gt;-Fruit dryad should now properly doppelgang you. 
&lt;br&gt;-Added submit event to honey slime (which is actually the blueberry slime event in disguise.)
&lt;br&gt;-Changed the spacing around the main passage and the grid button text.  
&lt;br&gt;-The tailor now actually properly reimburses you when you hand of the wizard&#39;s robes for Sampson&#39;s quest. 

&lt;li&gt;Version 0.62&lt;/li&gt;
-The UI update! Exciting I know. But I changed how the entire user interface works, and if the UI breaks then the game becomes legit unplayable. So I&#39;m going to try to focus on the UI for this update, and if things go terribly wrong then I&#39;ll just revert to a previous version. But things //should// be working properly and it //should// be slightly better on mobile. But you&#39;ll have to let me know if it works or not. 

&lt;li&gt;Version 0.61o&lt;/li&gt;
-Can no longer use items during eating contest, as intended. 
&lt;br&gt;-Added link to &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; to update unclothed descriptions to better fit with game descriptions. 
&lt;br&gt;-City combat encounters should now end with the proper navigation. 
&lt;br&gt;-Fixed very many typos and errors. 

&lt;li&gt;Version 0.61n&lt;/li&gt;
-Improved item descriptions in stores. 
&lt;br&gt;-Added mana costs to spell descriptions. 
&lt;br&gt;-Added some more popping events to hills events thanks to Rev701 and to the syrup vines thanks to Rejax!
&lt;br&gt;-Implemented the button grid at the intro to the game. 
&lt;br&gt;-Fixed some typos. 

&lt;li&gt;Version 0.61m&lt;/li&gt;
-Added directional action thingy again! There&#39;s so many ways this can break so please let me know if anything goes wrong! 
&lt;br&gt;-Not everything has been moved over to the grid, but they should be in their old location if not. 
&lt;br&gt;-Fixed logical error in gingerbread witch event that prevented a scene from being possible. 
&lt;br&gt;-Fixed logical error in jungle shaman quest. 
&lt;br&gt;-Added icons to several gems thanks to Trollololol. You&#39;ll have to use the &quot;update items&quot; link under &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; and get rid of your old copies of items before the new icons will show up. 
&lt;br&gt;-The bottom bar should be more mobile friendly?
&lt;br&gt;-The movement grid changes based on screen size in a hopefully good way? 
&lt;br&gt;-Font size reduced on smaller screens.
&lt;br&gt;-I don&#39;t know if these mobile changes are helping or not, so please let me know! This game wasn&#39;t really made with mobile in mind unfortunately so it&#39;ll prbably take a lot of rearranging to get things right. 
&lt;br&gt;-You should no longer be defeated at the restaurant if you end up under 130% full after eating. 

&lt;li&gt;Version 0.61l&lt;/li&gt;
-Hydra&#39;s item drop chance increased from 1% to 100%. Click on the &quot;Fix enemy stats&quot; in &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; to apply this change. 
&lt;br&gt;-Stats udpate when opening stats screen now. 
&lt;br&gt;-Fixed some more typos. 
&lt;br&gt;-Stat scaling for stomach capacity is slightly less restrictive now. 
&lt;br&gt;-Fixed minor error in sirens event. 
&lt;br&gt;-Switched double line breaks to paragraphs, which I think is better? I got tired before I finished them all. 
&lt;br&gt;-Updated instructions somewhat. 

&lt;li&gt;Version 0.61k&lt;/li&gt;
-Fixed some more typos. 
&lt;br&gt;-Added link to &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; that&#39;ll give you the Myst Mail from &quot;On the chain gang&quot;. 
&lt;br&gt;-Getting items with charges like cake or the large fruit now adds extra stacks. 
&lt;br&gt;-Added ability to unequip items in the status menu. 
&lt;br&gt;-Streamlined item usage in a way that&#39;ll almost certainly break something. 
&lt;br&gt;-Please let me know if something goes wrong, cause these are all things with high error possibilities. But they should all be fine? 
&lt;br&gt;-Mana potions now actually restore mana. 
&lt;br&gt;-It should be no longer possible to get extra slime items while on Bronk&#39;s quests. 
&lt;br&gt;-Added link to &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; that&#39;ll remove all slimes from your inventory, in case you have too many. 
&lt;br&gt;-Added link to &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; that fixes description of stretchyseaweed. You&#39;ll have to get rid of all your old copies of it before this button&#39;ll do anything. 
&lt;br&gt;-Also you can click the &quot;Fix enemy stats&quot; link in &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; to make the wildling shaman boss nonvoreable, like he&#39;s supposed to be. 

&lt;li&gt;Version 0.61j&lt;/li&gt;
-Armor actually prevents damage now!
&lt;br&gt;-Fixed bloat bees doing too much damage. Will have to use the link in &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; to update their stats. 
&lt;br&gt;-Added bursting scenes to water elemental thanks to Rejax!
&lt;br&gt;-Fixed some typos. 

&lt;li&gt;Version 0.61i&lt;/li&gt;
-Added more popping scenes thanks to Rev701! 
&lt;br&gt;-Fixed some more typos. 
&lt;br&gt;-Can now only get Wizards Notebook once. 
&lt;br&gt;-Combat status effects should no longer trigger after defeat. 
&lt;br&gt;-You now actually have to have a diet pill in your inventory in order to give one to the wildling captive. 

&lt;li&gt;Version 0.61h&lt;/li&gt;
-Long character descriptions fixed so they actually show up now! This was somehow bugged in an exact fashion that didn&#39;t throw up errors somewhow!
&lt;br&gt;-Fixed text error with honey slime. 
&lt;br&gt;-Species list is now alphabetized. 
&lt;br&gt;-Inventory is now split into regular items and &quot;key items&quot;. 
&lt;br&gt;-Changed ui of inventory somewhat? 
&lt;br&gt;-Typos in forest ambience fixed. 
&lt;br&gt;-Stretchy fruit/seaweed effects ending should no longer put you in limbo. 
&lt;br&gt;-Changed how resting works in a way that&#39;s hopefully better. 
&lt;br&gt;-You can now rest at the dairy farm. 
&lt;br&gt;-Gender settings should work in more situations. Hopefully this doesn&#39;t have unforseen consequences, but I think it should work fine? 

-&lt;li&gt;Version 0.61g&lt;/li&gt;
-Fixed not being able to leave when talking to Sampson during Strength quest. 
&lt;br&gt;-Fixed mana potions being named &quot;health&quot; potions. Will probably have to get rid of old potions and use &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; link to fix names. 
&lt;br&gt;-Fixed typo in training grounds. 
&lt;br&gt;-Clothes enhanced by golden thread should now actually be unbreakable. Although if your clothes are already broken, you&#39;ll have to tailor them and golden thread them again. 
&lt;br&gt;-Also you should actually be able to equip clothes enhanced by golden thread. 
&lt;br&gt;-Fixed &quot;walking&quot; descriptor having &quot;slowly&quot; added to it too many times. 
&lt;br&gt;-Golden bracelet should actually do something now. 
&lt;br&gt;-Fixed weird &quot;rest&quot; thing in west town. 
&lt;br&gt;-Smarty should now actually teach the correct spells. 
&lt;br&gt;-Fixed quest description for &quot;Learning to smith&quot; (although if you already have the quest then the description will just show up as blank. 
&lt;br&gt;-Fixed minor error in player description
&lt;br&gt;-Fixed price of milk jugs at milk stand. 
&lt;br&gt;-Made unsellable items actually unsellable. 
&lt;br&gt;-Added a link to &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; that&#39;ll turn your gold back into an actual number if it somehow got turned into &quot;[number NaN]&quot;. 
&lt;br&gt;-Fixed typo in well event. 
&lt;br&gt;-Added link under &lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt; that should fix the names of the &quot;crazed&quot; enemies, as well as update the characteristics of enemies in general. I think they&#39;re the only ones I&#39;ve changed so far though. 
&lt;br&gt;-Fixed the &quot;Devour&quot; option from showing up when it shouldn&#39;t. 
&lt;br&gt;-Fixed error with surviving feeder ant encounter. 

&lt;hr&gt;
&lt;li&gt;Version 0.61f&lt;/li&gt;
-Fixed error in blueberry slime ai
&lt;br&gt;-Slightly changed character description. 
&lt;br&gt;-Barkskin now actually does something. 
&lt;br&gt;-&quot;Beating some sense&quot; quest should now actually be completeable after fighting your way in?
&lt;br&gt;-Fixed error in Star shaman combat description
&lt;br&gt;-Added/Updated several popping scenes to be more... poppy thanks to Rev701! (largely focused on grasslands/hills enemies)
&lt;br&gt;-Changed several defeats from &quot;overeating&quot; to &quot;exploded&quot; to fit with scene better
&lt;br&gt;-You can now use the Book of Crystals multiple times. 
&lt;br&gt;-Added a game fixes link to the left panel. This should let you fix problems in the game? There&#39;s probably a better solution, but this is the most expedient solution at least. 

&lt;hr&gt;
&lt;li&gt;Version 0.61e&lt;/li&gt;
-A few textual errors
&lt;br&gt;-Fixed lemon slimes attack description
&lt;br&gt;-Fixed a few random textual errors. 
&lt;br&gt;-Stretch fruit and stretchy seaweed should now actually work. 
&lt;br&gt;-Fixed random events in the ocean and jungle. 
&lt;br&gt;-Chainmail quest should actually remove the chainmails you hand over from your inventory. 
&lt;br&gt;-Fixed &quot;Beating some sense&quot; quest
&lt;br&gt;-Fixed a couple enemy defeat errors

&lt;hr&gt;
&lt;li&gt;Version 0.61d&lt;/li&gt;
-Fixed error in long character descriptions. 
&lt;br&gt;-Blueberry slimes now reduce agility as intended
&lt;br&gt;-Fixed several instances where player weight was calculated incorrectly. 

&lt;hr&gt;
&lt;li&gt;Version 0.61c&lt;/li&gt;
-Fixed blue jays
&lt;br&gt;-Fixed events that cared about waist diameter, particularly the storeroom. 
&lt;br&gt;-&quot;Fixed&quot; crazed enemy names. I&#39;ll need to fix it better later. 
&lt;br&gt;-Fixed getting fractional gold. 
&lt;br&gt;-Fixed random npc genders even better. 
&lt;br&gt;-Fixed the descriptions of stretchy fruit. I think you&#39;ll have to get rid of all your old ones to fix the description.
&lt;br&gt;-Fixed soft lock when losing to the manticore. 
&lt;br&gt;-Added credits and patch notes to sidebar. 
&lt;br&gt;-Cheats are in the options menu. Which was true before, but I forgot to mention it. 
&lt;br&gt;-Added horizontal rules to the sidebar because... I like them. 
&lt;br&gt;-Fixed Bronk&#39;s quest, but you&#39;ll have to click this link if you&#39;ve already started part 3 of his quest: &lt;&lt;popup &quot;hot fixes&quot; &quot;hot fixes&quot;&gt;&gt;
&lt;br&gt;-Fixed the restaurant being weird if you did work there after ordering food. 
&lt;br&gt;-I think I fixed Sampson&#39;s chainmail quest...?
&lt;br&gt;-Fixed mad milk quest so defeating machines actually advances quest, I think. 

&lt;hr&gt;
&lt;li&gt;Version 0.61b&lt;/li&gt;
-Tailor no longer assumes you have gold thread
&lt;br&gt;-Popping option now actually does something

&lt;hr&gt;
&lt;li&gt;Version 0.61a&lt;/li&gt;
-Fixed some erroneous character descriptions in a few events
&lt;br&gt;-NPC gender options should now actually do something
&lt;br&gt;-Mad milk machine image should work now

&lt;hr&gt;
&lt;li&gt;Version 0.61&lt;/li&gt;
-Game now exists in non-flash format.
&lt;br&gt;-Inventory works in new fashion that I hope to god works.
&lt;br&gt;-Enemy spell damage is now based on their stats.
&lt;br&gt;-Enemy introductions exist in more places.
&lt;br&gt;-Enemy attacks should function more... as intended?
&lt;br&gt;-Saves work in a new way that I don&#39;t at all understand, but should be way better maybe!
&lt;br&gt;-Some typos fixed.
&lt;br&gt;-Numerous minor changes that I don&#39;t really remember.
&lt;br&gt;-Added more possible random npc species.
&lt;br&gt;-Slightly changed metric calculations. 
&lt;br&gt;-Waist diameter now accounts for being inflated. 
&lt;br&gt;-Added overeating defeats to certain items that should&#39;ve always been there. 
&lt;br&gt;-Added low chance event to digestive biscuit that should&#39;ve always been there I think. 
&lt;br&gt;-Added ability to eat 10 copies of a food item at once. 
&lt;br&gt;-Changed how status effects work in combat in a very experimental fashion. 
&lt;br&gt;-Changed how resting works in an ill-advised fashion. 
&lt;br&gt;-Storage doesn&#39;t exist yet.</tw-passagedata><tw-passagedata pid="517" name="Path out of the hills" tags="" position="2650,2400" size="100,100">You find a dirt footpath. As you approach closer you find it leads to one of the roads out of the city! Do you want to leave? 

&lt;&lt;include &quot;hills randomization&quot;&gt;&gt;

&lt;&lt;if random(1,2) == 1&gt;&gt;
&lt;&lt;action &quot;n&quot; &quot;road&quot; &quot;Eastern Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;w&quot; &quot;road&quot; &quot;Southern Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="518" name="Quests" tags="nobr" position="3075,700" size="100,100">&lt;&lt;for _i = 0; _i &lt; $quests.length; _i++&gt;&gt;
	&lt;p&gt;
	&lt;li&gt;&lt;u&gt;$quests[_i].name&lt;/u&gt;&lt;/li&gt;
	&lt;&lt;if $quests[_i].description != null&gt;&gt;
		$quests[_i].description
	&lt;&lt;/if&gt;&gt;
	&lt;br&gt;
	
	&lt;&lt;if $quests[_i].goal &gt; 0 and !$quests[_i].completed&gt;&gt;
	$quests[_i].progress / $quests[_i].goal
	
	&lt;&lt;elseif $quests[_i].completed&gt;&gt;
	Quest complete!
	&lt;&lt;/if&gt;&gt;	
	&lt;/p&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="519" name="Reminders" tags="" position="2575,425" size="200,100">//Emphasis//
&#39;&#39;Strong&#39;
__Underline__
==Strikethrough==
Super^^script^^
Sub~~script~~
*line item
---- or &lt;hr&gt; horizontal rule

Util.isNumeric(something)
Makes sure it&#39;s a number

clone(thing)
Makes a clone of the thing

Remember to end javascript function calls with () and start them with &quot;setup.&quot;
i.e. setup.randomHerbivore()</tw-passagedata><tw-passagedata pid="520" name="Select Species" tags="intro" position="2700,975" size="100,100">Select your species. (Or whatever&#39;s closest. You&#39;ll be able to edit it on the next page.)
/*&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Edit species&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;*/
/* FIXES AND EDITS - Go to new species editor instead */
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Edit species&quot; &quot;Species Editor&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;charGen&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;
&lt;br&gt;

/* FIXES AND EDITS - Make building species list automatic */
&lt;&lt;printSpeciesOptions &quot;$species&quot;&gt;&gt;

/*Scrubs text entry of gender*/
&lt;&lt;set $p.male = $p.male.toLowerCase()&gt;&gt;
&lt;&lt;set $p.he = $p.he.toLowerCase()&gt;&gt;
&lt;&lt;set $p.him = $p.him.toLowerCase()&gt;&gt;
&lt;&lt;set $p.his = $p.his.toLowerCase()&gt;&gt;
&lt;&lt;set $p.himself = $p.himself.toLowerCase()&gt;&gt;
&lt;&lt;set $p.man = $p.man.toLowerCase()&gt;&gt;
&lt;&lt;set $p.boy = $p.boy.toLowerCase()&gt;&gt;
&lt;&lt;set $p.sir = $p.sir.toLowerCase()&gt;&gt;
&lt;&lt;set $p.mister = $p.mister.toLowerCase()&gt;&gt;
&lt;&lt;set $p.guy = $p.guy.toLowerCase()&gt;&gt;
&lt;&lt;set $p.brother = $p.brother.toLowerCase()&gt;&gt;
&lt;&lt;set $p.fella = $p.fella.toLowerCase()&gt;&gt;
&lt;&lt;set $p.buddy = $p.buddy.toLowerCase()&gt;&gt;
&lt;&lt;set $p.gentleman = $p.gentleman.toLowerCase()&gt;&gt;
&lt;&lt;set $p.lad = $p.lad.toLowerCase()&gt;&gt;
&lt;&lt;set $p.laddie = $p.laddie.toLowerCase()&gt;&gt;
&lt;&lt;set $p.sport = $p.sport.toLowerCase()&gt;&gt;

&lt;&lt;set $p.Male = $p.male.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.He = $p.he.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Him = $p.him.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.His = $p.his.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Himself = $p.himself.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Man = $p.man.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Boy = $p.boy.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Sir = $p.sir.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Mister = $p.mister.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Guy = $p.guy.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Brother = $p.brother.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Fella = $p.fella.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Buddy = $p.buddy.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Gentleman = $p.gentleman.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Lad = $p.lad.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Laddie = $p.laddie.toUpperFirst()&gt;&gt;
&lt;&lt;set $p.Sport = $p.sport.toUpperFirst()&gt;&gt;</tw-passagedata><tw-passagedata pid="521" name="Select gender" tags="intro" position="2575,850" size="100,100">Select gender. (You&#39;ll be able to edit how your character&#39;s described on the next page.)
&lt;br&gt;

&lt;&lt;listbox &quot;$gender&quot;&gt;&gt;
	&lt;&lt;option &quot;Male&quot; $male&gt;&gt;
	&lt;&lt;option &quot;Female&quot; $female&gt;&gt;
    /* FIXES AND EDITS - Add in more gender options */
    &lt;&lt;option &quot;Non-binary / Neuter&quot; $neuter&gt;&gt;
    &lt;&lt;option &quot;Thing&quot; $thing&gt;&gt;
&lt;&lt;/listbox&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Edit gender&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="522" name="Spells" tags="nobr" position="1125,300" size="100,100">/* Clean cancelled configs of previous spells */
&lt;&lt;set $spellConfig = {}&gt;&gt;

/* FIXES AND EDITS - Hackily edited to work with new spell format */
&lt;&lt;for _i = 0; _i &lt; $spells.length; _i++&gt;&gt;
&lt;&lt;set _spell =  setup.getSpell($spells[_i])&gt;&gt;

&lt;&lt;capture _i, _spell&gt;&gt;
	/* Skip displaying spells from disabled mods */
    &lt;&lt;if _spell.option and variables()[_spell.option] == false&gt;&gt;
    	&lt;&lt;continue&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    
	&lt;&lt;printSpellbookOption _spell false&gt;&gt;
&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="523" name="Status" tags="" position="3075,200" size="100,100">&#39;&#39;$name&#39;&#39;,&lt;br&gt;
You are a $p.male $p.species that weighs 
&lt;&lt;set _weight = Math.round(setup.weight())&gt;&gt;
&lt;&lt;sayWeight _weight&gt;&gt;
and is &lt;&lt;sayDistance $p.height&gt;&gt; tall. 
&lt;hr&gt;


&lt;&lt;include &quot;Character Description&quot;&gt;&gt;
&lt;hr&gt;


You are wearing: 
&lt;li&gt;$top.Name
&lt;&lt;if $top.Name != $shirtless.Name&gt;&gt;
  [ &lt;&lt;link &quot;Unequip&quot;&gt;&gt;
	&lt;&lt;getItem $top&gt;&gt;
	&lt;&lt;set $top = clone($shirtless)&gt;&gt;
	&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Status&quot;);
	Dialog.wiki(Story.get(&quot;Status&quot;).processText());
	Dialog.open();
	&lt;&lt;/script&gt;&gt;	  
  &lt;&lt;/link&gt;&gt; ]
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;if $top.popped&gt;&gt;$top.poppedDescription
&lt;&lt;else&gt;&gt;$top.description
&lt;&lt;/if&gt;&gt;
&lt;/li&gt;

&lt;li&gt;$btm.Name
&lt;&lt;if $btm.Name != $pantsless.Name&gt;&gt;
  [ &lt;&lt;link &quot;Unequip&quot;&gt;&gt;
	&lt;&lt;getItem $btm&gt;&gt;
	&lt;&lt;set $btm = clone($pantsless)&gt;&gt;
	&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Status&quot;);
	Dialog.wiki(Story.get(&quot;Status&quot;).processText());
	Dialog.open();
	&lt;&lt;/script&gt;&gt;	  
  &lt;&lt;/link&gt;&gt; ]
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;if $btm.popped&gt;&gt;$btm.poppedDescription
&lt;&lt;else&gt;&gt;$btm.description
&lt;&lt;/if&gt;&gt;
&lt;/li&gt;

&lt;li&gt;$arm.Name
&lt;&lt;if $arm.Name != $unarmored.Name&gt;&gt;
  [ &lt;&lt;link &quot;Unequip&quot;&gt;&gt;
	&lt;&lt;getItem $arm&gt;&gt;
	&lt;&lt;set $arm = clone($unarmored)&gt;&gt;
	&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Status&quot;);
	Dialog.wiki(Story.get(&quot;Status&quot;).processText());
	Dialog.open();
	&lt;&lt;/script&gt;&gt;	  
  &lt;&lt;/link&gt;&gt; ]
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
$arm.description&lt;br&gt;
//$arm.defense defense//
&lt;/li&gt;

&lt;&lt;set _damage = $wea.damage+&quot;d&quot;+$wea.range&gt;&gt;
&lt;&lt;set _scaling = &quot;+&quot;+($wea.scaling*100)+&quot;% &quot;+$wea.stat&gt;&gt;
&lt;li&gt;$wea.Name
&lt;&lt;if $wea.Name != $unarmed.Name&gt;&gt;
  [ &lt;&lt;link &quot;Unequip&quot;&gt;&gt;
	&lt;&lt;getItem $wea&gt;&gt;
	&lt;&lt;set $wea = clone($unarmed)&gt;&gt;
	&lt;&lt;script&gt;&gt;
	Dialog.setup(&quot;Status&quot;);
	Dialog.wiki(Story.get(&quot;Status&quot;).processText());
	Dialog.open();
	&lt;&lt;/script&gt;&gt;	  
  &lt;&lt;/link&gt;&gt; ]
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
$wea.description&lt;br&gt;
//Deals _damage _scaling $wea.damageType damage. //
&lt;&lt;if $wea.stat == &quot;int&quot; and $wea.scaling &gt; 0.4&gt;&gt;
	//Increases spell damage by _scaling.//
&lt;&lt;/if&gt;&gt;
&lt;/li&gt;
&lt;hr&gt;


&lt;&lt;include &quot;player status&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="524" name="StoryAuthor" tags="" position="2825,325" size="200,100">&lt;hr&gt;
&lt;&lt;popup &quot;By Noone and many other contributors.&quot; &quot;Credits&quot;&gt;&gt; &lt;br&gt;
~~Version: 0.64a &lt;br&gt;
&lt;&lt;popup &quot;Patch notes&quot; &quot;Patch notes&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;popup &quot;Game fixes&quot; &quot;hot fixes&quot;&gt;&gt;~~

&lt;hr&gt;

&lt;&lt;button &quot;&#39;&#39;Saves&#39;&#39;&quot;&gt;&gt;&lt;&lt;run UI.saves()&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;br&gt;
&lt;&lt;button &quot;&#39;&#39;Restart&#39;&#39;&quot;&gt;&gt;&lt;&lt;run UI.restart()&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;br&gt;</tw-passagedata><tw-passagedata pid="525" name="StoryBanner" tags="" position="2825,1050" size="200,100">/*Back and forward buttons*/
&lt;&lt;button &quot;&#39;&#39;&lt;&lt;&lt;&#39;&#39;&quot;&gt;&gt;&lt;&lt;run Engine.backward()&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;button &quot;&#39;&#39;&gt;&gt;&gt;&#39;&#39;&quot;&gt;&gt;&lt;&lt;run Engine.forward()&gt;&gt;&lt;&lt;/button&gt;&gt;</tw-passagedata><tw-passagedata pid="526" name="StoryInit" tags="" position="2325,200" size="200,200">&lt;&lt;set $version = &quot;0.61b&quot;&gt;&gt;
&lt;&lt;set $gender = &quot;female&quot;&gt;&gt;
&lt;&lt;set $species = $lion&gt;&gt;
&lt;&lt;set $speciesHeight = 0&gt;&gt;
&lt;&lt;set $speciesStats = [0,0,0,0,0,0]&gt;&gt;

&lt;&lt;set $eventCounterA = 0&gt;&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;set $npc1 = {}&gt;&gt;
&lt;&lt;set $npc2 = {}&gt;&gt;
&lt;&lt;set $npc3 = {}&gt;&gt;

/*Make sure you load things in the correct order*/
&lt;&lt;include &quot;item objects&quot;&gt;&gt;
&lt;&lt;include &quot;gender variables&quot;&gt;&gt;
&lt;&lt;include &quot;species variables&quot;&gt;&gt;
&lt;&lt;include &quot;quest objects&quot;&gt;&gt;
&lt;&lt;include &quot;time variables&quot;&gt;&gt;
&lt;&lt;include &quot;enemy variables&quot;&gt;&gt;
&lt;&lt;include &quot;enemy stats&quot;&gt;&gt;
&lt;&lt;include &quot;spell objects&quot;&gt;&gt;
&lt;&lt;include &quot;player variables&quot;&gt;&gt;

&lt;&lt;set $e = $fatWolf&gt;&gt;

&lt;&lt;set $vendorInventory = []&gt;&gt;
&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you so much!\&quot;&quot;&gt;&gt;
&lt;&lt;set $vendor = {
	a: 0,
	b: 0
}&gt;&gt;

&lt;&lt;include &quot;event randomization&quot;&gt;&gt;

&lt;&lt;newmeter &#39;healthBar&#39;&gt;&gt;
    &lt;&lt;animation 300ms&gt;&gt;
    &lt;&lt;colors &#39;green&#39; &#39;#FF4136&#39; &#39;black&#39;&gt;&gt;
	&lt;&lt;sizing 100%&gt;&gt;
&lt;&lt;/newmeter&gt;&gt;

&lt;&lt;newmeter &#39;fullBar&#39;&gt;&gt;
    &lt;&lt;colors &#39;#FF4136&#39; &#39;green&#39; &#39;black&#39;&gt;&gt;
	&lt;&lt;sizing 100%&gt;&gt;
&lt;&lt;/newmeter&gt;&gt;

&lt;&lt;newmeter &#39;manaBar&#39;&gt;&gt;
    &lt;&lt;colors &#39;blue&#39; &#39;gray&#39; &#39;black&#39;&gt;&gt;
	&lt;&lt;sizing 100%&gt;&gt;
&lt;&lt;/newmeter&gt;&gt;

&lt;&lt;newmeter &#39;staminaBar&#39;&gt;&gt;
    &lt;&lt;colors &#39;white&#39; &#39;white&#39; &#39;black&#39;&gt;&gt;
	&lt;&lt;sizing 100%&gt;&gt;
&lt;&lt;/newmeter&gt;&gt;

&lt;&lt;newmeter &#39;enemyHealth&#39;&gt;&gt;
	&lt;&lt;sizing 100%&gt;&gt;
&lt;&lt;/newmeter&gt;&gt;


/* FIXES AND EDITS - Add dedicated passage for loading mod passages - START */
&lt;&lt;include &quot;mods patch and update&quot;&gt;&gt;
/* FIXES AND EDITS - Add dedicated passage for loading mod passages - END */</tw-passagedata><tw-passagedata pid="527" name="StoryInterface" tags="" position="2825,925" size="200,100">&lt;body class=&quot;dark-theme || light-theme&quot;&gt;

&lt;div class=&quot;row&quot;&gt;

&lt;div id=&quot;leftBar&quot;&gt;
        &lt;header id=&quot;title&quot; role=&quot;banner&quot;&gt;
            &lt;div id=&quot;story-banner&quot;&gt;&lt;/div&gt;
            &lt;h1 id=&quot;story-title&quot;&gt;&lt;/h1&gt;
            &lt;div id=&quot;story-subtitle&quot;&gt;&lt;/div&gt;
            &lt;div id=&quot;story-title-separator&quot;&gt;&lt;/div&gt;
            &lt;p id=&quot;story-author&quot;&gt;&lt;/p&gt;
        &lt;/header&gt;
&lt;/div&gt;


	
&lt;div id=&quot;story&quot; role=&quot;main&quot;&gt;

&lt;div id=&quot;bg&quot; style=&quot;position:relative; z-index:-1; opacity:0.4;&quot;&gt;
	&lt;img src=&quot;images/leftleaves.png&quot; style=&quot;position:absolute; &quot;&gt;
	&lt;img src=&quot;images/rightleaves.png&quot; style=&quot;position:absolute; right:0;&quot;&gt;
&lt;/div&gt;

    &lt;div id=&quot;passages&quot;&gt;&lt;/div&gt;
    &lt;div id=&quot;bottom-bar&quot;&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;div id=&quot;rightBar&quot;&gt;
&lt;/div&gt;


&lt;/div&gt;</tw-passagedata><tw-passagedata pid="528" name="StorySubtitle" tags="nobr" position="2825,200" size="200,100">&lt;&lt;if !tags().includes(&quot;intro&quot;)&gt;&gt;

&lt;hr&gt;

&lt;&lt;updateStats&gt;&gt;
&lt;&lt;set _fullness = Math.round($ful)&gt;&gt;
&lt;&lt;set _eaten = Math.round($ate + $inf)&gt;&gt;

Health- $hea/$maxHea
&lt;br&gt;
&lt;&lt;showmeter &quot;healthBar&quot;&gt;&gt;

&lt;&lt;if $hea &gt; 0&gt;&gt;
&lt;&lt;updatemeter &#39;healthBar&#39; `$hea / $maxHea`&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;updatemeter &#39;healthBar&#39; 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

Mana- &lt;&lt;print Math.floor($mana)&gt;&gt;/$maxMana
&lt;&lt;showmeter &quot;manaBar&quot;&gt;&gt;
&lt;&lt;updatemeter &#39;manaBar&#39; `$mana / $maxMana`&gt;&gt;

Fullness- _eaten/$sto (_fullness%)
&lt;&lt;showmeter &quot;fullBar&quot;&gt;&gt;
&lt;&lt;updatemeter &#39;fullBar&#39; `_eaten / $sto`&gt;&gt;

&lt;&lt;set _sta = Math.round($sta)&gt;&gt;
Stamina- _sta%
&lt;&lt;showmeter &quot;staminaBar&quot;&gt;&gt;
&lt;&lt;updatemeter &#39;staminaBar&#39; `$sta / 100`&gt;&gt;

&lt;hr&gt;

Strength- $str&lt;br&gt;
Agility- $agi&lt;br&gt;
Endurance- $end&lt;br&gt;
Intelligence- $int&lt;br&gt;

&lt;hr&gt;

&lt;&lt;if $alive and !$inCombat and !tags().includes(&quot;cutscene&quot;)&gt;&gt;
	&lt;&lt;popupButton &quot;Inventory&quot; &quot;Inventory&quot;&gt;&gt;&lt;br&gt;
	
	&lt;&lt;popupButton &quot;Key Items&quot; &quot;Key Items&quot;&gt;&gt;&lt;br&gt;
	
	&lt;&lt;popupButton &quot;Spells&quot; &quot;Spells&quot;&gt;&gt;&lt;br&gt;
	
	&lt;&lt;if $lvlUp &gt; 0&gt;&gt;
		&lt;&lt;popupButton &quot;Level up!&quot; &quot;Level up&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;popupButton &quot;Quests&quot; &quot;Quests&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;popupButton &quot;Status&quot; &quot;Status&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;popupButton &quot;Options&quot; &quot;Options&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;popupButton &quot;AI Settings&quot; &quot;AI Settings&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;popupButton &quot;Instructions&quot; &quot;Instructions&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="529" name="The test zone" tags="" position="1825,200" size="200,100">&lt;&lt;set _test = &quot;123@$#&lt;&quot;&gt;&gt;

&lt;&lt;if  /[^A-Z]/i.test(_test)&gt;&gt;
	Success?
&lt;&lt;/if&gt;&gt;

&lt;&lt;link &quot;Return to the wizard&quot; &quot;Manticore defeated&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="530" name="To do list" tags="" position="2575,200" size="200,200">--To Do--
storage
Update deranged waist diameter calculation
Add human?
Add crocodile
Add alert when an enemy defeats you through a stat hitting 0
Switch from breaks to paragraphs? 
Change how milk stand vendoring works. 
Give &quot;Rest&quot; it&#39;s own button? 
Fix gingerbread dialogue
Implement itemDescription widget 

--Refine--
Item stacking
Move &quot;item find&quot; to enemy ai passages
Move purchase restrictions to the confirmation part?
Better system for location label and enemy label
Remove weird skill checks from wolf event
Waist diameter calculation insane
Change strength description tiers?
Make book of crystals reuseable
Implement numOwned function?

--New things to do--
Smooth out enemy randomization
Unique rest areas
Restrict history if there&#39;s slowdown???
Store default variables like items in the java part if slowdown???
Add more descriptions
Fix clothes when you die so they can pop again
Scrub text inputs? May not matter???
Close stores at night?
Actually implement cabal/experiment town maps
Add starting clothes???
Flesh out rest areas</tw-passagedata><tw-passagedata pid="531" name="Victory" tags="nobr" position="4600,125" size="100,100">&lt;li&gt;__&#39;&#39;Victory!&#39;&#39;__&lt;/li&gt;


&lt;&lt;endCombat&gt;&gt;

&lt;&lt;if $e.xp &gt; 0&gt;&gt;&lt;&lt;doXP $e.xp&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.gld &gt; 0&gt;&gt;
	&lt;&lt;set _randomGold = random(($e.gld*0.8), ($e.gld*1.2))&gt;&gt;
	&lt;&lt;doGld _randomGold&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if random(1,100) &lt;= $e.itemChance and $e.item != &quot;&quot; and $e.item != null&gt;&gt;
	&lt;&lt;if $e.itemFound != undefined and $e.itemFound != &quot;&quot;&gt;&gt;
		$e.itemFound
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;getItem $e.item&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Quest advancements*/
&lt;&lt;if $e.name == $gorgedCheetah.name or $e.name == $bloatedLion.name&gt;&gt;
	&lt;&lt;advanceQuest $defendingTheHerd&gt;&gt;
&lt;&lt;elseif $e.name == $milkMachine.name&gt;&gt;
	&lt;&lt;advanceQuest $madMilk&gt;&gt;
&lt;&lt;elseif $e.name == $cheeseMonster.name&gt;&gt;
	&lt;&lt;advanceQuest $madCheese&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="532" name="What&#39;s your name" tags="intro" position="2450,850" size="100,100">&lt;&lt;textbox &quot;$name&quot; &quot;Hero&quot;&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Select gender&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="533" name="armor objects" tags="" position="3550,175" size="100,100">&lt;&lt;set $battlemagesGarb = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Battlemage&#39;s garb&quot;,
	name: &quot;battlemage&#39;s garb&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 100,
	defense: 4,
	mana: 10,
	description: &quot;This set of robes has inlaid plating, making it more defensive in combat, but slightly dampening its magical enchantments. &quot;,
	itemUse: &quot;You wrap the heavy robes around yourself and fasten the ties. Despite its simple appearance, you feel very well defended. &quot;
}&gt;&gt;

&lt;&lt;set $brutesHarness = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Brute&#39;s harness&quot;,
	name: &quot;brute&#39;s harness&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 350,
	defense: 3,
	stat: &quot;str&quot;,
	scaling: 0.15,
	description: &quot;A set of leather and metal armor emphasizing mobility over protection, this harness has been enchanted with the spirit of a hulking predator. &quot;,
	itemUse: &quot;You don the harness, and feel ready to smash the next thing that looks at you funny. &quot;
}&gt;&gt;

&lt;&lt;set $cabalDragonRobe = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Dragon Robes&quot;,
	name: &quot;Dragon Robes&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 1000,
	defense: 6,
	mana: 50,
	int: 20,
	agi: 20,
	str: 20,
	end: 20,
	description: &quot;This seemingly simple dark-brown robe doesn&#39;t appear to be special in any way, but when donned, it provides magical assistance of a level normally granted by those approaching the divine. Inside the cuff of the sleeves is an ornamentally stitched dragon, the only hint of its origin. &quot;,
	itemUse: &quot;You don the enchanted robes, and are almost overwhelmed as you sense the power of the robe seeping into every fiber of your being, making you feel almost megalomaniacally powerful! &quot;
}&gt;&gt;

&lt;&lt;set $chainmailArmor = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Chainmail armor&quot;,
	name: &quot;chainmail armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 30,
	defense: 3,
	description: &quot;A set of chain mail that covers your upper body. &quot;,
	itemUse: &quot;You slide the heavy set of interconnected metal rings over your head and let it fall over your body. &quot;
}&gt;&gt;

&lt;&lt;set $enchantedFighterArmor = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Enchanted fighter&#39;s armor&quot;,
	name: &quot;enchanted fighter&#39;s armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 500,
	defense: 5,
	agi: 13,
	description: &quot;A mixture of light plates and chainmail, this high-quality armor has been given an enchantment, increasing your speed and allowing you to stay flexible. &quot;,
	itemUse: &quot;You pull the armor on, piece by piece. The chain stretches over your joints, and the plates don&#39;t hinder you at all. When you have it all on, you feel significantly faster. &quot;
}&gt;&gt;

&lt;&lt;set $enchantedKnightArmor = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Enchanted knight&#39;s armor&quot;,
	name: &quot;enchanted knight&#39;s armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 500,
	defense: 8,
	str: 10,
	description: &quot;This gold-colored set of decorated armor will cover you from head to toe in magically enchanted interlocking plates, protecting you well and increasing your strength. &quot;,
	itemUse: &quot;You strap on the armor piece by piece, covering your limbs, head, neck, and $p.tail. When you finish, you feel safe and stronger. &quot;
}&gt;&gt;

&lt;&lt;set $enchantedWarmageArmor = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Enchanted warmage&#39;s armor&quot;,
	name: &quot;enchanted warmage&#39;s armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 500,
	defense: 4,
	mana: 30,
	int: 5,
	description: &quot;A rune-covered royal purple hooded robe and trousers trimmed with gold and sewn with light, protective plates in places. Its enchantment will improve your magical abilities. &quot;,
	itemUse: &quot;You don the garb, which is comfortable despite its increased bulk, and not even terribly gaudy for something a wizard would wear. When it&#39;s on, you can feel magic flowing more readily around you. &quot;
}&gt;&gt;

&lt;&lt;set $huntersGarb = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Hunter&#39;s garb&quot;,
	name: &quot;hunter&#39;s garb&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 350,
	defense: 3,
	stat: &quot;agi&quot;,
	scaling: 0.15,
	description: &quot;A dark, feathered set of leathers designed to blend into the jungle environment, this garb has been blessed with the spirit of a skulking predator. &quot;,
	itemUse: &quot;You don the garb, and get the strange urge to stalk small animals from the shadows. &quot;
}&gt;&gt;

&lt;&lt;set $leatherArmor = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Leather armor&quot;,
	name: &quot;leather armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 12,
	defense: 2,
	description: &quot;A set of ragged leather armor. &quot;,
	itemUse: &quot;You slip into the leather armor and adjust the straps appropriately. Doesn&#39;t seem very effective, but it&#39;s better than nothing. &quot;
}&gt;&gt;

&lt;&lt;set $mageApprenticeRobe = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Mage apprentice robe&quot;,
	name: &quot;mage apprentice robe&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 15,
	defense: 0,
	mana: 15,
	description: &quot;A set of mage&#39;s robes designed for a learning magic user. Made of comfortable cloth and imbued with a slight magical enchantment. &quot;,
	itemUse: &quot;You drape the robes down your body. You look rather silly but you can immediately feel the slightest tinge of power surging through you. &quot;
}&gt;&gt;

&lt;&lt;set $platemailArmor = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Platemail armor&quot;,
	name: &quot;platemail armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 187,
	defense: 6,
	description: &quot;A set of interconnected metal plates that cover your entire body. &quot;,
	itemUse: &quot;You take quite a while to put on the heavy pieces of plate mail and tighten all the straps as best you can. &quot;
}&gt;&gt;

&lt;&lt;set $segmentataArmor = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Segmentata armor&quot;,
	name: &quot;segmentata armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 125,
	defense: 5,
	description: &quot;A set of overlapping metal plates for your chest and shoulders, with a thick leather skirt to protect your lower body. &quot;,
	itemUse: &quot;You strap the armor to your chest and straighten the leather skirting to cover your legs. &quot;
}&gt;&gt;

&lt;&lt;set $splintArmor = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Splint armor&quot;,
	name: &quot;splint armor&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 75,
	defense: 4,
	description: &quot;A set of armor made from strips of metal sewn to leather backing. &quot;,
	itemUse: &quot;You take a while to put on all the pieces of armor and tighten all the straps as best as you can. &quot;
}&gt;&gt;

&lt;&lt;set $wizardsRobes = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Wizard&#39;s robe&quot;,
	name: &quot;wizard&#39;s robe&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	icon: &quot;armor&quot;,
	value: 65,
	defense: 2,
	mana: 25,
	description: &quot;An intricate and only fairly garishly colored robe that signifies one as a wizard. It is imbued with magical enchantments to make it more protective. &quot;,
	itemUse: &quot;You tie the thick robe around your waist, immediately feeling a tingling surge of power seeping from the robes into your body. &quot;
}&gt;&gt;</tw-passagedata><tw-passagedata pid="534" name="cast spell" tags="" position="1075,425" size="100,100">&lt;&lt;set $spellCast = setup.getSpell($spellCast)&gt;&gt;

&lt;&lt;if $inCombat&gt;&gt;
	&lt;li&gt;&lt;b&gt;Spell: &lt;&lt;icon $spellCast.icon&gt;&gt;$spellCast.Name&lt;/b&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;

/* FIXES AND EDITS - Display the name of the spell in out of combat casts */
&lt;&lt;if $inCombat == false&gt;&gt;
	&lt;&lt;setPopupTitle &quot;Cast: $spellCast.Name&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* FIXES AND EDITS - Let custom spells do their own cast messages */
&lt;&lt;if $spellCast.type != &quot;custom&quot;&gt;&gt;
	$spellCast.cast
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch $spellCast.type&gt;&gt;
	&lt;&lt;case &quot;buff&quot;&gt;&gt;
		&lt;&lt;switch $spellCast.effect&gt;&gt;
		&lt;&lt;case &quot;str&quot;&gt;&gt;
			&lt;&lt;if $tstr &gt;= $spellCast.damage&gt;&gt;
			But your strength has already been raised by magical means. 
			&lt;&lt;else&gt;&gt;
			&lt;&lt;tempBuff &quot;str&quot; $spellCast.damage&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;case &quot;agi&quot;&gt;&gt;
			&lt;&lt;if $tagi &gt;= $spellCast.damage&gt;&gt;
			But your agility has already been raised by magical means. 
			&lt;&lt;else&gt;&gt;
			&lt;&lt;tempBuff &quot;agi&quot; $spellCast.damage&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;case &quot;defense&quot;&gt;&gt;
			&lt;&lt;if $tdef &gt;= $spellCast.damage&gt;&gt;
			But your defense has already been raised by magical means. 
			&lt;&lt;else&gt;&gt;
			&lt;&lt;tempBuff &quot;defense&quot; $spellCast.damage&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;case &quot;dodge&quot;&gt;&gt;
			&lt;&lt;if $dodge &gt;= $spellCast.damage&gt;&gt;
			But your dodging has already been raised by magical means. 
			&lt;&lt;else&gt;&gt;
			&lt;&lt;tempBuff &quot;dodge&quot; $spellCast.damage&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;case &quot;regen&quot;&gt;&gt;	
			&lt;&lt;tempBuff &quot;regen&quot; $spellCast.time $spellCast.damage $spellCast.dRange&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
		
		
	&lt;&lt;case &quot;other&quot;&gt;&gt;
		/*Antidote is the only spell of this type so far*/
		
		&lt;&lt;removeStatus&gt;&gt;
		&lt;&lt;removeTempStatus&gt;&gt;
		&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
			Unfortunately, you feel your stomach returning to normal as well, and with as full as you are this proves to be very dangerous indeed. As you feel your stomach stretch tighter and tighter around it&#39;s contents, you find it harder and harder to stay concious as you&#39;re overwhelmed by fullness. 
			&lt;&lt;set $alive = false&gt;&gt;
			&lt;&lt;if !$inCombat&gt;&gt;
				&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
				&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		
	&lt;&lt;case &quot;attack&quot;&gt;&gt;
		&lt;&lt;spellDamage&gt;&gt;
		
		/* FIXES AND EDITS - Standardise effectiveness reporting */
		/*
		&lt;&lt;if $spellCast.dType != null&gt;&gt;
		  &lt;&lt;set _effective = 1&gt;&gt;
		  &lt;&lt;if $e.damageResistance != null&gt;&gt;
			  &lt;&lt;if $e.damageResistance.contains($spellCast.dType)&gt;&gt;
				  &lt;&lt;set _effective /= 1.5&gt;&gt;
			  &lt;&lt;/if&gt;&gt;
		  &lt;&lt;/if&gt;&gt;
		  &lt;&lt;if $e.damageWeakness != null&gt;&gt;
			  &lt;&lt;if $e.damageWeakness.contains($spellCast.dType)&gt;&gt;
				  &lt;&lt;set _effective *= 1.5&gt;&gt;
			  &lt;&lt;/if&gt;&gt;
		  &lt;&lt;/if&gt;&gt;
		  &lt;&lt;if _effective &gt; 1&gt;&gt;It&#39;s super effective! 
		  &lt;&lt;elseif _effective &lt; 1&gt;&gt;It&#39;s not very effective. 
		  &lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		*/
		
		&lt;&lt;reportEffectiveness $spellCast.dType &quot;enemy&quot;&gt;&gt;
		
		&lt;&lt;switch $spellCast.effect&gt;&gt;
		&lt;&lt;case &quot;burn&quot;&gt;&gt;
		&lt;&lt;if random(1,100) &lt; 25&gt;&gt;
			&lt;&lt;eBuff &quot;burn&quot; $spellCast.time&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;case &quot;slow&quot;&gt;&gt;
		&lt;&lt;if random(1,100) &lt; 30&gt;&gt;
			&lt;&lt;eBuff &quot;slow&quot; $spellCast.time&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;case &quot;stun&quot;&gt;&gt;
		&lt;&lt;if random(1,100) &lt; 20&gt;&gt;
			&lt;&lt;eBuff &quot;stun&quot; $spellCast.time&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;case &quot;soak&quot;&gt;&gt;
			&lt;&lt;eBuff &quot;soak&quot; $spellCast.time&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
		
		&lt;&lt;eDamage $dmg&gt;&gt;
		
		
	/* FIXES AND EDITS - Add debuff option */
	&lt;&lt;case &quot;debuff&quot;&gt;&gt; /* For cases where there&#39;s an effect, but not damage */
		&lt;&lt;switch $spellCast.effect&gt;&gt;
			&lt;&lt;case &quot;soak&quot;&gt;&gt;
				&lt;&lt;eBuff &quot;soak&quot; $spellCast.time&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;case &quot;heal&quot;&gt;&gt;
		&lt;&lt;spellDamage&gt;&gt;
		&lt;&lt;health $dmg&gt;&gt;
		&lt;&lt;if !$inCombat&gt;&gt;&lt;li&gt;//Health +$dmg//&lt;/li&gt;&lt;&lt;/if&gt;&gt;
	
/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;item&quot;&gt;&gt;
	&lt;&lt;set _item = $apple&gt;&gt;
	&lt;&lt;set _amount = 1&gt;&gt;
	
	&lt;&lt;if $spellCast.item != null&gt;&gt;
		&lt;&lt;set _item = State.getVar($spellCast.item)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $spellCast.amount != null&gt;&gt;
		&lt;&lt;set _amount = $spellCast.amount&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* `getItem` doesn&#39;t actually have a proper way of handling multiple items, so we&#39;ll do a workaround by cloning the item and manipulating the charges value */
	&lt;&lt;set _item = clone(_item)&gt;&gt;
	&lt;&lt;set _item.charges = _amount&gt;&gt;
	
	&lt;&lt;getItem _item&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
	
    /* FIXES AND EDITS - Add better custom spell support */
    &lt;&lt;case &quot;custom&quot;&gt;&gt;
    	&lt;&lt;if $spellCast.castPassage&gt;&gt;
        	&lt;&lt;include $spellCast.castPassage&gt;&gt;
        &lt;&lt;elseif $spellCast.castFunction&gt;&gt;
        	&lt;&lt;run setup[$spellCast.castFunction]($spellCast)&gt;&gt;
        &lt;&lt;else&gt;&gt;
        	&lt;&lt;include &quot;Custom Spell Logic&quot;&gt;&gt;
        &lt;&lt;/if&gt;&gt;
        
    
    &lt;&lt;default&gt;&gt;
		&#39;&#39;Error in &quot;cast spell&quot; $spellCast.Name&#39;&#39;
		
		
&lt;&lt;/switch&gt;&gt;

/*Spends mana (F&amp;E - and other resources)*/
/* FIXES AND EDITS - Let custom spells manage their own costs */
&lt;&lt;if $spellCast.type != &quot;custom&quot;&gt;&gt;
	&lt;&lt;run setup.consumeSpellCosts($spellCast)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $inCombat&gt;&gt;
    /* Log the spell&#39;s casting for recasting */
    &lt;&lt;set $lastCombatSpellCast = $spellCast&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* After casting, spell config is reset */
&lt;&lt;set $spellConfig = {}&gt;&gt;

&lt;&lt;updatePanels&gt;&gt;</tw-passagedata><tw-passagedata pid="535" name="cheat menu" tags="" position="3175,575" size="100,100">&#39;&#39;(Stats will update on next screen transition)&#39;&#39;&lt;br&gt;
Strength: &lt;&lt;numberbox &quot;$bstr&quot; $bstr&gt;&gt;&lt;br&gt;
Agility: &lt;&lt;numberbox &quot;$bagi&quot; $bagi&gt;&gt;&lt;br&gt;
Intelligence: &lt;&lt;numberbox &quot;$bint&quot; $bint&gt;&gt;&lt;br&gt;
Endurance: &lt;&lt;numberbox &quot;$bend&quot; $bend&gt;&gt;&lt;br&gt;
Stomach capacity: &lt;&lt;numberbox &quot;$bsto&quot; $bsto&gt;&gt;&lt;br&gt;
Health: &lt;&lt;numberbox &quot;$bmaxHea&quot; $bmaxHea&gt;&gt;&lt;br&gt;
Fatness: &lt;&lt;numberbox &quot;$fat&quot; $fat&gt;&gt;&lt;br&gt;
Gold: &lt;&lt;numberbox &quot;$gld&quot; $gld&gt;&gt;&lt;br&gt;</tw-passagedata><tw-passagedata pid="536" name="clothes objects" tags="" position="3550,300" size="100,100">&lt;&lt;set $bellyShirt = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Belly shirt&quot;,
	name: &quot;belly shirt&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 5,
	size: 18,
	description: &quot;More of a cloth tube you wear around your chest than a shirt, it shows of the wearer&#39;s belly, for better or for worse. &quot;,
	poppedDescription: &quot;More of a cloth tube you wear around your chest than a shirt, it shows of the wearer&#39;s belly, for better or for worse. &quot;,
	itemUse: &quot;You slide the \&quot;shirt\&quot; over you head and push it down under your armpits. You adjust it so it fits well around your chest. Lookin&#39; sexy! &quot;,
	tooSmall: &quot;You slide the \&quot;shirt\&quot; over you head, but you can barely get it under your armpits due to the size of your belly. &quot;,
	pop: &quot;Your fat gut has finally grown so large that the belly shirt has rolled up to being just a thin line around your chest. It&#39;s certainly showing off your belly, but not functioning much as a shirt. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $blueSwimTrunks = {
	Article: &quot;A pair of&quot;,
	article: &quot;a pair of&quot;,
	Name: &quot;Blue swim trunks&quot;,
	name: &quot;blue swim trunks&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 5,
	size: 20,
	description: &quot;A blue pair of stretchy elastic blue swim trunks designed for most normal sized furs. &quot;,
	poppedDescription: &quot;Despite your best efforts, the worn elastic swim trunks can only awkwardly cling to your thighs, making walking extremely awkward. &quot;,
	itemUse: &quot;You stick your legs through the leg holes and pull the swim trunks up around your waist, tightening the elastic band in the waist so it properly stay on. &quot;,
	tooSmall: &quot;You stick your legs through the leg holes and attempt to pull the swim trunks up around your waist, but the elastic just can&#39;t stretch around you properly no matter how hard you pull. The best you can do is to get them around your thighs, which doesn&#39;t exactly get the job done, so you put them back in your inventory. &quot;,
	pop: &quot;All of a sudden you feel your swim trunks start sliding down. Apparently the elastic waist band finally reached its limits and couldn&#39;t help but slide back down around your thighs to escape the growing sphere of your gut. Fortunately they still just barely keep you modest, but they&#39;re not doing their job of being pants very well. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $blueJeans = {
	Article: &quot;A pair of&quot;,
	article: &quot;a pair of&quot;,
	Name: &quot;Blue jeans&quot;,
	name: &quot;blue jeans&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 6,
	size: 10,
	description: &quot;A plain dark blue pair of denim pants. &quot;,
	poppedDescription: &quot;A plain dark blue pair of denim pants. The top button has popped off allowing your gut to sag down and making it quite hard to hold these pants up. &quot;,
	itemUse: &quot;You slide your legs into your pants, zip them up and close the button. Not very stylish, but at least they&#39;re durable. &quot;,
	tooSmall: &quot;You attempt to slide your legs into your pants, but can only barely get them past your thighs, let alone being able to zip them up. Sadly, you go back to what you were wearing before. &quot;,
	pop: &quot;With a sudden and forceful//pop!//, your jeans button pops off as you swollen gut expands outward, undoing your zipper as it goes. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $skirt = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Skirt&quot;,
	name: &quot;skirt&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 6,
	size: 10,
	description: &quot;A short satin skirt. &quot;,
	poppedDescription: &quot;A short satin skirt with several broken seams that make it very hard to keep your skirt on. &quot;,
	itemUse: &quot;You pull the skirt up around your waist and adjust it a bit. You do a little twirl because it seems like the thing to do. &quot;,
	tooSmall: &quot;You attempt to pull your skirt up around your waist, but your waist is now so large that you have no hope of wearing this skirt properly. Unfortunately, you have to go back to what you were wearing before. &quot;,
	pop: &quot;With a short, high-pitched //rrrrrip!// sound, several seams break loose on your skirt as your expanding gut proves to much for it to handle. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $buttonDownShirt = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Button down shirt&quot;,
	name: &quot;button down shirt&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 6,
	size: 8,
	description: &quot;A shirt with buttons down the front. &quot;,
	poppedDescription: &quot;A shirt with all the buttons popped off, leaving your belly hanging out. &quot;,
	itemUse: &quot;You slide your arms through the sleeves and button it down the front. Looking fancy! &quot;,
	tooSmall: &quot;You slide your arms through the sleeves and try to do the buttons, but try as you might, your belly is just too big for the buttons to reach. Dejectedly, you go back to what you were wearing before. &quot;,
	pop: &quot;With several sudden //pings!// the buttons of your shirt pop off one by one as your belly suddenly &#39;&#39;busts&#39;&#39; out of its restricting confines and slowly sags outward. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $dressGown = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Dress gown&quot;,
	name: &quot;dress gown&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 10,
	size: 5,
	description: &quot;A lovely and vibrant silk dress&#39;s top, silky smooth and glittering in the light. &quot;,
	poppedDescription: &quot;A formerly-lovely vibrant silk dress&#39;s top. There is a giant rip in the midsection. &quot;,
	itemUse: &quot;You don the delicate garment, buttoning up the back. You feel quite good in the luxurious silk. &quot;,
	tooSmall: &quot;You try to don the delicate garment, but the buttons refuse to meet in your back. Disappointed, you take it back off. &quot;,
	pop: &quot;With a soft ripping sound, your dress gown splits open, unable to contain your swelling belly! &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $dressSkirt = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Dress skirt&quot;,
	name: &quot;dress skirt&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 10,
	size: 8,
	description: &quot;A lovely and vibrant silk dress&#39;s skirt, silky smooth and glittering in the light. &quot;,
	poppedDescription: &quot;A formerly-lovely silk dress&#39;s skirt. Several seams have been torn and it is now an unwearable piece of attractive fabric. &quot;,
	itemUse: &quot;You put on the skirt. It clings nicely to your hips and glistens as you move about. &quot;,
	tooSmall: &quot;You try to put on the skirt, but the glistening fabric won&#39;t stretch around your thighs. Disappointed, you take it back off. &quot;,
	pop: &quot;There is the sound of thread snapping, and your dress skirt tears itself apart, unable to withstand the pressure of your growing belly! &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $overalls = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Overalls&quot;,
	name: &quot;overalls&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 12,
	size: 24,
	description: &quot;An XXL set of white bib overalls with a large pocket at the front. Perfect for the heavier-set labourer. &quot;,
	poppedDescription: &quot;The legs of the overalls cling tightly to your chunky thighs, but the ill-fitting \&quot;bib\&quot; doesn’t cover much of your belly any more, one strap burst, the other stretched tight over your gut, while your backside shows through a tear in the seat of your pants. &quot;,
	itemUse: &quot;You slip into the oversized overalls and cinch the braces to your size, the soft white material hugging your stomach and backside. Ok, they make you look \&quot;fat\&quot;, but they’re roomy and hard-wearing. &quot;,
	tooSmall: &quot;You squirm into the legs of the overalls, but strain as you might you just cannot pull them up over your backside and stomach, your belly repeatedly spilling over the top of them just when you’re trying to haul the braces up over your shoulders. With a sigh, you’re forced to accept that these XXL overalls just don’t come in your size. &quot;,
	pop: &quot;With an ominous creak you feel your overalls squeezing tightly around your backside. When you try to take a step forward the creak becomes a sharp &#39;&#39;RIP&#39;&#39; as the seat of your pants bursts open. This causes a ripple through to your belly, and more of your stomach bulges up over the \&quot;bib\&quot;. Burdened with too much to contain, one of the straps &#39;&#39;SNAPS&#39;&#39;, letting your stomach hang out even further on display. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $redSwimShirt = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Red swim shirt&quot;,
	name: &quot;red swim shirt&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	value: 5,
	size: 18,
	description: &quot;This swim suit is build for just about any normal sized being, with a lot of potential to stretch. It is red, long sleeved and conforms to body shape very well. &quot;,
	poppedDescription: &quot;Despite your best efforts to wear it, the swim shirt is just too small for your sizeable gut. The whole shirt has retreated towards your shoulders in order to escape from tearing. &quot;,
	itemUse: &quot;Pushing your arms through the stretchy material you slip on the shirt, dragging it down to your hips. You look about yourself, pleased that it fits you well. &quot;,
	tooSmall: &quot;You put your arms through the sleeves with a bit of trouble, but as you pull the shirt down, you face a real battle. After stretching and pulling, you don&#39;t think that the swim shirt will pull down far enough unless you tear it. Being unwilling to do that, you take off the swim shirt to save it from that demise. &quot;,
	pop: &quot;Your swim shirt has been getting noticably tighter as you&#39;ve been getting bigger. All of a sudden, the shirt rolls up your stomach, unable to keep itself down and leaving your belly exposed! &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $trousers = {
	Article: &quot;A pair of&quot;,
	article: &quot;a pair of&quot;,
	Name: &quot;Trousers&quot;,
	name: &quot;trousers&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 6,
	size: 5,
	description: &quot;Timeless pants for any occasion. Comfortable and flexible. &quot;,
	poppedDescription: &quot;Comfortable and flexible pants that have been ruined; the button is broken clean off. &quot;,
	itemUse: &quot;You pull the pants up about your legs. Simple and stylish. &quot;,
	tooSmall: &quot;You try to put the pants on, but you get as far as your huge thighs before being forced to give up. &quot;,
	pop: &quot;As your belly grow, the button snaps off your trousers, leaving them hanging loosely on your legs! &quot;,
	popped: false,
}&gt;&gt;


&lt;&lt;set $tropicalShirt = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Tropical shirt&quot;,
	name: &quot;tropical shirt&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 8,
	size: 10,
	description: &quot;A really bright and cheerful piece of tropical clothing, if not the most tasteful of garments. &quot;,
	poppedDescription: &quot;A really bright and cheerful piece of tropical clothing, if not the most tasteful of garments. The buttons all burst off, the open edges of the shirt flap uselessly against your sides, framing your belly between them. &quot;,
	itemUse: &quot;You slip your arms through the sleeves and with some fiddling manage to do all the buttons up over your chest and stomach. Not a bad fit, even if everyone will be able to see you coming about a mile off. &quot;,
	tooSmall: &quot;Your arms squeeze through the arm-holes, with a bit of persuasion, but suck it in as you might, the two edges of the shirt only just meet across your middle. You manage to get one straining button done up across your chest, but as you breathe out with relief it &#39;&#39;POPS&#39;&#39; open, causing a tidal-wave of belly to flop out. Shucks, it just won’t fit. &quot;,
	pop: &quot;With a ripping noise stitches across the back of your tropical shirt tear open, relieving the tension in the fabric a little, but not by enough. Groaning under the pressure, the buttons burst open, one by one, until your belly eventually &#39;&#39;FLUMPS&#39;&#39; out of the open front. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $tunic = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Tunic&quot;,
	name: &quot;tunic&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 6,
	size: 8,
	description: &quot;A plain old white tunic. Mostly worn by the common folk. &quot;,
	poppedDescription: &quot;A plain old white tunic with a large tear down the front, leaving your belly exposed. &quot;,
	itemUse: &quot;You slide the tunic over your head and put your arms through the short sleeve. You fiddle with the laces at the neck of the shirt, but they appear to be purely decorative. &quot;,
	tooSmall: &quot;You slide the tunic over your head, but can&#39;t get it any farther than your gut. Try as you might, you can&#39;t quite get the tunic over your oversized belly. Disappointed, you go back to what you were wearing before. &quot;,
	pop: &quot;You hear a small tearing sound that slowly turns into a loud ripping as you gut finally tears free from your confining tunic, having grown too large to be held back anymore. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $tuxedoJacket = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Tuxedo Jacket&quot;,
	name: &quot;tuxedo jacket&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 10,
	size: 7,
	description: &quot;A bright white tuxedo shirt with matching pitch black tuxedo jacket. It even comes with a clip-on bow tie. Extremely fancy looking! &quot;,
	poppedDescription: &quot;A bright white tuxedo shirt with all the buttons popped off and a matching pitch black tuxedo jacket. You don&#39;t look vary fancy with your belly hanging out for all to see. &quot;,
	itemUse: &quot;You slide on the tuxedo shirt and do up all the buttons before sliding on the jacket. You adjust your cuffs and attach your clip-on tie. &quot;,
	tooSmall: &quot;You slide on the tuxedo shirt and try to do the buttons, but try as you might, your belly is just too big for the buttons to reach. Dejectedly, you go back to what you were wearing before. &quot;,
	pop: &quot;With a sudden //ping!//, one of your fancy shirt button goes flying off. As you watch it sail away in confusion, several other //pings!// are heard as your bulging belly surges out through the gaps left by the flying buttons. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $tuxedoPants = {
	Article: &quot;A pair of&quot;,
	article: &quot;a pair of&quot;,
	Name: &quot;Tuxedo pants&quot;,
	name: &quot;tuxedo pants&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	icon: &quot;pants&quot;,
	value: 10,
	size: 8,
	description: &quot;A pitch black pair of tuxedo pants. Very classy. &quot;,
	poppedDescription: &quot;A pitch black pair of tuxedo pants with all the fancy buttons popped off, allowing your gut to sag outward freely. Not very classy. &quot;,
	itemUse: &quot;You slide your legs into your tuxedo pants and do up the discreetly hidden buttons on the front. &quot;,
	tooSmall: &quot;You attempt to slide your legs into your pants, but can only barely get them past your thighs, let alone being able to close up the buttons. Unfortunately, you have to go back to what you were wearing before. &quot;,
	pop: &quot;With several small //pop pop pop&#39;s// the buttons of your fancy tuxedo pants pop off one by one, unable to hold back the tide of your growing belly. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $vest = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Vest&quot;,
	name: &quot;vest&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	icon: &quot;shirt&quot;,
	value: 6,
	size: 5,
	description: &quot;A button-up sleeveless vest as stylish as it is armless. &quot;,
	poppedDescription: &quot;You are wearing a sleeveless vest. All the buttons have popped off, so it hangs loosely off your chest. &quot;,
	itemUse: &quot;You don the vest. Bare arms never looked better. &quot;,
	tooSmall: &quot;You try to put on the vest, but the sides can&#39;t get around you all the way, let alone the buttons meeting. You take it back off in dismay. &quot;,
	pop: &quot;Your vest&#39;s buttons pop off one by one as you outgrow the tight bit of fabric! &quot;,
	popped: false,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="537" name="combat actions" tags="nobr" position="4175,450" size="100,100">&lt;&lt;if $inCombat and $stun &lt;= 0&gt;&gt;

/*Actions useable while not grappled*/
&lt;&lt;if $grapple &lt;= 0&gt;&gt;
/* FIXES AND EDITS - Reimplement combat stamina loss */
&lt;&lt;set _showAttackOption = true&gt;&gt;
&lt;&lt;set _staminaPerAttack = Math.abs(setup.staminaCost(-3))&gt;&gt;

&lt;&lt;if $options.combatStamina &gt;= 2 and _staminaPerAttack &gt; $sta&gt;&gt;
	&lt;&lt;set _showAttackOption = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _showAttackOption == true&gt;&gt;
  &lt;&lt;action &quot;nw&quot; &quot;attack&quot; &quot;Attack&quot; &quot;Combat&quot;&gt;&gt;
      &lt;&lt;set $action = &quot;Attack&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* FIXES AND EDITS - Alter Devour option availability */
&lt;&lt;if setup.shouldShowDevour($e) == true &gt;&gt;
  &lt;&lt;action &quot;w&quot; &quot;devour&quot; &quot;Devour&quot; &quot;Combat&quot;&gt;&gt;
      &lt;&lt;set $action = &quot;Devour&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;n&quot; &quot;inventory&quot; &quot;Items&quot; &quot;combat inventory&quot; true&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;ne&quot; &quot;spells&quot; &quot;Spells&quot; &quot;Combat Spells&quot; true&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $e.runnable != false&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;run&quot; &quot;Run&quot; &quot;Combat&quot;&gt;&gt;
	&lt;&lt;set $action = &quot;Run&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*Quest actions*/
&lt;&lt;if $e.name == $lemonSlime.name&gt;&gt;
	&lt;&lt;if setup.questActive($slimeQuest2) and setup.numOwned($lemonSlimeItem) == 0&gt;&gt;
		&lt;&lt;action &quot;s&quot; &quot;inventory&quot; &quot;Capture&quot; &quot;Combat&quot;&gt;&gt;
			&lt;&lt;set $action = &quot;Capture&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if setup.questActive($slimeQuest3) and setup.numOwned($lemonSlimeItem) + setup.questStage($slimeQuest3) &lt; $slimeQuest3.goal&gt;&gt;
		&lt;&lt;action &quot;s&quot; &quot;inventory&quot; &quot;Capture&quot; &quot;Combat&quot;&gt;&gt;
			&lt;&lt;set $action = &quot;Capture&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $e.name == $blueberrySlime.name&gt;&gt;
	&lt;&lt;if setup.questActive($slimeQuest4) and setup.numOwned($blueSlimeItem) == 0&gt;&gt;
		&lt;&lt;action &quot;s&quot; &quot;inventory&quot; &quot;Capture&quot; &quot;Combat&quot;&gt;&gt;
			&lt;&lt;set $action = &quot;Capture&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if setup.questActive($slimeQuest5) and setup.numOwned($blueSlimeItem) + setup.questStage($slimeQuest5) &lt; $slimeQuest5.goal&gt;&gt;
		&lt;&lt;action &quot;s&quot; &quot;inventory&quot; &quot;Capture&quot; &quot;Combat&quot;&gt;&gt;
			&lt;&lt;set $action = &quot;Capture&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Actions useable while grappled*/
&lt;&lt;else&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Struggle&quot; &quot;Combat&quot;&gt;&gt;
	&lt;&lt;set $action = &quot;Struggle&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;sw&quot; &quot;wait&quot; &quot;Wait&quot; &quot;Combat&quot;&gt;&gt;
	&lt;&lt;set $action = &quot;Wait&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;se&quot; &quot;surrender&quot; &quot;Submit&quot; &quot;Combat&quot;&gt;&gt;
	&lt;&lt;set $action = &quot;Submit&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;elseif $inCombat and $stun &gt; 0&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;no&quot; &quot;Stunned!&quot; &quot;Combat&quot;&gt;&gt;
	&lt;&lt;set $action = &quot;Stunned&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="538" name="combat inventory" tags="" position="1325,550" size="100,100">/*Creates inventory links*/
&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;

	&lt;&lt;capture _i&gt;&gt;
		&lt;&lt;if $inventory[_i].icon != null&gt;&gt;
			&lt;&lt;icon $inventory[_i].icon&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;icon &quot;inventory&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _title = $inventory[_i].Name&gt;&gt;
		
		&lt;&lt;if $inventory[_i].stack &gt; 0&gt;&gt;
			&lt;&lt;set _title +=&quot; x&quot;+$inventory[_i].stack&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;link _title &quot;Combat&quot;&gt;&gt;
			&lt;&lt;set $action = &quot;Item&quot;&gt;&gt;
			&lt;&lt;set $itemUsed = $inventory[_i]&gt;&gt;
			&lt;&lt;run Dialog.close();&gt;&gt;
		&lt;&lt;/link&gt;&gt;
        
        /* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $options.feeder_expansionEnabled and $inCombat and $e.feedable&gt;&gt;
		&lt;&lt;if $inventory[_i].effect == &quot;Eat&quot; or $inventory[_i].feedable&gt;&gt;
				 [ 
				&lt;&lt;link &quot;Feed&quot; &quot;Combat&quot;&gt;&gt;
						&lt;&lt;set $action = &quot;Feed&quot;&gt;&gt;
						&lt;&lt;set $feeder_itemFed = $inventory[_i]&gt;&gt;
						&lt;&lt;set $feeder_fedAmount = $inventory[_i].eat&gt;&gt;
						&lt;&lt;run Dialog.close();&gt;&gt;
				&lt;&lt;/link&gt;&gt;
				 ] 
		&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
		&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="539" name="combat script" tags="nobr" position="4175,325" size="100,100">/*===Executes combat events based on input action===*/
&lt;&lt;switch $action&gt;&gt;


/*===Does nothing for the first round of combat===*/
&lt;&lt;case &quot;&quot;&gt;&gt;


/*===Player attack script===*/
&lt;&lt;case &quot;Attack&quot;&gt;&gt;
	/*Player attacks first*/
	&lt;&lt;if $agi + $int &gt;= $e.agi + $e.int or $e.slow &gt; 0&gt;&gt;
	  &lt;&lt;include &quot;player attack&quot;&gt;&gt;
	  &lt;&lt;if $inCombat and $e.hea &gt; 0&gt;&gt;
		  &lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	/*Enemy attacks first*/
	&lt;&lt;else&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
		&lt;&lt;if $alive and $grapple &lt;= 0 and $e.hea &gt; 0 and $inCombat&gt;&gt;
			&lt;&lt;include &quot;player attack&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;/if&gt;&gt;


/*===Player struggle script===*/
&lt;&lt;case &quot;Struggle&quot;&gt;&gt;
  &lt;li&gt;&#39;&#39;Struggle&#39;&#39;&lt;/li&gt;

  &lt;&lt;set _stat = $str&gt;&gt;
  &lt;&lt;if $agi &gt; _stat&gt;&gt;&lt;&lt;set _stat = $agi&gt;&gt;&lt;&lt;/if&gt;&gt;
  &lt;&lt;if $int &gt; _stat&gt;&gt;&lt;&lt;set _stat = $int&gt;&gt;&lt;&lt;/if&gt;&gt;
  &lt;&lt;set $grapple -= _stat&gt;&gt;

  &lt;&lt;if $grapple &lt;= 0&gt;&gt;
	  &lt;&lt;set $grapple = 0&gt;&gt;
	  &lt;&lt;enemyAction &quot;grapple succeed&quot;&gt;&gt;
  &lt;&lt;else&gt;&gt;
	  &lt;&lt;enemyAction &quot;grapple fail&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;


/*===Player vore script===*/
&lt;&lt;case &quot;Devour&quot;&gt;&gt;
	&lt;li&gt;&#39;&#39;Devour&#39;&#39;&lt;/li&gt;
	/*Vore attempt succeeds*/
	&lt;&lt;if setup.skillTestRange($agi+$str+$int+50, $e.agi+$e.str+$e.int+($e.hea*0.5), 0, 90)&gt;&gt;
		&lt;&lt;enemyAction &quot;vore&quot;&gt;&gt;
	
	/*Vore attempt fails*/
	&lt;&lt;else&gt;&gt;
		You lunge at your enemy in an attempt to swallow $npc1.him, but $npc1.he&#39;s too &lt;&lt;if $e.agi &gt; $agi&gt;&gt;fast for you and manages to dodge out of the way. &lt;&lt;elseif $e.str &gt; $str&gt;&gt;strong for you and manages to wrestle free from your grasp. &lt;&lt;elseif $e.int &gt; $int&gt;&gt;smart for you and manages to out maneuver you. &lt;&lt;else&gt;&gt;lucky for you and you miss your grab. &lt;&lt;/if&gt;&gt;
	  &lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;


/*===Player spellcasting script===*/
&lt;&lt;case &quot;Cast&quot;&gt;&gt;
	/*Player attacks first*/
	&lt;&lt;if $agi + $int &gt;= $e.agi + $e.int or $e.slow &gt; 0&gt;&gt;
	  &lt;&lt;include &quot;cast spell&quot;&gt;&gt;
	  &lt;&lt;if $inCombat and $e.hea &gt; 0&gt;&gt;
		  &lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	/*Enemy attacks first*/
	&lt;&lt;else&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
		&lt;&lt;if $alive and $grapple &lt;= 0 and $e.hea &gt; 0 and $inCombat&gt;&gt;
			&lt;&lt;include &quot;cast spell&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;/if&gt;&gt;
	

/*===Player item script===*/
&lt;&lt;case &quot;Item&quot;&gt;&gt;

	/*Player acts first*/
	&lt;&lt;if $agi + $int &gt;= $e.agi + $e.int or $e.slow &gt; 0&gt;&gt;
		&lt;&lt;include &quot;combat use item&quot;&gt;&gt;
	  	&lt;&lt;if $inCombat and $e.hea &gt; 0&gt;&gt;
			&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
	 	&lt;&lt;/if&gt;&gt;
	
	
	/*Enemy attacks first*/
	&lt;&lt;else&gt;&gt;
		&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;
		&lt;&lt;if $alive and $grapple &lt;= 0 and $e.hea &gt; 0 and $inCombat&gt;&gt;
			&lt;&lt;include &quot;combat use item&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	


/*===Player run script===*/
&lt;&lt;case &quot;Run&quot;&gt;&gt;
	&lt;&lt;if setup.skillTestRange(25+$agi+$int, $e.agi+$e.int, 10, 75)&gt;&gt;
		&lt;&lt;enemyAction &quot;run succeed&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;enemyAction &quot;run fail&quot;&gt;&gt;	
	&lt;&lt;/if&gt;&gt;


/*===Player wait script===*/
&lt;&lt;case &quot;Wait&quot;&gt;&gt;
  &lt;li&gt;&#39;&#39;Wait&#39;&#39;&lt;/li&gt;
  You stop to catch your breath. 
  &lt;&lt;stamina 15&gt;&gt;
  &lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Player stunned script===*/
&lt;&lt;case &quot;Stunned&quot;&gt;&gt;
  &lt;li&gt;&#39;&#39;Stunned!&#39;&#39;&lt;/li&gt;
  You were too stunned to act! 
  &lt;&lt;set $stun--&gt;&gt;
  &lt;&lt;if $stun &lt;= 0&gt;&gt;
  	&lt;i&gt;You finally shake off the effects of the stun though.&lt;/i&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Player submit script===*/
&lt;&lt;case &quot;Submit&quot;&gt;&gt;
  &lt;&lt;enemyAction &quot;submit&quot;&gt;&gt;
  
  
/*===Player Quest scripts===*/
&lt;&lt;case &quot;Capture&quot;&gt;&gt;
	&lt;&lt;enemyAction &quot;capture&quot;&gt;&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;case &quot;Feed&quot;&gt;&gt;
	/* Because of some wonkiness with how I&#39;ve set this up, player always goes first with feed attempts */
	
	&lt;&lt;enemyAction &quot;feed&quot;&gt;&gt;
/* FEEDER EXPANSION EDIT - END */
/*===Error script===*/
&lt;&lt;default&gt;&gt;
  &#39;&#39;(Error in combat script)&#39;&#39;

&lt;&lt;/switch&gt;&gt;


/*===Combat status effects===*/
&lt;&lt;if $alive&gt;&gt;&lt;&lt;include &quot;status effects&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;



/*===Adds extra hr to bracket combat actions===*/
&lt;&lt;if $action != &quot;&quot;&gt;&gt;&lt;hr&gt;&lt;&lt;/if&gt;&gt;


/*===Resolves events based on player/enemy states===*/
&lt;&lt;updateStats&gt;&gt;
/*If enemy died*/
&lt;&lt;if $e.hea &lt;= 0 and $alive and $inCombat&gt;&gt;
	&lt;&lt;endCombat&gt;&gt;
	&lt;&lt;enemyAction &quot;victory&quot;&gt;&gt;

/*If you died*/
&lt;&lt;elseif !$alive and $inCombat&gt;&gt;
	&lt;&lt;enemyAction &quot;defeat&quot;&gt;&gt;

/*If both are alive*/
&lt;&lt;elseif $alive and $inCombat&gt;&gt;
&lt;&lt;include &quot;combat actions&quot;&gt;&gt;

/* FIXES AND EDITS - Reimplement combat stamina loss */
&lt;&lt;set _staminaPerAttack = Math.abs(setup.staminaCost(-3))&gt;&gt;

&lt;&lt;if $options.combatStamina &gt;= 2 and _staminaPerAttack &gt; $sta&gt;&gt;
	&lt;i&gt;You feel too tired to raise your $wea.name&lt;/i&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="540" name="combat use item" tags="" position="1450,550" size="100,100">&lt;&lt;if $inCombat&gt;&gt;
	&lt;li&gt;&lt;b&gt;Item: $itemUsed.Name&lt;/b&gt;&lt;/li&gt;
&lt;&lt;/if&gt;&gt;

/*Loads dialog based on item effect*/
&lt;&lt;switch $itemUsed.effect&gt;&gt;
&lt;&lt;case &quot;Eat&quot;&gt;&gt;&lt;&lt;include &quot;eat&quot;&gt;&gt;
&lt;&lt;case &quot;Equip&quot;&gt;&gt;&lt;&lt;include &quot;equip&quot;&gt;&gt;
&lt;&lt;case &quot;other&quot;&gt;&gt;&lt;&lt;include &quot;use&quot;&gt;&gt;
&lt;&lt;case &quot;quest&quot;&gt;&gt;
__&#39;&#39;$itemUsed.Name&#39;&#39;__&lt;br&gt;
$itemUsed.description

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in combat use item!&#39;&#39;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="541" name="describe general" tags="" position="3500,600" size="100,100">&lt;&lt;switch $p.him&gt;&gt;	
	&lt;&lt;case $female.him&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a nearly weightless body with neither health not vigour to boast. Your airy build is highly polarizing to people you encounter, who either consider you a paragon of feminine beauty or an unfortunate victim of a particularly vicious diet. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a lean, toned and flexible body of an outgoing $p.boy. It&#39;s difficult for others to fault your vitality but your lack of volume in traditionally feminine areas makes it easy to discount your gender altogether. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a decidedly athletic constitution lacking any superfluous weight. It&#39;s not unheard of to encounter a $p.man so strong and resilient, although such an appearance of physical accomplishment in someone so unlikely makes people - especially the males - wary and intimidated. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an immaculatly sculpted body of a warrior princess, superbly muscled and devoid of fat. The reaction that your appearance tends elicit from those who surround you is either cautious fear or cheers of adoration. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have an ordinary body with somewhat pleasant features, but your lack of exercise or fresh air is evident as well. Folks around your tend to regard you as being on the cute side of homely, and don&#39;t mind your presence. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an fit and flexible body of an outgoing $p.boy who isn&#39;t afraid to act on her ambitions - especially if it involves exciting activities or travel. Most young men and a number of &lt;&lt;print $p.boy&gt;&gt;s as well find both your swift, measured motions intensely entrancing, and even the rest are comfortable to have someone light-footed still waltzing through the ranks of the increasingly portly populace of this land. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a decidedly athletic constitution that glow with lush vigour and stamina despite lacking any external pudge. It would have been intimidating for some to come across a $p.gentleman of such powerful stature if your feminine features weren&#39;t so well-pronounced and attention-gripping. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a gloriously built, burly body that is the picture of paramount athletic success and proportionately distributed brawn. It is a veritable one-person martial parade when you plod down the streets of any town, and many people automatically assume you to be a military leader or someone of equal authority and capability. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a somewhat curvaceous figure, but it would be a far cry to call you fat - rather, every surface of your body is delicately and finely enhanced with results of hearty meals past. Your peers don&#39;t hesitate to include you in their enterprises, although being mindful of your self-evident distaste for physical activity. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a capable and resourceful body, with a fashionable little of extra weight evenly distributed among its features. You find a degree of admiration wherever you turn, either for your adventerous spirit and energy, or for your pleasant proportions. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a powerful and nimble frame that is subtly softened in some places and given additional volume in others. Folk around you are often prone to oogling your strong, statueque, yet inescapably feminine constitution. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an excellently trained and developed physique that is given a bit of tenderness by the softer contours that people who reach such breathtaking athletic heights can seldom afford to keep. Some of the more conservative-minded of the friendly folks you can encounter in the unforgiving wilderness have a hard time aligning in their minds your excellent survival skills with your somewhat plush bodily texture, but the rest express humbled and honoured attitude to your presence. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a flossy plump figure, untouched by hard work or deprivations of long journey, making the challenges of dabbling in those matters uncomfortably arduous. People around you are often friendly and accepting of your presence, especially if you agree to share a dining table with them. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a reasonably full figure, but the rounder curves don&#39;t do much to impede your vigorous lifestyle even if the tone of your muscles remains concealed. Strangers and acquaintances alike consider themselves fortunate to share your company, eager to enjoy your vim and your healthy looks. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a decently filled-out body that has been rendered firm and maneuverable by an arduous and adventerous lifestyle. People in your vicinity are often surprised by the displays of power and grace that your ostensibly plush frame is capable of, and there are few situations where you cannot either make your strengths profitably useful or garner popularity by conversing over a full plate and foaming tankard. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a thickset constitution owing most of its girth to the great metallic might that evidences itself unmistakably despite the noticeable padding of your frame. Those who find themselves in your festively conspicuous presence are eager to accept your protection and authority should you choose to take charge, and your curvaceousness is seldom left uncomplimented by the more audacious folks. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a generously replete body that lends profoundly to the naturally prominent areas of $p.male physique, but lacks the vigour to support that slpendor properly. In a social setting, you are welcome, admired and appreciated, but the life of physical exertion would seem to be an uncooth absurdity for someone like you. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a plushly pudgy body that is, oddly enough, more fit and flexible than those of less encumbered &lt;&lt;print $p.boy&gt;&gt;s. Those leading a more indolent lifestyle are often taken aback by your bouts of energetic activity, and people of action don&#39;t think less of your abilities for the bouncy quality of your movements. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a seasoned, strong body that is also richly enough padded to exaggerate every forceful movement with a bit of delayed fleshy feedback. Though you tend to mingle around leaner, more athletic types, both the squishy townspeople and the hardened wilderness explorers recognize your ability and strive to be the ones sitting beside you around the fire. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a thick, powerful physique of an accomplished athlete that still remains downy to the touch, and your unstoppable charges and dashing evasive rolls appear even more impressive for the volume-enchancing keepsakes of old ample meals dancing in time with the action. Unless you&#39;re too far removed from civilization or being discreet, there is always an audience gathering to see your fights and your feasts, and you tend to finish both with more friends and admirers than you started with. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a profoundly plump, heavyset body that, despite proudly displaying outstanding curves, is visibly burdensome for you to move around. Most often you are perceived as matronly and good-tempered, and on occassions receive caring advices to avoid unnecessary exertion. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a body as well-fed and filled out as decency allows while still remaining energetic and flexible, although the limits of your mobility are significantly diminished. Ladies of your constitution often cannot keep up with you, and your willinglness to take up physical challenges makes fitter people disregard your chubby looks as a source of prohibitive encumberance; however, your pleasantly portly looks are always a welcome decoration of a merry evening feast. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a fairly fat body with more than enough power under all the supple layers to compensate for the supefluous weight, even if it trades litheness for greater force. More often than not your generous proportions leave your unfortunate foes and travel companions aghast at how little they drag you down in quickly unravelling situations, but you would never refuse an hour of resting and feasting by the fire after an arduous and fighting-intensive venture. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a phenomenally burly frame with an abundance of flab softening and firming parts of you, but it&#39;s a well-balanced arrangement that prevents you from being viewed as overtly angular or flabby. Folks from all walks of life are thrilled to be bask in the confidence and stalwart power you weave with your posture alone; after all, a dame that has evidentally been able to acquire such might without the effort stripping her of lush gravitas is a natural object of admiration. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a thoroughly well-fed, lush constitution with ample curves making up the most of you, and the lack of appropriately intensive exercise needed to account for that luxuriant build is made evident whenever you face physical challenges. Those you meet and interact with seldom fail to adopt an ingratiating tone, suspecting that a person of your weight and bearing absolutely must be someone to be reckoned with, although many shift into a more familiar attitude soon after. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a thoroughly well-fed, lush constitution with ample curves making up the most of you, and while the lack of appropriately intensive exercise need to account for that luxuriant build is made evident whenever you face physical challenges, you do have some untapped resources for mobility. Those you meet and interact with seldom fail to adopt an ingratiating tone, suspecting that a person of your weight and bearing absolutely must be someone to be reckoned with, although many shift into a more familiar attitude soon after. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a more than generously filled-out body, but it&#39;s quite obvious that not all of your thickness had come from good eating, if only by the firmness and confidence of your movements. Wherever you go, the sheer size of you and your adroitness in handling it makes the local populace see an authority that naturally puts you in charge of handling any crises if such should arise, no matter the severity thereof. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a body remarkably rich in both muscle and fat, and although the latter tends to hide the former most of the time, it&#39;s your unwavering fortitude of stance and the force of moves that introduce you as a $p.gentleman of action first, and a voluptuous gourmand dame second. The attitude towards you tends to be that of admiration and deference with a hint of judicious wariness, since your formidable athleticism insinuates its way through the tender layers of your dignified looks a little too strongly. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a profoundly portly body swimming with expansive convexities and sloshing bulges, and all that flesh starts to quake and shiver at the slightest turn or jolt, requiring a constant vigil over your posture to avoid a noisy collapse. People in your vicinity often lend you their respect as well as curiosity, aware of how much it must have cost to attain and maintain such a grand physique, although your laborious motions and shortness of breath attracts some sympathetic glances as well. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a profoundly portly body swimming with expansive curves and thick folds, and all that flesh starts to quake and shiver at a slightest turn or jolt, requiring a constant vigil over your posture to avoid a noisy collapse, and you never fail to keep it. People in your vicinity often lend you their respect as well as curiosity, aware of how much it must have cost to attain and maintain such grand physique, although your laborious motions lead them to conjecture that you don&#39;t belong with the adventuring lot. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an inordinately corpulent body with sloping protrusions given to wobbling and undulating at the changes of their momentum, but you are in definite control over setting your path. Friends and miscellaneous townfolk find your heavy frame to be both a sign of prosperity and social class, and you are never refused a hearty smile and a reverential bow, and even beyond the city gates your massive stature is a beacon of security for those seeking shelter. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a stout body with a clear feel of might and potency to your stance and martial prowess, made all the more impressive for the billowing rotund bulk of excess weight that you manage to keep in check, with the exception of harmless rippling and quivering after each dash or swing. In the social scene of any town you visit, your hardy confidence and determination in conjunction with your mass are quick to earn you a reputation of a mother figure to the entire community, making people flock to you for advice, protection and recipe consultations. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have the body of a lifelong glutton that is given most of its voluminous definition by firm and bountiful layers of fat rather then bones or muscle, and it takes all of your strength and focus to combat the wild swings of the more bulging parts of you that any drastic movement entails. Seeing as the most prominently well-fed folks around tend to be either successful gastronoms and combatants or savoury morsels for the countryside&#39;s numerous predators, your difficulties in managing the weighty baggage of your loose flesh engender sympathy and protective attitude in those around you, although in safer settings behind the city walls you are often treated as a goddess of plenty and a paragon of epicurean living. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have the body of a lifelong glutton that is given most of its voluminous definition by firm and bountiful layers of fat rather then bones or muscle, and it takes most of your strength and focus to combat the wild swings of the bulging parts of you that any drastic movement entails. Seeing the most prominently well-fed folks around tend to be either successful gastronoms and combatants or savoury morsels for the countryside&#39;s numerous predators, your shortcomings in managing the weighty baggage of your loose flesh properly engender sympathy and protective attitude in those around you, although in safer settings behind the city walls you are often treated as a goddess of plenty and a paragon of epicurian living. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an immensely fat constitution with abounding, lush curves dancing with delicate ripples and forceful quivering on the rare occasions you are forced to move quickly, but the very fact of you being capable of such bouts despite the obvious hindrance speaks volumes about the strength your round supple surfaces hide. Those you have dealings with are usually inclined to give any request or inquiry of yours top priority, recognizing how your corporeal weight reflects that of your experience in life, your confident bearing and expansive presence further cementing your authority and securing further admiration. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an outstandingly corpulent frame, its vast rounded surfaces firmed with grandiose fat deposits and plenty of harder flesh that gives you laboured, yet precise control of your rotund body in and out of the sweat-wringing efforts in craft or combat. It is hard to overstate how noticeable you are in a crowd, and since due to the recent history of the region that crowd can be composed almost exclusively of strapping or blubbery denizens, that is saying something, and you in all your fleshy, yet firmly powerful glory are an obvious go-to person for grim emergencies and lavish revelries both. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have an amazingly blubbery frame that represents the degree of obesity that a small gathering of self-indulgent gourmands couldn&#39;t hope to match even if put together, and there is so much swing in your lushly fleshed protuberances and even the thick coating of pudge closer to your miserably sapless muscle and bones that you can barely move without compromising your balance and losing your breath altogether. Your appearance becomes the talk of whatever town you choose to waddle in, and although even those who&#39;d had time to get used to the rampant corpulence of the folks of these parts occasionally treat you to a bewildered stare, the gravity of your clearly harmless form most often warrants a warm welcome bordering on a massive celebration. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an amazingly blubbery frame that represents the degree of obesity that a small gathering of self-indulgent gourmands couldn&#39;t hope to match even if put together, and there is so much swing in your lushly fleshed protuberances and even the thick coating of pudge closer to your unfortunately outmassed muscle and bones that you can barely move without compromising your balance and losing your breath altogether. Your appearance becomes the talk of whatever town you choose to waddle in, and although even those who&#39;d had time to get used to the rampant corpulence of the folks of these parts occasionally treat you to a bewildered stare, the gravity of your clearly harmless form most often warrants a warm welcome bordering on a massive celebration. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an amazingly blubbery frame that represents the degree of obesity that a small gathering of self-indulgent gourmands couldn&#39;t hope to match even if put together, and there is so much swing in your lushly fleshed protuberances and even the thick coating of pudge closer to your marginally adequate muscle and bones that you can barely move without compromising your balance and losing your breath altogether. Your appearance becomes the talk of whatever town you choose to waddle in, and although even those who&#39;d had time to get used to the rampant corpulence of the folks of these parts occasionally treat you to a bewildered stare, the gravity of your clearly almost harmless form most often warrants a warm welcome bordering on a massive celebration. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a breathtakingly corpulent body, furnished with blubber to a degree that it takes a dozen seconds to for all its rolling curves to stop sloshing about after you&#39;ve come to a halt from a slow stroll, and yet there is a suspicious hardiness to your posture and movements that a great deal of hidden brawn could be inferred from. Around the city premises, your heavy steps often serve as a call for all sorts of sincere admirers and ingratiating sycophants, and your girthy form&#39;s confidence of bearing means that even the most chivalrous of disposition don&#39;t hesitate to hide behind your expansive back when the alarm bells ring. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a constitution so prodigiously saturated with blubber that in a frighteningly likely event of losing your balance through carelessness or excruciating exhaustion, the fall itself would be mercifully quick and amply cushioned, seeing as your lower body&#39;s opulent deposits of heaving flesh are never too far away from the ground, although there would still be the prolonged and nearly impossible quest for regaining leverage and rising again to undertake. Many unfamiliar folks find themsleves too overwhelmed by your rampantly fattened form to approach, instead preferring to warily study from afar with concern and pity in their stares, but the more flexibly-minded and aware individuals rush to greet and offer their services to you, realizing that in this realm, every pound of trembling fatty flesh that a person can accrue without getting waylaid by a crafty predator or burning it off at the gymnasium is worth its weight in gold, and by that standard you must be the most affluent and powerful $p.gentleman in the vicinity. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a constitution so prodigiously saturated with blubber that in a likely event of losing your balance through carelessness or excruciating exhaustion, the fall itself would be mercifully quick and amply cushioned, seeing as your lower body&#39;s opulent deposits of heaving flesh are never too far away from the ground, although there would still be the prolonged and hellishly rigorous quest for regaining leverage and rising again to undertake. Many unfamiliar folks find themsleves too overwhelmed by your rampantly fattened form to approach, instead preferring to warily study from afar with concern and wonder in their stares, but the more flexibly-minded and aware individuals rush to greet, offer their services to you, realizing that in this realm, every pound of trembling flesh that a person can accrue without getting waylaid by a crafty predator or burning it off at the gymnasium is worth its weight in gold, and by that standard you must be the most affluent and powerful $p.gentleman in the vicinity. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a constitution so prodigiously saturated with blubber that in a consistently avoided event of losing your balance through unforeseen heave of a blubbery hip or an excruciating exhaustion, the fall itself would be mercifully quick and amply cushioned, seeing as your lower body&#39;s opulent deposits of heaving flesh are never too far away from the ground, although there would still be the prolonged and arduous quest for regaining leverage and rising again to undertake. Many unfamiliar folks find themsleves too overwhelmed by your rampantly fattened form to approach, preferring instead to warily study from afar with concern and wonder in their stares, but the more flexibly-minded and aware individuals rush to greet, offer their services to you, realizing that in this realm, every pound of trembling flesh that a person can accrue without getting waylaid by a crafty predator or burning it off at the gymnasium is worth its weight in gold, and by that standard you must be the most affluent and powerful $p.gentleman in the vicinity. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a staggeringly blubbery form so full of the the proudly worn keepsakes of unbridled gluttony that in some towns your hips graze walls on both sides of alleys wide enough to admit two-horse carriages, and the loose flesh galore that your frame reluctantly, but diligently supports, swings in complex and expansive arcs that are still not enough to throw your hardy body off balance. Your adventuring comrades in arms are proud to have a veritable war machine among their ranks, and your mellower town contacts always site your visits as a manifold blessing and an exalted honour, while those who have yet to earn your trust make a point of getting out of your way with all possible alacrity or humbly cheering you on from the sidelines. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a body boasting uncharted levels of obesity that far outclasses the physique of even the most well-insulated bestial denizens of the cold north, serving as the ultimate proof that there is no limit to how fat someone can get these days, and every aspect of your constitution is so engorged with lard and sprawling out so far from your bones and muscles that some of the most ponderously sagging features of yours outright ignore slight changes in your stance, remaining inert and only jiggling lightly; when you do sway your entire glorious bulk into action by exerting yourself to the point of bitter anguish, there isn&#39;t a part of you that remains untouched by the stormy undulations of flesh adding even more unbearable strain to your frame. Although the recent mysterious developments have made fuller physiques commonplace, the magnitude of your bountiful fleshiness leaves most of your new acquaintances shaking their heads in disbelief or gazing with rapt adoration, and while your perpetually exhausted appearance puts some at ease, it doesn&#39;t change the fact that you only ever get addressed by a stranger on rare occassions and in a nervous, overtly polite manner. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a body boasting uncharted levels of obesity that far outclasses the physique of even the most well-insulated bestial denizens of the cold north, and every aspect of your constitution is so engorged with lard and sprawling out so far from your bones and muscles that some of the most ponderously sagging features of yours outright ignore slight changes in your stance, remaining inert and only jiggling lightly; when you do sway your entire glorious bulk into action by exerting yourself to the point of drained exasperation, there isn&#39;t a part of you that remains untouched by the stormy undulations of flesh adding even more unbearable strain to your frame. Although the recent mysterious developments have made fuller physiques commonplace, the magnitude of your bountiful fleshiness leaves most of your new acquaintances shaking their heads in disbelief or gazing with rapt adoration, and while your frequently exhausted appearance puts some at ease, it doesn&#39;t change the fact that you only ever get addressed by a stranger on rare occassions and in a nervous, overtly polite manner. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a body boasting uncharted levels of obesity that far outclasses the physique of even the most well-insulated bestial denizens of the cold north, and every aspect of your constitution is so engorged with lard and sprawling out so far from your bones and muscles that some of the most ponderously sagging features of yours outright ignore slight changes in your stance, remaining inert and only jiggling lightly; when you do sway your entire glorious bulk into action by exerting yourself to the point of surly discontent, there isn&#39;t a part of you that remains untouched by the stormy undulations of flesh adding even more unbearable strain to your frame. Although the recent mysterious developments have made fuller physiques commonplace, the magnitude of your bountiful fleshiness leaves most of your new acquaintances shaking their heads in disbelief or gazing with rapt adoration, and while the sight of your grittily laborious movements engenders respect in some, it doesn&#39;t change the fact that you only ever get addressed by a stranger on rare occassions and in a nervous, overtly polite manner. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a body more befitting of a great sea leviathan than a $p.gentleman - massive and bulging with convex, curving and folding surfaces that fill even the most cavernous of confined spaces, and need little encourgement to launch into a fluid dance of wobbling fatness; while one might consider such portliness incompatible with active lifestyles, the unflinching determination of your heaving movement is indicative of the hidden titanic fortitude of your bloated form. Since you&#39;ve gone far beyond the boundaries of what even the most morbidly obese people should look like, it is understandably problematic for the townfolk to accept you as one of their own, but they are more then willing to applaud and praise you as an exceptional entity, especially since its quite clear that any friends of yours would be guaranteed both paramount degree of protection and - judging by your apparent appetite - an exclusive dining club membership. 

				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
		
	&lt;&lt;default&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a wretchedly underfed and unexercised physique. People feel their nurturing instinct triggering when they happen upon you, insisting that you eat something and stop making everyone feel uncomfortable with your coat-hanger frame. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a thin body that has nevertheless met some physical challenges, and is quite fit and energetic as a result. Overweight people striving to shape up are looking up to your efficient and pragmatic constitution, but are discouraged from following in your footsteps by the telltale rugged wiriness of a low-intake athlete. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a strong body with plenty of muscle on your bones, without a single suggestion of idle flesh. You are a model of selfless self-improvement, a likely candidate for any exercise-intensive tasks and an intimidating presense to anyone used to resolving their issues with brute force alone. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have the magnificent body of a mighty warrior or a legendary craftsman. The bulk of tangled, rippling, yet bewilderingly lean muscle that you bear so lightly is enough to put anyone in awe, whether it&#39;s a friend, a foe or even a wild beast. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have an inconspicuous, slim physique. People hardly ever notice you in the crowd, although with the recent shifts in the definition of being mundanely proportioned, your meager form may make a few round-cheeked heads turn. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an fit, agile build of a person leading an active life and benefiting from healthy food rationing that gives your frame a subtle gloss without furnishing it with any noticeable surplus flesh. Country folk of both genders find your vivacious springy form easy on the eyes, and there is a world of adventuring and social opportunity for someone of your build. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a burly body with plenty of trained flesh on your bones that naturally assumes a posture that accentuates this brawn and a lack of loose weight to obscure it. You are an example of what a male should aspire to be physically, and your peers look up to you and do their best to avoid getting on your bad side. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a spectacularly trained body that would have befitted a deity reigning over war, labor or hunt. The sheer bulky brawn that your constitution boasts is a radiant beacon of might that common folk are quick to flock to for protection and guidance. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a throughly healthy body of someone who hasn&#39;t been skipping his meals often, although it might also have been due to an indolent lifestyle. Your appearance, being soft and nonthreatening, has a way of putting others at ease, and you seldom encounter adversity when looking for work around the town or attending a feast thrown by a local noble. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a lush, healthy body brimming with vitality, evident of both an active lifestyle and a splendid appetite. People find you pleasant to be around, whether the occasion is a scouting foray or a dining soiree. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a strong, well-fed body that enhances its already admirable brawny volume with consequences of a frequent hearty meals. While most pay respects to your obvious physical prowess, you don&#39;t come off as overtly intimidating due to the contours of your hard muscles having softer outlines. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a staggeringly mountainous body, rendered so grand and solid by hard work and effort, and perfected by your partiality to an occasional epic feast. Even in the most worldly towns desensitized to curios, your visit is an event to remember, and although you are an obvious threat, the soft gloss you sport on top of your brawn dispells some of those concerns. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a mellow, slightly pudgy body, with no significant strength to even out the added weight, leaving you out of your depth when labor and fleetness of feet are needed. The way you look tends to leave others well-disposed towards you, not expecting any wrong-doing from someone so fluffy, and appreciating your apparent ability to indulge your appetites. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a body that is on a bit on a heavy side, but has seen a lot of exercise and firmed up where necessary. People you meet are quick to propose their camaraderie, sensing an active and jovial person in their new acquaintance. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a very powerful body with some superfluous weight that you can clearly afford to carry around. Wherever you go, you are met with ample cheerful greetings and respectful bows of the common folk who can appreciate your mighty and well-fed appearance the best. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a heavily built body, profoundly muscled after over a life of journeys, battles and training and quite well-padded courtesy of all the banquets you&#39;ve attended. Your stout frame commands respect and turns away any unwelcome attentuion of shady folks, although the softer appearance leaves the door open for friendly chitchat with the decent kind of people. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a quite fleshy body ideal for filling loose clothes or lounging on a sofa, but ill-equipped for menial chores and amateur warfare. The more peaceful citizenry that you come across tend to regard you with gracious amity, acknowledging your very apparent ability to keep yourself well-fed and away from the dangerous and bothersome life outside the walls. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a robust body that is richly flabby around the edges, but firm and energetic in its base, representing a workable arrangement between a challenging, outgoing life and a proclivity for plentiful dining. Even the much thinner acquaintances of yours who cherish their slim builds give credit to how little your heavier frame slows you down. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a pudgy and thickset body developed through a balanced combination of heavy meals and hard exercise. The folk you bump into always greet you with courtesy, and depending on your mood either pester your with banquet invitation and friendly gossip, or stay well out of your way. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a powerful body that has thick, mighty muscle coexisting peacefully with soft flab. Even despite the significant squishiness to your constitution, people only need one look to realize that this well-fed fellow has enough solid force at his disposal to put them through a brick wall if they&#39;re not careful, but they mostly like you sincerely anyway. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a full-formed, fat body with uncannily fortunate proportions that give you a dignified look, even if your usual slack posture does suggest a deficiency of bodily challenges in your life. Your appearance most commonly draws respect and cordiality, although it would be difficult for you to apply for any of the more physical professions without getting treated to a lot of skepticism. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a superbly well-fed constitution, and every part of you is so well padded as to become firm, although you are clearly unafraid of testing the limits of your endurance. Although you are usually pigeonholed as a person of leisure at the start, people who get to know you better soon become aware of the lively pace you adopt in everything you do. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a very pudgy body that still has a suspicious ease of movement and firmness of frame that betray the highly exercised and toned flesh beneath. People are equally ready to include you into their evening gorging festivities or to ask you for a bit of help with heavylifting or subduing an unruly tipsy miscreant. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a tremendously stout build, although the amount of softer flesh that you carry around does smoothen and soften the awesome display of physical development that your body would have otherwise presented. Both the spoiled townsfolk and hardy adventurers envy your splendid balance of jovial robustness and heroic brawn, and it&#39;s uncommon for you to be appointed of momentous enterprises for your looks alone. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have the exceedingly fleshy build of a voracious gourmand, and its heaving mass takes its toll on everything you do, be it escaping a robbery or putting on trousers. Your acquaintances and even complete strangers often treat you like a lifelong comrade from the get go, for your weighty presence serves as a reassuring pillar of certainty in a tumultuous world, while your laborious breathing and bearing attracts sympathy. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have the exceedingly fleshy build of a voracious gourmand, and its heaving mass takes its toll on everything you do, although in a pinch you are capable of admirable bursts of activity. Your acquaintances and even complete strangers often treat you like a lifelong comrade from the get go, for your weighty presence serves as a reassuring pillar of certainty in a tumultuous world. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a burly constitution with a great abundance of idle weight pulling you down, but you bear yourself in a way that suggests physical prowess to match your size. Those who meet you for the first time often inquire if your talents lie in the fields of luxury cuisine or metalcraft, since you look the type, but never in an obnoxiously cheeky manner. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a bulky body haunted by the ghosts of the grand banquets of old, but the overall sturdy girth of your frame drops enough clues about what kind of power lies buried underneath. Although you could easily pass for a townsperson of indolence behind the heavily-laden restaurant table, it&#39;s just too much trouble to restrain your might to preserve meek appearances, and your peers often get treated to displays of strength that make them lavish admiration and respect on you accordingly. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have an excessively corpulent body that needs a few seconds to stop trembling and shaking in the wake of each movement, and constantly threatens to leave you sprawled on the ground whenever you forget to account for the inertia of all the loose weight. Even among the big eaters and fabled layabouts of the town scene, you are regarded as the fat one, but given the recent developments in the world, such title is bestowed more in good humour and admiration than out of contempt. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an excessively corpulent body that needs a few seconds to stop trembling and shaking in the wake of each movement, and often threatens to leave you sprawled on the ground whenever you forget to account for the inertia of all the loose weight, but you have a few tricks up your sleeve when it comes to keeping balance. Even among the big eaters and fabled layabouts of the town scene, you are regarded as the fat one, but given the recent developments in the world, such title is bestowed more in good humour and admiration than out of contempt. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a body marverlously rich in doughy flesh, boasting wide curves and thick folds, and its only through your mastery of managing that bulging, wobbling abundance that your formidable brawn is revealed. Your burly, rounded dimensions stand out on the wild trail more than behind the table of a diner at the edge of town, but even in the safer havens your bulk draws curiosity and admiring glances. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an imposingly heavyset constitution burdened with layers upon layers of fat that make it difficult to control the way your softer parts behave, but the mighty fimness at the core asserts itself through the confidence of your bearing. Any crowd you find yourself mingling always treats you to a plenty of intrigued attention, and people part to let you pass at the slightest suggestion of your path intersecting their current position, preferring to orbit and shadow you instead of risking getting trampled. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a lavishly obese body that takes a great effort to motivate, and an even greater deal of exertion to stop, and you are so intensely filled out that your wide, rolling curves have become almost solid to the touch. You have a way of wrapping people&#39;s attention and discussion subjects around yourself without making an effort, and they often show you as much veneration as if your were as wealthy in gold as you are in bodily splendor, although you often hear good-natured jabs at your heftiness. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an unapologetically obese body that takes great effort to motivate, and just as much strain to stop, and you are so intensely filled out that your wide, rolling curves have become almost solid to the touch. You have a way of wrapping people&#39;s attention and discussion subjects around yourself without making an effort, and they often show you as much veneration as if your were as wealthy in gold as you are in bodily splendor, although on occassion you do hear an odd good-natured jab at your heftiness. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an unstintingly blubbery frame with its horizontal dimensions challenging the vertical ones, and even though the labored heaving that accompanies your movement puts a fine point on how undeniable your mass is, you face the challenges it throws your way with mettle and resolve. You are known for filling up space around you even when outdoors, and like a fountain in the middle of the town square, the citizenry find your whereabouts to be a splendid point of congregation, and you&#39;re never in a want for an audience or gossip venues. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a supremely fleshy body that implies in the subtlest of ways the profound strength being concealed within, although it&#39;s nigh impossible for the less perceptive to recognize that by looking at your bloated form with rolling waves disturbing its smooth curvature every now and again. The rest quickly catch on to the clues, and many of those you meet are at a loss whether they should dread or cheer you, especially when they get a glimpe of the paradoxial agility and power of your by all rights tremendously overweight frame. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a body that is massively overweight even by the lax local standards, with each blubbery fold and swelling on your frame seemingly having a mind of its own when you set your oppressive bulk in motion, which is a dreadfully difficult task in itself, your grossly inadequate level of fitness considering. You are the one who people point to when they need to explain to a foreigner the effect the recent burgeoning abundance had on the folks around here, and although a good number of people are still willing to approach and have dealings with you, regarding your grand physique as a mark of living one&#39;s life to the full, many others seem to get overtly concerned for your well-being, or becoming downright disturbed by such extravagant appearance. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a body that is massively overweight even by the lax local standards, with each blubbery fold and swelling on your frame seemingly having a mind of its own when you set your oppressive bulk in motion, which is a dreadfully difficult task in itself, your inadequate level of fitness considering. You are the one who people point to when they need to explain to a foreigner the effect the recent burgeoning abundance had on the folks around here, and although a good number of people are still willing to approach and have dealings with you, regarding your grand physique as a mark of living one&#39;s life to the full, many others seem to get overtly concerned for your well-being. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a body that is massively overweight even by the lax local standards, with each blubbery fold and swelling on your frame seemingly having a mind of its own when you set your oppressive bulk in motion, which is a quite difficult task in itself, your severely lacking level of fitness considering. You are the one who people point to when they need to explain to a foreigner the effect the recent burgeoning abundance had on the folks around here, and although a good number of people are still willing to approach and have dealings with you, regarding your grand physique as a mark of living one&#39;s life to the full, many others seem to get overtly concerned for your well-being, although these worries are quick to melt away in the face of your astoundingly fleet degree of mobility for someone who shouldn&#39;t be able to move at all. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have the immensely obese constitution of someone who eats for a living while sprawled on the softest and toughest of royal beds, and yet the deeply seated physical power earned through torturous training and harsh experiences allows you to fracture everyone&#39;s expectations of you to be an embodiment of sloth. Be it around the campfire during a journey or in a crowded dining hall, people strive to secure your amicable disposition towards them and maybe even protection, but only the bravest venture too near you, considering the popular stereotype of cannibalistic gluttons matching your burly, bloated appearance perfectly. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a body that is so profoundly obese that it would be more accurate to describe it as an immense accumulation of blubber with a person trapped inside it, and although you retain the ability to move, it is always entails a catastrophic display of jiggling folds, rippling curves and heavy breathing, and the dreadful prospect of collapsing looms over your body in the same way your body does over everyone else. Strangers stop to gape in awe at the first glimpse of your enormity, and even your close ones often get distracted midsentence by the fascinating sight of constantly shifting and rearranging flesh, but in the end both tend to cope with their amazement by changing their perception of you to that of a mysterious mythical creature or a spawn of some magical mishap, and dote upon your borderline helpless form out of kindness or superstitious awe. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a body that is so profoundly obese that it would be more accurate to describe it as an immense accumulation of blubber with a fit person trapped inside it, and although you retain the ability to move, it is always entails a catastrophic display of jiggling folds, rippling curves and heavy breathing, and the dreadful prospect of collapsing looms over your body in the same way it does over everyone else. Strangers stop to gape in awe at the first glimpse of your enormity, and even your close ones often get distracted midsentence by the fascinating sight of constantly shifting and rearranging flesh, but in the end both tend to cope with their amazement by changing their perception of you to that of a sentient mythical creature or a magical mishap&#39;s result, and dote upon your overburdened form out of kindness or superstitious awe. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a body that is so profoundly obese that it would be more accurate to describe it as an immense accumulation of blubber with a capable person trapped inside it, and although you retain the ability to move, it is always entails a catastrophic display of jiggling folds, rippling curves and heavy breathing, and the dreadful prospect of collapsing can never be entirely ruled out. Strangers stop to gape in awe at the first glimpse of your enormity, and even your close ones often get distracted midsentence by the fascinating sight of constantly shifting and rearranging flesh, but in the end both tend to cope with their amazement by changing their perception of you to that of a sentient mythical creature or a magical mishap&#39;s result, and dote upon your arduosly struggling form out of kindness or admiration. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an increadibly ponderous physique, with every part of your body greatly distended with thickly compressed fat, and although it is difficult to imagine such a bloated body out there in the wilderness, there is an unmistakable confidence in your bearing that could make any doubting party reconsider dismissing you as a pampered butterball. While both within and without the city walls you are regarded as something of a unique phenomenon far beyond being merely an obese person, and ascertaining your friendiness is an immediate priority for any local leadership unused to the sight of you, people are a quick to recognize their oddly-proportioned champion and cheer him on with all the befitting courtesy and generosity. 

				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You inhabit a form so drastically blown out of proportion by your history of unrestrained culinary hedonism that it dwarfs caravan carts fully loaded for a distant journey; it is only vaguely recognizable as a person&#39;s body, with its grandiose cascading folds and bulges overlapping and flowing into each other to further the difficulty of discerning limb from limb, and the sight of your bodily overabundance being set into motion by excruciatingly pained effort is blood-curdling even for the stoutests of heart. Even the folks who have witnessed their share of bizarre things in this world get overwhelmed by your oppressive vastness waddling about in a menacingly unsteady manner, and although few dare approaching you with ill intent, even the more decent folk only ever show you horrified trepidation or uncomprehending worship, and precious few bring themselves hobnob with an entity so vividly evoking the tales of ritualistically fattened offerings to the giant voracious beasts and demons. 

					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You inhabit a form so drastically blown out of proportion by your history of unrestrained culinary hedonism that it dwarfs caravan carts fully loaded for a distant journey; it is only vaguely recognizable as a person&#39;s body, with its grandiose cascading folds and bulges overlapping and flowing into each other to further the difficulty of discerning limb from limb, and the sight of your bodily overabundance being set into motion by pained effort is blood-curdling even for the stoutests of heart. Even the folks who have witnessed their share of bizarre things in this world get overwhelmed by your oppressive vastness waddling about in an eerily unsteady manner, and although few dare approaching you with ill intent, even the more decent folk only ever show you horrified trepidation or uncomprehending worship, and precious few bring themselves to treat an entity of such formidable presence with any degree of familiarity. 

					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You inhabit a form so drastically blown out of proportion by your history of unrestrained culinary hedonism that it dwarfs caravan carts fully loaded for a distant journey; it is only vaguely recognizable as a person&#39;s body, with its grandiose cascading folds and bulges overlapping and flowing into each other to further the difficulty of discerning limb from limb, and the sight of your bodily overabundance being set into motion by grittily concentrated effort is awe-inspiring even for the stoutests of heart. Even the folks who have witnessed their share of bizarre things in this world get overwhelmed by your oppressive vastness waddling about in a barely controlled way, and although few dare approaching you with ill intent, even the more decent folk only ever show you horrified trepidation or uncomprehending worship, and precious few bring themselves to treat an entity of such formidable presence with any degree of familiarity. 

					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a truly terrifying build comparable to that to the largest of beasts, to the point of having to squeeze gently through the widest city gates, although the incontestable majority of your magnificent mass is comprised of unfathomably thick layers of wobbling blubber; however, the unfazed manner in which you steer this massively bloated form gives a well-founded impression of your body being less of a prison, and more of an unassailable, astonishingly mobile fortress of flesh. People seldom socialize with you casually, intimidated beyond all wit by the implications of having such an avatar of corpulence and gluttony around, but party leaders and town officials approaching you with deferential ceremony is something of a common occurrence to you, and your own instances of addressing people never fail to guarantee their enthralled attention. 

				&lt;&lt;/switch&gt;&gt;

	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="542" name="describe legs" tags="" position="3900,600" size="100,100">&lt;&lt;switch $p.him&gt;&gt;
	&lt;&lt;case $female.him&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You move in an uncertain amble, and your rickety legs have barely prominent calves and pitiably underfed thighs. Your legs are feebly built, making you prone to stumbling and making even the most harmless stretches of journeying unwelcome and trying experiences.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You walk with brisk determination, and your briskly agile legs have starkly muscled calves and toned, narrow thighs. Your legs are clearly capable of impressive gymnastic feats, and make you already airy frame appears capable of soaring in the air when you move quickly.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You travel at a steady, confident pace, and your superbly trained legs have ornamentally muscled thighs and calves sturdy as rock. Your legs are as formidably strong as they are agile, and their heightened mobility rivals your inexhaustible stamina.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You readily choose a foot journey over a caravan ride, used as you are to prolonged arduous travel, and your outstandingly built legs are lean-fleshed, solid-thighed and gnarly-calved. Your legs are a perfect compromise between being excessively muscular and gymnastically mobile, and are more than capable of leaving even a mounted pursuit soaped and winded without even breaking a sweat.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a cautious townsperson&#39;s gait, and your slim, leisure-spoiled legs have untoned calves and tender narrow thighs. Your only have the overall modest weight of your body for their apparent quickness, and are in fact the reason you tend to start longing for a soft chair after anything more than a short stroll.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You walk with a sense of purpose and grace, and your fleet and springy legs have firm calves and toned lean thighs. Your legs are the definition of acrobatic litheness, and suggest their owner to be an accomplished runner or dancer.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You travel at a steady, confident pace, and your strong, shapely legs have muscle-hardened calves, well-developed thighs, are as formidably strong as they are agile and graceful. Your legs hold the strength and vigour surpassing those of your male athlete counterparts, and allow for easy and time-efficient adventuring on the wild side.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You readily choose a foot journey over a caravan ride, used as you are to prolonged arduous travel, and your grandiosely muscled legs have iron calves and meaty thighs. Your legs are second to none in terms of stamina and force they are capable of exerting, and permit you find your way around the deadliest of treasure-bearing loci, and make a speedy retreat across the same landscape with the loot jingling in the sack behind your back.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You walk at a leisurable townsperson&#39;s pace, and your shapely legs have calves that are soft to the touch and rounded thighs slightly lacking in their firmness. Your legs don&#39;t lack in vitality, but are deficient in tone, and often compel you to seek an easier path far removed from risks and challenges.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You move with a sense of purpose and grace, and your vivacious legs are firm-calved and healthy-thighed. Your legs always thirst for a quick dash or a measured jog, exhibiting a subtle voluptuous bounce and swagger to their gait even when strolling, and are nimble enough to get you in, through or out of the fight.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You travel at a steady, confident pace, and your exuberantly springy legs have athletic calves and enviably well-developed thighs. Your legs are muscular enough to guarantee an advantage of heightened mobility and superior balance, even though the richness of their texture allows a subtle lively jiggle accompany their motions.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You readily choose a foot journey over a caravan ride, used as you are to prolonged arduous travel, and your pillar-like legs have magnificently sculpted calves and powerful thighs that are still somewhat lushly fleshed. Your legs show unsurpassed mastery of equilibrium both in motion and holding your ground, and are ever ready to leave any challenge trampled underfoot.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You step gingerly, striving not to lose your balance due to an errant sway of the hip, and your weak legs have doughy calves and somewhat portly thighs. Your legs aren&#39;t much for facilitating adventuring in remote, hazard-riddled places, and their lackluster tone is prohibitive of any sort of travel other than a brief promenade across familiar, cultivated terrain.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You move along with an effortless voluptuous swagger, and your surprisingly limber legs have firm, plump calves and fairly strong thighs that are tender to the touch. Your legs may not be on top of their game as far as fitness goes, but they still allow many acrobatic options that few would expect from someone so fluffy-looking.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You traverse the land with vigorous jiggle accompanying your steady, confident march, and your stalwart legs have thick calves and well-developed thighs that require a good poke to reach the hard muscle. Your legs are brimming with vim and carry you and your burdens switfly along, coming to your aid in resolving hostilities as well opening new ways of traversing uneven landscapes.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You take on a road with a surefooted pace of a stout traveller prepared for anything, and your gloriously powerful legs have robust calves and strong, thick thighs that are also generously softened. Your legs lend you a dazzling degree of endurance, power and stability, and carry their modest chubbiness like a badge of honor - in addition to giving motion to the rest of your habitually hefty hauls from daring adventures.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You step gingerly, striving not to lose your balance due to an errant sway of the hip, and your clumsy legs have tender, flabby calves and generously plump thighs that lightly rub together when you walk. Your legs have trouble maintaining a steady pace even on a paved, even ground for more than a few minutes at a time.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You move along with an effortless voluptuous swagger, and your vigorous and robust legs have firm, yet pudgy calves and sizable thighs that lightly rub together when you walk. Your legs don&#39;t stumble easily or tire quickly unless sprinting is involved, circumventing their hefty inhibitions by tricks of leverage and balance.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You traverse the land with vigorous jiggle accompanying your steady, confident march, and your tempered legs have robust calves and generously fleshy, but also very athletic thighs that lightly rub together when you walk. Your legs give you splendid sprinting speed, a tenacity of travel, and provide you with a powerful stance and efficient footwork in combat.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You take on a road with a surefooted pace of a stout traveller prepared for anything, and your luxuriantly built legs have firm, meaty calves, and mightly, but sparingly-padded thighs that lightly rub together when you walk. Your legs neatly eliminate balance and leverage from the list of your outdoors hazard-managing concerns, and they also permit any acquired weight to be dragged along with impunity - including the weight accrued from the overtly nutritious dinners.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You step gingerly, striving not to lose your balance due to an errant sway of the hip, and your easily exhaustable legs have chubby calves and remarkably fleshy thighs that grind together quite a bit when you saunter about. Your legs are shamefully underwhelming in terms of bearing properties and constitute a major inconvenience whenever your schedule includes quick jog or a prolongued stretch of trundling.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You move along with an effortless voluptuous swagger, and your moderately exercised legs have plump calves and fleshy thighs that grind together quite a bit when you saunter about. Your legs may lack the weightless alacrity of your younger slimmer self, but they get you to your destination eventually through all the obstacles and confrontations, nevermind the amount of panting exacted by the exploit once you get there.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You traverse the land with vigorous jiggle accompanying your steady, confident march, and your robustly strong legs have splendidly developed, healthy calves and heavily muscled and pudgy thighs that grind together quite a bit when you saunter about. Your legs are molded after the standards of heavyweight athleticism, and guarantee your a firmly grounded stance and a hard kick to your foes, even if the finer gymnastic feats are a little more tricky to undertake.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You take on a road with a surefooted pace of a stout traveller prepared for anything, and your divinely potent legs have meaty calves and thoroughly plump, but powerful thighs that grind together quite a bit when you saunter about. Your legs treat their added girth and mass as a thrilling challenge rather than a sever hindrances, and can give your burdened form such an unstoppable momentum that very few onlookers would fail to be left amazed, and the same goes for the spectacular grace of your sway-intensive combat maneuvers.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Waddling at an ailing pace, you radiate unhurried indolence and dread the thought of a wobbling, breathless spectacle you get reduced to whenever there is an urgency of travel, and your pampered legs have overtly flabby calves and blubbery thighs that squash together forcibly as you proceed forward. Your legs are dragging your down in the most literal sense to the extent that even climbing a few sets of stairs becomes an arduous exploit, and always long for the comfort of a soft-cushioned bed by the fireplace.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Resigning yourself to the constant struggle against the contradictory jostles of your gorgeously filled-out curves, you brave your way towards the distant goal regardless, and your heavily built legs have very flabby calves and pillow-like thighs that squash together forcibly as you proceed forward. Your legs are dragging your down in the most literal sense to the extent that even climbing a few sets of stairs becomes a tricky business, and often long for the comfort of a soft-cushioned bed by the fireplace.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Perambulation doesn&#39;t come easily to you, but the training and brawn you&#39;ve managed to accrue works wonders in taming the heaving and bouncing of your frame, and your sturdily fleshy legs have firmly pudgy calves and thick, corpulent thighs that squash together forcibly as you proceed forward. The weight and texture of your legs rules out certain activities like precarious climbing or sudden blitzes, but their power makes up for it in the way you can stand your ground and maintain a measured march.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Unflinching in your steady stride during the journey, you transcend the limitations of the ample superfluous weight of your body, no matter how it quivers and sways, and your mightily stout legs have strong doughy calves and well-developed, thickly padded thighs that squash together a good deal as you proceed forward. Your legs allow feats of strength an insure a degree of endurance that the majority of corpulent folk cannot even dream about, and all but nullify the encumbrance in your fights and forays into the unknown.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Waddling at an ailing pace, you radiate unhurried indolence and dread the thought of a wobbling, breathless spectacle you get reduced to whenever there is an urgency of travel, and your roly-poly, delicate legs have tenderly pudgy calves and pillow-like grand thighs that squash together even when you set your feet apart. Your legs stunt your mobility considerably, only allowing your amble to cover a small distance before asserting their weight and demanding recuperation - and that only refers to navigating the interior of the town perimeter, outside of which it gets incalculably worse.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Resigning yourself to the constant struggle against the contradictory jostles of your gorgeously filled-out curves, you brave your way towards the distant goal regardless, and your grudgingly managing legs have pudgy calves and pillow-like voluminous thighs that squash together even when you set your feet apart. Your legs stunt your mobility considerably, only allowing your amble to cover an short distance before asserting their weight and demanding recuperation, even though you&#39;ve long since gotten used to push yourself a little past that threshold.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Perambulation doesn&#39;t come easily to you, but the training and brawn you&#39;ve managed to accrue works wonders in taming the heaving and bouncing of your frame, and your burly legs have smoothly chubby calves and stout, thickly padded thighs that squash together even when you set your feet apart. Your legs carry you steadily through the uneven landscapes of the wilderness, and provide confidence when blundering into a local hazard, but there is always a sense that a smallest misjudgment of how your fleshy extremities are aligned would result in a fall that you may not be able to recover from.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Unflinching in your steady stride during the journey, you transcend the limitations of the ample superfluous weight of your body, no matter how it quivers and sways, and your fortitudinous legs have thick, pudgy calves and amply fleshed thighs that squash together even when you set your feet apart. Your legs painstakingly wrest control of your maneuvers from the random influence of your undulating loose flesh, are quite capable of transferring a momentary loss of balance into a strike of significantly augmented potency; outside combat, they allow you to enjoy the scenic views when you stray outside the city walls without constantly insisting on your return to the realm of the cushy and refined.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Waddling at an ailing pace, you radiate unhurried indolence and dread the thought of a wobbling, breathless spectacle you get reduced to whenever there is an urgency of travel, and your luxuriantly coddled legs have downy, chubby calves and blubbery thighs thick as a barrel that are flattened against each other most of the time. Your legs only permit you a minimal degree of mobility, and conduct a concerto of fleshy unpleasantness whenever their limits are put to the test.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Resigning yourself to the constant struggle against the contradictory jostles of your gorgeously filled-out curves, you brave your way towards the distant goal regardless, and your luxuriantly unexercised legs have downy, chubby calves and blubbery thighs thick as a barrel that are flattened against each other most of the time. Your legs only permit you a minimal degree of mobility, and give you a really hard time whenever their limits are put to the test, but that is not something you would allow to stop you from getting where you want to be on time.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Perambulation doesn&#39;t come easily to you, but the training and brawn you&#39;ve managed to accrue works wonders in taming the heaving and bouncing of your frame, and your perplexingly sturdy legs have intensely doughy calves and blubbery thighs thick as a barrel that are flattened against each other most of the time. Your legs never let you down where traversing short distances or weathering minor battles is concerned, but any logistcal exploits of greater magnitude become taxing gauntlets for your voluptuous constitution, occupying all your thoughts with concerns about coordination and frustration at the intractable loose flesh.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Unflinching in your steady stride during the journey, you transcend the limitations of the ample superfluous weight of your body, no matter how it quivers and sways, and your monumentally hardy legs have corpulent calves and wonderously portly thighs that are flattened against each other most of the time. Your legs stalwartly accept the challenges your weight and the elusive center of mass throw at them, although it isn&#39;t without great difficulty and energy expenditure, and even though it&#39;s an astonishing sight to behold when you fight or surge forward, the bills of heavy panting, lengthy rests and hearty meals that your body produces at the resolution of those exploits are nothing to scoff at.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						It is a veritable mystery how someone as immoderately corpulent can still be moving about without assistance, but you make it happen through grit and tears, and your staggering legs have tender bulging calves and blubbery thighs; the latter are as girthy as prize-winning fattened hogs and squash against each other so strongly that your knees are forced widely apart. Your legs creak and agonize at having to endure such overwhelming stress, veering closer to expansive couches and sturdy-looking benches without your conscious input, and are the exact opposite of what a capable explorer of wilderness could want for her lower limbs.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Setting your form lurching forward in an avalanche of blubber is something you have no trouble doing, but it&#39;s the steering and decellerating that demand feats of strength and balance, and your sluggish legs have tender bulging calves and lardy thighs; the latter are as girthy as prize-winning fattened hogs and squash against each other so potently that your knees are forced widely apart. Your legs creak and ache at having to endure such overwhelming stress, veering closer to expansive couches and sturdy-looking benches without your conscious input, and aren&#39;t exactly what a capable explorer of wilderness would want for her lower limbs.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Something about the thunderous echo of your heavy footsteps betrays a highly trained traveller to whom her massive sloshing abundance of idle flesh is just one more obstacle to overcome, and your astonishingly resilient legs have bulging doughy calves and blubbery thighs; the latter are as girthy as prize-winning fattened hogs and squash against each other so strongly that your knees are forced widely apart. Your legs lament having to endure such overwhelming stress by persistently reminding of their plight by dull aching and veering closer to expansive couches and sturdy-looking benches without your conscious input, but refuse to succumb and faithfully carry you through your panting-intensive escapades.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Even though your bloated form imposes limitations that are impossible to mitigate via any means available to mortals, the sheer might of your limbs makes travelling through hazardous regions on foot not only conceivable, but comfortable, and your unyielding legs have blubbery calves and thighs that are fabulously fattened, yet firm; the latter are the size of prize-winning fattened hogs and squash against each other so strongly that your knees are forced widely apart. Your legs grudgingly support your swollen body when bracing for an enemy charge or when a lengthy trek becomes unavoidable, with the beckoning visions of the lavish festivities to follow your return with hard-won booty serving as an added incentive.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						It is a veritable mystery how someone as immoderately corpulent can still be moving about without assistance, but you make it happen through grit and tears, and your shakey legs have fatty quivering calves and bloated thighs; the latter are as girthy a grown ox&#39;s chest and crush each other so forcefully that your knees cannot be brought together closer than 
						&lt;&lt;if $options.metric&gt;&gt;half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a couple feet&lt;&lt;/if&gt;&gt;
						 apart. Your legs are driven way past their comfortable limits of exertion while you stand, and aren&#39;t shy about constantly informing you of their misery, and that continuous droning chorus of tension and hurt firmly prescribes you a relaxed lifestyle in a well-guarded town.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Setting your form lurching forward in an avalanche of blubber is something you have no trouble doing, but it&#39;s the steering and decellerating that demand feats of strength and balance, and your struggling legs have fatty quivering calves and bloated thighs; the latter are as girthy a fully grown ox&#39;s chest and crush each other so forcefully that your knees cannot be brought together closer that
						&lt;&lt;if $options.metric&gt;&gt;half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a couple feet&lt;&lt;/if&gt;&gt;
						 apart. Your legs are driven way past their comfortable limits of exertion while you stand, and aren&#39;t shy about constantly informing you of their hardship, and that continuous droning chorus of tension and aching firmly prescribes you a relaxed lifestyle in a well-guarded town.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Something about the thunderous echo of your heavy footsteps betrays a highly trained traveller to whom her massive sloshing abundance of idle flesh is just one more obstacle to overcome, and your long-suffering legs have stoutly meaty calves and bloated thighs; the latter are as girthy a fully grown ox&#39;s chest and crush each other so forcefully that your knees cannot be brought together closer that
						&lt;&lt;if $options.metric&gt;&gt;half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a couple feet&lt;&lt;/if&gt;&gt;
						 apart. Your legs are courting the limits of their physical prowess when you lumber through the action-intesive parts of your journeys, but any bout of motion leads to lengthy periods of exhaustion and aches that would make anyone long for a relaxed lifestyle in a well-guarded town.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Even though your bloated form imposes limitations that are impossible to mitigate via any means available to mortals, the sheer might of your limbs makes travelling through hazardous regions on foot not only conceivable, but comfortable, and your defiantly stalwart legs have chubby, meaty calves and magnificently corpulent thighs; the latter have the volume of an ancient oak tree trunk and compress each other so forcefully that your knees cannot be brought together closer than
						&lt;&lt;if $options.metric&gt;&gt;half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a couple feet&lt;&lt;/if&gt;&gt;
						 apart. Your legs are so stoutly built that during the more peaceful promenades you can even steal a few minutes untroubled by the chore of minding your stance and watching your step, but whenever the only course of action is urgent movement you find that your locomotive resources are very quick to exhaust and easy to squander.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						It is a veritable mystery how someone as immoderately corpulent can still be moving about without assistance, but you make it happen through grit and tears, and your brutally tortured legs have lardy, supple calves and titanic thighs; the latter are as girthy as a bathing barrel and squash together so hard that your knees cannot be brought anywhere near each other. Your legs are only capable of hefting your enormous bulk upright and keeping it that way by calling upon virtually every flimsy muscle of your upper body in a desperate bid for leverage and balance, and what feeble stability you manage to muster this way must always be insured by having a sturdy wall to lean against, and the only mode of travel you can honestly afford is an inexorable glacial crawl forward accompanied by groans and booming footfalls.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Setting your form lurching forward in an avalanche of blubber is something you have no trouble doing, but it&#39;s the steering and decellerating that demand feats of strength and balance, and your severelyailing legs have lardy, supple calves and titanic thighs; the latter are as girthy as a bathing barrel and squash together so hard that your knees cannot be brought anywhere near each other. Your legs are only capable of hefting your enormous bulk upright and keeping it that way by calling upon virtually every hidden muscle of your upper body in a desperate bid for leverage and balance, and what feeble stability you manage to muster this way must always be insured by having a sturdy wall to lean against, and the only mode of travel you can honestly afford is an inexorable glacial crawl forward accompanied by panting and booming footfalls.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Something about the thunderous echo of your heavy footsteps betrays a highly trained traveller to whom her massive sloshing abundance of idle flesh is just one more obstacle to overcome, and your pained, but unrelenting legs have lardy, supple calves and titanic thighs; the latter are as girthy as a bathing barrel and squash together so hard that your knees cannot be brought anywhere near each other. Your legs are only capable of hefting your enormous bulk upright and keeping it that way by calling upon the formidable musclature of your upper body in order to gain leverage and balance, and although it&#39;s always safest to have a sturdy wall to lean against for stability, your hardy means of locomotion are powerful enough to allow somewhat stable travel over short distances, even your booming steps render it an outrageously loud affair.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Even though your bloated form imposes limitations that are impossible to mitigate via any means available to mortals, the sheer might of your limbs makes travelling through hazardous regions on foot not only conceivable, but comfortable, and your epically tenacious legs have firm-surfaced blubbery calves and outrageously bloated thighs; the latter are fatter than a hibernating bear and are rammed into each other so heavily that your knees cannot be brought anywhere near to each other. Your legs are heroically stalwart in preserving the appearance of motive confidence, unhindered by the unreal girth and mass of what they carry, but a heave too strong brings your entire grandiose bulk to the brink of dramatically collapsing, which never bodes well in a combat situation or where buildings and people might get in the way of your destructive momentum - even though you have long since learned to measure your movements to work around this risk.
				&lt;&lt;/switch&gt;&gt;
				
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;default&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You aren&#39;t used to travelling on foot, and your unsteady legs have malnourished thighs, followed by spindly calves. Your legs are sorely underqualified for a life of adventure, being vulnerable to aches and spraining.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You are light on your feet, and your lean-thighed and thin-calved legs are quick and flexible. Your legs can be trusted to get you out of any trouble, or make up for your general lack of mass in times when a situation calls for a firm kick.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You are no stranger to the hardships of a long journey, and your legs have well-developed thighs bulging with granite quadriceps and thoroughly exercised lean calves. Your legs seem to be composed of nothing but sinew, bone and hard muscle, and never give you any trouble no matter the situation or terrain.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You are superbly sure-footed, striding with wide, steady steps, and your legs are columns of unbreakable bones enwrapped by thick, mighty flesh of your thighs and calves. Your legs appear capable of carrying the heaviest of weights across the roughest of landscapes, even when the added challenge of charging into a fight or fleeing factors in.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You aren&#39;t too used to travelling on foot, and your unremarkable legs have toneless thighs and supple calves. Your legs are more at home pacing on a hardwood floor than tramping on a rocky road, and only exhibit any fitness in a safe, secure environments where the jogging is seldom a life-saving course of action.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You are light on your feet, and your speedy legs have exercised, yet lean thighs and firm calves. Your legs are perfectly at ease both during a stroll, a jog or a sprint - as long as there is no heavy load weighting you down.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You are no stranger to hardships of a long journey, and your husky legs have thick musclular thighs and sturdy calves. Your legs have excellent tolerance for prolonged stress, and never give you any trouble no matter the situation or terrain.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You are superbly sure-footed, striding with wide, steady steps, and your massively developed legs have mighty thighs and outstandingly hardy calves. Your legs have been known to tirelessly eat up miles of craggy slopes, bramble thicket and barren rock without giving you as much a fleeting ache at the journey&#39;s end.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You aren&#39;t too used to travelling by foot, and your bumbling legs have marshmallow thighs and downy calves. Your legs have spent a little too much timy in cushy beds and behind dinner tables, and can only manage an uneven pace that isn&#39;t well-suited for a long journey.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You are light on your feet, and your vigorous legs have healthy-looking thighs and toned calves that are still slightly chubby. Your legs benefit from almost inexhaustible resources for moderately fleet journeys and don&#39;t get worn out easily despite their voluptuous texture - provided you are travelling light.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You are no stranger to hardships of a long journey, and your steady legs have meaty thighs and toned calves that keep their firmness in spite of their light padding. Your legs give you a fortitudinous stance most useful in withstanding heavy blows in combat, and a springy, bouncing gait on the move.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You are superbly sure-footed, striding with wide, steady steps, and your exemplarily trained like legs are enveloped in thick, strong flesh of your burly thighs and succulently meaty calves. Your legs are given awesome power by their overgrown musculature bostered stintingly by a tiny amount of flab, are quick to leap or kick, and impossible to tire even by a lengthy, heavilly-laden travel.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Unaccustomed as you are to moving around a lot, you are a poor traveller, and your awkwardly moving legs are doughy-thighed and supple-calved. Your legs have a definite predispoition for basking in warmth and indolence, and don&#39;t permit you to undergo any far-reaching amblings, else they start aching and complaining.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You are in a good shape for pedestrian forays despite your inherent baggage, and your firm legs have thighs and calves that are strong enough despite being consistently flabby. Your legs have a good working relationship with their decent baggage of loose flesh, and allow you to leave a good distance behind you before you start running out of breath and vigour.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You are a weathered journeyman used to carrying an bit of insurance against luckless foraging under your belt, and your hardy legs have stout thighs and juicy calves boating remarkable hardiness. Your legs may be less gymnastics-oriented in their function, but the rhythm and quickness of their pace suggests that the extra weight you bear doesn&#39;t come close to your full carrying capacity, even when forced to travel heavy and for far.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You tread ahead with an unstoppable tenacity in your heavy and firm steps, and your vigorously robust legs have strong, thick thighs and mightily meaty calves. Your legs are sturdy in the extreme, and their softer look doesn&#39;t compromise the fact that there isn&#39;t a slope you cannot climb nor a fallen log you can&#39;t fling away with a kick.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Unaccustomed as you are to moving around a lot, you are a poor traveller, and your underused legs have very flabby thighs and wobbly calves. Your legs are significantly stressed by your generous proportions, and ther curves seem to attract hard doorframes, table edges and trees stumps.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You are in a good shape for pedestrian forays despite your inherent baggage, and your defiantly quick legs are quite well-developed despite the added weight, and are flabby-thighed, plush-calved. Your legs give you a deep appreciation for comforts of home, but they also can keep you comfortable on an occasional trek through the wilderness.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You are a weathered journeyman used to carrying under your belt a bit of insurance against luckless foraging, and your intensely trained legs are plump-thighed and hardy-calved. Your legs have left enough hard miles behind them, and are so reliable that hardly ever let you feel their heavier, squishier aspects during a fight or a flight.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You tread ahead with an unstoppable tenacity in your heavy and firm steps, and your superiorly athletic legs have voluminous meaty thighs and tremendously exercised, yet luxuriantly plump calves. Your legs have the balance and power that allow to you can tackle any part of the adventuring life without giving any care to your slightly pudgy means of locomotion.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Unaccustomed as you are to moving around a lot, you are a poor traveller, and your strained legs have chubby thighs that rub together a little as you stroll, followed by the juicily-fleshed calves below. Your legs are understandably overstressed considering they have to take care of your upper bodily chubbiness on top of their own, and being so harassed they tend to find objects to stumble against even on the flattest of pavements.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You are in a good shape for pedestrian forays despite your inherent baggage, and your tolerably trained legs have fatty thighs that rub together a little as you stroll, followed by the firm, chubby calves below. Your legs are struggling to keep their hefty fleshiness from influencing your chosen trajectory, and even though it costs you a lot of effort, they are fully capable of seeing you through a perilous expedition.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You are a weathered journeyman used to carrying under your belt a bit of insurance against luckless foraging, and your uncommonly hardy legs have powerful and heavy thighs that rub together a little as you stroll, followed by the firm and meaty calves below. Your legs are prevented from realizing their full potential of gymnasitc prowess by the filled-out nature of your body, but otherwise aren&#39;t much affected by the heaving weight they support.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You tread ahead with an unstoppable tenacity in your heavy and firm steps, and your tremendously steadfast legs have overwhelmingly muscular, plump thighs that rub together a little as you stroll, followed by the robust stout calves below. Your legs don&#39;t perform too well when asked for a sudden feat of sprinting, but are affluent enough in their power reserves to allow an effortless march regardless of its duration, difficulty of landscape, the contents of your way bags or how heavy a meal you&#39;ve just had.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Never more than a hair&#39;s breadth away from getting stopped in your tracks by your girth panting and wheezing, you belong in a cushy homestead, and your infirm legs have profoundly chubby thighs that rub together a lot when you waddle forth, followed by the doughy calves below. Your legs are a constant source of duress and frustration whenever getting somewhere on time is of essence.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						To you a road of any description is always a formidable opponent that you frequently strive to avoid rather than vanquish, and your legs are out of shape, have profoundly chubby thighs that rub together a lot when you waddle forth, followed by the doughy calves below. Your legs are a constant source of duress and frustration whenever getting somewhere on time is of essence, although you can make your body move at a respectable pace through grit and determination alone.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Strugging and exerting yourself to overcome the sloshing intertia of your rounded parts, you still confidently plow through the thickets and over the dunes, and your sturdy legs have thick, fatty thighs that rub together a lot when you waddle forth, followed by into the fleshy, but toned calves below. Hard of step and kick alike, your legs naturally adopt a more defensive stance in fights that draw on your resilient stability rather than flashy maneuvers, and you always take care to pace yourself on lengthy trips.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Hampered as well as aided by the dire momentum of your bulk, you take to the road with the relentless flow of a drifting iceberg, and your stoutly built legs have profoundly flabby thighs that rub together a lot when you waddle forth, followed by the firmly chubby calves below. Your legs have long since developed a set of tactics for turning the cumbersome weight above to your advantage in combat or on the move, allowing you to root yourself into he ground in anticipation of a blow, and fly into a charge the next moment.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Never more than a hair&#39;s breadth away from getting stopped in your tracks by your girth panting and wheezing, you belong in a cushy homestead, and your awkward legs have bulging thighs that get squeezed together forcibly as you trundle along, followed by the richly fleshy calves below. Your legs are as much a liability during an arduous journey as the rest of you, but at least they cushion the campfire vigils when chance catches you camping in a particularly rocky country.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						To you a road of any description is always a formidable opponent that you frequently strive to avoid rather than vanquish, and your awkward legs have bulging thighs that get squeezed together forcibly as you trundle along, followed by the richly fleshy calves below. Your legs are nearly as much a liability during an arduous journey as the rest of you, but at least they cushion the campfire vigils when chance catches you camping in a particularly rocky country, and can help you get away from a slow enough opponent.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Strugging and exerting yourself to overcome the sloshing intertia of your rounded parts, you still confidently plow through the thickets and over the dunes, and your trusty legs have softly thighs that get squeezed together forcibly as you trundle along, followed by sturdy, but very thickly-padded calves below. Your legs make sauntering through the dark woods and ominous hills easy enough, but take some resolve and concentration to keep that ease during heated confrontation or while making a strategic retreat, for the wild swaying of your abounding flab is a chaotic force that is hard to adjust for.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Hampered as well as aided by the dire momentum of your bulk, you take to the road with the relentless flow of a drifting iceberg, and your sure-footed legs have impressively portly, but well-trained thighs that get squeezed together forcibly as you trundle along, followed by the mightily fleshed calves below. Your legs turn your corpulent lumbering frame into a body of a competent and mobile combatant, and show remarkable disdain for the roughness of terrain when exploring the wilds, although there&#39;s a limit to their resources.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Never more than a hair&#39;s breadth away from getting stopped in your tracks by your girth panting and wheezing, you belong in a cushy homestead, and your unstable legs have blubbery thighs that get squeezed together even when you set your knees apart, followed by the abundantly fatty calves below. Your legs get in your way constantly, straining, creaking and aching, and are far from being a proper means of locomotion for a town crier, let alone a hardy adventurer.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						To you a road of any description is always a formidable opponent that you frequently strive to avoid rather than vanquish, and your overstrained legs have blubbery thighs that get squeezed together even when you set your feet apart, followed by the abundantly fatty calves below. Your legs get in your way most of the time, and are far from being a proper means of locomotion for a town crier, let alone a hardy adventurer, but through effort and will to improve you somehow manage to pull through even the most ridiculously challenging situations for someone of your weight category.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Strugging and exerting yourself to overcome the sloshing intertia of your rounded parts, you still confidently plow through the thickets and over the dunes, and your burdened legs have stout and awesomely porty thighs that get squeezed together even when you set your feet aside, followed by the fleshy calves below. Your legs are the wardens of your precarious balance, and take this grave responsibility seriously, and even though quicker gaits and sudden maneuvers are right out for your bulk, you can at least be assured of a steady amble and a firm stance.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Hampered as well as aided by the dire momentum of your bulk, you take to the road with the relentless flow of a drifting iceberg, and your stout and sturdy legs have thighs with solid muscle and ample blubber giving them the girth that make them get squeezed together even when you set your feet aside, followed by the meaty calves below. Your legs have the power and resilience to cope with your bloated form most of the time, whether it&#39;s a long trudging expedition or a heated engagement, and on occasion are capable of turning the impeding weight into added force behind a combat lunge, but the tradeoff in balance makes the latter less than feasible.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Considering the magnitude of loose weight dragging your frame down, its continuing mobility seems downright miraculous, although you know bitterly well that it&#39;s nothing but excruciating toil that keeps you moving, and your tormented legs have luxuriantly fattened thighs thick as small beer barrels that are slammed together so hard your knees are forced apart, followed by the blubbery calves below. Your legs aren&#39;t much help when it comes to shifting your formidable bulk around, and every heavy step feels like trudging through a mire, nevermind attempting to hurry up your pace.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your traversing most often takes form of a barely controlled continuous collapse forward, accompanied by the wild swinging of your bulging rotundities and the haunting dread of having to stop at some point, and your underqualified legs have luxuriantly fattened thighs thick as small beer barrels that are slammed together so hard your knees are forced apart, followed by the blubbery calves below. Your legs aren&#39;t much help when it comes to shifting your formidable bulk around, and every heavy step feels like trudging through a mire, nevermind attempting to hurry up your pace, but the extensive experience of overcoming encumbrance allows you to rally in times of need and undertake an unexpected rush or two.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Just managing the maddening feat of harnessing the impetus of your overflowing dimensions in motion, you doggedly waddle towards the destination of your choice, and your belleaguered legs have luxuriantly fattened, yet sturdy thighs thick as small beer barrels that are slammed together so hard your knees are forced apart, followed by the blubbery calves below. Your legs are capable of hauling your formidable bulk around, but only just, and every heavy step feels like trudging through a mire, even though you can push yourself far beyond your comfortable limit.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Grass, sand, dirt and snow alike tremble at your ponderous advance, and even though you have left your capacity for springy acrobatics far behind and deep within, the tectonic inexorability of your pace in and out of combat never fails to impress, and your reliable legs have burly, blubbery thighs thick as small beer barrels that are slammed together so hard your knees are forced apart, followed by the firm, but lushly corpulent calves below. Your legs are constrained to a measured stroll in terms of speed, but for someone of your proportions, speed isn&#39;t nearly as much of an asset as stability, which your legs dutifully provide no matter the landscape.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Considering the magnitude of loose weight dragging your frame down, its continuing mobility seems downright miraculous, although you know bitterly well that it&#39;s nothing but excruciating toil that keeps you moving, and your trembling legs have massive thighs thick as yearling walruses that are smushed together tightly enough to force your knees widely apart, followed by the corpulent calves below. Your legs are pitifully overstrained carrying your staggeringly obese form, and even with a firm cobbled road beneath your feet and an empty travelling bag behind your back, you move by careening and lurching drunkedly, using every surface within reach for support, and in an event of clumsily running away from a fierce beast, not even the prospect of becoming your pursuer&#39;s banquet makes the desire for a lengthy lie-down any less tempting.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your traversing most often takes form of a barely controlled continuous collapse forward, accompanied by the wild swinging of your bulging rotundities and the haunting dread of having to stop at some point, and your harassed legs have massive thighs thick as yearling walruses that are smushed together tightly enough to force your knees widely apart, followed by the corpulent calves below. Your legs are substantially overstrained carrying your staggeringly obese form, and even with a firm cobbled road beneath your feet and an empty travelling bag behind your back, you move by careening and lurching drunkedly, using every surface within reach for support, and in an event of clumsily running away from a fierce beast, not even the prospect of becoming your pursuer&#39;s banquet makes the desire for a lengthy lie-down any less tempting.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Just managing the maddening feat of harnessing the impetus of your overflowing dimensions in motion, you doggedly waddle towards the destination of your choice, and your ailing legs have massive thighs thick as yearling walruses that are smushed together tightly enough to force your knees widely apart, followed by the corpulent calves below. Your legs are only just sufficiently developed to go on carrying your staggeringly obese form, and even with a firm cobbled road beneath your feet and an empty travelling bag behind your back, you move in uncertain lurches, using every surface within reach for support, and in an event of running away from a fierce beast, only the prospect of becoming your pursuer&#39;s banquet makes the idea of an immediate lengthy lie-down less appealing.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Grass, sand, dirt and snow alike tremble at your ponderous advance, and even though you have left your capacity for springy acrobatics far behind and deep within, the tectonic inexorability of your pace in and out of combat never fails to impress, and your heroically tenacious legs have mightily portly thighs as thick cathedral pillars that are smushed together so hard that your knees are forced widely apart, followed by the lavishly padded and meaty calves below. Your legs are formidable enough to accomplish their appointed task of transporting your inconceivably massive form around, and even offering a modicum of maneuverability in combat, but the severity of the stress they endure mean they can&#39;t be safely forced too far beyond their limits.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Considering the magnitude of loose weight dragging your frame down, its continuing mobility seems downright miraculous, although you know bitterly well that it&#39;s nothing but excruciating toil that keeps you moving, and your buckling legs have tremendous thighs neither of which could fit into a town well, and that are squeezed together so tightly they prohibit your knees from getting anywhere close to each other; even the superbly fleshy, jiggling calves below look slim in comparison to what hangs above. Your legs have nothing in terms of power and flexibility to account for your unparalleled obesity, and even a simple thing like getting out of bed or climbing a set of stairs - something that an ordinarily-built person would have found trivial and mundane - turns into a quest of epic proportions for you, with all its due breathless exhaustion, disastrous downfalls and heroic triumphs.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your traversing most often takes form of a barely controlled continuous collapse forward, accompanied by the wild swinging of your bulging rotundities and the haunting dread of having to stop at some point, and your cumbersome legs have tremendous thighs neither of which could fit into a town well, and that are squeezed together so tightly they prohibit your knees from getting anywhere close to each other; even the superbly fleshy, jiggling calves below look slim in comparison to what hangs above. Your legs have almost nothing in terms of power and flexibility to account for your unparalleled obesity, and even a simple thing like getting out of bed or climbing a set of stairs - something that an ordinarily-built person would have found trivial and mundane - turns into a quest of epic proportions for you, with all its due breathless exhaustion, disastrous downfalls and heroic triumphs.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Just managing the maddening feat of harnessing the impetus of your overflowing dimensions in motion, you doggedly waddle towards the destination of your choice, and your staggering legs have tremendous thighs neither of which could fit into a town well, and that are squeezed together so tightly they prohibit your knees from getting anywhere close to each other; even the superbly portly calves below look slim in comparison to what hangs above. Your legs have very little in terms of power and flexibility to account for your unparalleled obesity, and even a simple thing like getting out of bed or climbing a set of stairs - something that an ordinarily-built person would have found trivial and mundane - turns into an arduous quest with all of its gruelling vexations, but the reward of staying on your feet despite the absurd enormity of your physique is worth the investment.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Grass, sand, dirt and snow alike tremble at your ponderous advance, and even though you have left your capacity for springy acrobatics far behind and deep within, the tectonic inexorability of your pace in and out of combat never fails to impress, and your defiantly tough legs have bloated thighs neither of which could fit into a town well, and that are compressed together so hard that your knees are prevented from coming anywhere near each other; below, there are the firm, but inescapably lardaceous calves that are still humbled by the great bulks hanging above. Your legs are apparently as stubbornly unyielding as mountains, or else there would have been no secular, non-magical excuse for you to wander around as if you weren&#39;t as overwhelmingly overweight as you are, and it is often the shock of witnessing the maddening quickness of your frame that seals the fate of your adversaries, leaving them open to a flattening attack.
				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;		
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="543" name="describe lower" tags="" position="3800,600" size="100,100">&lt;&lt;switch $p.him&gt;&gt;
	&lt;&lt;case $female.him&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while - and fasting appears to feature quite heavily in your life - your belly looks sunken and sapless; your bony hips are lent their breadth almost exclusively by the hip bones, narrowing into your poorly-fleshed waist, and your posterior is destitutely skinny.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your stomach is flat and lean, but there is a bit of strength apparent by its taut tone; your hips have a slightly increased volume thanks to an active lifestyle and exercise, and your behind is hardily built.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your abdomen becomes rigid and knotted with its well-developed abs; your hips have undergone arduous training, and your rear is slim and meaty.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your stomach&#39;s texture becomes solid and unassailable by the overabundant abs gripping it; your hips likewise exude immense endurance and might, although your waist remains slender and narrow, and your lean gluteus is developed intensely enough to define your rump thoroughly.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your belly retracts humbly; your hips don&#39;t possess much strength or volume, but expand below you waist just enough to complement it, and your soft posterior is modestly fleshed.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your stomach flattens a bit, but there is a bit of strength inside that is hinted at whenever you turn or bend down; your hips have a modest swell to them thanks to good nutrition and exercise, and your slightly padded behind is fairly firm.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your abdomen assumes a hardened, yet elegant outline; your waist and hips are prominently toned and muscled, and contrast between them accentuates your &lt;&lt;print $p.gentleman&gt;&gt;like proportions despite the strapping physique, and your subtly rounded rear is hardened by exercise.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your stomach is given a solid and unassailable texture; your hips likewise exude immense power and segue smoothly into your legs, while your waist remains fairly slender, and your curvy rump is heavily built.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your belly retains a soft roundness to it, but doesn&#39;t protrude much; your hips may not be very well toned, but have a good swell to them, and your soft posterior is largely unexercised.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your stomach alternates between showcasing its exercised muscles and reverting to an unassuming soft appearance; your hips boast a significant swell, but remain firm and strong, and your equally toned behind is plushly textured.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your abdomen&#39;s appearance becomes a middle ground between extensive athletic segmentation and graceful smoothness; your waist is splendidly developed and expands into wide hips that are given most of their volume by muscle, and your well-exercised rear is softened just a little.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your stomach becomes defined by the slightly softened, yet magnificently exercised abs; your wide, firm hips are superbly toned and developed, and your strong rump is modestly padded.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your slight downy belly is just large enough to be called such, your rounded hips have a profound swell to them owing very little to muscles, and your sizable posterior is virtually unexercised.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your abdomen keeps a modest pout of your soft belly that feels as if there&#39;s more tone behind it than meets the eye, your generously-padded hips conceal some good, toned flesh, and your plump behind doesn&#39;t hamper your gymnastic ability much.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your lower body remains visibly toned despite its downy cover; your waist swells into firm, yet very well-rounded wide hips, and your technically athletic rear is still quite pudgy.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your work-hardened midsection reveals powerful abdominal muscles through its supple padding, your flexible, thick waist descends down to the strongly-built, but also heartily plump hips, and your rump has its well-develeoped gluteus hidden under its shapely soft curves.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your midsection is endowed with a quite heavy belly that is none the less downy to the touch; your richly-fleshed waist swells out into the munificently padded hips that curve into your scantly exercised, fleshy posterior.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your belly remains pudgy and soft to the touch, but the exercised muscles hidden behind it are capable of firming it significantly; your plump waist swells out into the toned flabby hips that are given much of their volume by their generous padding, and that curve into your adequately developed, but fatty behind below.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your abdomen has a pouting belly decorating it, as well as suggestions of the underlying hard exercised flesh; your modestly stout waist swells out into the wide, well-muscled hips that are richly insulated with soft fat, and curve into your heavily fleshed, but athletic rear below.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your lower body has its powerful muscles all but covered by a supple, plump belly; your thickly built waist swells out into the stout, hardy hips that are richly insulated with soft fat, and that curve into your profoundly well-fed and excellently trained rump below.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your chubby stomach stands out confidently, impossible to retract, but also firm enough to avoid sagging; your waistline, although already very plump, still greatly contrasts the rotund, meaty hips below that curve into your fat, heavy posterior that hasn&#39;t been exercised in any meaningful way.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your generously padded midsection flaunts a taut, rounded belly; your pudgy, yet deceptively bendy waistline bulges into expansive, jiggling hips that curve into your richly chubby behind that has a good tone to it, even it is nigh unnoticeable.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your belly stands its ground, pouting out cheerfully and firmly; your thick, steady waist segues into profoundly curvaceous, excellently well-fed hips that curve into your athletic rear that conceals most of its tone under thick layers of fat.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, your abdomen forms a heavy, supple-looking belly that the excessively developed abs underneath can form into some remarkable shapes; your waist, thick and resilient as an oak trunk and soft as snow to the touch, widens into superbly plump, jiggling hips that curve into your hard-muscled rump, although the latter is given an unassumingly soft look by its ample flabby padding.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurrence ever comes about, your large, squishy belly sags just below your pelvis; your pudgy waist swells into enormously filled-out hips that undulate in time with your stride, and curve into your scantly exercised, tremendously fleshy posterior.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurrence ever comes about, your large, squishy belly sags down to just below your pelvis; your pudgy waist swells into enormously filled-out hips that undulate in time with your stride, and curve into your exercised, but tremendously fleshy behind.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurrence ever comes about, your belly still feigns being stuffed and sags down to just below your pelvis; your stoutly chubby waist swells into throughly fattened hips that quiver in time with your stride, and curve into your heavy, blubbery, but surprisingly firm rear.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurrence ever comes about, your rotund belly is somewhat unyielding to the touch due to hard abs deeply-buried in fat, and sags down to just below your pelvis; your burly, yet lushly fleshed waist swells into thickly chubby hips that sway a little in time with your stride, and curve into your bulging, supple rump that is given a good deal of apparent tone by the mighty glutes beneath.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurrence ever comes about, the sizable tender pillow of your belly droops halfway below your thighs, sloshing when disturbed; your superbly chubby waist swells into generously blubbery hips that rock and sway in time with your stride, expansively curving into your posterior which is swollen with a layer of fat a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurrence ever comes about, the sizable tender pillow of your belly droops halfway below your thighs, sloshing when disturbed; your superbly chubby waist swells into generously blubbery hips that rock and sway in time with your stride, expansively curving into your behind which is made firm by healthy exercise and a layer of fat a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurence ever comes about, your lovingly fattened belly sags down halfway past your thighs, quivering when disturbed; your firmly chubby waist swells into extravagantly portly hips that undulate in time with your stride, expansively curving into your thoroughly blubbery rear that astonishingly maintains a semblance of tone.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, if such an occurence ever comes about, your belly is weighty, amply curvaceous, and sags down halfway past your thighs; your lushly meaty waist swells into boisterously bulging hips that shift and jiggle in time with your stride, expansively curving into your rump that has been both intensely exercised and recklessly fattened.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, even if such an event is annual at best, your unfathomably chubby belly - easily a half of your entire body in weight, but still well balanced by your sizable stern - droops down almost to your knees, billowing and shaking when disturbed; your portly waist swells into hips bulging with a layer of fat nearly a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick that undulate strongly as you walk, curving below into your profoundly blubbery posterior that seems to bind you to whatever surface you find yourself lounging on.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, even if such an event is annual at best, your sumptuously chubby belly - easily a half of your entire body in weight, but still well balanced by your sizable stern - droops down almost to your knees, billowing and shaking when disturbed; your portly waist swells into hips bulging with a layer of fat nearly a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick that undulate strongly as you walk, curving below into your profoundly blubbery behind that makes every instance of standing up a hard exercise.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, even if such an event is annual at best, your phenomenally fleshy belly - easily a half of your entire body in weight, but still fairly well balanced by your sizable stern - droops down almost to your knees, quaking and trembling when disturbed; your stout and chubby waist swells into hips packed with a layer of fat nearly a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick that quivers tremulously as you walk, curving below into your substantially obese, yet surprisingly firm rear.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						When you&#39;ve been fasting for a while, even if such an event is annual at best, your belly - easily a half of your entire body in weight, but still fairly well balanced by your sizable stern - remains formidably rotund and solid in consistency despite the occasional ripples running along its surface, and droops down almost to your knees; your stout and bloated waist swells into hardily built hips wrapped in a layer of far nearly a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick that wobble and bounce as you walk, curving below into your meaty rump that has a smooth, firm surface due to the mighty muscles hiding at the core of its dense stratas of blubber.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						In a rare event of your impending gigantic banquet becoming uncomfortably separate from the previous one, your outstandingly fleshy belly - rivalling the remainder of your body in weight, but somewhat balanced by your ample hindquarters - has the convexity of a small mound, and leads others to suspect you of having just exhausted the larder of an entire restaurant; if someone were to hug you, they&#39;d have to flatten themselves against your great stomach and smush into the huge bosoms resting on it. Your gut flows into your engorged flanks and hangs down to your knees, experiencing liquid perturbations with every move; your obese waist swells into hips bulging with a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly a couple feet&lt;&lt;/if&gt;&gt;
						 thick that sloshes mightily as you walk, curving below into your posterior that&#39;s even more lavishly padded.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						In a rare event of your impending gigantic banquet becoming uncomfortably separate from the previous one, your outstandingly fleshy belly - rivalling the remainder of your body in weight, but somewhat balanced by your ample hindquarters with the aid of your back&#39;s pained efforts - has the convexity of a small mound, and leads others to suspect you of having just exhausted the larder of an entire restaurant; if someone were to hug you, they&#39;d have to flatten themselves against your great stomach and smush into the huge bosoms resting on it. Your gut flows into your engorged flanks and hangs down to your knees, experiencing liquid perturbations with every move; your obese waist swells into hips bulging with a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly a couple feet&lt;&lt;/if&gt;&gt;
						 thick that sloshes mightily as you walk, curving below into your behind that&#39;s even more lavishly padded.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						In a rare event of your impending gigantic banquet becoming uncomfortably separate from the previous one, your outstandingly fleshy belly - rivalling the remainder of your body in weight, but balanced by your ample hindquarters with the aid of your back&#39;s tone - has the convexity of a small mound, and leads others to suspect you of having just exhausted the larder of an entire restaurant; if someone were to hug you, they&#39;d have to flatten themselves against your great stomach and smush into the huge bosoms resting on it. Your gut flows into your engorged flanks and hangs down to your knees, experiencing liquid perturbations with every move; your obese waist swells into hips bulging with a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly a couple feet&lt;&lt;/if&gt;&gt;
						 thick that sloshes mightily as you walk, curving below into your rear that&#39;s even more lavishly padded.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						In a rare event of your impending gigantic banquet becoming uncomfortably separate from the previous one, your imposingly rotund belly - rivalling the remainder of your body in weight, but balanced by your ample hindquarters with the aid of your back&#39;s hardiness - makes you look like you&#39;ve just single-handedly decimated a townhall banquet, yet possesses such firmness to its thick layers of blubber that a measure of trained muscle could be believed to be hiding under them; if someone where to hug you, they&#39;d have to flatten themselves against your great stomach and smush into the huge bosoms resting on it. Your gut flows into your swollen flanks and sags down to your knees; your heavily fleshy waist swells into hips wrapped in a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly a couple feet&lt;&lt;/if&gt;&gt;
						 thick that billow as you walk, curving below into your even more lardaceous and wide rump.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						In &lt;&lt;case your conventional routine of gorging yourself near the point of bursting is interrupted for a while, your butterball of a paunch - matching the weight of the rest of your form, but kept from toppling you you by the hefty hindquarters coupled with a prudently chosen stance - is an absolute nightmare to prevent from swinging whichever way it pleases, and it looks like you&#39;ve just transferred all the squawking contents of a huge overcrowded chicken coup inside it; if someone were to hug you, they&#39;d have to climb onto your gut and then squeeze between the massive busts, and even shaking hands with someone not quite as inordinately obese as you would mean the other party having to brush against your squishy belly&#39;s surface. Your gut merges seamlessly into your hefty fattened flanks, and swags past the knees, shuddering and swaying at the merest disturbance; your fabulously portly waist swells into hips engorged with a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that quivers wildly when your walk, curving below into your even wider and more corpulent posterior.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						In &lt;&lt;case your conventional routine of gorging yourself near the point of bursting is interrupted for a while, your butterball of a paunch - matching the weight of the rest of your form, but kept from toppling you you by the hefty hindquarters coupled with a prudently chosen stance - is quite an ordeal to keep from swinging whichever way it pleases, and it looks like you&#39;ve just transferred all the squawking contents of a huge overcrowded chicken coup inside it; if someone were to hug you, they&#39;d have to climb onto your gut and then squeeze between the massive bosoms, and even shaking hands with someone not quite as inordinately obese as you would mean the other party having to brush against your squishy belly&#39;s surface. Your gut merges seamlessly into your hefty fattened flanks, and swags past the knees, shuddering and swaying at the merest disturbance; your fabulously portly waist swells into hips engorged with a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that quivers wildly when your walk, curving below into your even wider and more corpulent behind.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						In &lt;&lt;case your conventional routine of gorging yourself near the point of bursting is interrupted for a while, your butterball of a paunch - matching the weight of the rest of your form, but kept from toppling you you by the hefty hindquarters coupled with a prudently chosen stance - is a constant bother to prevent from swinging whichever way it pleases, and it looks like you&#39;ve just transferred all the squawking contents of a huge overcrowded chicken coup inside it; if someone were to hug you, they&#39;d have to climb onto your gut and then squeeze between the massive bosoms, and even shaking hands with someone not quite as inordinately obese as you would mean the other party having to brush against your squishy belly&#39;s surface. Your gut merges seamlessly into your hefty stout flanks, and swags past the knees, shuddering and swaying at the merest disturbance; your fabulously portly waist swells into hips engorged with a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that quivers wildly when your walk, curving below into your even wider and more corpulent rear.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						In &lt;&lt;case your conventional routine of gorging yourself near the point of bursting is interrupted for a while, your humongously fattened gut - matching the weight of the rest of your form, but kept from toppling you by the hefty hindquarters coupled with a firm, sturdy stance - mocks the formidable muscles encased in its layers by the segmented topography of its folded surface, and makes it easy to believe you&#39;ve just made a meal of a feral horse; if someone were to hug you, they&#39;d have to climb onto your gut and then squeeze between the massive bosoms, and even shaking hands with someone not quite as inordinately obese would mean the other party having to brush against your squishy belly&#39;s surface. Your paunch merges seamlessly with your chunky swollen flanks and droops down past your knees; your expansive and luxuriantly fleshy waist swells into hips swaddled in a layer of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that quivers voluptuously when you walk, curving below into your even more overwhelmingly fleshy rump that hides steely glutes somewhere in its blubbery depths.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						In those astronomically rare cases when you find that at the moment you&#39;re experiencing genuine hunger born of the emptiness in your stomach rather than unbridled greed, your mountainous gut - easily surpassing the remainder of your form in terms of mass and girth, and only kept in check by the bulk of your blubbery hindquarters and desperate resolve - lays a claim to its autonomy every time you move a little too urgently, with its folds and stratas or lard surging and tumbling in conflicting patterns until your hopelessly outmatched muscles and sinews cry for mercy, and on top of that it looks like a couple of particularly large and well-fed bears have recently vanished into its depths; if someone offered to kiss your hand, that unhealthily chivalrous person would have to push through the enveloping softness of your stomach&#39;s doughy exterior in order to make the gesture. Your gut melts into your magnificently engorged hips, and sinks low enough to graze the ground, with slightest actions initiating a lengthy commotion of quivering curves; your rampantly corpulent waist swells into wonderously broad hips stuffed with a layers a lard
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that roll and billow tumultously in time with your waddle, curving below into an even more staggeringly obese posterior.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						In those astronomically rare cases when you find that at the moment you&#39;re experiencing genuine hunger born of the emptiness in your stomach rather than unbridled greed, your mountainous gut - easily surpassing the remainder of your form in terms of mass and girth, and only kept in check by the bulk of your blubbery hindquarters and desperate resolve - lays a claim to its autonomy every time you move a little too urgently, with its folds and stratas or lard surging and tumbling in conflicting patterns until your hopelessly outmatched muscles and sinews cringe at the strain, and on top of that it looks like a couple of particularly large and well-fed bears have recently vanished into its depths; if someone offered to kiss your hand, that unhealthily chivalrous person would have to push through the enveloping softness of your stomach&#39;s doughy exterior in order to make the gesture. Your gut melts into your magnificently engorged hips, and sinks low enough to graze the ground, with slightest actions initiating a lengthy commotion of quivering curves; your rampantly corpulent waist swells into wonderously broad hips stuffed with a layers a lard
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that roll and billow tumultously in time with your waddle, curving below into an even more staggeringly obese posterior.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						In those astronomically rare cases when you find that at the moment you&#39;re experiencing genuine hunger born of the emptiness in your stomach rather than unbridled greed, your mountainous gut - easily surpassing the remainder of your form in terms of mass and girth, and only kept in check by the bulk of your blubbery hindquarters and resolve - lays a claim to its autonomy every time you move a little too urgently, with its folds and stratas or lard surging and tumbling in conflicting patterns until your hopelessly outmatched muscles and sinews moan at the effort, and on top of that it looks like a couple of particularly large and well-fed bears have recently vanished into its depths; if someone offered to kiss your hand, that unhealthily chivalrous person would have to push through the enveloping softness of your stomach&#39;s doughy exterior in order to make the gesture. Your gut melts into your magnificently engorged hips, and sinks low enough to graze the ground, with slightest actions initiating a lengthy commotion of quivering curves; your rampantly corpulent waist swells into wonderously broad hips stuffed with a layers a lard
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick that roll and billow tumulously in time with your waddle, curving below into an even more staggeringly obese posterior.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						In those astronomically rare cases when you find that at the moment you&#39;re experiencing genuine hunger born of the emptiness in your stomach rather than unbridled greed, your absurdly voluminous belly - holding decisive sway over the rest of your body in terms of mass and girth, and only kept in check by the bulk of your blubbery hindquarters and tenacity of your powerful frame - never betrays the might sleeping near its core, discounting the impressive feats of reining its intractable heaves, and it has the appearance suggesting that you have just finished quaffing a small lake dry; if someone offered to kiss your hand, that unhealthily chivalrous person would have to climb onto mounting slope of your gut first. Your belly segues subtly into your prodigiously lardaceous flanks and plummets so low that it nearly shuffles against the ground, and every ponderous step causes a prominent noisy disturbance in its supple texture that doesn&#39;t abate until a few seconds later; your waist swells into hips crammed to the point of bursting with slabs of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter thick&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 that slosh around riotously when you waddle forth, curving below into the rump even more gratuitously overfurnished with jiggling blubber.
				&lt;&lt;/switch&gt;&gt;
				
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;default&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, which seems to be a near permanent state for you, your midsection is as thin as they come; your waist is marked with the pelvic bones jutting out sharply, while your bottom is lean and scrawny.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, your abdomen is well-toned and respectably exercised despite its lean quality; your waist is narrow and thin, while your buttocks are slimly-built.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, your belly is an ornate barrier of hardened abs; your hips are equally well-fleshed and exercised, while your backside is austerely athletic.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, your lower body is nevertheless standing out for how rife it is with brawny hardened flesh, both the seemingly unbreachable abdomen and the fat-deprived sculpted hips, while your glutes are superbly developed and lean.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, your midsection is stingily fleshed; your waist is very lean, but not enough so to make you appear starved, while your bottom is modestly fleshed.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, your abdomen looks fairly toned; your waist is narrow and solid, while your buttocks are firm and toned.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, your belly retains a bit of volume because of the superbly toned abs; your hips are equally generously lined with exercised flesh, while your backside is athletically meaty.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, your lower body is still standing out for how heavily fleshed it is, both the seemingly unassailable abdomen and the sculpted waistline, while your glutes are heavily-built and well-developed.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, your abdomen is slighty supple and feeble to the touch despite falling short of deserving to be called a proper belly; your waist has some healthy volume to it, but little tone, while your average-sized bottom is somewhat flabby.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, your belly looks firm if a little plush; your waist is adequately exercised and smooth, while your toned buttocks have a bit of on padding on them.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, your midsection shows well-developed flesh through the thin layer of fat padding it; your hips are solidly built, while your meaty backside is admirably toned.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, your excellently developed lower body reveals its formidable abs even with a bit of extra volume in the way; your waist is strong beyond belief, but it takes a little poke to reach the hardy brawn underneath, while your powerful glutes have a meager cover of fat.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, your midsection swells into a modest chubby belly; your waist is weak despite its robust surfaces and your pudgy bottom is scarcely exercised.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, your abdomen sports a slight belly which you can still harden or suck in at will; your plush waist has seen some training, while your well-padded buttocks are adequately toned.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, your slight belly contends with hardened muscle for giving your lower body its definition; your waistline is soft to the touch, but give it a poke and there&#39;s some firmness there, while your stout backside is well-developed.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, your mighty abdominal muscles refuse to be entirely eclipsed by the fat of your belly; your waist is lined with plump tissue, but its mighty frame is still evident, while your powerful glutes still have a good amount of flab covering them.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, your significant belly protrudes softly outwards; your hips have little strength and a good deal of flab, and multiple minor folds appear on your sides when you turn or tilt or twist your torso, while your unexercised bottom is prodigiously fat.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, your midsection swells into a good-sized doughy belly hiding toned flesh under it; your lithe and capable waist is plumped up a good deal, and multiple fatty folds appear on your sides whenever you turn or tilt or twist your torso, while your toned buttocks have a decent amount of pudge padding them.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, your abdomen bulges forward a good deal on account of your soft, plump belly, as well as the strong muscles underneath; your waist is firmly and athletically built under all the plush padding, and multiple small folds appear whenever you turn or tilt or twist your torso, while your innerly powerful backside is doughy and soft to the touch.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, your respectable squishy belly just about covers the impossibly well-developed abs; your hips are potently built, but with quite a bit superfluous flesh on them, and small elusive folds appear on your sides whenever you turn or tilt or twist your torso, while your profoundly pudgy tail end hides iron glutes.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, your abdomen bulges with a sizable and proud potbelly; your hips are pudgy, but much less so than the centerpiece of your midsection, there are a couple of squishy rolls on your sides, while your fattened bottom is devoid of exercised tone.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, your taut round belly pouts out a good deal, and the best your exercised abs can do is to make it jiggle slightly; your generously plump hips remain well-developed deep down, there are a couple of squishy rolls on your sides, while your soft heavy buttocks have a bit of strength to them.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, your midsection is defined by your firm, heavy belly that vaguely hint at the strong flesh underneath; your waist is meaty and soft to the touch, but strong and resilient, there are a couple of ill-defined squishy rolls on your sides, while your very pudgy backside is mightily developed.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, your abdomen sports a very firm, but substantial belly shrouding the titanic brawn beyond it; your waist is wrapped in strong flesh finished with a hearty layer of fat, with a couple of minor squishy rolls on your sides, while your excellently developed glutes are barely discernable under their thick padding.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, your rotund, heavy belly curves smoothly into your profoundly pudgy hips and sags down just below your crotch, trembling intensely with each step; there are fatty rolls on your sides that form deep crevices, and your soft and tender bottom is fairly blubbery.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, your rotund, heavy belly curves smoothly into your profoundly pudgy hips and sags down just below your crotch, trembling intensely with each step; there are fatty rolls on your sides that form deep crevices, while your buttocks are fairly blubbery, but oddly retain the look of firmness.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, your weighty flabby belly curves smoothly into your thick and robustly padded hips and sags down just below your crotch, trembling intensely with each step; there are fatty rolls on your sides that form thin crevices, while your decently exercised backside has a remarkable abundance of pudge on it.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, your burly, bulging belly curves smoothly into your generously flabby, but strong hips, and sags just below your crotch, trembling intensely with each step; there are fatty rolls on your sides that form minor crevices, and although your glutes are toned and powerful, your tail end is too thickly packed with fat to show them off properly.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, the ponderous, doughy-textured slab of blubber constituting your belly flows smoothly into your portly flanks and spills down halfway past your thighs, swaying and quivering potently after each step; there are fatty rolls on your sides that form crevices deep enough to engulf a finger, while your bottom droops heavily, brimming with fat.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, the ponderous, doughy-textured slab of blubber constituting your belly flows smoothly into your portly flanks and spills down halfway past your thighs, swaying and quivering potently after each step; there are fatty rolls on your sides that form crevices deep enough to engulf a finger, while your buttocks droop heavily, brimming with fat.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, your great doming belly flows smoothly into your stout flanks and spills down halfway past your thighs, bouncing and undulating joyously after each step; there are fatty rolls on your sides that form crevices deep enough to engulf a finger, while your immensely chubby backside have the firmness to them suggesting some athletic capability.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, which appears to be a very rare circumstance, your mightily protruding belly flows smoothly into your sturdy, chubby flanks, and sags halfway past your thighs, ripples and shivers running along its sloping surface; there are fatty rolls on your sides that form deep crevices, while your abundantly blubbery tail end provides too much cover for your iron glutes to display their brawn.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On an empty stomach, as bizarrely unlikely as that state might appear to be, your belly - nearly half as large as the rest of you - resembles nothing short of a huge, round caudlron that merges seamlessly with your fattened flanks and hangs down nearly to your knees, swinging pendulously after each step and firmly anchoring you to any unfortunate piece of furniture you might decide to test; there are thick folds on your sides that stretch from under your shoulders to your gut, and are a hand&#39;s length deep. The curves of your bottom are tightly packed with blubber.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On an empty stomach, as bizarrely unlikely as that state might appear to be, your belly - nearly half as large as the rest of you - resembles nothing short of a huge, round caudlron that that merges seamlessly with your fattened flanks and hangs down nearly to your knees, swinging pendulously after each step and making it a challenge to rise to your feet; there are thick folds on your sides that stretch from under your shoulders to your gut, and are a hand&#39;s length deep. The curves of your buttocks are thickly packed with blubber.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On an empty stomach, as bizarrely unlikely as that state might appear to be, your monstrously prominent belly - nearly half as large as the rest of you - merges seamlessy with your rotund flanks and hangs down nearly to your knees, billowing and sloshing after each step and covering your thighs when you sit down; there are thick folds on your sides that stretch from under your shoulders to your gut, and are a hand&#39;s length deep. Your stoutly built backside is extravagantly thickened with flab.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an empty stomach, as bizarrely unlikely as that state might appear to be, your unbelievably corpulent belly - nearly half as large as the rest of you - merges seamlessly into your firm blubbery flanks, and hangs down nearly to your knees, flabbily undulating after each step and constantly challenging your powerful muscles with its unpredicatble swaying; there are thick folds on your sides that stretch from under your shoulders to your gut, and are a hand&#39;s length deep. Your stout and burly tail end is munificently padded with fat.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Whenever you break a streak of glutting yourself with highly nutritious delicacies for long enough, your tremendous gut - nearly as large and heavy as the rest of you, its circumference dominating your silhouette - is a rotund entity in itself, and makes it look like you&#39;ve just emptied a town&#39;s winter provision cellar; if someone were to embrace you, they&#39;d have to recline on its upper shaky slope, or try their luck squeezing themselves into its reluctantly yielding mass. It forms a single whole with your massively chubby hips, and dangles down to your knees, powerful tremors washing over it with each labored step; the thick folds on your flanks are a forearm&#39;s length deep, and nearly encircle your form from under the shoulders to the belly, stopping just short of meeting in the middle of it. Your delicate and soft bottom is filled out with a layer of blubber at least a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Whenever you break a streak of glutting yourself with highly nutritious delicacies for long enough, your tremendous gut - nearly as large and heavy as the rest of you, its circumference dominating your silhouette - is a rotund entity in itself, and makes it look like you&#39;ve just emptied a town&#39;s winter provision cellar; if someone were to embrace you, they&#39;d have to recline on its upper protruding slope, or try their luck squeezing themselves into its reluctantly yielding mass. It forms a single whole with your massively chubby hips, and dangles down to your knees, powerful tremors washing over it with each labored step; the thick folds on your flanks are a forearm&#39;s length deep, and nearly encircle your form from under the shoulders to the belly, stopping just short of meeting in the middle of it. Your delicate and soft buttocks are filled out with a layer of blubber at least a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Whenever you break a streak of glutting yourself with highly nutritious delicacies for long enough, your tremendous gut - nearly as large and heavy as the rest of you, its circumference dominating your silhouette - is a rotund entity in itself, and makes it look like you&#39;ve just emptied a town&#39;s winter provision cellar; if someone were to embrace you, they&#39;d have to recline on its upper slope, or try their luck squeezing themselves into its reluctantly yielding mass. It forms a single whole with your massively chubby hips, and dangles down to your knees, powerful tremors washing over it with each labored step; the thick folds on your flanks are a forearm&#39;s length deep, and nearly encircle your form from under the shoulders to the belly, stopping just short of meeting in the middle of it. Your delicate and soft backside is filled out with a layer of blubber at least a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Whenever you break a streak of glutting yourself with highly nutritious delicacies for long enough, your stupendously filled out paunch - nearly as large and heavy as the rest of you, its circumference dominating your silhouette - constitutes a near-globe that lags a few seconds behind the movements of your body proper and making you look as if you&#39;ve just turned an acre of ripe fruit orchards into a bereft skeletal shadow of their former selves; if someone were to embrace you, they&#39;d have to recline on its upper slope, since the expansive dome of your gut is too solidly to allow squeezing into it. It forms a single whole with your stout, yet heavily fattened hips, and hangs down to your knees, sloshing violently after each step; the thick folds on your flanks a forearm&#39;s length deep, and nearly encircle your form from under the shoulders to the belly, stopping just short of meeting in the middle of it. Your massively obese tail end sags down despite the mighty musculature lurking under all the padding.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						During brief lulls in your feasting schedule when you are not stuffed to the gills, your immense belly - about as large and heavy as the rest of you, and the definite focal point of your anatomy - has its own center of mass and inertia that asserts itself whenever a rapid movement is made, and looks like you have just swallowed a small cow; if someone were to embrace you, they&#39;d have to climb onto its upper sloping suface, and extending a hand in greeting to a more modestly built person would invite them to brush against your paunch to make the clasp. Your belly incorporates your astoundingly filled-out hips, and sinks down past the knees, with each lumbering step making it wobble and slosh threateningly; the great blubbery rolls on your flanks are an arm&#39;s length deep and encircle your form from under the shoulders to the middle of the belly. Your bottom has the texture of a fine spongy dessert, and is given its girth by a cusion of lard
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly two feet&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						During brief lulls in your feasting schedule when you are not stuffed to the gills, your immense belly - about as large and heavy as the rest of you, and the definite focal point of your anatomy - has its own center of mass and inertia that asserts itself whenever a rapid movement is made, and looks like you have just swallowed a small cow; if someone were to embrace you, they&#39;d have to climb onto its upper sloping suface, and extending a hand in greeting to a more modestly built person would invite them to brush against your paunch to make the clasp. Your belly incorporates your astoundingly filled-out hips, and sinks down past the knees, with each heavy step making it wobble and slosh terribly; the great blubbery rolls on your flanks are an arm&#39;s length deep and encircle your form from under the shoulders to the middle of the belly. Your buttocks have the texture of a fine spongy dessert, and are given their girth by a cusion of lard
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly two feet&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						During brief lulls in your feasting schedule when you are not stuffed to the gills, your immense belly - about as large and heavy as the rest of you, and the definite focal point of your anatomy - has its own center of mass and inertia that asserts itself whenever a rapid movement is made, and looks like you have just swallowed a small cow; if someone were to embrace you, they&#39;d have to climb onto its upper sloping suface, and extending a hand in greeting to a more modestly built person would invite them to brush against your paunch to make the clasp. Your belly incorporates your astoundingly filled-out hips, and sinks down past the knees, with each resounding step making it wobble and slosh powerfully; the great blubbery rolls on your flanks are an arm&#39;s length deep and encircle your form from under the shoulders to the middle of the belly. Your backside has the texture of a fine spongy dessert, and is given its girth by a cusion of lard
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly two feet&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						During brief lulls in your feasting schedule when you are not stuffed to the gills, your overflowing stomach - about as large and heavy as the rest of you, and definitely the focal point of your stout anatomy - is so overgrown that its forceful and unpredictable impetus is hard to counteract even for your mighty muscles, and in addition it gives you an appearance of someone who has just gorged himself on a small flock of sheep; if someone were to embrace you, they&#39;d have to scale its mounting enormity, and extending a hand in greeting to a more modestly built person would invite them to brush against your paunch to make the clasp. Your belly absorbs your heavy, blubbery hips, and drops down past the knees, adopting a squishy pattern of wobbling throughout its spherical surface whenever you waddle forward; the hefty folds on your hardy flanks are an arm&#39;s length deep, and encircle your form from under the shoulders to the middle of your belly. Your tail end conceals the prodigious athleticism of its glutes by the pillow of quivering fat
						&lt;&lt;if $options.metric&gt;&gt;more than half a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;nearly two feet&lt;&lt;/if&gt;&gt;
						 thick.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						On the elusively unlikely occasion of you having had enough time to process all of your last fabulously immoderate banquet before delving into the next one, your dreadfully enormous gut - comprising the indisputed majority of your physique in weight, size and nutritional equivalent - swells into a tremendous segmented mass in front of you, and looks like you have just had a small whale for breakfast; if someone wished to shake hands with you, they&#39;d have to squeeze hard into the softer outer layers of lard just to make a clasp. Your paunch and your astoundlingly thoroughly fattened hips meld together, and swag low enough to brush against the ground, and every time you make a step the entire great bulk explodes into a breathtaking dispay of wobbing and quivering flesh that has different amplitude and patterns depending on the agitated part, and it lasts for a dozen seconds at the very least; the flesh on your sides is compressed into barrel-thick stratas of lard by its own weight, and the deepest folds - deep enough to lose a suit of plate armour in - encircle your form from under the shoulders to the middle of the belly. Your buttocks consist of tightly pressed, fold-ridden, swollen cushions of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						On the elusively unlikely occasion of you having had enough time to process all of your last fabulously immoderate banquet before delving into the next one, your dreadfully enormous gut - comprising the indisputed majority of your physique in weight, size and nutritional equivalent - swells into a tremendous segmented mass in front of you, and looks like you have just had a small whale for breakfast; if someone wished to shake hands with you, they&#39;d have to squeeze hard into the softer outer layers of lard just to make a clasp. Your paunch and your astoundlingly thoroughly fattened hips meld together, and swag low enough to brush against the ground, and every time you make a step the entire great bulk explodes into a breathtaking dispay of wobbing and quivering flesh that has different amplitude and patterns depending on the agitated part, and it lasts for a dozen seconds at the very least; the flesh on your sides is compressed into barrel-thick stratas of lard by its own weight, and the deepest folds - deep enough to lose a suit of plate armour in - encircle your form from under the shoulders to the middle of the belly. Your backside consists of tightly pressed, fold-ridden, swollen cushions of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						On the elusively unlikely occasion of you having had enough time to process all of your last fabulously immoderate banquet before delving into the next one, your dreadfully enormous gut - comprising the indisputed majority of your physique in weight, size and nutritional equivalent - swells into a tremendous segmented mass in front of you, and looks like you have just had a small whale for breakfast; if someone wished to shake hands with you, they&#39;d have to squeeze hard into the softer outer layers of lard just to make a clasp. Your paunch and your astoundlingly well-fattened hips meld together, and swag low enough to brush against the ground, and every time you make a step the entire great bulk explodes into a breathtaking dispay of wobbing and quivering flesh that has different amplitudes and patterns depending on the agitated part, and it lasts for about a dozen seconds; the flesh on your sides is compressed into barrel-thick stratas of lard by its own weight, and the deepest folds - deep enough to lose a suit of plate armour in - encircle your form from under the shoulders to the middle of the belly. Your backside consists of tightly pressed, fold-ridden, swollen cushions of fat
						&lt;&lt;if $options.metric&gt;&gt;more than a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						On an elusively unlikely occasion of you having had enough time to process all of your last fabulously immoderate banquet before delving into the next one, your colossal gut - comprising the indisputed majority of your physique in weight, size and nutritional equivalent - is so ponderous and independently mobile that a forceful motion is liable to send it into an avalanche of conflicting swings, sways and heaves that even your outstanding brawn would not hope to contain, and it looks swollen with a freshly swallowed small, but portly wyvern; if someone wanted to shake hand with you, they&#39;d have to climb on the yielding slope on your belly just to make the clasp. Your paunch and your gorgeously filled-out hips lack definitive features separating them, and plummet low enough to scrape the ground, surging with mercurial ripples and breathtaking, fold-rearranging waves after every heavy step; the flesh on your flanks furrows into a lumber pile-thick slabs of lard, with the deepest fold - deep enough to lose a suit of plate armor in - encircles your form from under the shoulders to the middle of your belly. Your intensely trained glutes are throughly buried under a padding of flab
						&lt;&lt;if $options.metric&gt;&gt;more than a meter&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;a few feet&lt;&lt;/if&gt;&gt;
						 thick.
				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;		
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="544" name="describe quest item" tags="" position="1575,675" size="100,100">__&#39;&#39;$itemUsed.Name&#39;&#39;__&lt;br&gt;
$itemUsed.description
&lt;hr&gt;

/* FEEDER EXPANSION EDIT - START */
&lt;&lt;if $itemUsed.Name == &quot;Witch&#39;s notes&quot;&gt;&gt;
	&lt;&lt;include &quot;feeder read witch notes&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;hr&gt;
/* FEEDER EXPANSION EDIT - END */

[&lt;&lt;popup &quot;Back&quot; &quot;Key Items&quot;&gt;&gt;]</tw-passagedata><tw-passagedata pid="545" name="describe shoulders" tags="" position="3600,600" size="100,100">&lt;&lt;switch $p.him&gt;&gt;
	&lt;&lt;case $female.him&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a frail, sickly face, a dainty neck with thin $p.furBack $p.fur covering it, and weakly slumped shoulders.
						
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face of nobly ascetic features, an elegantly thin neck tautly wrapped in $p.furBack $p.fur and shoulders that you carry with grace despite seemingly not having much flesh on them.
						
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a chisled, rigid face, a strong and lithe neck with all that gives it power evident through its $p.furBack $p.fur, and exceptionally hardened shoulders.
						
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a tough, roughly-featured face, the $p.furBack $p.fur of your thick neck is constantly shifting with the steely muscles coiling underneath, and your broad amazonian shoulders brim with condensed might.
						
				&lt;&lt;/switch&gt;&gt;
				
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a typical soft-featured face, a narrow neck with a hint of vitality under its $p.furBack $p.fur, and fairly frail shoulers.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face with mercurial features, an elegant thin neck with sinews barely visible through the $p.furBack $p.fur, and shoulders that you keep straight without effort.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a finely toned face, a strong and lithe neck with clear strength under its $p.furBack $p.fur, and hardened shoulders that nonetheless remain smoothly elegant.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have tough, yet refined features, a titanically developed neck tautly wrapped in $p.furBack $p.fur, and broad, looming shoulders rife with toil-hardened flesh.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a modestly full-cheeked face, a smooth tender neck with glossy $p.furBack $p.fur around it, and soft, slightly sagging shoulders.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a soft face with animated features, an agile neck smoothly covered in $p.furBack $p.fur and firmly held, but supply-textured shoulders.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a hard-boned, yet delicately rounded face, a strong, hardy neck with a smattering of flab under its $p.furBack $p.fur, and smoothly elegant shoulders that are nonetheless increadibly well-exercised and resilient.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a solid face with its hardest edges smoothened just a bit, a sturdy neck that suggests lightning reflexes despite its thickness and a scarce padding under its $p.furBack $p.fur, and broad powerful shoulders are given a degree of elegance by your natural softness.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a delicately rounded face, a tender neck with little strength under its $p.furBack $p.fur, and slightly sagging shoulders with a decent layer of downy flesh covering them.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an ample, expressive face, a firm neck with its volume enhanced by a layer of fluff under your $p.furBack $p.fur, and firmly held, but smoothly rounded shoulders.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a decisive, strong-featured face evened out by downy cheeks, a toned and pliant neck made supple by the softer flesh under its $p.furBack $p.fur, and powerful shoulders with hard muscles subtly hinted at by their volume and vague outlines.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a face with sharp and focused features smoothened a little by your supple cheeks, a mighty neck which is still quite soft to the touch due to minor pudginess under its $p.furBack $p.fur, while the steep arch of your broad, lightly padded shoulders are nothing short of grandiose in terms of brawn.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a doughy face with prominent cheeks, a bit of a second chin, a plump neck with very little strength flowing under its $p.furBack $p.fur, and droopy shoulders saturated with fat.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face touched by urgency and work, but otherwise quite plump, firmly held neck with a good deal of squishier stuff under its $p.furBack $p.fur, and liberally filled-out shoulders that you hold upright nonetheless.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a hard-featured face with peculiarly prominent cheeks, a mighty neck with enough fluff under its $p.furBack $p.fur to give it a doughy texture, and excellently developed shoulders concealing their strength under the plush exterior.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a strong-jawed face with modestly pouting cheeks, a flabby neck that is still evident as being splendidly developed under its $p.furBack $p.fur, and formidable broad shoulders with all their brawn nearly completely covered up by yielding fat.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a well-fed face with round, firmly plump cheeks, a tenderly chubby neck with its $p.furBack $p.fur stretching softly from your collarbone to your chin, and meekly slumped pudgy shoulders.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a quick-featured face with heartily chubby cheeks, a fatty, yet agile neck with its $p.furBack $p.fur stretching softly from your collarbone to your chin, and shoulders held with dignified grace that isn&#39;t diminished by how well-padded they are.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an athletic face, sharp-eyed and concentrated, but with pudgy, firm cheeks, a fleshy neck with its $p.furBack $p.fur stretching softly from your collarbone to your chin and its strength revealing itself during dashing gymnastic bouts, and broad, thoroughly plumped up shoulders hiding significant power deep down.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a face of a mighty $p.gentleman brawler adorned with firm, rounded cheeks, a plushly padded neck with its $p.furBack $p.fur stretching softly from your collarbone to your chin and physical power evidencing itself despite all the glossy cover, and broad burly shoulders that nonetheless look merely thick and pudgy unless a flex brings their true power to the forefront.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a face with rounded pouting cheeks smoothly flowing into your generously pudgy, supple neck that lends its padding&#39;s softness to its $p.furBack $p.fur, and slack shoulders sporting significant insulation.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face with rounded pouting cheeks smoothly flowing into your generously pudgy, supple neck that lends its padding&#39;s softness to its $p.furBack $p.fur, and often drooping shoulders sporting significant insulation with a tiniest hint of vigor surfacing every once in a while.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a quick-eyed, martial face decorated with plumply pouting cheeks that flow smoothly into your firmly held neck that has a profound abundance of pudge under its $p.furBack $p.fur, and thickset, evidently well-developed, but also intesively fleshy shoulders.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a face hardened by toil, but then softened still by a set of pudgy cheeks proudly standing out and smoothly flowing into your thickly built and hardy-looking neck wrapped in thick flab under its $p.furBack $p.fur, and stout, imposingly broad shoulders with enough padding to fully obscure the texture of iron muscle.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a fluffy face with doughy cheeks bulging forth, expanding gently into your tender, voluminous neck that has more than enough soft fat padding its $p.furBack $p.fur, and languidly slouched shoulders also rife with jiggling flesh.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a quick-eyed face with doughy cheeks bulging forth, expanding gently into your tender, voluminous neck that has more than enough soft fat padding its $p.furBack $p.fur, and shoulders that you strain to keep upright, also rife with jiggling flesh.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a determined face with firm cheeks bulging cheerfully, swelling moderately downwards into your surprisingly graceful neck wrapped in thick, soft layers of pudge beneath its $p.furBack $p.fur, and firmly balanced, but throughly corpulent shoulders.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a face that doesn&#39;t flinch at the smithy&#39;s smoldering heat nor at the sound of battle, and has cheeks ripely bulging from the sides of your head, meagerly growing in girth as they flow into your steady, but profusely flabby neck, and hardily built shoulders that area still unbelievably soft-fleshed under their $p.furBack $p.fur.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a face rounded and plumped by scores of hearty meals, and have swollen cheeks resting on the thick collar of fat under the $p.furBack $p.fur of your downy neck, and amazingly fleshy shoulders slumped mirthlessly.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face rounded and plumped by scores of hearty meals, and have swollen cheeks resting on the thick collar of fat under the $p.furBack $p.fur of your soft neck, and amazingly fleshy shoulders that get slumped sadly whenever you&#39;re not watching your posture.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a face with quick features weighted down by by the robust, chubby cheeks resting on the thick collar of fat under the $p.furBack $p.fur of your strong neck, and admirably well-held, stoutly built shoulders jiggling with the flab padding them.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a portly face with heroic features and generously flabby cheeks resting on the thick collar of fat under the $p.furBack $p.fur of your mighty neck, and broad, brawny, but still profusely blubbery shoulders.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						The heaving mass of your body makes your head appear disproportionately small, and your pained chubby face has its $p.mouth beginning to drown in the prominent blubbery cheeks sagging onto the voluminous roll of fat stretching the $p.furBack $p.fur of your neck; your gloriously chubby shoulders are always hopelessly slouched.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						The heaving mass of your body makes your head appear disproportionately small, and your chubby face has its $p.mouth beginning to drown in the prominent blubbery cheeks sagging onto the voluminous roll of fat stretching the $p.furBack $p.fur of your neck; your gloriously chubby shoulders can often be seen hopelessly slouched.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						The heaving mass of your body makes your head appear disproportionately small, and your alert chubby face has its $p.mouth beginning to drown in the prominent blubbery cheeks sagging onto the voluminous roll of fat stretching the $p.furBack $p.fur of your neck; your gloriously chubby shoulders are slouched whenever you are at rest, and assume a hard, rigid posture at times of need.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						The heaving mass of your body makes your head appear disproportionately small, and your resolute face is heavily padded and has its $p.mouth beginning to drown in the weighty bouncing cheeks laying on the voluminous roll of fat stretching the $p.furBack $p.fur of your sturdy neck; your steadfast, burly shoulders are inordinately full of softer flesh.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						The grandiose bell-shape of your body makes your head appear peculiarly petite, and your beset fatty face has a smothered quality to it because your $p.mouth is halfway enfolded by the bulging corpulent cheeks that spill onto the blubbery scarf tightly padding the $p.furBack $p.fur of your feeble neck; your shoulders, mind-bogglingly both softened and solidified by the plentiful layers of flab, are desperately slumped down even at the best of times.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						The grandiose bell-shape of your body makes your head appear peculiarly petite, and your harassed fatty face has a smothered quality to it because your $p.mouth is halfway enfolded by the bulging corpulent cheeks spilling onto the blubbery scarf tightly padding the $p.furBack $p.fur of your neck; your shoulders, mind-bogglingly both softened and solidified by the plentiful layers of flab, are weakly slumped down even at the best of times.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						The grandiose bell-shape of your body makes your head appear peculiarly petite, and your alert fatty face has a smothered quality to it because your $p.mouth is halfway enfolded by the bulging corpulent cheeks spilling onto the blubbery scarf tightly padding the $p.furBack $p.fur of your neck; your hardy shoulders, mind-bogglingly both softened and solidified by the plentiful layers of flab, are slumped heavily when at ease.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						The grandiose bell-shape of your body makes your head appear peculiarly petite, and your quick-featured portly face has a $p.mouth halfway sunken into the firm lardy cheeks propped up on the blubbery scarf tightly padding the $p.furBack $p.fur of your mighty neck; your shoulders are given expansive volume and breadth by a
						&lt;&lt;if $options.metric&gt;&gt;few dozen centimeters&lt;&lt;/if&gt;&gt;
						&lt;&lt;if !$options.metric&gt;&gt;foot&lt;&lt;/if&gt;&gt;
						-thick layer of fat as well as the harder flesh buried deep, deep inside them, and have a dignified tone to their bearing.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						The monumental measurements of your body make your head to appear insignificant in comparison, and your face is locked in an expression of overworldly anguish, and your $p.mouth is nearly all gone into the stifling embrace of the wobbling lardaceous cheeks flagging onto the multiple loaf-thick rolls of fat stretching the $p.furBack $p.fur of your weak neck; your frailly muscled shoulders are saved from slouching by the generous padding of your sides, and are magnificently padded with fat themselves.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						The monumental measurements of your body make your head appear insignificant in comparison, and your face is locked in an expression of overworked desperation, and your $p.mouth is nearly all gone into the stifling embrace of the wobbling lardaceous cheeks flagging onto the multiple loaf-thick rolls of fat stretching the $p.furBack $p.fur of your strained neck; your slightly muscled shoulders are saved from slouching by the generous padding of your sides, and are magnificently padded with fat themselves.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						The monumental measurements of your body make your head appear insignificant in comparison, and your face is locked in an expression of resignation to unceasing effort, and your $p.mouth is nearly all gone into the stifling embrace of the wobbling lardaceous cheeks flagging onto the multiple loaf-thick rolls of fat stretching the $p.furBack $p.fur of your resilient neck; your respectably muscled shoulders are saved from slouching by the generous padding of your sides, and are magnificently padded with fat themselves.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						The monumental measurements of your body make your head appear insignificant in comparison, and your harassed, but uncompromisingly resolute face has its $p.mouth nearly engulfed by the unbelievably filled out cheeks drooping onto the multiple loaf-thick rolls of fat padding the $p.furBack $p.fur of your burly neck; your broad shoulders are hardy and excellently developed despite the massive coat of lard padding them and the thick stuffing on your sides that prop your shoulders up a little.
				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;default&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a practically cadaverous face with pronounced cheekbones and jawline, a thin and sinewy neck, and sagging shoulders with $p.furBack $p.fur stretched tautly around them.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a gaunt face with animated features, an ascetic neck with pronounced sinews, and ruggedly built shoulders tightly wrapped in $p.furBack $p.fur that you keep firm and high.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an angular, sharp-featured face with powerful cords rolling under your jaw when you speak, a thick, hard-textured neck and broad, well-developed shoulders with $p.furBack $p.fur wrapped firmly around them.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a blocky, rock-hard face that radiates determination and might, a thick neck bulging with powerful bulging flesh and immensely broad shoulders with iron trapezius and looming deltoids stretching their $p.furBack $p.fur.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a regularly shaped face, a lean neck and unimpressive shoulders covered in $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face with animated features, a firmly held neck and equally toned shoulders that have the beginnings of might budding under their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a strong-jawed face, a thick hardy neck and broad shoulders with well-developed muscles apparent under their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an iron-jawed, sturdy face that a king of old might have had, a hefty, potent neck, and broad shoudlers with their $p.furBack $p.fur crawling with the restless overdeveloped trapezius and deltoids.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a tender-featured face, a smooth neck and shoulders with insignificant soft padding under their $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an alert, smooth face, a neck that doesn&#39;t quite reveal the reason for its firmness, and shoulders with vague suggestion of strength under their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a supple, strong-jawed face, a smooth stalwart neck and broad shoulders whose formidable might is softened by the slimmest of padding under their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have an slightly plump angular face, an unyielding neck bulging with powerful flesh, and immensely broad, well-trained shoulders that stretch their $p.furBack $p.fur tautly, but have the outlines of rippling brawn subdued a fraction by the meager cover of fat.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a mildly rounded face, a soft feeble neck and sagging shoulders with quite a bit of padding under the $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an animated, plump-cheeked face, a neck that is tender to the touch, but implying tone and firmness by its brisk movements, and seemingly tender shoulders smoothly wrapped in $p.furBack $p.fur held firmly upright.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a plushly cheeked, but strong-featured face, a mighty neck that is downy to the touch, and strong broad shoulders mostly advertised as such by the joint volume of toned flesh and plump padding under their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a full-blooded and brawny face, an imposingly strong neck, and profoundly developed broad shoulders appearing even broader for the added volume your padding its $p.furBack $p.fur.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a full face with round drooping cheeks, a feeble neck with enough flab to form a second chin under the jaw, and slumping soft shoulders amply padded under their $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face with quick features and rounded cheeks, a second chin only visible when you sink your neck into your doughy shoulders, which have a good proportion of loose and hardened flesh under their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a stout, hard-featured face, a thick hardy neck that also has substantial padding, and broad, heavyset shoulders with their $p.furBack $p.fur bolstered by a hearty testament to your dining habits.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a face with focused, controlled features that remain imposing even in spite of the soft cheeks, a thick neck with power subtly shifting under its doughy exterior, and immensely developed deltoids well-hidden by a plush cover of fat under the $p.furBack $p.fur your broad shoulders.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a rounded face with firmly plump cheeks, an untoned neck so chubby it runs streamlined from your collarbone to your chin, and limply hanging shoulders with a good helping of fat under their $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have an alert face with robust cheeks, a toned neck that is still so chubby it runs streamlined from from your collarbone to your chin, and firm, plump shoulders given an nice swell by a layer of fat under their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have a hard-featured face with pudgy cheeks, a sturdy neck that is so thick and generously padded it runs streamlined from your collarbone to your chin, and broad, heavy shoulders richly lined with fat under their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a seasoned athlete&#39;s face softened by the chubby cheeks, a mighty neck that is still plump enough to run streamlined from your collarbone to your chin, and colossally broad shoulders that conceal their awesome strength with the significant layer of fat under their $p.furBack $p.fur.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a face with pouting pudgy cheeks smoothly flowing into your thick and swollen neck, and down to your heavily slouching shoulders that are very thickly padded under your $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a face with pouting pudgy cheeks smoothly flowing into your thick and swollen neck, and down to your shoulders that are very thickly padded under your $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an alert face with cheeks plumply standing out and smoothly your neck that has the stiffness of tone as well as the lush yielding texture of fat, and broad, thick shoulders that you need to really push into to hit hard muscle under the padding of their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a hard-featured, but tender-textured face sporting pouting chubby cheeks that flow down to your thick, hardy neck also wrapped generously in a more supple flesh, and lower into formidably broad shoulders that are so well padded under their $p.furBack $p.fur that one can only guess as to the extent of terrific strength lurking within.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have a doughy face with cheeks bulging prominently before slightly swelling into your fat neck, and down to your powerlessly slumped shoulders that are thickened with a great deal of soft flesh under your $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have a well-fed face with firm cheeks bulging prominently before slightly swelling into your fat neck, and down to your slumped shoulders that are thickened with a great deal of soft flesh under your $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an animated face with firmly bulging cheeks that expand slightly into your thick, firmly held neck that is given most of its soft volume by its fat, and broad, burly shoulders that have a impressive amount of padding under their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a hard-eyed, yet amply rounded face with firmly bulging cheeks gaining volume as they flow into your sturdy, but generously fattened neck, and imposingly spanning shoulders with prodigiously thick padding under their $p.furBack $p.fur.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						You have the tired face of an eating contest champion, with bulging blubbery cheeks resting on the thick collar of fat around your tender neck, and your helplessly drooping shoulders have lush pudge tautly stretching their $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						You have the face of an eating contest champion with bulging blubbery cheeks resting on the thick collar of fat around your neck, and your drooping shoulders have lush pudge tautly stretching their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						You have an alert face with ripely pouting lardy cheeks resting on the thick collar of fat around your neck, and your broad, heavily built shoulders that have copious amounts of adipose padding their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						You have a face obviously touched by hardship and effort under its gorgerously chubby cheeks that rest on the thick collar of fat around your rigidly held neck, and your sprawling, indomitable shoulders have their $p.furBack $p.fur engorged with layers of flab.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						The massive bulk of your body makes your head look tiny in comparison, and your perpetually tired face is blubbery, with your $p.mouth nearly halfway engulfed by the portly cheeks drooping onto the weighty roll of flab your neck is bulging with; your pathetically hanging shoulders have an immensely thick coating of fat under their $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						The massive bulk of your body makes your head look tiny in comparison, and your face is blubbery, with your $p.mouth nearly halfway engulfed by the portly cheeks drooping onto the weighty roll of flab your neck is bulging with; your weakly hanging shoulders have an immensely thick coating of fat under their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						The massive bulk of your body makes your head look tiny in comparison, and your energetic face is blubbery, with your $p.mouth nearly halfway engulfed by the portly cheeks drooping onto the weighty roll of flab your neck is bulging with; your exhaustedly slumped broad shoulders have an immensely thick coat of fat under their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						The massive bulk of your body makes your head look tiny in comparison, and your world-weary face is supremely well-fed, with your $p.mouth nearly halfway engulfed by the poutng chubby cheeks folding below against the weighty roll of flab your neck is bulging with; your unbelievably firm-looking, broad shoulders have their $p.furBack $p.fur copiously padded with fat.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						The giant doming mass of your body makes your head look diminutive in comparison, and your anguished face is swollen enough to make half of your $p.mouth sink into the ladaceous cheeks sprawled on the slab of fat that your weak neck is distended by; your pitifully slouched shoulders have a barrelful of blubber stretching their $p.furBack $p.fur.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						The giant doming mass of your body makes your head look diminutive in comparison, and your vexed face is swollen enough to make half of your $p.mouth sink into the ladaceous cheeks sprawled on the slab of fat that your neck is distended by; your pitifully slouched shoulders have a barrelful of blubber stretching their $p.furBack $p.fur.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						The giant doming mass of your body makes your head look diminutive in comparison, and your focused face is swollen enough to make half of your $p.mouth sink into the ladaceous cheeks sprawled on the slab of fat that your alertly kept neck is distended by; your heavily slouched broad shoulders have a barrelful of blubber stretching their $p.furBack $p.fur.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						The giant doming mass of your body makes your head look diminutive in comparison, and your resolute face is so stuffed with blubber that half of your $p.mouth sinks into the swollen cheeks sprawled on the slab of fat that your neck is distended by; your shoulders, while broad and brawny in size, have their $p.furBack $p.fur unstintingly bolstered with lard.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						The gargantuan bulk of your body makes your head look miniscule in comparison, and your desperately tortured face is so well-fed that most of your $p.mouth has become smothered between your bloated cheeks, which spill onto the multiple loaf-thick rolls of fat that engorge your unsteady neck; your shoulders lack the power to support themselves, but are propped up by your swollen sides, and have their own $p.furBack $p.fur tautly stretched by the incredible abundance of blubber underneath.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						The gargantuan bulk of your body makes your head look miniscule in comparison, and your tortured face is so well-fed that most of your $p.mouth has become smothered between your bloated cheeks, which spill onto the multiple loaf-thick rolls of fat that engorge your unsteady neck; your shoulders lack enough power to support themselves, but are propped up by your swollen sides, and have their own $p.furBack $p.fur tautly stretched by the incredible abundance of blubber underneath.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						The gargantuan bulk of your body makes your head look miniscule in comparison, and your alert, but pained face is so well-fed that most of your $p.mouth has become smothered between your bloated cheeks, which spill onto the multiple loaf-thick rolls of fat that engorge your unsteady neck; your broad shoulders possess just about enough power to support themselves, but are propped up by your swollen sides anyway, and have their own $p.furBack $p.fur tautly stretched by the incredible abundance of blubber underneath.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						The gargantuan bulk of your body makes your head look miniscule in comparison, and your enduring and hard-eyed face is wantonly fattened to the point of your $p.mouth becoming mostly trapped between the bouncing blubbery masses of your cheeks, which rest on multiple loaf-thick rolls of fat wrapped around your hardy neck; your broad shoulders ride proudly on the cushions of your filled-out sides, but harbour terrific might under all the countless layers of lard stretching their $p.furBack $p.fur.
				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="546" name="describe upper" tags="" position="3700,600" size="100,100">&lt;&lt;switch $p.him&gt;&gt;
		&lt;&lt;case $female.him&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are unseeminlgy bony, your chest is scantly fleshed with practically no breasts to speak of, while your back is too fragile to keep straight without a considerable effort.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms have all the signs of strength and pliancy, your toned chest has next to no unnecessary flesh on it, while your back is always prepared to perform a speedy transition from a firm posture into quick motion.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms have firm tissues tighly wound around them, your chest has well-defined muscles with little else to push against a bodice or a breastplate, while your strong back is like a spring straining under immense tension and ready to fly into action at any second.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are bound in firm, unyielding muscles that give them respectable girth, your small-bosomed chest is otherwise profoundly fleshed with pectorals and serratis, while your broad, rippling, knot-riddled back is might made manifest.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are slender and seemingly unused to labour, your chest is rather slim and moderately endowed, while your back is too delicate for its own sake.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms may appear slender, but there is a firmness and agility to their texture, your toned chest has respectable bosoms decorating it, while your back is lithe, powerful, but smooth.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are evidently powerful, your chest is well-developed and not lacking in its softer aspect, while your strong back is like a wound spring ready to fly into action.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are incomparably brawny and awesomely thick, the flesh of your chest is perfected through punishing exercise, with feminine features just modest enough not to get in the way, while your tighly-wound and stalwart back naturally keeps a heroic posture.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are downy and delicate, your tender chest is supporting quite impressive bosoms, while your smooth back is a little limp.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms may be smooth in texture, but swift and strong in function, your subtly toned chest has large, firm bosoms decorating it and your back, while tender to the touch, harbours quite a bit of both strength and pliancy.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms look powerful even despite the seeming tenderness, your chest is well-developed as well as well-endowed, while your back is powerful and smooth.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms fail to hide thick steely muscles under their soft exterior, your upper body is superbly developed, which also goes for your sizable breasts that assert their presence in motion, while your thoroughly exercised, yet elegantly smooth back lends your stance an air of feminine regality.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are pudgy within the bounds of propriety, your downy chest is significantly and softly buxom, while your dainty, yet well-padded back is a nice substitute for chair cushions when you are forced to content your sitting needs with hard furniture.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are soft and yielding to the touch, but possess uncanny limberness and capable of applying force, your somewhat pudgy chest has some tone deep down and benefits from the extra volume in the bust area, while your exercised back shies away from making its athletic nature apparent.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms have a bit of padding making the outlines of trained muscles slightly blurry, your firm and proudly held chest is otherwise quite fleshy, while your stoutly built back is hardened far beyond its plush appearance.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms possess an outward tenderness that is betrayed by their volume and the occasional mighty flexing motion, your outstandingly sturdy upper body is profoundly filled out in all aspects, while your broad, heavily muscular back is bolstered with soft flab, but not quiet well enough to mask the underlying brawn.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms don&#39;t have much strong flesh on them despite being quite fleshy, your pudgy chest is blessed with large, doughy bosoms; your plush back is elegantly smooth, but is deprived of strength and flexibility, and there is a number of folds that appear where it meets the curve of your hips.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are well-exercised and nimble, but also doughy in texture, your smooth chest has a good tone completely obscured by the plentiful padding and your enviably-sized breasts; your steady back clearly belongs to someone who&#39;s been eating well, and there is a number of small folds that appear where it meets the curve of your hips.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms have quite a bit of padding making the outlines of your strong biceps blurry, your chest is throughly athletic on the inside, but is so plumped up on the outside and supports such a weighty bust that it nearly makes its mighty musculature unnoticeable; your limber, tough back has its strength covered up by the results of good eating equally well, and there is a number of minor folds that appear where it meets the curve of your hips.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are unmistakably powerful and gorgeously thick, even with the plump texture that they assume at rest, your tenderly-padded, heavily buxom torso is otherwise tremendously strong; your indomitable back&#39;s plentyful fluff only lends to its graceful fluidity, and there are a few tiny folds that appear where it meets the curve of your hips.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms haven&#39;t ever received a proper training and are soft with flossy flab, your exceptionally plump chest supports heavy, firm bosoms; your poor richly-fleshed back is sagging under its burden, and there are multiple thick folds where it meets the slope of your hips.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are pudgy and yielding to the touch, but are capable far beyond their soft appearance, your well-padded chest breathes exuberant energy and sports a large, bouncy bust; your very plump back does a good job keeping your torso steady, and there are multiple folds where it meets the slope of your hips.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are thick and firm, implying strong, well-developed muscles lying below the fluffy cover, while your chest, thoroughly athletic though it is, appears smooth and tender unless you flex it, and is further covered by the plump, heavy mammaries; your smoothly pudgy back is evidently stalwart enough to cope with your body&#39;s challenges as well as those imposed by the adventuring life, and there are multiple folds where it meets the slope of your hips.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are very well-padded, but also greatly tempered by work and fighting, your generously pudgy torso has heroic musculature flexing through its softer lining and is endowed with firm, weighty breasts; your lushly fleshy back shows off its immense power through your steeled stance and posture, and there are multiple small folds where it meets the slope of your hips.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms have their volume significantly increased by all the squishy flesh on them that jiggles quite a bit when you move, and your thoroughly chubby chest is endowed with ripely firm, heaving breasts. Your pitiably strained back is superbly well-padded, and the flesh under the shoulder blades folds up against the plump slopes of your hips, forming deep creases.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms have their volume significantly increased by all the squishy flesh on them that jiggles quite a bit when you move, and your thoroughly chubby chest is endowed with ripely firm, heaving breasts. Your back has a an air of defiant dignity about its strained bearing, it is lushly well-padded, and the flesh under the shoulder blades folds up against the plump slopes of your hips, forming deep creases.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are very pudgy as well as sturdy and jiggle quite a bit when you move, and your thickly insulated chest displays a weighty, robustly rounded bust. Your luxuriantly doughy back is steadily coping with the serious challenges imposed on it due to its training and brawn, and the flesh under the shoulder blades folds up against the plump slopes of your hips, forming thin creases.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are powerful in form and function, despite the generous cover of fat that jiggles quite a bit when you move, and your outstandingly well-fed upper body has faced training more than sufficient to account for the added weight, is gorgeously buxom. Your profoundly well-padded back ripples whenever the powerful, hardened strength inside is called upon, and the flesh under the shoulder blades folds up against the plump slopes of your hips, forming minor creases.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms have the texture of a tender souffle, are as thick as a fit person&#39;s thigh, and jiggle a good deal when you move, while your lushly doughy chest cowers under the weight of its own supple flesh and that of the voluminous and heavy bosoms spilling onto your belly. Your sprawling portly back has its strength grievously tested at all times, and the flesh under the shoulder blades folds up against the girthy slopes of your hips, forming creases deep enough to engulf a finger lengthwise.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms have the texture of a cheesecake, are as thick as a fit person&#39;s thigh and jiggle a good deal when you move, while your lushly doughy chest cowers under the weight of its own supple flesh and that of the grand voluminous and heavy bosoms spilling onto your belly. Your sprawling portly back has its strength tested at all times, but shows no signs of giving in, and the flesh under the shoulder blades folds up against the girthy slopes of your hips, forming creases deep enough to engulf a finger lengthwise.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are amazingly chubby, are as thick as a fit person&#39;s thigh and jiggle a good deal when you move, while your voluminous, squishy torso flaunts sizable heaving breasts spilling down to your belly. Your burly, thickset back has it work cut out for it given the magnitude of all the flabby weight swaying on your frame, and the flesh under the shoulder blades folds up against the girthy slopes of your hips, forming creases deep enough to engulf a finger lengthwise.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are sturdy and firm even with all the plentiful flab in the way, are as thick as a plump person&#39;s thigh and jiggle a good deal when you move, and your stalwartly maintained, stout chest is laden with plumped out breasts larger than a person&#39;s head. Your wide back utterly conceals its formidable musculature under the strata of pudge, and the flesh under the shoulder blades folds up against the girthy slopes of your hips, forming deep creases.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are poor in exercised muscle but affluent in fat, have the thickness of a particularly fluffy pillow, and jiggle strongly when you move; your luxuriantly chubby torso has huge, majestically fleshy breasts flattened against the expanse of your stomach. Your ailing, tormented back needs to be kept staight for fear of falling over, although that feat is helped by its own rich supply of blubber, and the flesh under the shoulder blades folds up against the nearly horizontal slopes of your hips, forming creases that extend far enough to cut into your belly, and are deep enough to envelop a hand&#39;s length.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are are poor in exercised muscle but affluent in fat, have the thickness of a particularly plump pillow, and jiggle strongly when you move; your luxuriantly chubby torso has huge, majestically fleshy breasts flattened against the expanse of your stomach. Your ailing back needs to be kept staight for fear of falling over, although that feat is helped by its own rich supply of blubber, and the flesh under the shoulder blades folds up against the nearly horizontal slopes of your hips, forming creases that extend far enough to cut into your belly, and are deep enough to envelop a hand&#39;s length.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are unstitingly fat, thick as a plump person&#39;s thigh and jiggle strongly when you move; your marvelously fleshy upper body has gorgeous swaying bosoms flattened against the expanse of your stomach. Your overtly chubby back does its best to safeguard you against toppling forward by the merit of its strength, and the flesh under the shoulder blades folds up against the nearly horizontal slopes of your hips, forming creases that extend far enough to cut into your belly, and are deep enough to envelop a hand&#39;s length.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are unbelievably chubby and frighteningly mighty at the same time, are as thick as a plump person&#39;s thigh and jiggle greatly when you move; your burly, superbly fleshy chest sports a set of magnificent weighty mammaries flattened against the expanse of your stomach. Your thoroughly blubbery back admirably bears the stress of maintaining the tilting influences of your belly and hips, and the flesh under the shoulder blades folds up against the nearly horizontal slopes of your hips, forming creases that extend far enough to cut into your belly, and are deep enough to envelop a hand&#39;s length.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are heavy with tender, fatty flesh that suggests a cozy life devoid of menial labor, are as thick as a small treasure chest and quiver powerfully at the slightest action; your amazingly doughy upper body has voluptuously swollen bosoms the size of a ripe pumpkin sagging against the incline of your gut underneath. Your burdensomely fattened back is giving everything it&#39;s got to mediate the terrible weights of your stomach and backside see-sawing beneath. The flesh under your shoulder blades bunches up against the bloated bulges of your hips, forming creases that run alongside your flanks, almost meeting in the middle of the belly, and are deep enough to enwrap a forearm&#39;s length.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are heavy with tender, fatty flesh that suggests a cozy life of little to no menial labor, are as thick as a small treasure chest and quiver powerfully at the slightest action; your amazingly doughy upper body has voluptuously swollen bosoms the size of a ripe pumpkin sagging against the incline of your gut underneath. Your burdensomely fattened back is giving everything it&#39;s got to mediate the terrible weights of your stomach and backside see-sawing beneath. The flesh under your shoulder blades bunches up against the bloated bulges of your hips, forming creases that run alongside your flanks, almost meeting in the middle of the belly, and are deep enough to enwrap a forearm&#39;s length.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are heavy with tender, fatty flesh that suggests a life of all the menial labor outweighed by unrestrained dining, are as thick as a small treasure chest, and quiver powerfully at the slightest action; your amazingly doughy upper body has voluptuously swollen bosoms the size of a ripe pumpkin sagging against the incline of your gut underneath. Your burdensomely fattened back is capable of successfully mediating the terrible weights of your stomach and backside see-sawing beneath. The flesh under your shoulder blades bunches up against the bloated bulges of your hips, forming creases that run alongside your flanks, almost meeting in the middle of the belly, and are deep enough to enwrap a forearm&#39;s length.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms, firmed and hardened through arduous training though they are, have a soft consistency due to the plentiful blubbery padding, are as thick as a grain bag and tremble strongly at every wave or flexing; your large, wonderously doughy torso supports rotund, fleshy breasts the size of a ripe pumpkin slouching against the incline of your paunch below. Your magnificently powerful back defies the odds by doing a sterling job with keeping your heavy form aloft despite being quite lavishly padded with blubber itself. The flesh under your shoulder blades bunches up against the firm bulges of your hips, forming creases that run alongside your flanks before nearly meeting in the middle of the belly, and are deep enough to enfold a forearm&#39;s length.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are munificently packed with soft, yielding flab, are as thick as a fatted sheep&#39;s belly, and become agitated with silky tremors for a little while after you move them; your unbelievable blubbery chest strains to accommodate the pendulous overripe mammaries the size of a refugee&#39;s travelling sack that spill over the upper hemisphere of your belly. Your back is excessively bolstered with flab, and is constantly belleaguered by the battling weights of your stomach and your hips. The flesh under your shoulder blades gathers into thick rolls against the gigantic expanse of your hips, forming folds that run alongside your flanks and around your belly, cutting deep enough to swallow an arm&#39;s length.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are munificently packed with soft, yielding flab, are as thick as a fatted sheep&#39;s belly, and become agitated with silky tremors for a little while after you move them; your unbelievable blubbery chest strains to accommodate the pendulous overripe mammaries the size of a refugee&#39;s travelling sack that spill over the upper hemisphere of your belly. Your back is excessively bolstered with flab, and although the rivalling weights of your stomach and hips require constant effort to hold in balance, even the lackluster tone of your torso is enough to do it. The flesh under your shoulder blades gathers into thick rolls against the gigantic expanse of your hips, forming folds that run alongside your flanks and around your belly, cutting deep enough to swallow an arm&#39;s length.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are munificently packed with soft, solid flab, are as thick as a fatted sheep&#39;s belly, and become agitated with silky tremors for a little while when you move them; your unbelievable blubbery chest strains to accommodate the pendulous overripe mammaries the size of a refugee&#39;s travelling sack that spill over the upper hemisphere of your belly. Your back is excessively bolstered with flab, and although the rivalling weights of your stomach and hips require constant effort to hold in balance, your body have the fortitude for the job. The flesh under your shoulder blades gathers into thick rolls against the gigantic expanse of your hips, forming folds that run alongside your flanks and around your belly, cutting deep enough to swallow an arm&#39;s length.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are stupendously fleshed, endowed with hardened muscles amply swaddled in blubber, are as thick as an oak tree&#39;s trunk, and their flesh stirs and jostles when the limbs are put to use; your great torso is swollen with fat and radiates robust vitality, supporing voluptuously heaving, treasure chest-sized bosoms that obscure the uppermost reaches of the tremendous belly below. Your lardaceous back is has also enough well-hidden toned flesh to alleviate the toil of maintaining the favourable alignment of your backside and gut. The flesh under your shoulder blades gathers into thick rolls against the gigantic expanse of your hips, forming folds that run alongside your flanks and around your belly, cutting deep enough to swallow an arm&#39;s length.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are excessively crammed with blubber, are as thick as the largest of seals, and become a heaving, billowing image of a restless sea if your move them too strongly; your incomparably fleshy and soft chest is utterly obscured by humongous globulous bosoms that sprawl over the upper platform of your massively overgrown stomach, covering it. Your back is so completely devoid of strength that mediating the great pendulous masses of your belly and your hips imposes an nigh unbearable degree of duress on it, and the rich yielding layer of lard that gives volume to your back is hardly much help. The flesh under your shoulder blades forms anvil-heavy baggy folds that crush the engorged mass of your hips from above, forming multiple ravines that girdle your entire body, the largest of which are deep enough to hide a small person inside them.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are excessively crammed with blubber, are as thick as the largest of seals, and become a heaving, billowing image of a restless sea if your move them too strongly; your incomparably fleshy and soft chest is utterly obscured by humongous globulous bosoms that sprawl over the upper platform of your massively overgrown stomach, covering it. Your back is so lacking in strength that mediating the great pendulous masses of your belly and your hips imposes immense strain on it, and the rich yielding layer of lard that gives volume to your back only occassionaly helps preserve the equilibrium. The flesh under your shoulder blades forms anvil-heavy baggy folds that crush the engorged mass of your hips from above, forming multiple ravines that girdle your entire body, the largest of which are deep enough to hide a small person inside them.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are excessively crammed with blubber, are as thick as the largest of seals, and become a heaving, billowing image of a restless sea if your move them too strongly; your incomparably fleshy and soft chest is utterly obscured by humongous globulous bosoms that sprawl over the platform of your massively overgrown stomach, covering it. Your back is creaking with aching effort, but somehow succeeds in mediating the great pendulous masses of your belly and your hips, and the rich yielding layer of lard that gives volume to your back presents a substantial boon in preserving the equilibrium. The flesh under your shoulder blades forms anvil-heavy baggy folds that crush the engorged mass of your hips from above, forming multiple ravines that girdle your entire body, the largest of which are deep enough to hide a small person inside them.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are unimaginably bloated with plentiful fat that camouflages the highly developed musculature within; they are as thick as an obese person&#39;s waist, and get stirred into a flurry of shuddering flesh whenever you flex or extend them. Your fantastically padded upper body is wide and thick with burly might as well as blubber, and is all but hidden behind your humongous rolling breasts that conceal the dome of the wildly expanded gut beneath their masses. Your expansive, sturdy back deals admirably with keeping your stomach and your hips from toppling you, and is bolstered by a nearly solid cover of fat. The flesh under your shoulder blades forms anvil-heavy baggy folds that crush the engorged mass of your hips from above, forming multiple ravines that girdle your entire body, the largest of which are deep enough to hide a small person inside them.
				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;default&gt;&gt;
		&lt;&lt;switch $bodyFatTier&gt;&gt;
			&lt;&lt;case &quot;malnourished&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms have hardly any tone or dexterity to them, your ribs are distinctly displayed, while your back has a ridge of pronounced vertebrae running along it.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are deceptively skinny for the quickness and force they are capable of, your upper body is a slightly starved-looking basrelief of bone and hard muscle, while your back is thoroughly exercised.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your muscular arms are as powerful as they look, your torso is impressively barrel-shaped from all the muscle wrapped around it without a trace of idle flesh, while your broad back is sharply-textured and rugged, with its every knot, rope and strand easily discernable.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are a tangle of ale keg-thick serpents in a deadlock, your massively muscular chest has enormous pectorals and serratis rippling in the front, while your statuesque back appears ready to withstand a cave-in.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;healthy&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms don&#39;t seem to have much tone, your chest muscles lack definition while your back isn&#39;t very firm, but on the whole your upper body is still adequately fit.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are capable of quickness and pack a wallop, your torso displays adequate muscle tone and power, while your back is thoroughly exercised.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your muscular arms are as powerful as they look, your torso is impressively barrel-shaped, while your back is formidably and reliably sturdy.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are colossaly musclebound and thick as a treetrunk, your strapping chest is wide enough to shield a small adventuring party, while your back is monolithic in its tone and resilience.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;robust&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are soft and unexercised, your chest lacks tone and your back isn&#39;t very hard or firm, but it&#39;s a fine torso for a person of leisure.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are quite agile and capable despite their texture not showing it, your chest has subtly defined muscles, while your firm back is handsomely smooth.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your strong, thick arms are deceptively smooth, your wide chest conveys its power with partly obscured outlines of hard perctorals, while your back is strong and flat.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are covered in thick, bulging muscles that are somewhat softer around the edges than those of more dedicated athletes, your massive, doorframe-eclipsing chest makes its strength obvious through volume alone, while your mighty, yet glossy back is seemingly devoid of any weakness.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;overweight&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are a tad flabby, your chest is feeble and untoned and your soft back doesn&#39;t seem to be up to any heavy lifting.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your fluffy arms are surprisingly quick and exercised, your chest is well-toned despite looking smooth, while your back is hardened and flexible under its plush surface.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are tough and nimble under their slight soft cover, your wide chest hides great strength hinted at by its general burliness and the softened shifting when you flex or strain, while your slightly plump back is hardy and endurant.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are mightily muscled and not even a bit of flab on top can cover their grand proportions; your colossal torso flashes engorged pectorals whenever you move or turn, while your back hides unfathomable power under its smooth, supple exterior.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;chubby&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are pudgy and hang down loosely more often than not, your sagging chest advertizes idleness, while your back is mildly burdened by the fleshy baggage of your torso.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms have been intimately acquainted with toil and challenges, but didn&#39;t lose their flabby flesh in the process, your well-fed upper body is exercised to a certain extent, while your firm back possesses respectable limberness despite its plump appearance.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are flabby to the touch, but their extrordinary strength can be inferred from their volume and vague definition, your wide, doughy chest rearranges itself into a more formidable display when you flex its powerful muscles, while your trained back has only just enough soft flesh to cover up and smoothen it.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms have the appearance of being tremedously powerful even through a good deal of pudgy padding, your expansive upper body is developed beyond belief aside from looking profoundly well-fed, while your luxuriantly fleshed back doesn&#39;t need to strain to keep your heroic torso proudly erect.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;corpulent&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are fairly feeble and very fleshy, your soft, doughy chest could conceal a good deal of muscle, but doesn&#39;t, while your perpetually strained back is thickly lined with pudge.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms quite pudgy, but are exercised enough to keep up with the challenges of their soft lining, your generously fleshed chest doesn&#39;t betray much power underneath, even if there is something faintly hinted at by the way you move, while your profoundly plump back just about manages to keep itself straight without much effort.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are very well-developed, but also quite thickly padded, your imposingly wide chest suggests serious might slumbering under the soft cover, while your meaty back displays its hardiness by sustaining a flexible, springy posture even against the odds of your stout frame.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are thickly and softly bosltered from fabulous feasting, but under the cover shift the hardest biceps one could hope to develop, and your burly, fleshy torso is given a good deal of its width by the brawn pulsing from within, while your tremendously powerful back can afford its hearty padding.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are thick and smooth with flab and jiggle quite a bit when you move them, your chest is given much extra volume by its padding, although it&#39;s lean compared to the gut hanging below. Your lushly pudgy back fights a losing fight against the oppressive weight it has to support.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are thick and smooth with fat and jiggle quite a bit when you move them, your chest is given much extra volume by its padding, although it&#39;s lean compared to the gut hanging below. Your lushly pudgy back fights an admirable fight against the oppressive weight it has to support.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are voluminous and downy to the touch and jiggle quite a bit when you move them, but are also infused with great strength, and your wide and profoundly pudgy chest is nonetheless athletically firm. Your tough back compensates for the surplus mass nicely.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms have an extrodinary thickness and firmness of build, but are also thickly padded and jiggle quite a bit when you move them, and your expansive, mighty torso is richly lined with flab. Your profoundly doughy-textured back is so superbly trained that its excess fleshiness fails to rob it of its powerful appearance.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;morbidly obese&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are incredibly doughy, thick as a fit person&#39;s thigh and wobble a good deal when you move them, while your chest is so plump and sagging it would make a good number of ladies envious. Your back is strained to its limits propping up your physique.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are incredibly doughy, thick as a fit person&#39;s thigh and wobble a good deal when you move them, while your chest is so chubby and protuberant it would make a good number of ladies envious. Your back is strained almost to its limits propping up your physique.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are flabby and stout, thick as a fit person&#39;s thigh and wobble a good deal when you move them, while your expansive chest is lined heavily with doughy flesh. Your thickly and softly padded back has sufficient resilience to endure the strain.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are firmed by the cruelest physical challenges, but are still predominantly squishy, thick as a plump person&#39;s thigh and wobbly a good deal when you move them, while your vast, burly chest is rendered tender to the touch by all its flab. Your sturdy back is thickly lined with rippling softness perfectly obscuring its might.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;massive&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are exceedingly chubby, thick as a particularly fluffy pillow and wobble strongly when you move them; your torso is barrel-shaped solely on the account of its surplus weight and your swollen breasts are propped up by the slope of the heavy gut beneath. Your astoundlingly fleshy back is forced into a curve mimicking that of your belly at all times for the purposes of balance.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are exceedingly chubby, thick as a particularly plump pillow and wobble strongly when you move them; your torso is barrel-shaped solely on the account of its surplus weight, and your swollen breasts are propped up by slope of the heavy gut beneath. Your astoundlingly fleshy back is forced into a curve mimicking that of your belly most of the time in the interests of balance.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are sturdy despite their prodigious flabbiness, thick as a plump person&#39;s thigh and wobble strongly when you move them; your large chest is stocked with flab, and your plump breasts rest on the slope of the heavy belly beneath. Your wide back has just enough brawn inside to keep your rotund belly from winning the perpetual tug-of-war, as well as an abundance of its own weighty supple flesh.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are stoutly capable and quite blubbery at the same time, are as thick as a plump person&#39;s thigh and wobble strongly when you move them, and your ridiculously meaty upper body has firmly pudgy breasts hovering above the slope of the heavy belly beneath. Your gloriously fattened back boasts the width and the unseen power to support your ponderous frame.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;spherical&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are formidably fattened, thick as a keg of ale and slosh around mightily when you move them; your chest is lavishly corpulent, and mostly consists of two swollen bags of flesh capping the tremendous paunch beneath. Your tormented back needs to be thrust backwards at all times to combat the monstrous weight of your abdomen, and is profusely chubby and doughy in its own right.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are formidably fattened, thick as a keg of ale and slosh around mightily when you move them; your chest is lavishly corpulent, and mostly consists of two swollen bags of flesh capping the tremendous paunch beneath. Your tormented back needs to be thrust backwards at all times to combat the monstrous weight of your abdomen, but it&#39;s a manageable chore considering that its cause is helped by how profusely chubby and doughy it is.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are formidably fattened, thick as a keg of ale and slosh around mightily when you move them; your chest is lavishly corpulent, and mostly consists of two swollen bags of flesh capping the tremendous paunch beneath. Your tormented back needs to be thrust backwards at most times to combat the monstrous weight of your abdomen - a feat that it accomplishes splendidly - and is profusely chubby and doughy in its own right.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are awesomely powerful, but are given their firm, smooth rotundity by the opulent layer of fat on them, and are as thick as a sack of grain, quivering with great intensity when you move them; your phenomenally wide and fleshy torso has doughy breasts resting against the slope of the ponderous belly below. Your oak-like, looming back that has the resilience to stave off flopping forward due to the weight in the front, is heavily and lushly lined with blubber as an added accolade to its bearing power.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;mountainous&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are profoundly and tenderly obese, thick as a small beer barrel and swim with fluid undulatons when you shift them; your supremely fleshy torso is doughy and voluminous, especially the baggy breasts covering the summit of the enormous stomach below. Your gorgeously padded back lacks the sufficiently potent tone and is heavy with its own furrowing blubber, but is charged with the agonizing ordeal of supporting your girth nonetheless.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are profoundly and tenderly obese, thick as a small beer barrel and swim with fluid undulatons when you shift them; your supremely fleshy torso is doughy and voluminous, especially the baggy breasts covering the summit of the enormous stomach below. Your gorgeously padded back lacks the proper tone and is heavy with its own furrowing blubber, but is charged with the challenging ordeal of supporting your girth nonetheless, and manages it somehow.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are profoundly obese, thick as a small beer barrel and swim with fluid undulatons when you shift them; your supremely fleshy torso is doughy and voluminous, especially the baggy breasts covering the summit of the enormous stomach below. Your gorgeously padded back has a barely sufficient tone and is heavy with its own furrowing blubber, but tackles the rigorous ordeal of supporting your girth with remarkable disregard for difficulty.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are stoutly built and outstandingly furnished with blubber, are as thick as a small beer barrel, and their bulging surface starts jostling and heaving as soon as your budge them; your fascinatingly expansive and lavishly filled out chest sports firmly chubby breasts folding against the rounded bulk of the gut under them. Your back has its generous padding of lard aiding it in keeping your overburdened frame straight, but its inherent brawn alone is usually quite adequate for this purpose.
				&lt;&lt;/switch&gt;&gt;
			&lt;&lt;case &quot;colossal&quot;&gt;&gt;
				&lt;&lt;switch $strengthTier&gt;&gt;
					&lt;&lt;case &quot;regular&quot;&gt;&gt;
						Your arms are spectacularly blubbery, thick as a great treasure chest, and when you move them their abundant loose flesh quivers so powerfully it sends ripples through the adjacent surfaces of your torso; your tremendously doughy and expansive chest is endowed with hefty, thickly bolstered bosoms that collapse on top of your gargantuan belly&#39;s nearly horizontal surface. Your pathetically ailing back is forced to endure the relentless onslaught of your gut&#39;s terrible weight, although the smallest of reliefs comes from its own opulent deposits of lard that help in maintaining a semblance of balance.
					&lt;&lt;case &quot;athletic&quot;&gt;&gt;
						Your arms are spectacularly blubbery, thick as a great treasure chest, and when you move them their abundant loose flesh quivers so powerfully it sends ripples through the adjacent surfaces of your torso; your tremendously doughy and expansive chest is endowed with hefty, thickly bolstered bosoms that collapse on top of your gargantuan belly&#39;s nearly horizontal surface. Your cruelly overstressed back is forced to endure the relentless onslaught of your gut&#39;s terrible weight, although the smallest of reliefs comes from its own opulent deposits of lard that help in maintaining a semblance of balance.
					&lt;&lt;case &quot;muscular&quot;&gt;&gt;
						Your arms are spectacularly blubbery, thick as a great treasure chest, and when you move them their abundant loose flesh quivers so powerfully it sends ripples through the adjacent surfaces of your torso; your tremendously doughy and expansive chest is endowed with hefty, thickly bolstered bosoms that collapse on top of your gargantuan belly&#39;s nearly horizontal surface. Your hardy, but severely strained back is forced to endure the relentless onslaught of your gut&#39;s terrible weight, although the smallest of reliefs comes from its own opulent deposits of lard that help in maintaining a semblance of balance.
					&lt;&lt;case &quot;bodybuilder&quot;&gt;&gt;
						Your arms are grossly engorged with lard, thick as a horse&#39;s torso and start quivering and sloshing like a running creek when your move them; your titanic grand chest is overgenerous in both its mighty flesh and wobbling blubber aspects, with its superbly chubby breasts smushed against the plateau of your globulous gut&#39;s upper pole. Your wide, stout back possesses sufficient brawn to withstand the pull of your giant belly, aided in keeping its firm balance by its own thick padding of fat that furrows and folds to rest heavily against the bulk of your bottom.
				&lt;&lt;/switch&gt;&gt;
		&lt;&lt;/switch&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="547" name="eat" tags="" position="1700,375" size="100,100">$itemUsed.itemUse
&lt;&lt;consume $itemUsed.eat $itemUsed.calories&gt;&gt;

&lt;&lt;if $itemUsed.heal &gt; 0&gt;&gt;&lt;&lt;health $itemUsed.heal&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.mana &gt; 0&gt;&gt;&lt;&lt;mana $itemUsed.mana&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.stamina &gt; 0&gt;&gt;&lt;&lt;stamina $itemUsed.stamina&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;removeItem $itemUsed&gt;&gt;

&lt;&lt;updatePanels&gt;&gt;

/*Overeating code*/
&lt;&lt;if !$alive&gt;&gt;
	&lt;&lt;if $itemUsed.overfilled != null&gt;&gt;
		$itemUsed.overfilled
	&lt;&lt;else&gt;&gt;
		You force yourself to swallow the $itemUsed.name down and swiftly realize it was more than your stomach can handle. As your stomach stretches out, you&#39;re overwhelmed by the sensation of vast overindulgence and collapse to the ground in a bloated stupor. 
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if !$inCombat&gt;&gt;
		&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
		&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="548" name="eat 10" tags="" position="1800,375" size="100,100">$itemUsed.itemUse
&lt;&lt;set _eat = $itemUsed.eat * 10&gt;&gt;
&lt;&lt;set _calories = $itemUsed.calories * 10&gt;&gt;
&lt;&lt;consume _eat _calories&gt;&gt;

&lt;&lt;if $itemUsed.heal &gt; 0&gt;&gt;
	&lt;&lt;set _heal = $itemUsed.heal * 10&gt;&gt;
	&lt;&lt;health _heal&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.stamina &gt; 0&gt;&gt;
	&lt;&lt;set _stamina = $itemUsed.stamina * 10&gt;&gt;
	&lt;&lt;stamina _stamina&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.mana &gt; 0&gt;&gt;
	&lt;&lt;set _mana = $itemUsed.mana * 10&gt;&gt;
	&lt;&lt;mana _mana&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;removeItem $itemUsed 10&gt;&gt;

&lt;&lt;updatePanels&gt;&gt;

/*Overeating code*/
&lt;&lt;if !$alive&gt;&gt;
	&lt;&lt;if $itemUsed.overfilled != null&gt;&gt;
		$itemUsed.overfilled
	&lt;&lt;else&gt;&gt;
		You force yourself to swallow the tenth $itemUsed.name down and swiftly realize it was more than your stomach can handle. As your stomach stretches out, you&#39;re overwhelmed by the sensation of vast overindulgence and collapse to the ground in a bloated stupor. 
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
	&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="549" name="eat x" tags="fixes-and-edits" position="1825,500" size="100,100">/* FIXES AND EDITS - Allow consuming any amount of food */
&lt;&lt;setPopupTitle &quot;Eat&quot;&gt;&gt;/* Rename the dialog to look exactly like the eat one, so we can have a nicer title, but not have to edit the base game&#39;s passage ;p */

&lt;&lt;set _amount = $consumeAmount&gt;&gt;
/* Cap to amount player actually has available */
&lt;&lt;if _amount &gt; $itemUsed.stack&gt;&gt;
	&lt;&lt;set _amount = $itemUsed.stack&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* Ensure not negative/zero */
&lt;&lt;if _amount &lt; 1&gt;&gt;
	&lt;&lt;set _amount = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;

$itemUsed.itemUse
&lt;&lt;set _eat = $itemUsed.eat * _amount&gt;&gt;
&lt;&lt;set _calories = $itemUsed.calories * _amount&gt;&gt;
&lt;&lt;consume _eat _calories&gt;&gt;

&lt;&lt;if $itemUsed.heal &gt; 0&gt;&gt;
	&lt;&lt;set _heal = $itemUsed.heal * _amount&gt;&gt;
	&lt;&lt;health _heal&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.stamina &gt; 0&gt;&gt;
	&lt;&lt;set _stamina = $itemUsed.stamina * _amount&gt;&gt;
	&lt;&lt;stamina _stamina&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.mana &gt; 0&gt;&gt;
	&lt;&lt;set _mana = $itemUsed.mana * _amount&gt;&gt;
	&lt;&lt;mana _mana&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;removeItem $itemUsed _amount&gt;&gt;

&lt;&lt;updatePanels&gt;&gt;

/*Overeating code*/
&lt;&lt;if !$alive&gt;&gt;
	&lt;&lt;if $itemUsed.overfilled != null&gt;&gt;
		$itemUsed.overfilled
	&lt;&lt;else&gt;&gt;
		You force yourself to swallow the tenth $itemUsed.name down and swiftly realize it was more than your stomach can handle. As your stomach stretches out, you&#39;re overwhelmed by the sensation of vast overindulgence and collapse to the ground in a bloated stupor. 
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
	&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="550" name="equip" tags="" position="1700,475" size="100,100">&lt;&lt;switch $itemUsed.type&gt;&gt;
&lt;&lt;case &quot;weapon&quot;&gt;&gt;
	&lt;&lt;if $wea.name != $unarmed.name&gt;&gt;
		You unequip your $wea.name
		&lt;&lt;getItem $wea&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	$itemUsed.itemUse
	&lt;&lt;set $wea = $itemUsed&gt;&gt;
	&lt;&lt;removeItem $itemUsed&gt;&gt;
	
&lt;&lt;case &quot;armor&quot;&gt;&gt;
	&lt;&lt;if $arm.name != $unarmored.name&gt;&gt;
		You unequip your $arm.name
		&lt;&lt;getItem $arm&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	$itemUsed.itemUse
	&lt;&lt;set $arm = $itemUsed&gt;&gt;
	&lt;&lt;removeItem $itemUsed&gt;&gt;
	
&lt;&lt;case &quot;top&quot;&gt;&gt;
	&lt;&lt;if $itemUsed.size &gt; setup.waistDiameter() or $itemUsed.size == 0&gt;&gt;
		&lt;&lt;if $top.name != $shirtless.name&gt;&gt;
			You take off your $top.name
			&lt;&lt;getItem $top&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		$itemUsed.itemUse
		&lt;&lt;set $top = $itemUsed&gt;&gt;
		&lt;&lt;removeItem $itemUsed&gt;&gt;
	&lt;&lt;else&gt;&gt;
		$itemUsed.tooSmall
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;case &quot;bottom&quot;&gt;&gt;
	&lt;&lt;if $itemUsed.size &gt; setup.waistDiameter() or $itemUsed.size == 0&gt;&gt;
		&lt;&lt;if $btm.name != $pantsless.name&gt;&gt;
			You take off your $btm.name
			&lt;&lt;getItem $btm&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		$itemUsed.itemUse
		&lt;&lt;set $btm = $itemUsed&gt;&gt;
		&lt;&lt;removeItem $itemUsed&gt;&gt;
	&lt;&lt;else&gt;&gt;
		$itemUsed.tooSmall
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;default&gt;&gt;
	&#39;&#39;ERROR IN EQUIP CODE&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="551" name="event randomization" tags="" position="3925,175" size="100,100">/*===Forest randomization===*/

&lt;&lt;set $forestRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 2,
	leave: 0,
	leaveRate: 0.5,
	minor: 0,
	minorRate: 2,
}&gt;&gt;
&lt;&lt;set $forestSpecialRandomization = [0,0,0,0]&gt;&gt;


&lt;&lt;set $swampRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 2,
	leave: 0,
	leaveRate: 0.4,
	minor: 0,
	minorRate: 2,
}&gt;&gt;
&lt;&lt;set $swampSpecialRandomization = [0,0,0,0]&gt;&gt;


&lt;&lt;set $grasslandsRandomization = {
	special: 0,
	specialRate: 0.5,
	combat: 0,
	combatRate: 2,
	leave: 0,
	leaveRate: 0.5,
	minor: 0,
	minorRate: 2,
}&gt;&gt;
/*Add special event randomization???*/


&lt;&lt;set $hillsRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 2,
	leave: 0,
	leaveRate: 0.5,
	minor: 0,
	minorRate: 2,
}&gt;&gt;

&lt;&lt;set $mountainRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 2,
	leave: 0,
	leaveRate: 1,
}&gt;&gt;

&lt;&lt;set $mountainSpecial = [&quot;cabal&quot;, &quot;wizard&quot;, &quot;hive&quot;, &quot;wyvern&quot;, &quot;experiment&quot;]&gt;&gt;

&lt;&lt;set $beachRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 2,
	minor: 0,
	minorRate: 2,
}&gt;&gt;

&lt;&lt;set $oceanRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 1.5,
}&gt;&gt;


&lt;&lt;set $jungleRandomization = {
	special: 0,
	specialRate: 1,
	combat: 0,
	combatRate: 1,
	leave: 0,
	leaveRate: 0.5,
	minor: 0,
	minorRate: 0.5,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="552" name="food objects" tags="" position="3425,300" size="100,100">&lt;&lt;set $ampleApple = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Ample apple&quot;,
	name: &quot;ample apple&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 3,
	calories: 1,
	charges: 10,
	heal: 9,
	description: &quot;This is an enormous apple, easily the size of your head. It&#39;s shinym red, clean and delicious-looking thanks to a little imbued magic. &quot;,
	itemUse: &quot;You take a few bites from the enormous apple. It is crisp, sweet, very slightly acidic, and big. Very big. &quot;	
}&gt;&gt;

&lt;&lt;set $apple = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Apple&quot;,
	name: &quot;apple&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 2,
	eat: 2,
	calories: 1,
	stack: 1,
	stackLimit: 5,
	heal: 6,
	description: &quot;A red juicy apple. &quot;,
	itemUse: &quot;You chomp the juicy apple down in just a few bites. &quot;
}&gt;&gt;

&lt;&lt;set $bagOfCandy = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Bag of candy&quot;,
	name: &quot;bag of candy&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 1,
	eat: 2,
	calories: 1.5,
	stackLimit: 5,
	heal: 3,
	description: &quot;A bag of candy coated chocolates that won&#39;t melt all over your hands. How convenient. &quot;,
	itemUse: &quot;You start out eating one or two pieces at a time, but eventually give in and cram handfuls of them into your mouth at once. &quot;
}&gt;&gt;

&lt;&lt;set $beefStew = {
	Article: &quot;A jug of&quot;,
	article: &quot;a jug of&quot;,
	Name: &quot;Beef stew&quot;,
	name: &quot;beef stew&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 8,
	eat: 12,
	calories: 8,
	stackLimit: 5,
	heal: 40,
	description: &quot;A mix of beef chunks and assorted vegetables in a thickened broth, put into a jug to allow it to be eaten anywhere. &quot;,
	itemUse: &quot;You open the jug and guzzle down the stew. The meat is tender, and the vegetables are soft enough to cut with a spoon. &quot;,
	overfilled: &quot; It&#39;s much more filling than you expected, the meat and vegetables lending enough weight to the broth to stretch your stomach just too much... &quot;
}&gt;&gt;

&lt;&lt;set $bigSteak = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Big steak&quot;,
	name: &quot;big steak&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 8,
	eat: 12,
	calories: 10,
	stackLimit: 5,
	heal: 30,
	description: &quot;Medium-rare and slathered with sauce before being put in a pouch for the diner on the go. &quot;,
	itemUse: &quot;You eat the steak, chewy and delicious, then lick your fingers clean of the tangy sauce. &quot;,
	overfilled: &quot;You force down the steak, and even as your stomach is hurting from being too full, you&#39;re licking your fingers clean of sauce... &quot;
}&gt;&gt;

&lt;&lt;set $bloatedBlueberry = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Bloated blueberry&quot;,
	name: &quot;Bloated blueberry&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 2,
	eat: 2,
	calories: 1,
	charges: 10,
	heal: 6,
	description: &quot;This blueberry is huge. You could use it as a caestus if you felt like doing some very messy fisticuffs, but that would be a waste. &quot;,
	itemUse: &quot;You bite into the tremendous blueberry, the juice immediately turning everything it touches the shade of blue associated with sweetness. &quot;
}&gt;&gt;

&lt;&lt;set $boxOfDonuts = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Box of donuts&quot;,
	name: &quot;box of donuts&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 0.75,
	eat: 2,
	calories: 1.5,
	charges: 6,
	heal: 3,
	description: &quot;A small box of warm, shiny glazed donuts! &quot;,
	itemUse: &quot;You delicately pick up a donut so you don&#39;t get your $p.hands all sticky. You chomp it down in two bites and relish its warm sticky goodness as you clean errant bits of donut from around your mouth with your tongue. &quot;
}&gt;&gt;

&lt;&lt;set $breadLoaf = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Bread loaf&quot;,
	name: &quot;bread loaf&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 8,
	eat: 4,
	calories: 2,
	stackLimit: 5,
	heal: 12,
	description: &quot;A thick loaf of soft wheat bread. Subtly tasty, and surprisingly heavy. &quot;,
	itemUse: &quot;You bite into the loaf of bread, the taste of grains is subtle, but present. &quot;
}&gt;&gt;

&lt;&lt;set $cake = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Slice of cake&quot;,
	name: &quot;slice of cake&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 4,
	calories: 3,
	charges: 6,
	heal: 6,
	description: &quot;A sweet vanilla cake. &quot;,
	itemUse: &quot;You take your time enjoying each bite of moist delicious cake. &quot;
}&gt;&gt;

&lt;&lt;set $calamari = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Calamari&quot;,
	name: &quot;calamari&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 30,
	eat: 35,
	calories: 19,
	stackLimit: 5,
	heal: 65,
	description: &quot;Lightly battered and deep fried to perfection, these bite-size rings have just the right amount of give to keep you crunching. Served with a thick creamy dip with a few spicy hints. Careful, these aren&#39;t appetizer portions. &quot;,
	itemUse: &quot;The inviting aroma fills your senses as you dig in, taking your sweet time in savoring the unique harmony of flavor, each wondrous crunch is music to your ears. Before you know it you&#39;re done, but you feel like you&#39;ve been eating nonstop for hours! &quot;
}&gt;&gt;

&lt;&lt;set $cheese = {
	Article: &quot;A round of&quot;,
	article: &quot;a round of&quot;,
	Name: &quot;Cheese&quot;,
	name: &quot;cheese&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 5,
	eat: 7,
	calories: 4,
	stackLimit: 5,
	heal: 10,
	description: &quot;A sizable wedge of sharp cheddar, coated with wax. Good as it is, or melted onto something. &quot;,
	itemUse: &quot;You peel off the wax and bite into the cheese. It&#39;s chewy, and the flavor is strong. &quot;
}&gt;&gt;

&lt;&lt;set $cheeseburger = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Cheeseburger&quot;,
	name: &quot;cheeseburger&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 3,
	eat: 4,
	calories: 3,
	stackLimit: 5,
	heal: 8,
	description: &quot;A cheese burger sopping with grease. &quot;,
	itemUse: &quot;You pick up the mouthwateringly greasy cheeseburger and devour it in several large bites, taking a moment to lick the grease of your fingers afterwards. &quot;	
}&gt;&gt;

&lt;&lt;set $chili = {
	Article: &quot;A jug of&quot;,
	article: &quot;a jug of&quot;,
	Name: &quot;Chili&quot;,
	name: &quot;chili&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 7,
	eat: 11,
	calories: 7,
	stackLimit: 5,
	heal: 35,
	description: &quot;A spicy mixture of beef and seasonings in tomato sauce, bottled into a jug for portability. This variety has beans in it to lend it extra weight. &quot;,
	itemUse: &quot;You open the jug and gulp down some chili. You can feel your entire face heat up as the spiciness gets to you. &quot;,
	overfilled: &quot;You are left feeling hot from the spice, and far &#39;&#39;far&#39;&#39; too full for comfort... &quot;
}&gt;&gt;

&lt;&lt;set $coconut = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Coconut&quot;,
	name: &quot;coconut&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 4,
	eat: 5,
	calories: 3,
	stackLimit: 5,
	heal: 9,
	stamina: 6,
	description: &quot;A rather large, ripe coconut, which seems to be the favourite food of the snakes that dwell under the sand of the beach. &quot;,
	itemUse: &quot;You crack open the coconut on the nearest hard object, drinking the thick milk from it before gnawing the white, hard, fruity flesh away from the shell. &quot;
}&gt;&gt;

&lt;&lt;set $cookies = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Cookie&quot;,
	name: &quot;cookie&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 1,
	eat: 2,
	calories: 1.5,
	stackLimit: 9,
	heal: 3,
	description: &quot;A chocolate chip cookie. &quot;,
	itemUse: &quot;You pick up the chocolate chip cookie. For a moment you think about savoring it, but you find you&#39;ve already crammed the entire cookie into your mouth without noticing. Your eyes roll back in your head as you enjoy the sweet chocolatey goodness. &quot;
}&gt;&gt;

&lt;&lt;set $cupcake = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Cupcake&quot;,
	name: &quot;cupcake&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 1,
	eat: 2,
	calories: 1.5,
	stackLimit: 5,
	heal: 3,
	description: &quot;A tiny little handheld cake topped with icing and sparkly little sprinkles. How cute! &quot;,
	itemUse: &quot;You delicately peel off the paper from the bottom of the cupcake and chomp it down in a few bites. It takes you a second to notice the icing on your nose and you lick it off, hoping no one noticed. &quot;
}&gt;&gt;

&lt;&lt;set $friedChicken = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Fried chicken&quot;,
	name: &quot;fried chicken&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	consume: true,
	useable: true,
	value: 6,
	eat: 7,
	calories: 5,
	stackLimit: 5,
	heal: 10,
	description: &quot;An entire chicken, battered and cooked. The meat is tender, and ready to eat right off the bone. &quot;,
	itemUse: &quot;You bite into the chicken, the battered skin crunching before giving way to the soft meat. &quot;
}&gt;&gt;

&lt;&lt;set $giganticGrape = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Gigantic grape&quot;,
	name: &quot;gigantic grape&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 2,
	calories: 1,
	charges: 10,
	heal: 6,
	description: &quot;This one grape could make enough wine to keep any drunkard happy for a night. Alternatively, you could use it as a meal or two. &quot;,
	itemUse: &quot;You bite into the enormous grape, slurping at its juice as you chow down on its fruity flesh. &quot;
}&gt;&gt;

&lt;&lt;set $grapes = {
	Article: &quot;A bunch of&quot;,
	article: &quot;a bunch of&quot;,
	Name: &quot;Grapes&quot;,
	name: &quot;grapes&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 2,
	calories: 1,
	stackLimit: 5,
	heal: 6,
	description: &quot;A bunch of large green grapes. &quot;,
	itemUse: &quot;You pull off grapes bigger than your thumb and practice tossing them in the air and catching them in your mouth. You even catch most of them! &quot;	
}&gt;&gt;

&lt;&lt;set $hamHock = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Ham hock&quot;,
	name: &quot;ham hock&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 7,
	eat: 10,
	calories: 6,
	stackLimit: 5,
	stack: 1,
	heal: 20,
	description: &quot;A big chunk of cooked ham glazed with brown sugar, giving it a nice, dark coating. &quot;,
	itemUse: &quot;You tear into the ham, the salty meat proving filling and delicious. &quot;,
	overfilled: &quot;You eat the ham, and manage to finish off the salty meat before your stomach starts to tell you it&#39;s had too much... &quot;
}&gt;&gt;

&lt;&lt;set $hamSandwich = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Ham sandwich&quot;,
	name: &quot;ham sandwich&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 4,
	calories: 3,
	stackLimit: 5,
	heal: 8,
	description: &quot;A thick ham sandwich complete with lettuce, cheese, and tomato. &quot;,
	itemUse: &quot;You pull out the thick ham sandwich, and after figuring out how to get it to fit in your mouth, you chow down on it. &quot;	
}&gt;&gt;

&lt;&lt;set $jambalaya = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Jambalaya&quot;,
	name: &quot;jambalaya&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 8,
	eat: 12,
	calories: 8,
	stackLimit: 5,
	heal: 40,
	description: &quot;Rice mixed with beef, ham, spices, and vegetables. A very well rounded and filling meal that stays good for a long time. &quot;,
	itemUse: &quot;You stuff the spicy rice mixture into your mouth by the handful, the mixture of meats and vegetables going well with the medium spiciness. &quot;,
	overfilled: &quot;The heft of it proves to be just a bit more than your stomach can handle as, full as you are... &quot;
}&gt;&gt;

&lt;&lt;set $meatballSub = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Meatball sub&quot;,
	name: &quot;Meatball sub&quot;,
	effect: &quot;Eat&quot;,	
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 4,
	calories: 3,
	stackLimit: 5,
	heal: 8,
	description: &quot;A foot long submarine sandwich full of meatballs and dripping with marinara sauce. You always wondered what a submarine was though. &quot;,
	itemUse: &quot;You grab the foot long sub sandwich and start eating it from end to end, smearing marinara sauce all over your face and spilling some on the ground. &quot;	
}&gt;&gt;

&lt;&lt;set $milkBottle = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Bottle of milk&quot;,
	name: &quot;bottle of milk&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;drink&quot;,
	value: 2,
	stackLimit: 1,
	eat: 3,
	calories: 1.5,
	stamina: 25,
	heal: 3,
	description: &quot;A glass bottle filled with milk. How it manages to stay cool despite lack of refrigeration is a bit of a mystery. &quot;,
	itemUse: &quot;You swallow several mouthfuls of cool refreshing milk. &quot;	
}&gt;&gt;

&lt;&lt;set $milkJug = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Jug of milk&quot;,
	name: &quot;jug of milk&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;drink&quot;,
	value: 2, /* FIXES AND EDITS - Was originally priced not accounting for charges, at 9. Meaning jugs costed 45 gold despite just being 5 milk bottles */
	charges: 5,
	eat: 3,
	calories: 1.5,
	stamina: 25,
	heal: 3,
	description: &quot;A metal jug filled with milk. How it manages to stay cool despite lack of refrigeration is a bit of a mystery. &quot;,
	itemUse: &quot;You swallow several mouthfuls of cool refreshing milk. &quot;	
}&gt;&gt;

&lt;&lt;set $orange = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Orange&quot;,
	name: &quot;orange&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 3,
	calories: 1.5,
	stackLimit: 5,
	heal: 9,
	description: &quot;A delicious citrus fruit with a strong acid that tastes good and cleans anything. &quot;,
	itemUse: &quot;You peel the orange and chomp into its flesh. Naturally, the juice runs all over your face, but it&#39;s tangy enough that you don&#39;t mind. &quot;
}&gt;&gt;

&lt;&lt;set $outrageousOrange = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Outrageous orange&quot;,
	name: &quot;outrageous orange&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 3,
	calories: 1,
	charges: 10,
	heal: 9,
	description: &quot;A tremendous orange that is vibrant in color. The peel is soft and the fruit is firm. You could get a few meals out of this. &quot;,
	itemUse: &quot;You bite into the giant orange, the taste of citrus filling your mouth as juice floods over your tongue. &quot;
}&gt;&gt;

&lt;&lt;set $plentifulPeach = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Plentiful peach&quot;,
	name: &quot;plentiful peach&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 3,
	calories: 1,
	charges: 10,
	heal: 9,
	description: &quot;A peach big enough to use as a helmet if you ate out the middle of it. Given that magic is keeping it firm and ripe, you might. &quot;,
	itemUse: &quot;You sink your teeth into the enormous peach, its distinct flavor and juice filling your mouth as you chew. &quot;
}&gt;&gt;

&lt;&lt;set $riceBowl = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Rice bowl&quot;,
	name: &quot;rice bowl&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 20,
	eat: 25,
	calories: 12,
	stackLimit: 5,
	heal: 25,
	description: &quot;Steaming hot and lightly seasoned, rice is great if you&#39;re hungry and want 2000 of something. Might fill you up more than you&#39;d expect. &quot;,
	itemUse: &quot;The simple, subtle flavor of every bite is enough to make you let out a contented sigh. True to the raccoon&#39;s warning, you feel as if you&#39;ve put away an entire field of rice, rather than a simple bowl! &quot;
}&gt;&gt;

&lt;&lt;set $oats = {
	Article: &quot;A bag of&quot;,
	article: &quot;a bag of&quot;,
	Name: &quot;Oats&quot;,
	name: &quot;oats&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 3,
	calories: 2,
	charges: 5,
	heal: 9,
	description: &quot;A small bag full of oats. &quot;,
	itemUse: &quot;Although bags of oats are usually meant for work animals, you decide to cram you face into the bag of oats and start chompin&#39; them down anyway. &quot;
}&gt;&gt;

&lt;&lt;set $profusePumpkin = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Profuse pumpkin&quot;,
	name: &quot;profuse pumpkin&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 20,
	eat: 20,
	calories: 10,
	charges: 10,
	heal: 50,
	description: &quot;An enormous pumpkin the size of a small shed. The only thing more marvelous than the fact that you&#39;re carrying it is that it&#39;s lost none of its vibrant orange color. &quot;,
	itemUse: &quot;You dig into the meat of the pumpkin, eating a hole inside and devouring it from the inside. It&#39;s a stringy mess, but it&#39;s the flavor of Fall. &quot;	
}&gt;&gt;

&lt;&lt;set $ridiculousRaspberry = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Ridiculous raspberry&quot;,
	name: &quot;ridiculous raspberry&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 2,
	calories: 1,
	charges: 10,
	heal: 6,
	description: &quot;A raspberry the size of a small child, but almost certainly better tasting. Magic keeps it fresh, clean, and ready to eat. &quot;,
	itemUse: &quot;You take a few good bites from the fruit of the enormous raspberry, the flavor is best described as &#39;red and sweet.&#39; &quot;
}&gt;&gt;

&lt;&lt;set $sausage = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Sausage&quot;,
	name: &quot;sausage&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 3,
	eat: 3,
	calories: 1.5,
	stackLimit: 5,
	heal: 9,
	description: &quot;A greasy smoked sausage. &quot;,
	itemUse: &quot;You toss the juicy sausage up in the air and catch it in your mouth, swallowing it in one bite. &quot;
}&gt;&gt;

&lt;&lt;set $sizableStrawberry = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Sizable strawberry&quot;,
	name: &quot;sizable strawberry&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 2,
	calories: 1,
	charges: 10,
	heal: 6,
	description: &quot;A gigantic strawberry. The seeds that dot it are regular size, however, and unlike natural large strawberries, this has lost none of its red color. &quot;,
	itemUse: &quot;You eat some of the strawberry. The hardness of the little seeds does not take away from the sweetness of the fruit&#39;s red flesh. &quot;
}&gt;&gt;

&lt;&lt;set $steak = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Steak&quot;,
	name: &quot;steak&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 4,
	eat: 6,
	calories: 4.5,
	stackLimit: 5,
	heal: 12,
	description: &quot;A juicy rare steak. &quot;,
	itemUse: &quot;Unafraid to eat with your hands, you tear apart your juicy steak like a savage animal. &quot;
}&gt;&gt;

&lt;&lt;set $strawberries = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Strawberries&quot;,
	name: &quot;strawberries&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 2,
	eat: 2,
	calories: 1,
	stackLimit: 5,
	heal: 6,
	description: &quot;A bunch of large bright red strawberries. &quot;,
	itemUse: &quot;You grab a strawberry half the size of your fist and chomp it down in two juicy bites. &quot;
}&gt;&gt;

&lt;&lt;set $sushiRoll = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Sushi roll&quot;,
	name: &quot;sushi roll&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 30,
	eat: 35,
	calories: 17,
	stackLimit: 5,
	heal: 65,
	description: &quot;Perfectly portioned and wrapped in soft, puffy rice, these little mouthfuls are filled with only the freshest, most delectable ingredients. Lightly decorated with sesame seeds and sauce, it&#39;s exactly the roll wanted. You do like sushi, right? Either way, it&#39;s more of a meal than you&#39;d expect it to be. &quot;,
	itemUse: &quot;With a light touch of soy sauce, you pop piece after piece into your maw, relishing the smooth blend of flavors and soft texture until there&#39;s not a grain of rice left. However, you feel more like you&#39;ve downed a buffet than a side-dish! &quot;
}&gt;&gt;

&lt;&lt;set $tempuraShrimp = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Tempura shrimp&quot;,
	name: &quot;tempura shrimp&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 30,
	eat: 38,
	calories: 25,
	stackLimit: 5,
	heal: 60,
	description: &quot;A few sizeable hunks of shrimp, breaded and deep fried to a luxurious golden-brown. Served with a savory dip to really bring out the flavors. Jumbo flavor, jumbo filling! &quot;,
	itemUse: &quot;With a wonderful crunch, your stomach starts doing the talking. You chomp through piece after piece with growing momentum, overwhelmed by the rich, fresh flavor, licking your fingers clean and almost losing a hand in the process. You feel like you now know how a whale feels! &quot;
}&gt;&gt;

&lt;&lt;set $waterFlask = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Water flask&quot;,
	name: &quot;water flask&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;drink&quot;,
	value: 1,
	eat: 3,
	calories: 0,
	stackLimit: 1,
	stamina: 30,
	description: &quot;A flask filled with water. &quot;,
	itemUse: &quot;You swallow several mouthfuls of cool refreshing spring water. &quot;
}&gt;&gt;

&lt;&lt;set $waterJug = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Water jug&quot;,
	name: &quot;water jug&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;drink&quot;,
	value: 1,
	eat: 3,
	calories: 0,
	charges: 5,
	stamina: 30,
	description: &quot;A jug filled with water. &quot;,
	itemUse: &quot;You swallow several mouthfuls of cool refreshing spring water. &quot;
}&gt;&gt;

&lt;&lt;set $watermelon = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Watermelon&quot;,
	name: &quot;watermelon&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 4,
	eat: 8,
	calories: 3,
	stackLimit: 1,
	heal: 15,
	stamina: 6,
	description: &quot;A big ol&#39; watermelon. Bigger than your head! &quot;,
	itemUse: &quot;You crack the watermelon open over your knee and start chewing out the red, dripping wet insides. You finish feeling quite refreshed, and covered in watermelon juice. &quot;
}&gt;&gt;

&lt;&lt;set $whoppingWatermelon = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Whopping watermelon&quot;,
	name: &quot;whopping watermelon&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;food&quot;,
	value: 20,
	eat: 20,
	calories: 8,
	charges: 10,
	heal: 48,
	description: &quot;This watermelon could double as a place to sleep if you ate out all the insides. Given that its pink and delicious in there, that might not be a bad idea. &quot;,
	itemUse: &quot;You dig into the watermelon, and become a slick and sticky mess of its juice. A small pile of seeds forms as you spit them out while you eat. &quot;	
}&gt;&gt;

&lt;&lt;set $wine = {
	Article: &quot;A small cask of&quot;,
	article: &quot;a small cask of&quot;,
	Name: &quot;Wine&quot;,
	name: &quot;wine&quot;,		
	effect: &quot;Eat&quot;,
	type: &quot;food&quot;,
	icon: &quot;drink&quot;,
	value: 2,
	eat: 3,
	calories: 2,
	charges: 5,
	stamina: 20,
	heal: 7,
	description: &quot;Made with fermented grapes, aged in a wooden cask for you to enjoy. &quot;,
	itemUse: &quot;You pop open the cask and drink some wine. It&#39;s fairly sweet, and the alcohol makes you feel warm and tingly. &quot;
}&gt;&gt;</tw-passagedata><tw-passagedata pid="553" name="gender variables" tags="" position="3800,300" size="200,100">/*Old gender system
&lt;&lt;switch $gender&gt;&gt;

&lt;&lt;case &quot;male&quot;&gt;&gt;

&lt;&lt;set $He = &quot;He&quot;&gt;&gt;&lt;&lt;set $he = &quot;he&quot;&gt;&gt;
&lt;&lt;set $Him = &quot;Him&quot;&gt;&gt;&lt;&lt;set $him = &quot;him&quot;&gt;&gt;
&lt;&lt;set $His = &quot;His&quot;&gt;&gt;&lt;&lt;set $his = &quot;his&quot;&gt;&gt;
&lt;&lt;set $Himself = &quot;Himself&quot;&gt;&gt;&lt;&lt;set $himself = &quot;himself&quot;&gt;&gt;
&lt;&lt;set $Man = &quot;Man&quot;&gt;&gt;&lt;&lt;set $man = &quot;man&quot;&gt;&gt;
&lt;&lt;set $Boy = &quot;Boy&quot;&gt;&gt;&lt;&lt;set $boy = &quot;boy&quot;&gt;&gt;
&lt;&lt;set $Male = &quot;Male&quot;&gt;&gt;&lt;&lt;set $male = &quot;male&quot;&gt;&gt;
&lt;&lt;set $Sir = &quot;Sir&quot;&gt;&gt;&lt;&lt;set $sir = &quot;sir&quot;&gt;&gt;
&lt;&lt;set $Mister = &quot;Mister&quot;&gt;&gt;&lt;&lt;set $mister = &quot;mister&quot;&gt;&gt;
&lt;&lt;set $Brother = &quot;Brother&quot;&gt;&gt;&lt;&lt;set $brother = &quot;brother&quot;&gt;&gt;
&lt;&lt;set $Guy = &quot;Guy&quot;&gt;&gt;&lt;&lt;set $guy = &quot;guy&quot;&gt;&gt;
&lt;&lt;set $Fella = &quot;Fella&quot;&gt;&gt;&lt;&lt;set $fella = &quot;fella&quot;&gt;&gt;
&lt;&lt;set $Buddy = &quot;Buddy&quot;&gt;&gt;&lt;&lt;set $buddy = &quot;buddy&quot;&gt;&gt;
&lt;&lt;set $Gentleman = &quot;Gentleman&quot;&gt;&gt;&lt;&lt;set $gentleman = &quot;gentleman&quot;&gt;&gt;
&lt;&lt;set $Lad = &quot;Lad&quot;&gt;&gt;&lt;&lt;set $lad = &quot;lad&quot;&gt;&gt;
&lt;&lt;set $Laddie = &quot;Laddie&quot;&gt;&gt;&lt;&lt;set $laddie = &quot;Laddie&quot;&gt;&gt;
&lt;&lt;set $Sport = &quot;Sport&quot;&gt;&gt;&lt;&lt;set $sport = &quot;sport&quot;&gt;&gt;

&lt;&lt;case &quot;female&quot;&gt;&gt;

&lt;&lt;set $He = &quot;She&quot;&gt;&gt;&lt;&lt;set $he = &quot;she&quot;&gt;&gt;
&lt;&lt;set $Him = &quot;Her&quot;&gt;&gt;&lt;&lt;set $him = &quot;her&quot;&gt;&gt;
&lt;&lt;set $His = &quot;Her&quot;&gt;&gt;&lt;&lt;set $his = &quot;her&quot;&gt;&gt;
&lt;&lt;set $Himself = &quot;Herself&quot;&gt;&gt;&lt;&lt;set $himself = &quot;herself&quot;&gt;&gt;
&lt;&lt;set $Man = &quot;Woman&quot;&gt;&gt;&lt;&lt;set $man = &quot;woman&quot;&gt;&gt;
&lt;&lt;set $Boy = &quot;Girl&quot;&gt;&gt;&lt;&lt;set $boy = &quot;girl&quot;&gt;&gt;
&lt;&lt;set $Male = &quot;Female&quot;&gt;&gt;&lt;&lt;set $male = &quot;female&quot;&gt;&gt;
&lt;&lt;set $Sir = &quot;Ma&#39;am&quot;&gt;&gt;&lt;&lt;set $sir = &quot;ma&#39;am&quot;&gt;&gt;
&lt;&lt;set $Mister = &quot;Miss&quot;&gt;&gt;&lt;&lt;set $mister = &quot;miss&quot;&gt;&gt;
&lt;&lt;set $Brother = &quot;Sister&quot;&gt;&gt;&lt;&lt;set $brother = &quot;sister&quot;&gt;&gt;
&lt;&lt;set $Guy = &quot;Girl&quot;&gt;&gt;&lt;&lt;set $guy = &quot;girl&quot;&gt;&gt;
&lt;&lt;set $Fella = &quot;Missy&quot;&gt;&gt;&lt;&lt;set $fella = &quot;missy&quot;&gt;&gt;
&lt;&lt;set $Buddy = &quot;Missy&quot;&gt;&gt;&lt;&lt;set $buddy = &quot;missy&quot;&gt;&gt;
&lt;&lt;set $Gentleman = &quot;Lady&quot;&gt;&gt;&lt;&lt;set $gentleman = &quot;lady&quot;&gt;&gt;
&lt;&lt;set $Lad = &quot;Lass&quot;&gt;&gt;&lt;&lt;set $lad = &quot;lass&quot;&gt;&gt;
&lt;&lt;set $Laddie = &quot;Lassie&quot;&gt;&gt;&lt;&lt;set $laddie = &quot;Lassie&quot;&gt;&gt;
&lt;&lt;set $Sport = &quot;Sugar&quot;&gt;&gt;&lt;&lt;set $sport = &quot;sugar&quot;&gt;&gt;

&lt;&lt;case &quot;thing&quot;&gt;&gt;

&lt;&lt;set $He = &quot;It&quot;&gt;&gt;&lt;&lt;set $he = &quot;it&quot;&gt;&gt;
&lt;&lt;set $Him = &quot;It&quot;&gt;&gt;&lt;&lt;set $him = &quot;it&quot;&gt;&gt;
&lt;&lt;set $His = &quot;It&#39;s&quot;&gt;&gt;&lt;&lt;set $his = &quot;it&#39;s&quot;&gt;&gt;
&lt;&lt;set $Himself = &quot;Itself&quot;&gt;&gt;&lt;&lt;set $himself = &quot;Itself&quot;&gt;&gt;
&lt;&lt;set $Man = &quot;Thing&quot;&gt;&gt;&lt;&lt;set $man = &quot;thing&quot;&gt;&gt;
&lt;&lt;set $Male = &quot;Thing&quot;&gt;&gt;&lt;&lt;set $male = &quot;thing&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;
*/


&lt;&lt;set $male = {
	Male: &quot;Male&quot;, male: &quot;male&quot;,
	He: &quot;He&quot;, he: &quot;he&quot;, 
	Him: &quot;Him&quot;, him: &quot;him&quot;, 
	His: &quot;His&quot;, his: &quot;his&quot;, 
	Himself: &quot;Himself&quot;, himself: &quot;himself&quot;, 
	Man: &quot;Man&quot;, man: &quot;man&quot;, 
	Boy: &quot;Boy&quot;, boy: &quot;boy&quot;, 
	Male: &quot;Male&quot;, male: &quot;male&quot;, 
	Sir: &quot;Sir&quot;, sir: &quot;sir&quot;, 
	Mister: &quot;Mister&quot;, mister: &quot;mister&quot;, 
	Brother: &quot;Brother&quot;, brother: &quot;brother&quot;, 
	Guy: &quot;Guy&quot;, guy: &quot;guy&quot;, 
	Fella: &quot;Fella&quot;, fella: &quot;fella&quot;, 
	Buddy: &quot;Buddy&quot;, buddy: &quot;buddy&quot;, 
	Gentleman: &quot;Gentleman&quot;, gentleman: &quot;gentleman&quot;, 
	Lad: &quot;Lad&quot;, lad: &quot;lad&quot;, 
	Laddie: &quot;Laddie&quot;, laddie: &quot;Laddie&quot;, 
	Sport: &quot;Sport&quot;, sport: &quot;sport&quot;, 
}&gt;&gt;


&lt;&lt;set $female = {
	Male: &quot;Female&quot;, male: &quot;female&quot;,
	He: &quot;She&quot;, he: &quot;she&quot;, 
	Him: &quot;Her&quot;, him: &quot;her&quot;, 
	His: &quot;Her&quot;, his: &quot;her&quot;, 
	Himself: &quot;Herself&quot;, himself: &quot;herself&quot;, 
	Man: &quot;Woman&quot;, man: &quot;woman&quot;, 
	Boy: &quot;Girl&quot;, boy: &quot;girl&quot;, 
	Male: &quot;Female&quot;, male: &quot;female&quot;, 
	Sir: &quot;Ma&#39;am&quot;, sir: &quot;ma&#39;am&quot;, 
	Mister: &quot;Miss&quot;, mister: &quot;miss&quot;, 
	Brother: &quot;Sister&quot;, brother: &quot;sister&quot;, 
	Guy: &quot;Girl&quot;, guy: &quot;girl&quot;, 
	Fella: &quot;Missy&quot;, fella: &quot;missy&quot;, 
	Buddy: &quot;Pal&quot;, buddy: &quot;pal&quot;, 
	Gentleman: &quot;Lady&quot;, gentleman: &quot;lady&quot;, 
	Lad: &quot;Lass&quot;, lad: &quot;lass&quot;, 
	Laddie: &quot;Lassie&quot;, laddie: &quot;Lassie&quot;, 
	Sport: &quot;Sugar&quot;, sport: &quot;sugar&quot;, 
}&gt;&gt;

/* FIXES AND EDITS - More gender options - START */
&lt;&lt;set $thing = {
	Male: &quot;Genderless&quot;, male: &quot;genderless&quot;,
	He: &quot;It&quot;, he: &quot;it&quot;, 
	Him: &quot;It&quot;, him: &quot;it&quot;, 
	His: &quot;It&#39;s&quot;, his: &quot;it&#39;s&quot;, 
	Himself: &quot;Itself&quot;, himself: &quot;itself&quot;, 
	Man: &quot;Thing&quot;, man: &quot;thing&quot;, 
	Boy: &quot;Thing&quot;, boy: &quot;thing&quot;, 
	Sir: &quot;Ser&quot;, sir: &quot;ser&quot;, 
	Mister: &quot;Mx&quot;, mister: &quot;mx&quot;, 
	Brother: &quot;Sibling&quot;, brother: &quot;sibling&quot;, 
	Guy: &quot;Thingy&quot;, guy: &quot;thingy&quot;, 
	Fella: &quot;Thingy&quot;, fella: &quot;thingy&quot;, 
	Buddy: &quot;Pal&quot;, buddy: &quot;pal&quot;, 
	Gentleman: &quot;Thing&quot;, gentleman: &quot;thing&quot;, 
	Lad: &quot;Thingy&quot;, lad: &quot;thingy&quot;, 
	Laddie: &quot;Thingy&quot;, laddie: &quot;thingy&quot;, 
	Sport: &quot;Thingy&quot;, sport: &quot;thingy&quot;, 
}&gt;&gt;

&lt;&lt;set $neuter = {
	Male: &quot;Enby&quot;, male: &quot;enby&quot;,
	He: &quot;They&quot;, he: &quot;they&quot;, 
	Him: &quot;Them&quot;, him: &quot;them&quot;, 
	His: &quot;Their&quot;, his: &quot;their&quot;, 
	Himself: &quot;Theirself&quot;, himself: &quot;theirself&quot;, 
	Man: &quot;Enby&quot;, man: &quot;enby&quot;, 
	Boy: &quot;Kid&quot;, boy: &quot;kid&quot;, /* not a great translation :s */
	Sir: &quot;Ser&quot;, sir: &quot;ser&quot;, 
	Mister: &quot;Mx&quot;, mister: &quot;mx&quot;, 
	Brother: &quot;Sibling&quot;, brother: &quot;sibling&quot;, 
	Guy: &quot;Dude&quot;, guy: &quot;dude&quot;, /* Both &quot;guy&quot; and &quot;dude&quot; are both contested as male/neutral, though &quot;dude&quot; is seen much more as neutral. I&#39;m going with that because I can&#39;t find any good sources of alternatives even in NB spaces =_= */
	Fella: &quot;Mixter&quot;, fella: &quot;mixter&quot;, 
	Buddy: &quot;Pal&quot;, buddy: &quot;pal&quot;, 
	Gentleman: &quot;Gentleperson&quot;, gentleman: &quot;gentleperson&quot;, 
	Lad: &quot;Mate&quot;, lad: &quot;mate&quot;, 
	Laddie: &quot;Matey&quot;, laddie: &quot;matey&quot;, /* Tends to be seen as male-gendered, but it&#39;s the best I got ^_^;*/
	Sport: &quot;Champ&quot;, sport: &quot;champ&quot;,
}&gt;&gt;
/* FIXES AND EDITS - More gender options - END */</tw-passagedata><tw-passagedata pid="554" name="grid test" tags="" position="2675,50" size="100,100">/* FIXES AND EDITS - Add quick action shortcuts */
/* (added spans) */

&lt;div id=&quot;actionGrid&quot;&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:1;grid-row:1;&quot;&gt;
	&lt;span id=&quot;northwest-action&quot;&gt;
    &lt;&lt;if $northwest != null&gt;&gt;
		&lt;&lt;if !$northwest.popup&gt;&gt;
		&lt;&lt;button $northwest.label $northwest.passage&gt;&gt;
			$northwest.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $northwest.label $northwest.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:2;grid-row:1;&quot;&gt;
	&lt;span id=&quot;north-action&quot;&gt;
    &lt;&lt;if $north != null&gt;&gt;
		&lt;&lt;if !$north.popup&gt;&gt;
		&lt;&lt;button $north.label $north.passage&gt;&gt;
			$north.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $north.label $north.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:3;grid-row:1;&quot;&gt;
	&lt;span id=&quot;northeast-action&quot;&gt;
    &lt;&lt;if $northeast != null&gt;&gt;
		&lt;&lt;if !$northeast.popup&gt;&gt;
		&lt;&lt;button $northeast.label $northeast.passage&gt;&gt;
			$northeast.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $northeast.label $northeast.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:1;grid-row:2;&quot;&gt;
	&lt;span id=&quot;west-action&quot;&gt;
    &lt;&lt;if $west != null&gt;&gt;
		&lt;&lt;if !$west.popup&gt;&gt;
		&lt;&lt;button $west.label $west.passage&gt;&gt;
			$west.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $west.label $west.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:2;grid-row:2;&quot;&gt;
	&lt;span id=&quot;center-action&quot;&gt;
    &lt;&lt;if $center != null&gt;&gt;
		&lt;&lt;if !$center.popup&gt;&gt;
		&lt;&lt;button $center.label $center.passage&gt;&gt;
			$center.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $center.label $center.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:3;grid-row:2;&quot;&gt;
	&lt;span id=&quot;east-action&quot;&gt;
    &lt;&lt;if $east != null&gt;&gt;
		&lt;&lt;if !$east.popup&gt;&gt;
		&lt;&lt;button $east.label $east.passage&gt;&gt;
			$east.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $east.label $east.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:1;grid-row:3;&quot;&gt;
	&lt;span id=&quot;southwest-action&quot;&gt;
    &lt;&lt;if $southwest != null&gt;&gt;
		&lt;&lt;if !$southwest.popup&gt;&gt;
		&lt;&lt;button $southwest.label $southwest.passage&gt;&gt;
			$southwest.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $southwest.label $southwest.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:2;grid-row:3;&quot;&gt;
	&lt;span id=&quot;south-action&quot;&gt;
    &lt;&lt;if $south != null&gt;&gt;
		&lt;&lt;if !$south.popup&gt;&gt;
		&lt;&lt;button $south.label $south.passage&gt;&gt;
			$south.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $south.label $south.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;

&lt;div class=&quot;cell&quot; style=&quot;grid-column:3;grid-row:3;&quot;&gt;
	&lt;span id=&quot;southeast-action&quot;&gt;
    &lt;&lt;if $southeast != null&gt;&gt;
		&lt;&lt;if !$southeast.popup&gt;&gt;
		&lt;&lt;button $southeast.label $southeast.passage&gt;&gt;
			$southeast.activity
		&lt;&lt;/button&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;popupButton $southeast.label $southeast.passage&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    &lt;/span&gt;
&lt;/div&gt;



&lt;/div&gt;</tw-passagedata><tw-passagedata pid="555" name="hot fixes" tags="" position="2725,550" size="100,100">/* FIXES AND EDITS - Add patch option for mods to use - START */
&lt;&lt;include &quot;manual mod patch option&quot;&gt;&gt;
&lt;hr&gt;
/* FIXES AND EDITS - Add patch option for mods to use - END */

This will update the stats and descriptions of items. It won&#39;t affect items you already have though, which you&#39;ll have to remove from your inventory completely before this affects anything&lt;br&gt;
&lt;&lt;link &quot;Update items&quot;&gt;&gt;
	&lt;&lt;include &quot;item objects&quot;&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

Updates enemy stats to be what they should be. &lt;br&gt;
&lt;&lt;link &quot;Fix enemy stats&quot;&gt;&gt;
	&lt;&lt;include &quot;enemy stats&quot;&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

If Bronk&#39;s quest part 3 doesn&#39;t work, click this link to remove it so you can get it again. That should fix it. 
&lt;br&gt;
&lt;&lt;link &quot;Remove slime quest part 3&quot;&gt;&gt;&lt;&lt;removeQuest $slimeQuest3&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

These&#39;ll give you the items for the map quests in the jungle. &lt;br&gt;
&lt;&lt;link &quot;Get spear quest reward item&quot;&gt;&gt;
	&lt;&lt;getItem $thunderboltSpear&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link &quot;Get hammer quest reward item&quot;&gt;&gt;
	&lt;&lt;getItem $starHammer&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;link &quot;Get sword quest reward item&quot;&gt;&gt;
	&lt;&lt;getItem $blackSword&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

If your gold has been turned into [number NaN], this link will turn it back to &quot;0&quot;. After that, you should be able to go into the cheat menu under options and set it to whatever it should be. &lt;br&gt;
&lt;&lt;link &quot;Fix gold not being a number&quot;&gt;&gt;
	&lt;&lt;set $gld = 0&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

Gives you the Myst Mail from the &quot;On the chain gang&quot; if you didn&#39;t get it after turning in 3 chainmails. &lt;br&gt;
&lt;&lt;link &quot;Get Myst Mail&quot;&gt;&gt;
	&lt;&lt;getItem $horseArmorFixed&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

Removes all the slime items from your inventory. Should probably save this until after you complete all Bronk&#39;s quests. 
&lt;&lt;link &quot;Remove slimes&quot;&gt;&gt;
	&lt;&lt;removeItem $blueSlimeItem &quot;all&quot;&gt;&gt;
	&lt;&lt;removeItem $lemonSampleItem &quot;all&quot;&gt;&gt;
	&lt;&lt;removeItem $lemonSlimeItem &quot;all&quot;&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;

Updates description of not wearing items to fit better within game descriptions. &lt;br&gt;
&lt;&lt;link &quot;Update clothesless descriptions&quot;&gt;&gt;
	&lt;&lt;include &quot;item objects&quot;&gt;&gt;
	&lt;&lt;if $top.description == $shirtless.description&gt;&gt;
		&lt;&lt;set $top = clone($shirtless)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $btm.description == $pantsless.description&gt;&gt;
		&lt;&lt;set $btm = clone($pantsless)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/link&gt;&gt;
&lt;hr&gt;</tw-passagedata><tw-passagedata pid="556" name="item objects" tags="" position="3425,50" size="200,100">/*
&lt;&lt;set $ = {

}&gt;&gt;
*/

&lt;&lt;include &quot;quest item objects&quot;&gt;&gt;
&lt;&lt;include &quot;weapon objects&quot;&gt;&gt;
&lt;&lt;include &quot;armor objects&quot;&gt;&gt;
&lt;&lt;include &quot;food objects&quot;&gt;&gt;
&lt;&lt;include &quot;clothes objects&quot;&gt;&gt;
&lt;&lt;include &quot;status item objects&quot;&gt;&gt;


&lt;&lt;set $amulet = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Amulet&quot;,
	name: &quot;amulet&quot;,	
	effect: &quot;other&quot;,
	type: &quot;gem&quot;,
	value: 20,
	description: &quot;A shiny red amulet. &quot;,
	itemUse: &quot;You gaze deeply into the amulet. For a moment you think it&#39;s hypnotizing you, but you realize you&#39;re just unnaturally attracted to shiny objects and put it away. &quot;
}&gt;&gt;

&lt;&lt;set $bookOfCrystals = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Book of crystals&quot;,
	name: &quot;book of crystals&quot;,	
	effect: &quot;other&quot;,
	type: &quot;book&quot;,
	value: 75,
	description: &quot;This is a small, leather-lined book marketed towards gem, rock and fossil aficionados. The later pages look the most interesting, talking about mystic gems and their powers. Use this item with an Unidentified Gem in your inventory to identify it. &quot;,
	itemUse: &quot;&quot;,
}&gt;&gt;

&lt;&lt;set $sandyBox = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Sandy box&quot;,
	name: &quot;sandy box&quot;,	
	effect: &quot;other&quot;,
	type: &quot;box&quot;,
	value: 8,
	description: &quot;A small box you dug up from the beach. It still leaks a bit of sand when you move it around. Maybe there’s something inside? &quot;,
	itemUse: &quot;Inside the box you find &quot;
}&gt;&gt;

&lt;&lt;set $treasureChest = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Treasure chest&quot;,
	name: &quot;treasure chest&quot;,	
	effect: &quot;other&quot;,
	type: &quot;box&quot;,
	value: 15,
	description: &quot;A rather ornate chest you found in the sand of the beach. You can hear something rattling around inside. &quot;,
	itemUse: &quot;You pry the chest open and inside you find &quot;
}&gt;&gt;

&lt;&lt;set $unidentifiedGem = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Unidentified gem&quot;,
	name: &quot;unidentified gem&quot;,	
	effect: &quot;other&quot;,
	reuseable: true,
	type: &quot;gem&quot;,
	value: 20,
	description: &quot;A strange, shimmering gemstone. You can tell it has some sort of magical power in it, but you can’t tell how it works in its current state. You could probably sell it, however. &quot;,
	itemUse: &quot;You sit down, holding the gem in your hand and looking at it. It’s pretty, but try as you might, you can’t figure out a way to release its power. Shrugging, you put it back in your bag. &quot;
}&gt;&gt;


/*Unequip &quot;items&quot;*/
&lt;&lt;set $unarmed = {
	Article: &quot;Your&quot;,
	article: &quot;your&quot;,
	Name: &quot;Fists&quot;,
	name: &quot;fists&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	stat: &quot;str&quot;,
	damage: 1,
	range: 4,
	scaling: 0.2,
	damageType: &quot;bashing&quot;,
	description: &quot;You only have your bare fists to fight with. &quot;,
	itemUse: &quot;You stow your previous weapon. All you need are your fists! &quot;,
	attack: &quot;You punch the $e.name, &quot;
}&gt;&gt;

&lt;&lt;set $unarmored = {
	Article: &quot;Completely&quot;,
	article: &quot;completely&quot;,
	Name: &quot;Unarmored&quot;,
	name: &quot;unarmored&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;armor&quot;,
	defense: 0,
	description: &quot;You&#39;re completely unarmored. &quot;,
	itemUse: &quot;You doff your previous armor. &quot;
}&gt;&gt;

&lt;&lt;set $shirtless = {
	Article: &quot;Completely&quot;,
	article: &quot;completely&quot;,
	Name: &quot;Exposed chest&quot;,
	name: &quot;exposed chest&quot;,	
	popped: false,
	effect: &quot;Equip&quot;,
	type: &quot;top&quot;,
	description: &quot;You&#39;re completely shirtless. &quot;,
	poppedDescription: &quot;You&#39;re completely shirtless. &quot;,
	itemUse: &quot;You take off what you were wearing. &quot;,
	popped: false,
}&gt;&gt;

&lt;&lt;set $pantsless = {
	Article: &quot;Completely&quot;,
	article: &quot;completely&quot;,
	Name: &quot;Exposed legs&quot;,
	name: &quot;exposed legs&quot;,	
	popped: false,
	effect: &quot;Equip&quot;,
	type: &quot;bottom&quot;,
	description: &quot;You&#39;re completely pantsless. &quot;,
	poppedDescription: &quot;You&#39;re completely pantsless. &quot;,
	itemUse: &quot;You take off what you were wearing. &quot;,
	popped: false,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="557" name="player attack" tags="nobr" position="4175,575" size="100,100">&lt;li&gt;Attack!&lt;/li&gt;
&lt;&lt;doDmg&gt;&gt;
&lt;&lt;if $wea.attack != undefined&gt;&gt;
	$wea.attack
&lt;&lt;/if&gt;&gt;
/* FIXES AND EDITS - Report damage effectiveness for standard weapon attacks */
&lt;&lt;reportEffectiveness $wea.damageType &quot;enemy&quot;&gt;&gt;

/* FIXES AND EDITS - Readd weapon effect procs */
&lt;&lt;if $wea.proc and $dmg &gt; 0 and random(1,100) &lt;= $wea.procChance&gt;&gt;
	&lt;&lt;switch $wea.proc&gt;&gt;
		&lt;&lt;case &quot;stun&quot;&gt;&gt;
			&lt;&lt;eBuff &quot;stun&quot; $wea.procPower&gt;&gt;
		
		&lt;&lt;case &quot;drain&quot;&gt;&gt;
			/* There&#39;s not actually a proper drain effect, so we&#39;ll put a temp one together here for now. */
			/* Should probably make a function for it though, since I do intend on using drains as part of spell effects, too */
			The $wea.Name draws life from them!
			&lt;&lt;set _drainedAmount = $dmg*($wea.procPower/100)&gt;&gt;
            &lt;&lt;set _drainedAmount = Math.min(_drainedAmount, $e.hea)&gt;&gt; /* I don&#39;t think the original capped drain healing amount by enemy&#39;s health remaining, but that&#39;s what we&#39;ll do here */
            &lt;&lt;set _drainedAmount = Math.round(_drainedAmount)&gt;&gt;
            
            &lt;&lt;health _drainedAmount&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* FIXES AND EDITS - Reimplement combat stamina loss */
&lt;&lt;if $options.combatStamina &gt;= 1&gt;&gt;
	&lt;&lt;stamina -3&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;eDamage $dmg&gt;&gt;</tw-passagedata><tw-passagedata pid="558" name="player status" tags="" position="3175,200" size="100,100">Status effects: 
&lt;&lt;set _status = &quot;&quot;&gt;&gt;


&lt;&lt;if $sta &lt;= 5&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You&#39;re very tired.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $ful &gt; 100&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;&quot;+$status.description+&quot;&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.testImmobile()&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You&#39;re starting to feel rather slowed down by your weight.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

/* ICY SPELLS - Add levitation - START */
&lt;&lt;if $status.levitateTime &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;Your body is being carried by magical energies.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
/* ICY SPELLS - Add levitation - END */

/* FIXES AND EDITS - Height manipulation */
/* ICY SPELLS - Also hijack this for enlarge descriptions */
&lt;&lt;if $status.heightTime &gt; 0 or $status.enlargeTime &gt; 0&gt;&gt;
	&lt;&lt;if ( $status.height &gt; 0 and $status.heightTime &gt; 0 ) or ( $status.enlarge &gt; 1 and $status.enlargeTime &gt; 0 )&gt;&gt;
		&lt;&lt;set _status += &quot;&lt;li&gt;You are taller than normal.&lt;/li&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _status += &quot;&lt;li&gt;You are shorter than normal.&lt;/li&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $cal &lt;=  0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel physically drained.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.stretchFruit &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;Your stomach feels stretchier than normal.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.wellFed &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel energized and well fed from recently eating an actual hot meal.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.dietPill &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel lighter than you ought to thanks to a diet pill.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.str &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically stronger!&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.str &lt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically weaker.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.agi &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically faster!&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.agi &lt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically slower.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $status.int &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically smarter!&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.int &lt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically dumber.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.end &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically tougher!&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.end &lt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically frail.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.mana &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically empowered!&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.mana &lt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically drained of power.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.sto &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically hungrier!&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.sto &lt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel mystically less hungry.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;	
	
&lt;&lt;if $status.poison &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;You feel very ill as poison courses through your veins.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;if $status.bloatVenom &gt; 0&gt;&gt;
	&lt;&lt;set _status += &quot;&lt;li&gt;Your head feels slightly fuzzy, and there is an odd growing pressure in your stomach.&lt;/li&gt;&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if _status == &quot;&quot;&gt;&gt;&lt;li&gt;You feel fine!&lt;/li&gt;
&lt;&lt;else&gt;&gt;_status
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="559" name="player variables" tags="" position="3800,50" size="100,100">&lt;&lt;set $itemUsed = &quot;&quot;&gt;&gt;
&lt;&lt;set $spellCast = &quot;&quot;&gt;&gt;

&lt;&lt;set $name = &quot;NO NAME&quot;&gt;&gt;
&lt;&lt;set $inventory = []&gt;&gt;
&lt;&lt;set $spells = []&gt;&gt;
&lt;&lt;set $quests = []&gt;&gt;
&lt;&lt;set $chats = {}&gt;&gt;
&lt;&lt;set $ambientText = {}&gt;&gt;
&lt;&lt;set $ambientPrompts = {}&gt;&gt;


/*Player species descriptors*/
&lt;&lt;set $p = {
	Species: &quot;Lion&quot;, species: &quot;lion&quot;,
	Angry: &quot;Yell&quot;, angry: &quot;yell&quot;, 
	Article: &quot;A&quot;, article: &quot;a&quot;, 
	Feet: &quot;Paws&quot;, feet: &quot;paws&quot;, 
	Foot: &quot;Paw&quot;, foot: &quot;paw&quot;, 
	Hands: &quot;Paws&quot;, hands: &quot;paws&quot;, 
	Hand: &quot;Paw&quot;, hand: &quot;paw&quot;, 
	Fur: &quot;Fur&quot;, fur: &quot;fur&quot;, 
	Furred: &quot;Furred&quot;, furred: &quot;furred&quot;, 
	Furry: &quot;Furry&quot;, furry: &quot;furry&quot;, 
	FurBack: &quot;Golden&quot;, furBack: &quot;golden&quot;, 
	FurBelly: &quot;White&quot;, furBelly: &quot;white&quot;, 
	FurHead: &quot;Brown&quot;, furHead: &quot;brown&quot;, 
	Hair: &quot;Head fur&quot;, hair: &quot;head fur&quot;, 
	Teeth: &quot;Teeth&quot;, teeth: &quot;teeth&quot;, 
	Mouth: &quot;Muzzle&quot;, mouth: &quot;muzzle&quot;, 
	tail: &quot;long tail&quot;,
	height: 1,
	
	Male: &quot;Male&quot;, male: &quot;male&quot;,
	He: &quot;He&quot;, he: &quot;he&quot;, 
	Him: &quot;Him&quot;, him: &quot;him&quot;, 
	His: &quot;His&quot;, his: &quot;his&quot;, 
	Himself: &quot;Himself&quot;, himself: &quot;himself&quot;, 
	Man: &quot;Man&quot;, man: &quot;man&quot;, 
	Boy: &quot;Boy&quot;, boy: &quot;boy&quot;, 
	Male: &quot;Male&quot;, male: &quot;male&quot;, 
	Sir: &quot;Sir&quot;, sir: &quot;sir&quot;, 
	Mister: &quot;Mister&quot;, mister: &quot;mister&quot;, 
	Brother: &quot;Brother&quot;, brother: &quot;brother&quot;, 
	Guy: &quot;Guy&quot;, guy: &quot;guy&quot;, 
	Fella: &quot;Fella&quot;, fella: &quot;fella&quot;, 
	Buddy: &quot;Buddy&quot;, buddy: &quot;buddy&quot;, 
	Gentleman: &quot;Gentleman&quot;, gentleman: &quot;gentleman&quot;, 
	Lad: &quot;Lad&quot;, lad: &quot;lad&quot;, 
	Laddie: &quot;Laddie&quot;, laddie: &quot;Laddie&quot;, 
	Sport: &quot;Sport&quot;, sport: &quot;sport&quot;, 
}&gt;&gt;

&lt;&lt;set $str = 0&gt;&gt;
&lt;&lt;set $tstr = 0&gt;&gt;
&lt;&lt;set $bstr = 15&gt;&gt;

&lt;&lt;set $agi = 0&gt;&gt;
&lt;&lt;set $tagi = 0&gt;&gt;
&lt;&lt;set $bagi = 15&gt;&gt;

&lt;&lt;set $int = 0&gt;&gt;
&lt;&lt;set $tint = 0&gt;&gt;
&lt;&lt;set $bint = 15&gt;&gt;

&lt;&lt;set $end = 0&gt;&gt;
&lt;&lt;set $tend = 0&gt;&gt;
&lt;&lt;set $bend = 15&gt;&gt;

&lt;&lt;set $sto = 0&gt;&gt;
&lt;&lt;set $tsto = 0&gt;&gt;
&lt;&lt;set $bsto = 20&gt;&gt;

&lt;&lt;set $maxFul = 130&gt;&gt;
&lt;&lt;set $bmaxHea = 100&gt;&gt;
&lt;&lt;set $maxHea = $bmaxHea&gt;&gt;
&lt;&lt;set $maxMana = 10&gt;&gt;

&lt;&lt;set $hea = $maxHea&gt;&gt;
&lt;&lt;set $mana = $maxMana&gt;&gt;
&lt;&lt;set $ful = 0&gt;&gt;
&lt;&lt;set $sta = 100&gt;&gt;
&lt;&lt;set $dodge = 0&gt;&gt;

&lt;&lt;set $ate = 3&gt;&gt;
&lt;&lt;set $inf = 0&gt;&gt;
&lt;&lt;set $infMass = 0&gt;&gt;
&lt;&lt;set $cal = 0&gt;&gt;
&lt;&lt;set $fat = 5&gt;&gt;
&lt;&lt;set $tfat = 0&gt;&gt;

/* FIXES AND EDITS - it&#39;s easier to just run removeStatus to set statuses to defaults - that way you don&#39;t have to edit 2 things when adding new statuses (not that you HAD to anyways) */
&lt;&lt;set $status = {}&gt;&gt;
&lt;&lt;removeStatus&gt;&gt;
&lt;&lt;set $status.description = &quot;You feel fine. &quot;&gt;&gt;

/* Also easier to do the same with temp status, though I won&#39;t bother cutting out repeats from here */
&lt;&lt;removeTempStatus&gt;&gt;

/* FIXES AND EDITS - Height manipulation */
&lt;&lt;set $bheight = 1&gt;&gt; /* This is the new value that we&#39;ll be using to track the player&#39;s base height, which sounds confusingly similar to $p.bheight, which is used for tracking the player&#39;s species base height */

&lt;&lt;set $gld = 20&gt;&gt;
&lt;&lt;set $xp = 0&gt;&gt;
&lt;&lt;set $xpToLvl = 100&gt;&gt;
&lt;&lt;set $lvl = 1&gt;&gt;
&lt;&lt;set $lvlUp = 0&gt;&gt;

/*Equipment*/
&lt;&lt;set $wea = $unarmed&gt;&gt;
&lt;&lt;set $arm = $unarmored&gt;&gt;
&lt;&lt;set $top = $shirtless&gt;&gt;
&lt;&lt;set $btm = $pantsless&gt;&gt;

/*Remove this later, probably*/
&lt;&lt;set $tdef = 0&gt;&gt;

&lt;&lt;set $dmg = 0&gt;&gt;

/*Descriptions*/
&lt;&lt;set $Walk to &quot;Walk&quot;&gt;&gt;
&lt;&lt;set $walk to &quot;walk&quot;&gt;&gt;
&lt;&lt;set $Walking to &quot;Walking&quot;&gt;&gt;
&lt;&lt;set $walking to &quot;walking&quot;&gt;&gt;

/*add functionality to these later*/
&lt;&lt;set $fatness = &quot;chubby&quot;&gt;&gt;
&lt;&lt;set $muscles = &quot;unnoticeable&quot;&gt;&gt;
&lt;&lt;set $waist = &quot;bulging&quot;&gt;&gt;
&lt;&lt;set $toBurst = 0&gt;&gt;
&lt;&lt;set $hungry = &quot;slightly hungry&quot;&gt;&gt;

/*States*/
&lt;&lt;set $defeatedBy = &quot;&quot;&gt;&gt;
&lt;&lt;set $action = &quot;&quot;&gt;&gt;
&lt;&lt;set $alive = true&gt;&gt;
&lt;&lt;set $skillCheck = false&gt;&gt;

/*Status effects*/
&lt;&lt;set $grapple = 0&gt;&gt;
&lt;&lt;set $stun = 0&gt;&gt;
&lt;&lt;set $burn = 0&gt;&gt;
&lt;&lt;set $burnTime = 0&gt;&gt;
&lt;&lt;set $regenTime = 0&gt;&gt;
&lt;&lt;set $regenDamage = 0&gt;&gt;
&lt;&lt;set $regenRange = 0&gt;&gt;
&lt;&lt;set $dodge = 0&gt;&gt;

/*Options*/
&lt;&lt;set $options = {
	popping: false,
	males: true,
	females: true,
	metric: false,
	longDescription: true,
	dark: true, 
}&gt;&gt;</tw-passagedata><tw-passagedata pid="560" name="quest item objects" tags="" position="3425,425" size="100,100">&lt;&lt;set $cabalCauldron = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Cabal Cauldron&quot;,
	name: &quot;Cabal Cauldron&quot;,
	effect: &quot;quest&quot;,
	description: &quot;The simplistic cauldron is quite compact and light, certainly due to the magical enchantments on it. It is easy enough to safely stash in your pack, and the lid is secured by a simple lock to prevent its contents from spilling forth. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $blueSlimeItem = {
	Article: &quot;A&quot;,
	article: &quot;A&quot;,
	Name: &quot;Captured blueberry slime&quot;,
	name: &quot;captured blueberry slime&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A blueberry slime subdued for the sake of the greedy innkeeper. How you&#39;re managing to keep it on your person without ruining everything else you&#39;re carrying is a bit of a mystery. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $cabalMap = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Map to Cabal Rogue&quot;,
	name: &quot;map to Cabal Rogue&quot;,
	effect: &quot;quest&quot;,
	icon: &quot;compass&quot;,
	description: &quot;You pull out the map to the rogue cabal member&#39;s cave. A distant area is circled in red, indicating his \&quot;hidden\&quot; lair.  You have been told that it will be a very difficult battle, and cautioned that your own body will be used against you. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $cabalTownMap = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Map to the Cabal&quot;,
	name: &quot;map to the Cabal&quot;,
	effect: &quot;quest&quot;,
	icon: &quot;compass&quot;,
	description: &quot;A map of the mountains that leads to the entrance to the cabal&#39;s cave. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $fallenStar = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Fallen star&quot;,
	name: &quot;fallen star&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A large chunk of star metal, still spherical but for a broken chunk of what must&#39;ve been the broken mace&#39;s handle back at the East Island Village Smith&#39;s. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $goldThread = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Gold thread&quot;,
	name: &quot;gold thread&quot;,
	effect: &quot;quest&quot;,
	value: 20,
	description: &quot;An entrancingly beautiful length of golden thread that had previously been part of an outright enormous cloth bag. Any tailor worth their salt would surely be interested in an item like this. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $hammerMap = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Map to shaman&#39;s stronghold&quot;,
	name: &quot;map to shaman&#39;s stronghold&quot;,
	effect: &quot;quest&quot;,
	icon: &quot;compass&quot;,
	description: &quot;A map marked with the location of the shaman that has stolen the fallen star. You are certain you could get there following this map. &quot;,
	itemUse: &quot;You follow the map into the jungle, not having to go very far before finding freshly worn foot paths. Following them in the appropriate direction leads you to a barricaded structure. Fortunately, the gate is open, and you make your way inside. There, the shaman is performing some kind of ritual around a totem that is topped with the Fallen Star. They suddenly stop, pointing at you. From behind, you hear a creaking of wood as the gate crashes shut. Looks like the only way out is a fight! &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $horsePantsBroke = {
	Article: &quot;A pair of&quot;,
	article: &quot;a pair of&quot;,
	Name: &quot;Old, worn pants&quot;,
	name: &quot;old, worn pants&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A tentlike pair of pants of an unfamiliar design so well-worn it&#39;s difficult to say what they were made of, let alone what color they were originally. A large split down the seat of them and numerous other little splits suggests that they might have been inadequate on the previous owner. You certainly can&#39;t wear them looking like this. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $horsePantsFixed = {
	Article: &quot;A pair of&quot;,
	article: &quot;a pair of&quot;,
	Name: &quot;Extremely large magical pants&quot;,
	name: &quot;extremely large magical pants&quot;,
	effect: &quot;quest&quot;,
	description: &quot;An extremely voluminous pair of pants of an unfamiliar design, now made mostly from a magical robe. While the effect is rather bright, the tailor has managed to arrange the magical designs so that they are at least slightly tasteful. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $horseArmorBroke = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Burst chainmail&quot;,
	name: &quot;burst chainmail&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A very fine set of chainmail whose rings have nevertheless ruptured and burst entirely down the front, splitting it in half. When the two halves are put together you can see a stylized running &lt;&lt;=setup.getSpeciesData($npcs.sampson.species).species&gt;&gt; emblazoned in gold across the chest, albeit now stretched very much out of shape. Looking very closely at one of the links, you can see a very small signature engraved on it, but sadly it&#39;s so worn as to be unreadable. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $horseArmorFixed = {
	Article: &quot;A set of&quot;,
	article: &quot;a set of&quot;,
	Name: &quot;Myst chainmail&quot;,
	name: &quot;Myst chainmail&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A very fine set of enchanted chainmail repaired by an even finer smith. You notice that they&#39;ve even managed to re-assemble the gold &lt;&lt;=setup.getSpeciesData($npcs.sampson.species).species&gt;&gt; emblem on the chest- though somehow the process has resulted in a far chunkier-looking beast being portrayed. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $lemonSampleItem = {
	Article: &quot;A&quot;,
	article: &quot;A&quot;,
	Name: &quot;Sample of lemon slime&quot;,
	name: &quot;sample of lemon slime&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A smallish lump of lemonslime, devoid of all its previous animate nature...? &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $lemonSlimeItem = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Captured lemon slime&quot;,
	name: &quot;captured lemon slime&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A lemon slime subdued for the sake of the greedy innkeeper. How you&#39;re managing to keep it on your person without ruining everything else you&#39;re carrying is a bit of a mystery. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $magicalObsidian = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Magical obsidian&quot;,
	name: &quot;magical obsidian&quot;,
	effect: &quot;quest&quot;,
	description: &quot;A chunk of obsidian you broke off the golem at the volcano. The East Island Village&#39;s Smith can use it to reforge the greatsword, if you dare. &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $spearMap = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Map to serpent&#39;s lair&quot;,
	name: &quot;map to serpent&#39;s lair&quot;,
	effect: &quot;quest&quot;,
	icon: &quot;compass&quot;,
	description: &quot;A map marked with the location of a deposit of white gold, and emblazoned with a warning that a giant serpent dwells here. You feel like you could find it fairly easily following this map. &quot;,
	itemUse: &quot;You follow the map deep into the jungle, the landmarks upon it proving usable, even if you do have to climb a tree to see them a couple of times. When you arrive in the marked location, you come across a hole in the ground. When you approach, an enormous snake begins to slide out of it. More and more of the giant snake emerges, and it soon becomes apparent that you are trapped in the area by its enormously lengthy body! &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $swordMap = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Map to volcano side&quot;,
	name: &quot;map to volcano side&quot;,
	effect: &quot;quest&quot;,
	icon: &quot;compass&quot;,
	description: &quot;A map marked with the location of a spiritually resonating deposit of obsidian. There is a warning that it is likely guarded by something, but you could go see yourself by following this map. &quot;,
	itemUse: &quot;You follow the map through the jungle and towards the center of the island, climbing up the side of the volcanic mountain. The heat begins to grow immense as you steadily approach the deposit, which is uncomfortably close to the open peak. Fortunately, you don&#39;t have to go much further, as the obsidian lies before you. Before you can take any of it, though, a deep, booming growl echoes from the mountain, forming obscure arcane syllables. As you watch, the obsidian rises up, taking a rough anthropomorphic form, and marches to you in time to a magical barrier trapping you in with it! &quot;,
	quest: true,
}&gt;&gt;

&lt;&lt;set $whiteGoldChunk = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;white gold chunk&quot;,
	name: &quot;white gold chunk&quot;,
	effect: &quot;quest&quot;,
	description: &quot;This chunk of white gold is quite lovely, and the Smith in the East Island Village can use it to reforge the broken spear. &quot;,
	quest: true,
}&gt;&gt;</tw-passagedata><tw-passagedata pid="561" name="quest objects" tags="" position="3675,300" size="100,100">/*=== City Quests ===*/

&lt;&lt;set $washedDishes = {
	name: &quot;Dishwasher&quot;,
	description: &quot;You helped do dishes at the restaurant today. Come back tomorrow to see if they need more help. &quot;,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $cookedFood = {
	name: &quot;Chef&quot;,
	description: &quot;You helped cook food for the restaurant today. Come back tomorrow and see if they need more help. &quot;,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $smithedArmor = {
	name: &quot;Smithee&quot;,
	description: &quot;You helped with smithing down at the armory. Come back tomorrow to see if he needs any more help. &quot;,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $foundGoldThread = {
	name: &quot;Enchanted thread bracelet&quot;,
	description: &quot;The tailor in town has woven a gold bracelet from an enchanted thread found from their sibling in the mountains. It enhances your stomach capacity, and if you find more it can increase your capacity even further. &quot;,
	goal: 5,
	progress: 0,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $learningToSmith = {
	name: &quot;Learning to smith&quot;,
	description: &quot;You&#39;ve started learning how to smith from the city&#39;s smithee. &quot;,
	goal: 1,
	progress: 0,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $eatingContest = {
	name: &quot;Enter the Eating Contest&quot;,
	description: &quot;1) Get the admission ticket for the eating contest from the patient in the hospital infirmary. &lt;br&gt;2) Attend the eating contest held in the barn at the dairy farm. &quot;,
	goal: 2,
	progress: 0,
	ready: false,
	completed: false
}&gt;&gt;
/*=== End City Quests ===*/




/*=== Farm quests ===*/
&lt;&lt;set $defendingTheHerd = {
	name: &quot;Defending the herd&quot;,
	description: &quot;Defeat any combination of 6 lions and/or cheetahs in the grasslands for the dairy farmer. &quot;,
	goal: 6,
	progress: 0,
	gold: 100,
	xp: 100,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $madMilk = {
	name: &quot;Mad Milk&quot;,
	description: &quot;Defeat the rogue milking machine in the hills for the dairy farmer. &quot;,
	goal: 1,
	progress: 0,
	gold: 200,
	xp: 150,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $madCheese = {
	name: &quot;Beware of cheese&quot;,
	description: &quot;There&#39;s something //nasty// lurking in the milk shed. It also happens to be evil (or at a minimum misunderstood). &quot;,
	goal: 1,
	progress: 0,
	gold: 350,
	xp: 250,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $uncommonTaste = {
	name: &quot;Uncommon Taste&quot;,
	description: &quot;Bring [food item] to the ex-adventurer horse hanging out at the dairy farm. &quot;,
	goal: 1,
	progress: 0,
	target: &quot;&quot;,
	gender: &quot;male&quot;,
	gold: 80,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $horseQuestClothes = {
	name: &quot;The Adventurer&#39;s New Clothes&quot;,
	description: &quot;Get Shire&#39;s pants tailored to fit better.&quot;,
	goal: 2,
	progress: 0,
	gold: 75,
	xp: 50,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $horseQuestArmor = {
	name: &quot;On the Chain Gang&quot;,
	description: &quot;Get Shire’s chainmail resized to fit!&quot;,
	goal: 4,
	progress: 0,
	gold: 125,
	xp: 80,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $horseQuestWeapon = {
	name: &quot;Axing a Favour&quot;,
	description: &quot;Find a weapon for Shire to take adventuring.&quot;,
	gold: 175,
	xp: 120,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $horseQuestStrength = {
	name: &quot;Give Me Strength&quot;,
	description: &quot;Find a spectrum gem to get Shire standing again.&quot;,
	gold: 200,
	xp: 175,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $horseQuestFreedom = {
	name: &quot;Just Desserts&quot;,
	description: &quot;Shire has gotten wedged in the farmhouse door! Can you free them?&quot;,
	gold: 80,
	xp: 75,
	ready: false,
	completed: false
}&gt;&gt;
/*=== End Farm Quests ===*/




/*=== West Town Quests ===*/

&lt;&lt;set $slimeQuest1 = {
	name: &quot;Slime Quest part 1&quot;,
	description: &quot;The west town innkeeper wants you to bring them some lemon slime to try. &quot;,
	progress: 0,	
	goal: 1,
	gold: 10,
	xp: 50,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $slimeQuest2 = {
	name: &quot;Slime Quest part 2&quot;,
	description: &quot;The west town innkeeper wants you to bring them a whole Lemon slime, intact. &quot;,
	progress: 0,	
	goal: 1,
	gold: 20,
	xp: 90,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $slimeQuest3 = {
	name: &quot;Slime Quest part 3&quot;,
	description: &quot;The west town innkeeper wants you to bring them 3 whole lemon slimes! &quot;,
	progress: 0,	
	goal: 3,
	gold: 50,
	xp: 150,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $slimeQuest4 = {
	name: &quot;Slime Quest part 4&quot;,
	description: &quot;The west town innkeeper wants you to capture them a Blueberry Slime. &quot;,
	progress: 0,	
	goal: 1,
	gold: 30,
	xp: 210,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $slimeQuest5 = {
	name: &quot;Slime Quest part 5&quot;,
	description: &quot;The insatiable west town innkeeper wants you to catch them 4 Blueberry Slimes!? &quot;,
	progress: 0,	
	goal: 4,
	gold: 150,
	xp: 300,
	ready: false,
	completed: false
}&gt;&gt;

/*=== End West Town Quests ===*/




/*=== Mountain Quests ===*/

&lt;&lt;set $cabalRogue = {
	name: &quot;Rogue cabal member&quot;,
	description: &quot;A powerful member of the mountain cabal has gone rogue and stolen away with one of their powerful artifacts. Your mission is to defeat this rogue member and return their property. You&#39;ve been given a map that will lead you to their hidden lair in the mountains. &quot;,
	progress: 0,	
	goal: 1,
	item: $cabalDragonRobe,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $wizardNotebook = {
	name: &quot;Wizard&#39;s Notebook&quot;,
	description: &quot;You received the notes of a rather mad wizard in the mountains. The first few pages of this book are a sensible set of studious notes, but the further it goes, the more jumbled and fragmented it gets. It may prove useful to someone, though. &quot;,
	progress: 0,	
	goal: 1,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $onBadTermsExperiments = {
	name: &quot;Angered the Experiments&quot;,
	description: &quot;You&#39;ve angered a group of theoretically civil people up in the mountains. Maybe you should go make amends with them? &quot;,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $onGoodTermsExperiments = {
	name: &quot;Working with the Experiments&quot;,
	description: &quot;You&#39;re on working terms with the experiments&quot;,
	ready: false,
	completed: false
}&gt;&gt;
/*=== End Mountain Quests ===*/




/*=== Jungle Quests ===*/

&lt;&lt;set $defeatShaman = {
	name: &quot;Beating some sense&quot;,
	description: &quot;The chief of the East Island Village wants you to &#39;beat the sense back into&#39; several of the rebelling shaman in the jungle. You&#39;ve been promised a reward if you do so. &quot;,
	progress: 0,	
	goal: 3,
	gold: 500,
	xp: 350,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $spearQuest = {
	name: &quot;Quest for the Spear&quot;,
	description: &quot;&quot;,
	progress: 0,	
	goal: 1,
	item: $thunderboltSpear,
	xp: 400,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $hammerQuest = {
	name: &quot;Quest for the Hammer&quot;,
	description: &quot;&quot;,
	progress: 0,	
	goal: 1,
	item: $starHammer,
	xp: 400,
	ready: false,
	completed: false
}&gt;&gt;

&lt;&lt;set $swordQuest = {
	name: &quot;Quest for the Sword&quot;,
	description: &quot;&quot;,
	progress: 0,	
	goal: 1,
	item: $blackSword,
	xp: 400,
	ready: false,
	completed: false
}&gt;&gt;
/*=== End Jungle Quests ===*/</tw-passagedata><tw-passagedata pid="562" name="rightBar Passage" tags="" position="2825,50" size="100,100">/*Adds action grid*/
&lt;span id=&quot;upperGrid&quot;&gt;
	&lt;&lt;include &quot;grid test&quot;&gt;&gt;
	&lt;hr&gt;
&lt;/span&gt;


/*Displays enemy and background images*/
&lt;div id=&quot;scenery&quot;&gt;
	&lt;&lt;include &quot;Background Image&quot;&gt;&gt;
	&lt;&lt;include &quot;Enemy Image&quot;&gt;&gt;
&lt;/div&gt;

/*Prints clock*/
&lt;&lt;set _time = &quot;Day &quot;+$day+&quot;, &quot;+$displayHour+&quot;:&quot;+$tensMinute+$onesMinute+&quot; &quot;+$ampm&gt;&gt;
&lt;div id=&quot;timeDisplay&quot;&gt;&#39;&#39; _time &#39;&#39;&lt;/div&gt;
&lt;hr&gt;

/*Prints label for location*/
/* FIXES AND EDITS - Allow custom titles - START */
/* added span so the default text can be replaced elsewhere */
&lt;span id=&quot;passageTitle&quot;&gt;
&lt;&lt;if $passageTitle &gt;&gt; /* The passage contains an alternative name. It has to be passed on this way because rightBar passage executes AFTER the passage has been loaded. We don&#39;t want to overwrite the custom title with defaults... */
    &lt;&lt;print $passageTitle&gt;&gt;
&lt;&lt;else&gt;&gt;
	/* Provide default titles */
    &lt;&lt;if $inCombat&gt;&gt;
      &lt;&lt;set _eHealth = Math.ceil(100 * ($e.hea/$e.maxhea))&gt;&gt;
      $e.Name &lt;br&gt;
      Level $e.lvl	_eHealth% HP 
    &lt;&lt;else&gt;&gt;
      &lt;&lt;print passage()&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/span&gt;
/* FIXES AND EDITS - Allow custom titles - END */
&lt;hr&gt;

/*Adds lower action grid*/
&lt;span id=&quot;lowerGrid&quot;&gt;
	&lt;&lt;include &quot;grid test&quot;&gt;&gt;
	&lt;hr&gt;
&lt;/span&gt;

/*Displays character description*/
&lt;span id=&quot;character description&quot; STYLE=&quot;font-size:12px&quot;&gt;
	&lt;&lt;include &quot;Character Description&quot;&gt;&gt;
&lt;/span&gt;</tw-passagedata><tw-passagedata pid="563" name="spell objects" tags="" position="3675,425" size="100,100">/* FIXES AND EDITS - Changed to work with newer spell structure */
/*
&lt;&lt;set $ = {
	Name: &quot;&quot;,
	name: &quot;&quot;,	
	description: &quot;&quot;,
	cast: &quot;&quot;,
	value: ,
	level: ,
	cost: ,
	int: ,
	damage: ,
	dRange: ,
	dType: &quot;&quot;,
	effect: &quot;&quot;,
	time: ,
	type: &quot;&quot;,
	icon: &quot;&quot;,
	target: &quot;&quot;,
	
}&gt;&gt;
*/

/* Wipe existing spell records */
&lt;&lt;set setup.spells = {}&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Cure&quot;,
	name: &quot;cure&quot;,	
	description: &quot;Cures you of most temporary status effects, whether positive or negative. &quot;,
	cast: &quot;You&#39;re bathed in a soft blue light as you begin to feel more like your normal self. &quot;,
	value: 35,
	level: 1,
	cost: 10,
	int: 30,
	type: &quot;other&quot;,
	icon: &quot;whiteMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;antidote1&quot;,
	core: true,
	combat: true,
	ooc: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Strength Boost&quot;,
	name: &quot;strength boost&quot;,	
	description: &quot;Slightly increases your strength in combat for a short time. (Multiple casts will only increase your strength once.) &quot;,
	cast: &quot;You are enveloped in a swirl of red light. &quot;,
	value: 22,
	level: 1,
	cost: 4,
	int: 30,
	damage: 10,
	type: &quot;buff&quot;,
	effect: &quot;str&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;boostStrength&quot;,
	core: true,
	combat: true
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Hunter&#39;s Swiftness&quot;,
	name: &quot;hunter&#39;s swiftness&quot;,	
	description: &quot;Call upon the power of nature to increase your speed. &quot;,
	cast: &quot;You focus on your opponent, touching one hand to the ground in a crouch as you feel the subtle energies of the earth flow through your fingers. &quot;,
	value: 22,
	level: 1,
	cost: 4,
	int: 30,
	damage: 10,
	type: &quot;buff&quot;,
	effect: &quot;agi&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;boostAgility&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Bark Skin&quot;,
	name: &quot;bark skin&quot;,	
	description: &quot;Improve your your toughness by channelling the spirit of a mighty tree. &quot;,
	cast: &quot;You hold out your hands, then slap the sides of your stomach. Your skin hardens. &quot;,
	value: 55,
	level: 1,
	cost: 9,
	int: 40,
	damage: 3,
	type: &quot;buff&quot;,
	effect: &quot;defense&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;boostDefense&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Dancing Wind&quot;,
	name: &quot;dancing wind&quot;,	
	description: &quot;Aid your movement with the power of wind to become more difficult to hit. &quot;,
	cast: &quot;You swipe your hands in front of yourself, kicking up a tailwind that makes your movement easier. &quot;,
	value: 65,
	level: 1,
	cost: 8,
	int: 45,
	damage: 10,
	type: &quot;buff&quot;,
	effect: &quot;dodge&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;boostDodge&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Rock Pelt&quot;,
	name: &quot;rock pelt&quot;,	
	description: &quot;Command the earth to leap at an opponent. &quot;,
	cast: &quot;You swipe a hand at your opponent, and small hunks of the ground fly at them. &quot;,
	value: 13,
	level: 1,
	cost: 6,
	int: 30,
	damage: 5,
	dRange: 4,
	dType: &quot;bashing&quot;,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;earth1&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Boulder Smash&quot;,
	name: &quot;boulder smash&quot;,	
	description: &quot;Command the earth to bury an opponent. &quot;,
	cast: &quot;You raise a hand and clench it into a fist, and the ground around your opponent launches itself in dozens of chunks at them. &quot;,
	value: 40,
	level: 3,
	cost: 18,
	int: 50,
	damage: 10,
	dRange: 4,
	dType: &quot;bashing&quot;,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;earth3&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Fireball&quot;,
	name: &quot;fireball&quot;,	
	description: &quot;Fling a ball of fire at your enemy. &quot;,
	cast: &quot;You hurl a ball of fire at your opponent. &quot;,
	value: 10,
	level: 1,
	cost: 5,
	int: 30,
	damage: 4,
	dRange: 4,
	dType: &quot;fire&quot;,
	effect: &quot;burn&quot;,
	time: 3,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;fire1&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Fire Serpent&quot;,
	name: &quot;fire serpent&quot;,	
	description: &quot;Create a serpent of flame to bite your foe with flaming teeth. &quot;,
	cast: &quot;You thrust your hand forth, launching a burning serpent at your opponent. It crashes fangs-first into your foe and splashes out in a gout of fire. &quot;,
	value: 40,
	level: 3,
	cost: 15,
	int: 50,
	damage: 6,
	dRange: 8,
	dType: &quot;fire&quot;,
	effect: &quot;burn&quot;,
	time: 3,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;fire2&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Flame Leviathan&quot;,
	name: &quot;flame leviathan&quot;,	
	description: &quot;Create a great wyrm of flame to engulf your opponent. &quot;,
	cast: &quot;You draw a great circle in front of you, and push forward with both hands. A tremendous fiery serpent roars forth, flying at your opponent with its great maw open. Its fiery body consumes them in flames. &quot;,
	value: 80,
	level: 5,
	cost: 30,
	int: 70,
	damage: 10,
	dRange: 12,
	dType: &quot;fire&quot;,
	effect: &quot;burn&quot;,
	time: 5,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;fire3&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Lesser Heal&quot;,
	name: &quot;lesser heal&quot;,	
	description: &quot;Restore a small number of your injuries. &quot;,
	cast: &quot;You are enveloped in a swirl of green light. &quot;,
	value: 25,
	level: 1,
	cost: 5,
	int: 20,
	damage: 1,
	dRange: 4,
	dType: &quot;life&quot;,
	type: &quot;heal&quot;,
	icon: &quot;whiteMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;heal1&quot;,
	core: true,
	combat: true,
	ooc: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Heal&quot;,
	name: &quot;heal&quot;,	
	description: &quot;Restore a moderate number of your injuries. &quot;,
	cast: &quot;You are enveloped in a swirling miasma of green light. &quot;,
	value: 43,
	level: 2,
	cost: 23,
	int: 40,
	damage: 4,
	dRange: 4,
	dType: &quot;life&quot;,
	type: &quot;heal&quot;,
	icon: &quot;whiteMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;heal2&quot;,
	core: true,
	combat: true,
	ooc: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Frost Shard&quot;,
	name: &quot;frost shard&quot;,	
	description: &quot;Fire a shard of ice at an opponent. &quot;,
	cast: &quot;A shard of ice coalesces in your hands and rockets towards your enemy. &quot;,
	value: 12,
	level: 1,
	cost: 6,
	int: 30,
	damage: 3,
	dRange: 6,
	dType: &quot;ice&quot;,
	effect: &quot;slow&quot;,
	time: 2,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;ice1&quot;,
	core: true,
	combat: true
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Rolling Ice&quot;,
	name: &quot;rolling ice&quot;,	
	description: &quot;Creates a ball of extreme cold, and send it at your enemy. &quot;,
	cast: &quot;You draw a spiral with your hand as you thrust it forward. A ball of cold coalesces on the ground, spins towards your foe, and bursts as it hits them. &quot;,
	value: 40,
	level: 3,
	cost: 18,
	int: 50,
	damage: 4,
	dRange: 10,
	dType: &quot;ice&quot;,
	effect: &quot;slow&quot;,
	time: 3,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;ice3&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Avalanche&quot;,
	name: &quot;avalanche&quot;,	
	description: &quot;Bury your opponent in flash-frozen air. &quot;,
	cast: &quot;You hold your hands apart, pointed toward your foe. Tremendous, jagged blocks of ice form in the air around it, and as you bring your hands together they smash together, entombing your opponent before bursting in eruptions of cold. &quot;,
	value: 80,
	level: 5,
	cost: 36,
	int: 70,
	damage: 7,
	dRange: 20,
	dType: &quot;ice&quot;,
	effect: &quot;slow&quot;,
	time: 5,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;ice5&quot;,
	core: true,
	combat: true
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Lightning Bolt&quot;,
	name: &quot;lightning bolt&quot;,	
	description: &quot;Strikes your enemy with a bolt of lightning. &quot;,
	cast: &quot;A bolt of lightning fires from your fingertips towards your enemy. &quot;,
	value: 13,
	level: 1,
	cost: 7,
	int: 30,
	damage: 3,
	dRange: 8,
	dType: &quot;lightning&quot;,
	effect: &quot;stun&quot;,
	time: 2,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;lightning1&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Lightning Cage&quot;,
	name: &quot;lightning cage&quot;,	
	description: &quot;Surround your foe then strike them with crackling lightning. &quot;,
	cast: &quot;You raise your hand up, then swing it down. Four pillars of lightning strike the ground, then let off a blinding shower of sparks as lightning strikes inwards at your foe. &quot;,
	value: 40,
	level: 3,
	cost: 21,
	int: 50,
	damage: 2,
	dRange: 25,
	dType: &quot;lightning&quot;,
	effect: &quot;stun&quot;,
	time: 2,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;lightning2&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Heaven&#39;s Lightning&quot;,
	name: &quot;heaven&#39;s lightning&quot;,	
	description: &quot;Strike your opponent with the thunder of the gods. &quot;,
	cast: &quot;You chant an invocation to the gods, pointing condemningly at your foe. Above, the clouds part as a halo of light shines down upon them. For a moment, the air shimmers and sparkles, then lightning strikes down in a tremendous flash and peal of thunder, causing a massive burst. &quot;,
	value: 80,
	level: 5,
	cost: 50,
	int: 70,
	damage: 15,
	dRange: 10,
	dType: &quot;lightning&quot;,
	effect: &quot;stun&quot;,
	time: 3,
	type: &quot;attack&quot;,
	icon: &quot;darkMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;lightning3&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Healing Glow&quot;,
	name: &quot;healing flow&quot;,	
	description: &quot;Call upon a healing stream to restore yourself gradually. &quot;,
	cast: &quot;You clasp your hands in front of you and plant your feet firmly. From the ground, you can feel a trickle of water flow up your legs and onto your body, soothing your injuries. &quot;,
	value: 35,
	level: 1,
	cost: 18,
	int: 35,
	damage: 1,
	dRange: 4,
	dType: &quot;life&quot;,
	type: &quot;buff&quot;,
	effect: &quot;regen&quot;,
	time: 5,
	icon: &quot;whiteMagic&quot;,
	target: &quot;player&quot;,
	
	id: &quot;regenerate2&quot;,
	core: true,
	combat: true,
	ooc: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Douse&quot;,
	name: &quot;douse&quot;,	
	description: &quot;Condense water from the air to soak an enemy, making them more susceptible to lightning. &quot;,
	cast: &quot;You raise a hand above your head and lower it slowly, causing a rain of water to fall harmlessly on your opponent. &quot;,
	value: 15,
	level: 1,
	cost: 5,
	int: 20,
	dType: &quot;water&quot;,
	effect: &quot;soak&quot;,
	time: 4, /* FIXES AND EDITS - Buffed from 3 to 4, since a buff that gives a total of 3x damage across 3 turns is functionally the same as just attacking for 3 turns :p */
	type: &quot;debuff&quot;, /* FIXES AND EDITS - Changed douse so it doesn&#39;t deal damage */
	icon: &quot;greyMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;water1&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.registerSpell({
	Name: &quot;Geyser&quot;,
	name: &quot;geyser&quot;,	
	description: &quot;Summon a gout of water from the ground to pummel and soak an enemy. &quot;,
	cast: &quot;You bend low, hands facing up before rising suddenly, throwing both hands into the air. The ground below your opponent rumbles for a moment before splitting open as a pounding rush of water blasts them. &quot;,
	value: 40,
	level: 3,
	cost: 20,
	int: 50,
	damage: 4,
	dRange: 8,
	dType: &quot;water&quot;,
	effect: &quot;soak&quot;,
	time: 5,
	type: &quot;attack&quot;,
	icon: &quot;greyMagic&quot;,
	target: &quot;enemy&quot;,
	
	id: &quot;water3&quot;,
	core: true,
	combat: true,
})&gt;&gt;

&lt;&lt;run setup.populateCoreGlobalSpells()&gt;&gt;</tw-passagedata><tw-passagedata pid="564" name="status effects" tags="" position="4275,325" size="100,100">/*===Enemy status effects===*/
/* ICY SPELLS - START */
&lt;&lt;if $e.icyspells_greased &gt; 0 and $dmg &gt; 0&gt;&gt;
	&lt;&lt;set _shouldIgnite = false&gt;&gt;
    &lt;&lt;if $action == &quot;Attack&quot; and $wea.damageType == &quot;fire&quot;&gt;&gt;
    	&lt;&lt;set _shouldIgnite = true&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if $action == &quot;Struggle&quot; and $grapple &lt;= 0 and $wea.damageType == &quot;fire&quot;&gt;&gt;
    	&lt;&lt;set _shouldIgnite = true&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if $action == &quot;Cast&quot; and $spellCast.dType and $spellCast.dType == &quot;fire&quot;&gt;&gt;
    	&lt;&lt;set _shouldIgnite = true&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    
    &lt;&lt;if _shouldIgnite == true&gt;&gt;
    	&lt;li&gt;&lt;i&gt;(The oil coating your opponent bursts into flame!)&lt;/i&gt;&lt;/li&gt;
        &lt;&lt;eBuff &quot;burn&quot; setup.tuning(&quot;icyspells_greaseBurnTime&quot;)&gt;&gt;
        
        /* Remove the status */
        &lt;&lt;set $e.icyspells_greased = 0&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
/* ICY SPELLS - END */

&lt;&lt;if $e.burnTime &gt; 0&gt;&gt;
	&lt;&lt;set $e.burnTime--&gt;&gt;
	&lt;li&gt;&lt;i&gt;Burn&lt;/i&gt;&lt;/li&gt;
	Your opponent burns for $e.burn damage. 
	&lt;&lt;eDamage $e.burn&gt;&gt;
	&lt;&lt;if $e.burnTime == 0&gt;&gt;
	&lt;li&gt;&lt;i&gt;(Your opponent is no longer burning.)&lt;/i&gt;&lt;/li&gt;
    &lt;&lt;set $e.burn = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.slow &gt; 0&gt;&gt;
	&lt;&lt;set $e.slow--&gt;&gt;
	&lt;&lt;if $e.slow == 0&gt;&gt;
	&lt;li&gt;&lt;i&gt;(Your opponent is no longer slowed.)&lt;/i&gt;&lt;/li&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $e.soak &gt; 0&gt;&gt;
	&lt;&lt;set $e.soak--&gt;&gt;
	&lt;&lt;if $e.soak == 0&gt;&gt;
	&lt;li&gt;&lt;i&gt;(Your opponent has shaken off most of the water from your spell.)&lt;/i&gt;&lt;/li&gt;
	/*&lt;&lt;run $e.damageWeakness.pluck(&quot;lightning&quot;)&gt;&gt;*/  /* FIXES AND EDITS - This is handled elsewhere now */
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


/*===Player status effects===*/
&lt;&lt;if $regenTime &gt; 0&gt;&gt;
	&lt;&lt;set _regen = setup.xdy($regenDamage, $regenRange)&gt;&gt;
	&lt;li&gt;&lt;b&gt;&lt;i&gt;Regeneration&lt;/i&gt;&lt;/b&gt;&lt;/li&gt;
	Your regenerate _regen health! 
	&lt;&lt;health _regen&gt;&gt;
	
	&lt;&lt;set $regenTime--&gt;&gt;
	&lt;&lt;if $regenTime &lt;= 0&gt;&gt;
		&lt;br&gt;
		&lt;i&gt;The healing effects surrounding you have begun to fade though.&lt;/i&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $status.poisonTime &gt; 0&gt;&gt;
	&lt;li&gt;&lt;b&gt;&lt;i&gt;Poison&lt;/i&gt;&lt;/b&gt;&lt;/li&gt;
	You take $status.poison damage from poison. 
	&lt;&lt;damage $status.poison&gt;&gt;
	&lt;&lt;set $status.poisonTime--&gt;&gt;
	&lt;&lt;if $status.poisonTime &lt;= 0&gt;&gt;
		&lt;i&gt;You no longer feel ill though.&lt;/i&gt; 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $burn &gt; 0&gt;&gt;
	&lt;li&gt;&lt;b&gt;&lt;i&gt;Burn&lt;/i&gt;&lt;/b&gt;&lt;/li&gt;
	You take $burn damage from the flames. 
	&lt;&lt;damage $burn&gt;&gt;
	&lt;&lt;set $burn--&gt;&gt;
	&lt;&lt;if $burn &lt;= 0&gt;&gt;
		&lt;i&gt;You finally stop burning though.&lt;/i&gt; 
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $status.bloatVenom &gt; 0&gt;&gt;
	&lt;li&gt;&lt;b&gt;&lt;i&gt;Bloat Venom&lt;/i&gt;&lt;/b&gt;&lt;/li&gt;
	Your stomach gurgles as you feel pressure as if you had just eaten a meal. 
	&lt;&lt;inflate $status.bloatVenom&gt;&gt;
	&lt;&lt;set $status.bloatVenom--&gt;&gt;
	&lt;&lt;if $status.bloatVenom &lt;= 0&gt;&gt;
		&lt;i&gt;Fortunately, your head no longer feels fuzzy and it seems you&#39;re finally over the effect&#39;s of the bloat venom.&lt;/i&gt;
		&lt;&lt;set $status.bloatVenomTime = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="565" name="status item objects" tags="" position="3550,425" size="100,100">&lt;&lt;set $aeroPearl = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Aero pearl&quot;,
	name: &quot;aero pearl&quot;,
	effect: &quot;other&quot;,
	type: &quot;gem&quot;,
	icon: &quot;aeroPearl&quot;,
	value: 20,
	stackLimit: 1,
	description: &quot;The pearl, with its smooth, lustrous surface, exudes a subtle glow, adding to its otherworldly charm. What truly sets it apart, however, is its peculiar behavior. When placed in your bag or even if just left on the ground, it doesn&#39;t rest like a normal object. Instead, it hangs suspended in the air, as if defying the very laws of gravity. The sight of it lazily floating, with a serene kind of motion, is both captivating and surreal. The moment you reach out and hold the Aero Pearl in your hand, an unexpected sensation grips you. You feel a compelling urge to burp, as if the pearl is inducing spontaneous twinges of gas within you. This sensation, while not uncomfortable, is certainly unusual and unexpected, leaving you momentarily puzzled. The book mentions that its power will be unleashed by putting it in your mouth, but it’s concerningly vague about what exactly that means. The notion of placing such a strange and magical object in your mouth is daunting. The book&#39;s ambiguity about the pearl&#39;s effects only heightens your sense of concern and wonder. Will it bring about a physical transformation, grant some sort of power, or unleash something entirely unexpected? The possibilities seem endless and uncertain, adding to the allure and mystery of the Aero Pearl.&quot;,
	itemUse: &quot;With a sense of impending doom, you carefully put the pearl into your mouth and close your mouth around it, wondering what might happen. You soon get your answer as you feel a building pressure in your mouth, and when you try to open your mouth to let it out, your jaw and lips seem to have locked shut. You hear a loud hiss ring out from inside your mouth and you feel air begin to force its way down into your stomach, having nowhere else to go, and your middle begins to swell out. You try to poke your fingers into your mouth to pry your mouth open, but your swollen fingers can’t get any leverage, and all you accomplish is accidentally swallowing the pearl. You feel it fall into your stomach. &quot;
}&gt;&gt;

&lt;&lt;set $antidotePotion = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Antidote potion&quot;,
	name: &quot;antidote potion&quot;,
	effect: &quot;other&quot;,
	type: &quot;health potion&quot;,
	value: 10,
	stackLimit: 9,
	description: &quot;A flask of completely colourless liquid- for all you know, this could just be funny-smelling water. &quot;,
	itemUse: &quot;You swig the contents of the flask in one go, spilling some down your chin and chest. Urgh, it tastes like... celery juice! You wipe your lips in disgust, but then feel a queer, almost tuneful rumbling from your insides. A wave of clarity and calmness washes over you, and with a small belch you feel completely back to your old self! If only you could get the taste of it out of your mouth... &quot;
}&gt;&gt;

&lt;&lt;set $denseTopaz = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Dense topaz&quot;,
	name: &quot;dense topaz&quot;,
	effect: &quot;other&quot;,
	type: &quot;gem&quot;,
	icon: &quot;denseTopaz&quot;,
	value: 20,
	stackLimit: 1,
	description: &quot;This gem feels abnormally weighty in your bag and tends to roll to the bottom of your bag. You feel a bit sluggish even holding it in your hand. Clenching it in your fist will fill you up and make you put on a few. &quot;,
	itemUse: &quot;With a sense of curiosity, you clasp your hand around the gem and squeeze. Immediately, you feel like something is entering your mouth from your throat downwards. You try to spit a bit of it out to see what it is, but all that come out are fragments of magical, wispy smoke, which immediately dart back into your mouth. You feel your stomach begin to rapidly fill with something warm, but you can feel the warmth pass your stomach and move down to your love handles and backside, filling them out with a little more weight as well, before splinters of the energy go down your arms and legs, swelling them as they go along. &quot;
}&gt;&gt;

&lt;&lt;set $dietPill = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Diet pill&quot;,
	name: &quot;diet pill&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 10,
	charges: 3,
	statusTime: 240,
	description: &quot;A packet of 3 pills, labelled &#39;Wunda-Slim&#39;. &quot;
}&gt;&gt;

&lt;&lt;set $sHealthPotion = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Small health potion&quot;,
	name: &quot;Small health potion&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;health potion&quot;,
	icon: &quot;healthPotion&quot;,
	value: 3,
	eat: 1,
	calories: 0,
	stackLimit: 5,
	heal: 25,
	description: &quot;A small vial of red liquid. &quot;,
	itemUse: &quot;You chug down the thick red liquid and start feeling a little better already. Cherry flavored! &quot;
}&gt;&gt;

&lt;&lt;set $mHealthPotion = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Medium Health potion&quot;,
	name: &quot;medium health potion&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;health potion&quot;,
	icon: &quot;healthPotion&quot;,
	value: 7,
	eat: 1,
	calories: 0,
	stackLimit: 5,
	heal: 50,
	description: &quot;A vial of red liquid. &quot;,
	itemUse: &quot;You chug down the thick red liquid and start feeling better already. Strawberry flavored! &quot;
}&gt;&gt;

&lt;&lt;set $lHealthPotion = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Large Health potion&quot;,
	name: &quot;large health potion&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;health potion&quot;,
	icon: &quot;healthPotion&quot;,
	value: 15,
	eat: 2,
	calories: 0,
	stackLimit: 5,
	heal: 75,
	description: &quot;A large vial of red liquid. &quot;,
	itemUse: &quot;You chug down the thick red liquid and start feeling much better already. Watermelon flavored! &quot;
}&gt;&gt;

&lt;&lt;set $sManaPotion = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Small mana potion&quot;,
	name: &quot;Small mana potion&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;mana potion&quot;,
	icon: &quot;manaPotion&quot;,
	value: 6,
	eat: 1,
	calories: 0,
	stackLimit: 5,
	mana: 20,
	description: &quot;A small vial of blue liquid. &quot;,
	itemUse: &quot;You chug down the thick blueish liquid and start feeling a little more energized already. Grape flavored! &quot;
}&gt;&gt;

&lt;&lt;set $mManaPotion = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Medium mana potion&quot;,
	name: &quot;medium mana potion&quot;,	
	effect: &quot;Eat&quot;,
	type: &quot;mana potion&quot;,
	icon: &quot;manaPotion&quot;,
	value: 14,
	eat: 1,
	calories: 0,
	stackLimit: 5,
	mana: 40,
	description: &quot;A vial of blue liquid. &quot;,
	itemUse: &quot;You chug down the thick blueish liquid and start feeling more energized already. Blueberry flavored! &quot;
}&gt;&gt;

&lt;&lt;set $lManaPotion = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Large mana potion&quot;,
	name: &quot;large mana potion&quot;,
	effect: &quot;Eat&quot;,
	type: &quot;mana potion&quot;,
	icon: &quot;manaPotion&quot;,
	value: 30,
	eat: 2,
	calories: 0,
	stackLimit: 5,
	mana: 60,
	description: &quot;A large vial of blue liquid. &quot;,
	itemUse: &quot;You chug down the thick blueish liquid and start feeling much more energized already. Plum flavored? &quot;
}&gt;&gt;

&lt;&lt;set $magicalHoney = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Magical honey&quot;,
	name: &quot;magical honey&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 30,
	stackLimit: 1,
	eat: 15,
	calories: 9,
	statusTime: 300,
	description: &quot;A bit of honey you stole from a feeder ant and stowed in an egg shell. It&#39;s heavy for its size, and is quite magical. &quot;,
	itemUse: &quot;You suck down the thick, sweet honey. It is very filling, and leaves you feeling strong. However, you don&#39;t think it&#39;s enough enough for the magics to permanently change you. &quot;,
}&gt;&gt;

&lt;&lt;set $oddCookie = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Digestive biscuit&quot;,
	name: &quot;digestive biscuit&quot;,
	effect: &quot;other&quot;,
	type: &quot;food&quot;,
	value: 5,
	stackLimit: 9,
	description: &quot;A small diamond shaped biscuit with white frosting. It looks moist and tempting. &quot;,
}&gt;&gt;

&lt;&lt;set $royalJelly = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Royal jelly&quot;,
	name: &quot;royal jelly&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 30,
	stackLimit: 1,
	eat: 40,
	calories: 24,
	statusTime: 300,
	description: &quot;This lump of jelly looks similar to honey, but it is opaque, and it&#39;s very weighty in your hands. It is neatly packed in a large packet of wax and practically glows with potent magic. &quot;,
	itemUse: &quot;You peel back the wax and find you have to eat this gelatinous honey in bites. Its curious magic flows through you, and you can feel your muscles get bigger and harder. &quot;,
}&gt;&gt;

&lt;&lt;set $snakeVenom = {
	Article: &quot;A vial of&quot;,
	article: &quot;a vial of&quot;,
	Name: &quot;Snake venom&quot;,
	name: &quot;snake venom&quot;,
	effect: &quot;other&quot;,
	type: &quot;mana potion&quot;,
	value: 7,
	stackLimit: 9,
	description: &quot;A vial of deep orange liquid, taken from the fangs of a sand snake. All the fun of fighting one of them with none of the bitemarks! &quot;,
	itemUse: &quot;You open the bottle and drink the venom down. It’s rather tasteless, but you feel it immediately work on your body. You feel quite full from it, and see your gut bulge out a bit. &quot;
}&gt;&gt;

&lt;&lt;set $spectrumGem = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Spectrum gem&quot;,
	name: &quot;spectrum gem&quot;,
	effect: &quot;other&quot;,
	type: &quot;gem&quot;,
	icon: &quot;spectrumGem&quot;,
	value: 100,
	stackLimit: 1,
	description: &quot;This gem is exceedingly rare, and vibrates with an ancient power. Clasping it in your hand will do wonders for your entire being, or you could sell it. &quot;,
	itemUse: &quot;You hold the gem tightly in your hand, and bolts of power flicker through in between your fingers. Bolts of energy hit your arms, legs, spine, head and your gut, enhancing all of them before the gem’s dies down. &quot;
}&gt;&gt;

&lt;&lt;set $stretchFruit = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Stretchy fruit&quot;,
	name: &quot;stretchy fruit&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 6,
	stackLimit: 5,
	status: &quot;stretchy fruit&quot;,
	statusTime: 300,
	description: &quot;A smallish blue fruit that is bizzarely stretchy. &quot;,
	itemUse: &quot;You toss the odd fruit into your mouth and start chewing it. It oozes strange tasting juices. It&#39;s not bad, but it&#39;s not good either. It actually tastes kind of like grape flavored rubber. As the fruit&#39;s juices flow down your throat, you feel your stomach rumble and eventually relax. &quot;
}&gt;&gt;

&lt;&lt;set $stretchySeaweed = {
	Article: &quot;Some&quot;,
	article: &quot;some&quot;,
	Name: &quot;Stretchy seaweed&quot;,
	name: &quot;stretchy seaweed&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 6,
	stackLimit: 5,
	status: &quot;stretchy fruit&quot;,
	statusTime: 300,
	description: &quot;A handful of seaweed. The greenish-brown fronds are slippery but surprisingly rubbery. &quot;,
	itemUse: &quot;You give the handful of seaweed a cautious sniff. It smells faintly of ozone, but not too bad. You roll the fronds up into a small ball and push them into your mouth, and chew. It tastes exactly like you’d expect seaweed to taste, and you pull some spectacular faces before swallowing it down. Urgh, talk about eating your greens! &quot;
}&gt;&gt;

&lt;&lt;set $weirdBerry = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Weird berry&quot;,
	name: &quot;weird berry&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 16,
	charges: 9,
	eat: 6,
	calories: 6,
	heal: 25,
	status: &quot;bloat venom&quot;,
	statusTime: 300,
	statusPowed: 40,
	description: &quot;It looks like a bloated blueberry, but the color is strangely off... &quot;,
	itemUse: &quot;You take a test bite out of the berry. It tastes tangy, and a little sweet. &quot;,
	overfilled: &quot;As you continue to eat, your overburdened stomach grumbles loudly, signifying you that you&#39;ve hit your limit. As you force the rest of the berry down your throat, you regret your decision as your stomach aches from its swollen state. You lie back on the ground, rubbing your stomach the entire time...Until you notice it growing even bigger! That berry must&#39;ve had bloat venom in it! You groan loudly as you futilely try to massage your stomach, growing and swelling in your hands. &quot;
}&gt;&gt;

&lt;&lt;set $largeWyvernEgg = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Large wyvern egg&quot;,
	name: &quot;large wyvern egg&quot;,
	effect: &quot;other&quot;,
	type: &quot;other&quot;,
	value: 30,
	stackLimit: 1,
	eat: 15,
	calories: 10,
	heal: 70,
	stamina: 30,
	statusTime: 300,
	description: &quot;An impressively large mottled grey egg that you got from a particularly large wyvern&#39;s nest. It could be a good meal, but someone might want it. &quot;,
	itemUse: &quot;You crack open the egg shell and gulp down the egg, chewing as you get to the large, thick yolk. It was definitely magical, and you feel healthy and hardy. &quot;,
}&gt;&gt;

&lt;&lt;set $voidOnyx = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Void onyx&quot;,
	name: &quot;void onyx&quot;,
	effect: &quot;other&quot;,
	type: &quot;gem&quot;,
	icon: &quot;voidOnyx&quot;,
	value: 20,
	stackLimit: 1,
	description: &quot;The colours of this black gem shift a little as you look at it, and just looking at it makes you feel a bit on the peckish size, while at the same time having no interest in eating it whatsoever. Pressing this against your gut will instantly empty it and make you a bit lighter. &quot;,
	itemUse: &quot;You hold the gem against your stomach, and it feels worryingly cold. A sharp, retch-inducing feeling kicks in, feeling like something from your stomach getting wrenched away from you. You hold the gem away from you as it crumbles to dust, its use expended. You feel like you’ve dropped a fair bit of weight, but considering how earth-shatteringly hungry you feel, you don’t know how long that’ll last. &quot;
}&gt;&gt;</tw-passagedata><tw-passagedata pid="566" name="template ai" tags="" position="4775,125" size="200,100">&lt;&lt;switch $aiAction&gt;&gt;

/*===Description===*/
&lt;&lt;case &quot;description&quot;&gt;&gt;


/*===Attack actions===*/
&lt;&lt;case &quot;attack&quot;&gt;&gt;
&lt;&lt;doEdmg&gt;&gt;


/*===Vore actions===*/
&lt;&lt;case &quot;vore&quot;&gt;&gt;


/*===Grapple Escape===*/
&lt;&lt;case &quot;grapple succeed&quot;&gt;&gt;
You manage to break free from your enemy&#39;s grasp! 
&lt;&lt;include &quot;player attack&quot;&gt;&gt;


/*===Grapple Fail===*/
&lt;&lt;case &quot;grapple fail&quot;&gt;&gt;
You struggle against your captor and loosen their grasp, but you can&#39;t quite break free. 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Run success===*/
&lt;&lt;case &quot;run succeed&quot;&gt;&gt;
&lt;li&gt;Escaped!&lt;/li&gt;
You escaped! 
&lt;&lt;endCombat&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


/*===Run Fail===*/
&lt;&lt;case &quot;run fail&quot;&gt;&gt;
&lt;li&gt;Run failed!&lt;/li&gt;
You failed to escape! 
&lt;&lt;enemyAction &quot;attack&quot;&gt;&gt;


/*===Surrender===*/
&lt;&lt;case &quot;submit&quot;&gt;&gt;
&lt;li&gt;Submit&lt;/li&gt;


/*===You lose===*/
&lt;&lt;case &quot;defeat&quot;&gt;&gt;
Your vision fades to black as you fall unconscious. 
&lt;hr&gt;
&lt;&lt;defeated &quot;devoured&quot;&gt;&gt;


/*===You win!===*/
&lt;&lt;case &quot;victory&quot;&gt;&gt;
You have defeated your enemy! 
&lt;&lt;include &quot;Victory&quot;&gt;&gt;
&lt;hr&gt;
&lt;&lt;include &quot;jungle randomization&quot;&gt;&gt;


&lt;&lt;default&gt;&gt;
&#39;&#39;Error in enemy ai&#39;&#39;
	
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="567" name="test combat" tags="" position="5525,1500" size="200,200">&lt;&lt;setEnemy $bloatBees&gt;&gt;
You found $e.article $e.name! $npc1.He looks mad!
&lt;hr&gt;
&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="568" name="test popup" tags="" position="1625,225" size="100,100">$p.mouth
[[test popup]]</tw-passagedata><tw-passagedata pid="569" name="test popup 2" tags="" position="1500,225" size="100,100">$walk
[[test popup]]</tw-passagedata><tw-passagedata pid="570" name="test popup 3" tags="" position="1375,225" size="100,100">&lt;&lt;print either(&quot;belly&quot;, &quot;rump&quot;)&gt;&gt;
&lt;&lt;removeItem $apple 8&gt;&gt;</tw-passagedata><tw-passagedata pid="571" name="time variables" tags="" position="3925,50" size="100,100">/*evening, day, morning, night*/
&lt;&lt;set $dayTime = &quot;Day&quot;&gt;&gt;
&lt;&lt;set $daytime = &quot;day&quot;&gt;&gt;
&lt;&lt;set $Sun = &quot;Sun&quot;&gt;&gt;
&lt;&lt;set $sun = &quot;sun&quot;&gt;&gt;
&lt;&lt;set $Sunlight = &quot;Sunlight&quot;&gt;&gt;
&lt;&lt;set $sunlight = &quot;sunlight&quot;&gt;&gt;
&lt;&lt;set $day = 1&gt;&gt;
&lt;&lt;set $hour = 9&gt;&gt;
&lt;&lt;set $displayHour = 0&gt;&gt;
&lt;&lt;set $tensMinute = 0&gt;&gt;
&lt;&lt;set $onesMinute = 0&gt;&gt;
&lt;&lt;set $ampm = &quot;AM&quot;&gt;&gt;
&lt;&lt;set $background = &quot;images/cityday.png&quot;&gt;&gt;

/*Travel timer*/
&lt;&lt;set $travel = 0&gt;&gt;

/*Sets text to start next scene*/
&lt;&lt;set $pretext = &quot;&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="572" name="use" tags="" position="1700,575" size="100,100">&lt;&lt;if $itemUsed.itemUse != null&gt;&gt;$itemUsed.itemUse&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.heal &gt; 0&gt;&gt;&lt;&lt;health $itemUsed.heal&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.stamina &gt; 0&gt;&gt;&lt;&lt;stamina $itemUsed.stamina&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.eat &gt; 0&gt;&gt;&lt;&lt;consume $itemUsed.eat $itemUsed.calories&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $itemUsed.reuseable != true&gt;&gt;&lt;&lt;removeItem $itemUsed&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;switch $itemUsed.name&gt;&gt;
&lt;&lt;case $weirdBerry.name&gt;&gt;
&lt;&lt;consume 6 6&gt;&gt;
&lt;&lt;switch $alive&gt;&gt;
  /*If you didn&#39;t pop*/
  &lt;&lt;case true&gt;&gt;
  &lt;&lt;if random(1,2) == 1&gt;&gt;
  After a few more gulps, you finish off the berry and lick the juice off of your fingers and around your mouth. Your stomach begins to gurgle loudly as you feel a small uncomfortable pain in your midsection. You begin to realize that you probably shouldn&#39;t eat every little thing you find like a devolved glutton. You press a hand onto your aching belly and slowly rub it, trying to relieve the stress. But as you rub it, you can feel it slowly growing under your hand. That berry was poisonous! 
  &lt;&lt;health -25&gt;&gt;
  &lt;&lt;if $hea &lt;= 0&gt;&gt;&lt;&lt;set $hea = 1&gt;&gt;&lt;&lt;/if&gt;&gt;
  &lt;&lt;stamina -20&gt;&gt;
  &lt;&lt;set $status.bloatVenom = 40&gt;&gt;

  &lt;&lt;else&gt;&gt;
  After a few more gulps, you finish off the berry and lick the juice off of your fingers and around your mouth. Your stomach gurgles a little before it settles back down. You breath a sigh of relief, almost thinking for a second back there, you might have eaten a poisonous berry or something! 
  &lt;&lt;health 25&gt;&gt;

  &lt;&lt;/if&gt;&gt;

  /*If you popped*/
  &lt;&lt;default&gt;&gt;
  $itemUsed.overfilled
  &lt;&lt;switch $options.popping&gt;&gt;
  &lt;&lt;case true&gt;&gt;
  As your stomach continues to swell in your hands, you can&#39;t help but feel lightheaded. Your stomach begins to creak as slowly, slowly, it grows bigger and bigger. Before you know it, there was a loud POP, and you blackout. 
  &lt;&lt;if !$inCombat&gt;&gt;
	&lt;&lt;set $defeatedBy to &quot;exploded&quot;&gt;&gt;
	&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;default&gt;&gt;
  As your stomach continues to grow more and more, your vision begins to become clouded and hazy. The pain becomes too much for you as you fall into a dark slumber. 
  &lt;&lt;if !$inCombat&gt;&gt;
	&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
	&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
  &lt;&lt;/if&gt;&gt;
  &lt;&lt;/switch&gt;&gt;

  &lt;&lt;/switch&gt;&gt;


&lt;&lt;case $dietPill.name&gt;&gt;
	&lt;&lt;if $status.dietPill &gt; 0&gt;&gt;
		You eagerly pop another large blue pill and put your hands to your stomach. Apart from a quiver and slight gurgling sound you don’t get any thinner, but at least you’re keeping the weight off. 
		&lt;&lt;set $status.dietPillTime = $itemUsed.statusTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _fatness = 50&gt;&gt;
		&lt;&lt;if _fatness &gt; $fat&gt;&gt;&lt;&lt;set _fatness = $fat&gt;&gt;&lt;&lt;/if&gt;&gt;
		You regard the pill laying in your $fatness palm rather nervously, then clap your hand to your open mouth and gulp. Hmm, kind of minty. The pill slips down your throat and hits your stomach. Almost at once you feel a funny gurgle in your middle, &lt;&lt;if _fatness &gt; 5&gt;&gt;and look down in time to see your $fatness stomach shrinking! You put your hands to your middle and feel it melting away, along with some of the girth around your sides and rear. A few moments later the funny feeling stops, but it feels like you’ve dropped a whole pant size without even breaking a sweat. &lt;&lt;else&gt;&gt;but you don&#39;t notice a huge change in your weight as you barely had any fat in the first place. &lt;&lt;/if&gt;&gt;
		&lt;&lt;set $status.dietPill = _fatness&gt;&gt;
		&lt;&lt;set $status.dietPillTime = $itemUsed.statusTime&gt;&gt;
		&lt;&lt;set $fat -= _fatness&gt;&gt;
		/*Add something to update passage footer?*/
	&lt;&lt;/if&gt;&gt;


&lt;&lt;case $stretchySeaweed.name&gt;&gt;
	&lt;&lt;if $status.stretchFruit &gt; 0&gt;&gt;
		You feel the stretching effects on your stomach renew. 
	&lt;&lt;else&gt;&gt;
		You stomach gives an odd gurgle, rather like running water, and you put your $p.hands against it nervously. It gives another sloshy rumble, and the $p.fur of your torso stretches slightly. You suddenly feel like you could stomach a whole lot more food. 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.stretchFruit &lt; 50&gt;&gt;&lt;&lt;set $status.stretchFruit = 50&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $status.stretchFruitTime = $itemUsed.statusTime&gt;&gt;


&lt;&lt;case $stretchFruit.name&gt;&gt;
	&lt;&lt;if $status.stretchFruit &gt; 0&gt;&gt;
		You feel the stretching effects on your stomach renew. 
	&lt;&lt;else&gt;&gt;
		You feel like you could eat a lot more food. 
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $status.stretchFruit &lt; 30&gt;&gt;&lt;&lt;set $status.stretchFruit = 30&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $status.stretchFruitTime = $itemUsed.statusTime&gt;&gt;


&lt;&lt;case $magicalHoney.name&gt;&gt;
	&lt;&lt;if $status.str &lt; 10&gt;&gt;
		You feel surprisingly stronger. 
		&lt;&lt;set $status.str = 10&gt;&gt;
		&lt;&lt;set $status.strTime = $itemUsed.statusTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
		It&#39;s effects don&#39;t seem powerful enough to overcome whatever&#39;s already affecting you. 
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $largeWyvernEgg.name&gt;&gt;
	&lt;&lt;if $status.end &lt; 10&gt;&gt;
		You feel surprisingly tougher. 
		&lt;&lt;set $status.end = 10&gt;&gt;
		&lt;&lt;set $status.endTime = $itemUsed.statusTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
		It&#39;s effects don&#39;t seem powerful enough to overcome whatever&#39;s already affecting you. 
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $royalJelly.name&gt;&gt;
	&lt;&lt;changeStats &quot;str&quot; 5&gt;&gt;
	&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
		Unfortunately your muscles aren&#39;t the only thing getting larger. Your stomach also groans and expands as the surprisingly filling jelly takes up the last remaining space in your stomach, and then just a bit more...
		
		&lt;&lt;if !$inCombat&gt;&gt;
			&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
			&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $antidotePotion.name&gt;&gt;
	&lt;&lt;removeStatus&gt;&gt;
	&lt;&lt;removeTempStatus&gt;&gt;
	&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
		Unfortunately, you feel your stomach returning to normal as well, and with as full as you are this proves to be very dangerous indeed. As you feel your stomach stretch tighter and tighter around it&#39;s contents, you find it harder and harder to stay concious as you&#39;re overwhelmed by fullness. 
		&lt;&lt;if !$inCombat&gt;&gt;
			&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
			&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $oddCookie.name&gt;&gt;
	&lt;&lt;set _random = random(1,11)&gt;&gt;
	
	&lt;&lt;if _random &lt;= 8&gt;&gt;
		You bite into the cookie, which tastes sweet but earthy, not unlike oatmeal. As it settles in your stomach you feel it gurgle in response. 
		&lt;&lt;if $ate &gt; 0&gt;&gt;
			&lt;&lt;digest 480&gt;&gt;
			You feel the pressure in your stomach lesson, as your metabolism goes to work digesting the contents of your stomach with new vigor. As it finishes you feel $hungry. 
		&lt;&lt;else&gt;&gt;
			&lt;&lt;digest 480&gt;&gt;
			You don&#39;t feel any other effects though, aside from the fact that you somehow feel even more starved than before. 
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;elseif _random &lt;= 10&gt;&gt;
		You bite into the cookie, which tastes sweet like molasses and cinnamon. As it settles in your stomach, you begin to feel... a bit funny. You let loose a full and heavy belch, suddenly realising you&#39;re feeling a bit stuffed, then realize that your stomach feels like it&#39;s expanding, and look on to see that indeed, it is filling out like a balloon. Whatever was in that cookie seems to be growing! 
		&lt;&lt;consume 20 13&gt;&gt;
		Within a few minutes your girth grows, your stomach sticking out &lt;&lt;sayDistance setup.waistDiameter()&gt;&gt; before it settles with a final gurgle. 
		&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
			As your stomach stretches out, you&#39;re overwhelmed by the sensation of vast overindulgence and collapse to the ground in a bloated stupor. 
			&lt;&lt;if !$inCombat&gt;&gt;
				&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
				&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;else&gt;&gt;
		You bite into the cookie, the flavor surprisingly meaty for something covered in frosting. As it hits your stomach you feel a warm and tingly sensation throughout your body. You murmur in pleasure for a moment, before realising that you&#39;re feeling a bit heavier, and watch in shock as suddenly you begin swelling up, though you feel no fuller then you did a moment before. Like a water balloon, your arms, legs and belly swell with jiggling fat, leaving a much larger $p.species in it&#39;s wake. 
		&lt;&lt;changeStats &quot;fat&quot; 30&gt;&gt;
		By the time you stop expanding you are &lt;&lt;sayWeight setup.weight()&gt;&gt;. 
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $voidOnyx.name&gt;&gt;
	&lt;&lt;set $ate = 0&gt;&gt;
	&lt;&lt;set $inf = 0&gt;&gt;
	&lt;&lt;set $infMass = 0&gt;&gt;
	&lt;&lt;set $cal = 0&gt;&gt;
	&lt;&lt;set $fat *= 0.9&gt;&gt;
	
	
&lt;&lt;case $aeroPearl.name&gt;&gt;
	&lt;&lt;inflate 60 -100&gt;&gt;
	&lt;&lt;if $hea &gt; 0 and setup.weight() &gt; 0&gt;&gt;
		You decide that there’s nothing more you can do about it till it finishes its work, sitting down and petting your expanding middle, lifting it up and placing it on your legs so it doesn’t push them apart too far. Gradually, you feel it come to a stop, and your mouth abruptly unblocks itself, snapping open and letting out a burp that brings the now-inert pearl up with it. You spit it into your hand and look at it before tossing it out, having obviously used up any value it had. As you stand, you give your gut a few inquisitive prods. You feel like it’s been permanently slightly stretched by the ordeal. You take a few moments to regain your composure, feeling a bit light-headed from the experience. Your body feels different, changed in a way you can&#39;t quite put into words.
		&lt;&lt;changeStats &quot;sto&quot; 5&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You fall onto your rear rather lightly, before the gas within you starts to lift you off the ground. The sensation is strange, almost like you&#39;re being carried away by an invisible force. 
		&lt;&lt;inflateToFloating&gt;&gt;
		&lt;&lt;if !$inCombat&gt;&gt;
			You wiggle helplessly as you continue to bloat, floating away in the wind as some onlookers gaze on. You rise higher and higher into the sky, and the thinning air begins to make your head spin, before it all becomes too much and you pass out. As you lose consciousness, you can&#39;t help but wonder what will become of you, floating aimlessly in the sky. The last thing you remember is the shrinking world below you.
			&lt;&lt;set $defeatedBy to &quot;floating&quot;&gt;&gt;
			&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $denseTopaz.name&gt;&gt;
	&lt;&lt;consume 100 50&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;
		As the power wanes from the gem, you look down at yourself, your stomach feeling very stretched and decidedly wider and heftier than before. 
		&lt;&lt;set _gain = Math.round($fat * 0.05)&gt;&gt;
		&lt;&lt;if _gain &gt; 100&gt;&gt;&lt;&lt;set _gain = 100&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;&lt;changeStats &quot;fat&quot; _gain&gt;&gt;
	&lt;&lt;else&gt;&gt;
		But you’re more concerned with the increasing warmth and pressure in your middle. You’re starting to feel a bit unwell, and to your concern, you can’t uncurl your hand from the gem. As the warmth continues to grow, you begin to feel a bit dopey. Once your weight becomes too much to handle, you can’t help but flop onto your back, and you feel the gem fizzle out of power and drop from your grasp as you lose consciousness. 
		&lt;&lt;if !$inCombat&gt;&gt;
			&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
			&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $spectrumGem.name&gt;&gt;
	&lt;&lt;set _stat = random(1,2)&gt;&gt;
	&lt;&lt;changeStats &quot;str&quot; _stat&gt;&gt;
	&lt;&lt;set _stat = random(1,2)&gt;&gt;
	&lt;&lt;changeStats &quot;agi&quot; _stat&gt;&gt;
	&lt;&lt;set _stat = random(1,2)&gt;&gt;
	&lt;&lt;changeStats &quot;end&quot; _stat&gt;&gt;
	&lt;&lt;set _stat = random(1,2)&gt;&gt;
	&lt;&lt;changeStats &quot;int&quot; _stat&gt;&gt;
	&lt;&lt;set _stat = random(1,2)&gt;&gt;
	&lt;&lt;changeStats &quot;sto&quot; _stat&gt;&gt;
	
	
&lt;&lt;case $snakeVenom.name&gt;&gt;
	&lt;&lt;consume 40 20&gt;&gt;
	&lt;&lt;if $hea &gt; 0&gt;&gt;
		You gently rub your gut, waiting to see if there’s any other effects, but your stomach settles with a gurgle and you feel safe that it’s done all that it’ll do. 
		&lt;&lt;changeStats &quot;sto&quot; 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You get the horrible feeling that drinking venom taken from a snake may not have been the cleverest idea. You belch loudly, trying to ease the pressure on your stomach, but it doesn’t help – You soon keel over from the pain in your gut and fall unconscious. 
		&lt;&lt;if !$inCombat&gt;&gt;
			&lt;&lt;set $defeatedBy to &quot;overeating&quot;&gt;&gt;
			&lt;&lt;goto &quot;Defeated&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
&lt;&lt;case $sandyBox.name&gt;&gt;
	&lt;&lt;set _found = &quot;gold&quot;&gt;&gt;
	&lt;&lt;switch random(1,5)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;&lt;&lt;set _found = $coconut&gt;&gt;
	&lt;&lt;case 2&gt;&gt;&lt;&lt;set _found = $shortSword&gt;&gt;
	&lt;&lt;case 3&gt;&gt;&lt;&lt;set _found = $redSwimShirt&gt;&gt;
	&lt;&lt;case 4&gt;&gt;&lt;&lt;set _found = $blueSwimTrunks&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	&lt;&lt;if _found == &quot;gold&quot;&gt;&gt;
		&lt;&lt;set _found = random(7,13)&gt;&gt;
		_found gold! 
		&lt;&lt;set $gld += _found&gt;&gt;
	&lt;&lt;else&gt;&gt;
		_found.article _found.name! 
		&lt;&lt;getItem _found&gt;&gt;	
	&lt;&lt;/if&gt;&gt;


&lt;&lt;case $treasureChest.name&gt;&gt;
	&lt;&lt;set _chance = random(1,4)&gt;&gt;
	&lt;&lt;if _chance == 4&gt;&gt;
		&lt;&lt;set _chance = random(10,25)&gt;&gt;
		_chance gold! 
		&lt;&lt;set $gld += _chance&gt;&gt;
	&lt;&lt;else&gt;&gt;
		_chance unidentified gem&lt;&lt;if _chance &gt; 1&gt;&gt;s&lt;&lt;/if&gt;&gt;!
		&lt;&lt;for _chance; _chance &gt; 0; _chance--&gt;&gt;
			&lt;&lt;getItem $unidentifiedGem&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;


&lt;&lt;case $bookOfCrystals.name&gt;&gt;
	&lt;&lt;if setup.hasItem($unidentifiedGem) &gt;= 0&gt;&gt;
		You take out one of the gems you found and open the book, flicking to the back pages. You leaf through them until you find what you think is a match. After double checking it a few times, you find it’s 
		&lt;&lt;set _found = $coconut&gt;&gt;
		&lt;&lt;set _chance = random(1,100)&gt;&gt;
		&lt;&lt;if _chance &gt; 95&gt;&gt;&lt;&lt;set _found = $spectrumGem&gt;&gt;
		&lt;&lt;elseif _chance &gt; 85&gt;&gt;&lt;&lt;set _found = $denseTopaz&gt;&gt;
		&lt;&lt;elseif _chance &gt; 65&gt;&gt;&lt;&lt;set _found = $aeroPearl&gt;&gt;
		&lt;&lt;elseif _chance &gt; 35&gt;&gt;&lt;&lt;set _found = $voidOnyx&gt;&gt;&lt;&lt;/if&gt;&gt;
		_found.article _found.name! &lt;&lt;if _found.name == $coconut.name&gt;&gt;You really think you should&#39;ve noticed it was a coconut earlier, but it is a very nice coconut. &lt;&lt;/if&gt;&gt;
		&lt;&lt;removeItem $unidentifiedGem&gt;&gt;
		&lt;&lt;getItem _found&gt;&gt;
	&lt;&lt;else&gt;&gt;
		You have no gems to identify. 
	&lt;&lt;/if&gt;&gt;
	
	/*This is the wrong way to fix this not being reuseable, but c&#39;est la vie. Fix in next release*/
	You put the book back in your inventory. 
	&lt;&lt;getItem $bookOfCrystals&gt;&gt;

&lt;&lt;/switch&gt;&gt;


&lt;&lt;updatePanels&gt;&gt;</tw-passagedata><tw-passagedata pid="573" name="weapon objects" tags="" position="3425,175" size="100,100">&lt;&lt;set $axe = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Axe&quot;,
	name: &quot;axe&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 21,
	stat: &quot;str&quot;,
	damage: 2,
	range: 6,
	scaling: 0.3,
	damageType: &quot;slashing&quot;,
	description: &quot;A small one-handed iron metal axe. &quot;,
	itemUse: &quot;You heft the solid axe in your hand. It looks more like it was meant for chopping wood than fighting foes, but it&#39;s pointy enough to probably not matter. &quot;
}&gt;&gt;

&lt;&lt;set $beastclawBracers = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Beastclaw Bracers&quot;,
	name: &quot;Beastclaw Bracers&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 750,
	stat: &quot;agi&quot;,
	damage: 1,
	range: 4,
	scaling: 1,
	damageType: &quot;slashing&quot;,
	description: &quot;A set of bracers enchanted with the spirit of a vicious predator. Wearing them transforms your claws into dangerous shredding weapons, even if you didn&#39;t have claws previously. &quot;,
	itemUse: &quot;You don the bracers, and your hands shudder as your claws grow harder, longer, and sharper. &quot;,
	attack: &quot;You maul your enemy with your claws, &quot;
}&gt;&gt;

&lt;&lt;set $blackSword = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Black sword&quot;,
	name: &quot;black sword&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 850,
	stat: &quot;str&quot;,
	damage: 6,
	range: 12,
	scaling: 0.75,
	damageType: &quot;slashing&quot;,
	proc: &quot;drain&quot;,
	procChance: 25,
	procPower: 20,
	description: &quot;A cursed obsidian greatsword that has gone by many names throughout history, just holding this life-draining sword fills your mind with dark thoughts. &quot;,
	itemUse: &quot;You take up the great black blade, and find yourself excited at the thought of hurting something with it. &quot;,
	attack: &quot;You slash your enemy with your bloodthirsty blade, &quot;
}&gt;&gt;

&lt;&lt;set $charredWand = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Charred wand&quot;,
	name: &quot;charred wand&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 130,
	stat: &quot;int&quot;,
	damage: 1,
	range: 10,
	scaling: 1,
	damageType: &quot;arcane&quot;,
	health: -50,
	description: &quot;Charred and blackened, this wand doesn&#39;t look like much, but has the curious trait of amplifying magic directed down it to a dangerous degree, both for the target and for the wielder. &quot;,
	itemUse: &quot;You grip the wand in your $p.hand and immediately feel a sensation as though the wand was on fire. The effect dies down rather quickly, but the wand is still somewhat painful to hold. &quot;,
	attack: &quot;A bolt of red arcane light arcs towards your opponent, &quot;
}&gt;&gt;

&lt;&lt;set $dagger = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Dagger&quot;,
	name: &quot;dagger&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 27,
	stat: &quot;agi&quot;,
	damage: 1,
	range: 10,
	scaling: 0.4,
	damageType: &quot;piercing&quot;,
	description: &quot;A razor sharp iron metal dagger. &quot;,
	itemUse: &quot;You prick your finger on the point of your dagger. This thing&#39;s sharp! &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $fireWand = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Fire wand&quot;,
	name: &quot;fire wand&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 50,
	stat: &quot;int&quot;,
	damage: 3,
	range: 4,
	scaling: 0.6,
	damageType: &quot;fire&quot;,
	description: &quot;A short gnarled wooden rod, burnt black and smelling distinctly of ash. Occasionaly a small burning ember flakes off and burns away. &quot;,
	itemUse: &quot;You swish and flick the wand around in a small flourish and manage to only slightly burn yourself. &quot;,
	attack: &quot;A small ball of fire arcs towards your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $giantAxe = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Giant axe&quot;,
	name: &quot;giant axe&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 73,
	stat: &quot;str&quot;,
	damage: 3,
	range: 15,
	scaling: 0.6,
	damageType: &quot;bashing&quot;,
	description: &quot;This mass of steel has a curved cutting edge backed by enormous weight. Smith&#39;s signature can be seen on the flat of it. &quot;,
	itemUse: &quot;You haul the heavy axe up onto a shoulder, more than equipped to take on the biggest tree you can find. &quot;,
	attack: &quot;You swing your mighty axe, &quot;
}&gt;&gt;

&lt;&lt;set $glaive = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Glaive&quot;,
	name: &quot;glaive&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 70,
	stat: &quot;agi&quot;,
	damage: 3,
	range: 10,
	scaling: 0.6,
	damageType: &quot;slashing&quot;,
	description: &quot;A long pole with a curved blade housed on the end for slicing. The length gives it leverage, all you have to do is give it speed. &quot;,
	itemUse: &quot;You give the long weapon a test swing. It swishes through the air with a satisfying sound, and you keep it at the ready. &quot;,
	attack: &quot;You swing your glaive, &quot;
}&gt;&gt;

&lt;&lt;set $greatClub = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Great club&quot;,
	name: &quot;great club&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 15,
	stat: &quot;str&quot;,
	damage: 4,
	range: 12,
	scaling: 0.6,
	damageType: &quot;bashing&quot;,
	description: &quot;This huge pillar of wood has a long, narrow end that could, hypothetically, allow it to be wielded as a club. You&#39;d just have to be extremely strong to manage to actually use it. &quot;,
	itemUse: &quot;You take the massive club up, resting it on one of your broad shoulders. You feel like you could level a building with this thing. &quot;
}&gt;&gt;

&lt;&lt;set $greatSword = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Great sword&quot;,
	name: &quot;great sword&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 75,
	stat: &quot;str&quot;,
	damage: 8,
	range: 5,
	scaling: 0.6,
	damageType: &quot;slashing&quot;,
	description: &quot;A huge, heavy, double-edged sword made by Smith. One side of the grip is grooved for use with two normal sized hands, and the other is grooved for one very large one. &quot;,
	itemUse: &quot;You heft the enormous blade onto one shoulder, ready to cut something clear in half. &quot;,
	attack: &quot;You swing your mighty sword, &quot;
}&gt;&gt;

&lt;&lt;set $heavyClub = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Heavy club&quot;,
	name: &quot;heavy club&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 16,
	stat: &quot;str&quot;,
	damage: 1,
	range: 8,
	scaling: 0.3,
	damageType: &quot;bashing&quot;,
	description: &quot;A very hefty hunk of wood with a rudimentary handle carved out of the smaller end and metal banding at the business end. &quot;,
	itemUse: &quot;You smack the heavy club into the palm of your hand. What it lacks in finesse it makes up for in menace. &quot;
}&gt;&gt;

&lt;&lt;set $heavyLance = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Heavy lance&quot;,
	name: &quot;heavy lance&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 49,
	stat: &quot;str&quot;,
	damage: 2,
	range: 12,
	scaling: 0.4,
	damageType: &quot;piercing&quot;,
	description: &quot;Basically a long wooden spear that slowly tapers to a metal capped point. It&#39;s quite heavy, feeling very reliable. &quot;,
	itemUse: &quot;You lift the heavy lance up in both your hands. It&#39;s heavy and study design make you feel very powerful wielding it, even if it&#39;s a bit impractical to use. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $honeyDipper = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Honey dipper&quot;,
	name: &quot;honey dipper&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 25,
	stat: &quot;str&quot;,
	damage: 1,
	range: 6,
	scaling: 0.4,
	damageType: &quot;bashing&quot;,
	description: &quot;A diminutive mallet that isn&#39;t good for much besides collecting honey. &quot;,
	itemUse: &quot;You casually toss the honey dipper up, as to examine its balance. Revolving once around its head, the honey dipper lands into your hand with a satisfactory splat. &quot;,
	attack: &quot;You bash your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $iceWand = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Ice wand&quot;,
	name: &quot;ice wand&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 62,
	stat: &quot;int&quot;,
	damage: 2,
	range: 4,
	scaling: 0.75,
	damageType: &quot;ice&quot;,
	description: &quot;A short straight metal rod, freezing cold to the touch and surrounded by a cloud of frozen mist. &quot;,
	itemUse: &quot;You grip the wand in your hand and after a furtive look around. For a brief panicked moment your tongue sticks to the rod before you manage to pull yourself free. &quot;,
	attack: &quot;A small shard of ice arcs towards your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $ironfistPebbles = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Ironfist Pebbles&quot;,
	name: &quot;Ironfist Pebbles&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 750,
	stat: &quot;str&quot;,
	damage: 1,
	range: 4,
	scaling: 1,
	damageType: &quot;bashing&quot;,
	description: &quot;A pair of small pebbles enchanted with an earthen spirit. Holding them in clenched fists makes the bearer&#39;s hands turn hard as steel. &quot;,
	itemUse: &quot;You clench the pebbles in your hands, and feel them stiffen as they turn a more metalic shade. &quot;,
	attack: &quot;You bash your enemy with your iron fists, &quot;
}&gt;&gt;

&lt;&lt;set $lightLance = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Light lance&quot;,
	name: &quot;light lance&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 49,
	stat: &quot;agi&quot;,
	damage: 2,
	range: 12,
	scaling: 0.4,
	damageType: &quot;piercing&quot;,
	description: &quot;Basically a long wooden spear that slowly tapers to a metal capped point. While it&#39;s technically light for a lance, it&#39;s still pretty damn heavy. &quot;,
	itemUse: &quot;You lift the lance up in both your hands. While it&#39;s not particularly practical to be using this item on foot, you&#39;re still sure you woldn&#39;t want to be one the receiving end of this thing. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $lightningWand = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Lightning wand&quot;,
	name: &quot;lightning wand&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 92,
	stat: &quot;int&quot;,
	damage: 1,
	range: 4,
	scaling: 0.8,
	damageType: &quot;lightning&quot;,
	description: &quot;A short gnarled wooden wand with veins of dark metal that occasional arcs off electricity. &quot;,
	itemUse: &quot;You swish and flick the wand around in a small flourish and manage to only slightly electrocute yourself. &quot;,
	attack: &quot;A thin bolt of lightning arcs towards your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $lightClub = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Light club&quot;,
	name: &quot;light club&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 10,
	stat: &quot;str&quot;,
	damage: 2,
	range: 4,
	scaling: 0.2,
	damageType: &quot;bashing&quot;,
	description: &quot;A rather hefty hunk of wood with a rudimentary handle carved out of the smaller end. It&#39;s not very fancy, but it looks menacing enough. &quot;,
	itemUse: &quot;You smack the club into the palm of your hand, making a satisfying and threatening meaty //thwack// sound. &quot;
}&gt;&gt;

&lt;&lt;set $nastyDagger = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Nasty dagger&quot;,
	name: &quot;nasty dagger&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 45,
	stat: &quot;agi&quot;,
	damage: 1,
	range: 10,
	scaling: 0.5,
	damageType: &quot;piercing&quot;,
	description: &quot;This curved dagger has jagged bits of pointy metal on its reverse side. It looks vicious, and is viciously sharp. &quot;,
	itemUse: &quot;You give the dagger a few experimental sweeps, causing it to whistle in the air, then keep it at the ready. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $obsidianSpear = {
	Article: &quot;An&quot;,
	article: &quot;an&quot;,
	Name: &quot;Obsidian tipped spear&quot;,
	name: &quot;obsidian tipped spear&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 65,
	stat: &quot;agi&quot;,
	damage: 3,
	range: 6,
	scaling: 0.5,
	damageType: &quot;piercing&quot;,
	description: &quot;The tip of this wooden spear is a black piece of chipped obsidian. While not exactly a technological marvel, its sharpness is undeniable. &quot;,
	itemUse: &quot;You pick up the spear, and while it&#39;s not very well made, its obsidian tip is spectacularly sharp and dangerous looking. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $queensSting = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Queen&#39;s Sting&quot;,
	name: &quot;Queen&#39;s Sting&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 150,
	stat: &quot;agi&quot;,
	damage: 2,
	range: 4,
	scaling: 0.6,
	damageType: &quot;piercing&quot;,
	proc: &quot;stun&quot;,
	procChance: 33,
	procPower: 1,
	description: &quot;The Insect Queen&#39;s stinger has just enough of a handhold to be a potent thrusting weapon. It straddles the line between a rapier and a spear, and seeps with an odd paralytic poison. &quot;,
	itemUse: &quot;You grab the \&quot;hilt\&quot; of the \&quot;sword\&quot; and adjust your grip to get a better hold of if. Out of curiosity you prick your finger on the end of the sword and you feel your finger go numb. The numbness quickly spreads to the rest of your hand and you quickly jerk you hand away and shake it until you get the feeling back. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $rapier = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Rapier&quot;,
	name: &quot;rapier&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 37,
	stat: &quot;agi&quot;,
	damage: 2,
	range: 4,
	scaling: 0.5,
	damageType: &quot;piercing&quot;,
	description: &quot;A plain, thin, steel sword. &quot;,
	itemUse: &quot;You give your trusty sword a few flashy swings and almost hurt yourself before deciding to stop showing off. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $shortSword = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Short sword&quot;,
	name: &quot;short sword&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 19,
	stat: &quot;str&quot;,
	damage: 3,
	range: 3,
	scaling: 0.3,
	damageType: &quot;slashing&quot;,
	description: &quot;A plain iron metal sword. &quot;,
	itemUse: &quot;You give your trusty sword a few flashy swings and almost hurt yourself before deciding to stop showing off. &quot;
}&gt;&gt;

&lt;&lt;set $spear = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Spear&quot;,
	name: &quot;spear&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 19,
	stat: &quot;agi&quot;,
	damage: 1,
	range: 12,
	scaling: 0.3,
	damageType: &quot;piercing&quot;,
	description: &quot;A long hefty wooden shaft with a sharpened metal tip. &quot;,
	itemUse: &quot;You twirl around the well balanced spear in your hands in a fashion that&#39;s not very combat effective, but it at least looks impressive. &quot;,
	attack: &quot;You jab your enemy, &quot;
}&gt;&gt;

&lt;&lt;set $starHammer = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Star hammer&quot;,
	name: &quot;star hammer&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 800,
	stat: &quot;str&quot;,
	damage: 4,
	range: 20,
	scaling: 0.8,
	damageType: &quot;bashing&quot;,
	description: &quot;An enormous mace made using a massive head made of star metal. Legend has it the star fell from the sky to smite a demonic tyrant. &quot;,
	itemUse: &quot;You lift the giant hammer onto one shoulder, ready to smash something with the boulder of iron on a stick. &quot;,
	attack: &quot;You smash your enemy with your enormous hammer, &quot;
}&gt;&gt;

&lt;&lt;set $thunderboltSpear = {
	Article: &quot;The&quot;,
	article: &quot;the&quot;,
	Name: &quot;Thunderbolt Spear&quot;,
	name: &quot;Thunderbolt Spear&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 750,
	stat: &quot;agi&quot;,
	damage: 5,
	range: 10,
	scaling: 0.75,
	damageType: &quot;lightning&quot;,
	description: &quot;A masterfully made spear struck by lightning after its creation, it crackles with electricity when thrust at an opponent. &quot;,
	itemUse: &quot;You take up the spear, its golden point raining down sparks for a moment. &quot;,
	attack: &quot;Your spear cracks with lightning as you jab your opponent, &quot;
}&gt;&gt;

&lt;&lt;set $trident = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Trident&quot;,
	name: &quot;trident&quot;,	
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 33,
	stat: &quot;str&quot;,
	damage: 3,
	range: 4,
	scaling: 0.4,
	damageType: &quot;piercing&quot;,
	description: &quot;A sharp 3-pronged metal pole. Normally meant for spear fishing, this trident is specifically designed for combat. &quot;,
	itemUse: &quot;You twirl the heavy trident around in your hands and almost end up stabbing yourself in the foot before you stop showing off. &quot;
}&gt;&gt;

&lt;&lt;set $warhammer = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Warhammer&quot;,
	name: &quot;warhammer&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 50,
	stat: &quot;str&quot;,
	damage: 2,
	range: 8,
	scaling: 0.5,
	damageType: &quot;bashing&quot;,
	description: &quot;A heavy wooden hammer with a solid metal head. Clearly meant for destructive purposes rather than constructive purposes compared to its more puny bretheren. &quot;,
	itemUse: &quot;You heft the heavy hammer in your hands. You can&amp;apos;t help but feel the strong urge to smash stuff. &quot;
}&gt;&gt;

&lt;&lt;set $wizardStaff = {
	Article: &quot;A&quot;,
	article: &quot;a&quot;,
	Name: &quot;Wizard staff&quot;,
	name: &quot;wizard staff&quot;,
	effect: &quot;Equip&quot;,
	type: &quot;weapon&quot;,
	icon: &quot;weapon&quot;,
	value: 155,
	stat: &quot;int&quot;,
	damage: 1,
	range: 4,
	scaling: 1.1,
	damageType: &quot;arcane&quot;,
	mana: 30,
	description: &quot;This staff isn&#39;t visibly impressive as a weapon, but its ability to channel magical spells is quite potent. &quot;,
	itemUse: &quot;You heft the staff in your hands. You inspect it to glean some information on it&#39;s magic qualities and when you look at the end of it you&#39;re nearly blinded by a searing light. &quot;,
	attack: &quot;A flash of arcane light sears towards your enemy, &quot;
}&gt;&gt;</tw-passagedata><tw-passagedata pid="574" name="Boat captain says" tags="beach" position="1125,1700" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the boat captain&quot;&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;The name&#39;s $npc1.Name, and I love the sea. This boat&#39;s my home, and my home&#39;s this boat. Wouldn&#39;t have it any other way.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;When I&#39;m not ferrying folks, I&#39;m shipping goods. When I&#39;m not shipping goods, I&#39;m fishing. When I&#39;m not fishing, I&#39;m ferrying folks. Pretty good life for a $npc1.man of the sea!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;The living space doesn&#39;t make up most of this boat, even though it looks that way. Most of it&#39;s empty space for hauling trade goods or fish. I may not look like it, but I&#39;m a bit of a wheeler and dealer!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;I&#39;ll tell you a true story: One time I was out fishing way off, and I swear to you, just below the surface, I saw a great $blueDragon.species! Before I could even do anything, it looked at me and my boat, and the water just carried us off like it wanted to be left alone. Lost my favorite pole that day, I did.&quot;
&lt;&lt;set $eventCounterB = 1&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="575" name="Docks" tags="beach" position="1125,1600" size="100,100">&lt;&lt;createFixedNPC &quot;captain&quot;&gt;&gt;

&lt;p&gt;Extending out from town is a long pier, not particularly bustling with activity, though there are a few boats docked here. Signs point out the docks reserved by business-minded captains willing to offer services and transport. You follow the sign to what seems to be a docked houseboat with a sail. From the deck, a thick-bodied and round-bellied $npc1.species can be seen lazily fishing. $npc1.He glances towards the dock and catches sight of you, waving politely before calling out, &quot;Step onboard, $p.sir! Let me know what I can do for you!&quot; &lt;/p&gt;

&lt;p&gt;&lt;&lt;if setup.weight() &lt; 600&gt;&gt;You step aboard onto the lightly swaying vessel. 
&lt;&lt;else&gt;&gt;You cautiously step aboard the vessel, your heavy body causing it to sway deeply when you do so. After a moment it settles back to a light sway. Fortunately, $npc1.he doesn&#39;t seem bothered by this. 
&lt;&lt;/if&gt;&gt;&lt;/p&gt;

&lt;p&gt;&quot;This boat heads to the western island,&quot; the $npc1.species explains, not leaving $npc1.his rod. &quot;I head out regularly, and can bring you along, if you&#39;d like. What do you say?&quot;&lt;/p&gt;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Boat captain says&quot;&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;ocean&quot; &quot;Sail west&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;e&quot; &quot;leave&quot; &quot;Go back&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="576" name="Inn" tags="beach" position="1525,1775" size="100,100">&lt;&lt;createFixedNPC &quot;westInnkeeper&quot;&gt;&gt;
&lt;&lt;createFixedNPC &quot;westInnkeeperReplacement&quot; 2&gt;&gt;

&lt;&lt;set $eventCounterA = &quot;no quest&quot;&gt;&gt;


/*Sets which quest you&#39;re on*/
&lt;&lt;if !setup.questStarted($slimeQuest3)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;before 3&quot;&gt;&gt;

&lt;&lt;elseif !setup.questCompleted($slimeQuest3)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;on 3&quot;&gt;&gt;

&lt;&lt;elseif !setup.questCompleted($slimeQuest4)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;on 4&quot;&gt;&gt;

&lt;&lt;elseif !setup.questCompleted($slimeQuest5)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;on 5&quot;&gt;&gt;

&lt;&lt;elseif setup.questCompleted($slimeQuest5)&gt;&gt;
&lt;&lt;set $eventCounterA = &quot;pig popped&quot;&gt;&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;switch $eventCounterA&gt;&gt;
&lt;&lt;case &quot;before 3&quot;&gt;&gt;
You $walk into a slightly dank inn, apparently made from reclaimed ship&#39;s wood. There are rows of hammocks strung to wooden pillars that keep the place intact. The jagged windows give you a good view of the ocean, and the sound of the waves is soothing enough that you think you could catch a good night&#39;s sleep here in spite of the less-than-sterling appearance of the place. A massively obese $npc1.species $npc1.guy is doing $npc1.his best to ignore everything that is not $npc1.his meal while still &#39;running&#39; the place. 



&lt;&lt;case &quot;on 3&quot;&gt;&gt;
&lt;p&gt;You $walk into a slightly dank inn, apparently made from reclaimed ship&#39;s wood. There are rows of hammocks strung to wooden pillars that keep the place intact. The jagged windows give you a good view of the ocean, and the sound of the waves is soothing enough that you think you could catch a good night&#39;s sleep here in spite of the less-than-sterling appearance of the place. &lt;/p&gt;

&lt;&lt;set _tempQuest = $quests[setup.questIndex($slimeQuest3)]&gt;&gt;
&lt;&lt;switch _tempQuest.progress&gt;&gt;
&lt;&lt;case 0&gt;&gt;
$npc1.Name the innkeeper is still sitting at the dining table, the fat $npc1.species as surly as ever. $npc1.He&#39;s put on some weight since you brought $npc1.him that last Lemon Slime, a crescent of $npc1.his round belly poking out from under $npc1.his taut beige tunic. 

&lt;&lt;case 1&gt;&gt;
$npc1.Name the innkeeper is still sitting at the dining table, the outsized $npc1.species as surly as ever. $npc1.He&#39;s gotten even porkier recently- $npc1.his grubby old tunic and pants are splitting at the seams, but are somehow grimly sticking with $npc1.him. $npc1.His swollen porcine paunch fills $npc1.his lap and presses up against the table, while the bench $npc1.he sits on is bending beneath $npc1.his bulging backside. 

&lt;&lt;case 2&gt;&gt;
$npc1.Name the innkeeper is still sitting at the dining table, the huge $npc1.species as surly as ever. $npc1.His recent weight-gain has become un-ignorable, a good two-thirds of $npc1.his torso swelling out from beneath $npc1.his burst tunic, a love-handle slung like an enormous tyre around $npc1.his middle. The table now digs deeply into the front of $npc1.his huge stomach, the top part bulging over onto its surface. The bench creaks in protest beneath $npc1.his double-plus-sized posterior, $npc1.his pants only clinging on thanks to a huge split across their seat. $npc1.His face has grown to moon-roundness, $npc1.mouth sticking out from between fat cheeks and a sizeable double-chin. And that&#39;s without $npc1.his mouth full, which seems to be a rarity these days. 
&lt;&lt;/switch&gt;&gt;



&lt;&lt;case &quot;on 4&quot;&gt;&gt;
&lt;p&gt;You $walk into a slightly dank inn, apparently made from reclaimed ship&#39;s wood. There are rows of hammocks strung to wooden pillars that keep the place intact. The jagged windows give you a good view of the ocean, and the sound of the waves is soothing enough that you think you could catch a good night&#39;s sleep here in spite of the less-than-sterling appearance of the place. &lt;/p&gt;

$npc1.Name the innkeeper has become a local landmark, a $npc1.species so super-sized that visitors come to stay just to gawp at $npc1.him. Wider than $npc1.he is tall, the near-spherical porker sits at $npc1.his usual table, $npc1.his stomach mostly resting on top, the front of it wobbling off the planks at the far side. $npc1.His bacon-ball behind is parked on a bench built for three and leaves no room for anyone else. The bench bends so far that it actually touches the ground- it HAS to be magically reinforced, no mere wood could survive that load. The burst and split remnants of a tunic and rough pants cling to $npc1.his overblown curves, just enough to leave $npc1.him decent, but leaving very little of $npc1.him to the imagination. $npc1.His chubby chins rest atop his swollen chest, $npc1.his head being pushed slightly up and back to accommodate its volume. $npc1.His fat arms rest on $npc1.his sides when $npc1.he&#39;s not eating- and these days that&#39;s practically ALL $npc1.he does, shovelling down meal after meal. 



&lt;&lt;case &quot;on 5&quot;&gt;&gt;
&lt;p&gt;You $walk into a slightly dank inn, apparently made from reclaimed ship&#39;s wood. There are rows of hammocks strung to wooden pillars that keep the place intact. The jagged windows give you a good view of the ocean, and the sound of the waves is soothing enough that you think you could catch a good night&#39;s sleep here in spite of the less-than-sterling appearance of the place. &lt;/p&gt;

&lt;&lt;set _tempQuest = $quests[setup.questIndex($slimeQuest5)]&gt;&gt;
&lt;&lt;switch _tempQuest.progress&gt;&gt;
&lt;&lt;case 0&gt;&gt;
$npc1.Name the sumo-sized $npc1.adjective innkeeper is still sitting at the dining table, bigger than ever, and twice as surly! This hugely overfed specimen of $npc1.species-kind is now making the table $npc1.he sits at look kind of small, almost swamped beneath $npc1.his downright vast, doughy belly. Since you last saw $npc1.him even more $npc1.species-blubber has bulged free of the confines of $npc1.his burst and tattered clothing, which are starting to look under a desperate strain. Magically reinforced or not, the 3-person bench $npc1.he&#39;s sitting on has bowed down further yet beneath the weight of $npc1.his gigantic bottom, and $npc1.he&#39;s grown nearly as wide as it. 

&lt;&lt;case 1&gt;&gt;
$npc1.Name the enormous $npc1.adjective innkeeper is still sitting at the dining table, bigger than ever, and twice as surly! This massively overfed specimen of $npc1.pig-kind is now practically filling $npc1.his corner of the inn, that table now completely buried beneath the pachyderm-sized ball of flab that $npc1.he calls his middle. Since you last saw $npc1.him even more $npc1.pig-blubber has bulged free of the confines of $npc1.his burst and tattered clothing, which are now hardly noticeable on $npc1.his humungous frame. Magically reinforced or not, the 3-person bench $npc1.he&#39;s sitting on has bowed down further yet beneath the weight of $npc1.his stupendously fat bottom, and $npc1.he&#39;s now visibly wider than it. 

&lt;&lt;case 2&gt;&gt;
$npc1.Name the gargantuan $npc1.adjective innkeeper is still sitting at the dining table, bigger than ever, and twice as surly! This stupendously overfed specimen of $npc1.pig-kind is starting to make the inn feel a bit small, the table now groaning beneath the hot-air balloon-sized hill of fatty $npc1.pork that $npc1.he calls $npc1.his middle. Since you last saw $npc1.him even more $npc1.pig-blubber has bulged free of the confines of $npc1.his burst and tattered clothing, which are now threatening to burst if $npc1.he so much as breathes deeply. Magically reinforced or not, the 3-person bench $npc1.he&#39;s sitting on has bowed down further yet beneath the weight of $npc1.his whale-like bottom, which is now starting to overflow it. 

&lt;&lt;case 3&gt;&gt;
$npc1.Name the $npc1.adjective innkeeper has now achieved whale-like proportions, and makes the entire building feel downright cramped! Travellers just stop and gape at this ludicrously overfed, sweaty specimen of $npc1.pig-kind, the dining table buried somewhere beneath $npc1.his mountainous blimp of a belly bending and creeeaking under the load, while they eat their dinners off their laps. The straining tatters of clothes hanging on around $npc1.his balloon-like bulk are now on the verge of destruction, creaking dangerously if $npc1.he so much as hiccups. $npc1.His neck has completely vanished, sandwiched somewhere between the twin hills $npc1.his chest has become and the thick facial tyre of $npc1.his double chin. Magically reinforced or not, the 3-person bench $npc1.he&#39;s sitting on is now almost hidden from view beneath $npc1.his indescribably fat backside, the only sign of its existence the occasional creak when $npc1.he reaches laboriously back to scratch an itch. 
&lt;&lt;/switch&gt;&gt;



&lt;&lt;case &quot;pig popped&quot;&gt;&gt;
&lt;p&gt;You $walk into an inn near the seashore, newly rebuilt and redecorated, it would seem. Built from reclaimed wood, there&#39;s a pleasant smell of sawdust and beeswax around the place, and all the freshly-stripped and scrubbed planking gleams, livened up by touches of cheerful paint here and there. Large porthole-style windows let in plenty of light to make the modest place seem airy. A set of fine straw beds seem to be available for any who want them, and for free. &lt;/p&gt;

&lt;p&gt;A surprisingly tall and muscular $npc2.color $npc2.species clad in a bright flower-patterned shirt and apron seems to be in charge of the place, busily wiping down tables and keeping things spick-and-span. &lt;/p&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Sleep&quot; &quot;West inn sleep&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Talk to innkeeper&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;if $eventCounterA != &quot;pig popped&quot;&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;quest&quot; &quot;Quest&quot; &quot;West inn quest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="577" name="Panther merchant says" tags="beach" position="1400,1775" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the merchant&quot;&gt;&gt;

&lt;&lt;set _parent = &quot;mom&quot;&gt;&gt;
&lt;&lt;if $npc1.male == &quot;male&quot;&gt;&gt; /* Panthers are both same genders, so we can just check the merchant&#39;s gender */
	&lt;&lt;set _parent = &quot;pop&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;switch $eventCounterB&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&quot;I&#39;m $npc1.name. I run the shop while my _parent&#39;s out adventuring. We&#39;ve got clothes for swimming, candy for eating, and big nasty weapons for fighting monsters!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;_parent.toUpperFirst() took a boat west over the ocean. $npc1.He says there&#39;s an island out there where dinosaurs live. I bet $npc1.he&#39;s having super exciting adventures all the time there!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;Are you an adventurer? I&#39;m gonna be one when I grow up. I wanna find a big ol&#39; dragon and poke it in the face!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;I like selling things, too. Running a store is fun, but it&#39;s a different kind of fun than exploring. I smile and tell people a price, and they give me gold! Hee hee!&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="578" name="Sail west" tags="beach" position="1050,1475" size="100,100">&lt;p&gt;&quot;All right, make yourself comfortable,&quot; the $npc1.species says, finally getting up to weigh anchor as $npc1.he hums a little song to $npc1.himself. $npc1.He seems content to do the job by hand, pulling it up with $npc1.his burly arms rather than a winch before pushing the boat away from the dock with one thick leg. $npc1.He breaks into a song about someone named Barrett, you think, as $npc1.he looses the sail and makes for the helm. &lt;/p&gt;

&lt;&lt;switch random(1,8)&gt;&gt;

&lt;&lt;case 1&gt;&gt;You spend the trip fishing, but the captain takes what you catch as a fare. 
&lt;&lt;case 2&gt;&gt;The trip is spent singing progressively more outlandish songs about things that almost certainly never happened. 
&lt;&lt;case 3&gt;&gt;The captain spends the entire time regaling you with facts about fishing that you will never, ever use. 
&lt;&lt;case 4&gt;&gt;The captain talks about the dozens of ways you can prepare a fish. $npc1.He never seems to run out. 
&lt;&lt;case 5&gt;&gt;The trip is a little worrying as the captain somehow takes a nap that lasts the duration. Fortunately, $npc1.he wakes up in time to dock safely. 
&lt;&lt;case 6&gt;&gt;You manage to get a view of a pod of &lt;&lt;=$dolphin.plural&gt;&gt; swimming by. One of them waves at you cheerfully. 
&lt;&lt;default&gt;&gt;
	&lt;&lt;switch random(1,4)&gt;&gt;
	&lt;&lt;case 1&gt;&gt;The captain spends the trip weaving consecutively bigger lies about the loves $npc1.he&#39;s had and lost. You call $npc1.him out around the time $npc1.he tries to convince you $npc1.he picked a flower from the moon to swoon some damsel or another. The rest of the trip is spent with awkward silence and sheepish expressions from $npc1.him. 
	&lt;&lt;case 2&gt;&gt;The captain regales you with a certainly-false tale of $npc1.his chance encounter with a &lt;&lt;=$brownBear.species&gt;&gt;-maid, a mystical creature with the upper body of a beautiful lady &lt;&lt;=$brownBear.species&gt;&gt; and the lower body of a $dolphin.species. $npc1.He looks a bit dismayed when you just shake your head at $npc1.his nonsense. 
	&lt;&lt;case 3&gt;&gt;The captain spends the entire trip spinning tales of great sea monsters, claiming that a giant, three-headed sea snake is the reason why there aren&#39;t very many ships. $npc1.He seems put off when you bring up the point that there just isn&#39;t all that much else out there so far as anyone knows. 
	&lt;&lt;case 4&gt;&gt;The captain spends a great deal of time telling you about a poem that $npc1.he received from another sea farer in $npc1.his travels. Specifically, about the lengths $npc1.he&#39;s gone to to try to understand it. When you ask for a look, you can&#39;t make too much of it either, but it&#39;s got something to do with a poet eating &lt;&lt;=$lion.plural&gt;&gt;. 
	&lt;&lt;/switch&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;next&quot; &quot;To port&quot; &quot;Island Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="579" name="Talk to innkeeper" tags="beach" position="1525,1875" size="100,100">&lt;&lt;setPopupTitle &quot;Talk to the innkeeper&quot;&gt;&gt;
&lt;&lt;set _partner = &quot;wife&quot;&gt;&gt;
&lt;&lt;set _partnerGender = $female&gt;&gt;
&lt;&lt;if $options.fixedNPCGenders == &quot;swap&quot;&gt;&gt;
	&lt;&lt;set _partner = &quot;husband&quot;&gt;&gt;
    &lt;&lt;set _partnerGender = $male&gt;&gt;
&lt;&lt;elseif $options.fixedNPCGenders == &quot;male&quot;&gt;&gt;
	&lt;&lt;set _partner = &quot;husband&quot;&gt;&gt;
    &lt;&lt;set _partnerGender = $male&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*
&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;
*/
&lt;&lt;switch $eventCounterA&gt;&gt;

&lt;&lt;case &quot;before 3&quot;&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Eh, what? Oh. Yeah, I&#39;m $npc1.Name. Ever met anyone named $npc1.Name? Well now you have.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Have a nap, it&#39;s free. The Mages across the way pay me to keep this place open to adventurers and whatnot. Even put an enchantment on the place to keep bugs away. Good deal, you ask me. All I gotta do is make sure it doesn&#39;t collapse. It won&#39;t, by the way.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;My _partner&#39;s out adventuring, and _partnerGender.he told me earlier that when _partnerGender.he went to the forest last, some of the plants grabbed _partnerGender.him and started stuffing _partnerGender.him with syrup. I thought _partnerGender.he&#39;d finally lost it, but _partnerGender.he gave me a piece _partnerGender.he cut off, and sure enough, syrup in a vine. Crazy, huh?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;If you see my _partner out there, tell _partnerGender.him I said to see if _partnerGender.he can bring back some gelatinous monster goop. _partnerGender.He says it&#39;s delicious and I want to try some, but hell if I&#39;m going out to get lost in the forest for it.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;



&lt;&lt;case &quot;on 3&quot;&gt;&gt;
&lt;&lt;set _tempQuest = $quests[setup.questIndex($slimeQuest3)]&gt;&gt;
&lt;&lt;switch _tempQuest.progress&gt;&gt;

/*0 quest progress*/
&lt;&lt;case 0&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Have a nap, it&#39;s free. The Mages across the way pay me to keep this place open to adventurers and whatnot. Even put an enchantment on the place to keep bugs away. Good deal, you ask me. All I gotta do is make sure it doesn&#39;t collapse. It won&#39;t, by the way.\&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;Whaddya talking about, &#39;Put on weight&#39;? I ain&#39;t put on no weight, just you ask the _partner! _partnerGender.He&#39;ll say I&#39;m still the fine figure of the $npc1.species _partnerGender.he married more&#39;n 10 years ago!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;&quot;My _partner&#39;s out adventuring, and _partnerGender.he told me earlier that when _partnerGender.he went to the forest last, some of the plants grabbed _partnerGender.him and started stuffing _partnerGender.him with syrup. I thought _partnerGender.he&#39;d finally lost it, but _partnerGender.he gave me a piece _partnerGender.he cut off, and sure enough, syrup in a vine. Crazy, huh?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;Yeah, I&#39;ve seen those yellow goop things out in the forest myself. In fact, just the other day had to I show one of them a thing or two- wound up eating the whole damn thing! Ever tried one? Well, let me tell you, they&#39;re damned tasty.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

/*1 quest progress*/
&lt;&lt;case 1&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Have a nap, it&#39;s free. The Mages across the way pay me to keep this place open to adventurers and whatnot. Even put an enchantment on the place to keep bugs away. Good deal, you ask me. All I gotta do is make sure it doesn&#39;t collapse. It won&#39;t, by the way.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;Say what you like about those mages, they can&#39;t do laundry worth a dang- they managed to SHRINK alla my clothes, and that&#39;s when I ain&#39;t even never got them washed in the first place!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;&quot;My _partner&#39;s out adventuring, and _partnerGender.he told me earlier that when _partnerGender.he went to the forest last, some of the plants grabbed _partnerGender.him and started stuffing _partnerGender.him with syrup. I thought _partnerGender.he&#39;d finally lost it, but _partnerGender.he gave me a piece _partnerGender.he cut off, and sure enough, syrup in a vine. Crazy, huh?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;Yep, I went out and caught me one of those Yellow Goop Monsters out in the forest. Let me tell you, it was THIS big- I nearly couldn&#39;t finish it all!&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

/*2 quest progress*/
&lt;&lt;case 2&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Have a nap, it&#39;s free. The Mages across the way pay me to keep this place open to adventurers and whatnot. Even put an enchantment on the place to keep bugs away. Good deal, you ask me. All I gotta do is make sure it doesn&#39;t collapse. It won&#39;t, by the way.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;One of those Mages came over here the other day talking about &#39;struck-ture-ral ree-in-forse-ment of the floor. Ain&#39;t nothing wrong with this floor- it ALWAYS sounds like this when I walk on it, I told $npc1.him.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;&quot;My _partner&#39;s started talking about me going on a diet. *Snort* What&#39;d I&#39;D need with a diet, I said? And since when did it get so draughty in here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;Yep, that&#39;s me- $npc1.Name Boyer, Yellow Goop Monster Destroyer. Took two down one day last week- didn&#39;t even work up a sweat! Well, no more&#39;n USUAL, anyway...&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;on 4&quot;&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Yep, I&#39;m $npc1.Name, guess you&#39;ve heard of me. Took down three Yellow Goop Monsters at once. Don&#39;t know anyone ELSE who could stomach that, eh?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;Those dumb Mages opposite are trying to make me pay for an extra spell to keep the floor up, can you believe it! Shoddy workmanship, that&#39;s what&#39;s to blame! If it can&#39;t take the weight of just one $npc1.species standin&#39; on it they should go get their money back. &#39;Risk of collapse&#39;, my butt! Uh... not that it&#39;s gonna, of course.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;&quot;My _partner was back for a little bit, sure, did pretty good in the kitchen, but now _partnerGender.he&#39;s gone out adventuring again. I told _partnerGender.him not to, but would _partnerGender.he listen? It&#39;s terrible- _partnerGender.he&#39;d put on ten pounds out there. _partnerGender.He&#39;s really letting herself go- say, that a slice of cake you&#39;ve got there?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;You heard they&#39;ve only gone and found some BLUE goop monsters out in the hills? I hear tell it&#39;s REAL tasty. What I wouldn&#39;t give to get my hands on one of THEM. But SOMEONE&#39;s- BURRP- gotta keep this place from fallin&#39; down...&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;on 5&quot;&gt;&gt;

&lt;&lt;set _tempQuest = $quests[setup.questIndex($slimeQuest5)]&gt;&gt;
&lt;&lt;switch _tempQuest.progress&gt;&gt;

/*0 quest progress*/
&lt;&lt;case 0&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Weight problem? Who says I&#39;ve got a WEIGHT PROBLEM? You show me who said that n&#39; I&#39;ll SIT on &#39;em! Haw, THEN we&#39;ll see who&#39;s problem it is!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;My _partner&#39;s started talking about me going on a diet. //Snort// What&#39;d I&#39;D need with a diet, I said? And since when did it get so draughty in here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;I tell you, those stupid mages MUST have messed up the spell they tried to put on this floor- all the tables have gone and started to shrink! You can hardly fit a decent meal across TWO of them, now.&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

/*1 quest progress*/
&lt;&lt;case 1&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Weight problem? Who says I&#39;ve got a WEIGHT PROBLEM? You show me who said that n&#39; I&#39;ll SIT on &#39;em! Haw, THEN we&#39;ll see who&#39;s problem it is!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;Ok, so maybe I HAVE got a bit &#39;huskier&#39; lately. So what? Have you SEEN some of the fat-asses lumbering around here lately? I told the _partner, there&#39;s plenty of people out there who APPRECIATE someone who&#39;s more&#39;n just skin and bones.&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;Those mages still haven&#39;t fixed that spell they messed up when they &#39;fixed&#39; the floor- now the rest of the furniture&#39;s started to shrink! I got my butt stuck in a chair the other day- burst the thing clean apart trying to squeeze out of it!&quot; 
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

/*2 quest progress*/
&lt;&lt;case 2&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Weight problem? Who says I&#39;ve got a WEIGHT PROBLEM? You show me who said that n&#39; I&#39;ll SIT on &#39;em! Haw, THEN we&#39;ll see who&#39;s problem it is!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;Ok, so maybe I AM getting rounder. So what? People expect us innkeepers to be &#39;jolly&#39;. It&#39;s practically a law. Pass me that jug of cream, willya?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;&quot;Those clowns at the Mages&#39; Guild STILL haven&#39;t fixed that spell they messed up when they &#39;fixed&#39; the floor- now the doorways have started shrinking. Tried to get to the kitchen last night and got wedged tight. You know how much butter my _partner had to rub on me before I could squeeze through? The stuff costs money!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;You got any chow on you? All this talkin&#39;s working up a real APPETITE...&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

/*3 quest progress*/
&lt;&lt;case 3&gt;&gt;&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;&quot;Whaddya want? Can&#39;t you see I&#39;m EATING, here?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;&quot;Weight problem? Who says I&#39;ve got a WEIGHT PROBLEM? You show me who said that n&#39; I&#39;ll SIT on &#39;em! Haw, THEN we&#39;ll see who&#39;s problem it is!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;&quot;What is it with people? You put on a LITTLE bit of extra weight and they start acting like you&#39;re some fat PIG or something. My _partner called me a downright greedy hog the other day. Can you believe it?&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;&quot;Since when did you all start to get so SKINNY? I tell you, those jokers at the Mages&#39; Guild have really gotta get this crazy spell of theirs under control, or you&#39;ll all wind up vanishing!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;&quot;You got any chow on you? All this talkin&#39;s worked up one serious appetite...&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/switch&gt;&gt;



&lt;&lt;case &quot;pig popped&quot;&gt;&gt;
&lt;&lt;switch $eventCounterB&gt;&gt;
&lt;&lt;case 0&gt;&gt;
&quot;Well hi there! Welcome to the Spruce Goose! Anything you want, just ask!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&quot;I&#39;m the new innkeeper! The previous one...? Oh, $npc1.he retired. Sorta. We don&#39;t like to talk about it much. Oh, I&#39;m $npc2.Name, by the way! Pleased to meet you!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&quot;I just flew in from overseas. I think I&#39;m going to like it here! But I have to say, a lot of the locals seem very... relaxed about their figures. Nosiree, you won&#39;t catch that happening to me! I&#39;m gonna be staying in shape!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&quot;Am I always this cheerful? Sure am! I&#39;ve got a lot to be cheerful about!&quot;
&lt;&lt;set $eventCounterB++&gt;&gt;

&lt;&lt;default&gt;&gt;
&quot;If you want a bed for the night, please just help yourself! We can even do you a healthy snack if you like!&quot;
&lt;&lt;set $eventCounterB = 0&gt;&gt;

&lt;&lt;/switch&gt;&gt;


&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="580" name="West Town" tags="beach" position="1400,1500" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a convenient spot to rest. 
	&lt;&lt;rest&gt;&gt;
	&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

You&#39;re standing in the center of the small western port town. 


&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;West Town&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;if $sta &gt; 0&gt;&gt;
	&lt;&lt;action &quot;e&quot; &quot;road&quot; &quot;Western Road&quot;&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;ne&quot; &quot;mage&quot; &quot;Mage&#39;s Guild&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;s&quot; &quot;store&quot; &quot;Westerly Store&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;se&quot; &quot;inn&quot; &quot;Inn&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;nw&quot; &quot;beach&quot; &quot;Beach&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;action &quot;w&quot; &quot;ocean&quot; &quot;Docks&quot;&gt;&gt;&lt;&lt;set $travel = 1&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="581" name="West inn quest" tags="beach" position="1625,1775" size="100,100">&lt;&lt;set _partner = &quot;wife&quot;&gt;&gt;
&lt;&lt;if $options.fixedNPCGenders == &quot;swap&quot;&gt;&gt;
	&lt;&lt;set _partner = &quot;husband&quot;&gt;&gt;
&lt;&lt;elseif $options.fixedNPCGenders == &quot;male&quot;&gt;&gt;
	&lt;&lt;set _partner = &quot;husband&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Start 1st quest*/
&lt;&lt;if !setup.questStarted($slimeQuest1)&gt;&gt;
&lt;p&gt;You ask the innkeeper if there&#39;s any work $npc1.he needs doing and $npc1.he regales you with a tale of a curiously delicious monster in the forests east of town. You offer to bring back some of this &#39;gelatinous monster goop&#39; from the forest for $npc1.Name to try... for a fee. $npc1.Name looks at you suspiciously from $npc1.his bench at the dining table, but $npc1.his appetite makes the decision for $npc1.him. &lt;/p&gt;

&lt;p&gt;&quot;Ok, you manage to bring me back some of that goop to try and I&#39;ll give you... 3 gold for it.&quot; With a bit of hard bartering you manage to argue $npc1.him up to 10 gold- once you&#39;ve outlined the violence needed to subdue a slime monster. With a small but vivid demonstration on one of the inn&#39;s spoons. &lt;/p&gt;

&quot;Alright, I&#39;ll give you 10 gold for it- but don&#39;t think you can try to trick me! I&#39;ll know if it&#39;s a fake- the real stuff tastes of lemon, my _partner says. And you owe me 2 for that spoon!&quot;
&lt;&lt;getQuest $slimeQuest1&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*===Progress 1st quest*/
&lt;&lt;elseif !setup.questStarted($slimeQuest2)&gt;&gt;
/*You do have the quest item*/
&lt;&lt;if setup.hasItem($lemonSampleItem) &gt;= 0&gt;&gt;
&lt;p&gt;You plonk your sample of slime onto the empty plate in front of $npc1.Name, where it wobbles gelatinously. The fat $npc1.species&#39;s eyes widen behind $npc1.his porky cheeks. $npc1.He scoops up some of it with $npc1.his fingers and sniffs it suspiciously. &lt;/p&gt;

&lt;p&gt;&quot;Hmm... I GUESS you&#39;re on the level...&quot; $npc1.He pops the yellow slime into $npc1.his mouth, chewing. $npc1.His face lights up, and you could swear $npc1.he almost smiles. &quot;Say, that&#39;s REALLY tasty!&quot;. $npc1.He reaches to scoop the rest of the sample off the plate, but your $p.hand clamps around $npc1.his wrist, and you politely remind $npc1.him of your deal. An argument ensues. You eventually persuade $npc1.Name to grudgingly count out 5 gold pieces from $npc1.his money pouch. &lt;/p&gt;

&lt;p&gt;&quot;This is a pretty puny serving, $p.mister Bigmouth- I&#39;ll give you the other 5 if you can bring me a WHOLE one of these things-&quot; $npc1.his big belly lets out an impatient gurgle, &quot;- AND another 15 on top of that!&quot; $npc1.he adds, $npc1.his trapped $npc1.hand scrabbling to reach the remains of the goop you brought. Seeing your hesitation, $npc1.he adds, a little desperately, &quot;I&#39;ll even call us even about that spoon!&quot; &lt;/p&gt;

20 gold for capturing a Lemon slime- you can live with a deal like that. You let go of $npc1.Name&#39;s wrist, and $npc1.he grabs the remainder of the lemon slime from the plate, stuffing it into $npc1.his mouth, then noisily sucks $npc1.his fingers clean. As you turn away $npc1.he even picks up the plate and licks it clean. 

&lt;&lt;removeItem $lemonSampleItem&gt;&gt;
&lt;&lt;questReward $slimeQuest1&gt;&gt;
&lt;&lt;getQuest $slimeQuest2&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

/*Don&#39;t have quest item*/
&lt;&lt;else&gt;&gt;
&quot;Where&#39;s that Lemon Thing you were gonna bring me? Have you caught me one, yet? Well I ain&#39;t gonna wait all week for it. And where&#39;s my 2 gold for that spoon you bent?&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===Progress 2nd quest*/
&lt;&lt;elseif !setup.questStarted($slimeQuest3)&gt;&gt;
&lt;&lt;if setup.hasItem($lemonSlimeItem) &gt;= 0&gt;&gt;
&lt;p&gt;You heave the Lemon Slime onto the table like a trawlerman landing a catch. $npc1.Name is so surprised $npc1.he actually stands up, the bench $npc1.he was sat on creaking with relief. The Slime glistens and wobbles in the lamplight, apparently stunned by its capture. &lt;/p&gt;

&lt;p&gt;&quot;Holy mudda of...&quot; The $npc1.species&#39;s eyes widen, and then for the first time $npc1.his fat face breaks into a greasy grin. &quot;It&#39;s a WHOLE one! You gone and got me a whole one!&quot; $npc1.He runs a finger down one of the cube&#39;s wobbling sides, and licks it. &quot;And it tastes even better fresh!&quot; You cough and $npc1.Name scowls at you, annoyed at the interruption. &quot;Oh, yeah...&quot; Surprisingly, $npc1.he digs into $npc1.his money-pouch and pays you without any further complaint, $npc1.his eyes always returning to the large yellow jello-cube sprawled across $npc1.his table. &quot;Tell ya what, I&#39;ll give you another 50 if you can bring me THREE more of these things!&quot; $npc1.He&#39;s already licking $npc1.his lips at the thought. The Slime quivers a little on the table, possibly picking up on the $npc1.species&#39;s voracious thoughts. You shrug agreement. &lt;/p&gt;

As you turn away, you hear the rather disgusting sucking and schlurping sounds of someone tucking into an enormous lump of jello... 

&lt;&lt;removeItem $lemonSlimeItem&gt;&gt;
&lt;&lt;questReward $slimeQuest2&gt;&gt;
&lt;&lt;getQuest $slimeQuest3&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&quot;Pah, bet you ain&#39;t NEVER got one- got a friend of yours to fetch you that last bit, didya? Well tell $npc1.him to find me some more!&quot; /* yes despite refusing to edit most minor gender things, I&#39;m making the hypothetical friend available for genderswapping xP */
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Progress 3rd quest*/
&lt;&lt;elseif !setup.questCompleted($slimeQuest3)&gt;&gt;
&lt;&lt;if setup.hasItem($lemonSlimeItem) &gt;= 0&gt;&gt;
&lt;&lt;switch setup.questStage($slimeQuest3)&gt;&gt;
&lt;&lt;case 0&gt;&gt;
You haul the Lemon Slime onto the table, to appreciative gasps from bystanders. $npc1.Name&#39;s piggy eyes gleam with delight. The greedy $npc1.species grabs the end of the glistening cube and pulls off a large &lt;&lt;=$npc1.hand&gt;&gt;ful, holding it quivering in front of $npc1.his face before $npc1.he opens wide and pushes the whole chunk in at once. Then $npc1.he unceremoniously begins stuffing great goopy hunks of it into $npc1.his mouth as fast as $npc1.he can, making $npc1.his cheeks bulge out in funny shapes. You don&#39;t stay to watch. As you turn away $npc1.he calls out, rather indistinctly, &quot;Dry do geb be ab eben BIGGER wub negt dime!&quot; 

&lt;&lt;removeItem $lemonSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest3&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;p&gt;You haul the Lemon Slime onto the slime-stained table-top, to astonished gasps from bystanders. $npc1.Name&#39;s piggy eyes gleam with delight from behind $npc1.his chubbed-up cheeks. $npc1.He looks so pleased even $npc1.his flapping ears perk up some. &lt;/p&gt;

&quot;Hot DIGGITY!&quot; The shameless glutton then tears in with $npc1.his $npc1.hands, ravenously stuffing great goopy hunks of it into his mouth as if $npc1.he hadn&#39;t eaten for weeks. With each noisy swallow $npc1.he seems to swell even bigger. As you turn away $npc1.he calls out, rather indistinctly, &quot;Nob bag, bug dry do geb be ab eben BIGGER wub negt dime, Bigmoud!&quot; 

&lt;&lt;removeItem $lemonSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest3&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;p&gt;You haul the Lemon Slime onto what space there is on the slime-slicked table-top in front of $npc1.Name, to astonished gasps from bystanders. $npc1.Name grins from ear-to-ear, then lunges straight at the thing, head-first! $npc1.He sinks $npc1.his snout in the dead-centre of the glistening, jiggling cube with a tremendous GLOOP noise. The sounds that follow as $npc1.he gorges the thing down are simply indescribable. What an out-and-out PIG! As $npc1.he stuffs himself $npc1.he swells rounder and rounder, more stitches bursting as $npc1.he further outgrows $npc1.his tattered clothing. &lt;/p&gt;

&lt;p&gt;$npc1.He finally slurps down the last of the slime- even licking the table clean!- and slowly rocks back on the bench, letting out a tremendous //BURRRRRRP//, looking too stuffed to move. $npc1.He pants, $npc1.his swollen chest heaving as $npc1.he wobbles there, making few remaining stitches of $npc1.his tunic strain audibly. &lt;/p&gt;

&quot;Ok... ok... I guess y&#39;vearned yer- //BURP!//- money THIS time...&quot; The enormously fat $npc1.species wobbles futilely in an attempt to reach $npc1.his money-pouch, which in the end is found laying on the ground beneath the bench, along with the torn end of $npc1.his burst belt. $npc1.His fat fingers sluggishly fumble out 50 gold pieces onto the curved top of $npc1.his bloated belly. When you&#39;ve retrieved your gold $npc1.he sits back and puts $npc1.his $npc1.hands to the sides of $npc1.his massive middle. &quot;I can&#39;t believe I ate the whole thing....&quot; 

&lt;&lt;removeItem $lemonSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest3&gt;&gt;
&lt;&lt;questReward $slimeQuest3&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Alright then&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&quot;It&#39;s about time you showed up again, $p.mister Bigmouth! Ain&#39;t you got me another of those Lemon Goop Monsters yet? Well hurry it up! They&#39;re darn tasty! In fact, it&#39;s making me hungry just THINKING about it! Pass me &lt;&lt;print either(&quot;those crackers&quot;,&quot;the mustard&quot;,&quot;that ham&quot;,&quot;the cheese&quot;)&gt;&gt;, willya?&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*===Get 4th quest*/
&lt;&lt;elseif !setup.questStarted($slimeQuest4)&gt;&gt;
&lt;p&gt;You offer to go and fetch a Blueberry slime from the hills for the innkeeper- again. $npc1.Name&#39;s piggy eyes narrow behind $npc1.his fat, swollen cheeks across the table, which is still splattered with yellow-ish slime where it&#39;s visible from underneath that gigantic bacon-belly. &lt;/p&gt;

&quot;Back again, huh, $p.mister Bigmouth? Boy, have you got &lt;&lt;if $fat &gt; 100&gt;&gt;skinny&lt;&lt;else&gt;&gt;FAT&lt;&lt;/if&gt;&gt;! Yer lucky that business is so good lately, otherwise I&#39;d be out there getting one of those things for myself! But I&#39;m working myself to the bone here keeping things going. Alright, you bring me some of this blue monster goop and I&#39;ll make it worth your while. But even THINK &#39;bout trying to con me- this time I want a WHOLE one, straight off! I&#39;m wearing myself to skin and bones as it is!&quot; 
&lt;&lt;getQuest $slimeQuest4&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Alright then&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;


/*===Progress 4th quest*/
&lt;&lt;elseif !setup.questCompleted($slimeQuest4)&gt;&gt;
&lt;&lt;if setup.hasItem($blueSlimeItem) &gt;= 0&gt;&gt;
&lt;p&gt;With a mighty heave you haul the entire Blueberry slime onto the remaining free table-space, setting it down with a loud SPLAT! The inn falls quiet for a moment at its appearance, and even $npc1.Name forgets to look unimpressed, staring at the very large, translucent blue block of gelatine in front of $npc1.him. $npc1.He sniffs at it curiously, and gets a jet of blue slime between $npc1.his lips for $npc1.his trouble. $npc1.He gulps in surprise... and then $npc1.he licks $npc1.his lips, piggy eyes lighting up. &lt;/p&gt;

&lt;p&gt;&quot;Smokin&#39; BACON that&#39;s tasty! Dang, if I could only FARM these things I&#39;d have all the Goop I&#39;d want- and it&#39;d sell by the barrel...&quot; &lt;/p&gt;

&lt;p&gt;$npc1.Name catches sight of you, and the obese $npc1.oinker&#39;s fat face creases into an expression mixing gluttony with cunning. &quot;Say there, Pardner. Thanks for rounding up this little fella- here&#39;s 30 gold for ya trouble. Now, how&#39;d you feel about getting me a few MORE of these critters? You do and I&#39;ll give you... 100 gold- OK! OK!&quot; $npc1.he says, seeing your expression and starting to sweat, &quot;150, but you ain&#39;t squeezin&#39; a copper more outa me, you got that? Good. Make &#39;em big, healthy ones, too. It shouldn&#39;t take more&#39;n FOUR to start things off. Well... what&#39;re you doin&#39; just STANDING there?&quot; &lt;/p&gt;

You turn to leave, and behind you you hear $npc1.Name say, &quot;Of course... it&#39;d be a crying shame to let THIS one just go to waste...&quot; As you reach the door you hear a gloopy, gelatinous SQUEAK followed by some quite revolting slurping, sucking and lip-smacking sounds. The expression on a few of the customers&#39; faces encourages you not to look back. A few paces down the road you&#39;re followed by a deep, rolling BURRRRRP! from the depths of the inn. 

&lt;&lt;removeItem $blueSlimeItem&gt;&gt;
&lt;&lt;questReward $slimeQuest4&gt;&gt;
&lt;&lt;getQuest $slimeQuest5&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;else&gt;&gt;
&quot;Back already, $p.mister Bigmouth? Got me that Blue Goop Monster I told you to get me, yet? Well what&#39;re you doing standing around HERE for, you &lt;&lt;if $fat &gt; 100&gt;&gt;skinny&lt;&lt;else&gt;&gt;FAT&lt;&lt;/if&gt;&gt; layabout? Go fetch me one! I&#39;m starting to get HUNGRY, here!&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Alright then&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*===Progress 5th quest*/
&lt;&lt;elseif !setup.questCompleted($slimeQuest5)&gt;&gt;
&lt;&lt;if setup.hasItem($blueSlimeItem) &gt;= 0&gt;&gt;
&lt;&lt;switch setup.questStage($slimeQuest5)&gt;&gt;

&lt;&lt;case 0&gt;&gt;
&lt;p&gt;With a mighty heave you haul the entire Blueberry slime onto the rapidly-shrinking free table-space, setting it down with a loud //SPLAT//! $npc1.Name grunts happily, and with a deft jab elicits a squirt of blue slime that $npc1.he catches in $npc1.his mouth, rather messily. The remains of $npc1.his tunic let out a warning //creeeeak//. &quot;Mphh, at last! I&#39;d almost forgotten how TASTY these things were... Whattya doin&#39; just standing around, Bigmouth? Go and get the rest! And HUSTLE, this time!&quot; &lt;/p&gt;

You turn to leave, and behind you you hear the king-sized $npc1.oinker smacking $npc1.his lips, and that huge gut rumble loudly. &quot;I can smell the profit already... if only it didn&#39;t make me so... HUNGRY...&quot; As you reach the door you hear a gloopy, gelatinous SQUEAK followed by some quite revolting slurping, sucking and lip-smacking sounds. A few paces down the road you&#39;re followed by a deep, rolling //BURRRRRP//! from the depths of the inn. 

&lt;&lt;removeItem $blueSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest5&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;The journey continues&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 1&gt;&gt;
&lt;p&gt;With a mighty heave you haul the Blueberry slime into the air to show the $npc1.species. It dangles from your $p.hand like some weird novelty dessert. $npc1.Name &lt;&lt;=$npc1.angry&gt;&gt;s eagerly and takes it from you, and with an expert squeeze elicits a long jet of slime that $npc1.he slurps down, $npc1.his obese body bloating even bigger. $npc1.He finally wipes $npc1.his lips and sighs happily. &quot;By apple sauce that stuff&#39;s good. Folks won&#39;t be able to get enough of it! Whattya doin&#39; just standing around, Bigmouth? Go and get the rest! And HUSTLE, this time!&quot; &lt;/p&gt;

You turn to leave, while behind you the emperor-sized $npc1.oinker&#39;s gargantuan belly rumbles demandingly. &quot;This stuff&#39;s just... irresistible. //Snort!// I just can&#39;t... get enough of it...&quot; As you reach the door you hear a gloopy, gelatinous //SQUEAK// followed by some quite revolting slurping, sucking and lip-smacking sounds. A few paces down the road you&#39;re followed by a deep, rolling //BURRRRRP!// from the depths of the inn. 

&lt;&lt;removeItem $blueSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest5&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;The journey continues&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 2&gt;&gt;
&lt;p&gt;With a mighty heave you haul the Blueberry slime into the air to show the $npc1.species. It dangles from your $p.hand like some weird novelty dessert. $npc1.Name grunts greedily with delight and makes a grab for it with $npc1.his fat arms, huffing with the effort. $npc1.He wrings the struggling gelatinous cube like a giant sponge, gulping down the slime until it runs dry, then $npc1.he sits back, panting, one fat, goopy $npc1.hand absently patting$npc1. his still-swelling gut. &quot;//Oogh//... that&#39;s the real stuff alright, but I still hadta make SURE. //BURRRP!// I&#39;m gonna have customers queuing round the town for this! Whattya doin&#39; just standing around, Bigmouth? Go and get the rest! And HUSTLE, this time!&quot; &lt;/p&gt;

As you turn to leave, you overhear the sultan-sized $npc1.oinker&#39;s Taj-Mahal-scale stomach rumble tectonically. &quot;Oof... THIS time I really gotta save you for the farm... but then again you&#39;re so, so TASTY... No, I-I really GOTTA...&quot; As you reach the door you hear a gloopy, gelatinous SQUEAK followed by some quite revolting slurping, sucking and lip-smacking sounds. A few paces down the road you&#39;re followed by a deep, rolling BURRRRRP! from the depths of the inn. 
&lt;&lt;removeItem $blueSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest5&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;The journey continues&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;case 3&gt;&gt;
&lt;p&gt;With a mighty heave you haul the Blueberry slime into the air, raising an appreciative //&#39;Ooo&#39;// from nearby customers. It dangles from your $p.hand like some weird novelty dessert. $npc1.Name puffs and grunts, eyeing it without $npc1.his usual enthusiasm, so you lean forward and ceremoniously plonk it on top of $npc1.his barn-sized belly, where it wobbles sluggishly. The gigantic $npc1.species &lt;&lt;=$npc1.angry&gt;&gt;s and groans, $npc1.his fat $npc1.hands pressing against $npc1.his sides. &quot;Y-yeah, thanks, that one looks great too, &#39;m just... //BURRRP!// ...kinda FULL right now...&quot; $npc1.He looks ready to burst. &quot;H-here&#39;s your gold, s-sucker. Ha, just one of these is enough to m-make me a FORTUNE. Enjoy being POOR, Bigmouth!&quot; With a knowing smile you turn and leave, although you pause at the door, just waiting for what comes next. &lt;/p&gt;

&lt;p&gt;&quot;Groo... Cryin&#39; Chipolatas... I&#39;m... s-so STUFFED, but... but... I... just... can&#39;t... STOP...&quot; &lt;/p&gt;

&lt;p&gt;There&#39;s a quite abominable squelching noise, followed by a gloopy slurp, and you turn back in time to see the last of the slime getting swallowed. With one last gulp it&#39;s gone and for a moment nothing happens, the $npc1.species just sitting there, looking dazed. Then a low, rending //groan// starts from $npc1.his ruined, painfully-tight clothing, getting louder and louder until finally it all BURSTS apart at once! &lt;/p&gt;

&lt;&lt;if $options.popping&gt;&gt;
&lt;&lt;set _oink = $npc1.angry.toUpperCase()&gt;&gt;
&lt;&lt;set _nameAllCaps = $npc1.Name.toUpperCase()&gt;&gt;

&lt;p&gt;With a surprised //_oink!// $npc1.Name&#39;s belly surges outwards, $npc1.his whole body visibly swelling from $npc1.his latest &#39;snack&#39;. But $npc1.he just doesn&#39;t seem to stop! A deep gurrrgling comes from that behemoth of a belly, and $npc1.he continues to swell fatter, and fatter, and fatter! The magically-reinforced bench beneath $npc1.him finally //SNAPS// beneath $npc1.his weight, the force of the $npc1.species&#39;s impact shaking the entire building! But $npc1.he just keeps on ballooning outwards, barely recognisable as a $npc1.species anymore as chairs and tables and scraped across the floor in front of $npc1.him, now starting to fill a sizeable fraction of the inn! And keeps on growing! &lt;/p&gt;

&lt;p&gt;Sensing trouble you duck through the doorway and set off briskly down the road, whistling innocently. A few minutes later you hear frantic scrambling sounds and turn to watch customers from the inn leaving by any exit they can. A low, thrumming groan can be heard coming from the inn, felt more through the $p.feet than the ears. One pauses long enough to cup $npc1.his paws to $npc1.his mouth and bellow, //&quot;_nameAllCaps&#39;S GONNA BLOOOOOW!!!&quot;// &lt;/p&gt;

Watching with interest, you see the wooden walls of the inn quiver slightly, and then you&#39;re almost knocked off your $p.feet by a deafening //KABOOSHHH!// The roof bulges out and then sags inwards a little, and little splatters of slime fly everywhere. Ouch, that&#39;s going to need more than a re-paint... 

&lt;&lt;else&gt;&gt;
&lt;p&gt;$npc1.Name&#39;s belly surges outwards, $npc1.his whole body visibly swelling from $npc1.his last &#39;snack&#39;. It&#39;s too much for the furniture- with a final, devastating //SNAP// the bench gives way beneath $npc1.him. The planks may have been magically reinforced, but it looks like no-one thought the legs would ever need it. The behemoth of a $npc1.species starts to tumble backwards, almost in slow-motion. Another //CRACK// announces the collapse of the table beneath $npc1.his gut, and then there&#39;s a long, meaty, building-shaking //SLAP// as $npc1.he hits the floor, backside first, then $npc1.his back, and then $npc1.his shoulders. Several unsuspecting customers are thrown off their feet by the impact. $npc1.He bounces slightly, before crashing down again. Dust shakes down from the ceiling and you can see cracks in the walls where the wooden joists have shifted. &lt;/p&gt;

&lt;p&gt;The stunned, slime-splattered $npc1.species lays there, an island of $npc1.his own making. You grin and head out of the door, which has fallen off one hinge. As you step outside you head a deep, rumbling, bubbling gurgle coming from the supersized porker&#39;s stomach. THIS time you&#39;re sure they can hear the volcanic //BELCH// that follows two islands along. It even lifts the roof off the inn! &lt;/p&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;removeItem $blueSlimeItem&gt;&gt;
&lt;&lt;advanceQuest $slimeQuest5&gt;&gt;
&lt;&lt;questReward $slimeQuest5&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Mission accomplished&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;else&gt;&gt;
What took you so long, $p.mister Bigmouth? Got me another of those Blue Goop Monsters, yet? Well what&#39;re you doing standing around HERE for, you &lt;&lt;if $fat &gt; 100&gt;&gt;skinny&lt;&lt;else&gt;&gt;FAT&lt;&lt;/if&gt;&gt; layabout? Go fetch me one! Don&#39;t make me go out there and do your job for you!&quot;
&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;I&#39;ll get right on it&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="582" name="West inn sleep" tags="beach" position="1625,1875" size="100,100">&lt;&lt;setPassageTitle &quot;Sleep&quot;&gt;&gt;

You find a hammock to rest in and lay down for a nap. 
&lt;&lt;sleep&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;next&quot; &quot;Wake up&quot; &quot;Inn&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;action &quot;s&quot; &quot;rest&quot; &quot;Sleep&quot; &quot;West inn sleep&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="583" name="West town vendor" tags="beach" position="1300,1875" size="100,100">&lt;p&gt;A smattering of various foods and clothing are on a few shelves, and an array of weapons lines an entire wall. Behind a counter, a young looking $npc1.species $npc1.boy smiles at you. &lt;/p&gt;

&quot;Welcome to the store!&quot; $npc1.he greets you chipperly, &quot;Everything is for sale, so don&#39;t hesitate to ask for whatever you want.&quot; 

&lt;&lt;store&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;leave&quot; &quot;Done&quot; &quot;Westerly Store&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="584" name="Westerly Store" tags="beach" position="1300,1775" size="100,100">&lt;&lt;createFixedNPC &quot;westMerchant&quot;&gt;&gt;

&lt;p&gt;You $walk into the west town general store, which is neat and organized to display their goods. A smattering of various foods and clothing are on a few shelves, and an array of weapons lines an entire wall. Behind a counter, a young looking $npc1.species $npc1.boy smiles at you. 
&lt;/p&gt;

&quot;Welcome to the store!&quot; $npc1.he greets you chipperly, &quot;everything is for sale, so don&#39;t hesitate to ask for whatever you want.&quot; 

&lt;&lt;vendor &quot;west town&quot;&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;store&quot; &quot;Trade&quot; &quot;West town vendor&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;hr&gt;
&lt;&lt;set $eventCounterB = 0&gt;&gt;
&lt;&lt;icon &quot;talk&quot;&gt;&gt;&lt;&lt;popup &quot;Talk&quot; &quot;Panther merchant says&quot;&gt;&gt;&lt;br&gt;

&lt;&lt;action &quot;s&quot; &quot;leave&quot; &quot;Leave&quot; &quot;West Town&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="585" name="Widgets" tags="widget nobr" position="2075,200" size="200,200">&lt;&lt;widget &quot;changeStats&quot;&gt;&gt; /* FIXED AND EDITS - Add option to make this silent */
  &lt;&lt;set _stat = $args[0]&gt;&gt;
  &lt;&lt;set _amount = $args[1]&gt;&gt;
  &lt;&lt;set _text = $args[1]&gt;&gt;
	
	&lt;&lt;set _silent = $args[2]&gt;&gt;
  &lt;&lt;if _amount &gt;= 0&gt;&gt;&lt;&lt;set _text = &quot;+&quot;+_text&gt;&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;switch _stat&gt;&gt;

  &lt;&lt;case &quot;str&quot;&gt;&gt;
  &lt;&lt;set $bstr += _amount&gt;&gt;
  &lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Strength _text&lt;/li&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;case &quot;agi&quot;&gt;&gt;
  &lt;&lt;set $bagi += _amount&gt;&gt;
  &lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Agility _text&lt;/li&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;case &quot;end&quot;&gt;&gt;
  &lt;&lt;set $bend += _amount&gt;&gt;
  &lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Endurance _text&lt;/li&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;case &quot;int&quot;&gt;&gt;
  &lt;&lt;set $bint += _amount&gt;&gt;
  &lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Intelligence _text&lt;/li&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;case &quot;sto&quot;&gt;&gt;
  &lt;&lt;set $bsto += _amount&gt;&gt;
  &lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Stomach capacity _text&lt;/li&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;case &quot;fat&quot;&gt;&gt;
  &lt;&lt;set $fat += _amount&gt;&gt;
  &lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Fat _text&lt;/li&gt;&lt;&lt;/if&gt;&gt;
	
	/* FIXES AND EDITS - Height manipulation */
	&lt;&lt;case &quot;height&quot;&gt;&gt;
	&lt;&lt;set $bheight += _amount&gt;&gt;
	&lt;&lt;set _modifier = &quot;-&quot;&gt;&gt;
	&lt;&lt;if _amount &gt;= 0&gt;&gt;&lt;&lt;set _modifier = &quot;+&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if not _silent&gt;&gt;&lt;li&gt;Height _modifier&lt;&lt;sayDistance Math.abs(_amount)&gt;&gt;&lt;/li&gt;&lt;&lt;/if&gt;&gt;

  &lt;&lt;/switch&gt;&gt;

  &lt;&lt;updateStats&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;buff&quot;&gt;&gt;
	&lt;&lt;set _type = $args[0]&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _amount = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt; 2&gt;&gt;&lt;&lt;set _length = $args[2]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;switch _type&gt;&gt;
	
	&lt;&lt;case &quot;str&quot;&gt;&gt;
		&lt;&lt;set $status.str += _amount&gt;&gt;
		&lt;&lt;set $status.strTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Strength _amount&lt;/li&gt;
		
	&lt;&lt;case &quot;agi&quot;&gt;&gt;
		&lt;&lt;set $status.agi += _amount&gt;&gt;
		&lt;&lt;set $status.agiTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Agility _amount&lt;/li&gt;
		
	&lt;&lt;case &quot;int&quot;&gt;&gt;
		&lt;&lt;set $status.int += _amount&gt;&gt;
		&lt;&lt;set $status.intTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Intelligence _amount&lt;/li&gt;
		
	&lt;&lt;case &quot;end&quot;&gt;&gt;
		&lt;&lt;set $status.end += _amount&gt;&gt;
		&lt;&lt;set $status.endTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Endurance _amount&lt;/li&gt;
		
	&lt;&lt;case &quot;sto&quot;&gt;&gt;
		&lt;&lt;set $status.sto += _amount&gt;&gt;
		&lt;&lt;set $status.stoTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Stomach capacity _amount&lt;/li&gt;
		
	&lt;&lt;case &quot;fat&quot;&gt;&gt;
		&lt;&lt;set $status.fat += _amount&gt;&gt;
		&lt;&lt;set $status.fatTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Fatness _amount&lt;/li&gt;
	
	/* FIXES AND EDITS - Height manipulation */
	&lt;&lt;case &quot;height&quot;&gt;&gt;
		&lt;&lt;set $status.height += _amount&gt;&gt;
		&lt;&lt;set $status.heightTime += _length&gt;&gt;
		&lt;&lt;set _modifier = &quot;-&quot;&gt;&gt;
		&lt;&lt;if _amount &gt;= 0&gt;&gt;&lt;&lt;set _modifier = &quot;+&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
		
		&lt;li&gt;Height _modifier&lt;&lt;sayDistance Math.abs(_amount)&gt;&gt;&lt;/li&gt;
		
	&lt;&lt;case &quot;mana&quot;&gt;&gt;
		&lt;&lt;set $status.mana += _amount&gt;&gt;
		&lt;&lt;set $status.manaTime += _length&gt;&gt;
		/*Makes descriptor display appropriately*/
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Maximum mana _amount&lt;/li&gt;
	
	&lt;&lt;case &quot;bloat&quot;&gt;&gt;
		&lt;&lt;set $status.bloatVenom += _amount&gt;&gt;
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Bloat venom _amount&lt;/li&gt;
	
	&lt;&lt;case &quot;poison&quot;&gt;&gt;
		&lt;&lt;set $status.poison += _amount&gt;&gt;
		&lt;&lt;if _amount &gt;= 0&gt;&gt;
			&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;li&gt;Poison _amount&lt;/li&gt;
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;updateStats&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;tempBuff&quot;&gt;&gt;
	&lt;&lt;set _type = $args[0]&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _amount = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;switch _type&gt;&gt;
	
	&lt;&lt;case &quot;str&quot;&gt;&gt;
		&lt;&lt;set $tstr += _amount&gt;&gt;
		&lt;&lt;if _amount &gt; 0&gt;&gt;&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;li&gt;(Strength _amount)&lt;/li&gt;
		
	&lt;&lt;case &quot;agi&quot;&gt;&gt;
		&lt;&lt;set $tagi += _amount&gt;&gt;
		&lt;&lt;if _amount &gt; 0&gt;&gt;&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;li&gt;(Agility _amount)&lt;/li&gt;
		
	&lt;&lt;case &quot;int&quot;&gt;&gt;
		&lt;&lt;set $tint += _amount&gt;&gt;
		&lt;&lt;if _amount &gt; 0&gt;&gt;&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;li&gt;(Intelligence _amount)&lt;/li&gt;
		
	&lt;&lt;case &quot;end&quot;&gt;&gt;
		&lt;&lt;set $tend += _amount&gt;&gt;
		&lt;&lt;if _amount &gt; 0&gt;&gt;&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;li&gt;(Endurance _amount)&lt;/li&gt;
		
	&lt;&lt;case &quot;sto&quot;&gt;&gt;
		&lt;&lt;set $tsto += _amount&gt;&gt;
		&lt;&lt;if _amount &gt; 0&gt;&gt;&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;li&gt;(Stomach capacity _amount)&lt;/li&gt;
		
	&lt;&lt;case &quot;fat&quot;&gt;&gt;
		&lt;&lt;set $tfat += _amount&gt;&gt;
		&lt;&lt;if _amount &gt; 0&gt;&gt;&lt;&lt;set _amount = &quot;+&quot;+_amount&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;li&gt;(Fatness _amount)&lt;/li&gt;
	
	/* FIXES AND EDITS - Height manipulation */
	&lt;&lt;case &quot;height&quot;&gt;&gt;
		&lt;&lt;set $theight += _amount&gt;&gt;
		&lt;&lt;set _modifier = &quot;-&quot;&gt;&gt;
		&lt;&lt;if _amount &gt;= 0&gt;&gt;&lt;&lt;set _modifier = &quot;+&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
		
		&lt;li&gt;(Height _modifier&lt;&lt;sayDistance Math.abs(_amount))&gt;&gt;&lt;/li&gt;
		
	&lt;&lt;case &quot;stun&quot;&gt;&gt;
		&lt;&lt;set $stun += _amount&gt;&gt;
		&lt;li&gt;(Stunned!)&lt;/li&gt;
		
	&lt;&lt;case &quot;burn&quot;&gt;&gt;
		&lt;&lt;set $burn += _amount&gt;&gt;
		&lt;li&gt;(Burned!)&lt;/li&gt;
	
	&lt;&lt;case &quot;defense&quot;&gt;&gt;
		&lt;&lt;set $tdef += _amount&gt;&gt;
		&lt;li&gt;(Defense +_amount)&lt;/li&gt;
		
	&lt;&lt;case &quot;regen&quot;&gt;&gt;
		&lt;&lt;set $regenTime = _amount&gt;&gt;
		&lt;&lt;set $regenDamage = $args[2]&gt;&gt;
		&lt;&lt;set $regenRange = $args[3]&gt;&gt;
		&lt;&lt;spellDamage&gt;&gt;
		&lt;&lt;health $dmg&gt;&gt;
		&lt;li&gt;(Regeneration for _amount turns)&lt;/li&gt;
	
	&lt;&lt;case &quot;dodge&quot;&gt;&gt;
		&lt;&lt;set $dodge += _amount&gt;&gt;
		&lt;li&gt;(Dodge chance +_amount%)&lt;/li&gt;
    
    /* ICY SPELLS - START */
    &lt;&lt;case &quot;icyspells_ward&quot;&gt;&gt;
    	&lt;&lt;if $icyspells_ward &gt; 0&gt;&gt;
    		&lt;&lt;set $icyspells_ward += _amount&gt;&gt;
				&lt;li&gt;(Ward reinforced $icyspells_ward (+_amount))&lt;/li&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;set $icyspells_ward = _amount&gt;&gt;
				&lt;&lt;set $icyspells_wardReduction = $args[2]&gt;&gt;
				&lt;li&gt;(Ward $icyspells_ward)&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
    
    /* ICY SPELLS - END */
	
	/*error message*/
	&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in the tempBuff code!!!&#39;&#39;
	
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;updateStats&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====
	
&lt;&lt;widget &quot;removeStatus&quot;&gt;&gt;

  &lt;&lt;set $status.str = 0&gt;&gt;
  &lt;&lt;set $status.strTime = 0&gt;&gt;
  &lt;&lt;set $status.agi = 0&gt;&gt;
  &lt;&lt;set $status.agiTime = 0&gt;&gt;
  &lt;&lt;set $status.end = 0&gt;&gt;
  &lt;&lt;set $status.endTime = 0&gt;&gt;
  &lt;&lt;set $status.int = 0&gt;&gt;
  &lt;&lt;set $status.intTime = 0&gt;&gt;
  &lt;&lt;set $status.sto = 0&gt;&gt;
  &lt;&lt;set $status.stoTime = 0&gt;&gt;
  &lt;&lt;set $status.mana = 0&gt;&gt;
  &lt;&lt;set $status.manaTime = 0&gt;&gt;
  &lt;&lt;set $status.stomachStretch = 0&gt;&gt;
  &lt;&lt;set $status.wellFed = 0&gt;&gt;
  &lt;&lt;set $status.wellFedTime = 0&gt;&gt;
  &lt;&lt;set $status.dietPill = 0&gt;&gt;
  &lt;&lt;set $status.dietPillTime = 0&gt;&gt;
  &lt;&lt;set $status.bloatVenom = 0&gt;&gt;
  &lt;&lt;set $status.bloatVenomTime = 0&gt;&gt;
  &lt;&lt;set $status.poison = 0&gt;&gt;
  &lt;&lt;set $status.poisonTime = 0&gt;&gt;
  &lt;&lt;set $status.stretchFruit = 0&gt;&gt;
  &lt;&lt;set $status.stretchFruitTime = 0&gt;&gt;
	
	/* FIXES AND EDITS - Height manipulation */
	&lt;&lt;set $status.height = 0&gt;&gt;
	&lt;&lt;set $status.heightTime = 0&gt;&gt;
	
	/* ICY SPELLS  - START */
	&lt;&lt;set $status.levitate = 0&gt;&gt;
	&lt;&lt;set $status.levitateTime = 0&gt;&gt;
    &lt;&lt;set $status.enlarge = 1&gt;&gt;
    &lt;&lt;set $status.enlargeTime = 0&gt;&gt;
	/* ICY SPELLS - END */

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;removeTempStatus&quot;&gt;&gt;
	&lt;&lt;set $tstr = 0&gt;&gt;
	&lt;&lt;set $tagi = 0&gt;&gt;
	&lt;&lt;set $tint = 0&gt;&gt;
	&lt;&lt;set $tend = 0&gt;&gt;
	&lt;&lt;set $tsto = 0&gt;&gt;
	&lt;&lt;set $tfat = 0&gt;&gt;
	&lt;&lt;set $theight = 0&gt;&gt; /* FIXES AND EDITS - Height manipulation */
	&lt;&lt;set $tdef = 0&gt;&gt;
	&lt;&lt;set $regen = 0&gt;&gt;
	&lt;&lt;set $dodge = 0&gt;&gt;
	&lt;&lt;set $regenDamage = 0&gt;&gt;
	&lt;&lt;set $regenRange = 0&gt;&gt;
    
    /* ICY SPELLS - START */
    &lt;&lt;set $icyspells_ward = 0&gt;&gt;
    &lt;&lt;set $icyspells_wardReduction = 0&gt;&gt;
    /* ICY SPELLS - END */

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;endCombat&quot;&gt;&gt;
	/*Removes temporary stat changes*/
	&lt;&lt;removeTempStatus&gt;&gt;
	&lt;&lt;set $grapple = 0&gt;&gt;
	&lt;&lt;set $stun = 0&gt;&gt;
	&lt;&lt;set $burn = 0&gt;&gt;
	
	/*Removes combat status*/
	&lt;&lt;set $inCombat = false&gt;&gt;
	&lt;&lt;set $action = &quot;&quot;&gt;&gt;
    &lt;&lt;set $lastCombatSpellCast = &quot;&quot;&gt;&gt; /* FIXES AND EDITS - Implement recent cast spell */
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;updateStats&quot;&gt;&gt;
	
	&lt;&lt;set $str = Math.round($bstr + $tstr + $status.str + $status.wellFed)&gt;&gt;
	&lt;&lt;set $agi = Math.round($bagi + $tagi + $status.agi + $status.wellFed)&gt;&gt;
	&lt;&lt;set $int = Math.round($bint + $tint + $status.int + $status.wellFed)&gt;&gt;
	&lt;&lt;set $end = Math.round($bend + $tend + $status.end + $status.wellFed)&gt;&gt;
	&lt;&lt;set $sto = Math.round($bsto + $tsto + $status.sto + $status.stretchFruit)&gt;&gt;
	&lt;&lt;if setup.questStage($foundGoldThread) &gt; 0&gt;&gt;
		&lt;&lt;set $sto += setup.questStage($foundGoldThread) * 5&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* FIXES AND EDITS - Height manipulation */
	&lt;&lt;set $p.height = Math.round($bheight + $theight + $status.height)&gt;&gt;
	
	/* ICY SPELLS - Enlarge modifications */
	&lt;&lt;if $options.icyspells_enabled&gt;&gt;
		&lt;&lt;set $p.height *= $status.enlarge&gt;&gt;
		&lt;&lt;set _statMod = $status.enlarge * setup.tuning(&quot;icyspells_enlargeStatChangeMod&quot;)&gt;&gt;
		
		/* Note: The spell itself will handle what happens if stomach is changed too small for its current contents */
		&lt;&lt;if $status.enlarge != 1&gt;&gt; /* It works out that the same operations are performed regardless of which direction the enlarge goes :p */
			&lt;&lt;set $agi = Math.round($agi / _statMod)&gt;&gt;
			&lt;&lt;set $sto = Math.round($sto * _statMod)&gt;&gt;
			&lt;&lt;set $str = Math.round($str * _statMod)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    
	&lt;&lt;set $p.height = Math.clamp($p.height, setup.tuning(&quot;absoluteHeightMin&quot;), setup.tuning(&quot;absoluteHeightMax&quot;))&gt;&gt;
	
	&lt;&lt;set $maxMana = ($bint * 0.5) + $status.mana&gt;&gt;
	&lt;&lt;if $wea.mana != null&gt;&gt;&lt;&lt;set $maxMana += $wea.mana&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $arm.mana != null&gt;&gt;&lt;&lt;set $maxMana += $arm.mana&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $maxMana = Math.round($maxMana)&gt;&gt;
	&lt;&lt;if $mana &gt; $maxMana&gt;&gt;&lt;&lt;set $mana = $maxMana&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $ful = (($ate + $inf) / $sto) * 100&gt;&gt;

	
	&lt;&lt;set _newMaxHea = $bmaxHea&gt;&gt;
	&lt;&lt;if $wea.health != null&gt;&gt;&lt;&lt;set _newMaxHea += $wea.health&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $arm.health != null&gt;&gt;&lt;&lt;set _newMaxHea += $arm.health&gt;&gt;&lt;&lt;/if&gt;&gt;
 	&lt;&lt;if $ful &gt; 100&gt;&gt;
		&lt;&lt;set _newMaxHea *= (($maxFul - $ful)/($maxFul-100))&gt;&gt;
		&lt;&lt;if _newMaxHea &lt; 0&gt;&gt;&lt;&lt;set _newMaxHea = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $maxHea = Math.round(_newMaxHea)&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $maxHea = _newMaxHea&gt;&gt;
		&lt;&lt;if $wea.health != null&gt;&gt;&lt;&lt;set $maxHea += $wea.health&gt;&gt;&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $arm.health != null&gt;&gt;&lt;&lt;set $maxHea += $arm.health&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
    /* FIXES AND EDITS - START */
    /* Prevent fat from being below zero */
    &lt;&lt;if $fat &lt; 0&gt;&gt;
    	&lt;&lt;set $fat = 0&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    /* FIXES AND EDITS - END */
    
	&lt;&lt;updateDescriptions&gt;&gt;
	
	&lt;&lt;if $hea &gt; $maxHea&gt;&gt;&lt;&lt;set $hea = $maxHea&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hea &lt;= 0&gt;&gt;
		&lt;&lt;set $hea = 0&gt;&gt;
		&lt;&lt;set $alive = false&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

/*Updates character description variables*/
&lt;&lt;widget &quot;updateDescriptions&quot;&gt;&gt;
	/*===Sets fullness description===*/
	&lt;&lt;if $ful &gt; 130&gt;&gt;&lt;&lt;set $hungry = &quot;too full to think&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;&#39;&#39;You&#39;re too full to even think. Your stomach throbs and groans. &#39;&#39;&quot;&gt;&gt;
	&lt;&lt;elseif $ful &gt; 120&gt;&gt;&lt;&lt;set $hungry = &quot;ready to pop&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;&#39;&#39;You feel like you&#39;ll explode if you get any fuller. &#39;&#39;&quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 110&gt;&gt;&lt;&lt;set $hungry = &quot;engorged&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;Your stomach feels painfully distended. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 100&gt;&gt;&lt;&lt;set $hungry = &quot;bloated&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You&#39;re so full it hurts. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 85&gt;&gt;&lt;&lt;set $hungry = &quot;overstuffed&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You&#39;re full to the brim. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 75&gt;&gt;&lt;&lt;set $hungry = &quot;stuffed&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You&#39;re very full. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 65&gt;&gt;&lt;&lt;set $hungry = &quot;pretty full&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You&#39;ve had a good meal. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 55&gt;&gt;&lt;&lt;set $hungry = &quot;well fed&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You&#39;re well fed. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 45&gt;&gt;&lt;&lt;set $hungry = &quot;sated&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You don&#39;t feel the need to eat. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 25&gt;&gt;&lt;&lt;set $hungry = &quot;not very hungry&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You could eat. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 10&gt;&gt;&lt;&lt;set $hungry = &quot;hungry&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You&#39;re pretty hungry. &quot;&gt;&gt;
	&lt;&lt;elseif  $ful &gt; 0&gt;&gt;&lt;&lt;set $hungry = &quot;ravenous&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You could really eat something. &quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set $hungry = &quot;starving&quot;&gt;&gt;
	  &lt;&lt;set $status.description = &quot;You need food badly. &quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	/*===Set&#39;s fatness description===*/
	&lt;&lt;if $fat &lt;= 1&gt;&gt;&lt;&lt;set $fatness = &quot;fatless&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 10&gt;&gt;&lt;&lt;set $fatness = &quot;lean&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 45&gt;&gt;&lt;&lt;set $fatness = &quot;average&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 60&gt;&gt;&lt;&lt;set $fatness = &quot;chubby&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 75&gt;&gt;&lt;&lt;set $fatness = &quot;pudgy&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 90&gt;&gt;&lt;&lt;set $fatness = &quot;fat&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 115&gt;&gt;&lt;&lt;set $fatness = &quot;doughy&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 140&gt;&gt;&lt;&lt;set $fatness = &quot;rotund&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 170&gt;&gt;&lt;&lt;set $fatness = &quot;squishy&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 210&gt;&gt;&lt;&lt;set $fatness = &quot;obese&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 270&gt;&gt;&lt;&lt;set $fatness = &quot;porcine&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 400&gt;&gt;&lt;&lt;set $fatness = &quot;incredibly obese&quot;&gt;&gt;
	&lt;&lt;elseif $fat &lt;= 700&gt;&gt;&lt;&lt;set $fatness = &quot;elephantine&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set $fatness = &quot;whale-like&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*===Set&#39;s muscle description===*/
	&lt;&lt;set _definition = $str - $fat&gt;&gt;
	&lt;&lt;if _definition &lt;= 5&gt;&gt;&lt;&lt;set $muscles = &quot;unnoticeable&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 10&gt;&gt;&lt;&lt;set $muscles = &quot;barely noticeable&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 20&gt;&gt;&lt;&lt;set $muscles = &quot;average&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 30&gt;&gt;&lt;&lt;set $muscles = &quot;well-defined&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 40&gt;&gt;&lt;&lt;set $muscles = &quot;impressive&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 50&gt;&gt;&lt;&lt;set $muscles = &quot;rippling&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 60&gt;&gt;&lt;&lt;set $muscles = &quot;tremendous&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 70&gt;&gt;&lt;&lt;set $muscles = &quot;bodybuilderesque&quot;&gt;&gt;
	&lt;&lt;elseif _definition &lt;= 80&gt;&gt;&lt;&lt;set $muscles = &quot;gargantuan&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set $muscles = &quot;mountain-like&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	/*===Set&#39;s waist description===*/
	&lt;&lt;set _roundness = setup.waistDiameter()&gt;&gt;
	&lt;&lt;if _roundness &lt;= 1&gt;&gt;&lt;&lt;set $waist = &quot;flat&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 3&gt;&gt;&lt;&lt;set $waist = &quot;small&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 4&gt;&gt;&lt;&lt;set $waist = &quot;slightly rounded&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 5&gt;&gt;&lt;&lt;set $waist = &quot;rounded&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 6&gt;&gt;&lt;&lt;set $waist = &quot;swollen&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 7&gt;&gt;&lt;&lt;set $waist = &quot;portly&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 8&gt;&gt;&lt;&lt;set $waist = &quot;bulging&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 10&gt;&gt;&lt;&lt;set $waist = &quot;basketball sized&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 12&gt;&gt;&lt;&lt;set $waist = &quot;jumbo sized&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 14&gt;&gt;&lt;&lt;set $waist = &quot;rotund&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 17&gt;&gt;&lt;&lt;set $waist = &quot;beachball sized&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 20&gt;&gt;&lt;&lt;set $waist = &quot;massively swollen&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 23&gt;&gt;&lt;&lt;set $waist = &quot;too big to reach around&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 26&gt;&gt;&lt;&lt;set $waist = &quot;globular&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 30&gt;&gt;&lt;&lt;set $waist = &quot;person sized&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 35&gt;&gt;&lt;&lt;set $waist = &quot;spherical&quot;&gt;&gt;
	&lt;&lt;elseif _roundness &lt;= 55&gt;&gt;&lt;&lt;set $waist = &quot;mountainous&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set $waist = &quot;impossibly massive&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;	
	&lt;&lt;if _roundness &gt; $p.height&gt;&gt;&lt;&lt;set $waist = &quot;wider than you are tall&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*===Sets walking description===*/
	&lt;&lt;set _walk = &quot;walk&quot;&gt;&gt;
	&lt;&lt;set _walking = &quot;walk&quot;&gt;&gt;
	&lt;&lt;set _heaviness = $ate + ($fat * 0.4)&gt;&gt;
	&lt;&lt;if _heaviness &gt; 100&gt;&gt;
		&lt;&lt;set _walk = &quot;wobble&quot;&gt;&gt;
		&lt;&lt;set _walking = &quot;wobbling&quot;&gt;&gt;
	&lt;&lt;elseif _heaviness &gt; 150&gt;&gt;
		&lt;&lt;set _walk = &quot;waddle&quot;&gt;&gt;
		&lt;&lt;set _walking = &quot;waddling&quot;&gt;&gt;
	&lt;&lt;elseif _heaviness &gt; 300&gt;&gt;
		&lt;&lt;set _walk = &quot;lumber&quot;&gt;&gt;
		&lt;&lt;set _walking = &quot;lumbering&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if setup.testImmobile()&gt;&gt;
		&lt;&lt;set _walk = &quot;slowly roll&quot;&gt;&gt;
		&lt;&lt;set _walking = &quot;slowly rolling&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* ICY SPELLS - Add levitation - START */
	&lt;&lt;if $status.levitateTime &gt; 0&gt;&gt;
		&lt;&lt;set _walk = &quot;float&quot;&gt;&gt;
		&lt;&lt;set _walking = &quot;floating&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* ICY SPELLS - Add levitation - END */
	
	
	&lt;&lt;set $walk = _walk&gt;&gt;
	&lt;&lt;set $walking = _walking&gt;&gt;
	&lt;&lt;set $Walk = $walk.toUpperFirst()&gt;&gt;
	&lt;&lt;set $Walking = $walking.toUpperFirst()&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;consume&quot;&gt;&gt;
	&lt;&lt;if $args.length &gt;= 1&gt;&gt;&lt;&lt;set $ate += $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt;= 2&gt;&gt;&lt;&lt;set $cal += $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;updateStats&gt;&gt;
	
	&lt;&lt;if setup.waistDiameter() &gt; $top.size and !$top.popped and $top.size &gt; 0&gt;&gt;
		$top.pop
		&lt;&lt;set $top.popped = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if setup.waistDiameter() &gt; $btm.size and !$btm.popped and $btm.size &gt; 0&gt;&gt;
		$btm.pop
		&lt;&lt;set $btm.popped = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $inCombat and $args[0] &gt; 0&gt;&gt;
		&lt;&lt;set _stuffed = Math.round($args[0])&gt;&gt;
		&lt;&lt;print &quot;&lt;li&gt;//Fullness +_stuffed//&lt;/li&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

/*For not displaying extra text*/
&lt;&lt;widget &quot;consumeQuiet&quot;&gt;&gt;
	&lt;&lt;if $args.length &gt;= 1&gt;&gt;&lt;&lt;set $ate += $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt;= 2&gt;&gt;&lt;&lt;set $cal += $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;updateStats&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;inflate&quot;&gt;&gt;
	&lt;&lt;if $args.length &gt;= 1&gt;&gt;&lt;&lt;set $inf += $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $args.length &gt;= 2&gt;&gt;&lt;&lt;set $infMass += $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;updateStats&gt;&gt;
	
	&lt;&lt;if $inCombat and $args[0] &gt; 0&gt;&gt;
		&lt;&lt;set _inflated = Math.round($args[0])&gt;&gt;
		&lt;li&gt;//Fullness +_inflated//&lt;/li&gt;
		&lt;&lt;if $args.length &gt;= 2 and $args[1] &lt; 0&gt;&gt;
			&lt;li&gt;//Weight &lt;&lt;sayWeight $args[1]&gt;&gt;//&lt;/li&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;findBursting&quot;&gt;&gt;
	&lt;&lt;set $toBurst = ((($maxFul/100) * $sto) - $ate - $inf)&gt;&gt;
	&lt;&lt;if $args.length &gt; 0&gt;&gt;&lt;&lt;set $toBurst += $args[0]&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;stuffToBursting&quot;&gt;&gt;
	&lt;&lt;findBursting +1&gt;&gt;
	&lt;&lt;set _stuffing = $toBurst&gt;&gt;
	&lt;&lt;if _stuffing &lt; 0&gt;&gt;&lt;&lt;set _stuffing = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _calories = _stuffing * 0.5&gt;&gt;
	
	&lt;&lt;consume _stuffing _calories&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;stuffToAlmostBursting&quot;&gt;&gt;
	&lt;&lt;findBursting -1&gt;&gt;
	&lt;&lt;set _stuffing = $toBurst&gt;&gt;
	&lt;&lt;if _stuffing &lt; 0&gt;&gt;&lt;&lt;set _stuffing = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _calories = _stuffing * 0.5&gt;&gt;
	
	&lt;&lt;consume _stuffing _calories&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;inflateToFloating&quot;&gt;&gt;
	&lt;&lt;set _mass = -1 * Math.ceil(setup.weight())&gt;&gt;
	&lt;&lt;set _volume = $sto * 1.3&gt;&gt;
	&lt;&lt;if _mass &gt; 0&gt;&gt;&lt;&lt;set _mass = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;inflate _volume _mass&gt;&gt;
&lt;&lt;/widget&gt;&gt;
=====

&lt;&lt;widget &quot;doXP&quot;&gt;&gt;
	&lt;&lt;set $xp += $args[0]&gt;&gt;
	&lt;li&gt;You got &#39;&#39;$args[0] experience.&#39;&#39;&lt;/li&gt;
	
	/*Gain a level*/
	&lt;&lt;for $xp &gt; $xpToLvl&gt;&gt;
		&lt;li&gt;&#39;&#39;You gained a level!&#39;&#39;&lt;/li&gt;
		&lt;&lt;set $xp -= $xpToLvl&gt;&gt;
		&lt;&lt;set $lvl++&gt;&gt;
		&lt;&lt;set $lvlUp++&gt;&gt;
		&lt;&lt;set $xpToLvl = 100 + (($lvl-1)*10)&gt;&gt;
		&lt;&lt;set $bmaxHea += Math.floor($end * 0.1)&gt;&gt;
		&lt;&lt;updateStats&gt;&gt;
		&lt;&lt;health $maxHea&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;doGld&quot;&gt;&gt;
	&lt;&lt;set _gold = Math.round($args[0])&gt;&gt;
	
	/*Prevents you from losing more gold than you have*/
	&lt;&lt;if _gold &lt; 0 and $gld + _gold &lt; 0&gt;&gt;
		&lt;&lt;set _gold = $gld&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $gld += _gold&gt;&gt;
	&lt;&lt;if $gld &lt;= 0&gt;&gt;&lt;&lt;set $gld = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _gold &lt; 0&gt;&gt;
		&lt;&lt;set _gold *= -1&gt;&gt;
		&lt;li&gt;You lost &#39;&#39;_gold gold!&#39;&#39;&lt;/li&gt;
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;You got &#39;&#39;_gold gold.&#39;&#39;&lt;/li&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;digest&quot;&gt;&gt;

	&lt;&lt;set _digestFor = $args[0]&gt;&gt;
	&lt;&lt;set _digestionRate = ($sto * 0.75)/1440&gt;&gt;
	&lt;&lt;set _digested = $ate&gt;&gt;
	
	/*Removes an amount of food you&#39;ve eaten*/
	&lt;&lt;set $ate -= (_digestFor * _digestionRate)&gt;&gt;
	
	/*Prevents you from being at negative food*/
	&lt;&lt;if $ate &lt; 0&gt;&gt;&lt;&lt;set $ate = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*Burns calories from metabolism*/
	&lt;&lt;set $fat -= 0.004 * _digestFor&gt;&gt;
	&lt;&lt;if $fat &lt; 0&gt;&gt;&lt;&lt;set $fat = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*Deflates you*/
	&lt;&lt;set _deflationRate = _digestFor * 0.01&gt;&gt;
	&lt;&lt;set _deflatedAmount = $inf&gt;&gt;
	&lt;&lt;set $inf -= _deflationRate&gt;&gt;
	&lt;&lt;if $inf &lt;= 0&gt;&gt;
		&lt;&lt;set $inf = 0&gt;&gt;
		&lt;&lt;set $infMass - 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _deflatedAmount != 0&gt;&gt;
		&lt;&lt;set $infMass *= $inf/_deflatedAmount&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Converts fat to mana*/
	&lt;&lt;if $mana &lt; $maxMana&gt;&gt;
	  &lt;&lt;set _startMana = $mana&gt;&gt;
	  &lt;&lt;set _restoreMana = $maxMana * _digestFor * 0.00417&gt;&gt;
	  &lt;&lt;set $mana += _restoreMana&gt;&gt;
	  &lt;&lt;if $mana &gt; $maxMana&gt;&gt;&lt;&lt;set $mana = $maxMana&gt;&gt;&lt;&lt;/if&gt;&gt;
	  &lt;&lt;set $fat -= ($mana - _startMana) * 0.25&gt;&gt;
	  &lt;&lt;if $fat &lt; 0&gt;&gt;&lt;&lt;set $fat = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Converts calories based on the percentage you&#39;ve digested*/
	&lt;&lt;set _digested = (_digested - $ate) / _digested&gt;&gt;
	&lt;&lt;if Util.isNumeric(_digested)&gt;&gt;
		&lt;&lt;set $fat += _digested * $cal&gt;&gt;
		&lt;&lt;set $cal -= _digested * $cal&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $cal &lt; 0&gt;&gt;&lt;&lt;set $cal = 0&gt;&gt;&lt;&lt;/if&gt;&gt;/*this shouldn&#39;t matter*/
	
	&lt;&lt;updateStats&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;stamina&quot;&gt;&gt;
	&lt;&lt;if $args[0] &gt;= 0&gt;&gt;
		&lt;&lt;set $sta += $args[0]&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $sta += $args[0] * Math.pow(0.8,$end/40)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	&lt;&lt;if $sta &lt; 0&gt;&gt;&lt;&lt;set $sta = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $sta &gt; 100&gt;&gt;&lt;&lt;set $sta = 100&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;spendMana&quot;&gt;&gt;
	&lt;&lt;set $mana -= $args[0]&gt;&gt;
	&lt;&lt;if $mana &lt; 0&gt;&gt;&lt;&lt;set $mana = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $mana &gt; $maxMana&gt;&gt;&lt;&lt;set $mana = $maxMana&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;mana&quot;&gt;&gt;
	&lt;&lt;set $mana += $args[0]&gt;&gt;
	&lt;&lt;if $mana &lt; 0&gt;&gt;&lt;&lt;set $mana = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $mana &gt; $maxMana&gt;&gt;&lt;&lt;set $mana = $maxMana&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;health&quot;&gt;&gt;
	&lt;&lt;set $hea += $args[0]&gt;&gt;
	&lt;&lt;if $hea &lt; 0&gt;&gt;&lt;&lt;set $hea = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hea &gt; $maxHea&gt;&gt;&lt;&lt;set $hea = $maxHea&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $inCombat&gt;&gt;&lt;li&gt;//Health +$args[0]//&lt;/li&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;damage&quot;&gt;&gt;
	&lt;&lt;set _damage = Math.round($args[0])&gt;&gt;
	
	/* ICY SPELLS - Add ward reduction */
	&lt;&lt;set _wardBroke = false&gt;&gt;
	&lt;&lt;if $icyspells_ward &gt; 0&gt;&gt;
		&lt;&lt;set _warded = Math.round(_damage * $icyspells_wardReduction)&gt;&gt;
		
		&lt;&lt;if _warded &gt; $icyspells_ward&gt;&gt; /* cap to what&#39;s remaining */
			&lt;&lt;set _warded = $icyspells_ward&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _damage -= _warded&gt;&gt;
		
		&lt;&lt;set $icyspells_ward -= _warded&gt;&gt;
		&lt;&lt;if $icyspells_ward &lt;= 0&gt;&gt;
			&lt;&lt;set $icyspells_ward = 0&gt;&gt;
			&lt;&lt;set $icyspells_wardReduction = 0&gt;&gt;
			&lt;&lt;set _wardBroke = true&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $hea -= _damage&gt;&gt;
	&lt;&lt;if $hea &lt; 0&gt;&gt;
		&lt;&lt;set $hea = 0&gt;&gt;
		&lt;&lt;set $alive = false&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _warded &gt; 0&gt;&gt;
		&lt;li&gt;//Health -_damage (Ward protected _warded)//&lt;/li&gt;
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;//Health -_damage//&lt;/li&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _wardBroke&gt;&gt;
		&lt;li&gt;//Ward shattered!//&lt;/li&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;doDmg&quot;&gt;&gt;
	/*Sets attack stats*/
	&lt;&lt;set _attackStat = $str&gt;&gt;
	&lt;&lt;set _scaling = 0.4&gt;&gt;
	&lt;&lt;if $wea.stat == &quot;agi&quot;&gt;&gt;&lt;&lt;set _attackStat = $agi&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $wea.stat == &quot;int&quot;&gt;&gt;&lt;&lt;set _attackStat = $int&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $wea.scaling &gt; 0&gt;&gt;
		&lt;&lt;set _scaling = $wea.scaling&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $dmg = setup.xdy($wea.damage, $wea.range)&gt;&gt;
	
	&lt;&lt;set $dmg += _attackStat * _scaling&gt;&gt;
	
	&lt;&lt;set $dmg -= $e.def&gt;&gt;
	
    /* FIXES AND EDITS - change stuff */
    /*
	&lt;&lt;if $wea.damageType != null&gt;&gt;
		&lt;&lt;set _multiplier = 1&gt;&gt;
		&lt;&lt;if $e.damageResistance != null&gt;&gt;
			&lt;&lt;if $e.damageResistance.contains($wea.damageType)&gt;&gt;
				&lt;&lt;set _multiplier /= 1.5&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $e.damageWeakness != null&gt;&gt;
			&lt;&lt;if $e.damageWeakness.contains($wea.damageType)&gt;&gt;
				&lt;&lt;set _multiplier *= 1.5&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $dmg = Math.round($dmg * _multiplier)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
    */
    /* Apply weakness / resistance modifications */
    &lt;&lt;set _damageTypeMultiplier = setup.getEnemyDamageTypeMultiplier($wea.damageType, $e)&gt;&gt;
    &lt;&lt;set $dmg = Math.round($dmg * _damageTypeMultiplier)&gt;&gt;
	
	&lt;&lt;if $dmg &lt; 0&gt;&gt;&lt;&lt;set $dmg = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $dmg = Math.round($dmg)&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;spellDamage&quot;&gt;&gt;
	
    /* FIXES AND EDITS - change stuff */
	/*
    &lt;&lt;set _scaling = 0.4&gt;&gt;
	&lt;&lt;if $wea.stat == &quot;int&quot; and $wea.scaling &gt; _scaling&gt;&gt;
		&lt;&lt;set _scaling = $wea.scaling&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $dmg = setup.xdy($spellCast.damage, $spellCast.dRange)&gt;&gt;
	&lt;&lt;set $dmg += Math.round($int * _scaling)&gt;&gt;
    */
    &lt;&lt;set $dmg = setup.xdy($spellCast.damage, $spellCast.dRange)&gt;&gt;
    &lt;&lt;set $dmg += setup.getPlayerSpellBonusDamage()&gt;&gt;
	
	/* FIXES AND EDITS - change stuff */
	/*
	&lt;&lt;if $spellCast.dType != null&gt;&gt;
		&lt;&lt;set _multiplier = 1&gt;&gt;
		&lt;&lt;if $e.damageResistance != null&gt;&gt;
			&lt;&lt;if $e.damageResistance.contains($spellCast.dType)&gt;&gt;
				&lt;&lt;set _multiplier /= 1.5&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $e.damageWeakness != null&gt;&gt;
			&lt;&lt;if $e.damageWeakness.contains($spellCast.dType)&gt;&gt;
				&lt;&lt;set _multiplier *= 1.5&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $dmg = Math.round($dmg * _multiplier)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	*/
	/* Apply weakness / resistance modifications */
	&lt;&lt;set _damageTypeMultiplier = setup.getEnemyDamageTypeMultiplier($spellCast.dType, $e)&gt;&gt;
	&lt;&lt;set $dmg = Math.round($dmg * _damageTypeMultiplier)&gt;&gt;
	
	&lt;&lt;if $dmg &lt; 0&gt;&gt;&lt;&lt;set $dmg = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====

/*Tests skill against opposition*/
&lt;&lt;widget &quot;skillTest&quot;&gt;&gt;
	&lt;&lt;set _playerSkill = $args[0]&gt;&gt;
	&lt;&lt;set _enemySkill = 0&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _enemySkill = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set $skillCheck = false&gt;&gt;
	
	&lt;&lt;if random(1,100) &lt; (_playerSkill - _enemySkill)&gt;&gt;
		&lt;&lt;set $skillCheck = true&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====</tw-passagedata><tw-passagedata pid="586" name="display widgets" tags="widget nobr" position="2075,825" size="200,100">&lt;&lt;widget &quot;defeated&quot;&gt;&gt;

&lt;&lt;endCombat&gt;&gt;
&lt;&lt;set $defeatedBy = $args[0]&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;no&quot; &quot;Defeated&quot; &quot;Defeated&quot;&gt;&gt;
&lt;&lt;/action&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;startCombat&quot;&gt;&gt;

/*Optionally sets enemy*/
&lt;&lt;if $args.length &gt; 0&gt;&gt;
	&lt;&lt;setEnemy $args[0]&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Moves you to combat state*/
&lt;&lt;set $inCombat = true&gt;&gt;

&lt;&lt;set $lastCombatSpellCast = &quot;&quot;&gt;&gt; /* FIXES AND EDITS - Implement recent cast spell */
/* (technically this could be tracked within the enemy to not waste space, because it&#39;s only going to exist when the enemy&#39;s around... */

/*Creates combat link*/
&lt;&lt;action &quot;c&quot; &quot;attack&quot; &quot;Fight!&quot; &quot;Combat&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;icon&quot;&gt;&gt;
&lt;&lt;switch $args[0]&gt;&gt;

&lt;&lt;case &quot;aeroPearl&quot;&gt;&gt;[img[icon/aeroPearl.png]]
&lt;&lt;case &quot;armor&quot;&gt;&gt;[img[icon/itemArmorIcon.png]]
&lt;&lt;case &quot;attack&quot;&gt;&gt;[img[icon/attackIcon.png]]
&lt;&lt;case &quot;appearance&quot;&gt;&gt;[img[icon/appearanceIcon.png]]
&lt;&lt;case &quot;beach&quot;&gt;&gt;[img[icon/beachIcon.png]]
&lt;&lt;case &quot;building&quot;&gt;&gt;[img[icon/buildingIcon.png]]
&lt;&lt;case &quot;button&quot;&gt;&gt;[img[icon/buttonIcon.png]]
&lt;&lt;case &quot;church&quot;&gt;&gt;[img[icon/churchIcon.png]]
&lt;&lt;case &quot;compass&quot;&gt;&gt;[img[icon/surroundingsIcon.png]]
&lt;&lt;case &quot;darkMagic&quot;&gt;&gt;[img[icon/darkMagicIcon.png]]
&lt;&lt;case &quot;denseTopaz&quot;&gt;&gt;[img[icon/denseTopaz.png]]
&lt;&lt;case &quot;devour&quot;&gt;&gt;[img[icon/devourIcon.png]]
&lt;&lt;case &quot;door&quot;&gt;&gt;[img[icon/leaveIcon.png]]
&lt;&lt;case &quot;dollar&quot;&gt;&gt;[img[icon/dollar sign.png]]
&lt;&lt;case &quot;down&quot;&gt;&gt;[img[icon/downIcon.png]]
&lt;&lt;case &quot;drink&quot;&gt;&gt;[img[icon/itemDrinkIcon.png]]
&lt;&lt;case &quot;fenceGate&quot;&gt;&gt;[img[icon/fenceGateIcon.png]]
&lt;&lt;case &quot;fence&quot;&gt;&gt;[img[icon/fenceIcon.png]]
&lt;&lt;case &quot;food&quot;&gt;&gt;[img[icon/itemFoodIcon.png]]
&lt;&lt;case &quot;forest&quot;&gt;&gt;[img[icon/forestIcon.png]]
&lt;&lt;case &quot;gate&quot;&gt;&gt;[img[icon/gateIcon.png]]
&lt;&lt;case &quot;gold&quot;&gt;&gt;[img[icon/storeIcon.png]]
&lt;&lt;case &quot;grasslands&quot;&gt;&gt;[img[icon/grasslandsIcon.png]]
&lt;&lt;case &quot;greyMagic&quot;&gt;&gt;[img[icon/greyMagicIcon.png]]
&lt;&lt;case &quot;healthPotion&quot;&gt;&gt;[img[icon/itemHealthPotionIcon.png]]
&lt;&lt;case &quot;hills&quot;&gt;&gt;[img[icon/hillsIcon.png]]
&lt;&lt;case &quot;hospital&quot;&gt;&gt;[img[icon/hospitalIcon.png]]
&lt;&lt;case &quot;house&quot;&gt;&gt;[img[icon/houseIcon.png]]
&lt;&lt;case &quot;inn&quot;&gt;&gt;[img[icon/innIcon.png]]
&lt;&lt;case &quot;inventory&quot;&gt;&gt;[img[icon/inventoryIcon.png]]
&lt;&lt;case &quot;jungle&quot;&gt;&gt;[img[icon/forestIcon.png]]
&lt;&lt;case &quot;leave&quot;&gt;&gt;[img[icon/leaveIcon.png]]
&lt;&lt;case &quot;left&quot;&gt;&gt;[img[icon/returnIcon.png]]
&lt;&lt;case &quot;mage&quot;&gt;&gt;[img[icon/mageIcon.png]]
&lt;&lt;case &quot;manaPotion&quot;&gt;&gt;[img[icon/itemManaPotionIcon.png]]
&lt;&lt;case &quot;mountain&quot;&gt;&gt;[img[icon/mountainIcon.png]]
&lt;&lt;case &quot;next&quot;&gt;&gt;[img[icon/nextIcon.png]]
&lt;&lt;case &quot;no&quot;&gt;&gt;[img[icon/noIcon.png]]
&lt;&lt;case &quot;ocean&quot;&gt;&gt;[img[icon/oceanIcon.png]]
&lt;&lt;case &quot;other&quot;&gt;&gt;[img[icon/itemOtherIcon.png]]
&lt;&lt;case &quot;pants&quot;&gt;&gt;[img[icon/pantsIcon.png]]
&lt;&lt;case &quot;quest&quot;&gt;&gt;[img[icon/appearanceIcon.png]]
&lt;&lt;case &quot;restaurant&quot;&gt;&gt;[img[icon/restaurantIcon.png]]
&lt;&lt;case &quot;rest&quot;&gt;&gt;[img[icon/restIcon.png]]
&lt;&lt;case &quot;return&quot;&gt;&gt;[img[icon/returnIcon.png]]
&lt;&lt;case &quot;right&quot;&gt;&gt;[img[icon/nextIcon.png]]
&lt;&lt;case &quot;road&quot;&gt;&gt;[img[icon/roadIcon.png]]
&lt;&lt;case &quot;run&quot;&gt;&gt;[img[icon/runIcon.png]]
&lt;&lt;case &quot;shirt&quot;&gt;&gt;[img[icon/itemTopIcon.png]]
&lt;&lt;case &quot;spectrumGem&quot;&gt;&gt;[img[icon/spectrumGem.png]]
&lt;&lt;case &quot;spells&quot;&gt;&gt;[img[icon/spellsIcon.png]]
&lt;&lt;case &quot;store&quot;&gt;&gt;[img[icon/storeIcon.png]]
&lt;&lt;case &quot;surrender&quot;&gt;&gt;[img[icon/surrenderIcon.png]]
&lt;&lt;case &quot;swamp&quot;&gt;&gt;[img[icon/swampIcon.png]]
&lt;&lt;case &quot;tailor&quot;&gt;&gt;[img[icon/tailorIcon.png]]
&lt;&lt;case &quot;talk&quot;&gt;&gt;[img[icon/appearanceIcon.png]]
&lt;&lt;case &quot;time&quot;&gt;&gt;[img[icon/waitIcon.png]]
&lt;&lt;case &quot;trainingGrounds&quot;&gt;&gt;[img[icon/trainingGroundsIcon.png]]
&lt;&lt;case &quot;up&quot;&gt;&gt;[img[icon/upIcon.png]]
&lt;&lt;case &quot;voidOnyx&quot;&gt;&gt;[img[icon/voidOnyx.png]]
&lt;&lt;case &quot;wait&quot;&gt;&gt;[img[icon/waitIcon.png]]
&lt;&lt;case &quot;wall&quot;&gt;&gt;[img[icon/wallIcon.png]]
&lt;&lt;case &quot;weapon&quot;&gt;&gt;[img[icon/itemWeaponIcon.png]]
&lt;&lt;case &quot;whiteMagic&quot;&gt;&gt;[img[icon/whiteMagicIcon.png]]
&lt;&lt;case &quot;yes&quot;&gt;&gt;[img[icon/yesIcon.png]]

&lt;&lt;default&gt;&gt;&#39;&#39;Icon widget error&#39;&#39;

&lt;&lt;/switch&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;popup&quot;&gt;&gt;

&lt;&lt;link $args[0]&gt;&gt;

  &lt;&lt;set _popupPassage = $args[1]&gt;&gt;
  
  &lt;&lt;capture _popupPassage&gt;&gt;
  &lt;&lt;script&gt;&gt;
  Dialog.setup(State.temporary.popupPassage);
  Dialog.wiki(Story.get(State.temporary.popupPassage).processText());
  Dialog.open();
  &lt;&lt;/script&gt;&gt;	  
  &lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/link&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;updatePanels&quot;&gt;&gt;

&lt;&lt;replace &quot;#story-subtitle&quot;&gt;&gt;
	&lt;&lt;display &quot;StorySubtitle&quot;&gt;&gt;
&lt;&lt;/replace&gt;&gt;

&lt;&lt;replace &quot;#bottom-bar&quot;&gt;&gt;
	&lt;&lt;display &quot;BottomBar&quot;&gt;&gt;
&lt;&lt;/replace&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;popupButton&quot;&gt;&gt;

&lt;&lt;button $args[0]&gt;&gt;

  &lt;&lt;set _popupPassage = $args[1]&gt;&gt;
  
  &lt;&lt;capture _popupPassage&gt;&gt;
  &lt;&lt;script&gt;&gt;
  Dialog.setup(State.temporary.popupPassage);
  Dialog.wiki(Story.get(State.temporary.popupPassage).processText());
  Dialog.open();
  &lt;&lt;/script&gt;&gt;	  
  &lt;&lt;/capture&gt;&gt;
  
&lt;&lt;/button&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;addPretext&quot;&gt;&gt;
	&lt;&lt;set $pretext = $pretext + &quot;&lt;p&gt;&quot; + $args[0] + &quot;&lt;/p&gt;&quot;&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====
&lt;&lt;widget sayWeight&gt;&gt;
	&lt;&lt;switch $options.metric&gt;&gt;
		&lt;&lt;case true&gt;&gt;
			&lt;&lt;set _kilos = $args[0] * 0.453592&gt;&gt;
			
			&lt;&lt;if _kilos &lt; 10&gt;&gt;
				&lt;&lt;set _kilos = Math.round(_kilos * 10)/10&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;set _kilos = Math.round(_kilos)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			_kilos kilograms
		&lt;&lt;default&gt;&gt;
			&lt;&lt;set _pounds = Math.round($args[0])&gt;&gt;
			_pounds pounds
	&lt;&lt;/switch&gt;&gt;	
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget sayDistance&gt;&gt;
	&lt;&lt;set _distance = $args[0]&gt;&gt;
	
	&lt;&lt;switch $options.metric&gt;&gt;
		&lt;&lt;case true&gt;&gt;
			&lt;&lt;set _centimeters = Math.round(_distance * 2.54)&gt;&gt;
			
			&lt;&lt;if _centimeters &gt;= 100&gt;&gt;
				&lt;&lt;set _centimeters = Math.round(_centimeters/10)/10&gt;&gt;
				&lt;&lt;if _centimeters == 1&gt;&gt;1 meter
				&lt;&lt;else&gt;&gt; _centimeters meters
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;if _centimeters == 1&gt;&gt;1 centimeter
				&lt;&lt;else&gt;&gt; _centimeters centimeters
				&lt;&lt;/if&gt;&gt;

				
			&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;default&gt;&gt;
			&lt;&lt;set _distance = Math.round(_distance)&gt;&gt;
			&lt;&lt;set _feet = Math.floor(_distance / 12)&gt;&gt;
			&lt;&lt;set _inches = _distance % 12&gt;&gt;
	
	
			&lt;&lt;if _feet &gt; 1&gt;&gt;
			_feet feet
		
			&lt;&lt;elseif _feet == 1&gt;&gt;
			_feet foot
		
			&lt;&lt;/if&gt;&gt;
	
			&lt;&lt;if _inches &gt; 1&gt;&gt;
			_inches inches
	
			&lt;&lt;elseif _inches == 1&gt;&gt;
			_inches inch
	
			&lt;&lt;elseif _feet == 0&gt;&gt;
			_inches inches
	
			&lt;&lt;/if&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	
	
&lt;&lt;/widget&gt;&gt;

====
&lt;&lt;widget action container&gt;&gt;
	&lt;&lt;set _direction = $args[0]&gt;&gt;
	&lt;&lt;set _icon = $args[1]&gt;&gt;	
	&lt;&lt;set _label = $args[2]&gt;&gt;
	
	&lt;&lt;if $args.length &gt; 3&gt;&gt;&lt;&lt;set _passage = $args[3]&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;set _passage = _label&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _activity = _contents&gt;&gt;
	
	&lt;&lt;set _popup = false&gt;&gt;
	&lt;&lt;if $args.length &gt; 4&gt;&gt;&lt;&lt;set _popup = true&gt;&gt;&lt;&lt;/if&gt;&gt;
	  
	&lt;&lt;if _direction == 1 or _direction == &quot;nw&quot;&gt;&gt;
	  &lt;&lt;set $northwest = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $northwest.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	  
	
	&lt;&lt;elseif  _direction == 2 or _direction == &quot;n&quot;&gt;&gt;
	  &lt;&lt;set $north = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $north.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 3 or _direction == &quot;ne&quot;&gt;&gt;
	  &lt;&lt;set $northeast = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $northeast.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 4 or _direction == &quot;w&quot;&gt;&gt;
	  &lt;&lt;set $west = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $west.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 5 or _direction == &quot;c&quot;&gt;&gt;
	  &lt;&lt;set $center = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $center.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 6 or _direction == &quot;e&quot;&gt;&gt;
	  &lt;&lt;set $east = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $east.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 7 or _direction == &quot;sw&quot;&gt;&gt;
	  &lt;&lt;set $southwest = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $southwest.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 8 or _direction == &quot;s&quot;&gt;&gt;
	  &lt;&lt;set $south = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $south.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;elseif  _direction == 9 or _direction == &quot;se&quot;&gt;&gt;
	  &lt;&lt;set $southeast = {
		  icon: _icon,
		  label: _label,
		  passage: _passage,
		  activity: _activity,
		  popup: _popup,
	  }&gt;&gt;
	  &lt;&lt;if _icon != &quot;&quot;&gt;&gt;
	  &lt;&lt;set $southeast.label = &quot;&lt;&lt;icon &quot;+_icon+&quot;&gt;&gt;&quot;+_label&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	
	&lt;&lt;else&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget clearActions&gt;&gt;
	&lt;&lt;set $northwest = null&gt;&gt;
	&lt;&lt;set $north = null&gt;&gt;
	&lt;&lt;set $northeast = null&gt;&gt;
	&lt;&lt;set $west = null&gt;&gt;
	&lt;&lt;set $center = null&gt;&gt;
	&lt;&lt;set $east = null&gt;&gt;
	&lt;&lt;set $southwest = null&gt;&gt;
	&lt;&lt;set $south = null&gt;&gt;
	&lt;&lt;set $southeast = null&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="587" name="enemy widgets" tags="widget" position="2300,450" size="200,100">====

&lt;&lt;widget &quot;setEnemy&quot;&gt;&gt;
	&lt;&lt;set $e = clone($args[0])&gt;&gt;
	&lt;&lt;set $e.hea = $e.maxhea&gt;&gt;

	 /* FEEDER EXPANSION EDIT - START */
    /*Prevent nulls*/
    &lt;&lt;if $e.flavorWeakness == null&gt;&gt;
        &lt;&lt;set $e.flavorWeakness = []&gt;&gt;
    &lt;&lt;/if&gt;&gt;

    &lt;&lt;set $e.ate = 0&gt;&gt;
    &lt;&lt;set $e.stuffedHalf = false&gt;&gt;
    /* FEEDER EXPANSION EDIT - END */
    
	/*sets gender*/
	&lt;&lt;if $e.gender == &quot;random&quot; or $e.gender == null&gt;&gt;
		&lt;&lt;if !$options.males and $options.females&gt;&gt;
			&lt;&lt;set $e.gender = $female&gt;&gt;
		&lt;&lt;elseif !$options.females and $options.males&gt;&gt;
			&lt;&lt;set $e.gender = $male&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $e.gender = either($male, $female)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*sets species*/
	&lt;&lt;switch $e.species&gt;&gt;
		&lt;&lt;case &quot;random&quot;&gt;&gt;
			&lt;&lt;set $e.species = setup.randomSpecies()&gt;&gt;
			&lt;&lt;set $e.flavorWeakness.push(either(&quot;meat&quot;,&quot;veg&quot;,&quot;dessert&quot;))&gt;&gt; /* FEEDER EXPANSION EDIT  */
		&lt;&lt;case &quot;herbivore&quot;&gt;&gt;
			&lt;&lt;set $e.species = setup.randomHerbivore()&gt;&gt;
			&lt;&lt;set $e.flavorWeakness.push(either(&quot;veg&quot;,&quot;veg&quot;,&quot;dessert&quot;))&gt;&gt; /* FEEDER EXPANSION EDIT  */
		&lt;&lt;case &quot;carnivore&quot;&gt;&gt;
			&lt;&lt;set $e.species = setup.randomCarnivore()&gt;&gt;
			&lt;&lt;set $e.flavorWeakness.push(either(&quot;meat&quot;,&quot;meat&quot;,&quot;dessert&quot;))&gt;&gt; /* FEEDER EXPANSION EDIT  */
		&lt;&lt;case &quot;dinosaur&quot;&gt;&gt;
			&lt;&lt;set $e.species = either($raptor, $pterodactyl, $triceratops, $stegosaurus, $apatosaurus, $tyrannosaurus)&gt;&gt;
			&lt;&lt;set $e.flavorWeakness.push(either(&quot;meat&quot;,&quot;veg&quot;,&quot;dessert&quot;))&gt;&gt; /* FEEDER EXPANSION EDIT  */
		&lt;&lt;default&gt;&gt; /* Fixes and edits - adjust for new method */
        	/* Could either be that it has a species that&#39;ll be found during `createNPC`, or it was given none - we only want to make alterations if none was given */
			&lt;&lt;if $e.species == null&gt;&gt;
            	&lt;&lt;set $e.species = &quot;none&quot;&gt;&gt;
            &lt;&lt;/if&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;createNPC $e.species $e.gender 1&gt;&gt;
	
	/*Makes sure enemy stats don&#39;t have null values*/
	&lt;&lt;if $e.damageWeakness == null&gt;&gt;
		&lt;&lt;set $e.damageWeakness = []&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $e.damageResistance == null&gt;&gt;
		&lt;&lt;set $e.damageResistance = []&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $e.stun = 0&gt;&gt;
	&lt;&lt;set $e.slow = 0&gt;&gt;
	&lt;&lt;set $e.burn = 0&gt;&gt;
	&lt;&lt;set $e.burnTime = 0&gt;&gt;
	&lt;&lt;set $e.soak = 0&gt;&gt;
   

&lt;&lt;/widget&gt;&gt;


====

&lt;&lt;widget &quot;eHealth&quot;&gt;&gt;
	&lt;&lt;set _healing = Math.round($args[0])&gt;&gt;
	
	/*Prevents healing above max health*/
	&lt;&lt;if _healing &gt; $e.maxhea - $e.hea&gt;&gt;
		&lt;&lt;set _healing = $e.maxhea - $e.hea&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Displays battle text*/
	&lt;&lt;if _healing &gt; 0&gt;&gt;
		&lt;&lt;print &quot;&lt;li&gt;//Enemy health +_healing//&lt;/li&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Changes enemy health*/
	&lt;&lt;set $e.hea += _healing&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;eDamage&quot;&gt;&gt;
	&lt;&lt;set _damage = Math.round($args[0])&gt;&gt;
	
	/*Prevents damage from being negative*/
	&lt;&lt;if _damage &lt; 0&gt;&gt;&lt;&lt;set _damage = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*Displays battle text*/
	&lt;&lt;if _damage == 0&gt;&gt;
		&lt;&lt;print &quot;&lt;li&gt;//No damage?//&lt;/li&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;print &quot;&lt;li&gt;//Enemy health -_damage//&lt;/li&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Changes enemy health*/
	&lt;&lt;set $e.hea -= _damage&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;eBuff&quot;&gt;&gt;
&lt;&lt;set _type = $args[0]&gt;&gt;
&lt;&lt;set _amount = 1&gt;&gt;
&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _amount = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;switch _type&gt;&gt;
	&lt;&lt;case &quot;stun&quot;&gt;&gt;
	//&lt;li&gt;(Enemy stunned)&lt;/li&gt;//
	&lt;&lt;set $e.stun += _amount&gt;&gt;
	
	&lt;&lt;case &quot;slow&quot;&gt;&gt;
	//&lt;li&gt;(Enemy slowed)&lt;/li&gt;//
	&lt;&lt;set $e.slow += _amount + 1&gt;&gt;
	
	&lt;&lt;case &quot;burn&quot;&gt;&gt;
	//&lt;li&gt;(Enemy Burnt)&lt;/li&gt;//
	/* FIXES AND EDITS - Modify burn to not overwrite existing burn variables if the new ones are worse */
    &lt;&lt;if Math.round($dmg * setup.tuning(&quot;burnProcDamageModifier&quot;)) &gt; $e.burn&gt;&gt;
    	&lt;&lt;set $e.burn = Math.round($dmg * setup.tuning(&quot;burnProcDamageModifier&quot;))&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;&lt;if _amount &gt; $e.burnTime&gt;&gt;
		&lt;&lt;set $e.burnTime = _amount&gt;&gt;
    &lt;&lt;/if&gt;&gt;
	&lt;&lt;if $e.soak &gt; 0&gt;&gt;
		Which has unfortunately stopped them from being soaked. 
		&lt;&lt;set $e.soak = 0&gt;&gt;
		/*&lt;&lt;run $e.damageWeakness.pluck(&quot;lightning&quot;)&gt;&gt;*/ /* FIXES AND EDITS - Fix soak weakness */
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;case &quot;soak&quot;&gt;&gt;
	//&lt;li&gt;(Enemy soaked)&lt;/li&gt;//
	&lt;&lt;set $e.soak += _amount + 1&gt;&gt;
	/*&lt;&lt;run $e.damageWeakness.push(&quot;lightning&quot;)&gt;&gt;*/ /* FIXES AND EDITS - Fix soak weakness */
	&lt;&lt;if $e.burn &gt; 0&gt;&gt;
		Which has unfortunately stopped them from burning. 
		&lt;&lt;set $e.burn = 0&gt;&gt;
		&lt;&lt;set $e.burnTime = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/switch&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;enemyAction&quot;&gt;&gt;
	&lt;&lt;set $aiAction = $args[0]&gt;&gt;
	&lt;&lt;if $aiAction == &quot;attack&quot; and $e.stun &gt; 0&gt;&gt;
		&lt;&lt;set $e.stun--&gt;&gt;
		&lt;li&gt;&lt;i&gt;Stunned&lt;/i&gt;&lt;br&gt;
		Your enemy is too stunned to attack! &lt;/li&gt;
		&lt;&lt;if $e.stun &lt;= 0&gt;&gt;
		&lt;i&gt;Your opponent seems to be shaking off the effects of the stun though.&lt;/i&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;include $e.ai&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;doEdmg&quot;&gt;&gt;
	/*Selects the enemy&#39;s highest attack stat*/
	&lt;&lt;set _attackStat = $e.str&gt;&gt;
	&lt;&lt;if $e.agi &gt; _attackStat&gt;&gt;&lt;&lt;set _attackStat = $e.agi&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $e.int &gt; _attackStat&gt;&gt;&lt;&lt;set _attackStat = $e.int&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $e.attackStat != null&gt;&gt;
		&lt;&lt;switch $e.attackStat&gt;&gt;
		&lt;&lt;case &quot;str&quot;&gt;&gt;&lt;&lt;set _attackStat = $e.str&gt;&gt;
		&lt;&lt;case &quot;agi&quot;&gt;&gt;&lt;&lt;set _attackStat = $e.agi&gt;&gt;
		&lt;&lt;case &quot;int&quot;&gt;&gt;&lt;&lt;set _attackStat = $e.int&gt;&gt;
		&lt;&lt;default&gt;&gt;&#39;&#39;Error in enemy attack stat&#39;&#39; 
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Randomizes incoming damage*/
	&lt;&lt;set $edmg = random(_attackStat * 0.75, _attackStat)&gt;&gt;
	
	/*Reduces damage based on armor*/
	&lt;&lt;set $edmg -= $arm.defense + $tdef&gt;&gt;
	
	/*Prevents dealing negative damage*/
	&lt;&lt;if $edmg &lt; 0&gt;&gt;&lt;&lt;set $edmg = 0&gt;&gt;&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;doEspellDmg&quot;&gt;&gt;

&lt;&lt;set _spellCast = $args[0]&gt;&gt;

&lt;&lt;set $edmg = setup.xdy(_spellCast.damage, _spellCast.range) + ($e.int * 0.4)&gt;&gt;

&lt;&lt;set $edmg = Math.round($edmg)&gt;&gt;

&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;enemyCast&quot;&gt;&gt;
&lt;&lt;set _spell = $args[0]&gt;&gt;

/*casts spell based on type*/
&lt;&lt;switch _spell.type&gt;&gt;

&lt;&lt;case &quot;heal&quot;&gt;&gt;
	&lt;&lt;doEspellDmg _spell&gt;&gt;
	&lt;&lt;eHealth $edmg&gt;&gt;
	
&lt;&lt;/switch&gt;&gt;

&lt;&lt;set $e.mana -= _spell.cost&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====</tw-passagedata><tw-passagedata pid="588" name="inventory widgets" tags="nobr widget" position="2075,575" size="200,100">/*===Adds the input item to your inventory===*/
&lt;&lt;widget &quot;getItem&quot;&gt;&gt;
	&lt;&lt;set _itemGot = clone($args[0])&gt;&gt;
	
	/* FIXES AND EDITS - Allow getItem to give multiple items */
	&lt;&lt;set _multiplier = 1&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _multiplier = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _itemGot.stack == null or _itemGot.stack &lt; 1&gt;&gt;
		&lt;&lt;set _itemGot.stack = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _itemGot.charges != null&gt;&gt;
		&lt;&lt;set _itemGot.stack = _itemGot.charges&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _itemGot.stack *= _multiplier&gt;&gt;
	
	&lt;&lt;if _multiplier == 1&gt;&gt;
		&lt;li&gt;You got &#39;&#39;_itemGot.article _itemGot.name&#39;&#39;! &lt;/li&gt;
	&lt;&lt;else&gt;&gt;
		&lt;li&gt;You got &#39;&#39;_itemGot.article _itemGot.name&#39;&#39; (x_multiplier)! &lt;/li&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if setup.hasItem(_itemGot) &gt;= 0&gt;&gt;
	&lt;&lt;set $inventory[setup.hasItem(_itemGot)].stack += _itemGot.stack&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;run $inventory.push(_itemGot)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*Alphabetizes the inventory somehow?*/
	&lt;&lt;run $inventory.sort((a, b) =&gt; (a.name &gt; b.name) ? 1 : -1)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

/*===Removes items from inventory===*/
&lt;&lt;widget &quot;removeItem&quot;&gt;&gt;
	&lt;&lt;set _item = null&gt;&gt;
	&lt;&lt;if setup.hasItem($args[0]) &gt;= -1&gt;&gt;
		&lt;&lt;set _item = $inventory[setup.hasItem($args[0])]&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;set _number = 1&gt;&gt;
	&lt;&lt;if $args.length &gt; 1&gt;&gt;&lt;&lt;set _number = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _item == null&gt;&gt;
		/*Do nothing*/
	&lt;&lt;elseif _number == &quot;all&quot;&gt;&gt;
		&lt;&lt;run $inventory.deleteAt(setup.hasItem($args[0]))&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _item.stack -= _number&gt;&gt;
		&lt;&lt;if _item.stack &lt;= 0&gt;&gt;
			&lt;&lt;run $inventory.deleteAt(setup.hasItem($args[0]))&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;describeItem&quot;&gt;&gt;
&lt;&lt;set _item = $args[0]&gt;&gt;

&lt;u&gt;
&lt;&lt;if _item.icon != null&gt;&gt;&lt;&lt;icon _item.icon&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;icon &quot;inventory&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
_item.Name
&lt;/u&gt;
&lt;br&gt;_item.description

/* FIXES AND EDITS - Fix: Make costs account for charges */
/* (It would be confusing to the player to see the charge-altered value when inspecting an item, but the gold cost of an item is only ever seen in the shop purchasing menu, which side-steps this issue) */
&lt;&lt;set _itemBaseValue = _item.value&gt;&gt;
&lt;&lt;set _itemCharge = 1&gt;&gt;
&lt;&lt;if _item.charges&gt;&gt;
	&lt;&lt;set _itemCharge = _item.charges&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _itemValue = Math.round(_itemBaseValue * _itemCharge)&gt;&gt;

&lt;br&gt;_itemValue gold, _item.type

&lt;&lt;if _item.damage &gt; 0&gt;&gt;
	&lt;&lt;set _damage = _item.damage+&quot;d&quot;+_item.range&gt;&gt;
	&lt;&lt;set _scaling = (_item.scaling*100)+&quot;% &quot;+_item.stat&gt;&gt;
	&lt;br&gt;Deals _damage +_scaling _item.damageType damage. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _item.defense &gt; 0&gt;&gt;
	&lt;br&gt;Increases defense by _item.defense 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _item.mana &gt; 0&gt;&gt;Mana +_item.mana &lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.int &gt; 0&gt;&gt;Intelligence +_item.int &lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.str &gt; 0&gt;&gt;Strength +_item.str &lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.agi &gt; 0&gt;&gt;Agility +_item.agi &lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.end &gt; 0&gt;&gt;Endurance +_item.end &lt;&lt;/if&gt;&gt;

&lt;&lt;if _item.size &gt; 0&gt;&gt;
	&lt;br&gt;Size _item.size 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _item.heal&gt;0 or _item.mana&gt;0 or _item.stamina&gt;0&gt;&gt;
	&lt;br&gt;Restores: 
	&lt;&lt;if _item.heal &gt; 0&gt;&gt;_item.heal health &lt;&lt;/if&gt;&gt;
	&lt;&lt;if _item.mana &gt; 0&gt;&gt;_item.mana mana &lt;&lt;/if&gt;&gt;
	&lt;&lt;if _item.stamina &gt; 0&gt;&gt;_item.stamina stamina &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt; 

&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;store&quot;&gt;&gt;

&lt;&lt;if $vendor.selling&gt;&gt;
	&lt;&lt;if $vendor.b &gt;= 0&gt;&gt;
		&lt;&lt;set _tempItem = $inventory[$vendor.b]&gt;&gt;

		&lt;hr&gt;
		&lt;u&gt;
		&lt;&lt;if _tempItem.icon != null&gt;&gt;&lt;&lt;icon _tempItem.icon&gt;&gt;
		&lt;&lt;else&gt;&gt;&lt;&lt;icon &quot;inventory&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		_tempItem.Name
		&lt;/u&gt;	
		
		&lt;br&gt;_tempItem.description

		/* FIXES AND EDITS - Add buy/sell volume options */
		&lt;&lt;set $vendor.amount = 1&gt;&gt;
		&lt;br&gt;&lt;&lt;link &quot;Sell&quot; $vendorLocation&gt;&gt;
			&lt;&lt;set $vendor.a = $vendor.b&gt;&gt;
			&lt;&lt;set $vendor.b = -2&gt;&gt;
		&lt;&lt;/link&gt;&gt; x &lt;&lt;numberbox &quot;$vendor.amount&quot; 1&gt;&gt;

	/*Buys the item*/
	&lt;&lt;elseif $vendor.b == -2&gt;&gt;
		&lt;hr&gt;
		$vendorThanks
		
		/* FIXES AND EDITS - Add buy/sell volume options */

		&lt;&lt;set _amountSold = $vendor.amount&gt;&gt;
		
		/* cap actual amount to number player actually has */
		&lt;&lt;if $inventory[$vendor.a].stack &lt; _amountSold&gt;&gt;
			&lt;&lt;set _amountSold = $inventory[$vendor.a].stack&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* Ensure isn&#39;t  zero/negative */
		&lt;&lt;if _amountSold &lt; 1&gt;&gt;
			&lt;&lt;set _amountSold = 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _cost = Math.round($inventory[$vendor.a].value * _amountSold * 0.5)&gt;&gt;
		&lt;&lt;doGld _cost&gt;&gt;
		&lt;&lt;removeItem $inventory[$vendor.a] _amountSold&gt;&gt;

	&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
/*Purchase confirmation*/
	&lt;&lt;if $vendor.b &gt;= 0&gt;&gt;
		&lt;&lt;set _tempItem = $vendorInventory[$vendor.b]&gt;&gt;

		&lt;hr&gt;
		&lt;&lt;describeItem _tempItem&gt;&gt;
		
		/* FIXES AND EDITS - Add buy/sell volume options */
		&lt;&lt;set $vendor.amount = 1&gt;&gt;
		&lt;br&gt;&lt;&lt;link &quot;Buy&quot; $vendorLocation&gt;&gt;
			&lt;&lt;set $vendor.a = $vendor.b&gt;&gt;
			&lt;&lt;set $vendor.b = -2&gt;&gt;
		&lt;&lt;/link&gt;&gt; x &lt;&lt;numberbox &quot;$vendor.amount&quot; 1&gt;&gt;

	/*Buys the item*/
	&lt;&lt;elseif $vendor.b == -2&gt;&gt;
		&lt;hr&gt;
		$vendorThanks
		/* FIXES AND EDITS - Fix: Make costs account for charges + Add buy/sell volume options*/
		&lt;&lt;set _itemBaseValue = $vendorInventory[$vendor.a].value&gt;&gt;
		&lt;&lt;set _itemCharge = 1&gt;&gt;
		&lt;&lt;if $vendorInventory[$vendor.a].charges&gt;&gt;
			&lt;&lt;set _itemCharge = $vendorInventory[$vendor.a].charges&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set _itemValue = Math.round(_itemBaseValue * _itemCharge)&gt;&gt;
		
		&lt;&lt;set _amountBought = $vendor.amount&gt;&gt;
		
		/* Ensure isn&#39;t  zero/negative */
		&lt;&lt;if _amountBought &lt; 1&gt;&gt;
			&lt;&lt;set _amountBought = 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		/* cap to amount player can afford */
		&lt;&lt;if $gld &lt; _amountBought * _itemValue&gt;&gt;
			&lt;&lt;set _amountBought = Math.floor($gld / _itemValue)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _cost = _itemValue * _amountBought * -1&gt;&gt;
		&lt;&lt;doGld _cost&gt;&gt;
		&lt;&lt;getItem $vendorInventory[$vendor.a] _amountBought&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

/*Lists buying options*/
&lt;hr&gt;

/*Sell items to vendor*/
&lt;&lt;if $vendor.selling&gt;&gt;
	&lt;&lt;for _i = 0; _i &lt; $inventory.length; _i++&gt;&gt;
		&lt;&lt;capture _i&gt;&gt;
			&lt;&lt;if $inventory[_i].icon != null&gt;&gt;&lt;&lt;icon $inventory[_i].icon&gt;&gt;
			&lt;&lt;else&gt;&gt;&lt;&lt;icon &quot;inventory&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;set _description = 
			$inventory[_i].Name+
			&quot;...&quot;&gt;&gt;
			
			&lt;&lt;if $inventory[_i].value != null&gt;&gt;
				&lt;&lt;set _description += Math.round($inventory[_i].value * 0.5)+&quot; gold&quot;&gt;&gt;
				&lt;&lt;link  _description $vendorLocation&gt;&gt;
					&lt;&lt;set $vendor.b = _i&gt;&gt;
				&lt;&lt;/link&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;set _description += &quot;unsellable&quot;&gt;&gt;
				_description
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;/capture&gt;&gt;
		&lt;br&gt;
	&lt;&lt;/for&gt;&gt;
	&lt;&lt;icon &quot;store&quot;&gt;&gt;
	&lt;&lt;link  &quot;Buy items&quot; $vendorLocation&gt;&gt;
		&lt;&lt;set $vendor.selling = false&gt;&gt;
		&lt;&lt;set $vendor.b = -1&gt;&gt;
		&lt;&lt;set $vendor.a = -1&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;br&gt;
			
/*Buy items from vendor*/
&lt;&lt;else&gt;&gt;
	&lt;&lt;for _i = 0; _i &lt; $vendorInventory.length; _i++&gt;&gt;
		/* FIXES AND EDITS - Fix: Make costs account for charges */
		&lt;&lt;set _itemBaseValue = $vendorInventory[_i].value&gt;&gt;
		&lt;&lt;set _itemCharge = 1&gt;&gt;
		&lt;&lt;if $vendorInventory[_i].charges&gt;&gt;
			&lt;&lt;set _itemCharge = $vendorInventory[_i].charges&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _itemValue = Math.round(_itemBaseValue * _itemCharge)&gt;&gt;
		
		&lt;&lt;capture _i, _itemValue&gt;&gt;
			&lt;&lt;set _description = 
			$vendorInventory[_i].Name+
			&quot;...&quot;+_itemValue+&quot; gold&quot;&gt;&gt;
			
			&lt;&lt;if $vendorInventory[_i].icon != null&gt;&gt;
				&lt;&lt;icon $vendorInventory[_i].icon&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;icon &quot;inventory&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;if $gld &lt; _itemValue&gt;&gt;
				_description ~~(Not enough gold)~~
			&lt;&lt;else&gt;&gt;		
				&lt;&lt;link  _description $vendorLocation&gt;&gt;
					&lt;&lt;set $vendor.b = _i&gt;&gt;
				&lt;&lt;/link&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;/capture&gt;&gt;
		&lt;br&gt;
	&lt;&lt;/for&gt;&gt;
	&lt;&lt;icon &quot;store&quot;&gt;&gt;
	&lt;&lt;link  &quot;Sell items&quot; $vendorLocation&gt;&gt;
		&lt;&lt;set $vendor.selling = true&gt;&gt;
		&lt;&lt;set $vendor.b = -1&gt;&gt;
		&lt;&lt;set $vendor.a = -1&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;br&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;vendor&quot;&gt;&gt;

&lt;&lt;set $vendor.b = -1&gt;&gt;
&lt;&lt;set $vendor.a = -1&gt;&gt;
&lt;&lt;set $vendor.selling = false&gt;&gt;

&lt;&lt;switch $args[0]&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Earl&quot;&gt;&gt;
&lt;&lt;set $vendorInventory = [$milkJug, $oats, $breadLoaf, $hamHock, $bigSteak, $beefStew, $chili, $jambalaya]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank ya&#39; kindly!\&quot; &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Trade with Earl&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;donkey smith special&quot;&gt;&gt;
&lt;&lt;set $vendorInventory = [$greatSword, $glaive, $giantAxe, $lightLance, $chainmailArmor, $splintArmor, $platemailArmor, $enchantedFighterArmor, $enchantedKnightArmor, $enchantedWarmageArmor]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you.\&quot; &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Trade with the Smith&quot;&gt;&gt;


&lt;&lt;case &quot;donkey smith normal&quot;&gt;&gt;
&lt;&lt;set $vendorInventory = [$greatSword, $glaive, $giantAxe, $lightLance, $chainmailArmor, $splintArmor, $platemailArmor]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you.\&quot; &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Trade with the Smith&quot;&gt;&gt;


/*===============================================*/
&lt;&lt;case &quot;beach raccoon&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$riceBowl, $tempuraShrimp, $calamari, $sushiRoll]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;With a blur of expert speed, you watch as the raccoon lovingly turns your order into a reality, before folding it up in a big green leaf. \&quot;There, guaranteed as fresh as the moment you bought it\&quot; &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Buy from beach vendor&quot;&gt;&gt;


/*===============================================*/
&lt;&lt;case &quot;ocean raccoon&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$riceBowl, $tempuraShrimp, $calamari, $sushiRoll]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;With a blur of expert speed, you watch as the raccoon lovingly turns your order into a reality, before folding it up in a big green leaf. \&quot;There, guaranteed as fresh as the moment you bought it\&quot; &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Buy from ocean vendor&quot;&gt;&gt;


/*===============================================*/
&lt;&lt;case &quot;lizard wizard&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$ampleApple, $outrageousOrange, $plentifulPeach, $ridiculousRaspberry, $bloatedBlueberry, $sizableStrawberry, $profusePumpkin, $whoppingWatermelon, $giganticGrape]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Pleasure doing business!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Trade with the Lizard Wizard&quot;&gt;&gt;


/*===============================================*/
&lt;&lt;case &quot;milk stand&quot;&gt;&gt;
&lt;&lt;set _cheapMilkBottle = clone($milkBottle)&gt;&gt;
&lt;&lt;set _cheapMilkBottle.value = 1&gt;&gt;
&lt;&lt;set _cheapMilkJug = clone($milkJug)&gt;&gt;
&lt;&lt;set _cheapMilkJug.value = 1&gt;&gt;
&lt;&lt;set $vendorInventory = [_cheapMilkBottle, _cheapMilkJug]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot; he reaches behind the bar and sets the milk down as you hand him the gold. &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Milk Stand&quot;&gt;&gt;


/*===============================================*/
&lt;&lt;case &quot;Island smithee&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$rapier, $spear, $trident, $warhammer, $lightLance, $splintArmor, $segmentataArmor]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Island smithee store&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Island smithee special&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$rapier, $spear, $trident, $warhammer, $lightLance, $splintArmor, $segmentataArmor, $huntersGarb, $brutesHarness, $ironfistPebbles, $beastclawBracers]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Island smithee store&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;west town&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$bookOfCrystals, $rapier, $spear, $trident, $warhammer, $blueSwimTrunks, $redSwimShirt, $bagOfCandy, $tropicalShirt, $boxOfDonuts]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;West town vendor&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;apothecary&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$lightningWand, $fireWand, $iceWand, $sManaPotion, $mManaPotion, $antidotePotion, $mageApprenticeRobe, $wizardsRobes, $battlemagesGarb]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Pleasure doing business!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Apothecary vendor&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Altertarium&quot;&gt;&gt;

&lt;&lt;set $vendorDescription = &quot;You walk into the alerterrarium. &quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$boostStrength]&gt;&gt;
/* ICY SPELLS */
&lt;&lt;if $options.icyspells_enabled&gt;&gt;
	&lt;&lt;run $vendorInventory.push(...[&quot;icyspells_lesserWard&quot;, &quot;icyspells_ward&quot;,&quot;icyspells_levitate&quot;,&quot;icyspells_enlarge&quot;])&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Learn spells from Altertarium&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Destructatorium&quot;&gt;&gt;

&lt;&lt;set $vendorDescription = &quot;\&quot;You walk into the destructatorium. \&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$fire1, $lightning1, $ice1]&gt;&gt;
/* ICY SPELLS */
&lt;&lt;if $options.icyspells_enabled&gt;&gt;
	&lt;&lt;run $vendorInventory.push(...[&quot;icyspells_ignite&quot;, &quot;icyspells_heatwave&quot;])&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you...\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Learn spells from Destructatorium&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Restoratorium&quot;&gt;&gt;

&lt;&lt;set $vendorDescription = &quot;You walk into the restoratorium. &quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$heal1, $heal2, $antidote1]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you.\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Learn spells from Restoratorium&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Smarty&quot;&gt;&gt;

&lt;&lt;set $vendorDescription = &quot;\&quot;Want to learn some spells, do you? I&#39;ll give you fair warning, these aren&#39;t exactly easy to handle.\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$lightning2, $lightning3, $fire2, $fire3, $ice3, $ice5]&gt;&gt;
/* ICY SPELLS */
&lt;&lt;if $options.icyspells_enabled&gt;&gt;
	&lt;&lt;run $vendorInventory.push(...[&quot;icyspells_explode&quot;])&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Well done!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Learn spells from Smarty&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;Island shaman&quot;&gt;&gt;

&lt;&lt;set $vendorDescription = &quot;\&quot;Ours is the magic of the earth, water, sky and life. If you seek to become harmonious with the world, I may yet have spells to teach you.\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$boostDefense, $boostDodge, $boostAgility, $earth1, $earth3, $regenerate2, $water1, $water3, $lightning1, $lightning3]&gt;&gt;

/* ICY SPELLS */
&lt;&lt;if $options.icyspells_enabled&gt;&gt;
	&lt;&lt;run $vendorInventory.push(...[&quot;icyspells_meditate&quot;, &quot;icyspells_grease&quot;,  &quot;icyspells_ignite&quot;,&quot;icyspells_heatwave&quot;])&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Well done!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;Learn spells from shaman&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;grocery store&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$apple, $grapes, $oats, $cheeseburger, $sausage, $meatballSub, $cake, $waterFlask, $waterJug, $orange, $friedChicken, $cheese, $wine]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;grocery store vendor&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;armory vendor&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$leatherArmor, $chainmailArmor, $splintArmor, $platemailArmor, $shortSword, $dagger, $axe, $lightClub]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;armorer vendor&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;clothing vendor&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$buttonDownShirt, $tunic, $bellyShirt, $tuxedoJacket, $tuxedoPants, $blueJeans, $skirt, $overalls, $dressSkirt, $trousers, $vest, $dressGown]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;clothing vendor&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;general store&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$sHealthPotion, $mHealthPotion, $lHealthPotion, $sManaPotion]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;\&quot;Thank you!\&quot;&quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;general store&quot;&gt;&gt;

/*===============================================*/
&lt;&lt;case &quot;hospital vendor&quot;&gt;&gt;

&lt;&lt;set $vendorInventory = [$sHealthPotion, $mHealthPotion, $lHealthPotion, $dietPill]&gt;&gt;

&lt;&lt;set $vendorThanks = &quot;Your coins //clink// into the box. &quot;&gt;&gt;

&lt;&lt;set $vendorLocation = &quot;hospital vendor&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="589" name="npc widgets" tags="nobr widget" position="2075,450" size="200,100">/* FIXES AND EDITS - Change widgets to use the same system that was introduced for fixed NPCs */
&lt;&lt;widget &quot;createNPC&quot;&gt;&gt;
	&lt;&lt;set _species = $args[0]&gt;&gt;
	&lt;&lt;set _gender = $args[1]&gt;&gt;
	&lt;&lt;set _slot = 1&gt;&gt;
	&lt;&lt;if $args[2]&gt;&gt;
		&lt;&lt;set _slot = $args[2]&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;set _npc = setup.createNPC(_species, _gender)&gt;&gt;
	
	/* (For legacy compatibility, even though it means we don&#39;t get to free up the nice $species variable D:&lt;) */
	&lt;&lt;set $species = _npc.speciesObject&gt;&gt;
	&lt;&lt;set $gender = _npc.gender&gt;&gt;
	
	/* Continue to create NPC */
	&lt;&lt;setNPC _npc _slot&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;setNPC&quot;&gt;&gt;
	&lt;&lt;if $args.length == 1&gt;&gt; /* 1 argument means something was trying to use the legacy form of this, that&#39;s literally only used in one place in the base game + has been replaced by fixes and edits, but we&#39;ll still do this anyway */
		&lt;&lt;set _slot = $args[0]&gt;&gt;
		
		&lt;&lt;set _npc = setup.createNPC($species, $gender)&gt;&gt;
		
		&lt;&lt;run setup.setNPCToSlot(_npc, _slot)&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _npc = $args[0]&gt;&gt;
		&lt;&lt;set _slot = $args[1]&gt;&gt;
		
		&lt;&lt;run setup.setNPCToSlot(_npc, _slot)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="590" name="npc widgets old" tags="" position="1975,450" size="100,100">/* Trying to comment this out wasn&#39;t working, so here&#39;s a copy paste of the old (still slightly edited) npc widgets for backup purposes */
&lt;&lt;widget &quot;createNPC&quot;&gt;&gt;

	&lt;&lt;switch $args[0]&gt;&gt;
		&lt;&lt;case &quot;random&quot;&gt;&gt;&lt;&lt;set $species = setup.randomSpecies()&gt;&gt;
		&lt;&lt;case &quot;herbivore&quot;&gt;&gt;&lt;&lt;set $species = setup.randomHerbivore()&gt;&gt;
		&lt;&lt;case &quot;carnivore&quot;&gt;&gt;&lt;&lt;set $species = setup.randomCarnivore()&gt;&gt;
		&lt;&lt;case &quot;dinosaur&quot;&gt;&gt;&lt;&lt;set $species = either($raptor, $pterodactyl, $triceratops, $stegosaurus, $apatosaurus, $tyrannosaurus)&gt;&gt;
		&lt;&lt;default&gt;&gt;&lt;&lt;set $species = $args[0]&gt;&gt;
	&lt;&lt;/switch&gt;&gt;
	
	&lt;&lt;switch $args[1]&gt;&gt;
		&lt;&lt;case &quot;male&quot;&gt;&gt;
			&lt;&lt;set $gender = $male&gt;&gt;
			&lt;&lt;if !$options.males&gt;&gt;&lt;&lt;set $gender = $female&gt;&gt;&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;case &quot;female&quot;&gt;&gt;
			&lt;&lt;set $gender = $female&gt;&gt;
			&lt;&lt;if !$options.females&gt;&gt;&lt;&lt;set $gender = $male&gt;&gt;&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;case &quot;random&quot;&gt;&gt;
		  &lt;&lt;if !$options.males and $options.females&gt;&gt;
			  &lt;&lt;set $gender = $female&gt;&gt;
		  &lt;&lt;elseif !$options.females and $options.males&gt;&gt;
			  &lt;&lt;set $gender = $male&gt;&gt;
		  &lt;&lt;else&gt;&gt;
			  &lt;&lt;set $gender = either($male, $female)&gt;&gt;
		  &lt;&lt;/if&gt;&gt;
		  
		&lt;&lt;default&gt;&gt;
			&lt;&lt;set $gender = $args[1]&gt;&gt;
			
	&lt;&lt;/switch&gt;&gt;
	
	/*Sets gendered species name*/
	&lt;&lt;if $species.mname != undefined and $gender.he == $male.he&gt;&gt;
		&lt;&lt;set $species.species = $species.mname&gt;&gt;
		&lt;&lt;set $species.Species = $species.mname.toUpperFirst()&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $species.fname != undefined and $gender.he == $female.he&gt;&gt;
		&lt;&lt;set $species.species = $species.fname&gt;&gt;
		&lt;&lt;set $species.Species = $species.fname.toUpperFirst()&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	

	&lt;&lt;set _number = 1&gt;&gt;
	&lt;&lt;if $args.length &gt; 2&gt;&gt;&lt;&lt;set _number = $args[2]&gt;&gt;&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;setNPC _number&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====
&lt;&lt;widget &quot;setNPC&quot;&gt;&gt;
	&lt;&lt;set _number = $args[0]&gt;&gt;
	
	&lt;&lt;switch _number&gt;&gt;
	
	&lt;&lt;case 1&gt;&gt;
	
	/*set species descriptors*/
	&lt;&lt;set $npc1.speciesType = $species.id&gt;&gt;
	&lt;&lt;set $npc1.species = $species.species&gt;&gt;
	&lt;&lt;set $npc1.Species = $species.Species&gt;&gt;
	&lt;&lt;set $npc1.FurBack = $species.furBack.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.furBack = $species.furBack&gt;&gt;
	&lt;&lt;set $npc1.FurBelly = $species.furBelly.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.furBelly = $species.furBelly&gt;&gt;
	&lt;&lt;set $npc1.FurHead = $species.furHead.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.furHead = $species.furHead&gt;&gt;
	&lt;&lt;set $npc1.Feet = $species.feet.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.feet = $species.feet&gt;&gt;
	&lt;&lt;set $npc1.Foot = $species.foot.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.foot = $species.foot&gt;&gt;
	&lt;&lt;set $npc1.Hand = $species.hand.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.hand = $species.hand&gt;&gt;
	&lt;&lt;set $npc1.Hands = $species.hands.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.hands = $species.hands&gt;&gt;
	&lt;&lt;set $npc1.Fur = $species.fur.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.fur = $species.fur&gt;&gt;
	&lt;&lt;set $npc1.Furred = $species.furred.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.furred = $species.furred&gt;&gt;
	&lt;&lt;set $npc1.Furry = $species.furry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.furry = $species.furry&gt;&gt;
	&lt;&lt;set $npc1.Hair = $species.hair.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.hair = $species.hair&gt;&gt;
	&lt;&lt;set $npc1.Tail = $species.tail.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.tail = $species.tail&gt;&gt;
	&lt;&lt;set $npc1.Teeth = $species.teeth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.teeth = $species.teeth&gt;&gt;
	&lt;&lt;set $npc1.Mouth = $species.mouth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.mouth = $species.mouth&gt;&gt;
	&lt;&lt;set $npc1.Angry = $species.angry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc1.angry = $species.angry&gt;&gt;
	&lt;&lt;set $npc1.speciesHeight = $species.speciesHeight&gt;&gt;
	&lt;&lt;set $npc1.speciesStats = $species.speciesStats&gt;&gt;
	&lt;&lt;set $npc1.article = $species.article&gt;&gt;
	&lt;&lt;set $npc1.Article = $species.article.toUpperFirst()&gt;&gt;

	
	/*set gender descriptors*/
	&lt;&lt;set $npc1.He = $gender.He&gt;&gt;
	&lt;&lt;set $npc1.he = $gender.he&gt;&gt;
	&lt;&lt;set $npc1.Him = $gender.Him&gt;&gt;
	&lt;&lt;set $npc1.him = $gender.him&gt;&gt;
	&lt;&lt;set $npc1.His = $gender.His&gt;&gt;
	&lt;&lt;set $npc1.his = $gender.his&gt;&gt;
	&lt;&lt;set $npc1.Himself = $gender.Himself&gt;&gt;
	&lt;&lt;set $npc1.himself = $gender.himself&gt;&gt;
	&lt;&lt;set $npc1.Man = $gender.Man&gt;&gt;
	&lt;&lt;set $npc1.man = $gender.man&gt;&gt;
	&lt;&lt;set $npc1.Boy = $gender.Boy&gt;&gt;
	&lt;&lt;set $npc1.boy = $gender.boy&gt;&gt;
	&lt;&lt;set $npc1.Male = $gender.Male&gt;&gt;
	&lt;&lt;set $npc1.male = $gender.male&gt;&gt;
	&lt;&lt;set $npc1.Sir = $gender.Sir&gt;&gt;
	&lt;&lt;set $npc1.sir = $gender.sir&gt;&gt;
	&lt;&lt;set $npc1.Mister = $gender.Mister&gt;&gt;
	&lt;&lt;set $npc1.mister = $gender.mister&gt;&gt;
	&lt;&lt;set $npc1.Brother = $gender.Brother&gt;&gt;
	&lt;&lt;set $npc1.brother = $gender.brother&gt;&gt;
	&lt;&lt;set $npc1.Guy = $gender.Guy&gt;&gt;
	&lt;&lt;set $npc1.guy = $gender.guy&gt;&gt;
	&lt;&lt;set $npc1.Fella = $gender.Fella&gt;&gt;
	&lt;&lt;set $npc1.fella = $gender.fella&gt;&gt;
	&lt;&lt;set $npc1.Buddy = $gender.Buddy&gt;&gt;
	&lt;&lt;set $npc1.buddy = $gender.buddy&gt;&gt;
	&lt;&lt;set $npc1.Gentleman = $gender.Gentleman&gt;&gt;
	&lt;&lt;set $npc1.gentleman = $gender.gentleman&gt;&gt;
	&lt;&lt;set $npc1.Lad = $gender.Lad&gt;&gt;
	&lt;&lt;set $npc1.lad = $gender.lad&gt;&gt;
	&lt;&lt;set $npc1.Laddie = $gender.Laddie&gt;&gt;
	&lt;&lt;set $npc1.laddie = $gender.Laddie&gt;&gt;
	&lt;&lt;set $npc1.Sport = $gender.Sport&gt;&gt;
	&lt;&lt;set $npc1.sport = $gender.sport&gt;&gt;

	&lt;&lt;case 2&gt;&gt;
	
	/*set species descriptors*/
	&lt;&lt;set $npc2.speciesType = $species.id&gt;&gt;
	&lt;&lt;set $npc2.species = $species.species&gt;&gt;
	&lt;&lt;set $npc2.Species = $species.Species&gt;&gt;
	&lt;&lt;set $npc2.FurBack = $species.furBack.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.furBack = $species.furBack&gt;&gt;
	&lt;&lt;set $npc2.FurBelly = $species.furBelly.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.furBelly = $species.furBelly&gt;&gt;
	&lt;&lt;set $npc2.FurHead = $species.furHead.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.furHead = $species.furHead&gt;&gt;
	&lt;&lt;set $npc2.Feet = $species.feet.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.feet = $species.feet&gt;&gt;
	&lt;&lt;set $npc2.Foot = $species.foot.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.foot = $species.foot&gt;&gt;
	&lt;&lt;set $npc2.Hand = $species.hand.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.hand = $species.hand&gt;&gt;
	&lt;&lt;set $npc2.Hands = $species.hands.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.hands = $species.hands&gt;&gt;
	&lt;&lt;set $npc2.Fur = $species.fur.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.fur = $species.fur&gt;&gt;
	&lt;&lt;set $npc2.Furred = $species.furred.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.furred = $species.furred&gt;&gt;
	&lt;&lt;set $npc2.Furry = $species.furry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.furry = $species.furry&gt;&gt;
	&lt;&lt;set $npc2.Hair = $species.hair.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.hair = $species.hair&gt;&gt;
	&lt;&lt;set $npc2.Tail = $species.tail.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.tail = $species.tail&gt;&gt;
	&lt;&lt;set $npc2.Teeth = $species.teeth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.teeth = $species.teeth&gt;&gt;
	&lt;&lt;set $npc2.Mouth = $species.mouth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.mouth = $species.mouth&gt;&gt;
	&lt;&lt;set $npc2.Angry = $species.angry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc2.angry = $species.angry&gt;&gt;
	&lt;&lt;set $npc2.speciesHeight = $species.speciesHeight&gt;&gt;
	&lt;&lt;set $npc2.speciesStats = $species.speciesStats&gt;&gt;
	&lt;&lt;set $npc2.article = $species.article&gt;&gt;
	&lt;&lt;set $npc2.Article = $species.article.toUpperFirst()&gt;&gt;

	/*set gender descriptors*/
	&lt;&lt;set $npc2.He = $gender.He&gt;&gt;
	&lt;&lt;set $npc2.he = $gender.he&gt;&gt;
	&lt;&lt;set $npc2.Him = $gender.Him&gt;&gt;
	&lt;&lt;set $npc2.him = $gender.him&gt;&gt;
	&lt;&lt;set $npc2.His = $gender.His&gt;&gt;
	&lt;&lt;set $npc2.his = $gender.his&gt;&gt;
	&lt;&lt;set $npc2.Himself = $gender.Himself&gt;&gt;
	&lt;&lt;set $npc2.himself = $gender.himself&gt;&gt;
	&lt;&lt;set $npc2.Man = $gender.Man&gt;&gt;
	&lt;&lt;set $npc2.man = $gender.man&gt;&gt;
	&lt;&lt;set $npc2.Boy = $gender.Boy&gt;&gt;
	&lt;&lt;set $npc2.boy = $gender.boy&gt;&gt;
	&lt;&lt;set $npc2.Male = $gender.Male&gt;&gt;
	&lt;&lt;set $npc2.male = $gender.male&gt;&gt;
	&lt;&lt;set $npc2.Sir = $gender.Sir&gt;&gt;
	&lt;&lt;set $npc2.sir = $gender.sir&gt;&gt;
	&lt;&lt;set $npc2.Mister = $gender.Mister&gt;&gt;
	&lt;&lt;set $npc2.mister = $gender.mister&gt;&gt;
	&lt;&lt;set $npc2.Brother = $gender.Brother&gt;&gt;
	&lt;&lt;set $npc2.brother = $gender.brother&gt;&gt;
	&lt;&lt;set $npc2.Guy = $gender.Guy&gt;&gt;
	&lt;&lt;set $npc2.guy = $gender.guy&gt;&gt;
	&lt;&lt;set $npc2.Fella = $gender.Fella&gt;&gt;
	&lt;&lt;set $npc2.fella = $gender.fella&gt;&gt;
	&lt;&lt;set $npc2.Buddy = $gender.Buddy&gt;&gt;
	&lt;&lt;set $npc2.buddy = $gender.buddy&gt;&gt;
	&lt;&lt;set $npc2.Gentleman = $gender.Gentleman&gt;&gt;
	&lt;&lt;set $npc2.gentleman = $gender.gentleman&gt;&gt;
	&lt;&lt;set $npc2.Lad = $gender.Lad&gt;&gt;
	&lt;&lt;set $npc2.lad = $gender.lad&gt;&gt;
	&lt;&lt;set $npc2.Laddie = $gender.Laddie&gt;&gt;
	&lt;&lt;set $npc2.laddie = $gender.Laddie&gt;&gt;
	&lt;&lt;set $npc2.Sport = $gender.Sport&gt;&gt;
	&lt;&lt;set $npc2.sport = $gender.sport&gt;&gt;

	
	&lt;&lt;case 3&gt;&gt;
	
	/*set species descriptors*/
	&lt;&lt;set $npc3.speciesType = $species.id&gt;&gt;
	&lt;&lt;set $npc3.species = $species.species&gt;&gt;
	&lt;&lt;set $npc3.Species = $species.Species&gt;&gt;
	&lt;&lt;set $npc3.FurBack = $species.furBack.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.furBack = $species.furBack&gt;&gt;
	&lt;&lt;set $npc3.FurBelly = $species.furBelly.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.furBelly = $species.furBelly&gt;&gt;
	&lt;&lt;set $npc3.FurHead = $species.furHead.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.furHead = $species.furHead&gt;&gt;
	&lt;&lt;set $npc3.Feet = $species.feet.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.feet = $species.feet&gt;&gt;
	&lt;&lt;set $npc3.Foot = $species.foot.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.foot = $species.foot&gt;&gt;
	&lt;&lt;set $npc3.Hand = $species.hand.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.hand = $species.hand&gt;&gt;
	&lt;&lt;set $npc3.Hands = $species.hands.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.hands = $species.hands&gt;&gt;
	&lt;&lt;set $npc3.Fur = $species.fur.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.fur = $species.fur&gt;&gt;
	&lt;&lt;set $npc3.Furred = $species.furred.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.furred = $species.furred&gt;&gt;
	&lt;&lt;set $npc3.Furry = $species.furry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.furry = $species.furry&gt;&gt;
	&lt;&lt;set $npc3.Hair = $species.hair.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.hair = $species.hair&gt;&gt;
	&lt;&lt;set $npc3.Tail = $species.tail.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.tail = $species.tail&gt;&gt;
	&lt;&lt;set $npc3.Teeth = $species.teeth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.teeth = $species.teeth&gt;&gt;
	&lt;&lt;set $npc3.Mouth = $species.mouth.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.mouth = $species.mouth&gt;&gt;
	&lt;&lt;set $npc3.Angry = $species.angry.toUpperFirst()&gt;&gt;
	&lt;&lt;set $npc3.angry = $species.angry&gt;&gt;
	&lt;&lt;set $npc3.speciesHeight = $species.speciesHeight&gt;&gt;
	&lt;&lt;set $npc3.speciesStats = $species.speciesStats&gt;&gt;
	&lt;&lt;set $npc3.article = $species.article&gt;&gt;
	&lt;&lt;set $npc3.Article = $species.article.toUpperFirst()&gt;&gt;
	
	
	/*set gender descriptors*/
	&lt;&lt;set $npc3.He = $gender.He&gt;&gt;
	&lt;&lt;set $npc3.he = $gender.he&gt;&gt;
	&lt;&lt;set $npc3.Him = $gender.Him&gt;&gt;
	&lt;&lt;set $npc3.him = $gender.him&gt;&gt;
	&lt;&lt;set $npc3.His = $gender.His&gt;&gt;
	&lt;&lt;set $npc3.his = $gender.his&gt;&gt;
	&lt;&lt;set $npc3.Himself = $gender.Himself&gt;&gt;
	&lt;&lt;set $npc3.himself = $gender.himself&gt;&gt;
	&lt;&lt;set $npc3.Man = $gender.Man&gt;&gt;
	&lt;&lt;set $npc3.man = $gender.man&gt;&gt;
	&lt;&lt;set $npc3.Boy = $gender.Boy&gt;&gt;
	&lt;&lt;set $npc3.boy = $gender.boy&gt;&gt;
	&lt;&lt;set $npc3.Male = $gender.Male&gt;&gt;
	&lt;&lt;set $npc3.male = $gender.male&gt;&gt;
	&lt;&lt;set $npc3.Sir = $gender.Sir&gt;&gt;
	&lt;&lt;set $npc3.sir = $gender.sir&gt;&gt;
	&lt;&lt;set $npc3.Mister = $gender.Mister&gt;&gt;
	&lt;&lt;set $npc3.mister = $gender.mister&gt;&gt;
	&lt;&lt;set $npc3.Brother = $gender.Brother&gt;&gt;
	&lt;&lt;set $npc3.brother = $gender.brother&gt;&gt;
	&lt;&lt;set $npc3.Guy = $gender.Guy&gt;&gt;
	&lt;&lt;set $npc3.guy = $gender.guy&gt;&gt;
	&lt;&lt;set $npc3.Fella = $gender.Fella&gt;&gt;
	&lt;&lt;set $npc3.fella = $gender.fella&gt;&gt;
	&lt;&lt;set $npc3.Buddy = $gender.Buddy&gt;&gt;
	&lt;&lt;set $npc3.buddy = $gender.buddy&gt;&gt;
	&lt;&lt;set $npc3.Gentleman = $gender.Gentleman&gt;&gt;
	&lt;&lt;set $npc3.gentleman = $gender.gentleman&gt;&gt;
	&lt;&lt;set $npc3.Lad = $gender.Lad&gt;&gt;
	&lt;&lt;set $npc3.lad = $gender.lad&gt;&gt;
	&lt;&lt;set $npc3.Laddie = $gender.Laddie&gt;&gt;
	&lt;&lt;set $npc3.laddie = $gender.Laddie&gt;&gt;
	&lt;&lt;set $npc3.Sport = $gender.Sport&gt;&gt;
	&lt;&lt;set $npc3.sport = $gender.sport&gt;&gt;

	&lt;&lt;/switch&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="591" name="quest widgets" tags="widget nobr" position="2075,700" size="200,100">&lt;&lt;widget &quot;getQuest&quot;&gt;&gt;
	&lt;&lt;set _questGot = clone($args[0])&gt;&gt;
	&lt;li&gt;You started &#39;&#39;_questGot.name&#39;&#39;! &lt;/li&gt;
	&lt;&lt;run $quests.push(_questGot)&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;removeQuest&quot;&gt;&gt;
	&lt;&lt;set _quest = setup.questIndex($args[0])&gt;&gt;
	
	&lt;&lt;if _quest &gt; -1&gt;&gt;
		&lt;&lt;run $quests.deleteAt(_quest)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;advanceQuest&quot;&gt;&gt;

	&lt;&lt;if setup.questStarted($args[0])&gt;&gt;
	
		&lt;&lt;set _index = setup.questIndex($args[0])&gt;&gt;
				
		&lt;&lt;if !$quests[_index].ready&gt;&gt;
		
			&lt;&lt;set $quests[_index].progress++&gt;&gt;
			
			&lt;&lt;if $quests[_index].progress &gt;= $quests[_index].goal&gt;&gt;
				&lt;&lt;set $quests[_index].ready = true&gt;&gt;
				&lt;li&gt;Fulfilled quest &#39;&#39;$quests[_index].name!&#39;&#39;&lt;/li&gt;
				
			&lt;&lt;elseif $quests[_index].progress &lt; $quests[_index].goal&gt;&gt;
				&lt;li&gt;Advanced quest &#39;&#39;$quests[_index].name!&#39;&#39;&lt;/li&gt;
				
			&lt;&lt;/if&gt;&gt;
			
		&lt;&lt;/if&gt;&gt;	
		
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;questReward&quot;&gt;&gt;

&lt;&lt;set _quest = $quests[setup.questIndex($args[0])]&gt;&gt;

&lt;li&gt;Completed: &#39;&#39;_quest.name!&#39;&#39;&lt;/li&gt;

&lt;&lt;if _quest.gold &gt; 0&gt;&gt;&lt;&lt;doGld _quest.gold&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if _quest.xp &gt; 0&gt;&gt;&lt;&lt;doXP _quest.xp&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if _quest.item != undefined&gt;&gt;&lt;&lt;getItem _quest.item&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if setup.questStarted(_quest)&gt;&gt;
	&lt;&lt;set $quests[setup.questIndex(_quest)].completed = true&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="592" name="spell widgets" tags="nobr widget" position="2300,575" size="200,100">/* FIXES AND EDITS - Hackily edited to work with spell changes */

&lt;&lt;widget &quot;teach&quot;&gt;&gt;

$vendorDescription

/*Purchase confirmation*/
&lt;&lt;if $vendor.b &gt;= 0&gt;&gt;
	&lt;&lt;set _tempItem = setup.getSpell($vendorInventory[$vendor.b])&gt;&gt;

	&lt;hr&gt;
	&lt;u&gt;_tempItem.Name&lt;/u&gt;
	&lt;br&gt;&lt;&lt;=setup.getSpellCosts(_tempItem).join(&quot;, &quot;)&gt;&gt;
	&lt;br&gt;_tempItem.description
	
	&lt;br&gt;&lt;&lt;link &quot;Learn this power?&quot; $vendorLocation&gt;&gt;
		&lt;&lt;set $vendor.a = $vendor.b&gt;&gt;
		&lt;&lt;set $vendor.b = -2&gt;&gt;
	&lt;&lt;/link&gt;&gt;

/*Learns the spell*/
&lt;&lt;elseif $vendor.b == -2&gt;&gt;
	&lt;hr&gt;
	$vendorThanks
	&lt;&lt;set _spend = setup.getSpell($vendorInventory[$vendor.a]).value * -1&gt;&gt;
	&lt;&lt;doGld _spend&gt;&gt;
	&lt;&lt;getSpell setup.getSpell($vendorInventory[$vendor.a])&gt;&gt;
	
&lt;&lt;/if&gt;&gt;

/*Lists buying options*/
&lt;hr&gt;
&lt;&lt;for _i = 0; _i &lt; $vendorInventory.length; _i++&gt;&gt;
	&lt;&lt;set _currentSpell = setup.getSpell($vendorInventory[_i])&gt;&gt;

	&lt;&lt;capture _i, _currentSpell&gt;&gt;
		&lt;&lt;if _currentSpell.icon != null&gt;&gt;
			&lt;&lt;icon _currentSpell.icon&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;set _description = 
		_currentSpell.Name+
		&quot;...&quot;+_currentSpell.value+&quot; gold&quot;&gt;&gt;
		
		/*&lt;&lt;if setup.spellIndex($vendorInventory[_i]) &gt; -1&gt;&gt;*/
		&lt;&lt;if setup.knowsSpell(_currentSpell)&gt;&gt;
			&lt;s&gt;_description&lt;/s&gt; ~~(Already known)~~
		
		&lt;&lt;elseif not setup.canLearnSpell(_currentSpell)&gt;&gt;
			_description ~~(Requires &lt;&lt;=setup.spellLearnFailReasons(_currentSpell).join(&quot;, &quot;)&gt;&gt;)~~
		
		&lt;&lt;elseif $gld &lt; _currentSpell.value&gt;&gt;
			_description ~~(Not enough gold)~~
		
		&lt;&lt;else&gt;&gt;
		  &lt;&lt;link  _description $vendorLocation&gt;&gt;
			  &lt;&lt;set $vendor.b = _i&gt;&gt;
		  &lt;&lt;/link&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
	&lt;br&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;/widget&gt;&gt;

====

&lt;&lt;widget &quot;getSpell&quot;&gt;&gt;
	&lt;&lt;set _spellGot = clone(setup.getSpell($args[0]))&gt;&gt;
	
     &lt;li&gt;You learned &#39;&#39;_spellGot.Name&#39;&#39;! &lt;/li&gt;
     
    &lt;&lt;if _spellGot.unique or $args[1]&gt;&gt; /* The spell should specifically be stored as an object, rather than just an ID. Useful for tracking spell-related variables, though honestly you should probably still use an ID and track variables with globals instead */
    	&lt;&lt;run $spells.push(_spellGot)&gt;&gt;
    &lt;&lt;else&gt;&gt;
    	&lt;&lt;run $spells.push(_spellGot.id)&gt;&gt; /* Only store the ids*/
    &lt;&lt;/if&gt;&gt;

	&lt;&lt;run setup.sortSpellbook()&gt;&gt;
&lt;&lt;/widget&gt;&gt;

====</tw-passagedata><tw-passagedata pid="593" name="time widgets" tags="widget" position="2300,700" size="200,100">&lt;&lt;widget &quot;rest&quot;&gt;&gt;
	&lt;&lt;doTime 60&gt;&gt;
	&lt;&lt;stamina 25&gt;&gt;
	&lt;&lt;health $end&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;sleep&quot;&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
	&lt;&lt;rest&gt;&gt;
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;doTime&quot;&gt;&gt;
	&lt;&lt;set _theTime = Math.round($args[0])&gt;&gt;
	
	&lt;&lt;eventTime _theTime&gt;&gt;
	
	/*===Sets tens time digit===*/
	&lt;&lt;set $onesMinute += _theTime&gt;&gt;
	&lt;&lt;for $onesMinute &gt; 9&gt;&gt;
		&lt;&lt;set $onesMinute -= 10&gt;&gt;
		&lt;&lt;set $tensMinute += 1&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	
	/*===Sets hour===*/
	&lt;&lt;for $tensMinute &gt; 5&gt;&gt;
		&lt;&lt;set $tensMinute -= 6&gt;&gt;
		&lt;&lt;set $hour += 1&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	
	/*===Sets the day===*/
	&lt;&lt;for $hour &gt; 23&gt;&gt;
		&lt;&lt;set $hour -= 24&gt;&gt;
		&lt;&lt;set $day += 1&gt;&gt;
		&lt;&lt;removeQuest $washedDishes&gt;&gt;
		&lt;&lt;removeQuest $cookedFood&gt;&gt;
		&lt;&lt;removeQuest $smithedArmor&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	
	/*===Sets the displayed hour===*/
	&lt;&lt;set $displayHour = $hour&gt;&gt;
	&lt;&lt;for $displayHour &gt; 12&gt;&gt;
		&lt;&lt;set $displayHour -= 12&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	&lt;&lt;if $displayHour == 0&gt;&gt;&lt;&lt;set $displayHour = 12&gt;&gt;&lt;&lt;/if&gt;&gt;
	
	/*===Sets AM PM===*/
	&lt;&lt;if $hour &lt;= 11&gt;&gt;
		&lt;&lt;set $ampm = &quot;AM&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $ampm = &quot;PM&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/*===Sets what time of day it is===*/
	&lt;&lt;if $hour &gt;= 16 and $hour &lt;= 20&gt;&gt;
		&lt;&lt;set $dayTime = &quot;Evening&quot;&gt;&gt;&lt;&lt;set $daytime = &quot;evening&quot;&gt;&gt;
		&lt;&lt;set $Sun = &quot;Sun&quot;&gt;&gt;&lt;&lt;set $sun = &quot;sun&quot;&gt;&gt;
		&lt;&lt;set $Sunlight = &quot;Sunlight&quot;&gt;&gt;&lt;&lt;set $sunlight = &quot;sunlight&quot;&gt;&gt;
	&lt;&lt;elseif $hour &gt;= 10 and $hour &lt;= 15&gt;&gt;
		&lt;&lt;set $dayTime = &quot;Day&quot;&gt;&gt;&lt;&lt;set $daytime = &quot;day&quot;&gt;&gt;
		&lt;&lt;set $Sun = &quot;Sun&quot;&gt;&gt;&lt;&lt;set $sun = &quot;sun&quot;&gt;&gt;
		&lt;&lt;set $Sunlight = &quot;Sunlight&quot;&gt;&gt;&lt;&lt;set $sunlight = &quot;sunlight&quot;&gt;&gt;
	&lt;&lt;elseif $hour &gt;= 6 and $hour &lt;= 9&gt;&gt;
		&lt;&lt;set $dayTime = &quot;Morning&quot;&gt;&gt;&lt;&lt;set $daytime = &quot;morning&quot;&gt;&gt;
		&lt;&lt;set $Sun = &quot;Sun&quot;&gt;&gt;&lt;&lt;set $sun = &quot;sun&quot;&gt;&gt;
		&lt;&lt;set $Sunlight = &quot;Sunlight&quot;&gt;&gt;&lt;&lt;set $sunlight = &quot;sunlight&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $dayTime = &quot;Night&quot;&gt;&gt;&lt;&lt;set $daytime = &quot;night&quot;&gt;&gt;
		&lt;&lt;set $Sun = &quot;Moon&quot;&gt;&gt;&lt;&lt;set $sun = &quot;moon&quot;&gt;&gt;
		&lt;&lt;set $Sunlight = &quot;Moonlight&quot;&gt;&gt;&lt;&lt;set $sunlight = &quot;moonlight&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	

	
	/*===Digests for input amount of time===*/
	&lt;&lt;digest _theTime&gt;&gt;
	
&lt;&lt;/widget&gt;&gt;

=====

&lt;&lt;widget &quot;eventTime&quot;&gt;&gt;
	&lt;&lt;set _eventTime = $args[0]&gt;&gt;
	
	
	
	&lt;&lt;if $ful &gt; 100&gt;&gt;
		&lt;&lt;set $status.stomachStretch += _eventTime&gt;&gt;
		&lt;&lt;if $status.stomachStretch &gt;= 120&gt;&gt;
			&lt;li&gt;//You&#39;ve spent so much time being full that your stomach has stretched out.//&lt;/li&gt;
			 &lt;&lt;changeStats &quot;sto&quot; 1&gt;&gt;
			&lt;&lt;set $status.stomachStretch -= 500&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	
	&lt;&lt;if $status.wellFed &gt; 0&gt;&gt;
		&lt;&lt;set $status.wellFedTime -= _eventTime&gt;&gt;
		&lt;&lt;if $status.wellFedTime &lt;= 0&gt;&gt;	
			&lt;li&gt;//You reminisce about your last hot meal. //&lt;/li&gt;
			&lt;&lt;set $status.wellFed = 0&gt;&gt;
			&lt;&lt;set $status.wellFedTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	
	&lt;&lt;if $status.dietPill &gt; 0&gt;&gt;
		&lt;&lt;set $status.dietPillTime -= _eventTime&gt;&gt;
		&lt;&lt;if $status.dietPillTime &lt;= 0&gt;&gt;
			
			&lt;li&gt;//
			Your stomach lets out a very audible &#39;&#39;glorp!&#39;&#39; and you&#39;re forced to stop still, puffing out your cheeks from a sudden sense of fullness. With a groan your torso bloats outwards, as if you’ve been walking around all this time with your stomach sucked in.
			/*add clothes popping thing*/
			
			Within moments you’re left as big as you ever were, and no longer walking on air. 
			//&lt;/li&gt;
			&lt;&lt;changeStats &quot;fat&quot; $status.dietPill&gt;&gt;
			&lt;&lt;set $status.dietPill = 0&gt;&gt;
			&lt;&lt;set $status.dietPillTime = 0&gt;&gt;

		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	
	
	&lt;&lt;if $status.stretchFruit &gt; 0&gt;&gt;
		&lt;&lt;set $status.stretchFruitTime -= _eventTime&gt;&gt;
		&lt;&lt;if $status.stretchFruitTime &lt;= 0&gt;&gt;
			&lt;li&gt;//Whatever was making your stomach so stretchy seems to be wearing off. //&lt;/li&gt;
			
			&lt;&lt;set $status.stretchFruit = 0&gt;&gt;
			&lt;&lt;set $status.stretchFruitTime = 0&gt;&gt;
			&lt;&lt;updateStats&gt;&gt;
				
			&lt;&lt;if $ful &gt; $maxFul&gt;&gt;
				&lt;li&gt;//You hear an ominous gurgling sound emanating from your stomach. You look down as you&#39;re struck by the all too familiar sensation of growing fuller and fuller. You quickly realize that the powers affecting your stomach are wearing off in spite of you exceeding your normal limits. Fortunately the shrinking eventually stops before you explode, although you&#39;re stomach is still stretched to its absolute limit. It seems the effects haven&#39;t completely worn off... yet. //&lt;/li&gt;
				&lt;&lt;set _sizeRequired = Math.floor(($ate + $inf + 1) / ($maxFul/100))&gt;&gt;
				&lt;&lt;set _boostRequired = _sizeRequired - $sto + $status.stretchFruit&gt;&gt;

				&lt;&lt;set $status.stretchFruit = _boostRequired&gt;&gt;
				&lt;&lt;set $status.stretchFruitTime = setup.tuning(&quot;stretchFruitRescueInterval&quot;)&gt;&gt; /* default: 40 minutes */
				&lt;&lt;updateStats&gt;&gt;
				
				&lt;&lt;if $hea &lt; 1&gt;&gt;&lt;&lt;set $hea = 1&gt;&gt;&lt;&lt;/if&gt;&gt;
				&lt;&lt;set $alive = true&gt;&gt;
			&lt;&lt;/if&gt;&gt;

			
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	/* ICY SPELLS - Add levitation - START */
	&lt;&lt;if $status.levitateTime &gt; 0&gt;&gt;
		&lt;&lt;set $status.levitateTime -= _eventTime&gt;&gt;
		&lt;&lt;if $status.levitateTime &lt;= 0&gt;&gt;
			&lt;&lt;set _fatness = $fat + $tfat&gt;&gt;
			
			&lt;&lt;set _weightLine = &quot;your weight&quot;&gt;&gt;
			&lt;&lt;if _fatness &lt;= 150&gt;&gt;
				&lt;&lt;set _weightLine = &quot;your weight&quot;&gt;&gt;
			&lt;&lt;elseif _fatness &lt;= 400&gt;&gt;
				&lt;&lt;set _weightLine = &quot;your generous weight&quot;&gt;&gt;
			&lt;&lt;elseif _fatness &lt;= 900&gt;&gt;
				&lt;&lt;set _weightLine = &quot;your not inconsiderable weight&quot;&gt;&gt;
			&lt;&lt;elseif _fatness &lt;= 1800&gt;&gt;
				&lt;&lt;set _weightLine = &quot;your hefty weight&quot;&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;set _weightLine = &quot;your crushing weight&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;li&gt;//You feel the sensation of weightlessness holding you aloft beginning to slowly ebb away. Soon, you&#39;re left to bear _weightLine with your own two $p.feet as gravity gently takes hold of you once more.//&lt;/li&gt;
			
			&lt;&lt;set $status.levitate = 0&gt;&gt;
			&lt;&lt;set $status.levitateTime = 0&gt;&gt;
			&lt;&lt;updateDescriptions&gt;&gt; /* levitating modifies walk description */
		&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;/if&gt;&gt;
	/* ICY SPELLS - Add levitation - END */
	
	/* FIXES AND EDITS - Height manipulation */
	&lt;&lt;if $status.heightTime &gt; 0&gt;&gt;
		&lt;&lt;set $status.heightTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.heightTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.height &gt; 0&gt;&gt; /* Grown */
				&lt;li&gt;//Your perspective of the world around you begins to sink as you shrink back to your normal size.//&lt;/li&gt;
			&lt;&lt;else&gt;&gt; /* Shrank */
				&lt;li&gt;//Your perspective of the world around you begins to rise as you grow back to your normal size.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;set $status.height = 0&gt;&gt;
			&lt;&lt;set $status.heightTime = 0&gt;&gt;
			&lt;&lt;updateStats&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
	&lt;&lt;/if&gt;&gt;
    
    /* ICY SPELLS - Enlarge */
    /* basically just a copypasta of height one :p */
    &lt;&lt;if $status.enlargeTime &gt; 0&gt;&gt;
		&lt;&lt;set $status.enlargeTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.enlargeTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.enlarge &gt; 1&gt;&gt; /* Grown */
				&lt;li&gt;//Your perspective of the world around you begins to sink as you shrink back to your normal size.//&lt;/li&gt;
			&lt;&lt;else&gt;&gt; /* Shrank */
				&lt;li&gt;//Your perspective of the world around you begins to rise as you grow back to your normal size.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			
            &lt;&lt;set _wasAlive = $alive&gt;&gt;
            
			&lt;&lt;set $status.enlarge = 1&gt;&gt;
			&lt;&lt;set $status.enlargeTime = 0&gt;&gt;
			&lt;&lt;updateStats&gt;&gt;
            
            &lt;&lt;if _wasAlive and not $alive&gt;&gt; /* Player was KO&#39;d by fullness... honestly could do a better check for this, but whatever xP */
              &lt;&lt;set _failPassage = &quot;As your body shrinks, you feel a growing fullness in your stomach. It seems that while your stomach is shrinking alongside your body, the contents of it aren&#39;t. The sensation in your gut grows concerningly tighter and tighter, the $p.fur on your belly creaking as it reaches an eye-watering strain. Just as you reach the point of exploding, the shrinking around your belly halts. While you watch the rest of your body continue growing smaller, your belly maintains its size, becoming more proportionally mismatched as the remaining seconds of shifting pass. It seems like the effect will hold off on shrinking your stomach any further, for now... &quot;&gt;&gt;
              &lt;&lt;stomachResizeRescue _failPassage&gt;&gt;
          &lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;


	/*Add event for stomach buffs ending?*/
	
	&lt;&lt;if $status.bloatVenom &gt; 0&gt;&gt;
		&lt;&lt;set $status.bloatVenomTime += _eventTime&gt;&gt;
		
		&lt;&lt;if $status.bloatVenomTime &gt;= 30&gt;&gt;
			&lt;&lt;findBursting -1&gt;&gt;
			
			&lt;&lt;if $toBurst &gt; $status.bloatVenom&gt;&gt;
				&lt;&lt;set _randomMessage to random(1, 5)&gt;&gt;
				&lt;&lt;switch _randomMessage&gt;&gt;
					&lt;&lt;case 1&gt;&gt;
						&lt;li&gt;//You suddenly feel slightly more full due to the bloat venom. The sensation is strange, but not entirely unpleasant. It&#39;s as if your stomach is slowly inflating like a balloon. //&lt;/li&gt;
					&lt;&lt;case 2&gt;&gt;
						&lt;li&gt;//A sudden wave of fullness hits you, the bloat venom is taking effect. It&#39;s a bit disconcerting, feeling your stomach expand so rapidly. You take a deep breath, trying to adjust to the sensation. //&lt;/li&gt;
					&lt;&lt;case 3&gt;&gt;
						&lt;li&gt;//The bloat venom causes your stomach to expand slightly. It&#39;s a slow, gradual feeling, like your stomach is being gently filled. You can&#39;t help but place a hand on your belly, feeling it slowly grow beneath your touch. //&lt;/li&gt;
					&lt;&lt;case 4&gt;&gt;
						&lt;li&gt;//A strange sensation fills your stomach as the bloat venom takes effect. It&#39;s as if your stomach is being filled with a warm, gentle pressure. //&lt;/li&gt;
					&lt;&lt;case 5&gt;&gt;
						&lt;li&gt;//The bloat venom causes a sudden increase in your fullness. It&#39;s a startling sensation, but not entirely unpleasant. You can feel your stomach stretching to accommodate the extra volume. //&lt;/li&gt;
				&lt;&lt;/switch&gt;&gt;
				&lt;&lt;inflate $status.bloatVenom&gt;&gt;
				&lt;&lt;set $status.bloatVenom -= 0.5&gt;&gt;
				&lt;&lt;set $status.bloatVenomTime %= 30&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;li&gt;//Your stomach creaks ominously as it grows ever more distended from the venom coursing through your veins. The pressure is intense, like a balloon being filled far beyond its capacity. Your skin feels tight, stretched to its limit as your stomach continues to expand. It&#39;s a miracle it hasn&#39;t exploded already. Each breath you take is shallow and labored, the expanding girth leaving little room for your lungs to expand. You can feel every heartbeat, each pulse sending a wave of discomfort through your bloated form. The sensation is overwhelming, leaving you in a state of discomfort and apprehension. //&lt;/li&gt;
				&lt;&lt;inflate $toBurst&gt;&gt;
				&lt;&lt;set $status.bloatVenom -= 0.5&gt;&gt;
				&lt;&lt;set $status.bloatVenomTime %= 30&gt;&gt;
			&lt;&lt;/if&gt;&gt;		
		&lt;&lt;/if&gt;&gt;
		
		&lt;&lt;if $status.bloatVenom &lt;= 0&gt;&gt;
			&lt;li&gt;//Fortunately, your head no longer feels fuzzy and it seems you&#39;re finally over the effect&#39;s of the bloat venom//&lt;/li&gt;
			&lt;&lt;set $status.bloatVenom = 0&gt;&gt;
			&lt;&lt;set $status.bloatVenomTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		
		
	&lt;&lt;/if&gt;&gt;
	
	
	
	&lt;&lt;if $status.poison &gt; 0&gt;&gt;
		&lt;&lt;set $status.poisonTime += _eventTime&gt;&gt;
		&lt;&lt;if $status.poisonTime &gt;= 15&gt;&gt;
			&lt;&lt;set _damage = $status.poison * -1&gt;&gt;
			&lt;li&gt;//You feel ill as poison courses through you. //&lt;/li&gt;
			&lt;&lt;health _damage&gt;&gt;
			&lt;&lt;set $status.poisonTime %= 15&gt;&gt;
			&lt;&lt;set $status.poison -= 3&gt;&gt;
			&lt;&lt;if $status.poison &lt; 0&gt;&gt;
				&lt;&lt;set $status.poison = 0&gt;&gt;
				&lt;&lt;set $status.poisonTime = 0&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		/*Add stuff for dieing to poison. Especially during royal guard wasp fight*/
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $status.stoTime &gt; 0&gt;&gt;
	  &lt;&lt;set $status.stoTime -= _eventTime&gt;&gt;

	  &lt;&lt;if $status.stoTime &lt;= 0&gt;&gt;
		  &lt;&lt;if $status.sto &lt; 0&gt;&gt;
			  &lt;li&gt;//You suddenly feel more hungry.//&lt;/li&gt;
		  &lt;&lt;/if&gt;&gt;
		  &lt;&lt;if $status.sto &gt; 0&gt;&gt;
			  &lt;li&gt;//You suddenly feel less hungry.//&lt;/li&gt;
		  &lt;&lt;/if&gt;&gt;

		  &lt;&lt;set $status.sto = 0&gt;&gt;
		  &lt;&lt;set $status.stoTime = 0&gt;&gt;
		  &lt;&lt;updateStats&gt;&gt;

		  &lt;&lt;if $ful &gt; $maxFul&gt;&gt;
			  &lt;&lt;stomachResizeRescue&gt;&gt;
		  &lt;&lt;/if&gt;&gt;
	  &lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $status.agi != 0&gt;&gt;
		&lt;&lt;set $status.agiTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.agiTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.agi &gt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as fast.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $status.agi &lt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as slow!//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set $status.agi = 0&gt;&gt;
			&lt;&lt;set $status.agiTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $status.str != 0&gt;&gt;
		&lt;&lt;set $status.strTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.strTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.str &gt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as strong.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $status.str &lt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as weak!//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set $status.str = 0&gt;&gt;
			&lt;&lt;set $status.strTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $status.int != 0&gt;&gt;
		&lt;&lt;set $status.intTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.intTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.int &gt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as smart.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $status.int &lt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as stupid!//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set $status.int = 0&gt;&gt;
			&lt;&lt;set $status.intTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $status.end != 0&gt;&gt;
		&lt;&lt;set $status.endTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.endTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.end &gt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as tough.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $status.end &lt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as sickly!//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set $status.end = 0&gt;&gt;
			&lt;&lt;set $status.endTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $status.mana != 0&gt;&gt;
		&lt;&lt;set $status.manaTime -= _eventTime&gt;&gt;
		
		&lt;&lt;if $status.manaTime &lt;= 0&gt;&gt;
			&lt;&lt;if $status.mana &gt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as empowered.//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $status.mana &lt; 0&gt;&gt;
				&lt;li&gt;//You no longer feel as disempowered!//&lt;/li&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set $status.mana = 0&gt;&gt;
			&lt;&lt;set $status.manaTime = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="594" name="Swamp First Time" tags="swamp" position="3675,1775" size="200,200">&lt;&lt;setPassageTitle &quot;Swamp&quot;&gt;&gt;
&lt;&lt;set $firstTimeSwamp = false&gt;&gt;

/* &lt;&lt;set _species = either($tiger, $fox, $rabbit)&gt;&gt; */
&lt;&lt;createFixedNPC &quot;Elara&quot; 1&gt;&gt; 

&lt;p&gt;As you make your way through the dense, murky swampland, the air is heavy with the scent of damp earth and decaying vegetation. The thick canopy above filters the sunlight into a greenish haze, casting eerie shadows on the waterlogged ground below. The swamp is alive with the sounds of distant animal calls and the occasional splash of water, hinting at the presence of unseen creatures lurking beneath the surface.&lt;/p&gt;

&lt;p&gt;In this almost otherworldly setting, a peculiar and startling sight interrupts your path. Lying just off the trail is a figure so unusual it takes a moment for your mind to make sense of it. It&#39;s a $npc1.species, but $npc1.his condition defies natural explanation. $npc1.He&#39;s been massively swollen, $npc1.his body bloated to a size that seems impossible. You assume this must be the effects of the infamous Puff Fungus of this area.&lt;/p&gt;

&lt;p&gt;As you approach cautiously, the details of $npc1.his transformation become more apparent.The $npc1.species&#39;s waist is gargantuan, measuring around four feet in circumference. It&#39;s as if $npc1.his body has been inflated to the limits of its skin, stretched smooth and shiny like the surface of a balloon. $npc1.His once sleek and agile form is now a spherical mass, Lightly wobbling back and forth in the breeze.&lt;/p&gt;

&lt;p&gt;$npc1.His arms and legs, swollen to extreme proportions, jut out from $npc1.his round body. They resemble less the limbs of a $npc1.species and more like plump, overstuffed sausages, devoid of their usual dexterity. $npc1.His limbs twitch and wiggle feebly, the only movement $npc1.he seems capable of in $npc1.his inflated state.&lt;/p&gt;

&lt;p&gt;Suddenly, there&#39;s a noticeable shift in $npc1.his condition. $npc1.He lets out a deep, resonating burp, and a puff of green gas escapes $npc1.his lips. It&#39;s a small but visible release, and you watch in surprise as $npc1.his body deflates slightly with the expulsion of the gas. The swelling in $npc1.his waist reduces just a bit, the skin loosening ever so slightly from its previously taut state.&lt;/p&gt;

&lt;p&gt;The bloated $npc1.species lies there, seemingly unaware of your presence, $npc1.his eyes half-closed as if in a daze. As you draw nearer, you contemplate your next move. You could introduce yourself or maybe you want to do something else...&lt;/p&gt;

&lt;&lt;action &quot;7&quot; &quot;swamp&quot; &quot;Talk&quot; &quot;Talk to Swollen Adventurer&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="595" name="Swamp" tags="swamp" position="3775,1750" size="200,200">&lt;&lt;if $eventCounterB == &quot;rest&quot;&gt;&gt;
	&lt;p&gt;&lt;&lt;set $eventCounterB = &quot;&quot;&gt;&gt;
	You find a comfortable spot to sit down and rest. 
	&lt;&lt;rest&gt;&gt;&lt;/p&gt;

	&lt;&lt;if random(1,5) == 1&gt;&gt;
		&lt;&lt;set _enemy = either($fatWolf, $obeseBear, $lemonSlime, $syrupVines, $fruitDryad)&gt;&gt;
		&lt;&lt;setEnemy _enemy&gt;&gt;
		You are awoken from your sleep by $e.article $e.name! 
		&lt;&lt;startCombat&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;include &quot;Ambient swamp&quot;&gt;&gt;
		&lt;&lt;include &quot;swamp randomization&quot;&gt;&gt;
		&lt;&lt;action &quot;7&quot; &quot;swamp&quot; &quot;Talk&quot; &quot;Talk to Swollen Adventurer&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;else&gt;&gt;
&lt;p&gt;The nearby swamplands, once an overlooked and desolate expanse, have recently transformed into a place teeming with life and mystery. The once-still waters now bubble with activity, and the thick, murky depths seem to pulsate with a newfound energy. The swamp&#39;s flora, from towering, moss-draped trees to the smallest of ferns, have taken on a lush and vibrant hue, thriving in the damp, humid air. The creatures of the swamp, too, have become unusually robust and active, their bodies swelling with the abundance of the environment. Fish are plumper, amphibians more numerous, and even the insects buzz with a livelier zeal. &lt;/p&gt;

&lt;p&gt;However, this abundance is not without its perils. The predators of the swamp, from the silent, stalking alligators to the swift, striking snakes, have grown more daring and aggressive, feasting on the bloated prey with relentless hunger. There are whispers among the locals of shadowy figures who traverse the swamp, their intentions as murky as the waters they walk beside. These mysterious beings are rumored to harness the swamp&#39;s strange energies for their own dark purposes, ensnaring unwary travelers with enchantments as thick as the swamp&#39;s fog. The swamp, with its hidden dangers and secrets, beckons the brave and the foolish in equal measure, promising both untold treasures and unspeakable terrors within its enigmatic embrace.&lt;/p&gt;

&lt;&lt;include &quot;Ambient swamp&quot;&gt;&gt;
&lt;&lt;include &quot;swamp randomization&quot;&gt;&gt;
&lt;&lt;action &quot;7&quot; &quot;swamp&quot; &quot;Talk to Elara&quot; &quot;Talk to Swollen Adventurer&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="596" name="Talk to Swollen Adventurer" tags="swamp" position="3525,1875" size="100,100">&lt;&lt;createFixedNPC &quot;Elara&quot; 1&gt;&gt; 
&lt;&lt;set $character = &quot;Elara&quot;&gt;&gt;
&lt;&lt;set $hasRun = false&gt;&gt;
&lt;&lt;set $request = &quot;&quot;&gt;&gt;

&lt;div class=&quot;block--background&quot;&gt;
	&lt;div class=&quot;chatbot__overview&quot;&gt;
		&lt;ul class=&quot;chatlist&quot;/&gt;
	&lt;/div&gt;
	&lt;div class=&quot;chatbox-area&quot;&gt;
		&lt;form action=&quot;&quot; id=&quot;chatform&quot;&gt;
			&lt;&lt;textbox &quot;$request&quot; &quot;&quot;&gt;&gt;
			&lt;&lt;link &quot;Send&quot;&gt;&gt;
				&lt;&lt;run 
					addChat($character, {&quot;role&quot;: &quot;user&quot;,&quot;content&quot;: $request});
					makeAITextRequest({character: $character});
				&gt;&gt;
				&lt;&lt;script&gt;&gt;
					document.getElementById(&#39;textbox-request&#39;).value = &#39;&#39;;
				&lt;&lt;/script&gt;&gt;
			&lt;&lt;/link&gt;&gt;
		&lt;/form&gt;
	&lt;/div&gt;
&lt;/div&gt;

&lt;&lt;script&gt;&gt;
console.log(State.variables.npcs.Elara);
postdisplay[&#39;createConversation&#39;] = function (taskName) {
    if (!State.variables.hasRun) {
        var character = State.variables.character;
        createConversation(character);
        State.variables.hasRun = true;
    }
};
&lt;&lt;/script&gt;&gt;

&lt;&lt;action &quot;4&quot; &quot;swamp&quot; &quot;Return to Swamp&quot; &quot;Swamp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="597" name="Ambient swamp" tags="nobr swamp" position="3675,1675" size="100,100">&lt;&lt;switch $daytime&gt;&gt;

&lt;&lt;case &quot;night&quot;&gt;&gt;
&lt;&lt;switch random(1,5)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
The moon rises, and its shine along with that of starlight seeps through the silver-tinted canopy leaves and scantly illuminates the mysterious nightly happenings of the swamp, that include far more than just nocturnal hunting and gurgling of both carnivorous and ruminant bellies filled during midday and twilight. 

&lt;&lt;case 2&gt;&gt;
As the rustle of elusive, yet hefty &lt;&lt;=$bat.plural&gt;&gt; and likewise well-fed night time birds fills the air above, hisses and rattling start coming from the underbrush, and strange, bizarrely moving silhouettes can be spotted against the eldritch glow coming from the heart of the swamp.

&lt;&lt;case 3&gt;&gt;
Unsettling whispers come from everywhere, resonating from tree to tree and floating through the bushes and grass, and the eerie shapes are moving ever closer to your hiding place that doesn&#39;t feel so secure now, and the plants themselves seem to move subtly on their own accord without any wind prompting them. 

&lt;&lt;case 4&gt;&gt;
A chill creeps along your spine, unsettling you. In a swift motion, you whirl around, half-expecting to find someone behind you, but the trail lies empty and silent. The sensation of a hand gripping your shoulder lingers in your mind. As you resume your walk, the event replays in your thoughts. You swear you jumped and then felt the hand on your shoulder, but that doesn&#39;t make sense... You&#39;re not sure anymore...

&lt;&lt;default&gt;&gt;
You feel like you should leave...

&lt;&lt;/switch&gt;&gt;

&lt;&lt;case &quot;morning&quot;&gt;&gt;
&lt;&lt;switch random(1,3)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
In the pre-dawn stillness, the swamp lies in a deep, eerie calm. The water&#39;s surface is a mirror of glass, undisturbed by the usual ripple of fish or splash of amphibians. The nocturnal creatures have retreated to the safety of their murky lairs, and the daytime dwellers are yet to emerge, creating a moment of rare, quiet stillness in the usually bustling swamp.
								
&lt;&lt;case 2&gt;&gt;
As the morning mist hangs low over the swamp, you spot a group of unusually round birds perched clumsily on a branch. Their bodies are comically swollen, bobbing slightly as they attempt to maintain their balance. As you watch, one of them tips forward, its inflated body acting like a balloon, causing it to drift upwards and get entangled in a higher branch, flapping helplessly as it tries to free itself.
								
&lt;&lt;case 3&gt;&gt;
A hodgepodge chorus of small birds fills the morning air, and life awakens on the forest&#39;s shadowy floor, with little creatures scurrying around and larger forms rustling the bushes and cracking dry branches under their feet and paws. 
								 								
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;day&quot;&gt;&gt;
&lt;&lt;switch random(1,5)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
The swamp at midday is a slow-moving tableau under the heavy, humid air. Bloated alligators lounge languidly on the banks, their swollen bellies sunning in the dappled light. Occasionally, one will slide into the water with a lazy splash, disturbing schools of plump fish that scatter in lazy, undulating waves. The air is thick with the drone of oversized insects, lazily flitting from leaf to leaf, too weighed down by the heat to hurry.

&lt;&lt;case 2&gt;&gt;
In the oppressive heat of the swamp, even the usual frenetic pace of life seems to slow. Overweight frogs squat on lily pads, eyes half-closed, too full and hot to bother with the slow-moving dragonflies. 

&lt;&lt;case 3&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;
In the afternoon, while navigating through a particularly dense part of the swamp, you hear a faint call for help. Looking up, you see another adventurer, a $npc1.male $npc1.specices. $npc1.his body massively swollen, stuck in the branches of a towering tree. $npc1.he seems to have inflated like a balloon and floated up there, now unable to descend. While attempting to rescure the $npc1.specices, $npc1.he suddenly dislodges from the canopy and gradually floats upward, lifted by whatever gas they&#39;ve been filled with. You apologize to the blimped $npc1.species as $npc1.he wiggles $npc1.his $npc1.hands in panic and slowly drifts away. 

&lt;&lt;case 4&gt;&gt;
A corpulent snake winds its way lethargically through the underbrush, distended from a recent meal, showing little interest in the plodding, chubby rodents that scurry in the underbrush. The atmosphere is one of drowsy satiation, as predator and prey alike succumb to the midday malaise.

&lt;&lt;default&gt;&gt;
Occasionally, a heavily-set otter or a round-bellied raccoon can be seen waddling along the water&#39;s edge, more interested in finding a cool spot to nap than in hunting. The chorus of croaks, chirps, and splashes is subdued, the swamp creatures too full and tired to engage in their usual activities. Even the insects seem to buzz more slowly, the air heavy with the scent of water and greenery, and the lazy, contented sounds of a swamp in the heat of the day.
								
&lt;&lt;/switch&gt;&gt;


&lt;&lt;case &quot;evening&quot;&gt;&gt;
&lt;&lt;switch random(1,6)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
As night falls over the swamp, the atmosphere shifts from lethargic to sinister. The moon casts an eerie glow on the water, and the shadows seem to move with a life of their own. Suddenly, the quiet is shattered by a ferocious splashing as a massive, bloated crocodile lunges at an unsuspecting, overweight capybara. The swamp becomes a stage for deadly predators, their hefty forms surprisingly agile in the hunt, turning the still night into a symphony of predatory prowess and desperate escape attempts.

&lt;&lt;case 2&gt;&gt;
Under the cover of night, while the swamp is alive with the sounds of nocturnal creatures, you spot a pair of eyes glowing in the darkness. Approaching cautiously, you discover a raccoon stuck in a narrow gap between two trees. Its body is inflated to the point of immobility, round and tight as a drum. It looks at you with a mix of embarrassment and plea, evidence of the strange and unpredictable nature of the swamp.

&lt;&lt;case 3&gt;&gt;
A deep, rumbling growl resonates through the air, followed by a frenzied splashing as one of these formidable creatures successfully captures its plump prey. The night air is filled with the sounds of struggle and conquest, reminding you of the swamp&#39;s perilous nature after dark.

&lt;&lt;case 4&gt;&gt;
In the dead of night, the swamp transforms into a realm of lurking danger. The air vibrates with the low croaks of giant frogs and the occasional disturbing splash of something large moving through the water. 

&lt;&lt;case 5&gt;&gt;
You catch a fleeting glimpse of a shadowy figure moving in the distance, too quick to identify but unmistakably ominous. The sight sends a chill down your spine, a stark reminder that in the swamp, you are never truly alone, and not all that moves in the shadows is natural.

&lt;&lt;default&gt;&gt;
The moon casts a silver sheen over the swamp, creating a landscape both beautiful and treacherous. The night&#39;s chorus is a mix of croaks, hisses, and unseen rustlings in the underbrush. 
								
&lt;&lt;/switch&gt;&gt;


&lt;&lt;default&gt;&gt;
**Error in ambient swamp**

&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="598" name="Swamp ambush" tags="nobr" position="3625,1975" size="100,100">/* Dark dangers in the swamp at night */
&lt;&lt;switch $daytime&gt;&gt;
	&lt;&lt;case &quot;night&quot;&gt;&gt;
		&lt;&lt;set $swampEnemies = [&quot;vines&quot;]&gt;&gt;
	&lt;&lt;default&gt;&gt;
		&lt;&lt;set $swampEnemies = [&quot;vines&quot;]&gt;&gt;
&lt;&lt;/switch&gt;&gt;
&lt;&lt;set _enemy = $swampEnemies.pluck()&gt;&gt;

&lt;&lt;switch _enemy&gt;&gt;

	&lt;&lt;case &quot;vines&quot;&gt;&gt;
	&lt;&lt;setEnemy $syrupVines&gt;&gt;
	As you&#39;re walking through the swamp, you start to notice the vines are growing strangely thick. Especially since this type of swamp isn&#39;t supposed to have vines. Soon you find yourself completely surrounded by thick dripping vines as they move to surround you!

	&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in enemy randomization&#39;&#39;
&lt;&lt;/switch&gt;&gt;

&lt;&lt;startCombat&gt;&gt;</tw-passagedata><tw-passagedata pid="599" name="swamp randomization" tags="swamp" position="3875,1875" size="100,100">/*Ticks up random events counters*/
&lt;&lt;set $swampRandomization.combat += $swampRandomization.combatRate&gt;&gt;
&lt;&lt;set $swampRandomization.special += $swampRandomization.specialRate&gt;&gt;
&lt;&lt;set $swampRandomization.leave += $swampRandomization.leaveRate&gt;&gt;
&lt;&lt;set $swampRandomization.minor += $swampRandomization.minorRate&gt;&gt;

/*Selects highest counter*/
&lt;&lt;set _randomEvent = &quot;combat&quot;&gt;&gt;
&lt;&lt;if $swampRandomization.special &gt; $swampRandomization.combat&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;special&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $swampRandomization.minor &gt; $swampRandomization.special&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;minor&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $swampRandomization.leave &gt; $swampRandomization.minor&gt;&gt;
	&lt;&lt;set _randomEvent = &quot;leave&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

/*Executes selected event and resets counter*/
&lt;&lt;switch _randomEvent&gt;&gt;

/*A random combat*/
&lt;&lt;case &quot;combat&quot;&gt;&gt;
&lt;&lt;set $swampRandomization.combat = 0&gt;&gt;
&lt;&lt;set _event = &quot;Swamp ambush&quot;&gt;&gt;

/*A special event*/
&lt;&lt;case &quot;special&quot;&gt;&gt;
&lt;&lt;set $swampRandomization.special = 0&gt;&gt;
&lt;&lt;set _specialEvent = 0&gt;&gt;
&lt;&lt;for _i=0; _i&lt;$swampSpecialRandomization.length; _i++&gt;&gt;
	&lt;&lt;set $swampSpecialRandomization[_i]++&gt;&gt;
	&lt;&lt;if $swampSpecialRandomization[_i] &gt;
		$swampSpecialRandomization[_specialEvent]&gt;&gt;
		&lt;&lt;set _specialEvent = _i&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;set $swampSpecialRandomization[_specialEvent] = 0&gt;&gt;
&lt;&lt;switch _specialEvent&gt;&gt;
	&lt;&lt;case 0&gt;&gt;
	&lt;&lt;set _event = &quot;Marshmallow Wisps&quot;&gt;&gt;
	&lt;&lt;case 1&gt;&gt;
	&lt;&lt;set _event = &quot;Wolf pack&quot;&gt;&gt;
	&lt;&lt;case 2&gt;&gt;
	&lt;&lt;set _event = &quot;Storeroom&quot;&gt;&gt;
	&lt;&lt;case 3&gt;&gt;
	&lt;&lt;set _event = &quot;Mysterious feast&quot;&gt;&gt;
	&lt;&lt;default&gt;&gt;
	&#39;&#39;Error in special event randomization!&#39;&#39;
&lt;&lt;/switch&gt;&gt;

/*A random minor scene*/
&lt;&lt;case &quot;minor&quot;&gt;&gt;
&lt;&lt;set $swampRandomization.minor = 0&gt;&gt;
&lt;&lt;set _event = &quot;Minor swamp events&quot;&gt;&gt;

/*Opportunity to leave the swamp*/
&lt;&lt;case &quot;leave&quot;&gt;&gt;
&lt;&lt;set $swampRandomization.leave = 0&gt;&gt;
&lt;&lt;set _event = &quot;Path out of the swamp&quot;&gt;&gt;

&lt;&lt;default&gt;&gt;
&#39;&#39;Error in swamp randomization!!!&#39;&#39;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;rest&quot; &quot;Rest&quot; &quot;Swamp&quot;&gt;&gt;
	&lt;&lt;set $eventCounterB = &quot;rest&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $sta &gt; 0&gt;&gt;
&lt;&lt;action &quot;4&quot; &quot;swamp&quot; &quot;Swamp&quot; _event&gt;&gt;&lt;&lt;set $travel = 5&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;p&gt;&#39;&#39;You&#39;re too tired to move&#39;&#39;&lt;/p&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="600" name="Path out of the swamp" tags="" position="3000,2000" size="100,100">You find a clearing ahead. As you approach closer you find it is one of the trails back to the forest. Do you wish to leave the swamp?

&lt;&lt;include &quot;swamp randomization&quot;&gt;&gt;
&lt;&lt;action &quot;3&quot; &quot;forest&quot; &quot;Leave&quot; &quot;Forest&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="601" name="Minor swamp events" tags="nobr" position="3725,1975" size="100,100">&lt;&lt;setPassageTitle &quot;A discovery?&quot;&gt;&gt;

&lt;&lt;switch random(1,10)&gt;&gt;
&lt;&lt;case 1&gt;&gt;
As you wade deeper into the swamp, you notice a peculiar plant with vibrant, luminescent flowers. Carefully reaching out, you pluck one of the glowing blooms. The flower&#39;s light seems to pulsate gently in your hand, emitting a soft, ethereal glow. Tucking it into your bag, you feel a sense of warmth emanating from it.
&lt;&lt;getItem $luminousFlower&gt;&gt;


&lt;&lt;case 2&gt;&gt;
&lt;p&gt;Wandering through the murky swamp, you stumble upon a scene of indulgence. Several bloated toads are sprawled around a bush laden with glistening berries. Their bellies are distended, and they seem too full to move. As you approach, one of the toads burps lazily, eyeing you with disinterest. You pluck a handful of the untouched berries, their rich, sweet aroma tempting you to taste them, but you decide to save them for later.&lt;/p&gt;
&lt;&lt;getItem $swampBerries&gt;&gt;


&lt;&lt;case 3&gt;&gt;	
/* Need to change this case */
&lt;p&gt;As you travel through the swamp you hear the faint sound of trickling water. As you follow the sound, you find a small waterfall pouring from a cliff above. At the base of the waterfall you find a small pile of flasks. Most of them are broken, but one of them is still in pristine condition. &lt;/p&gt;

You look around and it doesn&#39;t seem like anyone&#39;s been here recently. Whoever owned these left them here long ago. You pick up the flask and fill it up from the waterfall.
&lt;&lt;getItem $waterFlask&gt;&gt;
	

&lt;&lt;case 4&gt;&gt;		
/* Need to change this case */
&lt;p&gt;You wander into a small clearing, in the middle of which you see a large stump. You cross the clearing and approach the stump, upon which you find a small wooden box. It looks rather simple, but has a few strange words carved into the top in some language you cannot decipher. &lt;/p&gt;		

You open the lid and find a small strange diamond shaped cookie with white frosting on top, while a few crumbs lie about it from where others must have once been. You take it, and replaced the box where you found it. 
&lt;&lt;getItem $oddCookie&gt;&gt;


&lt;&lt;case 5&gt;&gt;
&lt;&lt;createNPC &quot;random&quot; &quot;random&quot;&gt;&gt;
&lt;p&gt;As you navigate the swamp, the distant sounds of splashing and thrashing catch your attention. Moving cautiously, you weave through the dense foliage, drawn toward the commotion. Soon, you witness a startling scene: a formidable alligator is locked in a fierce struggle with a swarm of Bubble Leeches.&lt;/p&gt;

&lt;p&gt;The gator snaps viciously at the air, but with each bite, more of the leeches latch onto its thick hide. They begin to inflate the gator with an odd, gaseous substance. The reptile&#39;s tough skin stretches grotesquely, its body ballooning outwards at an alarming rate. The gator&#39;s once menacing form is now comically round, and it floats helplessly on the water&#39;s surface, unable to right itself or fend off the relentless leeches.&lt;/p&gt;

&lt;p&gt;You watch, mesmerized, as the gator&#39;s belly swells larger and larger, the surface of its skin shining tight under the moonlight. The Bubble Leeches continue their attack relentlessly, pumping the gator full until it resembles a giant, floating ball. With a final effort, the gator lets out a muffled roar, its voice distorted by its bloated body, before resigning to its fate as a buoyant spectacle in the moonlit swamp.&lt;/p&gt;

&lt;p&gt;In the aftermath, the gator floats motionlessly, proof of the swamp&#39;s strange and dangerous ecosystem. You take a moment to absorb the surreal scene before quietly backing away, leaving the inflated reptile to its fate amidst the murky waters and eerie whispers of the swamp.&lt;/p&gt;

/* Old section */
Now that the maelstrom of activity is over, you leave your hiding spot in the bushes and survey the combat zone. 
&lt;&lt;if random(1,2) == 1&gt;&gt;
Searching the marshy ground, you manage to find something! 

&lt;&lt;set _randomItem = random(1,100)&gt;&gt;
&lt;&lt;if _randomItem &gt; 90&gt;&gt;&lt;&lt;getItem $trident&gt;&gt;
&lt;&lt;elseif _randomItem &gt; 75&gt;&gt;&lt;&lt;getItem $apple&gt;&gt;
&lt;&lt;elseif _randomItem &gt; 40&gt;&gt;&lt;&lt;getItem $sHealthPotion&gt;&gt;
&lt;&lt;else&gt;&gt;&lt;&lt;getItem $cheeseburger&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;else&gt;&gt;
Searching the marshy ground, you manage to find a small bag of gold! 
&lt;&lt;set _goldFound = random(26,33)&gt;&gt;
&lt;&lt;doGld _goldFound&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;default&gt;&gt;
&lt;&lt;include &quot;Ambient swamp&quot;&gt;&gt;

&lt;&lt;/switch&gt;&gt;

&lt;&lt;include &quot;swamp randomization&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="602" name="Marshmallow Wisps" tags="" position="3750,1450" size="200,100">As you make your way through the dense, foggy swamp, a soft, sweet aroma tickles your nose. Intrigued, you follow the scent until you&#39;re surrounded by a swirl of Marshmallow Wisps – ethereal, floating creatures radiating a soft, white glow. They move gracefully around you, leaving trails of sparkling light.


&lt;&lt;action &quot;w&quot; &quot;whiteMagic&quot; &quot;Observe the wisps&quot; &quot;Marshmallow Wisps 1&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Run&quot; &quot;Marshmallow Wisps Run 1&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;action &quot;e&quot; &quot;wait&quot; &quot;Stay still&quot; &quot;Marshmallow Wisps Still 1&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;set $lastAction = &quot;observe&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="603" name="Marshmallow Wisps Run 1" tags="" position="3750,1450" size="200,100">/* &lt;&lt;set $lastAction = &quot;run&quot;&gt;&gt; */
&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;
&lt;p&gt;Fearing the Wisps you attempt to escape as fast as you can...&lt;/p&gt;
&lt;&lt;if $agi &gt; 90&gt;&gt;
    &lt;p&gt;...and you succeed! You manage to escape the Wisps and continue your journey.&lt;/p&gt;
    &lt;&lt;action &quot;w&quot; &quot;swamp&quot; &quot;Leave&quot; &quot;Swamp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else &gt;&gt;
    &lt;p&gt;...but you fail. The Wisps are too fast for you and manage to keep up.&lt;/p&gt;
    &lt;&lt;action &quot;e&quot; &quot;wait&quot; &quot;Uh oh...&quot; &quot;Marshmallow Wisps 1&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="604" name="Marshmallow Wisps Still 1" tags="" position="3750,1450" size="200,100">/* &lt;&lt;set $lastAction = &quot;still&quot;&gt;&gt; */
&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;

&lt;p&gt;You decide to stay still, knowing that it&#39;s about 50/50 that the Wisps might lose interest and just leave...&lt;/p&gt;
&lt;&lt;switch random(1,2)&gt;&gt;
    &lt;&lt;case 1&gt;&gt;
        &lt;p&gt;...and you&#39;re right! The Wisps lose interest and leave you alone.&lt;/p&gt;
        &lt;&lt;action &quot;w&quot; &quot;swamp&quot; &quot;Leave&quot; &quot;Swamp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
    &lt;&lt;case 2&gt;&gt;
        &lt;p&gt;...but you&#39;re wrong! The Wisps are still interested and continue to circle you.&lt;/p&gt;
        &lt;&lt;action &quot;e&quot; &quot;wait&quot; &quot;Uh oh...&quot; &quot;Marshmallow Wisps 1&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="605" name="Marshmallow Wisps 1" tags="" position="3750,1450" size="200,100">&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;

/* &lt;&lt;if $lastAction === &quot;observe&quot;&gt;&gt;  */
/* &lt;&lt;/if&gt;&gt; */

&lt;p&gt;The Wisps continue to swirl around you, their glow illuminating the foggy swamp. They seem to be observing you, but you can&#39;t tell what they&#39;re thinking. You&#39;re not sure if they&#39;re friendly or hostile, but they don&#39;t seem to be attacking you. You&#39;re not sure what to do next.&lt;/p&gt;

&lt;p&gt;Without warning, one of the Wisps brushes against your lips. Instantly, your $p.mouth fills with a thick, fluffy substance – marshmallow cream! Startled, you swallow reflexively, only for another dollop to take its place. It&#39;s impossibly light yet quickly makes your stomach feel full and heavy.&lt;/p&gt;

&lt;p&gt;The cream keeps coming, puffing up your cheeks with each new mouthful. Your belly begins to expand, a gentle swelling at first, slowly filling up. The sensation is peculiar – not unpleasant, but unnervingly relentless. The marshmallow cream is sweet and airy, yet it accumulates weight inside you, making your midsection rounder and softer to the touch.&lt;/p&gt;

&lt;p&gt;You try to step back, to escape the enchanting Wisps, but they seem to follow you, continuing their sweet assault. They take turns lightly pressing against your face and filling your $p.mouth with marshmallow. Each swallow contributes to your burgeoning belly, which now protrudes noticeably under your clothes. The fabric strains against the expansion, outlining a gradually swelling sphere.&lt;/p&gt;

&lt;p&gt;The filling becomes increasingly intense; your stomach stretches outwards, growing taut and swollen. You place your $p.hands on your sides, feeling the usual softness and the pressure that accompanies overeating. The marshmallow cream is still flowing into you, and you can&#39;t help but swallow it down or risk suffocating. &lt;/p&gt;

&lt;p&gt;In this state of initial bloating, you realize that escaping or defending yourself is becoming more challenging. Your movements are sluggish, burdened by the weight of the marshmallow cream filling you up. Each gulp adds to your size, leaving you increasingly heavy and stuffed in the eerie glow of the Wisps.&lt;/p&gt;

&lt;&lt;consume 20 15&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; 80&gt;&gt;

&lt;&lt;action &quot;c&quot; &quot;wait&quot; &quot;Something in the clearing...&quot; &quot;Marshmallow Wisps Clearing&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;</tw-passagedata><tw-passagedata pid="606" name="Marshmallow Wisps Clearing" tags="" position="3750,1450" size="200,100">&lt;&lt;createNPC &quot;random&quot; &quot;random&quot; 1&gt;&gt;
&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;

&lt;p&gt;As the Marshmallow Wisps continue their dance around you, you notice what they were previously encircling. It&#39;s a small group of adventurers, each transformed into a swollen state by the Wisps&#39; magic. Among them, one figure captures your attention – $npc1.article $npc1.species who is the largest of the group.&lt;/p&gt;

&lt;p&gt;This $npc1.species has been completely rounded out into an enormous, swollen marshmallow ball. $npc1.His $npc1.fur has taken on the pale, pristine whiteness of marshmallow cream, stretched taut and smooth over $npc1.his vastly inflated form. $npc1.He squishes heavily against the ground, gently wobbling back and forth.&lt;/p&gt;

&lt;p&gt;$npc1.His once distinct features are now softly molded by $npc1.his bloated state. $npc1.His arms and legs are barely discernible, merged into the roundness of $npc1.his body. $npc1.His face, though still recognizable, is extremely puffy, $npc1.his cheeks ballooned out to an almost comical degree. $npc1.His eyes, half-open as if in a daze, gaze out from $npc1.his marshmallow-swollen face.&lt;/p&gt;

&lt;p&gt;Despite $npc1.his predicament, $npc1.his expression is one of a bizarre, tranquil acceptance, as if $npc1.he has resigned $npc1.himself to $npc1.his fate at the hands of the Wisps. The faintest hint of a resigned smile plays across $npc1.his plump, marshmallowy lips, suggesting a surreal serenity amidst the chaos of the swamp.&lt;/p&gt;

&lt;p&gt;$npc1.His bloated, puffy form, now more a giant marshmallow sculpture than a $npc1.species, serves as a stark warning of the Wisps&#39; whimsical but potent magic. The sight is haunting as you realize this may soon be your fate if you don&#39;t escape soon.&lt;/p&gt;

&lt;&lt;if $alive == false&gt;&gt;
    &lt;br&gt;

    &lt;p&gt;You&#39;re too full and can&#39;t even fathom trying to escape. You just stand there idly rubbing your $waist stomach and groaning softly, trying to alleviate some of the pressure.&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;action &quot;w&quot; &quot;whiteMagic&quot; &quot;Give in to the Wisps&quot; &quot;Marshmallow Wisps 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;if $alive&gt;&gt;
    &lt;&lt;action &quot;c&quot; &quot;run&quot; &quot;Run&quot; &quot;Marshmallow Wisps Run 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
    &lt;&lt;action &quot;e&quot; &quot;wait&quot; &quot;Stay still&quot; &quot;Marshmallow Wisps Still 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $lastAction = &quot;wait&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="607" name="Marshmallow Wisps Run 2" tags="" position="3750,1450" size="200,100">&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;
&lt;&lt;set $lastAction = &quot;run&quot;&gt;&gt;

&lt;p&gt;The wisps aren&#39;t following as swiftly as before, so you heft your rounded belly up and attempt to run...&lt;/p&gt;
&lt;&lt;if $agi &gt; 60 &amp;&amp; $str &gt; 60&gt;&gt;
    &lt;p&gt;...and you succeed! You manage to escape the Wisps and continue your journey. You rub your $waist belly idly, almost wishing you could have a bit more of that tasty marshmallow filling...&lt;/p&gt;
    &lt;&lt;action &quot;w&quot; &quot;swamp&quot; &quot;Leave&quot; &quot;Swamp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;else &gt;&gt;
    &lt;p&gt;...but you fail. The Wisps are too fast for you and manage to keep up.&lt;/p&gt;
    &lt;&lt;action &quot;e&quot; &quot;wait&quot; &quot;Uh oh...&quot; &quot;Marshmallow Wisps 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="608" name="Marshmallow Wisps Still 2" tags="" position="3750,1450" size="200,100">&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;
&lt;&lt;set $lastAction = &quot;run&quot;&gt;&gt;

&lt;p&gt;You decide to stay still, knowing that it&#39;s about 50/50 that the Wisps might lose interest and just leave...&lt;/p&gt;
&lt;&lt;switch random(1,2)&gt;&gt;
    &lt;&lt;case 1&gt;&gt;
        &lt;p&gt;...and you&#39;re right! The Wisps lose interest and leave you alone. You rub your $waist belly idly, almost wishing you could have a bit more of that tasty marshmallow filling...&lt;/p&gt;
        &lt;&lt;action &quot;w&quot; &quot;swamp&quot; &quot;Leave&quot; &quot;Swamp&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
    &lt;&lt;case 2&gt;&gt;
        &lt;p&gt;...but you&#39;re wrong! The Wisps are still interested and continue to circle you.&lt;/p&gt;
        &lt;&lt;action &quot;e&quot; &quot;wait&quot; &quot;Uh oh...&quot; &quot;Marshmallow Wisps 2&quot;&gt;&gt;&lt;&lt;/action&gt;&gt;
&lt;&lt;/switch&gt;&gt;</tw-passagedata><tw-passagedata pid="609" name="Marshmallow Wisps 2" tags="" position="3750,1450" size="200,100">&lt;&lt;setPassageTitle &quot;Marshmallow Wisps&quot;&gt;&gt;

&lt;&lt;if $lastAction == &quot;run&quot;&gt;&gt;
    &lt;p&gt;You panic and attempt to flee, but your efforts are hindered by the growing fullness in your belly. The Marshmallow Wisps, unrelenting in their whimsical assault, continue to envelop you in their enchanting dance, filling you with more of the airy marshmallow cream.&lt;/p&gt;

    &lt;p&gt;As you struggle, you feel your belly puffing up even further, swelling into an enormous, rounded mass. It juts out prominently, a soft, white dome that wobbles slightly with each movement. But the expansion doesn&#39;t stop there.&lt;/p&gt;

    &lt;p&gt;You feel a curious sensation spreading to your hips and thighs. They begin to fatten up, the marshmallow cream seeping into your limbs, inflating them from within. Your hips widen, rounding out to match the distention of your stomach. Your thighs puff up, becoming thick and soft, rubbing against each other with each step.&lt;/p&gt;

    &lt;&lt;if $p.male == &quot;female&quot;&gt;&gt;
        &lt;p&gt;As you desperately try to flee from the enchanting Marshmallow Wisps, you feel an increasingly cumbersome change in your chest. you start to notice a dramatic change in your chest. The marshmallow cream, with its peculiar, airy density, begins to fill your breasts, causing them to swell and expand uncontrollably. The sensation is disorienting; your breasts become heavier and more voluminous, bouncing and wobbling uncontrollably with each labored step.&lt;/p&gt;

        &lt;p&gt;Your clothing strains against the sudden expansion, struggling to contain your rapidly enlarging chest. This bizarre swelling of your breasts adds a challenging new dynamic to your situation, their exaggerated roundness and wobble making it increasingly difficult to maintain your momentum.&lt;/p&gt;
    &lt;&lt;else&gt;&gt;
        &lt;p&gt;Your chest is not immune to the transformation. It too begins to fill, your torso expanding in all directions, growing increasingly rotund and pillowy. Your clothes stretch and strain over your swelling form, struggling to contain the ever-growing puffiness.&lt;/p&gt;
    &lt;&lt;/if&gt;&gt;

    &lt;p&gt;As the transformation progresses, your entire body takes on a puffy, marshmallow-like quality. Your arms grow round and plump, and even your face feels fuller, your features softening under the expanding layers. You become a picture of roundness, your body losing its usual contours under the relentless stuffing.&lt;/p&gt;

    &lt;p&gt;Moving becomes a challenge; each step is labored and slow, your fat limbs heavy and unwieldy. Each step is met with the jostling and bouncing of your marshmallow-inflated breasts, a constant reminder of the whimsical yet hindering magic of the Wisps. You can barely recognize your own body, now a soft, voluminous mass, a $p.species-sized marshmallow. The wisps dance around you, their work nearly complete, as you stand, swollen and almost entirely transformed,&lt;/p&gt;

&lt;&lt;else&gt;&gt;
    &lt;p&gt;A sense of resignation washes over you as you watch the whimsical creatures continue their dance, filling you with more of the fluffy marshmallow cream.&lt;/p&gt;

    &lt;p&gt;You close your eyes and take a deep breath, feeling the marshmallow cream puff up your belly even more. It swells outward smoothly, a soft, expanding dome that gently pushes forward. The sensation is oddly soothing, a warm, billowy fullness that envelops your midsection.&lt;/p&gt;

    &lt;p&gt;As you stand there, the expansion begins to spread. Your hips start to widen, the marshmallow cream filling them, rounding them out to match the distention of your stomach. You feel your thighs fattening next, becoming soft and pillowy. They rub against each other, a testament to their new, plump size.&lt;/p&gt;

    &lt;&lt;if $p.male == &quot;female&quot;&gt;&gt;
        &lt;p&gt;As the transformation continues, you notice a significant change in your chest. The marshmallow cream, with its airy yet substantial presence, begins to fill your breasts, causing them to swell and expand. They grow gradually heavier and rounder, stretching the fabric of your clothing to its limits. The sensation is both strange and oddly mesmerizing, feeling your breasts becoming increasingly plump and voluminous.&lt;/p&gt;

        &lt;p&gt;With a curious mix of surprise and acceptance, you gently rub the sides of your expanding breasts, feeling their newfound fullness and softness. The texture is smooth and pillowy under your touch. &lt;/p&gt;
    &lt;&lt;else&gt;&gt;
        &lt;p&gt;Your chest follows suit, inflating gently with each breath you take. Your torso expands in a uniform, cushiony manner, your body growing more rotund and marshmallow-like. The fabric of your clothes stretches over your swelling form, creating a snug, cocooning sensation around your increasingly puffy body.&lt;/p&gt;

        &lt;p&gt;With a curious mix of surprise and acceptance, you gently rub the sides of your expanding chest, feeling it&#39;s newfound fullness and softness. The texture is soft and pillowy to the touch. &lt;/p&gt;
    &lt;&lt;/if&gt;&gt;

    &lt;p&gt;Your arms and even your face start to fill out, adopting the same marshmallow softness. Your features soften, your cheeks becoming pleasantly plump. Your entire body is now a picture of round, soft puffiness, losing its usual contours under the steady, gentle inflation.&lt;/p&gt;

    &lt;p&gt;Embracing your transformed state, you find a strange tranquility in the experience. Any movement now is slow and deliberate, your plush limbs moving in a dreamlike state. You are a embodiment of a marshmallow, soft and serene, surrounded by the glittering dance of the Wisps. In this moment of surrender, you find a bizarre comfort, enveloped in the warmth of your own marshmallow-filled form.&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;consume 40 30&gt;&gt;
&lt;&lt;tempBuff &quot;fat&quot; 300&gt;&gt;</tw-passagedata><tw-passagedata pid="610" name="AI Settings" tags="nobr" position="2100,400" size="300,300">/* CREATE PASSAGE FOR (whatever) */

&lt;&lt;setPopupTitle &quot;AI Options&quot;&gt;&gt;

&lt;&lt;set _aiconfig = setup.aiconfig&gt;&gt; /* input boxes require state variables to work. This is just a dummy copy. We won&#39;t actually be using the real input box functionality, instead handling the setting etc. with scripts. */

/* Prepare the JSON section */
&lt;&lt;set _aiconfig.text.extra_parameters = JSON.stringify(_aiconfig.text.extra_parameters, null, &quot;\t&quot;)&gt;&gt;

&lt;b&gt;&lt;u&gt;Text Generation&lt;/u&gt;&lt;/b&gt;&lt;br&gt;
&lt;u&gt;Generation Service&lt;/u&gt;&lt;br&gt;
Include the URL (and optional API key) of the service to use for text generation. Text generation uses the OpenAI API standard, which can be used locally in programs like Oobabooga.&lt;br&gt;
&lt;label&gt;URL: &lt;&lt;textbox &quot;_aiconfig.text.url&quot; _aiconfig.text.url&gt;&gt;&lt;/label&gt;&lt;br&gt;
&lt;label&gt;Model: &lt;&lt;textbox &quot;_aiconfig.text.model&quot; _aiconfig.text.model&gt;&gt;&lt;/label&gt;&lt;br&gt;
&lt;label&gt;API Key: &lt;&lt;textbox &quot;_aiconfig.text.apikey&quot; _aiconfig.text.apikey&gt;&gt;&lt;/label&gt;&lt;br&gt;
&lt;br&gt;
&lt;u&gt;Settings&lt;/u&gt;&lt;br&gt;
&lt;label&gt;Temperature: &lt;&lt;numberbox &quot;_aiconfig.text.temperature&quot; _aiconfig.text.temperature&gt;&gt;&lt;/label&gt;&lt;br&gt;
&lt;label&gt;Frequency Penalty: &lt;&lt;numberbox &quot;_aiconfig.text.frequency_penalty&quot; _aiconfig.text.frequency_penalty&gt;&gt;&lt;/label&gt;&lt;br&gt;
&lt;label&gt;Maximum Tokens: &lt;&lt;numberbox &quot;_aiconfig.text.max_tokens&quot; _aiconfig.text.max_tokens&gt;&gt;&lt;/label&gt;&lt;br&gt;
&lt;br&gt;
&lt;u&gt;Additional Parameters&lt;/u&gt;&lt;br&gt;
Enter additional API parameters here in the form of JSON Object.&lt;br&gt;
&lt;&lt;textarea &quot;_aiconfig.text.extra_parameters&quot; _aiconfig.text.extra_parameters&gt;&gt;


&lt;&lt;script&gt;&gt;

function onTextStandardChanged(key, newValue, elementId) {
	/* Do any clamping of values etc. here */
    switch(key) {
    	case &quot;temperature&quot;:
        	newValue = Math.clamp(newValue, 0, 2);
            break;
        case &quot;frequency_penalty&quot;:
        	newValue = Math.clamp(newValue, -2, 2);
            break;
        default:
        	break;
    }
	
	/* Set the new value */
	setup.aiconfig.text[key] = newValue;
	
	/* Manually update the input box value */
	$(elementId).val(newValue);
}

/* Trigger saving to metadata */
function onClosed() {
	/* Attempt to save what was entered into the JSON section (we don&#39;t bother trying to save this on each input like the other options) */
	try {
        let newValue = JSON.parse($(&#39;#textarea--aiconfigtextextra-parameters&#39;).val());
		/* Set the new value */
		setup.aiconfig.text.extra_parameters = newValue;
		
	} catch (error) {
		/* Do nothing*/
        console.log(&quot;Input JSON was incorrectly formatted - discarding&quot;);
	} finally {
		
      	/* Save the AI Config in metadata */
     	 State.metadata.set(&#39;aiconfig&#39;, setup.aiconfig);
    };
}

/* Save changes *whenever* the user changes the input */
$(document).ready(function() {
  $(&#39;#textbox--aiconfigtexturl&#39;).on(&#39;input&#39;, function() {
    onTextStandardChanged(&quot;url&quot;, $(this).val(), &quot;#textbox--aiconfigtexturl&quot;);
  });
	$(&#39;#textbox--aiconfigtextapikey&#39;).on(&#39;input&#39;, function() {
    onTextStandardChanged(&quot;apikey&quot;, $(this).val(), &quot;#textbox--aiconfigtextapikey&quot;);
  });
	
	$(&#39;#numberbox--aiconfigtexttemperature&#39;).on(&#39;input&#39;, function() {
    onTextStandardChanged(&quot;temperature&quot;, $(this).val(), &quot;#numberbox--aiconfigtexttemperature&quot;);
  });
	$(&#39;#numberbox--aiconfigtextfrequency-penalty&#39;).on(&#39;input&#39;, function() {
    onTextStandardChanged(&quot;frequency_penalty&quot;, $(this).val(), &quot;#numberbox--aiconfigtextfrequency-penalty&quot;);
  });
	$(&#39;#numberbox--aiconfigtextmax-tokens&#39;).on(&#39;input&#39;, function() {
    onTextStandardChanged(&quot;max_tokens&quot;, $(this).val(), &quot;numberbox--aiconfigtextmax-tokens&quot;);
  });
	
	/* (extra parameters aren&#39;t processed in this same way, and are only attempted to save upon dialog close) */
	
	$(document).one(&#39;:dialogclosing&#39;, function() {
    onClosed();
  });
});

&lt;&lt;/script&gt;&gt;</tw-passagedata></tw-storydata>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){(function(window,document,jQuery,undefined){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var errorPrologRegExp=/^(?:(?:uncaught\s+(?:exception:\s+)?)?\w*(?:error|exception|_err):\s+)+/i,Alert=function(){function mesg(where,error,isFatal,isUncaught){var mesg="Error",nice="A".concat(isFatal?" fatal":"n"," error has occurred.");nice+=isFatal?" Aborting.":" You may be able to continue, but some parts may not work properly.";var isObject=null!==error&&"object"===_typeof(error),what=(isObject&&"message"in error?String(error.message).replace(errorPrologRegExp,""):String(error)).trim()||"unknown error";null!=where&&(mesg+=" [".concat(where,"]")),mesg+=": ".concat(what,"."),isObject&&"stack"in error&&(mesg+="\n\nStack Trace:\n".concat(error.stack)),mesg&&(nice+="\n\n".concat(mesg)),isUncaught||console[isFatal?"error":"warn"](mesg),window.alert(nice)}var origOnError;return origOnError=window.onerror,window.onerror=function(what,source,lineNum,colNum,error){"complete"===document.readyState?mesg(null,null!=error?error:what,!1,!0):(mesg(null,null!=error?error:what,!0,!0),window.onerror=origOnError,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))},Object.freeze(Object.defineProperties({},{error:{value:function(where,error){mesg(where,error)}},fatal:{value:function(where,error){mesg(where,error,!0)}}}))}(),Patterns=(wsMap=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),wsRe=/^\s$/,missing="",wsMap.forEach((function(pat,char){wsRe.test(char)||(missing+=pat)})),space=missing?"[\\s".concat(missing,"]"):"\\s",spaceNoTerminator="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",notSpace="\\s"===space?"\\S":space.replace(/^\[/,"[^"),anyChar="(?:.|".concat("[\\n\\r\\u2028\\u2029]",")"),anyLetter="[0-9A-Z_a-z\\-\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]",anyLetterStrict=anyLetter.replace("\\-",""),identifier="".concat("[$A-Z_a-z]").concat("[$0-9A-Z_a-z]","*"),variable="[$_]"+identifier,htmlTagName="[A-Za-z](?:".concat(cENChar="(?:[\\x2D.0-9A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])","*-").concat(cENChar,"*|[0-9A-Za-z]*)"),twStyle="(".concat(anyLetter,"+)\\(([^\\)\\|\\n]+)\\):"),cssStyle="".concat(spaceNoTerminator,"*(").concat(anyLetter,"+)").concat(spaceNoTerminator,"*:([^;\\|\\n]+);"),idOrClass="".concat(spaceNoTerminator,"*((?:").concat("[#.]").concat(anyLetter,"+").concat(spaceNoTerminator,"*)+);"),inlineCss="".concat(twStyle,"|").concat(cssStyle,"|").concat(idOrClass),Object.freeze({space:space,spaceNoTerminator:spaceNoTerminator,lineTerminator:"[\\n\\r\\u2028\\u2029]",notSpace:notSpace,anyChar:anyChar,anyLetter:anyLetter,anyLetterStrict:anyLetterStrict,identifierFirstChar:"[$A-Z_a-z]",identifierNextChar:"[$0-9A-Z_a-z]",identifier:identifier,variableSigil:"[$_]",variable:variable,macroName:"[A-Za-z][\\w-]*|[=-]",templateName:"[A-Za-z][\\w-]*",htmlTagName:htmlTagName,cssIdOrClassSigil:"[#.]",cssImage:"\\[[<>]?[Ii][Mm][Gg]\\[(?:\\s|\\S)*?\\]\\]+",inlineCss:inlineCss,url:"(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+"})),wsMap,wsRe,missing,cENChar,twStyle,cssStyle,idOrClass,space,spaceNoTerminator,notSpace,anyChar,anyLetter,anyLetterStrict,identifier,variable,htmlTagName,inlineCss;!function(){var startWSRe,endWSRe,_trimString=(startWSRe=new RegExp("^".concat(Patterns.space).concat(Patterns.space,"*")),endWSRe=new RegExp("".concat(Patterns.space).concat(Patterns.space,"*$")),function(str,where){var val=String(str);if(!val)return val;switch(where){case"start":return startWSRe.test(val)?val.replace(startWSRe,""):val;case"end":return endWSRe.test(val)?val.replace(endWSRe,""):val;default:throw new Error('_trimString called with incorrect where parameter value: "'.concat(where,'"'))}});function _createPadString(length,padding){var targetLength=Number.parseInt(length,10)||0;if(targetLength<1)return"";var padString=void 0===padding?"":String(padding);for(""===padString&&(padString=" ");padString.length<targetLength;){var curPadLength=padString.length,remainingLength=targetLength-curPadLength;padString+=curPadLength>remainingLength?padString.slice(0,remainingLength):padString}return padString.length>targetLength&&(padString=padString.slice(0,targetLength)),padString}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,writable:!0,value:function flat(){if(null==this)throw new TypeError("Array.prototype.flat called on null or undefined");var depth=0===arguments.length?1:Number(arguments[0])||0;return depth<1?Array.prototype.slice.call(this):Array.prototype.reduce.call(this,(function(acc,cur){return cur instanceof Array?acc.push.apply(acc,_toConsumableArray(flat.call(cur,depth-1))):acc.push(cur),acc}),[])}}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatMap called on null or undefined");return Array.prototype.map.apply(this,arguments).flat()}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var length=this.length>>>0;if(0===length)return!1;var needle=arguments[0],i=Number(arguments[1])||0;for(i<0&&(i=Math.max(0,length+i));i<length;++i){var value=this[i];if(value===needle||value!=value&&needle!=needle)return!0}return!1}}),Object.entries||Object.defineProperty(Object,"entries",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.entries object parameter must be an object");return Object.keys(obj).map((function(key){return[key,obj[key]]}))}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{configurable:!0,writable:!0,value:function(iter){return Array.from(iter).reduce((function(acc,pair){if(Object(pair)!==pair)throw new TypeError("Object.fromEntries iterable parameter must yield objects");return pair[0]in acc?Object.defineProperty(acc,pair[0],{configurable:!0,enumerable:!0,writable:!0,value:pair[1]}):acc[pair[0]]=pair[1],acc}),{})}}),Object.getOwnPropertyDescriptors||Object.defineProperty(Object,"getOwnPropertyDescriptors",{configurable:!0,writable:!0,value:function(obj){if(null==obj)throw new TypeError("Object.getOwnPropertyDescriptors object parameter is null or undefined");var O=Object(obj);return Reflect.ownKeys(O).reduce((function(acc,key){var desc=Object.getOwnPropertyDescriptor(O,key);return void 0!==desc&&(key in acc?Object.defineProperty(acc,key,{configurable:!0,enumerable:!0,writable:!0,value:desc}):acc[key]=desc),acc}),{})}}),Object.values||Object.defineProperty(Object,"values",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.values object parameter must be an object");return Object.keys(obj).map((function(key){return obj[key]}))}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:_createPadString(targetLength-baseLength,padding)+baseString}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:baseString+_createPadString(targetLength-baseLength,padding)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return _trimString(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return _trimString(this,"end")}})}(),function(){var _nativeMathRandom=Math.random,_regExpMetaCharsRe,_hasRegExpMetaCharsRe,_formatRegExp,_hasFormatRegExp;function _random(){var min,max;switch(arguments.length){case 0:throw new Error("_random called with insufficient parameters");case 1:min=0,max=arguments[0];break;default:min=arguments[0],max=arguments[1]}if(min>max){var _ref=[max,min];min=_ref[0],max=_ref[1]}return Math.floor(_nativeMathRandom()*(max-min+1))+min}function _randomIndex(length,boundsArgs){var min,max;switch(boundsArgs.length){case 1:min=0,max=length-1;break;case 2:min=0,max=Math.trunc(boundsArgs[1]);break;default:min=Math.trunc(boundsArgs[1]),max=Math.trunc(boundsArgs[2])}return Number.isNaN(min)?min=0:!Number.isFinite(min)||min>=length?min=length-1:min<0&&(min=length+min)<0&&(min=0),Number.isNaN(max)?max=0:(!Number.isFinite(max)||max>=length||max<0&&(max=length+max)<0)&&(max=length-1),_random(min,max)}function _getCodePointStartAndEnd(str,pos){var code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};if(code<55296||code>57343)return{char:str.charAt(pos),start:pos,end:pos};if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)throw new Error("high surrogate without trailing low surrogate");var nextCode=str.charCodeAt(nextPos);if(nextCode<56320||nextCode>57343)throw new Error("high surrogate without trailing low surrogate");return{char:str.charAt(pos)+str.charAt(nextPos),start:pos,end:nextPos}}if(0===pos)throw new Error("low surrogate without leading high surrogate");var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);if(prevCode<55296||prevCode>56319)throw new Error("low surrogate without leading high surrogate");return{char:str.charAt(prevPos)+str.charAt(pos),start:prevPos,end:pos}}Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(array){if("object"!==_typeof(array)||null===array||!Object.prototype.hasOwnProperty.call(array,"length"))throw new TypeError("Array.random array parameter must be an array or array-lke object");var length=array.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments,1));return array[index]}}}),Object.defineProperty(Array.prototype,"concatUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.concatUnique called on null or undefined");var result=Array.from(this);if(0===arguments.length)return result;var items=Array.prototype.reduce.call(arguments,(function(prev,cur){return prev.concat(cur)}),[]),addSize=items.length;if(0===addSize)return result;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=items[i];-1===indexOf.call(result,value)&&push.call(result,value)}return result}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var indexOf=Array.prototype.indexOf,needle=arguments[0],pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,++pos;return count}}),Object.defineProperty(Array.prototype,"countWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.countWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.countWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return 0;for(var count=0,i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&++count;return count}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var needles=Array.prototype.concat.apply([],arguments),needlesLength=needles.length,indices=[],i=0;i<length;++i)for(var value=this[i],j=0;j<needlesLength;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){indices.push(i);break}}for(var result=[],_i=0,iend=indices.length;_i<iend;++_i)result[_i]=this[indices[_i]];for(var splice=Array.prototype.splice,_i2=indices.length-1;_i2>=0;--_i2)splice.call(this,indices[_i2],1);return result}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,cpyIndices=_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map((function(x){return x<0?Math.max(0,length+x):x}))).values()),delIndices=_toConsumableArray(cpyIndices).sort((function(a,b){return b-a})),result=[],i=0,iend=cpyIndices.length;i<iend;++i)result[i]=this[cpyIndices[i]];for(var _i3=0,_iend=delIndices.length;_i3<_iend;++_i3)splice.call(this,delIndices[_i3],1);return result}}),Object.defineProperty(Array.prototype,"deleteWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.deleteWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.deleteWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,indices=[],result=[],i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&(result.push(this[i]),indices.push(i));for(var _i4=indices.length-1;_i4>=0;--_i4)splice.call(this,indices[_i4],1);return result}}),Object.defineProperty(Array.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.first called on null or undefined");if(0!==this.length>>>0)return this[0]}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(!Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.last called on null or undefined");var length=this.length>>>0;if(0!==length)return this[length-1]}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return Array.prototype.splice.call(this,index,1)[0]}}}),Object.defineProperty(Array.prototype,"pluckMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.pluckMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.pluckMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var splice=Array.prototype.splice,result=[],max=length-1;do{result.push(splice.call(this,_random(0,max--),1)[0])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"pushUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pushUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&push.call(this,value)}return this.length>>>0}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return this[index]}}}),Object.defineProperty(Array.prototype,"randomMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.randomMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.randomMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var picked=new Map,result=[],max=length-1;do{var i=void 0;do{i=_random(0,max)}while(picked.has(i));picked.set(i,!0),result.push(this[i])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var length=this.length>>>0;if(0===length)return this;for(var i=length-1;i>0;--i){var j=Math.floor(_nativeMathRandom()*(i+1));if(i!==j){var swap=this[i];this[i]=this[j],this[j]=swap}}return this}}),Object.defineProperty(Array.prototype,"unshiftUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.unshiftUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,unshift=Array.prototype.unshift,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&unshift.call(this,value)}return this.length>>>0}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var slice=Array.prototype.slice,fn=this,bound=slice.call(arguments,0);return function(){for(var applied=[],argc=0,i=0;i<bound.length;++i)applied.push(bound[i]===undefined?arguments[argc++]:bound[i]);return fn.apply(this,applied.concat(slice.call(arguments,argc)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(num,min,max){var value=Number(num);return Number.isNaN(value)?NaN:value.clamp(min,max)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(num){return 1-(Math.cos(Number(num)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var min=Number(arguments[0]),max=Number(arguments[1]);if(min>max){var _ref2=[max,min];min=_ref2[0],max=_ref2[1]}return Math.min(Math.max(this,min),max)}}),RegExp.escape||(_regExpMetaCharsRe=/[\\^$*+?.()|[\]{}]/g,_hasRegExpMetaCharsRe=new RegExp(_regExpMetaCharsRe.source),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(str){var val=String(str);return val&&_hasRegExpMetaCharsRe.test(val)?val.replace(_regExpMetaCharsRe,"\\$&"):val}})),_formatRegExp=/{(\d+)(?:,([+-]?\d+))?}/g,_hasFormatRegExp=new RegExp(_formatRegExp.source),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(format){function padString(str,align,pad){if(!align)return str;var plen=Math.abs(align)-str.length;if(plen<1)return str;var padding=String(pad).repeat(plen);return align<0?str+padding:padding+str}if(arguments.length<2)return 0===arguments.length?"":format;var args=2===arguments.length&&Array.isArray(arguments[1])?_toConsumableArray(arguments[1]):Array.prototype.slice.call(arguments,1);return 0===args.length?format:_hasFormatRegExp.test(format)?(_formatRegExp.lastIndex=0,format.replace(_formatRegExp,(function(match,index,align){var retval=args[index];if(null==retval)return"";for(;"function"==typeof retval;)retval=retval();switch(_typeof(retval)){case"string":break;case"object":retval=JSON.stringify(retval);break;default:retval=String(retval)}return padString(retval,align?Number.parseInt(align,10):0," ")}))):format}}),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return-1!==String.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var needle=String(arguments[0]||"");if(""===needle)return 0;for(var indexOf=String.prototype.indexOf,step=needle.length,pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,pos+=step;return count}}),Object.defineProperty(String.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.first called on null or undefined");return _getCodePointStartAndEnd(String(this),0).char}}),Object.defineProperty(String.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.last called on null or undefined");var str=String(this);return _getCodePointStartAndEnd(str,str.length-1).char}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(startAt,delCount,replacement){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var length=this.length>>>0;if(0===length)return"";var start=Number(startAt);Number.isSafeInteger(start)?start<0&&(start+=length)<0&&(start=0):start=0,start>length&&(start=length);var count=Number(delCount);(!Number.isSafeInteger(count)||count<0)&&(count=0);var res=this.slice(0,start);return void 0!==replacement&&(res+=replacement),start+count<length&&(res+=this.slice(start+count)),res}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd3=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd3.char,end=_getCodePointStartAnd3.end;return-1===end?"":char.toLocaleUpperCase()+str.slice(end+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd4=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd4.char,end=_getCodePointStartAnd4.end;return-1===end?"":char.toUpperCase()+str.slice(end+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","(".concat(this.toString(),")")]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",_toConsumableArray(this)]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",_toConsumableArray(this)]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(code,data){if("string"!=typeof code)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[code,data]]}}),Object.defineProperty(JSON,"_real_stringify",{value:JSON.stringify}),Object.defineProperty(JSON,"stringify",{configurable:!0,writable:!0,value:function(_value,replacer,space){return JSON._real_stringify(_value,(function(key,val){var value=val;if("function"==typeof replacer)try{value=replacer(key,value)}catch(ex){}return void 0===value&&(value=["(revive:eval)","undefined"]),value}),space)}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,(function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(ex){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(ex){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(ex){}return value}))}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.flat.call(this,1/0)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var match,re=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),names=[];null!==(match=re.exec(this));)match[1]?names.push(match[1]):match[2]&&names.push(match[2]);return names}})}();var Browser=(userAgent=navigator.userAgent.toLowerCase(),winPhone=userAgent.includes("windows phone"),isMobile=Object.freeze({Android:!winPhone&&userAgent.includes("android"),BlackBerry:/blackberry|bb10/.test(userAgent),iOS:!winPhone&&/ip(?:hone|ad|od)/.test(userAgent),Opera:!winPhone&&("object"===_typeof(window.operamini)||userAgent.includes("opera mini")),Windows:winPhone||/iemobile|wpdesktop/.test(userAgent),any:function(){return isMobile.Android||isMobile.BlackBerry||isMobile.iOS||isMobile.Opera||isMobile.Windows}}),isGecko=!isMobile.Windows&&!/khtml|trident|edge/.test(userAgent)&&userAgent.includes("gecko"),isIE=!userAgent.includes("opera")&&/msie|trident/.test(userAgent),ieVersion=isIE?(ver=/(?:msie\s+|rv:)(\d+\.\d)/.exec(userAgent))?Number(ver[1]):0:null,isOpera=userAgent.includes("opera")||userAgent.includes(" opr/"),operaVersion=isOpera?function(){var ver=new RegExp("".concat(/khtml|chrome/.test(userAgent)?"opr":"version","\\/(\\d+\\.\\d+)")).exec(userAgent);return ver?Number(ver[1]):0}():null,isVivaldi=userAgent.includes("vivaldi"),Object.freeze({userAgent:userAgent,isMobile:isMobile,isGecko:isGecko,isIE:isIE,ieVersion:ieVersion,isOpera:isOpera,operaVersion:operaVersion,isVivaldi:isVivaldi})),ver,userAgent,winPhone,isMobile,isGecko,isIE,ieVersion,isOpera,operaVersion,isVivaldi,Has=(hasAudioElement=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(ex){}return!1}(),hasFile=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(ex){}return!1}(),hasGeolocation=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(ex){}return!1}(),hasMutationObserver=function(){try{return"MutationObserver"in window&&"function"==typeof window.MutationObserver}catch(ex){}return!1}(),hasPerformance=function(){try{return"performance"in window&&"function"==typeof window.performance.now}catch(ex){}return!1}(),hasTouch=function(){try{return"ontouchstart"in window||!!window.DocumentTouch&&document instanceof window.DocumentTouch||!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints}catch(ex){}return!1}(),hasTransitionEndEvent=function(){try{for(var teMap=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),teKeys=_toConsumableArray(teMap.keys()),el=document.createElement("div"),i=0;i<teKeys.length;++i)if(el.style[teKeys[i]]!==undefined)return teMap.get(teKeys[i])}catch(ex){}return!1}(),Object.freeze({audio:hasAudioElement,fileAPI:hasFile,geolocation:hasGeolocation,mutationObserver:hasMutationObserver,performance:hasPerformance,touch:hasTouch,transitionEndEvent:hasTransitionEndEvent})),hasAudioElement,hasFile,hasGeolocation,hasMutationObserver,hasPerformance,hasTouch,hasTransitionEndEvent,Visibility=(vendor=function(){try{return Object.freeze([{hiddenProperty:"hidden",stateProperty:"visibilityState",changeEvent:"visibilitychange"},{hiddenProperty:"webkitHidden",stateProperty:"webkitVisibilityState",changeEvent:"webkitvisibilitychange"},{hiddenProperty:"mozHidden",stateProperty:"mozVisibilityState",changeEvent:"mozvisibilitychange"},{hiddenProperty:"msHidden",stateProperty:"msVisibilityState",changeEvent:"msvisibilitychange"}].find((function(vnd){return vnd.hiddenProperty in document})))}catch(ex){}return undefined}(),Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},state:{get:function(){return vendor&&document[vendor.stateProperty]||"visible"}},isEnabled:{value:function(){return Boolean(vendor)}},isHidden:{value:function(){return Boolean(vendor&&document[vendor.hiddenProperty])}},hiddenProperty:{value:vendor&&vendor.hiddenProperty},stateProperty:{value:vendor&&vendor.stateProperty},changeEvent:{value:vendor&&vendor.changeEvent}}))),vendor,Fullscreen=function(){var _hasPromise,vendor=function(){try{return Object.freeze([{isEnabled:"fullscreenEnabled",element:"fullscreenElement",requestFn:"requestFullscreen",exitFn:"exitFullscreen",changeEvent:"fullscreenchange",errorEvent:"fullscreenerror"},{isEnabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",requestFn:"webkitRequestFullscreen",exitFn:"webkitExitFullscreen",changeEvent:"webkitfullscreenchange",errorEvent:"webkitfullscreenerror"},{isEnabled:"mozFullScreenEnabled",element:"mozFullScreenElement",requestFn:"mozRequestFullScreen",exitFn:"mozCancelFullScreen",changeEvent:"mozfullscreenchange",errorEvent:"mozfullscreenerror"},{isEnabled:"msFullscreenEnabled",element:"msFullscreenElement",requestFn:"msRequestFullscreen",exitFn:"msExitFullscreen",changeEvent:"MSFullscreenChange",errorEvent:"MSFullscreenError"}].find((function(vnd){return vnd.isEnabled in document})))}catch(ex){}return undefined}(),_returnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,vendor)try{var value=document.exitFullscreen();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise});function _selectElement(requestedEl){var selectedEl=requestedEl||document.documentElement;return selectedEl===document.documentElement&&("msRequestFullscreen"===vendor.requestFn||Browser.isOpera&&Browser.operaVersion<15)&&(selectedEl=document.body),selectedEl}function isFullscreen(){return Boolean(vendor&&document[vendor.element])}function requestFullscreen(options,requestedEl){var _this=this;if(!vendor)return Promise.reject(new Error("fullscreen not supported"));var element=_selectElement(requestedEl);if("function"!=typeof element[vendor.requestFn])return Promise.reject(new Error("fullscreen not supported"));if(isFullscreen())return Promise.resolve();if(_returnsPromise())return element[vendor.requestFn](options);var namespace=".Fullscreen_requestFullscreen";return new Promise((function(resolve,reject){jQuery(element).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen request error")):resolve()})),element[vendor.requestFn](options)}))}function exitFullscreen(){var _this2=this;if(!vendor||"function"!=typeof document[vendor.exitFn])return Promise.reject(new TypeError("fullscreen not supported"));if(!isFullscreen())return Promise.reject(new TypeError("fullscreen mode not active"));if(_returnsPromise())return document[vendor.exitFn]();var namespace=".Fullscreen_exitFullscreen";return new Promise((function(resolve,reject){jQuery(document).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this2).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen exit error")):resolve()})),document[vendor.exitFn]()}))}return Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},element:{get:function(){return vendor?document[vendor.element]:null}},isEnabled:{value:function(){return Boolean(vendor&&document[vendor.isEnabled])}},isFullscreen:{value:isFullscreen},request:{value:requestFullscreen},exit:{value:exitFullscreen},toggle:{value:function(options,requestedEl){return isFullscreen()?exitFullscreen():requestFullscreen(options,requestedEl)}},onChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.changeEvent,handlerFn)}}},offChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.changeEvent,handlerFn):$(element).off(vendor.changeEvent)}}},onError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.errorEvent,handlerFn)}}},offError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.errorEvent,handlerFn):$(element).off(vendor.errorEvent)}}}}))}(),_ref3=Object.freeze(Object.defineProperties({},{clone:{value:function clone(orig){return"object"!==_typeof(orig)||null===orig?orig:orig instanceof String?String(orig):orig instanceof Number?Number(orig):orig instanceof Boolean?Boolean(orig):"function"==typeof orig.clone?orig.clone(!0):orig.nodeType&&"function"==typeof orig.cloneNode?orig.cloneNode(!0):(orig instanceof Array?copy=new Array(orig.length):orig instanceof Date?copy=new Date(orig.getTime()):orig instanceof Map?(copy=new Map,orig.forEach((function(val,key){return copy.set(key,clone(val))}))):orig instanceof RegExp?copy=new RegExp(orig):orig instanceof Set?(copy=new Set,orig.forEach((function(val){return copy.add(clone(val))}))):copy=Object.create(Object.getPrototypeOf(orig)),Object.keys(orig).forEach((function(name){return copy[name]=clone(orig[name])})),copy);var copy}},convertBreaks:{value:function(source){for(var node,output=document.createDocumentFragment(),para=document.createElement("p");null!==(node=source.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":if(null!==node.nextSibling&&node.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===node.nextSibling.nodeName.toUpperCase()){source.removeChild(node.nextSibling),source.removeChild(node),output.appendChild(para),para=document.createElement("p");continue}if(!para.hasChildNodes()){source.removeChild(node);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":para.hasChildNodes()&&(output.appendChild(para),para=document.createElement("p")),output.appendChild(node);continue}para.appendChild(node)}para.hasChildNodes()&&output.appendChild(para),source.appendChild(output)}},safeActiveElement:{value:function(){try{return document.activeElement||null}catch(ex){return null}}},setDisplayTitle:{value:function(title){if("string"!=typeof title)throw new TypeError("story display title must be a string (received: ".concat(Util.getType(title),")"));var render=document.createDocumentFragment();new Wikifier(render,title);var text=function(source){for(var node,copy=source.cloneNode(!0),frag=document.createDocumentFragment();null!==(node=copy.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":case"DIV":case"P":frag.appendChild(document.createTextNode(" "))}frag.appendChild(node)}return frag.textContent}(render).trim();document.title=Config.passages.displayTitles&&""!==State.passage&&State.passage!==Config.passages.start?"".concat(State.passage," | ").concat(text):text;var storyTitle=document.getElementById("story-title");null!==storyTitle&&jQuery(storyTitle).empty().append(render)}},setPageElement:{value:function(idOrElement,titles,defaultText){var el="object"===_typeof(idOrElement)?idOrElement:document.getElementById(idOrElement);if(null==el)return null;var ids=Array.isArray(titles)?titles:[titles];jQuery(el).empty();for(var i=0,iend=ids.length;i<iend;++i)if(Story.has(ids[i]))return new Wikifier(el,Story.get(ids[i]).processText().trim()),el;if(null!=defaultText){var text=String(defaultText).trim();""!==text&&new Wikifier(el,text)}return el}},throwError:{value:function(place,message,source){var $wrapper=jQuery(document.createElement("div")),$toggle=jQuery(document.createElement("button")),$source=jQuery(document.createElement("pre")),mesg="".concat(L10n.get("errorTitle"),": ").concat(message||"unknown error");return $toggle.addClass("error-toggle").ariaClick({label:L10n.get("errorToggle")},(function(){$toggle.hasClass("enabled")?($toggle.removeClass("enabled"),$source.attr({"aria-hidden":!0,hidden:"hidden"})):($toggle.addClass("enabled"),$source.removeAttr("aria-hidden hidden"))})).appendTo($wrapper),jQuery(document.createElement("span")).addClass("error").text(mesg).appendTo($wrapper),jQuery(document.createElement("code")).text(source).appendTo($source),$source.addClass("error-source").attr({"aria-hidden":!0,hidden:"hidden"}).appendTo($wrapper),$wrapper.addClass("error-view").appendTo(place),console.warn("".concat(mesg,"\n\t").concat(source.replace(/\n/g,"\n\t"))),!1}},stringFrom:{value:function stringFrom(value){switch(_typeof(value)){case"function":return"[function]";case"number":if(Number.isNaN(value))return"[number NaN]";break;case"object":if(null===value)return"[null]";if(value instanceof Array)return value.map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Set)return Array.from(value).map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Map){var result=Array.from(value).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2),key=_ref5[0],val=_ref5[1];return"".concat(stringFrom(key)," → ").concat(stringFrom(val))}));return"{ ".concat(result.join(", ")," }")}if(value instanceof Date)return value.toLocaleString();if(value instanceof Element){if(value===document.documentElement||value===document.head||value===document.body)throw new Error("illegal operation; attempting to convert the <html>, <head>, or <body> tags to string is not allowed");return value.outerHTML}return value instanceof Node?value.textContent:"function"==typeof value.toString?value.toString():Object.prototype.toString.call(value);case"symbol":var desc=void 0!==value.description?' "'.concat(value.description,'"'):"";return"[symbol".concat(desc,"]");case"undefined":return"[undefined]"}return String(value)}}})),clone=_ref3.clone,convertBreaks=_ref3.convertBreaks,safeActiveElement=_ref3.safeActiveElement,setDisplayTitle=_ref3.setDisplayTitle,setPageElement=_ref3.setPageElement,throwError=_ref3.throwError,stringFrom=_ref3.stringFrom;!function(){function onKeypressFn(ev){13!==ev.which&&32!==ev.which||(ev.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function onClickFnWrapper(fn){return function(){var $this=jQuery(this);$this.ariaIsDisabled()||($this.is("[aria-pressed]")&&$this.attr("aria-pressed","true"===$this.attr("aria-pressed")?"false":"true"),fn.apply(this,arguments))}}function oneClickFnWrapper(fn){return onClickFnWrapper((function(){jQuery(this).off(".aria-clickable").removeAttr("role tabindex aria-controls aria-pressed").filter("button").prop("disabled",!0),fn.apply(this,arguments)}))}jQuery.fn.extend({ariaClick:function(options,handler){if(0===this.length||0===arguments.length)return this;var opts=options,fn=handler;return null==fn&&(fn=opts,opts=undefined),"string"!=typeof(opts=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,role:undefined,controls:undefined,pressed:undefined,label:undefined},opts)).namespace?opts.namespace="":"."!==opts.namespace[0]&&(opts.namespace=".".concat(opts.namespace)),"boolean"==typeof opts.pressed&&(opts.pressed=opts.pressed?"true":"false"),this.filter("button").prop("type","button"),null!=opts.role?this.attr("role",opts.role):this.not("[role]").filter("a,[data-passage]").attr("role","link").end().not("a").not("[data-passage]").attr("role","button").end().end().end(),this.attr("tabindex",0),null!=opts.controls&&this.attr("aria-controls",opts.controls),null!=opts.pressed&&this.attr("aria-pressed",opts.pressed),null!=opts.label&&this.attr({"aria-label":opts.label,title:opts.label}),this.not("button").on("keypress.aria-clickable".concat(opts.namespace),opts.selector,onKeypressFn),this.on("click.aria-clickable".concat(opts.namespace),opts.selector,opts.data,opts.one?oneClickFnWrapper(fn):onClickFnWrapper(fn)),this},ariaDisabled:function(disable){if(0===this.length||0===arguments.length)return this;var $nonDisableable=this.not("button,fieldset,input,menuitem,optgroup,option,select,textarea"),$disableable=this.filter("button,fieldset,input,menuitem,optgroup,option,select,textarea");return disable?($nonDisableable.each((function(){this.setAttribute("disabled",""),this.setAttribute("aria-disabled","true")})),$disableable.each((function(){this.disabled=!0,this.setAttribute("aria-disabled","true")}))):($nonDisableable.each((function(){this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")})),$disableable.each((function(){this.disabled=!1,this.removeAttribute("aria-disabled")}))),this},ariaIsDisabled:function(){return this.is("[disabled]")}})}(),jQuery.extend({wikiWithOptions:function(options){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];if(0!==sources.length){var frag=document.createDocumentFragment();sources.forEach((function(content){return new Wikifier(frag,content,options)}));var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "))}},wiki:function(){for(var _len2=arguments.length,sources=new Array(_len2),_key2=0;_key2<_len2;_key2++)sources[_key2]=arguments[_key2];this.wikiWithOptions.apply(this,[undefined].concat(sources))}}),jQuery.fn.extend({wikiWithOptions:function(options){for(var _len3=arguments.length,sources=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)sources[_key3-1]=arguments[_key3];if(0===this.length||0===sources.length)return this;var frag=document.createDocumentFragment();return sources.forEach((function(content){return new Wikifier(frag,content,options)})),this.append(frag),this},wiki:function(){for(var _len4=arguments.length,sources=new Array(_len4),_key4=0;_key4<_len4;_key4++)sources[_key4]=arguments[_key4];return this.wikiWithOptions.apply(this,[undefined].concat(sources))}});var Util=function(){var toString,utilGetType="[object Object]"===(toString=Object.prototype.toString).call(new Map)?function(O){if(null===O)return"null";if(O instanceof Map)return"Map";if(O instanceof Set)return"Set";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType}:function(O){if(null===O)return"null";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType};function utilToEnum(obj){var pEnum=Object.create(null);if(obj instanceof Array)obj.forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Set)Array.from(obj).forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Map)obj.forEach((function(val,key){return pEnum[String(key)]=val}));else{if("object"!==_typeof(obj)||null===obj||Object.getPrototypeOf(obj)!==Object.prototype)throw new TypeError("Util.toEnum obj parameter must be an Array, Map, Set, or generic object");Object.assign(pEnum,obj)}return Object.freeze(pEnum)}function utilToStringTag(obj){return Object.prototype.toString.call(obj).slice(8,-1)}var _illegalSlugCharsRe=/[\x00-\x20!-/:-@[-^`{-\x9f]+/g,_isInvalidSlugRe=/^-*$/;var _illegalFilenameCharsRE=/[\x00-\x1f"#$%&'*+,/:;<=>?\\^`|\x7f-\x9f]+/g;var _markupCharsRe=/[!"#$&'*\-/<=>?@[\\\]^_`{|}~]/g,_hasMarkupCharsRe=new RegExp(_markupCharsRe.source),_markupCharsMap=utilToEnum({"!":"&#33;",'"':"&quot;","#":"&#35;",$:"&#36;","&":"&amp;","'":"&#39;","*":"&#42;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","?":"&#63;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;",_:"&#95;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"});var _htmlCharsRe=/[&<>"'`]/g,_hasHtmlCharsRe=new RegExp(_htmlCharsRe.source),_htmlCharsMap=utilToEnum({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"});function utilEscape(str){if(null==str)return"";var val=String(str);return val&&_hasHtmlCharsRe.test(val)?val.replace(_htmlCharsRe,(function(ch){return _htmlCharsMap[ch]})):val}var _escapedHtmlRe=/&(?:amp|#38|#x26|lt|#60|#x3c|gt|#62|#x3e|quot|#34|#x22|apos|#39|#x27|#96|#x60);/gi,_hasEscapedHtmlRe=new RegExp(_escapedHtmlRe.source,"i"),_escapedHtmlMap=utilToEnum({"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3c;":"<","&gt;":">","&#62;":">","&#x3e;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"});function utilUnescape(str){if(null==str)return"";var val=String(str);return val&&_hasEscapedHtmlRe.test(val)?val.replace(_escapedHtmlRe,(function(entity){return _escapedHtmlMap[entity.toLowerCase()]})):val}var _nowSource=Has.performance?performance:Date;var _cssTimeRe=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/;var utilScrubEventKey=function(){var separatorKey,decimalKey;if("undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat){var match=(new Intl.NumberFormat).format(111111.5).match(/(\D*)\d+(\D*)/);match&&(separatorKey=match[1],decimalKey=match[2])}return separatorKey||decimalKey||(separatorKey=",",decimalKey="."),function(key){switch(key){case"Scroll":return"ScrollLock";case"Spacebar":return" ";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Del":return"Delete";case"Crsel":return"CrSel";case"Exsel":return"ExSel";case"Esc":return"Escape";case"Apps":return"ContextMenu";case"Nonconvert":return"NonConvert";case"MediaNextTrack":return"MediaTrackNext";case"MediaPreviousTrack":return"MediaTrackPrevious";case"VolumeUp":return"AudioVolumeUp";case"VolumeDown":return"AudioVolumeDown";case"VolumeMute":return"AudioVolumeMute";case"Zoom":return"ZoomToggle";case"SelectMedia":case"MediaSelect":return"LaunchMediaPlayer";case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Decimal":return decimalKey;case"Separator":return separatorKey}return key}}(),utilHasMediaQuery="function"!=typeof window.matchMedia?function(){return!1}:function(mediaQuery){return window.matchMedia(mediaQuery).matches};return Object.freeze(Object.defineProperties({},{getType:{value:utilGetType},isBoolean:{value:function(obj){return"boolean"==typeof obj||"string"==typeof obj&&("true"===obj||"false"===obj)}},isIterable:{value:function(obj){return null!=obj&&"function"==typeof obj[Symbol.iterator]}},isNumeric:{value:function(obj){var num;switch(_typeof(obj)){case"number":num=obj;break;case"string":num=Number(obj);break;default:return!1}return!Number.isNaN(num)&&Number.isFinite(num)}},sameValueZero:{value:function(a,b){return a===b||a!=a&&b!=b}},toEnum:{value:utilToEnum},toStringTag:{value:utilToStringTag},slugify:{value:function(str){var base=String(str).trim(),_legacy=base.replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase();return _isInvalidSlugRe.test(_legacy)?base.replace(_illegalSlugCharsRe,"").replace(/[_\s\u2013\u2014-]+/g,"-"):_legacy}},sanitizeFilename:{value:function(str){return String(str).trim().replace(_illegalFilenameCharsRE,"")}},escapeMarkup:{value:function(str){if(null==str)return"";var val=String(str);return val&&_hasMarkupCharsRe.test(val)?val.replace(_markupCharsRe,(function(ch){return _markupCharsMap[ch]})):val}},escape:{value:utilEscape},unescape:{value:utilUnescape},charAndPosAt:{value:function(text,position){var str=String(text),pos=Math.trunc(position),code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};var retval={char:str.charAt(pos),start:pos,end:pos};if(code<55296||code>57343)return retval;if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)return retval;var nextCode=str.charCodeAt(nextPos);return nextCode<56320||nextCode>57343||(retval.char=retval.char+str.charAt(nextPos),retval.end=nextPos),retval}if(0===pos)return retval;var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);return prevCode<55296||prevCode>56319||(retval.char=str.charAt(prevPos)+retval.char,retval.start=prevPos),retval}},now:{value:function(){return _nowSource.now()}},fromCssTime:{value:function(cssTime){var match=_cssTimeRe.exec(String(cssTime));if(null===match)throw new SyntaxError('invalid time value syntax: "'.concat(cssTime,'"'));var msec=Number(match[1]);if(1===match[2].length&&(msec*=1e3),Number.isNaN(msec)||!Number.isFinite(msec))throw new RangeError('invalid time value: "'.concat(cssTime,'"'));return msec}},toCssTime:{value:function(msec){if("number"!=typeof msec||Number.isNaN(msec)||!Number.isFinite(msec)){var what;switch(_typeof(msec)){case"string":what='"'.concat(msec,'"');break;case"number":what=String(msec);break;default:what=utilToStringTag(msec)}throw new Error("invalid milliseconds: ".concat(what))}return"".concat(msec,"ms")}},fromCssProperty:{value:function(cssName){if(!cssName.includes("-"))switch(cssName){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return cssName}return("-ms-"===cssName.slice(0,4)?cssName.slice(1):cssName).split("-").map((function(part,i){return 0===i?part:part.toUpperFirst()})).join("")}},parseUrl:{value:function(url){var el=document.createElement("a"),queryObj=Object.create(null);el.href=url,el.search&&el.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach((function(query){var _query$split2=_slicedToArray(query.split("="),2),key=_query$split2[0],value=_query$split2[1];queryObj[key]=value}));var pathname=el.host&&"/"!==el.pathname[0]?"/".concat(el.pathname):el.pathname;return{href:el.href,protocol:el.protocol,host:el.host,hostname:el.hostname,port:el.port,path:"".concat(pathname).concat(el.search),pathname:pathname,query:el.search,search:el.search,queries:queryObj,searches:queryObj,hash:el.hash}}},newExceptionFrom:{value:function(original,exceptionType,override){if("object"!==_typeof(original)||null===original)throw new Error("Util.newExceptionFrom original parameter must be an object");if("function"!=typeof exceptionType)throw new Error("Util.newExceptionFrom exceptionType parameter must be an error type constructor");var ex=new exceptionType(original.message);void 0!==original.name&&(ex.name=original.name),void 0!==original.code&&(ex.code=original.code),void 0!==original.columnNumber&&(ex.columnNumber=original.columnNumber),void 0!==original.description&&(ex.description=original.description),void 0!==original.fileName&&(ex.fileName=original.fileName),void 0!==original.lineNumber&&(ex.lineNumber=original.lineNumber),void 0!==original.number&&(ex.number=original.number),void 0!==original.stack&&(ex.stack=original.stack);var overrideType=_typeof(override);if("undefined"!==overrideType)if("object"===overrideType&&null!==override)Object.assign(ex,override);else{if("string"!==overrideType)throw new Error("Util.newExceptionFrom override parameter must be an object or string");ex.message=override}return ex}},scrubEventKey:{value:utilScrubEventKey},hasMediaQuery:{value:utilHasMediaQuery},random:{value:Math.random},entityEncode:{value:utilEscape},entityDecode:{value:utilUnescape},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleStore=(_adapters=[],_initialized=null,Object.freeze(Object.defineProperties({},{adapters:{value:_adapters},create:{value:function(storageId,persistent){if(_initialized)return _initialized.create(storageId,persistent);for(var i=0;i<_adapters.length;++i)if(_adapters[i].init(storageId,persistent))return(_initialized=_adapters[i]).create(storageId,persistent);throw new Error("no valid storage adapters found")}}}))),_adapters,_initialized,_ok,_WebStorageAdapter;SimpleStore.adapters.push((_ok=!1,_WebStorageAdapter=function(){function _WebStorageAdapter(storageId,persistent){_classCallCheck(this,_WebStorageAdapter);var prefix="".concat(storageId,"."),engine=null,name=null;persistent?(engine=window.localStorage,name="localStorage"):(engine=window.sessionStorage,name="sessionStorage"),Object.defineProperties(this,{_engine:{value:engine},_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:name},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_WebStorageAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){for(var keys=[],i=0;i<this._engine.length;++i){var key=this._engine.key(i);this._prefixRe.test(key)&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&this._engine.hasOwnProperty(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=this._engine.getItem(this._prefix+key);return null==value?null:_WebStorageAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{this._engine.setItem(this._prefix+key,_WebStorageAdapter._serialize(value))}catch(ex){if(/quota.?(?:exceeded|reached)/i.test(ex.name+ex.message))throw Util.newExceptionFrom(ex,Error,"".concat(this.name," quota exceeded"));throw ex}return!0}},{key:"delete",value:function(key){return!("string"!=typeof key||!key||(this._engine.removeItem(this._prefix+key),0))}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_serialize",value:function(obj){return LZString.compressToUTF16(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromUTF16(str))}}]),_WebStorageAdapter}(),Object.freeze(Object.defineProperties({},{init:{value:function(){function hasWebStorage(storeId){try{var store=window[storeId],tid="_sc_".concat(String(Date.now()));store.setItem(tid,tid);var result=store.getItem(tid)===tid;return store.removeItem(tid),result}catch(ex){}return!1}return _ok=hasWebStorage("localStorage")&&hasWebStorage("sessionStorage")}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _WebStorageAdapter(storageId,persistent)}}})))),SimpleStore.adapters.push(function(){var _MAX_EXPIRY="Tue, 19 Jan 2038 03:14:07 GMT",_MIN_EXPIRY="Thu, 01 Jan 1970 00:00:00 GMT",_ok=!1,_CookieAdapter=function(){function _CookieAdapter(storageId,persistent){_classCallCheck(this,_CookieAdapter);var prefix="".concat(storageId).concat(persistent?"!":"*",".");Object.defineProperties(this,{_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:"cookie"},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_CookieAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){if(""===document.cookie)return[];for(var cookies=document.cookie.split(/;\s*/),keys=[],i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(this._prefixRe.test(key))""!==decodeURIComponent(kvPair[1])&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&null!==_CookieAdapter._getCookie(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=_CookieAdapter._getCookie(this._prefix+key);return null===value?null:_CookieAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,_CookieAdapter._serialize(value),this.persistent?"Tue, 19 Jan 2038 03:14:07 GMT":undefined),!this.has(key))throw new Error("unknown validation error during set")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"delete",value:function(key){if("string"!=typeof key||!key||!this.has(key))return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,undefined,_MIN_EXPIRY),this.has(key))throw new Error("unknown validation error during delete")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_getCookie",value:function(prefixedKey){if(!prefixedKey||""===document.cookie)return null;for(var cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("=");if(prefixedKey===decodeURIComponent(kvPair[0]))return decodeURIComponent(kvPair[1])||null}return null}},{key:"_setCookie",value:function(prefixedKey,value,expiry){if(prefixedKey){var payload="".concat(encodeURIComponent(prefixedKey),"=");null!=value&&(payload+=encodeURIComponent(value)),null!=expiry&&(payload+="; expires=".concat(expiry)),payload+="; path=/",document.cookie=payload}}},{key:"_serialize",value:function(obj){return LZString.compressToBase64(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromBase64(str))}}]),_CookieAdapter}();return Object.freeze(Object.defineProperties({},{init:{value:function(storageId){try{var tid="_sc_".concat(String(Date.now()));_CookieAdapter._setCookie(tid,_CookieAdapter._serialize(tid),undefined),_ok=_CookieAdapter._deserialize(_CookieAdapter._getCookie(tid))===tid,_CookieAdapter._setCookie(tid,undefined,_MIN_EXPIRY)}catch(ex){_ok=!1}return _ok&&function(storageId){if(""===document.cookie)return;for(var oldPrefix="".concat(storageId,"."),oldPrefixRe=new RegExp("^".concat(RegExp.escape(oldPrefix))),persistPrefix="".concat(storageId,"!."),sessionPrefix="".concat(storageId,"*."),sessionTestRe=/\.(?:state|rcWarn)$/,cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(oldPrefixRe.test(key)){var value=decodeURIComponent(kvPair[1]);""!==value&&function(){var persist=!sessionTestRe.test(key);_CookieAdapter._setCookie(key,undefined,_MIN_EXPIRY),_CookieAdapter._setCookie(key.replace(oldPrefixRe,(function(){return persist?persistPrefix:sessionPrefix})),value,persist?_MAX_EXPIRY:undefined)}()}}}(storageId),_ok}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _CookieAdapter(storageId,persistent)}}}))}());var DebugView=function(){function DebugView(parent,type,name,title){_classCallCheck(this,DebugView),Object.defineProperties(this,{parent:{value:parent},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:title,"aria-label":title,"data-type":null!=type?type:"","data-name":null!=name?name:""}).addClass("debug"),jQuery(this.break).addClass("debug hidden"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(DebugView,[{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(type){this.view.setAttribute("data-type",null!=type?type:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(name){this.view.setAttribute("data-name",null!=name?name:"")}},{key:"title",get:function(){return this.view.title},set:function(title){this.view.title=title}},{key:"append",value:function(el){return jQuery(this.view).append(el),this}},{key:"modes",value:function(options){if(null==options){var current={};return this.view.className.splitOrEmpty(/\s+/).forEach((function(name){"debug"!==name&&(current[name]=!0)})),current}if("object"===_typeof(options))return Object.keys(options).forEach((function(name){this[options[name]?"addClass":"removeClass"](name)}),jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var $view=jQuery(this.view);this.view.hasChildNodes()&&$view.contents().appendTo(this.parent),$view.remove(),jQuery(this.break).remove()}}],[{key:"isEnabled",value:function(){return"enabled"===jQuery(document.documentElement).attr("data-debug-view")}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),jQuery.event.trigger(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),jQuery.event.trigger(":debugviewupdate")}},{key:"toggle",value:function(){"enabled"===jQuery(document.documentElement).attr("data-debug-view")?DebugView.disable():DebugView.enable()}}]),DebugView}(),NodeTyper=function(){var NodeTyper=function(){function NodeTyper(config){if(_classCallCheck(this,NodeTyper),"object"!==_typeof(config)||null===config)throw new Error("config parameter must be an object (received: ".concat(Util.getType(config),")"));if(!(config.hasOwnProperty("targetNode")&&config.targetNode instanceof Node))throw new Error('config parameter object "targetNode" property must be a node');Object.defineProperties(this,{node:{value:config.targetNode},childNodes:{value:[]},nodeValue:{writable:!0,value:""},appendTo:{writable:!0,value:config.parentNode||null},classNames:{writable:!0,value:config.classNames||null},finished:{writable:!0,value:!1}});var childNode,node=this.node;for(node.nodeValue&&(this.nodeValue=node.nodeValue,node.nodeValue="");null!==(childNode=node.firstChild);)this.childNodes.push(new NodeTyper({targetNode:childNode,parentNode:node,classNames:this.classNames})),node.removeChild(childNode)}return _createClass(NodeTyper,[{key:"finish",value:function(){for(;this.type(!0););return!1}},{key:"type",value:function(flush){if(this.finished)return!1;if(this.appendTo){if(this.appendTo.appendChild(this.node),this.appendTo=null,this.node.nodeType!==Node.ELEMENT_NODE&&this.node.nodeType!==Node.TEXT_NODE||"none"===jQuery(this.node.parentNode).css("display"))return this.finish();this.node.parentNode&&this.classNames&&jQuery(this.node.parentNode).addClass(this.classNames)}if(this.nodeValue){if(flush)this.node.nodeValue+=this.nodeValue,this.nodeValue="";else{var _Util$charAndPosAt=Util.charAndPosAt(this.nodeValue,0),char=_Util$charAndPosAt.char,start=_Util$charAndPosAt.start,end=_Util$charAndPosAt.end;this.node.nodeValue+=char,this.nodeValue=this.nodeValue.slice(1+end-start)}return!0}this.classNames&&(jQuery(this.node.parentNode).removeClass(this.classNames),this.classNames=null);for(var childNodes=this.childNodes;childNodes.length>0;){if(childNodes[0].type())return!0;childNodes.shift()}return this.finished=!0,!1}}]),NodeTyper}();return NodeTyper}(),PRNGWrapper=function(){function PRNGWrapper(seed,useEntropy){_classCallCheck(this,PRNGWrapper),Object.defineProperties(this,new Math.seedrandom(seed,useEntropy,(function(prng,seed){return{_prng:{value:prng},seed:{writable:!0,value:seed},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}})))}return _createClass(PRNGWrapper,null,[{key:"marshal",value:function(prng){if(!prng||!prng.hasOwnProperty("seed")||!prng.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:prng.seed,pull:prng.pull}}},{key:"unmarshal",value:function(prngObj){if(!prngObj||!prngObj.hasOwnProperty("seed")||!prngObj.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var prng=new PRNGWrapper(prngObj.seed,!1),i=prngObj.pull;i>0;--i)prng.random();return prng}}]),PRNGWrapper}(),StyleWrapper=(_imageMarkupRe=new RegExp(Patterns.cssImage,"g"),_hasImageMarkupRe=new RegExp(Patterns.cssImage),function(){function StyleWrapper(style){if(_classCallCheck(this,StyleWrapper),null==style)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:style}})}return _createClass(StyleWrapper,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(rawCss){this.clear(),this.add(rawCss)}},{key:"add",value:function(rawCss){var css=rawCss;_hasImageMarkupRe.test(css)&&(_imageMarkupRe.lastIndex=0,css=css.replace(_imageMarkupRe,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text.trim())}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),this.style.styleSheet?this.style.styleSheet.cssText+=css:this.style.appendChild(document.createTextNode(css))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),StyleWrapper}()),_imageMarkupRe,_hasImageMarkupRe,Diff=(Op=Util.toEnum({Delete:0,SpliceArray:1,Copy:2,CopyDate:3}),Object.freeze(Object.defineProperties({},{Op:{value:Op},diff:{value:function diff(orig,dest){for(var aOpRef,objToString=Object.prototype.toString,origIsArray=orig instanceof Array,keys=[].concat(Object.keys(orig),Object.keys(dest)).sort().filter((function(val,i,arr){return 0===i||arr[i-1]!==val})),diffed={},keyIsAOpRef=function(key){return key===aOpRef},i=0,klen=keys.length;i<klen;++i){var key=keys[i],origP=orig[key],destP=dest[key];if(orig.hasOwnProperty(key))if(dest.hasOwnProperty(key)){if(origP===destP)continue;if(_typeof(origP)===_typeof(destP))if("function"==typeof origP)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,destP]);else if("object"!==_typeof(origP)||null===origP)diffed[key]=[Op.Copy,destP];else{var origPType=objToString.call(origP);if(origPType===objToString.call(destP))if(origP instanceof Date)Number(origP)!==Number(destP)&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Map)diffed[key]=[Op.Copy,clone(destP)];else if(origP instanceof RegExp)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Set)diffed[key]=[Op.Copy,clone(destP)];else if("[object Object]"!==origPType)diffed[key]=[Op.Copy,clone(destP)];else{var recurse=diff(origP,destP);null!==recurse&&(diffed[key]=recurse)}else diffed[key]=[Op.Copy,clone(destP)]}else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}else if(origIsArray&&Util.isNumeric(key)){var nKey=Number(key);if(!aOpRef){aOpRef="";do{aOpRef+="~"}while(keys.some(keyIsAOpRef));diffed[aOpRef]=[Op.SpliceArray,nKey,nKey]}nKey<diffed[aOpRef][1]&&(diffed[aOpRef][1]=nKey),nKey>diffed[aOpRef][2]&&(diffed[aOpRef][2]=nKey)}else diffed[key]=Op.Delete;else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}return Object.keys(diffed).length>0?diffed:null}},patch:{value:function patch(orig,diffed){for(var keys=Object.keys(diffed||{}),patched=clone(orig),i=0,klen=keys.length;i<klen;++i){var key=keys[i],diffedP=diffed[key];if(diffedP===Op.Delete)delete patched[key];else if(diffedP instanceof Array)switch(diffedP[0]){case Op.SpliceArray:patched.splice(diffedP[1],diffedP[2]-diffedP[1]+1);break;case Op.Copy:patched[key]=clone(diffedP[1]);break;case Op.CopyDate:patched[key]=new Date(diffedP[1])}else patched[key]=patch(patched[key],diffedP)}return patched}}}))),Op,L10n=(_patternRe=/\{\w+\}/g,_hasPatternRe=new RegExp(_patternRe.source),Object.freeze(Object.defineProperties({},{init:{value:function(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach((function(id){try{var value;switch(id){case"identity":value=strings.identity;break;case"aborting":value=strings.aborting;break;case"cancel":value=strings.cancel;break;case"close":value=strings.close;break;case"ok":value=strings.ok;break;case"errorTitle":value=strings.errors.title;break;case"errorNonexistentPassage":value=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":value=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":value=strings.errors.saveIdMismatch;break;case"warningDegraded":value=strings.warnings.degraded;break;case"debugViewTitle":value=strings.debugView.title;break;case"debugViewToggle":value=strings.debugView.toggle;break;case"uiBarToggle":value=strings.uiBar.toggle;break;case"uiBarBackward":value=strings.uiBar.backward;break;case"uiBarForward":value=strings.uiBar.forward;break;case"uiBarJumpto":value=strings.uiBar.jumpto;break;case"jumptoTitle":value=strings.jumpto.title;break;case"jumptoTurn":value=strings.jumpto.turn;break;case"jumptoUnavailable":value=strings.jumpto.unavailable;break;case"savesTitle":value=strings.saves.title;break;case"savesDisallowed":value=strings.saves.disallowed;break;case"savesIncapable":value=strings.saves.incapable;break;case"savesLabelAuto":value=strings.saves.labelAuto;break;case"savesLabelDelete":value=strings.saves.labelDelete;break;case"savesLabelExport":value=strings.saves.labelExport;break;case"savesLabelImport":value=strings.saves.labelImport;break;case"savesLabelLoad":value=strings.saves.labelLoad;break;case"savesLabelClear":value=strings.saves.labelClear;break;case"savesLabelSave":value=strings.saves.labelSave;break;case"savesLabelSlot":value=strings.saves.labelSlot;break;case"savesUnavailable":value=strings.saves.unavailable;break;case"savesUnknownDate":value=strings.saves.unknownDate;break;case"settingsTitle":value=strings.settings.title;break;case"settingsOff":value=strings.settings.off;break;case"settingsOn":value=strings.settings.on;break;case"settingsReset":value=strings.settings.reset;break;case"restartTitle":value=strings.restart.title;break;case"restartPrompt":value=strings.restart.prompt;break;case"shareTitle":value=strings.share.title;break;case"alertTitle":break;case"autoloadTitle":value=strings.autoload.title;break;case"autoloadCancel":value=strings.autoload.cancel;break;case"autoloadOk":value=strings.autoload.ok;break;case"autoloadPrompt":value=strings.autoload.prompt;break;case"macroBackText":value=strings.macros.back.text;break;case"macroReturnText":value=strings.macros.return.text}value&&(l10nStrings[id]=value.replace(/%\w+%/g,(function(pat){return"{".concat(pat.slice(1,-1),"}")})))}catch(ex){}}))}},get:{value:function(ids,overrides){if(!ids)return"";var selectedId,id=((Array.isArray(ids)?ids:[ids]).some((function(id){return!!l10nStrings.hasOwnProperty(id)&&(selectedId=id,!0)})),selectedId);if(!id)return"";for(var processed=l10nStrings[id],iteration=0;_hasPatternRe.test(processed);){if(++iteration>50)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");_patternRe.lastIndex=0,processed=processed.replace(_patternRe,(function(pat){var subId=pat.slice(1,-1);return overrides&&overrides.hasOwnProperty(subId)?overrides[subId]:l10nStrings.hasOwnProperty(subId)?l10nStrings[subId]:void 0}))}return processed}}}))),_patternRe,_hasPatternRe,strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorToggle:"Toggle the error view",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveDiskLoadFailed:"failed to load save file from disk",errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugBarToggle:"Toggle the debug bar",debugBarNoWatches:"— no watches set —",debugBarAddWatch:"Add watch",debugBarDeleteWatch:"Delete watch",debugBarWatchAll:"Watch all",debugBarWatchNone:"Delete all",debugBarLabelAdd:"Add",debugBarLabelWatch:"Watch",debugBarLabelTurn:"Turn",debugBarLabelViews:"Views",debugBarViewsToggle:"Toggle the debug views",debugBarWatchToggle:"Toggle the watch panel",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",alertTitle:"Alert",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=(_debug=!1,_addVisitedLinkClass=!1,_cleanupWikifierOutput=!1,_loadDelay=0,_audioPauseOnFadeToZero=!0,_audioPreloadMetadata=!0,_historyControls=!0,_historyMaxStates=40,_macrosIfAssignmentError=!0,_macrosMaxLoopIterations=1e3,_macrosTypeSkipKey=" ",_macrosTypeVisitedPassages=!0,_passagesDisplayTitles=!1,_passagesNobr=!1,_savesId="untitled-story",_savesSlots=8,_savesTryDiskOnMobile=!0,_uiStowBarInitially=800,_uiUpdateStoryElements=!0,_errHistoryModeDeprecated="Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code",Object.freeze({get debug(){return _debug},set debug(value){_debug=Boolean(value)},get addVisitedLinkClass(){return _addVisitedLinkClass},set addVisitedLinkClass(value){_addVisitedLinkClass=Boolean(value)},get cleanupWikifierOutput(){return _cleanupWikifierOutput},set cleanupWikifierOutput(value){_cleanupWikifierOutput=Boolean(value)},get loadDelay(){return _loadDelay},set loadDelay(value){if(!Number.isSafeInteger(value)||value<0)throw new RangeError("Config.loadDelay must be a non-negative integer");_loadDelay=value},audio:Object.freeze({get pauseOnFadeToZero(){return _audioPauseOnFadeToZero},set pauseOnFadeToZero(value){_audioPauseOnFadeToZero=Boolean(value)},get preloadMetadata(){return _audioPreloadMetadata},set preloadMetadata(value){_audioPreloadMetadata=Boolean(value)}}),history:Object.freeze({get controls(){return _historyControls},set controls(value){var controls=Boolean(value);if(1===_historyMaxStates&&controls)throw new Error("Config.history.controls must be false when Config.history.maxStates is 1");_historyControls=controls},get maxStates(){return _historyMaxStates},set maxStates(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.history.maxStates must be a positive integer");_historyMaxStates=value,_historyControls&&1===value&&(_historyControls=!1)},get mode(){throw new Error(_errHistoryModeDeprecated)},set mode(_){throw new Error(_errHistoryModeDeprecated)},get tracking(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")},set tracking(_){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}}),macros:Object.freeze({get ifAssignmentError(){return _macrosIfAssignmentError},set ifAssignmentError(value){_macrosIfAssignmentError=Boolean(value)},get maxLoopIterations(){return _macrosMaxLoopIterations},set maxLoopIterations(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.macros.maxLoopIterations must be a positive integer");_macrosMaxLoopIterations=value},get typeSkipKey(){return _macrosTypeSkipKey},set typeSkipKey(value){_macrosTypeSkipKey=String(value)},get typeVisitedPassages(){return _macrosTypeVisitedPassages},set typeVisitedPassages(value){_macrosTypeVisitedPassages=Boolean(value)}}),navigation:Object.freeze({get override(){return _navigationOverride},set override(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.navigation.override must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_navigationOverride=value}}),passages:Object.freeze({get descriptions(){return _passagesDescriptions},set descriptions(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"Object"!==valueType&&"function"!==valueType)throw new TypeError("Config.passages.descriptions must be a boolean, object, function, or null/undefined (received: ".concat(valueType,")"))}_passagesDescriptions=value},get displayTitles(){return _passagesDisplayTitles},set displayTitles(value){_passagesDisplayTitles=Boolean(value)},get nobr(){return _passagesNobr},set nobr(value){_passagesNobr=Boolean(value)},get onProcess(){return _passagesOnProcess},set onProcess(value){if(null!=value){var valueType=Util.getType(value);if("function"!==valueType)throw new TypeError("Config.passages.onProcess must be a function or null/undefined (received: ".concat(valueType,")"))}_passagesOnProcess=value},get start(){return _passagesStart},set start(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType)throw new TypeError("Config.passages.start must be a string or null/undefined (received: ".concat(valueType,")"))}_passagesStart=value},get transitionOut(){return _passagesTransitionOut},set transitionOut(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.passages.transitionOut must be a string, non-negative integer, or null/undefined (received: ".concat(valueType,")"))}_passagesTransitionOut=value}}),saves:Object.freeze({get autoload(){return _savesAutoload},set autoload(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"string"!==valueType&&"function"!==valueType)throw new TypeError("Config.saves.autoload must be a boolean, string, function, or null/undefined (received: ".concat(valueType,")"))}_savesAutoload=value},get autosave(){return _savesAutosave},set autosave(value){if(null!=value){var valueType=Util.getType(value);if("string"===valueType)return void(_savesAutosave=[value]);if("boolean"!==valueType&&("Array"!==valueType||!value.every((function(item){return"string"==typeof item})))&&"function"!==valueType)throw new TypeError("Config.saves.autosave must be a boolean, Array<string>, function, or null/undefined (received: ".concat(valueType).concat("Array"===valueType?"<any>":"",")"))}_savesAutosave=value},get id(){return _savesId},set id(value){if("string"!=typeof value||""===value)throw new TypeError("Config.saves.id must be a non-empty string (received: ".concat(Util.getType(value),")"));_savesId=value},get isAllowed(){return _savesIsAllowed},set isAllowed(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.isAllowed must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_savesIsAllowed=value},get slots(){return _savesSlots},set slots(value){if(!Number.isSafeInteger(value)||value<0)throw new TypeError("Config.saves.slots must be a non-negative integer (received: ".concat(Util.getType(value),")"));_savesSlots=value},get tryDiskOnMobile(){return _savesTryDiskOnMobile},set tryDiskOnMobile(value){_savesTryDiskOnMobile=Boolean(value)},get version(){return _savesVersion},set version(value){_savesVersion=value},get onLoad(){throw new Error("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead")},set onLoad(value){console.warn("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead"),Save.onLoad.add(value)},get onSave(){throw new Error("Config.saves.onSave has been deprecated, use the Save.onSave API instead")},set onSave(value){console.warn("Config.saves.onSave has been deprecated, use the Save.onSave API instead"),Save.onSave.add(value)}}),ui:Object.freeze({get stowBarInitially(){return _uiStowBarInitially},set stowBarInitially(value){var valueType=Util.getType(value);if("boolean"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.ui.stowBarInitially must be a boolean or non-negative integer (received: ".concat(valueType,")"));_uiStowBarInitially=value},get updateStoryElements(){return _uiUpdateStoryElements},set updateStoryElements(value){_uiUpdateStoryElements=Boolean(value)}})})),_navigationOverride,_passagesDescriptions,_passagesStart,_passagesOnProcess,_passagesTransitionOut,_savesAutoload,_savesAutosave,_savesIsAllowed,_savesVersion,_debug,_addVisitedLinkClass,_cleanupWikifierOutput,_loadDelay,_audioPauseOnFadeToZero,_audioPreloadMetadata,_historyControls,_historyMaxStates,_macrosIfAssignmentError,_macrosMaxLoopIterations,_macrosTypeSkipKey,_macrosTypeVisitedPassages,_passagesDisplayTitles,_passagesNobr,_savesId,_savesSlots,_savesTryDiskOnMobile,_uiStowBarInitially,_uiUpdateStoryElements,_errHistoryModeDeprecated,SimpleAudio=function(){var _hasPromise,_gestureEventNames=Object.freeze(["click","contextmenu","dblclick","keyup","mouseup","pointerup","touchend"]),_specialIds=Object.freeze([":not",":all",":looped",":muted",":paused",":playing"]),_formatSpecRe=/^([\w-]+)\s*\|\s*(\S.*)$/,_badIdRe=/[:\s]/,_tracks=new Map,_groups=new Map,_lists=new Map,_subscribers=new Map,_masterRate=1,_masterVolume=1,_masterMute=!1,_masterMuteOnHidden=!1,_playReturnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,Has.audio)try{var audio=document.createElement("audio");audio.muted=!0;var value=audio.play();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise}),AudioTrack=function(){function AudioTrack(obj){if(_classCallCheck(this,AudioTrack),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioTrack))throw new Error("sources parameter must be either an array, of URIs or source objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioTrack,[{key:"_create",value:function(sourceList){var dataUriRe=/^data:\s*audio\/(?:x-)?([^;,]+)\s*[;,]/i,extRe=/\.([^./\\]+)$/,formats=AudioTrack.formats,usedSources=[],audio=document.createElement("audio");audio.preload="none",sourceList.forEach((function(src){var srcUri=null;switch(_typeof(src)){case"string":var match;if("data:"===src.slice(0,5)){if(null===(match=dataUriRe.exec(src)))throw new Error("source data URI missing media type")}else if(null===(match=extRe.exec(Util.parseUrl(src).pathname)))throw new Error("source URL missing file extension");formats[match[1]]&&(srcUri=src);break;case"object":if(null===src)throw new Error("source object cannot be null");if(!src.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!src.hasOwnProperty("format"))throw new Error('source object missing required "format" property');formats[src.format]&&(srcUri=src.src);break;default:throw new Error("invalid source value (type: ".concat(_typeof(src),")"))}if(null!==srcUri){var source=document.createElement("source");source.src=srcUri,audio.appendChild(source),usedSources.push(srcUri)}})),audio.hasChildNodes()&&Config.audio.preloadMetadata&&(audio.preload="metadata"),this._finalize(audio,usedSources,clone(sourceList))}},{key:"_copy",value:function(obj){this._finalize(obj.audio.cloneNode(!0),clone(obj.sources),clone(obj.originals))}},{key:"_finalize",value:function(audio,sources,originals){var _this3=this;Object.defineProperties(this,{audio:{configurable:!0,value:audio},sources:{value:Object.freeze(sources)},originals:{value:Object.freeze(originals)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart.AudioTrack",(function(){return _this3._error=!1})).on("error.AudioTrack",(function(){return _this3._error=!0})).find("source:last-of-type").on("error.AudioTrack",(function(){return _this3._trigger("error")})),function(id,callback){if("function"!=typeof callback)throw new Error("callback parameter must be a function");_subscribers.set(id,callback)}(this,(function(mesg){if(_this3.audio)switch(mesg){case"loadwithscreen":if(_this3.hasSource()){var lockId=LoadScreen.lock();_this3.one("canplaythrough.AudioTrack_loadwithscreen error.AudioTrack_loadwithscreen",(function(){jQuery(this).off(".AudioTrack_loadwithscreen"),LoadScreen.unlock(lockId)})).load()}break;case"load":_this3.load();break;case"mute":_this3._updateAudioMute();break;case"rate":_this3._updateAudioRate();break;case"stop":_this3.stop();break;case"volume":_this3._updateAudioVolume();break;case"unload":_this3.unload()}else unsubscribe(_this3)})),this._updateAudioMute(),this._updateAudioRate(),this._updateAudioVolume()}},{key:"_trigger",value:function(eventName){jQuery(this.audio).triggerHandler(eventName)}},{key:"_destroy",value:function(){unsubscribe(this),this.audio&&(jQuery(this.audio).off(),this.unload(),this._error=!0,delete this.audio)}},{key:"clone",value:function(){return new AudioTrack(this)}},{key:"load",value:function(){var _this4=this;if(this.fadeStop(),this.audio.pause(),!this.audio.hasChildNodes()){if(0===this.sources.length)return;this.sources.forEach((function(srcUri){var source=document.createElement("source");source.src=srcUri,_this4.audio.appendChild(source)}))}"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"unload",value:function(){this.fadeStop(),this.stop();var audio=this.audio;for(audio.preload="none";audio.hasChildNodes();)audio.removeChild(audio.firstChild);audio.load()}},{key:"play",value:function(){var _this5=this;if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));"auto"!==this.audio.preload&&(this.audio.preload="auto");var namespace=".AudioTrack_play";return _playReturnsPromise()?this.audio.play():new Promise((function(resolve,reject){_this5.isPlaying()?resolve():(jQuery(_this5.audio).off(namespace).one("error".concat(namespace," playing").concat(namespace," timeupdate").concat(namespace),(function(ev){jQuery(_this5).off(namespace),"error"===ev.type?reject(new Error("unknown audio play error")):resolve()})),_this5.audio.play())}))}},{key:"playWhenAllowed",value:function(){var _this6=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioTrack_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioTrack_playWhenAllowed"),_this6.audio.play()}))}))}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time(0),this._trigger(":stopped")}},{key:"fade",value:function(duration,toVol,fromVol){var _this7=this;if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));this.fadeStop();var from=Math.clamp(null==fromVol?this.volume():fromVol,0,1),to=Math.clamp(toVol,0,1);return from!==to?(this.volume(from),jQuery(this.audio).off("timeupdate.AudioTrack_fade").one("timeupdate.AudioTrack_fade",(function(){var min,max;from<to?(min=from,max=to):(min=to,max=from);var time=Math.max(duration,1),delta=(to-from)/(time/.025);_this7._trigger(":fading"),_this7._faderId=setInterval((function(){_this7.isPlaying()?(_this7.volume(Math.clamp(_this7.volume()+delta,min,max)),Config.audio.pauseOnFadeToZero&&0===_this7.volume()&&_this7.pause(),_this7.volume()===to&&(_this7.fadeStop(),_this7._trigger(":faded"))):_this7.fadeStop()}),25)})),this.play()):void 0}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"loop",value:function(_loop){return null==_loop?this.audio.loop:(this.audio.loop=!!_loop,this)}},{key:"mute",value:function(_mute){return null==_mute?this._mute:(this._mute=!!_mute,this._updateAudioMute(),this)}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||_masterMute}},{key:"rate",value:function(_rate){if(null==_rate)return this._rate;if("number"!=typeof _rate)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate,.2,5),this._updateAudioRate(),this}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=Math.clamp(this._rate*_masterRate,.2,5)}},{key:"time",value:function(_time){var _this8=this;if(null==_time)return this.audio.currentTime;if("number"!=typeof _time)throw new TypeError("time parameter must be a number");return this.hasMetadata()?this.audio.currentTime=_time:jQuery(this.audio).off("loadedmetadata.AudioTrack_time").one("loadedmetadata.AudioTrack_time",(function(){return _this8.audio.currentTime=_time})),this}},{key:"volume",value:function(_volume){if(null==_volume)return this._volume;if("number"!=typeof _volume)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume,0,1),this._updateAudioVolume(),this}},{key:"_updateAudioVolume",value:function(){this.audio.volume=Math.clamp(this._volume*_masterVolume,0,1)}},{key:"duration",value:function(){return this.audio.duration}},{key:"remaining",value:function(){return this.audio.duration-this.audio.currentTime}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isUnloaded",value:function(){return!this.audio.hasChildNodes()}},{key:"isUnavailable",value:function(){return!this.hasSource()||this.isUnloaded()||this.isFailed()}},{key:"isPlaying",value:function(){return!this.audio.paused&&this.hasSomeData()}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isStopped",value:function(){return this.audio.paused&&0===this.audio.currentTime}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isSeeking",value:function(){return this.audio.seeking}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"on",value:function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return jQuery.fn.on.apply(jQuery(this.audio),args),this}},{key:"one",value:function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return jQuery.fn.one.apply(jQuery(this.audio),args),this}},{key:"off",value:function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return jQuery.fn.off.apply(jQuery(this.audio),args),this}}]),AudioTrack}();Object.defineProperties(AudioTrack,{formats:{value:function(){var audio=document.createElement("audio"),types=new Map;function canPlay(mimeType){return types.has(mimeType)||types.set(mimeType,""!==audio.canPlayType(mimeType).replace(/^no$/i,"")),types.get(mimeType)}return Object.assign(Object.create(null),{aac:canPlay("audio/aac"),caf:canPlay("audio/x-caf")||canPlay("audio/caf"),flac:canPlay("audio/x-flac")||canPlay("audio/flac"),mp3:canPlay('audio/mpeg; codecs="mp3"')||canPlay("audio/mpeg")||canPlay("audio/mp3")||canPlay("audio/mpa"),mpeg:canPlay("audio/mpeg"),m4a:canPlay("audio/x-m4a")||canPlay("audio/m4a")||canPlay("audio/aac"),mp4:canPlay("audio/x-mp4")||canPlay("audio/mp4")||canPlay("audio/aac"),ogg:canPlay("audio/ogg"),oga:canPlay("audio/ogg"),opus:canPlay('audio/ogg; codecs="opus"')||canPlay("audio/opus"),wav:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),wave:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),weba:canPlay("audio/webm"),webm:canPlay("audio/webm")})}()}});var AudioList=function(){function AudioList(obj){if(_classCallCheck(this,AudioList),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioList))throw new Error("tracks parameter must be either an array, of track objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioList,[{key:"_create",value:function(trackList){var _this9=this;this._finalize(trackList.map((function(trackObj){if("object"!==_typeof(trackObj))throw new Error("tracks parameter array members must be objects");var own,rate,track,volume;if(trackObj instanceof AudioTrack)own=!0,rate=trackObj.rate(),track=trackObj.clone(),volume=trackObj.volume();else{if(!trackObj.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(trackObj.track instanceof AudioTrack))throw new Error('track object\'s "track" property must be an AudioTrack object');own=trackObj.hasOwnProperty("own")&&trackObj.own,rate=trackObj.hasOwnProperty("rate")?trackObj.rate:trackObj.track.rate(),track=trackObj.track,volume=trackObj.hasOwnProperty("volume")?trackObj.volume:trackObj.track.volume()}return track.stop(),track.loop(!1),track.mute(!1),track.rate(rate),track.volume(volume),track.on("ended.AudioList",(function(){return _this9._onEnd()})),{own:own,track:track,volume:volume,rate:rate}})))}},{key:"_copy",value:function(obj){this._finalize(clone(obj.tracks))}},{key:"_finalize",value:function(tracks){Object.defineProperties(this,{tracks:{configurable:!0,value:Object.freeze(tracks)},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}})}},{key:"_destroy",value:function(){this.stop(),this.tracks.filter((function(trackObj){return trackObj.own})).forEach((function(trackObj){return trackObj.track._destroy()})),delete this.tracks,delete this.queue}},{key:"load",value:function(){this.tracks.forEach((function(trackObj){return trackObj.track.load()}))}},{key:"unload",value:function(){this.stop(),this.tracks.forEach((function(trackObj){return trackObj.track.unload()}))}},{key:"play",value:function(){return null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||(0===this.queue.length&&this._fillQueue(),this._next())?this.current.track.play():Promise.reject(new Error("no tracks were available"))}},{key:"playWhenAllowed",value:function(){var _this10=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioList_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioList_playWhenAllowed"),_this10.play()}))}))}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this._drainQueue()}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fade",value:function(duration,toVol,fromVol){if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(0===this.queue.length&&this._fillQueue(),null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||this._next()){var adjFromVol,adjToVol=Math.clamp(toVol,0,1)*this.current.volume;return null!=fromVol&&(adjFromVol=Math.clamp(fromVol,0,1)*this.current.volume),this._volume=toVol,this.current.track.fade(duration,adjToVol,adjFromVol)}}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this.current&&this.current.track.fadeStop()}},{key:"loop",value:function(_loop2){return null==_loop2?this._loop:(this._loop=!!_loop2,this)}},{key:"mute",value:function(_mute2){return null==_mute2?this._mute:(this._mute=!!_mute2,null!==this.current&&this.current.track.mute(this._mute),this)}},{key:"rate",value:function(_rate2){if(null==_rate2)return this._rate;if("number"!=typeof _rate2)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate2,.2,5),null!==this.current&&this.current.track.rate(this._rate*this.current.rate),this}},{key:"shuffle",value:function(_shuffle){var _this11=this;if(null==_shuffle)return this._shuffle;if(this._shuffle=!!_shuffle,this.queue.length>0&&(this._fillQueue(),!this._shuffle&&null!==this.current&&this.queue.length>1)){var _this$queue,firstIdx=this.queue.findIndex((function(trackObj){return trackObj===_this11.current}));if(-1!==firstIdx)(_this$queue=this.queue).push.apply(_this$queue,_toConsumableArray(this.queue.splice(0,firstIdx+1)))}return this}},{key:"volume",value:function(_volume2){if(null==_volume2)return this._volume;if("number"!=typeof _volume2)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume2,0,1),null!==this.current&&this.current.track.volume(this._volume*this.current.volume),this}},{key:"duration",value:function(){if(arguments.length>0)throw new Error("duration takes no parameters");return this.tracks.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0)}},{key:"remaining",value:function(){if(arguments.length>0)throw new Error("remaining takes no parameters");var remainingTime=this.queue.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0);return null!==this.current&&(remainingTime+=this.current.track.remaining()),remainingTime}},{key:"time",value:function(){if(arguments.length>0)throw new Error("time takes no parameters");return this.duration()-this.remaining()}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isStopped",value:function(){return 0===this.queue.length&&null===this.current}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isFading",value:function(){return null!==this.current&&this.current.track.isFading()}},{key:"_next",value:function(){var nextTrack;for(null!==this.current&&(this.current.track.stop(),this.current=null);nextTrack=this.queue.shift();)if(!nextTrack.track.isUnavailable()){this.current=nextTrack;break}return null!==this.current&&(this.current.track.mute(this._mute),this.current.track.rate(this._rate*this.current.rate),this.current.track.volume(this._volume*this.current.volume),this.current.track.loop(!1),!0)}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._fillQueue()}this._next()&&this.current.track.play()}},{key:"_drainQueue",value:function(){this.queue.splice(0)}},{key:"_fillQueue",value:function(){var _this$queue2;this._drainQueue(),(_this$queue2=this.queue).push.apply(_this$queue2,_toConsumableArray(this.tracks.filter((function(trackObj){return!trackObj.track.isUnavailable()})))),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}}]),AudioList}(),AudioRunner=function(){function AudioRunner(list){if(_classCallCheck(this,AudioRunner),!(list instanceof Set||list instanceof AudioRunner))throw new TypeError("list parameter must be a Set or a AudioRunner instance");Object.defineProperties(this,{trackIds:{value:new Set(list instanceof AudioRunner?list.trackIds:list)}})}return _createClass(AudioRunner,[{key:"load",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.load)}},{key:"unload",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.unload)}},{key:"play",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.play)}},{key:"playWhenAllowed",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.playWhenAllowed)}},{key:"pause",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.pause)}},{key:"stop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.stop)}},{key:"fade",value:function(duration,toVol,fromVol){if(null==duration||null==toVol)throw new Error("fade requires parameters");AudioRunner._run(this.trackIds,AudioTrack.prototype.fade,duration,toVol,fromVol)}},{key:"fadeIn",value:function(duration,fromVol){if(null==duration)throw new Error("fadeIn requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeIn,duration,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){if(null==duration)throw new Error("fadeOut requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeOut,duration,fromVol)}},{key:"fadeStop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeStop)}},{key:"loop",value:function(_loop3){if(null==_loop3)throw new Error("loop requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.loop,_loop3),this}},{key:"mute",value:function(_mute3){if(null==_mute3)throw new Error("mute requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.mute,_mute3),this}},{key:"rate",value:function(_rate3){if(null==_rate3)throw new Error("rate requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.rate,_rate3),this}},{key:"time",value:function(_time2){if(null==_time2)throw new Error("time requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.time,_time2),this}},{key:"volume",value:function(_volume3){if(null==_volume3)throw new Error("volume requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.volume,_volume3),this}},{key:"on",value:function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.on].concat(args)),this}},{key:"one",value:function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.one].concat(args)),this}},{key:"off",value:function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.off].concat(args)),this}}],[{key:"_run",value:function(ids,fn){for(var _len11=arguments.length,args=new Array(_len11>2?_len11-2:0),_key11=2;_key11<_len11;_key11++)args[_key11-2]=arguments[_key11];ids.forEach((function(id){var track=_tracks.get(id);track&&fn.apply(track,args)}))}}]),AudioRunner}();var _runnerParseSelector=function(){var notWsRe=/\S/g,parenRe=/[()]/g;function processNegation(str,startPos){var match;if(notWsRe.lastIndex=startPos,null===(match=notWsRe.exec(str))||"("!==match[0])throw new Error('invalid ":not()" syntax: missing parentheticals');parenRe.lastIndex=notWsRe.lastIndex;for(var start=notWsRe.lastIndex,result={str:"",nextMatch:-1},depth=1;null!==(match=parenRe.exec(str));)if("("===match[0]?++depth:--depth,depth<1){result.nextMatch=parenRe.lastIndex,result.str=str.slice(start,result.nextMatch-1);break}return result}return function parseSelector(idArg){for(var match,ids=[],idRe=/:?[^\s:()]+/g;null!==(match=idRe.exec(idArg));){var id=match[0];if(":not"===id){if(0===ids.length)throw new Error('invalid negation: no group ID preceded ":not()"');var parent=ids[ids.length-1];if(":"!==parent.id[0])throw new Error('invalid negation of track "'.concat(parent.id,'": only groups may be negated with ":not()"'));var negation=processNegation(idArg,idRe.lastIndex);if(-1===negation.nextMatch)throw new Error('unknown error parsing ":not()"');idRe.lastIndex=negation.nextMatch,parent.not=parseSelector(negation.str)}else ids.push({id:id})}return ids}}();function masterMute(mute){if(null==mute)return _masterMute;publish("mute",_masterMute=!!mute)}function unsubscribe(id){_subscribers.delete(id)}function publish(mesg,data){_subscribers.forEach((function(fn){return fn(mesg,data)}))}function _newTrack(sources){return new AudioTrack(sources.map((function(source){if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);if(passage.tags.includes("Twine.audio"))return passage.text.trim()}var match=_formatSpecRe.exec(source);return null===match?source:{format:match[1],src:match[2]}})))}return Object.freeze(Object.defineProperties({},{tracks:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("track ID"),arguments.length<2&&errors.push("sources"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='track ID "'.concat(id,'"');if(_badIdRe.test(id))throw new Error("invalid ".concat(what,": track IDs must not contain colons or whitespace"));var track,sources=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{track=_newTrack(sources)}catch(ex){throw new Error("".concat(what,": error during track initialization: ").concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("".concat(what,": no supported audio sources found"));_tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.set(id,track)}},delete:{value:function(id){return _tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.delete(id)}},clear:{value:function(){_tracks.forEach((function(track){return track._destroy()})),_tracks.clear()}},has:{value:function(id){return _tracks.has(id)}},get:{value:function(id){return _tracks.get(id)||null}}}))},groups:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("group ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='group ID "'.concat(id,'"');if(":"!==id[0]||_badIdRe.test(id.slice(1)))throw new Error("invalid ".concat(what,": group IDs must start with a colon and must not contain colons or whitespace"));if(_specialIds.includes(id))throw new Error("cannot clobber special ".concat(what));var group,trackIds=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{group=new Set(trackIds.map((function(trackId){if(!_tracks.has(trackId))throw new Error('track "'.concat(trackId,'" does not exist'));return trackId})))}catch(ex){throw new Error("".concat(what,": error during group initialization: ").concat(ex.message))}_groups.set(id,Object.freeze(Array.from(group)))}},delete:{value:function(id){return _groups.delete(id)}},clear:{value:function(){_groups.clear()}},has:{value:function(id){return _groups.has(id)}},get:{value:function(id){return _groups.get(id)||null}}}))},lists:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("list ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='list ID "'.concat(id,'"');if(_badIdRe.test(id))return this.error("invalid ".concat(what,": list IDs must not contain colons or whitespace"));var list,descriptors=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{list=new AudioList(descriptors.map((function(desc){if(null===desc)throw new Error("track descriptor must be a string or object (type: null)");switch(_typeof(desc)){case"string":desc={id:desc};break;case"object":if(!desc.hasOwnProperty("id")&&!desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain one of either an "id" or a "sources" property');if(desc.hasOwnProperty("id")&&desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain either an "id" or a "sources" property, not both');break;default:throw new Error("track descriptor must be a string or object (type: ".concat(_typeof(desc),")"))}var own,track,volume;if(desc.hasOwnProperty("id")){if("string"!=typeof desc.id)throw new Error('"id" property must be a string');if(!_tracks.has(desc.id))throw new Error('track "'.concat(desc.id,'" does not exist'));track=_tracks.get(desc.id)}else if(desc.hasOwnProperty("sources")){if(!Array.isArray(desc.sources)||0===desc.sources.length)throw new Error('"sources" property must be a non-empty array');if(desc.hasOwnProperty("own"))throw new Error('"own" property is not allowed with the "sources" property');try{track=_newTrack(desc.sources),own=!0}catch(ex){throw new Error("error during track initialization: ".concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("no supported audio sources found")}if(desc.hasOwnProperty("own")){if("boolean"!=typeof desc.own)throw new Error('"own" property must be a boolean');(own=desc.own)&&(track=track.clone())}if(desc.hasOwnProperty("volume")){if("number"!=typeof desc.volume||Number.isNaN(desc.volume)||!Number.isFinite(desc.volume)||desc.volume<0)throw new Error('"volume" property must be a non-negative finite number');volume=desc.volume}return{own:null!=own&&own,track:track,volume:null!=volume?volume:track.volume()}})))}catch(ex){throw new Error("".concat(what,": error during playlist initialization: ").concat(ex.message))}_lists.has(id)&&_lists.get(id)._destroy(),_lists.set(id,list)}},delete:{value:function(id){return _lists.has(id)&&_lists.get(id)._destroy(),_lists.delete(id)}},clear:{value:function(){_lists.forEach((function(list){return list._destroy()})),_lists.clear()}},has:{value:function(id){return _lists.has(id)}},get:{value:function(id){return _lists.get(id)||null}}}))},select:{value:function(){if(0===arguments.length)throw new Error("no track selector specified");var selector=String(arguments[0]).trim(),trackIds=new Set;try{var renderIds=function renderIds(idObj){var ids,id=idObj.id;switch(id){case":all":ids=allIds;break;case":looped":ids=allIds.filter((function(id){return _tracks.get(id).loop()}));break;case":muted":ids=allIds.filter((function(id){return _tracks.get(id).mute()}));break;case":paused":ids=allIds.filter((function(id){return _tracks.get(id).isPaused()}));break;case":playing":ids=allIds.filter((function(id){return _tracks.get(id).isPlaying()}));break;default:ids=":"===id[0]?_groups.get(id):[id]}if(idObj.hasOwnProperty("not")){var negated=idObj.not.map((function(idObj){return renderIds(idObj)})).flat(1/0);ids=ids.filter((function(id){return!negated.includes(id)}))}return ids},allIds=Array.from(_tracks.keys());_runnerParseSelector(selector).forEach((function(idObj){return renderIds(idObj).forEach((function(id){if(!_tracks.has(id))throw new Error('track "'.concat(id,'" does not exist'));trackIds.add(id)}))}))}catch(ex){throw new Error("error during runner initialization: ".concat(ex.message))}return new AudioRunner(trackIds)}},load:{value:function(){publish("load")}},loadWithScreen:{value:function(){publish("loadwithscreen")}},mute:{value:masterMute},muteOnHidden:{value:function(mute){if(!Visibility.isEnabled())return!1;if(null==mute)return _masterMuteOnHidden;var namespace=".SimpleAudio_masterMuteOnHidden";if(_masterMuteOnHidden=!!mute){var visibilityChange="".concat(Visibility.changeEvent).concat(namespace);jQuery(document).off(namespace).on(visibilityChange,(function(){return masterMute(Visibility.isHidden())})),Visibility.isHidden()&&masterMute(!0)}else jQuery(document).off(namespace)}},rate:{value:function(rate){if(null==rate)return _masterRate;if("number"!=typeof rate||Number.isNaN(rate)||!Number.isFinite(rate))throw new Error("rate must be a finite number");publish("rate",_masterRate=Math.clamp(rate,.2,5))}},stop:{value:function(){publish("stop")}},unload:{value:function(){publish("unload")}},volume:{value:function(volume){if(null==volume)return _masterVolume;if("number"!=typeof volume||Number.isNaN(volume)||!Number.isFinite(volume))throw new Error("volume must be a finite number");publish("volume",_masterVolume=Math.clamp(volume,0,1))}}}))}(),State=function(){var _history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null,_tempVariables={};function stateMarshal(noDelta){var stateObj={index:_activeIndex};return noDelta?stateObj.history=clone(_history):stateObj.delta=historyDeltaEncode(_history),_expired.length>0&&(stateObj.expired=_toConsumableArray(_expired)),null!==_prng&&(stateObj.seed=_prng.seed),stateObj}function stateUnmarshal(stateObj,noDelta){if(null==stateObj)throw new Error("state object is null or undefined");if(!stateObj.hasOwnProperty(noDelta?"history":"delta")||0===stateObj[noDelta?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!stateObj.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==_prng&&!stateObj.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===_prng&&stateObj.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");_history=noDelta?clone(stateObj.history):historyDeltaDecode(stateObj.delta),_activeIndex=stateObj.index,_expired=stateObj.hasOwnProperty("expired")?_toConsumableArray(stateObj.expired):[],stateObj.hasOwnProperty("seed")&&(_prng.seed=stateObj.seed),momentActivate(_activeIndex)}function momentCreate(title,variables){return{title:null==title?"":String(title),variables:null==variables?{}:clone(variables)}}function momentActivate(moment){if(null==moment)throw new Error("moment activation attempted with null or undefined");switch(_typeof(moment)){case"object":_active=clone(moment);break;case"number":if(historyIsEmpty())throw new Error("moment activation attempted with index on empty history");if(moment<0||moment>=historySize())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, ".concat(historySize()-1,"], got ").concat(moment));_active=clone(_history[moment]);break;default:throw new TypeError('moment activation attempted with a "'.concat(_typeof(moment),'"; must be an object or valid history stack index'))}return null!==_prng&&(_prng=PRNGWrapper.unmarshal({seed:_prng.seed,pull:_active.pull})),session.set("state",stateMarshal()),jQuery.event.trigger(":historyupdate"),_active}function historyLength(){return _activeIndex+1}function historySize(){return _history.length}function historyIsEmpty(){return 0===_history.length}function historyTop(){return _history.length>0?_history[_history.length-1]:null}function historyGoTo(index){return!(null==index||index<0||index>=historySize()||index===_activeIndex)&&(momentActivate(_activeIndex=index),!0)}function historyDeltaEncode(historyArr){if(!Array.isArray(historyArr))return null;if(0===historyArr.length)return[];for(var delta=[historyArr[0]],i=1,iend=historyArr.length;i<iend;++i)delta.push(Diff.diff(historyArr[i-1],historyArr[i]));return delta}function historyDeltaDecode(delta){if(!Array.isArray(delta))return null;if(0===delta.length)return[];for(var historyArr=[clone(delta[0])],i=1,iend=delta.length;i<iend;++i)historyArr.push(Diff.patch(historyArr[i-1],delta[i]));return historyArr}function prngInit(seed,useEntropy){var scriptSection;if(!historyIsEmpty())throw scriptSection="the Story JavaScript",new Error("State.prng.init must be called during initialization, within either ".concat(scriptSection," or the StoryInit special passage"));_prng=new PRNGWrapper(seed,useEntropy),_active.pull=_prng.pull}function metadataDelete(key){if("string"!=typeof key)throw new TypeError("State.metadata.delete key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");store&&store.hasOwnProperty(key)&&(1===Object.keys(store).length?storage.delete("metadata"):(delete store[key],storage.set("metadata",store)))}return Object.freeze(Object.defineProperties({},{reset:{value:function(){session.delete("state"),_history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null===_prng?null:new PRNGWrapper(_prng.seed,!1)}},restore:{value:function(){if(session.has("state")){var stateObj=session.get("state");return null!=stateObj&&(stateUnmarshal(stateObj),!0)}return!1}},marshalForSave:{value:function(){return stateMarshal(!0)}},unmarshalForSave:{value:function(stateObj){return stateUnmarshal(stateObj,!0)}},expired:{get:function(){return _expired}},turns:{get:function(){return _expired.length+historyLength()}},passages:{get:function(){return _expired.concat(_history.slice(0,historyLength()).map((function(moment){return moment.title})))}},hasPlayed:{value:function(title){return null!=title&&""!==title&&(!!_expired.includes(title)||!!_history.slice(0,historyLength()).some((function(moment){return moment.title===title})))}},active:{get:function(){return _active}},activeIndex:{get:function(){return _activeIndex}},passage:{get:function(){return _active.title}},variables:{get:function(){return _active.variables}},history:{get:function(){return _history}},length:{get:historyLength},size:{get:historySize},isEmpty:{value:historyIsEmpty},current:{get:function(){return _history.length>0?_history[_activeIndex]:null}},top:{get:historyTop},bottom:{get:function(){return _history.length>0?_history[0]:null}},index:{value:function(index){return historyIsEmpty()||index<0||index>_activeIndex?null:_history[index]}},peek:{value:function(offset){if(historyIsEmpty())return null;var lengthOffset=1+(offset?Math.abs(offset):0);return lengthOffset>historyLength()?null:_history[historyLength()-lengthOffset]}},has:{value:function(title){if(historyIsEmpty()||null==title||""===title)return!1;for(var i=_activeIndex;i>=0;--i)if(_history[i].title===title)return!0;return!1}},create:{value:function(title){for(0,historyLength()<historySize()&&_history.splice(historyLength(),historySize()-historyLength()),_history.push(momentCreate(title,_active.variables)),_prng&&(historyTop().pull=_prng.pull);historySize()>Config.history.maxStates;)_expired.push(_history.shift().title);return momentActivate(_activeIndex=historySize()-1),historyLength()}},goTo:{value:historyGoTo},go:{value:function(offset){return null!=offset&&0!==offset&&historyGoTo(_activeIndex+offset)}},deltaEncode:{value:historyDeltaEncode},deltaDecode:{value:historyDeltaDecode},prng:{value:Object.freeze(Object.defineProperties({},{init:{value:prngInit},isEnabled:{value:function(){return null!==_prng}},pull:{get:function(){return _prng?_prng.pull:NaN}},seed:{get:function(){return _prng?_prng.seed:null}}}))},random:{value:function(){return _prng?_prng.random():Math.random()}},clearTemporary:{value:function(){TempVariables=_tempVariables={}}},temporary:{get:function(){return _tempVariables}},getVar:{value:function(varExpression){try{return Scripting.evalTwineScript(varExpression)}catch(ex){}}},setVar:{value:function(varExpression,value){try{return Scripting.evalTwineScript("".concat(varExpression," = evalTwineScript$Data$"),null,value),!0}catch(ex){}return!1}},metadata:{value:Object.freeze(Object.defineProperties({},{clear:{value:function(){storage.delete("metadata")}},delete:{value:metadataDelete},entries:{value:function(){var store=storage.get("metadata");return store&&Object.entries(store)}},get:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.get key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)?store[key]:undefined}},has:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.has key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)}},keys:{value:function(){var store=storage.get("metadata");return store&&Object.keys(store)}},set:{value:function(key,value){if("string"!=typeof key)throw new TypeError("State.metadata.set key parameter must be a string (received: ".concat(_typeof(key),")"));if(void 0===value)metadataDelete(key);else{var store=storage.get("metadata")||{};store[key]=value,storage.set("metadata",store)}}},size:{get:function(){var store=storage.get("metadata");return store?Object.keys(store).length:0}}}))},initPRNG:{value:prngInit},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Scripting=function(){function addAccessibleClickHandler(targets,selector,handler,one,namespace){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var fn,opts;if("function"==typeof selector?(fn=selector,opts={namespace:one,one:!!handler}):(fn=handler,opts={namespace:namespace,one:!!one,selector:selector}),"function"!=typeof fn)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(targets).ariaClick(opts,fn)}function insertElement(place,type,id,classNames,text,title){var $el=jQuery(document.createElement(type));return id&&$el.attr("id",id),classNames&&$el.addClass(classNames),title&&$el.attr("title",title),text&&$el.text(text),place&&$el.appendTo(place),$el[0]}function insertText(place,text){jQuery(place).append(document.createTextNode(text))}function removeChildren(node){jQuery(node).empty()}function removeElement(node){jQuery(node).remove()}function fade(el,options){var current,intervalId,direction="in"===options.fade?1:-1,proxy=el.cloneNode(!0);function setOpacity(el,opacity){el.style.zoom=1,el.style.filter="alpha(opacity=".concat(Math.floor(100*opacity),")"),el.style.opacity=opacity}el.parentNode.replaceChild(proxy,el),"in"===options.fade?(current=0,proxy.style.visibility="visible"):current=1,setOpacity(proxy,current),intervalId=window.setInterval((function(){current+=.05*direction,setOpacity(proxy,Math.easeInOut(current)),(1===direction&&current>=1||-1===direction&&current<=0)&&(el.style.visibility="in"===options.fade?"visible":"hidden",proxy.parentNode.replaceChild(el,proxy),proxy=null,window.clearInterval(intervalId),options.onComplete&&options.onComplete())}),25)}function scrollWindowTo(el,incrementBy){var increment=null!=incrementBy?Number(incrementBy):.1;Number.isNaN(increment)||!Number.isFinite(increment)||increment<0?increment=.1:increment>1&&(increment=1);var intervalId,start=window.scrollY?window.scrollY:document.body.scrollTop,end=function(el){var posTop=function(el){var curtop=0;for(;el.offsetParent;)curtop+=el.offsetTop,el=el.offsetParent;return curtop}(el),posBottom=posTop+el.offsetHeight,winTop=window.scrollY?window.scrollY:document.body.scrollTop,winHeight=window.innerHeight?window.innerHeight:document.body.clientHeight,winBottom=winTop+winHeight;return posTop>=winTop&&posBottom>winBottom&&el.offsetHeight<winHeight?posTop-(winHeight-el.offsetHeight)+20:posTop}(el),distance=Math.abs(start-end),direction=start>end?-1:1,progress=0;intervalId=window.setInterval((function(){progress+=increment,window.scroll(0,start+direction*(distance*Math.easeInOut(progress))),progress>=1&&window.clearInterval(intervalId)}),25)}function toStringOrDefault(value){return stringFrom(value)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function forget(key){if("string"!=typeof key)throw new TypeError("forget key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.delete(key)}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,i=0,iend=needles.length;i<iend;++i)if(!played.includes(needles[i]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,uBound=played.length-1,turns=State.turns,i=0,iend=needles.length;i<iend&&turns>-1;++i){var lastIndex=played.lastIndexOf(needles[i]);turns=Math.min(turns,-1===lastIndex?-1:uBound-lastIndex)}return turns}function memorize(key,value){if("string"!=typeof key)throw new TypeError("memorize key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.set(key,value)}function passage(){return State.passage}function previous(){var passages=State.passages;if(arguments.length>0){var offset=Number(arguments[0]);if(!Number.isSafeInteger(offset)||offset<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return passages.length>offset?passages[passages.length-1-offset]:""}for(var i=passages.length-2;i>=0;--i)if(passages[i]!==State.passage)return passages[i];return""}function random(){var min,max;switch(arguments.length){case 0:throw new Error("random called with insufficient parameters");case 1:min=0,max=Math.trunc(arguments[0]);break;default:min=Math.trunc(arguments[0]),max=Math.trunc(arguments[1])}if(!Number.isInteger(min))throw new Error("random min parameter must be an integer");if(!Number.isInteger(max))throw new Error("random max parameter must be an integer");if(min>max){var _ref6=[max,min];min=_ref6[0],max=_ref6[1]}return Math.floor(State.random()*(max-min+1))+min}function randomFloat(){var min,max;switch(arguments.length){case 0:throw new Error("randomFloat called with insufficient parameters");case 1:min=0,max=Number(arguments[0]);break;default:min=Number(arguments[0]),max=Number(arguments[1])}if(Number.isNaN(min)||!Number.isFinite(min))throw new Error("randomFloat min parameter must be a number");if(Number.isNaN(max)||!Number.isFinite(max))throw new Error("randomFloat max parameter must be a number");if(min>max){var _ref7=[max,min];min=_ref7[0],max=_ref7[1]}return State.random()*(max-min)+min}function recall(key,defaultValue){if("string"!=typeof key)throw new TypeError("recall key parameter must be a string (received: ".concat(Util.getType(key),")"));return State.metadata.has(key)?State.metadata.get(key):defaultValue}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var passages=Array.prototype.concat.apply([],arguments),tags=[],i=0,iend=passages.length;i<iend;++i)tags=tags.concat(Story.get(passages[i]).tags);return tags}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:Util.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),played=State.passages,count=State.turns,i=0,iend=needles.length;i<iend&&count>0;++i)count=Math.min(count,played.count(needles[i]));return count}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],arguments),nLength=needles.length,played=State.passages,seen=new Map,count=0,i=0,iend=played.length;i<iend;++i){var title=played[i];if(seen.has(title))seen.get(title)&&++count;else{var _tags2=Story.get(title).tags;if(_tags2.length>0){for(var found=0,j=0;j<nLength;++j)_tags2.includes(needles[j])&&++found;found===nLength?(++count,seen.set(title,!0)):seen.set(title,!1)}}}return count}var _ref8=function(){function slugifyUrl(url){return Util.parseUrl(url).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function addScript(url){return new Promise((function(resolve,reject){jQuery(document.createElement("script")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importScripts failed to load the script "'.concat(url,'".')))})).appendTo(document.head).attr({id:"script-imported-".concat(slugifyUrl(url)),type:"text/javascript",src:url})}))}function addStyle(url){return new Promise((function(resolve,reject){jQuery(document.createElement("link")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importStyles failed to load the stylesheet "'.concat(url,'".')))})).appendTo(document.head).attr({id:"style-imported-".concat(slugifyUrl(url)),rel:"stylesheet",href:url})}))}function sequence(callbacks){return callbacks.reduce((function(seq,fn){return seq.then(fn)}),Promise.resolve())}return{importScripts:function(){for(var _len12=arguments.length,urls=new Array(_len12),_key12=0;_key12<_len12;_key12++)urls[_key12]=arguments[_key12];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addScript(url)}}))):addScript(oneOrSeries)})))},importStyles:function(){for(var _len13=arguments.length,urls=new Array(_len13),_key13=0;_key13<_len13;_key13++)urls[_key13]=arguments[_key13];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addStyle(url)}}))):addStyle(oneOrSeries)})))}}}(),importScripts=_ref8.importScripts,importStyles=_ref8.importStyles,parse=function(){var tokenTable=Util.toEnum({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),parseRe=new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(`(?:\\\\.|[^`\\\\])+`)","(?:[=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),notSpaceRe=/\S/,varTest=new RegExp("^".concat(Patterns.variable)),withColonTestRe=/^\s*:/,withNotTestRe=/^\s+not\b/;function parse(rawCodeString){if(0!==parseRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var match,code=rawCodeString;null!==(match=parseRe.exec(code));)if(match[1]){var rawTemplate=match[1],parsedTemplate=parseTemplate(rawTemplate);parsedTemplate!==rawTemplate&&(code=code.splice(match.index,rawTemplate.length,parsedTemplate),parseRe.lastIndex+=parsedTemplate.length-rawTemplate.length)}else if(match[2]){var token=match[2];if("$"===token||"_"===token)continue;if(varTest.test(token))token=token[0];else if("is"===token){var start=parseRe.lastIndex,ahead=code.slice(start);withNotTestRe.test(ahead)&&(code=code.splice(start,ahead.search(notSpaceRe)),token="isnot")}else{var _ahead=code.slice(parseRe.lastIndex);if(withColonTestRe.test(_ahead))continue}tokenTable[token]&&(code=code.splice(match.index,token.length,tokenTable[token]),parseRe.lastIndex+=tokenTable[token].length-token.length)}return code}var templateGroupStartRe=/\$\{/g,templateGroupParseRe=new RegExp(["(?:\"\"|'')",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(\\{)","(\\})"].join("|"),"g");function parseTemplate(rawTemplateLiteral){if(0!==templateGroupStartRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start of template literal");for(var startMatch,template=rawTemplateLiteral;null!==(startMatch=templateGroupStartRe.exec(template));){var startIdx=startMatch.index+2,endIdx=startIdx,depth=1,endMatch=void 0;for(templateGroupParseRe.lastIndex=startIdx;null!==(endMatch=templateGroupParseRe.exec(template));)if(endMatch[1]?++depth:endMatch[2]&&--depth,0===depth){endIdx=endMatch.index;break}if(endIdx>startIdx){var parseIndex=parseRe.lastIndex,rawGroup=template.slice(startIdx,endIdx);parseRe.lastIndex=0;var parsedGroup=parse(rawGroup);parseRe.lastIndex=parseIndex,template=template.splice(startIdx,rawGroup.length,parsedGroup),templateGroupStartRe.lastIndex+=parsedGroup.length-rawGroup.length}}return template}return parse}();function evalJavaScript(code,output,data){return function(code,output,evalJavaScript$Data$){return eval(code)}.call(output?{output:output}:null,String(code),output,data)}function evalTwineScript(code,output,data){return function(code,output,evalTwineScript$Data$){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output,data)}return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),_ref9=function(){var Lexer=function(){function Lexer(source,initialState){if(_classCallCheck(this,Lexer),arguments.length<2)throw new Error("Lexer constructor called with too few parameters (source:string , initialState:function)");Object.defineProperties(this,{source:{value:source},initial:{value:initialState},state:{writable:!0,value:initialState},start:{writable:!0,value:0},pos:{writable:!0,value:0},depth:{writable:!0,value:0},items:{writable:!0,value:[]},data:{writable:!0,value:{}}})}return _createClass(Lexer,[{key:"reset",value:function(){this.state=this.initial,this.start=0,this.pos=0,this.depth=0,this.items=[],this.data={}}},{key:"run",value:function(){for(;null!==this.state;)this.state=this.state(this);return this.items}},{key:"nextItem",value:function(){for(;0===this.items.length&&null!==this.state;)this.state=this.state(this);return this.items.shift()}},{key:"next",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos++]}},{key:"peek",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos]}},{key:"backup",value:function(num){this.pos-=num||1}},{key:"forward",value:function(num){this.pos+=num||1}},{key:"ignore",value:function(){this.start=this.pos}},{key:"accept",value:function(valid){var ch=this.next();return-1!==ch&&(!!valid.includes(ch)||(this.backup(),!1))}},{key:"acceptRe",value:function(validRe){var ch=this.next();return-1!==ch&&(!!validRe.test(ch)||(this.backup(),!1))}},{key:"acceptRun",value:function(valid){for(;;){var ch=this.next();if(-1===ch)return;if(!valid.includes(ch))break}this.backup()}},{key:"acceptRunRe",value:function(validRe){for(;;){var ch=this.next();if(-1===ch)return;if(!validRe.test(ch))break}this.backup()}},{key:"emit",value:function(type){this.items.push({type:type,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),this.start=this.pos}},{key:"error",value:function(type,message){if(arguments.length<2)throw new Error("Lexer.prototype.error called with too few parameters (type:number , message:string)");return this.items.push({type:type,message:message,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),null}}],[{key:"enumFromNames",value:function(names){var obj=names.reduce((function(obj,name,i){return obj[name]=i,obj}),{});return Object.freeze(Object.assign(Object.create(null),obj))}}]),Lexer}();return{EOF:-1,Lexer:Lexer}}(),EOF=_ref9.EOF,Lexer=_ref9.Lexer,Wikifier=function(){var _optionsStack,lookaheadRe,idOrClassRe,_callDepth=0,Wikifier=function(){function Wikifier(destination,source,options){_classCallCheck(this,Wikifier),Wikifier.Parser.Profile.isEmpty()&&Wikifier.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(source)},options:{writable:!0,value:Object.assign({profile:"all"},options)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),null==destination?this.output=document.createDocumentFragment():destination.jquery?this.output=destination[0]:this.output=destination;try{++_callDepth,this.subWikify(this.output),1===_callDepth&&Config.cleanupWikifierOutput&&convertBreaks(this.output)}finally{--_callDepth}}return _createClass(Wikifier,[{key:"subWikify",value:function(output,terminator,options){var newOptions,oldOptions,oldOutput=this.output;this.output=output,Wikifier.Option.length>0&&(newOptions=Object.assign(newOptions||{},Wikifier.Option.options)),null!==options&&"object"===_typeof(options)&&(newOptions=Object.assign(newOptions||{},options)),newOptions&&(oldOptions=this.options,this.options=Object.assign({},this.options,newOptions));var terminatorMatch,parserMatch,parsersProfile=Wikifier.Parser.Profile.get(this.options.profile),terminatorRegExp=terminator?new RegExp("(?:".concat(terminator,")"),this.options.ignoreTerminatorCase?"gim":"gm"):null;do{if(parsersProfile.parserRegExp.lastIndex=this.nextMatch,terminatorRegExp&&(terminatorRegExp.lastIndex=this.nextMatch),parserMatch=parsersProfile.parserRegExp.exec(this.source),(terminatorMatch=terminatorRegExp?terminatorRegExp.exec(this.source):null)&&(!parserMatch||terminatorMatch.index<=parserMatch.index))return terminatorMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,terminatorMatch.index),this.matchStart=terminatorMatch.index,this.matchLength=terminatorMatch[0].length,this.matchText=terminatorMatch[0],this.nextMatch=terminatorRegExp.lastIndex,this.output=oldOutput,void(oldOptions&&(this.options=oldOptions));if(parserMatch){parserMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,parserMatch.index),this.matchStart=parserMatch.index,this.matchLength=parserMatch[0].length,this.matchText=parserMatch[0],this.nextMatch=parsersProfile.parserRegExp.lastIndex;for(var matchingParser=void 0,i=1,iend=parserMatch.length;i<iend;++i)if(parserMatch[i]){matchingParser=i-1;break}if(parsersProfile.parsers[matchingParser].handler(this),null!=TempState.break)break}}while(terminatorMatch||parserMatch);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=oldOutput,oldOptions&&(this.options=oldOptions)}},{key:"outputText",value:function(destination,startPos,endPos){jQuery(destination).append(document.createTextNode(this.source.substring(startPos,endPos)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this._rawArgs)}}],[{key:"wikifyEval",value:function(text){var output=document.createDocumentFragment();new Wikifier(output,text);var errors=output.querySelector(".error");if(null!==errors)throw new Error(errors.textContent.replace(errorPrologRegExp,""));return output}},{key:"createInternalLink",value:function(destination,passage,text,callback){var $link=jQuery(document.createElement("a"));return null!=passage&&($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken"),$link.ariaClick({one:!0},(function(){"function"==typeof callback&&callback(),Engine.play(passage)}))),text&&$link.append(document.createTextNode(text)),destination&&$link.appendTo(destination),$link[0]}},{key:"createExternalLink",value:function(destination,url,text){var $link=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(text).appendTo(destination);return null!=url&&$link.attr({href:url,tabindex:0}),$link[0]}},{key:"isExternalLink",value:function(link){return!Story.has(link)&&(new RegExp("^".concat(Patterns.url),"gim").test(link)||/[/.?#]/.test(link))}}]),Wikifier}();return Object.defineProperty(Wikifier,"Option",{value:(_optionsStack=[],Object.freeze(Object.defineProperties({},{length:{get:function(){return _optionsStack.length}},options:{get:function(){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(_optionsStack)))}},clear:{value:function(){_optionsStack=[]}},get:{value:function(idx){return _optionsStack[idx]}},pop:{value:function(){return _optionsStack.pop()}},push:{value:function(options){if("object"!==_typeof(options)||null===options)throw new TypeError("Wikifier.Option.push options parameter must be an object (received: ".concat(Util.getType(options),")"));return _optionsStack.push(options)}}})))}),Object.defineProperty(Wikifier,"Parser",{value:function(){var _profiles,_parsers=[];function parsersHas(name){return!!_parsers.find((function(parser){return parser.name===name}))}return Object.freeze(Object.defineProperties({},{parsers:{get:function(){return _parsers}},add:{value:function(parser){if("object"!==_typeof(parser))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!parser.hasOwnProperty("name"))throw new Error('parser object missing required "name" property');if("string"!=typeof parser.name)throw new Error('parser object "name" property must be a string');if(!parser.hasOwnProperty("match"))throw new Error('parser object missing required "match" property');if("string"!=typeof parser.match)throw new Error('parser object "match" property must be a string');if(!parser.hasOwnProperty("handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof parser.handler)throw new Error('parser object "handler" property must be a function');if(parser.hasOwnProperty("profiles")&&!Array.isArray(parser.profiles))throw new Error('parser object "profiles" property must be an array');if(parsersHas(parser.name))throw new Error('cannot clobber existing parser "'.concat(parser.name,'"'));_parsers.push(parser)}},delete:{value:function(name){var parser=_parsers.find((function(parser){return parser.name===name}));parser&&_parsers.delete(parser)}},isEmpty:{value:function(){return 0===_parsers.length}},has:{value:parsersHas},get:{value:function(name){return _parsers.find((function(parser){return parser.name===name}))||null}},Profile:{value:Object.freeze(Object.defineProperties({},{profiles:{get:function(){return _profiles}},compile:{value:function(){var all=_parsers,core=all.filter((function(parser){return!Array.isArray(parser.profiles)||parser.profiles.includes("core")}));return _profiles=Object.freeze({all:{parsers:all,parserRegExp:new RegExp(all.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")},core:{parsers:core,parserRegExp:new RegExp(core.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")}})}},isEmpty:{value:function(){return"object"!==_typeof(_profiles)||0===Object.keys(_profiles).length}},has:{value:function(profile){return"object"===_typeof(_profiles)&&_profiles.hasOwnProperty(profile)}},get:{value:function(profile){if("object"!==_typeof(_profiles)||!_profiles.hasOwnProperty(profile))throw new Error('nonexistent parser profile "'.concat(profile,'"'));return _profiles[profile]}}}))}}))}()}),Object.defineProperties(Wikifier,{helpers:{value:{}},getValue:{value:State.getVar},setValue:{value:State.setVar},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(Wikifier.helpers,{inlineCss:{value:(lookaheadRe=new RegExp(Patterns.inlineCss,"gm"),idOrClassRe=new RegExp("(".concat(Patterns.cssIdOrClassSigil,")(").concat(Patterns.anyLetter,"+)"),"g"),function(w){var matched,css={classes:[],id:"",styles:{}};do{lookaheadRe.lastIndex=w.nextMatch;var match=lookaheadRe.exec(w.source);if(matched=match&&match.index===w.nextMatch){if(match[1])css.styles[Util.fromCssProperty(match[1])]=match[2].trim();else if(match[3])css.styles[Util.fromCssProperty(match[3])]=match[4].trim();else if(match[5]){var subMatch=void 0;for(idOrClassRe.lastIndex=0;null!==(subMatch=idOrClassRe.exec(match[5]));)"."===subMatch[1]?css.classes.push(subMatch[2]):css.id=subMatch[2]}w.nextMatch=lookaheadRe.lastIndex}}while(matched);return css})},evalText:{value:function(text){var result;try{switch(_typeof(result=Scripting.evalTwineScript(text))){case"string":""===result.trim()&&(result=text);break;case"number":result=String(result);break;default:result=text}}catch(ex){result=text}return result}},evalPassageId:{value:function(passage){return null==passage||Story.has(passage)?passage:Wikifier.helpers.evalText(passage)}},hasBlockContext:{value:function(nodes){for(var hasGCS="function"==typeof window.getComputedStyle,i=nodes.length-1;i>=0;--i){var node=nodes[i];switch(node.nodeType){case Node.ELEMENT_NODE:var tagName=node.nodeName.toUpperCase();if("BR"===tagName)return!0;var styles=hasGCS?window.getComputedStyle(node,null):node.currentStyle;if(styles&&styles.display){if("none"===styles.display)continue;return"block"===styles.display}switch(tagName){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},createShadowSetterCallback:{value:function(){var macroParser=null;function getMacroContextShadowView(){for(var macro=macroParser||function(){if(!macroParser&&!(macroParser=Wikifier.Parser.get("macro")))throw new Error('cannot find "macro" parser');return macroParser}(),view=new Set,context=macro.context;null!==context;context=context.parent)context._shadows&&context._shadows.forEach((function(name){return view.add(name)}));return _toConsumableArray(view)}return function(code){var shadowStore={};return getMacroContextShadowView().forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]})),function(){var shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null;try{return shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),Scripting.evalJavaScript(code)}finally{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}}()},parseSquareBracketedMarkup:{value:function(){var Item=Lexer.enumFromNames(["Error","DelimLTR","DelimRTL","InnerMeta","ImageMeta","LinkMeta","Link","RightMeta","Setter","Source","Text"]),Delim=Lexer.enumFromNames(["None","LTR","RTL"]);function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexLeftMeta(lexer){if(!lexer.accept("["))return lexer.error(Item.Error,"malformed square-bracketed markup");if(lexer.accept("["))lexer.data.isLink=!0,lexer.emit(Item.LinkMeta);else{if(lexer.accept("<>"),!(lexer.accept("Ii")&&lexer.accept("Mm")&&lexer.accept("Gg")&&lexer.accept("[")))return lexer.error(Item.Error,"malformed square-bracketed markup");lexer.data.isLink=!1,lexer.emit(Item.ImageMeta)}return lexer.depth=2,lexCoreComponents}function lexCoreComponents(lexer){for(var what=lexer.data.isLink?"link":"image",delim=Delim.None;;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup"));break;case"|":delim===Delim.None&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(),lexer.emit(Item.DelimLTR));break;case"-":delim===Delim.None&&">"===lexer.peek()&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(2),lexer.emit(Item.DelimLTR));break;case"<":delim===Delim.None&&"-"===lexer.peek()&&(delim=Delim.RTL,lexer.backup(),lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.DelimRTL));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.InnerMeta),lexer.data.isLink?lexSetter:lexImageLink;case"]":return--lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexImageLink(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup link component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.InnerMeta),lexSetter;case"]":return--lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexSetter(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup setter component"));break;case"'":if(slurpQuote(lexer,"'")===EOF)return lexer.error(Item.Error,"unterminated single quoted string in ".concat(what," markup setter component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)return"]"!==lexer.peek()?lexer.error(Item.Error,"malformed ".concat(what," markup")):(--lexer.depth,lexer.backup(),lexer.emit(Item.Setter),lexer.forward(2),lexer.emit(Item.RightMeta),null)}}return function(w){var lexer=new Lexer(w.source,lexLeftMeta);lexer.start=lexer.pos=w.matchStart;var markup={},items=lexer.run(),last=items.last();return last&&last.type===Item.Error?markup.error=last.message:items.forEach((function(item){var text=item.text.trim();switch(item.type){case Item.ImageMeta:markup.isImage=!0,"<"===text[1]?markup.align="left":">"===text[1]&&(markup.align="right");break;case Item.LinkMeta:markup.isLink=!0;break;case Item.Link:"~"===text[0]?(markup.forceInternal=!0,markup.link=text.slice(1)):markup.link=text;break;case Item.Setter:markup.setter=text;break;case Item.Source:markup.source=text;break;case Item.Text:markup.text=text}})),markup.pos=lexer.pos,markup}}()}}),Wikifier}();!function(){function _verbatimTagHandler(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(match[1]).appendTo(w.output))}Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("blockquote")).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,i,destStack=[w.output],curLevel=0,newLevel=w.matchLength;do{if(newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement("blockquote")).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();curLevel=newLevel,w.subWikify(destStack[destStack.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(destStack[destStack.length-1]),this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);(matched=match&&match.index===w.nextMatch)&&(newLevel=match[0].length,w.nextMatch+=match[0].length)}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(/?".concat(Patterns.macroName,")(?:\\s*)((?:(?:/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/)|(?://.*\\n)|(?:`(?:\\\\.|[^`\\\\])*`)|(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>"),"gm"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(w){var matchStart=this.lookahead.lastIndex=w.matchStart;if(this.parseTag(w)){var macro,nextMatch=w.nextMatch,name=this.working.name,rawArgs=this.working.arguments;try{if(!(macro=Macro.get(name))){if(Macro.tags.has(name)){var tags=Macro.tags.get(name);return throwError(w.output,"child tag <<".concat(name,">> was found outside of a call to its parent macro").concat(1===tags.length?"":"s"," <<").concat(tags.join(">>, <<"),">>"),w.source.slice(matchStart,w.nextMatch))}return throwError(w.output,"macro <<".concat(name,">> does not exist"),w.source.slice(matchStart,w.nextMatch))}var payload=null;if(void 0!==macro.tags&&!(payload=this.parseBody(w,macro)))return w.nextMatch=nextMatch,throwError(w.output,"cannot find a closing tag for macro <<".concat(name,">>"),"".concat(w.source.slice(matchStart,w.nextMatch),"…"));if("function"!=typeof macro.handler)return throwError(w.output,"macro <<".concat(name,">> handler function ").concat(void 0===macro.handler?"does not exist":"is not a function"),w.source.slice(matchStart,w.nextMatch));var args=payload?payload[0].args:this.createArgs(rawArgs,this.skipArgs(macro,macro.name));if(void 0!==macro._MACRO_API){this.context=new MacroContext({macro:macro,name:name,args:args,payload:payload,source:w.source.slice(matchStart,w.nextMatch),parent:this.context,parser:w});try{macro.handler.call(this.context)}finally{this.context=this.context.parent}}else{var prevRawArgs=w._rawArgs;w._rawArgs=rawArgs;try{macro.handler(w.output,name,args,w,payload)}finally{w._rawArgs=prevRawArgs}}}catch(ex){return throwError(w.output,"cannot execute ".concat(macro&&macro.isWidget?"widget":"macro"," <<").concat(name,">>: ").concat(ex.message),w.source.slice(matchStart,w.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else w.outputText(w.output,w.matchStart,w.nextMatch)},parseTag:function(w){var match=this.lookahead.exec(w.source);return!(!match||match.index!==w.matchStart||!match[1])&&(w.nextMatch=this.lookahead.lastIndex,this.working.source=w.source.slice(match.index,this.lookahead.lastIndex),this.working.name=match[1],this.working.arguments=match[2],this.working.index=match.index,!0)},parseBody:function(w,macro){for(var openTag=this.working.name,closeTag="/".concat(openTag),closeAlt="end".concat(openTag),bodyTags=!!Array.isArray(macro.tags)&&macro.tags,payload=[],end=-1,opened=1,curSource=this.working.source,curTag=this.working.name,curArgument=this.working.arguments,contentStart=w.nextMatch;-1!==(w.matchStart=w.source.indexOf(this.match,w.nextMatch));)if(this.parseTag(w)){var tagSource=this.working.source,tagName=this.working.name,tagArgs=this.working.arguments,tagBegin=this.working.index,tagEnd=w.nextMatch,hasArgs=""!==tagArgs.trim();switch(tagName){case openTag:++opened;break;case closeAlt:case closeTag:if(hasArgs)throw w.nextMatch=tagBegin+2+tagName.length,new Error('malformed closing tag: "'.concat(tagSource,'"'));--opened;break;default:if(hasArgs&&(tagName.startsWith("/")||tagName.startsWith("end"))){this.lookahead.lastIndex=w.nextMatch=tagBegin+2+tagName.length;continue}if(1===opened&&bodyTags)for(var i=0,iend=bodyTags.length;i<iend;++i)tagName===bodyTags[i]&&(payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),curSource=tagSource,curTag=tagName,curArgument=tagArgs,contentStart=tagEnd)}if(0===opened){payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),end=tagEnd;break}}else this.lookahead.lastIndex=w.nextMatch=w.matchStart+this.match.length;return-1!==end?(w.nextMatch=end,payload):null},createArgs:function(rawArgsString,skipArgs){var args=skipArgs?[]:this.parseArgs(rawArgsString);return Object.defineProperties(args,{raw:{value:rawArgsString},full:{value:Scripting.parse(rawArgsString)}}),args},skipArgs:function(macro,tagName){if(void 0!==macro.skipArgs){var sa=macro.skipArgs;return"boolean"==typeof sa&&sa||Array.isArray(sa)&&sa.includes(tagName)}return void 0!==macro.skipArg0&&(macro.skipArg0&&macro.name===tagName)},parseArgs:function(){var Item=Lexer.enumFromNames(["Error","Bareword","Expression","String","SquareBracket"]),spaceRe=new RegExp(Patterns.space),notSpaceRe=new RegExp(Patterns.notSpace),varTest=new RegExp("^".concat(Patterns.variable));function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexSpace(lexer){var offset=lexer.source.slice(lexer.pos).search(notSpaceRe);if(offset===EOF)return null;switch(0!==offset&&(lexer.pos+=offset,lexer.ignore()),lexer.next()){case"`":return lexExpression;case'"':return lexDoubleQuote;case"'":return lexSingleQuote;case"[":return lexSquareBracket;default:return lexBareword}}function lexExpression(lexer){return slurpQuote(lexer,"`")===EOF?lexer.error(Item.Error,"unterminated backquote expression"):(lexer.emit(Item.Expression),lexSpace)}function lexDoubleQuote(lexer){return slurpQuote(lexer,'"')===EOF?lexer.error(Item.Error,"unterminated double quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSingleQuote(lexer){return slurpQuote(lexer,"'")===EOF?lexer.error(Item.Error,"unterminated single quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSquareBracket(lexer){var what;if(lexer.accept("<>IiMmGg")?(what="image",lexer.acceptRun("<>IiMmGg")):what="link",!lexer.accept("["))return lexer.error(Item.Error,"malformed ".concat(what," markup"));lexer.depth=2;loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case"[":++lexer.depth;break;case"]":if(--lexer.depth,lexer.depth<0)return lexer.error(Item.Error,"unexpected right square bracket ']'");if(1===lexer.depth){if("]"===lexer.next()){--lexer.depth;break loop}lexer.backup()}}return lexer.emit(Item.SquareBracket),lexSpace}function lexBareword(lexer){var offset=lexer.source.slice(lexer.pos).search(spaceRe);return lexer.pos=offset===EOF?lexer.source.length:lexer.pos+offset,lexer.emit(Item.Bareword),offset===EOF?null:lexSpace}return function(rawArgsString){var lexer=new Lexer(rawArgsString,lexSpace),args=[];return lexer.run().forEach((function(item){var arg=item.text;switch(item.type){case Item.Error:throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(item.message));case Item.Bareword:if(varTest.test(arg))arg=State.getVar(arg);else if(/^(?:settings|setup)[.[]/.test(arg))try{arg=Scripting.evalTwineScript(arg)}catch(ex){throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(ex.message))}else if("null"===arg)arg=null;else if("undefined"===arg)arg=undefined;else if("true"===arg)arg=!0;else if("false"===arg)arg=!1;else if("NaN"===arg)arg=NaN;else{var argAsNum=Number(arg);Number.isNaN(argAsNum)||(arg=argAsNum)}break;case Item.Expression:if(""===(arg=arg.slice(1,-1).trim()))arg=undefined;else try{arg=Scripting.evalTwineScript("(".concat(arg,")"))}catch(ex){throw new Error('unable to parse macro argument expression "'.concat(arg,'": ').concat(ex.message))}break;case Item.String:try{arg=Scripting.evalJavaScript(arg)}catch(ex){throw new Error('unable to parse macro argument string "'.concat(arg,'": ').concat(ex.message))}break;case Item.SquareBracket:var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:arg,matchStart:0});if(markup.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(markup.error));if(markup.pos<arg.length)throw new Error('unable to parse macro argument "'.concat(arg,'": unexpected character(s) "').concat(arg.slice(markup.pos),'" (pos: ').concat(markup.pos,")"));markup.isLink?((arg={isLink:!0}).count=markup.hasOwnProperty("text")?2:1,arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):arg.link,arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null):markup.isImage&&(arg=function(source){var imgObj={source:source,isImage:!0};if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(imgObj.source=passage.text,imgObj.passage=passage.title)}return imgObj}(Wikifier.helpers.evalPassageId(markup.source)),markup.hasOwnProperty("align")&&(arg.align=markup.align),markup.hasOwnProperty("text")&&(arg.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("link")&&(arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link)),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null)}args.push(arg)})),args}}()}),Wikifier.Parser.add({name:"link",profiles:["core"],match:"\\[\\[[^[]",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{w.nextMatch=markup.pos;var link=Wikifier.helpers.evalPassageId(markup.link),text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):link,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,output=(Config.debug?new DebugView(w.output,"link-markup","[[link]]",w.source.slice(w.matchStart,w.nextMatch)):w).output;markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(output,link,text,setFn):Wikifier.createExternalLink(output,link,text)}}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(w){w.outputText(Wikifier.createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{var debugView;w.nextMatch=markup.pos,Config.debug&&(debugView=new DebugView(w.output,"image-markup",markup.hasOwnProperty("link")?"[img[][link]]":"[img[]]",w.source.slice(w.matchStart,w.nextMatch))).modes({block:!0});var source,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,el=(Config.debug?debugView:w).output;if(markup.hasOwnProperty("link")){var link=Wikifier.helpers.evalPassageId(markup.link);(el=markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(el,link,null,setFn):Wikifier.createExternalLink(el,link)).classList.add("link-image")}if(el=jQuery(document.createElement("img")).appendTo(el).get(0),"data:"!==(source=Wikifier.helpers.evalPassageId(markup.source)).slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(el.setAttribute("data-passage",passage.title),source=passage.text.trim())}el.src=source,markup.hasOwnProperty("text")&&(el.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("align")&&(el.align=markup.align)}}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){var pre=jQuery(document.createElement("pre"));jQuery(document.createElement("code")).text(match[1]).appendTo(pre),pre.appendTo(w.output),w.nextMatch=this.lookahead.lastIndex}}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(w){switch(w.matchText){case"''":w.subWikify(jQuery(document.createElement("strong")).appendTo(w.output).get(0),"''");break;case"//":w.subWikify(jQuery(document.createElement("em")).appendTo(w.output).get(0),"//");break;case"__":w.subWikify(jQuery(document.createElement("u")).appendTo(w.output).get(0),"__");break;case"^^":w.subWikify(jQuery(document.createElement("sup")).appendTo(w.output).get(0),"\\^\\^");break;case"~~":w.subWikify(jQuery(document.createElement("sub")).appendTo(w.output).get(0),"~~");break;case"==":w.subWikify(jQuery(document.createElement("s")).appendTo(w.output).get(0),"==");break;case"{{{":var lookahead=/\{\{\{((?:.|\n)*?)\}\}\}/gm;lookahead.lastIndex=w.matchStart;var match=lookahead.exec(w.source);match&&match.index===w.matchStart&&(jQuery(document.createElement("code")).text(match[1]).appendTo(w.output),w.nextMatch=lookahead.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRe:/\s*\n/gm,handler:function(w){var css=Wikifier.helpers.inlineCss(w);this.blockRe.lastIndex=w.nextMatch;var blockMatch=this.blockRe.exec(w.source),blockLevel=blockMatch&&blockMatch.index===w.nextMatch,$el=jQuery(document.createElement(blockLevel?"div":"span")).appendTo(w.output);0===css.classes.length&&""===css.id&&0===Object.keys(css.styles).length?$el.addClass("marked"):(css.classes.forEach((function(className){return $el.addClass(className)})),""!==css.id&&$el.attr("id",css.id),$el.css(css.styles)),blockLevel?(w.nextMatch+=blockMatch[0].length,w.subWikify($el[0],"\\n?".concat(this.terminator))):w.subWikify($el[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<[Nn][Oo][Ww][Ii][Kk][Ii]>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<[Nn][Oo][Ww][Ii][Kk][Ii]>((?:.|\n)*?)<\/[Nn][Oo][Ww][Ii][Kk][Ii]>)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createElement("span")).addClass("verbatim").text(match[1]||match[2]).appendTo(w.output))}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+$\\n?|<[Hh][Rr]\\s*/?>\\n?",handler:function(w){jQuery(document.createElement("hr")).appendTo(w.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(w){jQuery(document.createTextNode("—")).appendTo(w.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(w){jQuery(document.createTextNode("$")).appendTo(w.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:"".concat(Patterns.variable,"(?:(?:\\.").concat(Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[").concat(Patterns.variable,"\\]))*"),handler:function(w){var result=State.getVar(w.matchText);null==result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"variable",w.matchText,w.matchText):w).output,stringFrom(result))}}),Wikifier.Parser.add({name:"template",profiles:["core"],match:"\\?".concat(Patterns.templateName),handler:function(w){var name=w.matchText.slice(1),template=Template.get(name),result=null;switch(template instanceof Array&&(template=template.random()),_typeof(template)){case"function":try{result=stringFrom(template.call({name:name}))}catch(ex){return throwError(w.output,"cannot execute function template ?".concat(name,": ").concat(ex.message),w.source.slice(w.matchStart,w.nextMatch))}break;case"string":result=template}null===result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"template",w.matchText,w.matchText):w).output,result)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("h".concat(w.matchLength))).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,table=jQuery(document.createElement("table")).appendTo(w.output).get(0),prevColumns=[],curRowType=null,$rowContainer=null,rowCount=0;w.nextMatch=w.matchStart;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var nextRowType=match[2];"k"===nextRowType?(table.className=match[1],w.nextMatch+=match[0].length+1):(nextRowType!==curRowType&&(curRowType=nextRowType,$rowContainer=jQuery(document.createElement(this.rowTypes[nextRowType])).appendTo(table)),"c"===curRowType?($rowContainer.css("caption-side",0===rowCount?"top":"bottom"),w.nextMatch+=1,w.subWikify($rowContainer[0],this.rowTerminator)):this.rowHandler(w,jQuery(document.createElement("tr")).appendTo($rowContainer).get(0),prevColumns),++rowCount)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))},rowHandler:function(w,rowEl,prevColumns){var matched,_this12=this,cellRe=new RegExp(this.cellPattern,"gm"),col=0,curColCount=1;do{cellRe.lastIndex=w.nextMatch;var cellMatch=cellRe.exec(w.source);if(matched=cellMatch&&cellMatch.index===w.nextMatch){if("~"===cellMatch[1]){var last=prevColumns[col];last&&(++last.rowCount,last.$element.attr("rowspan",last.rowCount).css("vertical-align","middle")),w.nextMatch=cellMatch.index+cellMatch[0].length-1}else if(">"===cellMatch[1])++curColCount,w.nextMatch=cellMatch.index+cellMatch[0].length-1;else{if(cellMatch[2]){w.nextMatch=cellMatch.index+cellMatch[0].length;break}!function(){++w.nextMatch;for(var css=Wikifier.helpers.inlineCss(w),spaceLeft=!1,spaceRight=!1,$cell=void 0;" "===w.source.substr(w.nextMatch,1);)spaceLeft=!0,++w.nextMatch;"!"===w.source.substr(w.nextMatch,1)?($cell=jQuery(document.createElement("th")).appendTo(rowEl),++w.nextMatch):$cell=jQuery(document.createElement("td")).appendTo(rowEl),prevColumns[col]={rowCount:1,$element:$cell},curColCount>1&&($cell.attr("colspan",curColCount),curColCount=1),w.subWikify($cell[0],_this12.cellTerminator)," "===w.matchText.substr(w.matchText.length-2,1)&&(spaceRight=!0),css.classes.forEach((function(className){return $cell.addClass(className)})),""!==css.id&&$cell.attr("id",css.id),spaceLeft&&spaceRight?css.styles["text-align"]="center":spaceLeft?css.styles["text-align"]="right":spaceRight&&(css.styles["text-align"]="left"),$cell.css(css.styles),w.nextMatch=w.nextMatch-1}()}++col}}while(matched)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){w.nextMatch=w.matchStart;var matched,i,destStack=[w.output],curType=null,curLevel=0;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var newType=match[2]?"ol":"ul",newLevel=match[0].length;if(w.nextMatch+=match[0].length,newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();else newLevel===curLevel&&newType!==curType&&(destStack.pop(),destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0)));curLevel=newLevel,curType=newType,w.subWikify(jQuery(document.createElement("li")).appendTo(destStack[destStack.length-1]).get(0),this.terminator)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:\x3c!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\".concat(Patterns.spaceNoTerminator,"*\\n|\\n").concat(Patterns.spaceNoTerminator,"*\\\\|\\n?\\\\").concat(Patterns.spaceNoTerminator,"*$|^").concat(Patterns.spaceNoTerminator,"*\\\\\\n?"),handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n|<[Bb][Rr]\\s*/?>",handler:function(w){w.options.nobr||jQuery(document.createElement("br")).appendTo(w.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(w){jQuery(document.createDocumentFragment()).append(w.matchText).appendTo(w.output)}}),Wikifier.Parser.add({name:"xmlProlog",profiles:["core"],match:"<\\?[Xx][Mm][Ll][^>]*\\?>",handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"verbatimHtml",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"verbatimScriptTag",profiles:["core"],match:"<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>",lookahead:/(<[Ss][Cc][Rr][Ii][Pp][Tt]*>(?:.|\n)*?<\/[Ss][Cc][Rr][Ii][Pp][Tt]>)/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"styleTag",profiles:["core"],match:"<[Ss][Tt][Yy][Ll][Ee][^>]*>",lookahead:/(<[Ss][Tt][Yy][Ll][Ee]*>)((?:.|\n)*?)(<\/[Ss][Tt][Yy][Ll][Ee]>)/gm,imageMarkup:new RegExp(Patterns.cssImage,"g"),hasImageMarkup:new RegExp(Patterns.cssImage),handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){w.nextMatch=this.lookahead.lastIndex;var css=match[2];this.hasImageMarkup.test(css)&&(this.imageMarkup.lastIndex=0,css=css.replace(this.imageMarkup,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text)}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),jQuery(document.createDocumentFragment()).append(match[1]+css+match[3]).appendTo(w.output)}}}),Wikifier.Parser.add({name:"svgTag",profiles:["core"],match:"<[Ss][Vv][Gg][^>]*>",lookahead:/<(\/?)[Ss][Vv][Gg][^>]*>/gm,namespace:"http://www.w3.org/2000/svg",handler:function(w){var _this13=this;this.lookahead.lastIndex=w.nextMatch;for(var match,depth=1;depth>0&&null!==(match=this.lookahead.exec(w.source));)depth+="/"===match[1]?-1:1;if(0===depth){w.nextMatch=this.lookahead.lastIndex;var svgTag=w.source.slice(w.matchStart,this.lookahead.lastIndex),$frag=jQuery(document.createDocumentFragment()).append(svgTag);$frag.find("a[data-passage],image[data-passage]").each((function(_,el){var tagName=el.tagName.toLowerCase();try{_this13.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"svg|<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}el.hasAttribute("data-passage")&&_this13.processDataAttributes(el,tagName)})),$frag.appendTo(w.output)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref10){var name=_ref10.name,value=_ref10.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if("image"===tagName)"data:"!==passage.slice(0,5)&&Story.has(passage)&&(passage=Story.get(passage)).tags.includes("Twine.image")&&el.setAttribute("href",passage.text.trim());else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<".concat(Patterns.htmlTagName,"(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>"),tagRe:new RegExp("^<(".concat(Patterns.htmlTagName,")")),mediaTags:["audio","img","source","track","video"],nobrTags:["audio","colgroup","datalist","dl","figure","meter","ol","optgroup","picture","progress","ruby","select","table","tbody","tfoot","thead","tr","ul","video"],voidTags:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],handler:function(w){var tagMatch=this.tagRe.exec(w.matchText),tag=tagMatch&&tagMatch[1],tagName=tag&&tag.toLowerCase();if(tagName){var terminator,terminatorMatch,isVoid=this.voidTags.includes(tagName)||w.matchText.endsWith("/>"),isNobr=this.nobrTags.includes(tagName);if(!isVoid){terminator="<\\/".concat(tagName,"\\s*>");var terminatorRe=new RegExp(terminator,"gim");terminatorRe.lastIndex=w.matchStart,terminatorMatch=terminatorRe.exec(w.source)}if(!isVoid&&!terminatorMatch)return throwError(w.output,"cannot find a closing tag for HTML <".concat(tag,">"),"".concat(w.matchText,"…"));var debugView,output=w.output,el=document.createElement(w.output.tagName);for(el.innerHTML=w.matchText;el.firstChild;)el=el.firstChild;try{this.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}if(el.hasAttribute("data-passage")&&(this.processDataAttributes(el,tagName),Config.debug&&((debugView=new DebugView(w.output,"html-".concat(tagName),tagName,w.matchText)).modes({block:"img"===tagName,nonvoid:terminatorMatch}),output=debugView.output)),terminatorMatch){try{Wikifier.Option.push({nobr:isNobr}),w.subWikify(el,terminator,{ignoreTerminatorCase:!0})}finally{Wikifier.Option.pop()}debugView&&jQuery(el).find(".debug.block").length>0&&debugView.modes({block:!0})}output.appendChild("track"===tagName?el.cloneNode(!0):el)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref11){var name=_ref11.name,value=_ref11.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if(this.mediaTags.includes(tagName)){if("data:"!==passage.slice(0,5)&&Story.has(passage)){var parentName,twineTag;switch(passage=Story.get(passage),tagName){case"audio":case"video":twineTag="Twine.".concat(tagName);break;case"img":twineTag="Twine.image";break;case"track":twineTag="Twine.vtt";break;case"source":var $parent=$(el).closest("audio,picture,video");$parent.length&&(parentName=$parent.get(0).tagName.toLowerCase(),twineTag="Twine.".concat("picture"===parentName?"image":parentName))}passage.tags.includes(twineTag)&&(el["picture"===parentName?"srcset":"src"]=passage.text.trim())}}else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}})}();var Template=(_templates=new Map,_validNameRe=new RegExp("^(?:".concat(Patterns.templateName,")$")),_validType=function(template){var templateType=_typeof(template);return"function"===templateType||"string"===templateType},Object.freeze(Object.defineProperties({},{add:{value:function(name,template){if(!(_validType(template)||template instanceof Array&&template.length>0&&template.every(_validType)))throw new TypeError("invalid template type (".concat(name,"); templates must be: functions, strings, or an array of either"));(name instanceof Array?name:[name]).forEach((function(name){if(!_validNameRe.test(name))throw new Error('invalid template name "'.concat(name,'"'));if(_templates.has(name))throw new Error("cannot clobber existing template ?".concat(name));_templates.set(name,template)}))}},delete:{value:function(name){(name instanceof Array?name:[name]).forEach((function(name){return _templates.delete(name)}))}},get:{value:function(name){return _templates.has(name)?_templates.get(name):null}},has:{value:function(name){return _templates.has(name)}},size:{get:function(){return _templates.size}}}))),_templates,_validNameRe,_validType,Macro=function(){var _macros={},_tags={},_validNameRe=new RegExp("^(?:".concat(Patterns.macroName,")$"));function macrosHas(name){return _macros.hasOwnProperty(name)}function tagsRegister(parent,bodyTags){if(!parent)throw new Error("no parent specified");for(var endTags=["/".concat(parent),"end".concat(parent)],allTags=[].concat(endTags,Array.isArray(bodyTags)?bodyTags:[]),i=0;i<allTags.length;++i){var tag=allTags[i];if(macrosHas(tag))throw new Error("cannot register tag for an existing macro");tagsHas(tag)?_tags[tag].includes(parent)||(_tags[tag].push(parent),_tags[tag].sort()):_tags[tag]=[parent]}}function tagsUnregister(parent){if(!parent)throw new Error("no parent specified");Object.keys(_tags).forEach((function(tag){var i=_tags[tag].indexOf(parent);-1!==i&&(1===_tags[tag].length?delete _tags[tag]:_tags[tag].splice(i,1))}))}function tagsHas(name){return _tags.hasOwnProperty(name)}return Object.freeze(Object.defineProperties({},{add:{value:function macrosAdd(name,def){if(Array.isArray(name))name.forEach((function(name){return macrosAdd(name,def)}));else{if(!_validNameRe.test(name))throw new Error('invalid macro name "'.concat(name,'"'));if(macrosHas(name))throw new Error("cannot clobber existing macro <<".concat(name,">>"));if(tagsHas(name))throw new Error("cannot clobber child tag <<".concat(name,">> of parent macro").concat(1===_tags[name].length?"":"s"," <<").concat(_tags[name].join(">>, <<"),">>"));try{if("object"===_typeof(def))_macros[name]=Object.assign(Object.create(null),def,{_MACRO_API:!0});else{if(!macrosHas(def))throw new Error("cannot create alias of nonexistent macro <<".concat(def,">>"));_macros[name]=Object.create(_macros[def],{_ALIAS_OF:{enumerable:!0,value:def}})}Object.defineProperty(_macros,name,{writable:!1})}catch(ex){throw"TypeError"===ex.name?new Error("cannot clobber protected macro <<".concat(name,">>")):new Error("unknown error when attempting to add macro <<".concat(name,">>: [").concat(ex.name,"] ").concat(ex.message))}if(void 0!==_macros[name].tags)if(null==_macros[name].tags)tagsRegister(name);else{if(!Array.isArray(_macros[name].tags))throw new Error('bad value for "tags" property of macro <<'.concat(name,">>"));tagsRegister(name,_macros[name].tags)}}}},delete:{value:function macrosDelete(name){if(Array.isArray(name))name.forEach((function(name){return macrosDelete(name)}));else if(macrosHas(name)){void 0!==_macros[name].tags&&tagsUnregister(name);try{Object.defineProperty(_macros,name,{writable:!0}),delete _macros[name]}catch(ex){throw new Error("unknown error removing macro <<".concat(name,">>: ").concat(ex.message))}}else if(tagsHas(name))throw new Error("cannot remove child tag <<".concat(name,">> of parent macro <<").concat(_tags[name],">>"))}},isEmpty:{value:function(){return 0===Object.keys(_macros).length}},has:{value:macrosHas},get:{value:function(name){var macro=null;return macrosHas(name)&&"function"==typeof _macros[name].handler?macro=_macros[name]:macros.hasOwnProperty(name)&&"function"==typeof macros[name].handler&&(macro=macros[name]),macro}},init:{value:function(){var handler=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(_macros).forEach((function(name){"function"==typeof _macros[name][handler]&&_macros[name][handler](name)})),Object.keys(macros).forEach((function(name){"function"==typeof macros[name][handler]&&macros[name][handler](name)}))}},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:function(name){return tagsHas(name)?_tags[name]:null}}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var MacroContext=function(){function MacroContext(contextData){_classCallCheck(this,MacroContext);var context=Object.assign({parent:null,macro:null,name:"",displayName:"",args:null,payload:null,parser:null,source:""},contextData);if(null===context.macro||""===context.name||null===context.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{self:{value:context.macro},name:{value:void 0===context.macro._ALIAS_OF?context.name:context.macro._ALIAS_OF},displayName:{value:context.name},args:{value:context.args},payload:{value:context.payload},source:{value:context.source},parent:{value:context.parent},parser:{value:context.parser},_output:{value:context.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(MacroContext,[{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return _toConsumableArray(this._shadows)}},{key:"shadowView",get:function(){var view=new Set;return this.contextSelectAll((function(ctx){return ctx._shadows})).forEach((function(ctx){return ctx._shadows.forEach((function(name){return view.add(name)}))})),_toConsumableArray(view)}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}},{key:"contextHas",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return!0;return!1}},{key:"contextSelect",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return context;return null}},{key:"contextSelectAll",value:function(filter){for(var result=[],context=this;null!==(context=context.parent);)filter(context)&&result.push(context);return result}},{key:"addShadow",value:function(){var _this14=this;this._shadows||(this._shadows=new Set);for(var varRe=new RegExp("^".concat(Patterns.variable,"$")),_len14=arguments.length,names=new Array(_len14),_key14=0;_key14<_len14;_key14++)names[_key14]=arguments[_key14];names.flat(1/0).forEach((function(name){if("string"!=typeof name)throw new TypeError("variable name must be a string; type: ".concat(_typeof(name)));if(!varRe.test(name))throw new Error('invalid variable name "'.concat(name,'"'));_this14._shadows.add(name)}))}},{key:"createShadowWrapper",value:function(callback,doneCallback,startCallback){var shadowStore,shadowContext=this;return"function"==typeof callback&&(shadowStore={},this.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]}))),function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];if("function"==typeof startCallback&&startCallback.apply(this,args),"function"==typeof callback){var contextCache,shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null,macroParser=Wikifier.Parser.get("macro");try{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),contextCache=macroParser.context,macroParser.context=shadowContext,callback.apply(this,args)}finally{contextCache!==undefined&&(macroParser.context=contextCache),shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}"function"==typeof doneCallback&&doneCallback.apply(this,args)}}},{key:"createDebugView",value:function(name,title){return this._debugView=new DebugView(this._output,"macro",name||this.displayName,title||this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(message,source){return throwError(this._output,"<<".concat(this.displayName,">>: ").concat(message),source||this.source)}}]),MacroContext}();return MacroContext}();!function(){if(Macro.add("capture",{skipArgs:!0,tags:null,tsVarRe:new RegExp("(".concat(Patterns.variable,")"),"g"),handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var valueCache={};try{for(var match,tsVarRe=this.self.tsVarRe;null!==(match=tsVarRe.exec(this.args.raw));){var varName=match[1],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),this.addShadow(varName)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,jsVarRe:new RegExp("State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var match,jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var store=State[match[1]],name=match[2];store.hasOwnProperty(name)&&delete store[name]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}for(var match,remember=storage.get("remember")||{},jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];remember[name]=State.variables[name]}if(!storage.set("remember",remember))return this.error("unknown error, cannot remember: ".concat(this.args.raw));Config.debug&&this.debugView.modes({hidden:!0})},init:function(){var remember=storage.get("remember");remember&&Object.keys(remember).forEach((function(name){return State.variables[name]=remember[name]}))}}),Macro.add("forget",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var match,remember=storage.get("remember"),jsVarRe=this.self.jsVarRe,needStore=!1;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];State.variables.hasOwnProperty(name)&&delete State.variables[name],remember&&remember.hasOwnProperty(name)&&(needStore=!0,delete remember[name])}if(needStore)if(0===Object.keys(remember).length){if(!storage.delete("remember"))return this.error("unknown error, cannot update remember store")}else if(!storage.set("remember",remember))return this.error("unknown error, cannot update remember store");Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var output=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,output)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.createDebugView(),output.hasChildNodes()&&this.output.appendChild(output)}}),Macro.add("include",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?(Config.debug&&this.debugView.modes({block:!0}),passage=Story.get(passage),void(this.args[1]?jQuery(document.createElement(this.args[1])).addClass("".concat(passage.domId," macro-").concat(this.name)).attr("data-passage",passage.title).appendTo(this.output):jQuery(this.output)).wiki(passage.processText())):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var result=stringFrom(Scripting.evalJavaScript(this.args.full));null!==result&&new Wikifier(this.output,"-"===this.name?Util.escape(result):result)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var frag=document.createDocumentFragment();if(new Wikifier(frag,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({block:!0,hidden:!0}),this.output.appendChild(frag);else{var errList=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent}));if(errList.length>0)return this.error("error".concat(1===errList.length?"":"s"," within contents (").concat(errList.join("; "),")"))}}}),Macro.add("type",{isAsync:!0,tags:null,typeId:0,handler:function(){if(0===this.args.length)return this.error("no speed specified");var cursor,speed=Util.fromCssTime(this.args[0]);if(speed<0)return this.error("speed time value must be non-negative (received: ".concat(this.args[0],")"));for(var elClass="",elId="",elTag="div",skipKey=Config.macros.typeSkipKey,start=400,options=this.args.slice(1);options.length>0;){var option=options.shift();switch(option){case"class":if(0===options.length)return this.error("class option missing required class name(s)");if(""===(elClass=options.shift()))throw new Error('class option class name(s) must be non-empty (received: "")');break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=options.shift()))throw new Error('element option tag name must be non-empty (received: "")');break;case"id":if(0===options.length)return this.error("id option missing required ID");if(""===(elId=options.shift()))throw new Error('id option ID must be non-empty (received: "")');break;case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":if(0===options.length)return this.error("skipkey option missing required key value");if(""===(skipKey=options.shift()))throw new Error('skipkey option key value must be non-empty (received: "")');break;case"start":if(0===options.length)return this.error("start option missing required time value");var value=options.shift();if((start=Util.fromCssTime(value))<0)throw new Error("start option time value must be non-negative (received: ".concat(value,")"));break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:!0});var className="macro-".concat(this.name),namespace=".".concat(className),$target=jQuery(document.createElement(elTag)).addClass("".concat(className," ").concat(className,"-target")).appendTo(this.output);TempState.macroTypeQueue||(TempState.macroTypeQueue=[],$(document).off(namespace).one(":passageinit".concat(namespace),(function(){return $(document).off(namespace)})));var startTyping=0===TempState.macroTypeQueue.length,selfId=++this.self.typeId;TempState.macroTypeQueue.push({id:selfId,handler:function(){var $wrapper=jQuery(document.createElement(elTag)).addClass(className);elId&&$wrapper.attr("id",elId),elClass&&$wrapper.addClass(elClass),new Wikifier($wrapper,contents);var passage=State.passage,turn=State.turns;if(!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((function(title){return title===passage}))||$wrapper.find(".error").length>0)return $target.replaceWith($wrapper),TempState.macroTypeQueue.shift(),void(TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().handler());var typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:"none"===cursor?null:"".concat(className,"-cursor")});$target.replaceWith($wrapper);var keydownAndNS="keydown".concat(namespace),typingStopAndNS="".concat(":typingstop").concat(namespace);$(document).off(keydownAndNS).on(keydownAndNS,(function(ev){Util.scrubEventKey(ev.key)!==skipKey||ev.target!==document.body&&ev.target!==document.documentElement||(ev.preventDefault(),$(document).off(keydownAndNS),typer.finish())})).one(typingStopAndNS,(function(){TempState.macroTypeQueue&&(0===TempState.macroTypeQueue.length?jQuery.event.trigger(":typingcomplete"):TempState.macroTypeQueue.first().handler())}));var typeNode=function(){var typeNodeMember=function(typeIntervalId){State.passage===passage&&State.turns===turn&&typer.type()||(typeIntervalId&&clearInterval(typeIntervalId),TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId&&TempState.macroTypeQueue.shift(),$wrapper.trigger(":typingstop"),$wrapper.addClass("".concat(className,"-done")),"keep"===cursor&&$wrapper.addClass("".concat(className,"-cursor")))};$wrapper.trigger(":typingstart"),typeNodeMember();var typeNodeMemberId=setInterval((function(){return typeNodeMember(typeNodeMemberId)}),speed)};start?setTimeout(typeNode,start):typeNode()}}),startTyping&&(Engine.isPlaying()?$(document).one(":passageend".concat(namespace),(function(){return TempState.macroTypeQueue.first().handler()})):TempState.macroTypeQueue.first().handler())}}}),Macro.add("display","include"),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],elseifWsRe:/^\s*if\b/i,ifAssignRe:/[^!=&^|<>*/%+-]=[^=>]/,handler:function(){var i;try{var len=this.payload.length,elseifWsRe=this.self.elseifWsRe,ifAssignRe=this.self.ifAssignRe;for(i=0;i<len;++i)if("else"===this.payload[i].name){if(this.payload[i].args.raw.length>0)return elseifWsRe.test(this.payload[i].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'.concat(i>0?" (#"+i+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<else>> must be the final clause")}else{if(0===this.payload[i].args.full.length)return this.error("no conditional expression specified for <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""));if(Config.macros.ifAssignmentError&&ifAssignRe.test(this.payload[i].args.full))return this.error("assignment operator found within <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""," (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: ").concat(this.payload[i].args.raw))}var evalJavaScript=Scripting.evalJavaScript,success=!1;for(i=0;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"else"===this.payload[i].name||evalJavaScript(this.payload[i].args.full)){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!success,invalid:!success})}}catch(ex){return this.error("bad conditional expression in <<".concat(0===i?"if":"elseif",">> clause").concat(i>0?" (#"+i+")":"",": ").concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("switch",{skipArgs:["switch"],tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var i,result,len=this.payload.length;if(1===len)return this.error("no cases specified");for(i=1;i<len;++i)if("default"===this.payload[i].name){if(this.payload[i].args.length>0)return this.error("<<default>> does not accept values, invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<default>> must be the final case")}else if(0===this.payload[i].args.length)return this.error("no value(s) specified for <<".concat(this.payload[i].name,">> (#").concat(i,")"));try{result=Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}var debugView=this.debugView,success=!1;for(Config.debug&&debugView.modes({nonvoid:!1,hidden:!0}),i=1;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"default"===this.payload[i].name||this.payload[i].args.some((function(val){return val===result}))){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});debugView.modes({nonvoid:!1,hidden:!0,invalid:!success}),this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0,invalid:!success})}}}),Macro.add("for",{skipArgs:!0,tags:null,hasRangeRe:new RegExp("^\\S".concat(Patterns.anyChar,"*?\\s+range\\s+\\S").concat(Patterns.anyChar,"*?$")),rangeRe:new RegExp("^(?:State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")\\s*,\\s*)?State\\.(variables|temporary)\\.(").concat(Patterns.identifier,")\\s+range\\s+(\\S").concat(Patterns.anyChar,"*?)$")),threePartRe:/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/,forInRe:/^\S+\s+in\s+\S+/i,forOfRe:/^\S+\s+of\s+\S+/i,handler:function(){var argsStr=this.args.full.trim(),payload=this.payload[0].contents.replace(/\n$/,"");if(0===argsStr.length)this.self.handleFor.call(this,payload,null,!0,null);else if(this.self.hasRangeRe.test(argsStr)){var parts=argsStr.match(this.self.rangeRe);if(null===parts)return this.error("invalid range form syntax, format: [index ,] value range collection");this.self.handleForRange.call(this,payload,{type:parts[1],name:parts[2]},{type:parts[3],name:parts[4]},parts[5])}else{var init,condition,post;if(-1===argsStr.indexOf(";")){if(this.self.forInRe.test(argsStr))return this.error("invalid syntax, for…in is not supported; see: for…range");if(this.self.forOfRe.test(argsStr))return this.error("invalid syntax, for…of is not supported; see: for…range");condition=argsStr}else{var _parts=argsStr.match(this.self.threePartRe);if(null===_parts)return this.error("invalid 3-part conditional form syntax, format: [init] ; [condition] ; [post]");init=_parts[1],condition=_parts[2].trim(),post=_parts[3],0===condition.length&&(condition=!0)}this.self.handleFor.call(this,payload,init,condition,post)}},handleFor:function(payload,init,condition,post){var evalJavaScript=Scripting.evalJavaScript,first=!0,safety=Config.macros.maxLoopIterations;Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,init)try{evalJavaScript(init)}catch(ex){return this.error("bad init expression: ".concat("object"===_typeof(ex)?ex.message:ex))}for(;evalJavaScript(condition);){if(--safety<0)return this.error("exceeded configured maximum loop iterations (".concat(Config.macros.maxLoopIterations,")"));if(new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(post)try{evalJavaScript(post)}catch(ex){return this.error("bad post expression: ".concat("object"===_typeof(ex)?ex.message:ex))}}}catch(ex){return this.error("bad conditional expression: ".concat("object"===_typeof(ex)?ex.message:ex))}finally{TempState.break=null}},handleForRange:function(payload,indexVar,valueVar,rangeExp){var rangeList,first=!0;try{rangeList=this.self.toRangeList(rangeExp)}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});try{TempState.break=null;for(var i=0;i<rangeList.length;++i)if(indexVar.name&&(State[indexVar.type][indexVar.name]=rangeList[i][0]),State[valueVar.type][valueVar.name]=rangeList[i][1],new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}}catch(ex){return this.error("object"===_typeof(ex)?ex.message:ex)}finally{TempState.break=null}},toRangeList:function(rangeExp){var value,list,evalJavaScript=Scripting.evalJavaScript;try{value=evalJavaScript("{"===rangeExp[0]?"(".concat(rangeExp,")"):rangeExp)}catch(ex){if("object"!==_typeof(ex))throw new Error("bad range expression: ".concat(ex));throw ex.message="bad range expression: ".concat(ex.message),ex}switch(_typeof(value)){case"string":list=[];for(var i=0;i<value.length;){var obj=Util.charAndPosAt(value,i);list.push([i,obj.char]),i=1+obj.end}break;case"object":if(Array.isArray(value))list=value.map((function(val,i){return[i,val]}));else if(value instanceof Set)list=_toConsumableArray(value).map((function(val,i){return[i,val]}));else if(value instanceof Map)list=_toConsumableArray(value.entries());else{if("Object"!==Util.toStringTag(value))throw new Error("unsupported range expression type: ".concat(Util.toStringTag(value)));list=Object.keys(value).map((function(key){return[key,value[key]]}))}break;default:throw new Error("unsupported range expression type: ".concat(_typeof(value)))}return list}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){if(!this.contextHas((function(ctx){return"for"===ctx.name})))return this.error("must only be used in conjunction with its parent macro <<for>>");TempState.break="continue"===this.name?1:2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var _this15=this;if(0===this.args.length)return this.error("no ".concat("button"===this.name?"button":"link"," text specified"));var passage,$link=jQuery(document.createElement("button"===this.name?"button":"a"));if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var $image=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo($link);$link.addClass("link-image"),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link}else $link.append(document.createTextNode(this.args[0].text)),passage=this.args[0].link;else $link.wikiWithOptions({profile:"core"},this.args[0]),passage=this.args.length>1?this.args[1]:undefined;null!=passage?($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken")):$link.addClass("link-internal"),$link.addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:null!=passage?"link":"button",one:null!=passage},this.createShadowWrapper(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(_this15.payload[0].contents.trim())}:null,null!=passage?function(){return Engine.play(passage)}:null)).appendTo(this.output)}}),Macro.add("checkbox",{isAsync:!0,handler:function(){if(this.args.length<3){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("unchecked value"),this.args.length<3&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),uncheckValue=this.args[1],checkValue=this.args[2],el=document.createElement("input");switch(jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:"checkbox",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.checked?checkValue:uncheckValue)}))).appendTo(this.output),this.args[3]){case"autocheck":State.getVar(varName)===checkValue?el.checked=!0:State.setVar(varName,uncheckValue);break;case"checked":el.checked=!0,State.setVar(varName,checkValue);break;default:State.setVar(varName,uncheckValue)}}}),Macro.add(["cycle","listbox"],{isAsync:!0,skipArgs:["optionsfrom"],tags:["option","optionsfrom"],handler:function(){var _this16=this;if(0===this.args.length)return this.error("no variable name specified");if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),len=this.payload.length;if(1===len)return this.error("no options specified");for(var config={autoselect:!1,once:!1},i=1;i<this.args.length;++i){var arg=this.args[i];switch(arg){case"once":config.once=!0;break;case"autoselect":config.autoselect=!0;break;default:return this.error("unknown argument: ".concat(arg))}}for(var options=[],tagCount={option:0,optionsfrom:0},selectedIdx=-1,_i5=1;_i5<len;++_i5){var payload=this.payload[_i5];if("option"===payload.name){if(++tagCount.option,0===payload.args.length)return this.error("no arguments specified for <<".concat(payload.name,">> (#").concat(tagCount.option,")"));var option={label:String(payload.args[0])},isSelected=!1;switch(payload.args.length){case 1:option.value=payload.args[0];break;case 2:"selected"===payload.args[1]?(option.value=payload.args[0],isSelected=!0):option.value=payload.args[1];break;default:option.value=payload.args[1],"selected"===payload.args[2]&&(isSelected=!0)}if(options.push(option),isSelected){if(config.autoselect)return this.error("cannot specify both the autoselect and selected keywords");if(-1!==selectedIdx)return this.error("multiple selected keywords specified for <<".concat(payload.name,">> (#").concat(selectedIdx+1," & #").concat(tagCount.option,")"));selectedIdx=options.length-1}}else{var _ret=function(){if(++tagCount.optionsfrom,0===payload.args.full.length)return{v:_this16.error("no expression specified for <<".concat(payload.name,">> (#").concat(tagCount.optionsfrom,")"))};var result=void 0;try{var exp=payload.args.full;result=Scripting.evalJavaScript("{"===exp[0]?"(".concat(exp,")"):exp)}catch(ex){return{v:_this16.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}if("object"!==_typeof(result)||null===result)return{v:_this16.error("expression must yield a supported collection or generic object (type: ".concat(null===result?"null":_typeof(result),")"))};if(result instanceof Array||result instanceof Set)result.forEach((function(val){return options.push({label:String(val),value:val})}));else if(result instanceof Map)result.forEach((function(val,key){return options.push({label:String(key),value:val})}));else{var oType=Util.toStringTag(result);if("Object"!==oType)return{v:_this16.error("expression must yield a supported collection or generic object (object type: ".concat(oType,")"))};Object.keys(result).forEach((function(key){return options.push({label:key,value:result[key]})}))}}();if("object"===_typeof(_ret))return _ret.v}}if(-1===selectedIdx)if(config.autoselect){var sameValueZero=Util.sameValueZero,curValue=State.getVar(varName),curValueIdx=options.findIndex((function(opt){return sameValueZero(opt.value,curValue)}));selectedIdx=-1===curValueIdx?0:curValueIdx}else selectedIdx=0;if("cycle"===this.name){var lastIdx=options.length-1;if(config.once&&selectedIdx===lastIdx)jQuery(this.output).wikiWithOptions({profile:"core"},options[selectedIdx].label);else{var cycleIdx=selectedIdx;jQuery(document.createElement("a")).wikiWithOptions({profile:"core"},options[selectedIdx].label).attr("id","".concat(this.name,"-").concat(varId)).addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:"button"},this.createShadowWrapper((function(){var $this=$(this);cycleIdx=(cycleIdx+1)%options.length,State.setVar(varName,options[cycleIdx].value),$this.empty().wikiWithOptions({profile:"core"},options[cycleIdx].label),config.once&&cycleIdx===lastIdx&&$this.off().contents().unwrap()}))).appendTo(this.output)}}else{var $select=jQuery(document.createElement("select"));options.forEach((function(opt,i){jQuery(document.createElement("option")).val(i).text(opt.label).appendTo($select)})),$select.attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),tabindex:0}).addClass("macro-".concat(this.name)).val(selectedIdx).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,options[Number(this.value)].value)}))).appendTo(this.output)}State.setVar(varName,options[selectedIdx].value)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this17=this;if(0===this.args.length)return this.error("no link text specified");var $link=jQuery(document.createElement("a")),$insert=jQuery(document.createElement("span")),transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]);$link.wikiWithOptions({profile:"core"},this.args[0]).addClass("link-internal macro-".concat(this.name)).ariaClick({namespace:".macros",one:!0},this.createShadowWrapper((function(){if("linkreplace"===_this17.name?$link.remove():$link.wrap('<span class="macro-'.concat(_this17.name,'"></span>')).replaceWith((function(){return $link.html()})),""!==_this17.payload[0].contents){var frag=document.createDocumentFragment();new Wikifier(frag,_this17.payload[0].contents),$insert.append(frag)}transition&&setTimeout((function(){return $insert.removeClass("macro-".concat(_this17.name,"-in"))}),Engine.minDomActionDelay)}))).appendTo(this.output),$insert.addClass("macro-".concat(this.name,"-insert")),transition&&$insert.addClass("macro-".concat(this.name,"-in")),"linkprepend"===this.name?$insert.insertBefore($link):$insert.insertAfter($link)}}),Macro.add(["numberbox","textbox"],{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var asNumber="numberbox"===this.name,defaultValue=asNumber?Number(this.args[1]):this.args[1];if(asNumber&&Number.isNaN(defaultValue))return this.error('default value "'.concat(this.args[1],'" is neither a number nor can it be parsed into a number'));var passage,varId=Util.slugify(varName),el=document.createElement("input"),autofocus=!1;this.args.length>3?(passage=this.args[2],autofocus="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?autofocus=!0:passage=this.args[2]),"object"===_typeof(passage)&&(passage=passage.link),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:asNumber?"number":"text",inputmode:asNumber?"decimal":"text",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,asNumber?Number(this.value):this.value)}))).on("keypress.macros",this.createShadowWrapper((function(ev){13===ev.which&&(ev.preventDefault(),State.setVar(varName,asNumber?Number(this.value):this.value),null!=passage&&Engine.play(passage))}))).appendTo(this.output),asNumber&&(el.step="any"),State.setVar(varName,defaultValue),el.value=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("radiobutton",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),checkValue=this.args[1],el=document.createElement("input");switch(TempState.hasOwnProperty(this.name)||(TempState[this.name]={}),TempState[this.name].hasOwnProperty(varId)||(TempState[this.name][varId]=0),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId,"-").concat(TempState[this.name][varId]++),name:"".concat(this.name,"-").concat(varId),type:"radio",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){this.checked&&State.setVar(varName,checkValue)}))).appendTo(this.output),this.args[2]){case"autocheck":State.getVar(varName)===checkValue&&(el.checked=!0);break;case"checked":el.checked=!0,State.setVar(varName,checkValue)}}}),Macro.add("textarea",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var varId=Util.slugify(varName),defaultValue=this.args[1],autofocus="autofocus"===this.args[2],el=document.createElement("textarea");jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),rows:4,tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.value)}))).appendTo(this.output),State.setVar(varName,defaultValue),el.textContent=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){for(var $list=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),i=0;i<this.args.length;++i){var passage=void 0,text=void 0,$image=void 0,setFn=void 0;if("object"===_typeof(this.args[i])?this.args[i].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[i].source),this.args[i].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[i].passage),this.args[i].hasOwnProperty("title")&&$image.attr("title",this.args[i].title),this.args[i].hasOwnProperty("align")&&$image.attr("align",this.args[i].align),passage=this.args[i].link,setFn=this.args[i].setFn):(text=this.args[i].text,passage=this.args[i].link,setFn=this.args[i].setFn):text=passage=this.args[i],!(State.variables.hasOwnProperty("#actions")&&State.variables["#actions"].hasOwnProperty(passage)&&State.variables["#actions"][passage])){var $link=jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo($list),passage,null,function(passage,fn){return function(){State.variables.hasOwnProperty("#actions")||(State.variables["#actions"]={}),State.variables["#actions"][passage]=!0,"function"==typeof fn&&fn()}}(passage,setFn))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text));$image&&$link.addClass("link-image")}}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var passage,text,$image,$link,momentIndex=-1;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(passage=this.args[0].link)):(1===this.args[0].count||(text=this.args[0].text),passage=this.args[0].link):1===this.args.length&&(text=this.args[0])),null==passage){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){momentIndex=i,passage=State.history[i].title;break}if(null==passage&&"return"===this.name)for(var _i6=State.expired.length-1;_i6>=0;--_i6)if(State.expired[_i6]!==State.passage){passage=State.expired[_i6];break}}else{if(!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));if("back"===this.name){for(var _i7=State.length-2;_i7>=0;--_i7)if(State.history[_i7].title===passage){momentIndex=_i7;break}if(-1===momentIndex)return this.error('cannot find passage "'.concat(passage,'" in the current story history'))}}if(null==passage)return this.error("cannot find passage");"back"!==this.name||-1!==momentIndex?($link=jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(passage)}:function(){return Engine.goTo(momentIndex)}),$image&&$link.addClass("link-image")):$link=jQuery(document.createElement("span")).addClass("link-disabled"),$link.addClass("macro-".concat(this.name)).append($image||document.createTextNode(text||L10n.get("macro".concat(this.name.toUpperFirst(),"Text")))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var passage,text,$image,setFn,$link,choiceId=State.passage;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link,setFn=this.args[0].setFn):(text=this.args[0].text,passage=this.args[0].link,setFn=this.args[0].setFn):text=passage=this.args[0]:(passage=this.args[0],text=this.args[1]),State.variables.hasOwnProperty("#choice")&&State.variables["#choice"].hasOwnProperty(choiceId)&&State.variables["#choice"][choiceId])return $link=jQuery(document.createElement("span")).addClass("link-disabled macro-".concat(this.name)).attr("tabindex",-1).append($image||document.createTextNode(text)).appendTo(this.output),void($image&&$link.addClass("link-image"));$link=jQuery(Wikifier.createInternalLink(this.output,passage,null,(function(){State.variables.hasOwnProperty("#choice")||(State.variables["#choice"]={}),State.variables["#choice"][choiceId]=!0,"function"==typeof setFn&&setFn()}))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text)),$image&&$link.addClass("link-image")}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("selector"),this.args.length<2&&errors.push("class names"),this.error("no ".concat(errors.join(" or ")," specified"))}var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));switch(this.name){case"addclass":$targets.addClass(this.args[1].trim());break;case"toggleclass":$targets.toggleClass(this.args[1].trim())}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));this.args.length>1?$targets.removeClass(this.args[1].trim()):$targets.removeClass(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));jQuery(this.output).append($targets.html()),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["append","prepend","replace"],{tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this18=this;if(0===this.args.length)return this.error("no selector specified");var $insert,$targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));if(""!==this.payload[0].contents)switch(this.args.length>1&&this.self.t8nRe.test(this.args[1])?(($insert=jQuery(document.createElement("span"))).addClass("macro-".concat(this.name,"-insert macro-").concat(this.name,"-in")),setTimeout((function(){return $insert.removeClass("macro-".concat(_this18.name,"-in"))}),Engine.minDomActionDelay)):$insert=jQuery(document.createDocumentFragment()),$insert.wiki(this.payload[0].contents),this.name){case"replace":$targets.empty();case"append":$targets.append($insert);break;case"prepend":$targets.prepend($insert)}else"replace"===this.name&&$targets.empty();Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));$targets.remove(),Config.debug&&this.debugView.modes({hidden:!0})}}),Has.audio){var errorOnePlaybackAction=function(cur,prev){return'only one playback action allowed per invocation, "'.concat(cur,'" cannot be combined with "').concat(prev,'"')};Macro.add("audio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track and/or group IDs"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var selected;try{selected=SimpleAudio.select(this.args[0])}catch(ex){return this.error(ex.message)}for(var action,fadeTo,loop,mute,passage,time,volume,args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors=[];return args.length<1&&_errors.push("seconds"),args.length<2&&_errors.push("level"),this.error("fadeoverto missing required ".concat(_errors.join(" and ")," value").concat(_errors.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"time":if(0===args.length)return this.error("time missing required seconds value");if(raw=args.shift(),time=Number.parseFloat(raw),Number.isNaN(time)||!Number.isFinite(time))return this.error("cannot parse time: ".concat(raw));break;case"loop":case"unloop":loop="loop"===arg;break;case"goto":if(0===args.length)return this.error("goto missing required passage title");if(raw=args.shift(),passage="object"===_typeof(raw)?raw.link:raw,!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));break;default:return this.error("unknown action: ".concat(arg))}}try{if(null!=volume&&selected.volume(volume),null!=time&&selected.time(time),null!=mute&&selected.mute(mute),null!=loop&&selected.loop(loop),null!=passage){var nsEnded="ended.macros.macro-".concat(this.name,"_goto");selected.off(nsEnded).one(nsEnded,(function(){selected.off(nsEnded),Engine.play(passage)}))}switch(action){case"fade":selected.fade(fadeOver,fadeTo);break;case"load":selected.load();break;case"pause":selected.pause();break;case"play":selected.playWhenAllowed();break;case"stop":selected.stop();break;case"unload":selected.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("cacheaudio",{handler:function(){var _this19=this;if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track ID"),this.args.length<2&&errors.push("sources"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim(),oldFmtRe=/^format:\s*([\w-]+)\s*;\s*/i;try{SimpleAudio.tracks.add(id,this.args.slice(1).map((function(source){if(oldFmtRe.test(source)){if(Config.debug)return _this19.error('track ID "'.concat(id,'": format specifier migration required, "format:formatId;" → "formatId|"'));source=source.replace(oldFmtRe,"$1|")}return source})))}catch(ex){return this.error(ex.message)}if(Config.debug&&!SimpleAudio.tracks.get(id).hasSource())return this.error('track ID "'.concat(id,'": no supported audio sources found'));Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var groupId=String(this.args[0]).trim(),trackIds=[],i=1,len=this.payload.length;i<len;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");trackIds.push(String(this.payload[i].args[0]).trim()),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.groups.add(groupId,trackIds)}catch(ex){return this.error(ex.message)}Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no list ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");var playlist=Macro.get("playlist");if(null!==playlist.from&&"createplaylist"!==playlist.from)return this.error("a playlist has already been defined with <<setplaylist>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var listId=String(this.args[0]).trim(),trackObjs=[],i=1,len=this.payload.length;i<len;++i){if(0===this.payload[i].args.length)return this.error("no track ID specified");for(var trackObj={id:String(this.payload[i].args[0]).trim()},args=this.payload[i].args.slice(1);args.length>0;){var arg=args.shift(),raw=void 0,parsed=void 0;switch(arg){case"copy":case"own":trackObj.own=!0;break;case"rate":args.length>0&&args.shift();break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),parsed=Number.parseFloat(raw),Number.isNaN(parsed)||!Number.isFinite(parsed))return this.error("cannot parse volume: ".concat(raw));trackObj.volume=parsed;break;default:return this.error("unknown action: ".concat(arg))}}trackObjs.push(trackObj),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.lists.add(listId,trackObjs)}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="createplaylist"),Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var action,mute,muteOnHide,volume,args=this.args.slice(0);args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"mute":case"unmute":mute="mute"===arg;break;case"muteonhide":case"nomuteonhide":muteOnHide="muteonhide"===arg;break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=mute&&SimpleAudio.mute(mute),null!=muteOnHide&&SimpleAudio.muteOnHidden(muteOnHide),null!=volume&&SimpleAudio.volume(volume),action){case"load":SimpleAudio.load();break;case"stop":SimpleAudio.stop();break;case"unload":SimpleAudio.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("playlist",{from:null,handler:function(){var list,args,action,from=this.self.from;if(null===from)return this.error("no playlists have been created");if("createplaylist"===from){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("list ID"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));list=SimpleAudio.lists.get(id),args=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");list=SimpleAudio.lists.get("setplaylist"),args=this.args.slice(0)}for(var fadeTo,loop,mute,shuffle,volume,fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"skip":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors2=[];return args.length<1&&_errors2.push("seconds"),args.length<2&&_errors2.push("level"),this.error("fadeoverto missing required ".concat(_errors2.join(" and ")," value").concat(_errors2.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"loop":case"unloop":loop="loop"===arg;break;case"shuffle":case"unshuffle":shuffle="shuffle"===arg;break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=volume&&list.volume(volume),null!=mute&&list.mute(mute),null!=loop&&list.loop(loop),null!=shuffle&&list.shuffle(shuffle),action){case"fade":list.fade(fadeOver,fadeTo);break;case"load":list.load();break;case"pause":list.pause();break;case"play":list.playWhenAllowed();break;case"skip":list.skip();break;case"stop":list.stop();break;case"unload":list.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("removeaudiogroup",{handler:function(){if(0===this.args.length)return this.error("no group ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.groups.has(id))return this.error('group "'.concat(id,'" does not exist'));SimpleAudio.groups.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));SimpleAudio.lists.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("waitforaudio",{skipArgs:!0,handler:function(){SimpleAudio.loadWithScreen()}}),Macro.add("setplaylist",{handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var playlist=Macro.get("playlist");if(null!==playlist.from&&"setplaylist"!==playlist.from)return this.error("playlists have already been defined with <<createplaylist>>");try{SimpleAudio.lists.add("setplaylist",this.args.slice(0))}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="setplaylist"),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){SimpleAudio.select(":all").stop(),Config.debug&&this.debugView.modes({hidden:!0})}})}else Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeaudiogroup","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){Config.debug&&this.debugView.modes({hidden:!0})}});Macro.add("done",{skipArgs:!0,tags:null,handler:function(){var contents=this.payload[0].contents.trim();""!==contents&&setTimeout(this.createShadowWrapper((function(){return $.wiki(contents)})),Engine.minDomActionDelay)}}),Macro.add("goto",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?void setTimeout((function(){return Engine.play(passage)}),Engine.minDomActionDelay):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){var delay,_this20=this;if(0===this.args.length)return this.error("no time value specified");try{delay=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerInterval(this.createShadowWrapper((function(){var frag=document.createDocumentFragment();new Wikifier(frag,_this20.payload[0].contents);var $output=$wrapper;transition&&($output=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-repeat-in")}),Engine.minDomActionDelay)})),delay)},registerInterval:function(callback,delay){var _this21=this;if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null;timerId=setInterval((function(){if(State.passage!==passage||State.turns!==turn)return clearInterval(timerId),void timers.delete(timerId);var timerIdCache;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(timerIdCache=TempState.repeatTimerId),TempState.repeatTimerId=timerId,callback.call(_this21)}finally{void 0!==timerIdCache?TempState.repeatTimerId=timerIdCache:delete TempState.repeatTimerId,TempState.break=null}}),delay),timers.add(timerId),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearInterval(timerId)})),timers.clear()})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var timers=Macro.get("repeat").timers,timerId=TempState.repeatTimerId;clearInterval(timerId),timers.delete(timerId),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var i,items=[];try{items.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(ex){return this.error("".concat(ex.message," in <<timed>>"))}if(this.payload.length>1)try{var len;for(i=1,len=this.payload.length;i<len;++i)items.push({name:this.payload[i].name,source:this.payload[i].source,delay:0===this.payload[i].args.length?items[items.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[i].args[0])),content:this.payload[i].contents})}catch(ex){return this.error("".concat(ex.message," in <<next>> (#").concat(i,")"))}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerTimeout(this.createShadowWrapper((function(item){var frag=document.createDocumentFragment();new Wikifier(frag,item.content);var $output=$wrapper;Config.debug&&"next"===item.name&&($output=jQuery(new DebugView($output[0],"macro",item.name,item.source).output)),transition&&($output=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-timed-in")}),Engine.minDomActionDelay)})),items)},registerTimeout:function(callback,items){if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null,nextItem=items.shift();timerId=setTimeout((function worker(){if(timers.delete(timerId),State.passage===passage&&State.turns===turn){var curItem=nextItem;null!=(nextItem=items.shift())&&(timerId=setTimeout(worker,nextItem.delay),timers.add(timerId)),callback.call(this,curItem)}}),nextItem.delay),timers.add(timerId),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearTimeout(timerId)})),timers.clear()})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var widgetCode,widgetName=this.args[0],isNonVoid=this.args.length>1&&"container"===this.args[1];if(Macro.has(widgetName)){if(!Macro.get(widgetName).isWidget)return this.error('cannot clobber existing macro "'.concat(widgetName,'"'));Macro.delete(widgetName)}try{var widgetDef={isWidget:!0,handler:(widgetCode=this.payload[0].contents,function(){var shadowStore={};State.temporary.hasOwnProperty("args")&&(shadowStore._args=State.temporary.args),State.temporary.args=_toConsumableArray(this.args),State.temporary.args.raw=this.args.raw,State.temporary.args.full=this.args.full,this.addShadow("_args"),isNonVoid&&(State.temporary.hasOwnProperty("contents")&&(shadowStore._contents=State.temporary.contents),State.temporary.contents=this.payload[0].contents,this.addShadow("_contents")),State.variables.hasOwnProperty("args")&&(shadowStore.$args=State.variables.args),State.variables.args=State.temporary.args,this.addShadow("$args");try{var resFrag=document.createDocumentFragment(),errList=[];if(new Wikifier(resFrag,widgetCode),Array.from(resFrag.querySelectorAll(".error")).forEach((function(errEl){errList.push(errEl.textContent)})),0!==errList.length)return this.error("error".concat(errList.length>1?"s":""," within widget code (").concat(errList.join("; "),")"));this.output.appendChild(resFrag)}catch(ex){return this.error("cannot execute widget: ".concat(ex.message))}finally{shadowStore.hasOwnProperty("_args")?State.temporary.args=shadowStore._args:delete State.temporary.args,isNonVoid&&(shadowStore.hasOwnProperty("_contents")?State.temporary.contents=shadowStore._contents:delete State.temporary.contents),shadowStore.hasOwnProperty("$args")?State.variables.args=shadowStore.$args:delete State.variables.args}})};isNonVoid&&(widgetDef.tags=[]),Macro.add(widgetName,widgetDef),Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error('cannot create widget macro "'.concat(widgetName,'": ').concat(ex.message))}}})}();var Dialog=function(){var _$overlay=null,_$dialog=null,_$dialogTitle=null,_$dialogBody=null,_lastActive=null,_scrollbarWidth=0,_dialogObserver=null;function dialogClose(ev){return _$dialogBody.trigger(":dialogclosing"),jQuery(document).off(".dialog-close"),_dialogObserver?(_dialogObserver.disconnect(),_dialogObserver=null):_$dialogBody.off(".dialog-resize"),jQuery(window).off(".dialog-resize"),_$dialog.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),_$overlay.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),_$dialogTitle.empty(),_$dialogBody.empty().removeClass(),null!==_lastActive&&(jQuery(_lastActive).focus(),_lastActive=null),ev&&ev.data&&"function"==typeof ev.data.closeFn&&ev.data.closeFn(ev),_$dialogBody.trigger(":dialogclose"),_$dialogBody.trigger(":dialogclosed"),Dialog}function dialogIsOpen(classNames){return _$dialog.hasClass("open")&&(!classNames||classNames.splitOrEmpty(/\s+/).every((function(cn){return _$dialogBody.hasClass(cn)})))}function dialogOpen(options,closeFn){_$dialogBody.trigger(":dialogopening");var top=jQuery.extend({top:50},options).top;return dialogIsOpen()||(_lastActive=safeActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),_$overlay.addClass("open"),null!==_$dialogBody[0].querySelector("img")&&_$dialogBody.imagesLoaded().always((function(){return _resizeHandler({data:{top:top}})})),jQuery("body>:not(script,#store-area,tw-storydata,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0),_$dialog.css(_calcPosition(top)).addClass("open").focus(),jQuery(window).on("resize.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),Has.mutationObserver?(_dialogObserver=new MutationObserver((function(mutations){for(var i=0;i<mutations.length;++i)if("childList"===mutations[i].type){_resizeHandler({data:{top:top}});break}}))).observe(_$dialogBody[0],{childList:!0,subtree:!0}):_$dialogBody.on("DOMNodeInserted.dialog-resize DOMNodeRemoved.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),jQuery(document).one("click.dialog-close",".ui-close",{closeFn:closeFn},(function(ev){dialogClose(ev)})).one("keypress.dialog-close",".ui-close",(function(ev){13!==ev.which&&32!==ev.which||jQuery(this).trigger("click")})),_$dialogBody.trigger(":dialogopen"),_$dialogBody.trigger(":dialogopened"),Dialog}function _calcPosition(topPos){var top=null!=topPos?topPos:50,$parent=jQuery(window),dialogPos={left:"",right:"",top:"",bottom:""};_$dialog.css(dialogPos);var horzSpace=$parent.width()-_$dialog.outerWidth(!0)-1,vertSpace=$parent.height()-_$dialog.outerHeight(!0)-1;return horzSpace<=32+_scrollbarWidth&&(vertSpace-=_scrollbarWidth),vertSpace<=32+_scrollbarWidth&&(horzSpace-=_scrollbarWidth),dialogPos.left=dialogPos.right=horzSpace<=32?16:horzSpace/2>>0,dialogPos.top=vertSpace<=32?dialogPos.bottom=16:vertSpace/2>top?top:dialogPos.bottom=vertSpace/2>>0,Object.keys(dialogPos).forEach((function(key){""!==dialogPos[key]&&(dialogPos[key]+="px")})),dialogPos}function _resizeHandler(ev){var top=ev&&ev.data&&void 0!==ev.data.top?ev.data.top:50;"block"===_$dialog.css("display")&&(_$dialog.css({display:"none"}),_$dialog.css(jQuery.extend({display:""},_calcPosition(top))))}return Object.freeze(Object.defineProperties({},{append:{value:function(){var _$dialogBody2;return(_$dialogBody2=_$dialogBody).append.apply(_$dialogBody2,arguments),Dialog}},body:{value:function(){return _$dialogBody.get(0)}},close:{value:dialogClose},init:{value:function(){if(!document.getElementById("ui-dialog")){_scrollbarWidth=function(){var scrollbarWidth;try{var inner=document.createElement("p"),outer=document.createElement("div");inner.style.width="100%",inner.style.height="200px",outer.style.position="absolute",outer.style.left="0px",outer.style.top="0px",outer.style.width="100px",outer.style.height="100px",outer.style.visibility="hidden",outer.style.overflow="hidden",outer.appendChild(inner),document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="auto";var w2=inner.offsetWidth;w1===w2&&(w2=outer.clientWidth),document.body.removeChild(outer),scrollbarWidth=w1-w2}catch(ex){}return scrollbarWidth||17}();var $elems=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+'<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'.concat(L10n.get("close"),'"></button>')+'</div><div id="ui-dialog-body"></div></div>');_$overlay=jQuery($elems.find("#ui-overlay").get(0)),_$dialog=jQuery($elems.find("#ui-dialog").get(0)),_$dialogTitle=jQuery($elems.find("#ui-dialog-title").get(0)),_$dialogBody=jQuery($elems.find("#ui-dialog-body").get(0)),$elems.insertBefore("body>script#script-sugarcube")}}},isOpen:{value:dialogIsOpen},open:{value:dialogOpen},resize:{value:function(data){return _resizeHandler("object"===_typeof(data)?{data:data}:undefined)}},setup:{value:function(title,classNames){return _$dialogBody.empty().removeClass(),null!=classNames&&_$dialogBody.addClass(classNames),_$dialogTitle.empty().append((null!=title?String(title):"")||" "),_$dialogBody.get(0)}},wiki:{value:function(){var _$dialogBody3;return(_$dialogBody3=_$dialogBody).wiki.apply(_$dialogBody3,arguments),Dialog}},addClickHandler:{value:function(targets,options,startFn,doneFn,closeFn){return jQuery(targets).ariaClick((function(ev){ev.preventDefault(),"function"==typeof startFn&&startFn(ev),dialogOpen(options,closeFn),"function"==typeof doneFn&&doneFn(ev)}))}}}))}(),Engine=function(){var States=Util.toEnum({Idle:"idle",Playing:"playing",Rendering:"rendering"}),_initDebugViews=[],_state=States.Idle,_lastPlay=null,_outlinePatch=null,_updating=null;function engineGo(offset){var succeded=State.go(offset);return succeded&&engineShow(),succeded}function engineShow(){return enginePlay(State.passage,!0)}function enginePlay(title,noHistory){var passageReadyOutput,passageDoneOutput,passageTitle=title;if(_state=States.Playing,TempState={},State.clearTemporary(),"function"==typeof Config.navigation.override)try{var overrideTitle=Config.navigation.override(passageTitle);overrideTitle&&(passageTitle=overrideTitle)}catch(ex){}var passage=Story.get(passageTitle);if(jQuery.event.trigger({type:":passageinit",passage:passage}),Object.keys(prehistory).forEach((function(task){"function"==typeof prehistory[task]&&prehistory[task].call(passage,task)})),noHistory||State.create(passage.title),document.body.className&&(document.body.className=""),_lastPlay=Util.now(),Object.keys(predisplay).forEach((function(task){"function"==typeof predisplay[task]&&predisplay[task].call(passage,task)})),Story.has("PassageReady"))try{passageReadyOutput=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(ex){console.error(ex),Alert.error("PassageReady",ex.message)}_state=States.Rendering;var dataTags=passage.tags.length>0?passage.tags.join(" "):null,passageEl=document.createElement("div");jQuery(passageEl).attr({id:passage.domId,"data-passage":passage.title,"data-tags":dataTags}).addClass("passage ".concat(passage.className)),jQuery(document.body).attr("data-tags",dataTags).addClass(passage.className),jQuery(document.documentElement).attr("data-tags",dataTags),jQuery.event.trigger({type:":passagestart",content:passageEl,passage:passage}),Object.keys(prerender).forEach((function(task){"function"==typeof prerender[task]&&prerender[task].call(passage,passageEl,task)})),Story.has("PassageHeader")&&new Wikifier(passageEl,Story.get("PassageHeader").processText()),passageEl.appendChild(passage.render()),Story.has("PassageFooter")&&new Wikifier(passageEl,Story.get("PassageFooter").processText()),jQuery.event.trigger({type:":passagerender",content:passageEl,passage:passage}),Object.keys(postrender).forEach((function(task){"function"==typeof postrender[task]&&postrender[task].call(passage,passageEl,task)}));var debugView,containerEl=document.getElementById("passages");if(containerEl.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&Has.transitionEndEvent?_toConsumableArray(containerEl.childNodes).forEach((function(outgoing){var $outgoing=jQuery(outgoing);if(outgoing.nodeType===Node.ELEMENT_NODE&&$outgoing.hasClass("passage")){if($outgoing.hasClass("passage-out"))return;$outgoing.attr({id:"out-".concat($outgoing.attr("id")),"aria-live":"off"}).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?$outgoing.on(Has.transitionEndEvent,(function(ev){ev.propertyName===Config.passages.transitionOut&&$outgoing.remove()})):setTimeout((function(){return $outgoing.remove()}),Math.max(40,Config.passages.transitionOut))}else $outgoing.remove()})):jQuery(containerEl).empty()),jQuery(passageEl).addClass("passage-in").appendTo(containerEl),setTimeout((function(){return jQuery(passageEl).removeClass("passage-in")}),40),Story.has("StoryDisplayTitle")?null===_updating&&Config.ui.updateStoryElements||setDisplayTitle(Story.get("StoryDisplayTitle").processText()):Config.passages.displayTitles&&passage.title!==Config.passages.start&&(document.title="".concat(passage.title," | ").concat(Story.title)),window.scroll(0,0),_state=States.Playing,Story.has("PassageDone"))try{passageDoneOutput=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(ex){console.error(ex),Alert.error("PassageDone",ex.message)}(jQuery.event.trigger({type:":passagedisplay",content:passageEl,passage:passage}),Object.keys(postdisplay).forEach((function(task){"function"==typeof postdisplay[task]&&postdisplay[task].call(passage,task)})),null!==_updating?_updating.forEach((function(pair){jQuery(pair.element).empty(),new Wikifier(pair.element,Story.get(pair.passage).processText().trim())})):Config.ui.updateStoryElements&&UIBar.update(),Config.debug)&&(null!=passageReadyOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady")).modes({hidden:!0}),debugView.append(passageReadyOutput),jQuery(passageEl).prepend(debugView.output)),null!=passageDoneOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone")).modes({hidden:!0}),debugView.append(passageDoneOutput),jQuery(passageEl).append(debugView.output)),1===State.turns&&_initDebugViews.length>0&&jQuery(passageEl).prepend(_initDebugViews));switch(jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"object":passage.tags.some((function(tag){return Config.saves.autosave.includes(tag)}))&&Save.autosave.save();break;case"function":Config.saves.autosave()&&Save.autosave.save()}return jQuery.event.trigger({type:":passageend",content:passageEl,passage:passage}),_state=States.Idle,_lastPlay=Util.now(),passageEl}function _hideOutlines(){_outlinePatch.set("*:focus{outline:none;}")}return Object.freeze(Object.defineProperties({},{States:{value:States},minDomActionDelay:{value:40},init:{value:function(){var _lastOutlineEvent;jQuery("#init-no-js,#init-lacking").remove(),function(){var $elems=jQuery(document.createDocumentFragment()),markup=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(markup){UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),$elems.append(markup);var $passages=$elems.find("#passages");if(0===$passages.length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage');$passages.empty().not("[aria-live]").attr("aria-live","polite").end(),$elems.find("[data-init-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-init-passage" content attribute'));var passage=el.getAttribute("data-init-passage").trim();if(el.hasAttribute("data-passage"))throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> must not contain a "data-passage" content attribute'));if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(el).empty().wiki(Story.get(passage).processText().trim())}));var updating=[];$elems.find("[data-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-passage" content attribute'));var passage=el.getAttribute("data-passage").trim();if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&updating.push({passage:passage,element:el})})),updating.length>0&&(_updating=updating),Config.ui.updateStoryElements=!1}else $elems.append('<div id="story" role="main"><div id="passages" aria-live="polite"></div></div>');$elems.insertBefore("body>script#script-sugarcube")}(),_outlinePatch=new StyleWrapper(jQuery(document.createElement("style")).attr({id:"style-aria-outlines",type:"text/css"}).appendTo(document.head).get(0)),_hideOutlines(),jQuery(document).on("mousedown.aria-outlines keydown.aria-outlines",(function(ev){ev.type!==_lastOutlineEvent&&(_lastOutlineEvent=ev.type,"keydown"===ev.type?_outlinePatch.clear():_hideOutlines())}))}},start:{value:function(){if(Story.getAllInit().forEach((function(passage){try{var debugBuffer=Wikifier.wikifyEval(passage.text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","".concat(passage.title," [init-tagged]"),"".concat(passage.title," [init-tagged]"));debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("".concat(passage.title," [init-tagged]"),"object"===_typeof(ex)?ex.message:ex)}})),Story.has("StoryInit"))try{var debugBuffer=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("StoryInit","object"===_typeof(ex)?ex.message:ex)}if(null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'.concat(Config.passages.start,'") not found'));if(jQuery(document.documentElement).focus(),State.restore())engineShow();else{var loadStart=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!1,UI.buildAutoload(),Dialog.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(loadStart=!Save.autosave.load())}loadStart&&enginePlay(Config.passages.start)}}},restart:{value:function(){LoadScreen.show(),window.scroll(0,0),State.reset(),jQuery.event.trigger(":enginerestart"),window.location.reload()}},state:{get:function(){return _state}},isIdle:{value:function(){return _state===States.Idle}},isPlaying:{value:function(){return _state!==States.Idle}},isRendering:{value:function(){return _state===States.Rendering}},lastPlay:{get:function(){return _lastPlay}},goTo:{value:function(idx){var succeded=State.goTo(idx);return succeded&&engineShow(),succeded}},go:{value:engineGo},backward:{value:function(){return engineGo(-1)}},forward:{value:function(){return engineGo(1)}},show:{value:engineShow},play:{value:enginePlay},display:{value:function(title,link,option){var noHistory=!1;switch(option){case undefined:break;case"replace":case"back":noHistory=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'.concat(option,'"; please notify the developer'))}enginePlay(title,noHistory)}}}))}(),Passage=(_tagsToSkip=/^(?:debug|nobr|passage|widget|twine\..*)$/i,function(){function Passage(title,el){var _this22=this;_classCallCheck(this,Passage),Object.defineProperties(this,{title:{value:Util.unescape(title)},element:{value:el||null},tags:{value:Object.freeze(el&&el.hasAttribute("tags")?Array.from(new Set(el.getAttribute("tags").trim().splitOrEmpty(/\s+/))):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-".concat(Util.slugify(this.title))},classes:{value:Object.freeze(0===this.tags.length?[]:_this22.tags.filter((function(tag){return!_tagsToSkip.test(tag)})).map((function(tag){return Util.slugify(tag)})))}})}return _createClass(Passage,[{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var passage=Util.escapeMarkup(this.title),mesg="".concat(L10n.get("errorTitle"),": ").concat(L10n.get("errorNonexistentPassage",{passage:passage}));return'<div class="error-view"><span class="error">'.concat(mesg,"</span></div>")}return this.element.textContent.replace(/\r/g,"")}},{key:"description",value:function(){var descriptions=Config.passages.descriptions;switch(_typeof(descriptions)){case"boolean":if(descriptions)return this.title;break;case"object":if(descriptions.hasOwnProperty(this.title))return descriptions[this.title];break;case"function":var result=descriptions.call(this);if(result)return result}return null===this._excerpt&&(this._excerpt=Passage.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){if(null==this.element)return this.text;if(this.tags.includes("Twine.image"))return"[img[".concat(this.text,"]]");var processed=this.text;return Config.passages.onProcess&&(processed=Config.passages.onProcess.call(null,{title:this.title,tags:this.tags,text:processed})),(Config.passages.nobr||this.tags.includes("nobr"))&&(processed=processed.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),processed}},{key:"render",value:function(options){var frag=document.createDocumentFragment();return new Wikifier(frag,this.processText(),options),this._excerpt=Passage.getExcerptFromNode(frag),frag}}],[{key:"getExcerptFromNode",value:function(node,count){if(!node.hasChildNodes())return"";var excerpt=node.textContent.trim();if(""!==excerpt){var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})"));excerpt=excerpt.replace(/\s+/g," ").match(excerptRe)}return excerpt?"".concat(excerpt[1],"…"):"…"}},{key:"getExcerptFromText",value:function(text,count){if(""===text)return"";var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})")),excerpt=text.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*?)(?:(?:\||->|<-)[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(excerptRe);return excerpt?"".concat(excerpt[1],"…"):"…"}}]),Passage}()),_tagsToSkip,Save=function(){var Type=Util.toEnum({Autosave:"autosave",Disk:"disk",Serialize:"serialize",Slot:"slot"}),_slotsUBound=-1,_onLoadHandlers=new Set,_onSaveHandlers=new Set;function savesObjGet(){var saves=storage.get("saves");return null===saves?{autosave:null,slots:_appendSlots([],Config.saves.slots)}:saves}function savesObjClear(){return storage.delete("saves"),!0}function autosaveOk(){return"cookie"!==storage.name&&void 0!==Config.saves.autosave}function slotsOk(){return"cookie"!==storage.name&&-1!==_slotsUBound}function slotsCount(){if(!slotsOk())return 0;for(var saves=savesObjGet(),count=0,i=0,iend=saves.slots.length;i<iend;++i)null!==saves.slots[i]&&++count;return count}function _appendSlots(array,num){for(var i=0;i<num;++i)array.push(null);return array}function _savesObjIsEmpty(saves){for(var slots=saves.slots,isSlotsEmpty=!0,i=0,iend=slots.length;i<iend;++i)if(null!==slots[i]){isSlotsEmpty=!1;break}return null===saves.autosave&&isSlotsEmpty}function _savesObjSave(saves){return _savesObjIsEmpty(saves)?(storage.delete("saves"),!0):storage.set("saves",saves)}function _savesObjUpdate(saveObj){if(null==saveObj||"object"!==_typeof(saveObj))return!1;var updated=!1;return saveObj.hasOwnProperty("state")&&saveObj.state.hasOwnProperty("delta")&&saveObj.state.hasOwnProperty("index")||(saveObj.hasOwnProperty("data")?(delete saveObj.mode,saveObj.state={delta:State.deltaEncode(saveObj.data)},delete saveObj.data):saveObj.state.hasOwnProperty("delta")?saveObj.state.hasOwnProperty("index")||delete saveObj.state.mode:(delete saveObj.state.mode,saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history),saveObj.state.index=saveObj.state.delta.length-1,updated=!0),saveObj.state.hasOwnProperty("rseed")&&(saveObj.state.seed=saveObj.state.rseed,delete saveObj.state.rseed,saveObj.state.delta.forEach((function(_,i,delta){delta[i].hasOwnProperty("rcount")&&(delta[i].pull=delta[i].rcount,delete delta[i].rcount)})),updated=!0),(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired||saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired&&delete saveObj.state.expired,(saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.expired=[],saveObj.state.hasOwnProperty("unique")&&(saveObj.state.expired.push(saveObj.state.unique),delete saveObj.state.unique),saveObj.state.hasOwnProperty("last")&&(saveObj.state.expired.push(saveObj.state.last),delete saveObj.state.last)),updated=!0),updated}function _marshal(supplemental,details){if(null!=supplemental&&"object"!==_typeof(supplemental))throw new Error("supplemental parameter must be an object");var saveObj=Object.assign({},supplemental,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(saveObj.version=Config.saves.version),_onSaveHandlers.forEach((function(fn){return fn(saveObj,details)})),saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history,saveObj}function _unmarshal(saveObj){try{if(_savesObjUpdate(saveObj),!saveObj||!saveObj.hasOwnProperty("id")||!saveObj.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(saveObj.state.history=State.deltaDecode(saveObj.state.delta),delete saveObj.state.delta,_onLoadHandlers.forEach((function(fn){return fn(saveObj)})),saveObj.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(saveObj.state),Engine.show()}catch(ex){return UI.alert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("aborting"),".")),!1}return!0}return Object.freeze(Object.defineProperties({},{init:{value:function(){if("cookie"===storage.name)return savesObjClear(),Config.saves.autoload=undefined,Config.saves.autosave=undefined,Config.saves.slots=0,!1;var saves=savesObjGet(),updated=!1;Array.isArray(saves)&&(saves={autosave:null,slots:saves},updated=!0),Config.saves.slots!==saves.slots.length&&(Config.saves.slots<saves.slots.length?(saves.slots.reverse(),saves.slots=saves.slots.filter((function(val){return!(null===val&&this.count>0)||(--this.count,!1)}),{count:saves.slots.length-Config.saves.slots}),saves.slots.reverse()):Config.saves.slots>saves.slots.length&&_appendSlots(saves.slots,Config.saves.slots-saves.slots.length),updated=!0),_savesObjUpdate(saves.autosave)&&(updated=!0);for(var i=0;i<saves.slots.length;++i)_savesObjUpdate(saves.slots[i])&&(updated=!0);return _savesObjIsEmpty(saves)&&(storage.delete("saves"),updated=!1),updated&&_savesObjSave(saves),_slotsUBound=saves.slots.length-1,!0}},get:{value:savesObjGet},clear:{value:savesObjClear},ok:{value:function(){return autosaveOk()||slotsOk()}},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:autosaveOk},has:{value:function(){return null!==savesObjGet().autosave}},get:{value:function(){return savesObjGet().autosave}},load:{value:function(){var saves=savesObjGet();return null!==saves.autosave&&_unmarshal(saves.autosave)}},save:{value:function(title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var saves=savesObjGet(),supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.autosave=_marshal(supplemental,{type:Type.Autosave}),_savesObjSave(saves)}},delete:{value:function(){var saves=savesObjGet();return saves.autosave=null,_savesObjSave(saves)}}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:slotsOk},length:{get:function(){return _slotsUBound+1}},isEmpty:{value:function(){return 0===slotsCount()}},count:{value:slotsCount},has:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])}},get:{value:function(slot){if(slot<0||slot>_slotsUBound)return null;var saves=savesObjGet();return slot>=saves.slots.length?null:saves.slots[slot]}},load:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])&&_unmarshal(saves.slots[slot])}},save:{value:function(slot,title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),!1;if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();if(slot>=saves.slots.length)return!1;var supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.slots[slot]=_marshal(supplemental,{type:Type.Slot}),_savesObjSave(saves)}},delete:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length)&&(saves.slots[slot]=null,_savesObjSave(saves))}}}))},export:{value:function(filename,metadata){if("function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed()){var str,now,MM,DD,hh,mm,ss,baseName=null==filename?Story.domId:(str=filename,Util.sanitizeFilename(str).replace(/[_\s\u2013\u2014-]+/g,"-")),saveName="".concat(baseName,"-").concat((now=new Date,MM=now.getMonth()+1,DD=now.getDate(),hh=now.getHours(),mm=now.getMinutes(),ss=now.getSeconds(),MM<10&&(MM="0".concat(MM)),DD<10&&(DD="0".concat(DD)),hh<10&&(hh="0".concat(hh)),mm<10&&(mm="0".concat(mm)),ss<10&&(ss="0".concat(ss)),"".concat(now.getFullYear()).concat(MM).concat(DD,"-").concat(hh).concat(mm).concat(ss)),".save"),supplemental=null==metadata?{}:{metadata:metadata},saveObj=LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Disk})));saveAs(new Blob([saveObj],{type:"text/plain;charset=UTF-8"}),saveName)}else Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed"))}},import:{value:function(event){var file=event.target.files[0],reader=new FileReader;jQuery(reader).one("loadend",(function(){if(reader.error){var ex=reader.error;UI.alert("".concat(L10n.get("errorSaveDiskLoadFailed").toUpperFirst()," (").concat(ex.name,": ").concat(ex.message,").</p><p>").concat(L10n.get("aborting"),"."))}else{var saveObj;try{saveObj=JSON.parse(/\.json$/i.test(file.name)||/^\{/.test(reader.result)?reader.result:LZString.decompressFromBase64(reader.result))}catch(ex){}_unmarshal(saveObj)}})),reader.readAsText(file)}},serialize:{value:function(metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),null;var supplemental=null==metadata?{}:{metadata:metadata};return LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Serialize})))}},deserialize:{value:function(base64Str){var saveObj;try{saveObj=JSON.parse(LZString.decompressFromBase64(base64Str))}catch(ex){}return _unmarshal(saveObj)?saveObj.metadata:null}},onLoad:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onLoad.add handler parameter must be a function (received: ".concat(valueType,")"));_onLoadHandlers.add(handler)}},clear:{value:function(){_onLoadHandlers.clear()}},delete:{value:function(handler){return _onLoadHandlers.delete(handler)}},size:{get:function(){return _onLoadHandlers.size}}}))},onSave:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onSave.add handler parameter must be a function (received: ".concat(valueType,")"));_onSaveHandlers.add(handler)}},clear:{value:function(){_onSaveHandlers.clear()}},delete:{value:function(handler){return _onSaveHandlers.delete(handler)}},size:{get:function(){return _onSaveHandlers.size}}}))}}))}(),Setting=function(){var Types=Util.toEnum({Header:0,Toggle:1,List:2,Range:3}),_definitions=[];function settingsCreate(){return Object.create(null)}function settingsSave(){var savedSettings=settingsCreate();return Object.keys(settings).length>0&&_definitions.filter((function(def){return def.type!==Types.Header&&settings[def.name]!==def.default})).forEach((function(def){return savedSettings[def.name]=settings[def.name]})),0===Object.keys(savedSettings).length?(storage.delete("settings"),!0):storage.set("settings",savedSettings)}function settingsLoad(){var defaultSettings=settingsCreate(),loadedSettings=storage.get("settings")||settingsCreate();_definitions.filter((function(def){return def.type!==Types.Header})).forEach((function(def){return defaultSettings[def.name]=def.default})),window.SugarCube.settings=settings=Object.assign(defaultSettings,loadedSettings)}function settingsClear(){return window.SugarCube.settings=settings=settingsCreate(),storage.delete("settings"),!0}function definitionsAdd(type,name,def){if(arguments.length<3){var errors=[];throw arguments.length<1&&errors.push("type"),arguments.length<2&&errors.push("name"),arguments.length<3&&errors.push("definition"),new Error("missing parameters, no ".concat(errors.join(" or ")," specified"))}if("object"!==_typeof(def))throw new TypeError("definition parameter must be an object");if(definitionsHas(name))throw new Error('cannot clobber existing setting "'.concat(name,'"'));var str,pos,definition={type:type,name:name,label:"string"==typeof def.label?def.label.trim():""};if("string"==typeof def.desc){var desc=def.desc.trim();""!==desc&&(definition.desc=desc)}switch(type){case Types.Header:break;case Types.Toggle:definition.default=!!def.default;break;case Types.List:if(!def.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(def.list))throw new TypeError("list must be an array");if(0===def.list.length)throw new Error("list must not be empty");if(definition.list=Object.freeze(def.list),null==def.default)definition.default=def.list[0];else{var defaultIndex=def.list.indexOf(def.default);if(-1===defaultIndex)throw new Error("list does not contain default");definition.default=def.list[defaultIndex]}break;case Types.Range:if(!def.hasOwnProperty("min"))throw new Error("no min specified");if("number"!=typeof def.min||Number.isNaN(def.min)||!Number.isFinite(def.min))throw new TypeError("min must be a finite number");if(!def.hasOwnProperty("max"))throw new Error("no max specified");if("number"!=typeof def.max||Number.isNaN(def.max)||!Number.isFinite(def.max))throw new TypeError("max must be a finite number");if(!def.hasOwnProperty("step"))throw new Error("no step specified");if("number"!=typeof def.step||Number.isNaN(def.step)||!Number.isFinite(def.step)||def.step<=0)throw new TypeError("step must be a finite number greater than zero");var stepValidate=function(value){if(fracDigits>0){var ma=Number("".concat(def.min,"e").concat(fracDigits)),sa=Number("".concat(def.step,"e").concat(fracDigits)),_va=Number("".concat(value,"e").concat(fracDigits))-ma;return Number("".concat(_va-_va%sa+ma,"e-").concat(fracDigits))}var va=value-def.min;return va-va%def.step+def.min},fracDigits=(str=String(def.step),-1===(pos=str.lastIndexOf("."))?0:str.length-pos-1);if(stepValidate(def.max)!==def.max)throw new RangeError("max (".concat(def.max,") is not a multiple of the step (").concat(def.step,") plus the min (").concat(def.min,")"));if(definition.max=def.max,definition.min=def.min,definition.step=def.step,null==def.default)definition.default=def.max;else{if("number"!=typeof def.default||Number.isNaN(def.default)||!Number.isFinite(def.default))throw new TypeError("default must be a finite number");if(def.default<def.min)throw new RangeError("default (".concat(def.default,") is less than min (").concat(def.min,")"));if(def.default>def.max)throw new RangeError("default (".concat(def.default,") is greater than max (").concat(def.max,")"));definition.default=def.default}break;default:throw new Error("unknown Setting type: ".concat(type))}"function"==typeof def.onInit&&(definition.onInit=Object.freeze(def.onInit)),"function"==typeof def.onChange&&(definition.onChange=Object.freeze(def.onChange)),_definitions.push(Object.freeze(definition))}function definitionsHas(name){return _definitions.some((function(definition){return definition.name===name}))}function definitionsGet(name){return _definitions.find((function(definition){return definition.name===name}))}return Object.freeze(Object.defineProperties({},{Types:{value:Types},init:{value:function(){if(storage.has("options")){var old=storage.get("options");null!==old&&(window.SugarCube.settings=settings=Object.assign(settingsCreate(),old)),settingsSave(),storage.delete("options")}settingsLoad(),_definitions.forEach((function(def){if(def.hasOwnProperty("onInit")){var thisArg={name:def.name,value:settings[def.name],default:def.default};def.hasOwnProperty("list")&&(thisArg.list=def.list),def.onInit.call(thisArg)}}))}},create:{value:settingsCreate},save:{value:settingsSave},load:{value:settingsLoad},clear:{value:settingsClear},reset:{value:function(name){if(0===arguments.length)settingsClear(),settingsLoad();else{if(null==name||!definitionsHas(name))throw new Error('nonexistent setting "'.concat(name,'"'));var def=definitionsGet(name);def.type!==Types.Header&&(settings[name]=def.default)}return settingsSave()}},forEach:{value:function(callback,thisArg){_definitions.forEach(callback,thisArg)}},add:{value:definitionsAdd},addHeader:{value:function(name,desc){definitionsAdd(Types.Header,name,{desc:desc})}},addToggle:{value:function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];definitionsAdd.apply(void 0,[Types.Toggle].concat(args))}},addList:{value:function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];definitionsAdd.apply(void 0,[Types.List].concat(args))}},addRange:{value:function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];definitionsAdd.apply(void 0,[Types.Range].concat(args))}},isEmpty:{value:function(){return 0===_definitions.length}},has:{value:definitionsHas},get:{value:definitionsGet},delete:{value:function definitionsDelete(name){definitionsHas(name)&&delete settings[name];for(var i=0;i<_definitions.length;++i)if(_definitions[i].name===name){_definitions.splice(i,1),definitionsDelete(name);break}}}}))}(),Story=function(){var _passages={},_inits=[],_scripts=[],_styles=[],_widgets=[],_title="",_ifId="",_domId="";function _storySetTitle(rawTitle){if(null==rawTitle)throw new Error("story title must not be null or undefined");var title=Util.unescape(String(rawTitle)).trim();if(""===title)throw new Error("story title must not be empty or consist solely of whitespace");if(document.title=_title=title,""===(_domId=Util.slugify(_title)))if(""!==_ifId)_domId=_ifId;else for(var i=0,len=_title.length;i<len;++i){var _Util$charAndPosAt2=Util.charAndPosAt(_title,i),char=_Util$charAndPosAt2.char,start=_Util$charAndPosAt2.start,end=_Util$charAndPosAt2.end;_domId+=char.codePointAt(0).toString(16),i+=end-start}}return Object.freeze(Object.defineProperties({},{load:{value:function(){var validationCodeTags=["init","widget"],validationNoCodeTagPassages=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryInit","StoryMenu","StoryShare","StorySubtitle"];function validateStartingPassage(passage){if(passage.tags.includesAny(validationCodeTags))throw new Error('starting passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(passage.tags.filter((function(tag){return validationCodeTags.includes(tag)})).sort().join('", "'),'"'))}function validateSpecialPassages(passage){if(validationNoCodeTagPassages.includes(passage.title)){for(var _len19=arguments.length,tags=new Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++)tags[_key19-1]=arguments[_key19];throw new Error('special passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(tags.sort().join('", "'),'"'))}var codeTags=[].concat(validationCodeTags),foundTags=[];if(passage.tags.forEach((function(tag){codeTags.includes(tag)&&foundTags.push.apply(foundTags,_toConsumableArray(codeTags.delete(tag)))})),foundTags.length>1)throw new Error('passage "'.concat(passage.title,'" contains multiple special tags; invalid: "').concat(foundTags.sort().join('", "'),'"'))}var $storydata=jQuery("tw-storydata"),startNode=$storydata.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test($storydata.attr("options")),$storydata.children("style").each((function(i){_styles.push(new Passage("tw-user-style-".concat(i),this))})),$storydata.children("script").each((function(i){_scripts.push(new Passage("tw-user-script-".concat(i),this))})),$storydata.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each((function(){var $this=jQuery(this),pid=$this.attr("pid")||"",passage=new Passage($this.attr("name"),this);pid===startNode&&""!==startNode?(Config.passages.start=passage.title,validateStartingPassage(passage),_passages[passage.title]=passage):passage.tags.includes("init")?(validateSpecialPassages(passage,"init"),_inits.push(passage)):passage.tags.includes("widget")?(validateSpecialPassages(passage,"widget"),_widgets.push(passage)):_passages[passage.title]=passage})),_ifId=$storydata.attr("ifid"),_storySetTitle("FTAG Twine"),Config.saves.id=Story.domId}},init:{value:function(){var storyStyle;storyStyle=document.createElement("style"),new StyleWrapper(storyStyle).add(_styles.map((function(style){return style.text.trim()})).join("\n")),jQuery(storyStyle).appendTo(document.head).attr({id:"style-story",type:"text/css"});for(var i=0;i<_scripts.length;++i)try{Scripting.evalJavaScript(_scripts[i].text)}catch(ex){console.error(ex),Alert.error(_scripts[i].title,"object"===_typeof(ex)?ex.message:ex)}for(var _i8=0;_i8<_widgets.length;++_i8)try{Wikifier.wikifyEval(_widgets[_i8].processText())}catch(ex){console.error(ex),Alert.error(_widgets[_i8].title,"object"===_typeof(ex)?ex.message:ex)}}},title:{get:function(){return _title}},domId:{get:function(){return _domId}},ifId:{get:function(){return _ifId}},add:{value:function(passage){if(!(passage instanceof Passage))throw new TypeError("Story.add passage parameter must be an instance of Passage");var title=passage.title;return!_passages.hasOwnProperty(title)&&(_passages[title]=passage,!0)}},has:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":return _passages.hasOwnProperty(String(title));case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.has title parameter cannot be ".concat(type))}},get:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":var id=String(title);return _passages.hasOwnProperty(id)?_passages[id]:new Passage(id||"(unknown)");case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.get title parameter cannot be ".concat(type))}},getAllInit:{value:function(){return Object.freeze(Array.from(_inits))}},getAllRegular:{value:function(){return Object.freeze(Object.assign({},_passages))}},getAllScript:{value:function(){return Object.freeze(Array.from(_scripts))}},getAllStylesheet:{value:function(){return Object.freeze(Array.from(_styles))}},getAllWidget:{value:function(){return Object.freeze(Array.from(_widgets))}},lookup:{value:function(key,value){var sortKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"title",results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];"object"===_typeof(passage[key])&&null!==passage[key]?passage[key]instanceof Array&&passage[key].some((function(m){return Util.sameValueZero(m,value)}))&&results.push(passage):Util.sameValueZero(passage[key],value)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}},lookupWith:{value:function(predicate){var sortKey=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"title";if("function"!=typeof predicate)throw new TypeError("Story.lookupWith predicate parameter must be a function");var results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];predicate(passage)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}}}))}(),UI=function(){function uiAssembleLinkList(passage,listEl){var list=listEl,debugState=Config.debug,cleanState=Config.cleanupWikifierOutput;Config.debug=!1,Config.cleanupWikifierOutput=!1;try{null==list&&(list=document.createElement("ul"));var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim());var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "));for(;frag.hasChildNodes();){var node=frag.firstChild;if(node.nodeType===Node.ELEMENT_NODE&&"A"===node.nodeName.toUpperCase()){var li=document.createElement("li");list.appendChild(li),li.appendChild(node)}else frag.removeChild(node)}}finally{Config.cleanupWikifierOutput=cleanState,Config.debug=debugState}return list}function uiOpenAlert(message){jQuery(Dialog.setup(L10n.get("alertTitle"),"alert")).append("<p>".concat(message,'</p><ul class="buttons">')+'<li><button id="alert-ok" class="ui-close">'.concat(L10n.get(["alertOk","ok"]),"</button></li>")+"</ul>");for(var _len20=arguments.length,args=new Array(_len20>1?_len20-1:0),_key20=1;_key20<_len20;_key20++)args[_key20-1]=arguments[_key20];Dialog.open.apply(Dialog,args)}function uiBuildAutoload(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>".concat(L10n.get("autoloadPrompt"),'</p><ul class="buttons">')+'<li><button id="autoload-ok" class="ui-close">'.concat(L10n.get(["autoloadOk","ok"]),"</button></li>")+'<li><button id="autoload-cancel" class="ui-close">'.concat(L10n.get(["autoloadCancel","cancel"]),"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",(function(ev){var isAutoloadOk="autoload-ok"===ev.target.id;jQuery(document).one(":dialogclosed",(function(){isAutoloadOk&&Save.autosave.load()||Engine.play(Config.passages.start)}))})),!0}function uiBuildJumpto(){var list=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(list);for(var expired=State.expired.length,i=State.size-1;i>=0;--i)if(i!==State.activeIndex){var passage=Story.get(State.history[i].title);passage&&passage.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(idx){return function(){return jQuery(document).one(":dialogclosed",(function(){return Engine.goTo(idx)}))}}(i)).addClass("ui-close").text("".concat(L10n.get("jumptoTurn")," ").concat(expired+i+1,": ").concat(passage.description()))).appendTo(list)}list.hasChildNodes()||jQuery(list).append("<li><a><em>".concat(L10n.get("jumptoUnavailable"),"</em></a></li>"))}function uiBuildRestart(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>".concat(L10n.get("restartPrompt"),'</p><ul class="buttons">')+'<li><button id="restart-ok">'.concat(L10n.get(["restartOk","ok"]),"</button></li>")+'<li><button id="restart-cancel" class="ui-close">'.concat(L10n.get(["restartCancel","cancel"]),"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){return Engine.restart()})),Dialog.close()})),!0}function uiBuildSaves(){var savesAllowed="function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed();function createActionItem(bId,bClass,bText,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId)).html(bText);return bClass&&$btn.addClass(bClass),bAction?$btn.ariaClick(bAction):$btn.ariaDisabled(!0),jQuery(document.createElement("li")).append($btn)}var $dialogBody=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),savesOk=Save.ok(),fileOk=Has.fileAPI&&(Config.saves.tryDiskOnMobile||!Browser.isMobile.any());if(savesOk&&$dialogBody.append(function(){function createButton(bId,bClass,bText,bSlot,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId,"-").concat(bSlot)).addClass(bId).html(bText);return bClass&&$btn.addClass(bClass),bAction?"auto"===bSlot?$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelAuto"))},(function(){return bAction()})):$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelSlot")," ").concat(bSlot+1)},(function(){return bAction(bSlot)})):$btn.ariaDisabled(!0),$btn}var saves=Save.get(),$tbody=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var $tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo($tdSlot),saves.autosave?($tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),"auto",(function(){jQuery(document).one(":dialogclosed",(function(){return Save.autosave.load()}))}))),jQuery(document.createElement("div")).text(saves.autosave.title).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.autosave.date?"".concat(new Date(saves.autosave.date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo($tdDesc),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto",(function(){Save.autosave.delete(),uiBuildSaves()})))):($tdLoad.append(createButton("load",null,L10n.get("savesLabelLoad"),"auto")),$tdDesc.addClass("empty").text("•  •  •"),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)}for(var i=0,iend=saves.slots.length;i<iend;++i){var _$tdSlot=jQuery(document.createElement("td")),_$tdLoad=jQuery(document.createElement("td")),_$tdDesc=jQuery(document.createElement("td")),_$tdDele=jQuery(document.createElement("td"));_$tdSlot.append(document.createTextNode(i+1)),saves.slots[i]?(_$tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),i,(function(slot){jQuery(document).one(":dialogclosed",(function(){return Save.slots.load(slot)}))}))),jQuery(document.createElement("div")).text(saves.slots[i].title).appendTo(_$tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.slots[i].date?"".concat(new Date(saves.slots[i].date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo(_$tdDesc),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i,(function(slot){Save.slots.delete(slot),uiBuildSaves()})))):(_$tdLoad.append(createButton("save","ui-close",L10n.get("savesLabelSave"),i,savesAllowed?Save.slots.save:null)),_$tdDesc.addClass("empty").text("•  •  •"),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i))),jQuery(document.createElement("tr")).append(_$tdSlot).append(_$tdLoad).append(_$tdDesc).append(_$tdDele).appendTo($tbody)}return jQuery(document.createElement("table")).attr("id","saves-list").append($tbody)}()),savesOk||fileOk){var $btnBar=jQuery(document.createElement("ul")).addClass("buttons").appendTo($dialogBody);return fileOk&&($btnBar.append(createActionItem("export","ui-close",L10n.get("savesLabelExport"),savesAllowed?function(){return Save.export()}:null)),$btnBar.append(createActionItem("import",null,L10n.get("savesLabelImport"),(function(){return $dialogBody.find("#saves-import-file").trigger("click")}))),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",(function(ev){jQuery(document).one(":dialogclosed",(function(){return Save.import(ev)})),Dialog.close()})).appendTo($dialogBody)),savesOk&&$btnBar.append(createActionItem("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),uiBuildSaves()}:null)),!0}return uiOpenAlert(L10n.get("savesIncapable")),!1}function uiBuildSettings(){var $dialogBody=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach((function(control){if(control.type===Setting.Types.Header){var _name=control.name,_id=Util.slugify(_name),$header=jQuery(document.createElement("div")),$heading=jQuery(document.createElement("h2"));return $header.attr("id","header-body-".concat(_id)).append($heading).appendTo($dialogBody),$heading.attr("id","header-heading-".concat(_id)).wiki(_name),void(control.desc&&jQuery(document.createElement("p")).attr("id","header-desc-".concat(_id)).wiki(control.desc).appendTo($header))}var $control,name=control.name,id=Util.slugify(name),$setting=jQuery(document.createElement("div")),$label=jQuery(document.createElement("label")),$controlBox=jQuery(document.createElement("div"));switch(jQuery(document.createElement("div")).append($label).append($controlBox).appendTo($setting),control.desc&&jQuery(document.createElement("p")).attr("id","setting-desc-".concat(id)).wiki(control.desc).appendTo($setting),$label.attr({id:"setting-label-".concat(id),for:"setting-control-".concat(id)}).wiki(control.label),null==settings[name]&&(settings[name]=control.default),control.type){case Setting.Types.Toggle:$control=jQuery(document.createElement("button")),settings[name]?$control.addClass("enabled").text(L10n.get("settingsOn")):$control.text(L10n.get("settingsOff")),$control.ariaClick((function(){settings[name]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[name]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[name]=!0),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default})}));break;case Setting.Types.List:$control=jQuery(document.createElement("select"));for(var i=0,iend=control.list.length;i<iend;++i)jQuery(document.createElement("option")).val(i).text(control.list[i]).appendTo($control);$control.val(control.list.indexOf(settings[name])).attr("tabindex",0).on("change",(function(){settings[name]=control.list[Number(this.value)],Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,list:control.list})}));break;case Setting.Types.Range:($control=jQuery(document.createElement("input"))).attr({type:"range",min:control.min,max:control.max,step:control.step,value:settings[name],tabindex:0}).on("change input",(function(){settings[name]=Number(this.value),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,min:control.min,max:control.max,step:control.step})})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$control.trigger("change"))}))}$control.attr("id","setting-control-".concat(id)).appendTo($controlBox),$setting.attr("id","setting-body-".concat(id)).appendTo($dialogBody)})),$dialogBody.append('<ul class="buttons">'+'<li><button id="settings-ok" class="ui-close">'.concat(L10n.get(["settingsOk","ok"]),"</button></li>")+'<li><button id="settings-reset">'.concat(L10n.get("settingsReset"),"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){Setting.reset(),window.location.reload()})),Dialog.close()})),!0}function uiBuildShare(){try{jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(uiAssembleLinkList("StoryShare"))}catch(ex){return console.error(ex),Alert.error("StoryShare",ex.message),!1}return!0}return Object.freeze(Object.defineProperties({},{assembleLinkList:{value:uiAssembleLinkList},alert:{value:uiOpenAlert},jumpto:{value:function(){uiBuildJumpto(),Dialog.open.apply(Dialog,arguments)}},restart:{value:function(){uiBuildRestart(),Dialog.open.apply(Dialog,arguments)}},saves:{value:function(){uiBuildSaves(),Dialog.open.apply(Dialog,arguments)}},settings:{value:function(){uiBuildSettings(),Dialog.open.apply(Dialog,arguments)}},share:{value:function(){uiBuildShare(),Dialog.open.apply(Dialog,arguments)}},buildAutoload:{value:uiBuildAutoload},buildJumpto:{value:uiBuildJumpto},buildRestart:{value:uiBuildRestart},buildSaves:{value:uiBuildSaves},buildSettings:{value:uiBuildSettings},buildShare:{value:uiBuildShare},stow:{value:function(){return UIBar.stow()}},unstow:{value:function(){return UIBar.unstow()}},setStoryElements:{value:function(){return UIBar.update()}},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:uiBuildAutoload},buildDialogJumpto:{value:uiBuildJumpto},buildDialogRestart:{value:uiBuildRestart},buildDialogSaves:{value:uiBuildSaves},buildDialogSettings:{value:uiBuildSettings},buildDialogShare:{value:uiBuildShare},buildLinkListFromPassage:{value:uiAssembleLinkList}}))}(),UIBar=function(){var _$uiBar=null;function uiBarStow(noAnimation){var $story;_$uiBar&&!_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.addClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay));return this}function uiBarUpdate(){if(Story.has("StoryDisplayTitle")&&setDisplayTitle(Story.get("StoryDisplayTitle").processText()),_$uiBar){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var menuStory=document.getElementById("menu-story");if(null!==menuStory&&(jQuery(menuStory).empty(),Story.has("StoryMenu")))try{UI.assembleLinkList("StoryMenu",menuStory)}catch(ex){console.error(ex),Alert.error("StoryMenu",ex.message)}}}return Object.freeze(Object.defineProperties({},{destroy:{value:function(){_$uiBar&&(_$uiBar.hide(),jQuery(document).off(".ui-bar"),jQuery(document.head).find("#style-ui-bar").remove(),_$uiBar.remove(),_$uiBar=null)}},hide:{value:function(){return _$uiBar&&_$uiBar.hide(),this}},init:{value:function(){if(!document.getElementById("ui-bar")){var toggleLabel,backwardLabel,jumptoLabel,forwardLabel,$backward,$forward,$elems=(toggleLabel=L10n.get("uiBarToggle"),backwardLabel=L10n.get("uiBarBackward"),jumptoLabel=L10n.get("uiBarJumpto"),forwardLabel=L10n.get("uiBarForward"),jQuery(document.createDocumentFragment()).append('<div id="ui-bar" aria-live="polite"><div id="ui-bar-tray">'+'<button id="ui-bar-toggle" tabindex="0" title="'.concat(toggleLabel,'" aria-label="').concat(toggleLabel,'"></button>')+'<div id="ui-bar-history">'+'<button id="history-backward" tabindex="0" title="'.concat(backwardLabel,'" aria-label="').concat(backwardLabel,'"></button>')+'<button id="history-jumpto" tabindex="0" title="'.concat(jumptoLabel,'" aria-label="').concat(jumptoLabel,'"></button>')+'<button id="history-forward" tabindex="0" title="'.concat(forwardLabel,'" aria-label="').concat(forwardLabel,'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+'<li id="menu-item-saves"><a tabindex="0">'.concat(L10n.get("savesTitle"),"</a></li>")+'<li id="menu-item-settings"><a tabindex="0">'.concat(L10n.get("settingsTitle"),"</a></li>")+'<li id="menu-item-restart"><a tabindex="0">'.concat(L10n.get("restartTitle"),"</a></li>")+'<li id="menu-item-share"><a tabindex="0">'.concat(L10n.get("shareTitle"),"</a></li>")+"</ul></nav></div></div>"));_$uiBar=jQuery($elems.find("#ui-bar").get(0)),$elems.insertBefore("body>script#script-sugarcube"),jQuery(document).on(":historyupdate.ui-bar",($backward=jQuery("#history-backward"),$forward=jQuery("#history-forward"),function(){$backward.ariaDisabled(State.length<2),$forward.ariaDisabled(State.length===State.size)}))}}},isHidden:{value:function(){return _$uiBar&&"none"===_$uiBar.css("display")}},isStowed:{value:function(){return _$uiBar&&_$uiBar.hasClass("stowed")}},show:{value:function(){return _$uiBar&&_$uiBar.show(),this}},start:{value:function(){_$uiBar&&(("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&uiBarStow(!0),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},(function(){return _$uiBar.toggleClass("stowed")})),Config.history.controls?(jQuery("#history-backward").ariaDisabled(State.length<2).ariaClick({label:L10n.get("uiBarBackward")},(function(){return Engine.backward()})),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},(function(){return UI.jumpto()})):jQuery("#history-jumpto").remove(),jQuery("#history-forward").ariaDisabled(State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},(function(){return Engine.forward()}))):jQuery("#ui-bar-history").remove(),Story.has("StoryDisplayTitle")?setDisplayTitle(Story.get("StoryDisplayTitle").processText()):jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||uiBarUpdate(),jQuery("#menu-item-saves a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSaves(),Dialog.open()})).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():jQuery("#menu-item-settings a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSettings(),Dialog.open()})).text(L10n.get("settingsTitle")),jQuery("#menu-item-restart a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildRestart(),Dialog.open()})).text(L10n.get("restartTitle")),Story.has("StoryShare")?jQuery("#menu-item-share a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildShare(),Dialog.open()})).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove())}},stow:{value:uiBarStow},unstow:{value:function(noAnimation){var $story;return _$uiBar&&_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.removeClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay)),this}},update:{value:uiBarUpdate},setStoryElements:{value:uiBarUpdate}}))}(),DebugBar=function(){var _variableRe=new RegExp("^".concat(Patterns.variable,"$")),_numericKeyRe=/^\d+$/,_watchList=[],_$debugBar=null,_$watchBody=null,_$watchList=null,_$turnSelect=null,_stowed=!0;function debugBarStow(){_$debugBar.css("right","-".concat(_$debugBar.outerWidth(),"px")),_stowed=!0,_updateSession()}function debugBarUnstow(){_$debugBar.css("right",0),_stowed=!1,_updateSession()}function debugBarToggle(){_stowed?debugBarUnstow():debugBarStow()}function debugBarWatchAdd(varName){_variableRe.test(varName)&&(_watchList.pushUnique(varName),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession())}function debugBarWatchAddAll(){Object.keys(State.variables).map((function(name){return _watchList.pushUnique("$".concat(name))})),Object.keys(State.temporary).map((function(name){return _watchList.pushUnique("_".concat(name))})),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchClear(){for(var i=_watchList.length-1;i>=0;--i)_watchList.pop();_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDelete(varName){_watchList.delete(varName),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDisable(){_debugBarWatchDisableNoUpdate(),_updateSession()}function debugBarWatchEnable(){_debugBarWatchEnableNoUpdate(),_updateSession()}function debugBarWatchIsEnabled(){return!_$watchBody.attr("hidden")}function debugBarWatchToggle(){_$watchBody.attr("hidden")?debugBarWatchEnable():debugBarWatchDisable()}function _debugBarWatchDisableNoUpdate(){_$watchBody.attr({"aria-hidden":!0,hidden:"hidden"})}function _debugBarWatchEnableNoUpdate(){_$watchBody.removeAttr("aria-hidden hidden")}function _clearSession(){session.delete("debugState")}function _hasSession(){return session.has("debugState")}function _updateSession(){session.set("debugState",{stowed:_stowed,watchList:_watchList,watchEnabled:debugBarWatchIsEnabled(),viewsEnabled:DebugView.isEnabled()})}function _updateWatchBody(){if(0!==_watchList.length){for(var delLabel=L10n.get("debugBarDeleteWatch"),$table=jQuery(document.createElement("table")),$tbody=jQuery(document.createElement("tbody")),_loop4=function(i,len){var varName=_watchList[i],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary,$row=jQuery(document.createElement("tr")),$delBtn=jQuery(document.createElement("button")),$code=jQuery(document.createElement("code"));$delBtn.addClass("watch-delete").attr("data-name",varName).ariaClick({one:!0,label:delLabel},(function(){return debugBarWatchDelete(varName)})),$code.text(_toWatchString(store[varKey])),jQuery(document.createElement("td")).append($delBtn).appendTo($row),jQuery(document.createElement("td")).text(varName).appendTo($row),jQuery(document.createElement("td")).append($code).appendTo($row),$row.appendTo($tbody)},i=0,len=_watchList.length;i<len;++i)_loop4(i);$table.append($tbody),_$watchBody.empty().append($table)}else _$watchBody.empty().append("<div>".concat(L10n.get("debugBarNoWatches"),"</div>"))}function _updateWatchList(){var svn=Object.keys(State.variables),tvn=Object.keys(State.temporary);if(0!==svn.length||0!==tvn.length){var names=[].concat(_toConsumableArray(svn.map((function(name){return"$".concat(name)}))),_toConsumableArray(tvn.map((function(name){return"_".concat(name)})))).sort(),options=document.createDocumentFragment();names.delete(_watchList);for(var i=0,len=names.length;i<len;++i)jQuery(document.createElement("option")).val(names[i]).appendTo(options);_$watchList.empty().append(options)}else _$watchList.empty()}function _updateTurnSelect(){for(var histLen=State.size,expLen=State.expired.length,options=document.createDocumentFragment(),i=0;i<histLen;++i)jQuery(document.createElement("option")).val(i).text("".concat(expLen+i+1,". ").concat(Util.escape(State.history[i].title))).appendTo(options);_$turnSelect.empty().ariaDisabled(histLen<2).append(options).val(State.activeIndex)}function _toWatchString(value){if(null===value)return"null";switch(_typeof(value)){case"number":if(Number.isNaN(value))return"NaN";if(!Number.isFinite(value))return"Infinity";case"boolean":case"symbol":case"undefined":return String(value);case"string":return JSON.stringify(value);case"function":return"Function"}var objType=Util.toStringTag(value);if("Date"===objType)return"Date {".concat(value.toLocaleString(),"}");if("RegExp"===objType)return"RegExp ".concat(value.toString());var result=[];if(value instanceof Array||value instanceof Set){for(var list=value instanceof Array?value:Array.from(value),i=0,len=list.length;i<len;++i)result.push(list.hasOwnProperty(i)?_toWatchString(list[i]):"<empty>");return Object.keys(list).filter((function(key){return!_numericKeyRe.test(key)})).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(list[key])))})),"".concat(objType,"(").concat(list.length,") [").concat(result.join(", "),"]")}return value instanceof Map?(value.forEach((function(val,key){return result.push("".concat(_toWatchString(key)," → ").concat(_toWatchString(val)))})),"".concat(objType,"(").concat(value.size,") {").concat(result.join(", "),"}")):(Object.keys(value).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(value[key])))})),"".concat(objType," {").concat(result.join(", "),"}"))}return Object.freeze(Object.defineProperties({},{init:{value:function(){var barToggleLabel=L10n.get("debugBarToggle"),watchAddLabel=L10n.get("debugBarAddWatch"),watchAllLabel=L10n.get("debugBarWatchAll"),watchNoneLabel=L10n.get("debugBarWatchNone"),watchToggleLabel=L10n.get("debugBarWatchToggle"),viewsToggleLabel=L10n.get("debugBarViewsToggle");jQuery(document.createDocumentFragment()).append('<div id="debug-bar"><div id="debug-bar-watch">'+"<div>".concat(L10n.get("debugBarNoWatches"),"</div>>")+"</div><div>"+'<button id="debug-bar-watch-toggle" tabindex="0" title="'.concat(watchToggleLabel,'" aria-label="').concat(watchToggleLabel,'">').concat(L10n.get("debugBarLabelWatch"),"</button>")+'<label id="debug-bar-watch-label" for="debug-bar-watch-input">'.concat(L10n.get("debugBarLabelAdd"),"</label>")+'<input id="debug-bar-watch-input" name="debug-bar-watch-input" type="text" list="debug-bar-watch-list" tabindex="0"><datalist id="debug-bar-watch-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-watch-add" tabindex="0" title="'.concat(watchAddLabel,'" aria-label="').concat(watchAddLabel,'"></button>')+'<button id="debug-bar-watch-all" tabindex="0" title="'.concat(watchAllLabel,'" aria-label="').concat(watchAllLabel,'"></button>')+'<button id="debug-bar-watch-none" tabindex="0" title="'.concat(watchNoneLabel,'" aria-label="').concat(watchNoneLabel,'"></button>')+"</div><div>"+'<button id="debug-bar-views-toggle" tabindex="0" title="'.concat(viewsToggleLabel,'" aria-label="').concat(viewsToggleLabel,'">').concat(L10n.get("debugBarLabelViews"),"</button>")+'<label id="debug-bar-turn-label" for="debug-bar-turn-select">'.concat(L10n.get("debugBarLabelTurn"),"</label>")+'<select id="debug-bar-turn-select" tabindex="0"></select></div>'+'<button id="debug-bar-toggle" tabindex="0" title="'.concat(barToggleLabel,'" aria-label="').concat(barToggleLabel,'"></button>')+'</div><div id="debug-bar-hint"></div>').appendTo("body"),_$debugBar=jQuery("#debug-bar"),_$watchBody=jQuery(_$debugBar.find("#debug-bar-watch").get(0)),_$watchList=jQuery(_$debugBar.find("#debug-bar-watch-list").get(0)),_$turnSelect=jQuery(_$debugBar.find("#debug-bar-turn-select").get(0));var $barToggle=jQuery(_$debugBar.find("#debug-bar-toggle").get(0)),$watchToggle=jQuery(_$debugBar.find("#debug-bar-watch-toggle").get(0)),$watchInput=jQuery(_$debugBar.find("#debug-bar-watch-input").get(0)),$watchAdd=jQuery(_$debugBar.find("#debug-bar-watch-add").get(0)),$watchAll=jQuery(_$debugBar.find("#debug-bar-watch-all").get(0)),$watchNone=jQuery(_$debugBar.find("#debug-bar-watch-none").get(0)),$viewsToggle=jQuery(_$debugBar.find("#debug-bar-views-toggle").get(0));$barToggle.ariaClick(debugBarToggle),$watchToggle.ariaClick(debugBarWatchToggle),$watchInput.on(":addwatch",(function(){debugBarWatchAdd(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$watchInput.trigger(":addwatch"))})),$watchAdd.ariaClick((function(){return $watchInput.trigger(":addwatch")})),$watchAll.ariaClick(debugBarWatchAddAll),$watchNone.ariaClick(debugBarWatchClear),_$turnSelect.on("change",(function(){Engine.goTo(Number(this.value))})),$viewsToggle.ariaClick((function(){DebugView.toggle(),_updateSession()})),jQuery(document).on(":historyupdate.debug-bar",_updateTurnSelect).on(":passageend.debug-bar",(function(){_updateWatchBody(),_updateWatchList()})).on(":enginerestart.debug-bar",_clearSession),_hasSession()||DebugView.enable()}},isStowed:{value:function(){return _stowed}},start:{value:function(){(function(){if(!_hasSession())return!1;var debugState=session.get("debugState");_stowed=debugState.stowed,_watchList.push.apply(_watchList,_toConsumableArray(debugState.watchList)),debugState.watchEnabled?_debugBarWatchEnableNoUpdate():_debugBarWatchDisableNoUpdate();debugState.viewsEnabled?DebugView.enable():DebugView.disable()})(),_stowed?debugBarStow():debugBarUnstow(),_updateTurnSelect(),_updateWatchBody(),_updateWatchList()}},stow:{value:debugBarStow},toggle:{value:debugBarToggle},unstow:{value:debugBarUnstow},watch:{value:Object.freeze(Object.defineProperties({},{add:{value:debugBarWatchAdd},all:{value:debugBarWatchAddAll},clear:{value:debugBarWatchClear},delete:{value:debugBarWatchDelete},disable:{value:debugBarWatchDisable},enable:{value:debugBarWatchEnable},isEnabled:{value:debugBarWatchIsEnabled},toggle:{value:debugBarWatchToggle}}))}}))}(),LoadScreen=function(){var _locks=new Set,_autoId=0;function loadScreenHide(){jQuery(document.documentElement).removeAttr("data-init")}function loadScreenShow(){jQuery(document.documentElement).attr("data-init","loading")}return Object.freeze(Object.defineProperties({},{init:{value:function(){jQuery(document).on("readystatechange.SugarCube",(function(){_locks.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout((function(){0===_locks.size&&loadScreenHide()}),Math.max(Engine.minDomActionDelay,Config.loadDelay)):loadScreenHide()):loadScreenShow())}))}},clear:{value:function(){jQuery(document).off("readystatechange.SugarCube"),_locks.clear(),loadScreenHide()}},hide:{value:loadScreenHide},show:{value:loadScreenShow},lock:{value:function(){return++_autoId,_locks.add(_autoId),loadScreenShow(),_autoId}},unlock:{value:function(id){if(null==id)throw new Error("LoadScreen.unlock called with a null or undefined ID");_locks.has(id)&&_locks.delete(id),0===_locks.size&&jQuery(document).trigger("readystatechange")}}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:36,patch:1,prerelease:null,build:9717,date:new Date("2021-12-22T05:37:33.467Z"),extensions:{},toString:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,"+").concat(this.build)},short:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.title," (v").concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,")")},long:function(){return"".concat(this.title," v").concat(this.toString()," (").concat(this.date.toUTCString(),")")}}),TempState={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story,TempVariables=State.temporary;window.SugarCube={},jQuery((function(){try{var lockId=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),Story.load(),storage=SimpleStore.create(Story.domId,!0),session=SimpleStore.create(Story.domId,!1),Dialog.init(),UIBar.init(),Engine.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),Config.debug&&DebugBar.init();var $window=$(window),vprCheckId=setInterval((function(){$window.width()&&(clearInterval(vprCheckId),UIBar.start(),Config.debug&&DebugBar.start(),jQuery.event.trigger({type:":storyready"}),setTimeout((function(){return LoadScreen.unlock(lockId)}),2*Engine.minDomActionDelay))}),Engine.minDomActionDelay);Object.defineProperty(window,"SugarCube",{value:Object.seal(Object.assign(Object.create(null),{Browser:Browser,Config:Config,Dialog:Dialog,Engine:Engine,Fullscreen:Fullscreen,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,DebugBar:DebugBar,Util:Util,Visibility:Visibility,Wikifier:Wikifier,session:session,settings:settings,setup:setup,storage:storage,version:version}))})}catch(ex){return console.error(ex),LoadScreen.clear(),Alert.fatal(null,ex.message,ex)}}))})(window,window.document,jQuery);}
	</script>
</body>
</html>
